RtlClearBits    proc near               ; CODE XREF: sub_14020A8C8+2AC↑p
                                        ; sub_14020C4F4+71D↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                test    r8d, r8d
                jz      short locret_14021E0A2
                push    rsi
                sub     rsp, 20h

loc_14021E05A:                          ; DATA XREF: .rdata:0000000140051618↑o
                                        ; .rdata:0000000140051628↑o ...
                mov     [rsp+28h+arg_0], rbx
                mov     ebx, edx
                and     edx, 7
                shr     rbx, 3
                add     rbx, [rcx+8]
                mov     esi, r8d
                mov     [rsp+28h+arg_8], rbp
                lea     rbp, cs:140000000h
                lea     ecx, [rdx+rsi]
                cmp     ecx, 8
                ja      short loc_14021E0A4
                movzx   eax, byte ptr [rsi+rbp+1DAE0h]
                mov     ecx, edx
                shl     al, cl
                not     al

loc_14021E091:                          ; CODE XREF: RtlClearBits+9C↓j
                and     [rbx], al

loc_14021E093:                          ; CODE XREF: RtlClearBits+92↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rbp, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rsi

locret_14021E0A2:                       ; CODE XREF: RtlClearBits+3↑j
                retn
; ---------------------------------------------------------------------------
algn_14021E0A3:                         ; DATA XREF: .pdata:00000001400CA974↑o
                                        ; .pdata:00000001400CA980↑o
                align 4

loc_14021E0A4:                          ; CODE XREF: RtlClearBits+31↑j
                                        ; DATA XREF: .rdata:0000000140051654↑o ...
                test    edx, edx
                jz      short loc_14021E0B8
                movzx   eax, byte ptr [rdx+rbp+1DAE0h]
                lea     esi, [rcx-8]
                and     [rbx], al
                inc     rbx

loc_14021E0B8:                          ; CODE XREF: RtlClearBits+56↑j
                cmp     esi, 8
                jbe     short loc_14021E0E0

loc_14021E0BD:                          ; DATA XREF: .rdata:0000000140051654↑o
                                        ; .rdata:0000000140051664↑o ...
                mov     [rsp+28h+arg_10], rdi
                xor     edx, edx
                mov     edi, esi
                mov     rcx, rbx
                shr     rdi, 3
                mov     r8, rdi
                call    memset
                add     rbx, rdi
                mov     rdi, [rsp+28h+arg_10]
                and     esi, 7

loc_14021E0E0:                          ; CODE XREF: RtlClearBits+6B↑j
                                        ; DATA XREF: .pdata:00000001400CA998↑o ...
                test    esi, esi
                jz      short loc_14021E093
                movzx   eax, byte ptr [rsi+rbp+1A870h]
                jmp     short loc_14021E091
RtlClearBits    endp

; ---------------------------------------------------------------------------
algn_14021E0EE:                         ; DATA XREF: .pdata:00000001400CA9A4↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14021E100   proc near               ; CODE XREF: sub_1405CCFD8+13↓p
                                        ; sub_1405FAB94+5C5↓p ...

arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h

                mov     [rsp+arg_10], rbp
                mov     [rsp+arg_8], edx
                push    rsi
                push    rdi
                push    r14
                sub     rsp, 30h
                mov     r14d, [rcx+748h]
                mov     rdi, r8
                mov     ebp, edx
                mov     rsi, rcx
                test    r14d, r14d
                jnz     short loc_14021E139
                mov     [r8], r14d
                xor     al, al
                mov     rbp, [rsp+48h+arg_10]
                add     rsp, 30h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14021E139:                          ; CODE XREF: sub_14021E100+23↑j
                movsxd  rdx, dword ptr [rcx+750h]
                test    edx, edx
                js      short loc_14021E16F
                cmp     edx, r14d
                jnb     short loc_14021E16F
                mov     rax, [rsi+758h]
                mov     rcx, rdx
                add     rcx, rcx
                cmp     [rax+rcx*8], ebp
                jnz     short loc_14021E16F
                mov     [r8], edx
                mov     al, 1
                mov     rbp, [rsp+48h+arg_10]
                add     rsp, 30h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14021E16F:                          ; CODE XREF: sub_14021E100+42↑j
                                        ; sub_14021E100+47↑j ...
                mov     [rsp+48h+arg_0], rbx
                lea     rcx, [rsp+48h+arg_8]
                mov     rbx, [rsi+758h]
                mov     r8, r14
                mov     rdx, rbx
                call    sub_1403F0D30
                mov     rcx, rax
                sub     rcx, rbx
                mov     rbx, [rsp+48h+arg_0]
                shr     rcx, 4
                cmp     ecx, r14d
                jnb     short loc_14021E1BC

loc_14021E19F:                          ; DATA XREF: .pdata:00000001400CA9BC↑o
                                        ; .pdata:00000001400CA9C8↑o
                cmp     [rax], ebp
                jnz     short loc_14021E1BC
                mov     [rsi+750h], ecx
                mov     al, 1
                mov     [rdi], ecx
                mov     rbp, [rsp+48h+arg_10]
                add     rsp, 30h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14021E1BC:                          ; CODE XREF: sub_14021E100+9D↑j
                                        ; sub_14021E100+A1↑j
                mov     [rdi], ecx
                xor     al, al
                mov     rbp, [rsp+48h+arg_10]
                add     rsp, 30h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14021E100   endp

byte_14021E1CF  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CA9C8↑o

; =============== S U B R O U T I N E =======================================


sub_14021E1D8   proc near               ; CODE XREF: sub_1405D6F44+27↓p
                                        ; sub_1405FAAE0+7C↓p ...
                sub     rsp, 28h
                call    ExFreePoolWithTag
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14021E1D8   endp

algn_14021E1E7:                         ; DATA XREF: .pdata:00000001400CA9D4↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14021E1F0   proc near               ; CODE XREF: sub_140202824+58↑p
                                        ; CMSPAddress::get_DynamicTerminalClasses(tagVARIANT *)+2CC↑p ...
                sub     rsp, 28h
                add     word ptr [rcx+1E4h], 1
                jnz     short loc_14021E20A
                lea     rax, [rcx+98h]
                cmp     [rax], rax
                jnz     short loc_14021E210

loc_14021E20A:                          ; CODE XREF: sub_14021E1F0+C↑j
                                        ; sub_14021E1F0+28↓j ...
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_14021E210:                          ; CODE XREF: sub_14021E1F0+18↑j
                cmp     word ptr [rcx+1E6h], 0
                jnz     short loc_14021E20A
                call    KiCheckForKernelApcDelivery
                jmp     short loc_14021E20A
sub_14021E1F0   endp

; ---------------------------------------------------------------------------
algn_14021E221:                         ; DATA XREF: .pdata:00000001400CA9E0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14021E230   proc near               ; CODE XREF: sub_140207C5C+F6↑p
                                        ; sub_14026DEF0+22B↓p ...

var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
var_10          = qword ptr -10h
arg_0           = dword ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014041C110 SIZE 00000281 BYTES

                mov     [rsp+arg_8], edx
                mov     r11, rsp
                push    rbp
                sub     rsp, 50h
                mov     rax, [rcx+20h]
                mov     ebp, edx
                cmp     rax, 1
                jz      loc_14021E3D2
                test    rax, rax
                jnz     loc_14021E3D9
                mov     rax, gs:188h

loc_14021E25E:                          ; DATA XREF: .rdata:0000000140051F60↑o
                                        ; .rdata:0000000140051F78↑o ...
                mov     [r11+20h], rbx
                mov     rbx, gs:188h
                mov     [r11-10h], rsi
                mov     esi, edx
                mov     [r11-18h], rdi
                mov     [r11-20h], r12
                mov     [r11-28h], r13
                mov     [r11-30h], r14
                mov     r14, [rbx+0B8h]
                mov     [r11-38h], r15
                lea     r15, [rax+258h]
                mov     eax, 2
                lea     r13, [rax-3]
                and     esi, eax
                jnz     loc_14021E3F5
                mov     r12, cr8
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C110

loc_14021E2BA:                          ; CODE XREF: sub_14021E230+1FDEE2↓j
                                        ; sub_14021E230+1FDEEC↓j ...
                mov     rdi, gs:20h
                mov     [rsp+58h+arg_0], 0
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_14041C151

loc_14021E2DB:                          ; CODE XREF: sub_14021E230+212↓j
                                        ; sub_14021E230+1FDF25↓j ...
                lock bts qword ptr [rbx+40h], 0
                jb      loc_14021E415

loc_14021E2E8:                          ; CODE XREF: sub_14021E230+1C8↓j
                cmp     byte ptr [rbx+0C1h], 0
                jnz     loc_14021E3FD

loc_14021E2F5:                          ; CODE XREF: sub_14021E230+1E0↓j
                cmp     byte ptr [rbx+24Ah], 0
                jz      loc_14041C386
                test    byte ptr [rbx+0C0h], 1
                jnz     loc_14041C386
                lea     rdi, [rbx+98h]
                cmp     [rdi], rdi
                jnz     loc_14041C386
                lea     rax, [rbx+0A8h]
                cmp     [rax], rax
                jnz     loc_14041C386
                or      dword ptr [rbx+74h], 800h
                lea     rcx, [rbx+258h]
                mov     rdx, rdi
                cmp     r15, rcx
                jnz     loc_14041C315
                call    sub_14021EC30
                mov     qword ptr [rbx+278h], 0
                mov     byte ptr [rbx+24Ah], 0

loc_14021E360:                          ; CODE XREF: sub_14021E230+1FE0EE↓j
                test    esi, esi
                jnz     short loc_14021E36C
                mov     rcx, rbx
                call    sub_1403261B0

loc_14021E36C:                          ; CODE XREF: sub_14021E230+132↑j
                mov     rcx, [rbx+0B8h]
                mov     rdx, r14
                call    sub_14021E460
                and     dword ptr [rbx+74h], 0FFFFF7FFh
                test    esi, esi
                jnz     short loc_14021E39C
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C323

loc_14021E394:                          ; CODE XREF: sub_14021E230+1FE0F5↓j
                                        ; sub_14021E230+1FE101↓j ...
                movzx   eax, r12b
                mov     cr8, rax

loc_14021E39C:                          ; CODE XREF: sub_14021E230+154↑j
                test    bpl, 1
                jnz     short loc_14021E3AA
                mov     rcx, r14
                call    sub_14021ECB0

loc_14021E3AA:                          ; CODE XREF: sub_14021E230+170↑j
                cmp     [rdi], rdi
                jnz     short loc_14021E3E5

loc_14021E3AF:                          ; CODE XREF: sub_14021E230+1C3↓j
                mov     r14, [rsp+58h+var_30]
                mov     r13, [rsp+58h+var_28]
                mov     r12, [rsp+58h+var_20]
                mov     rdi, [rsp+58h+var_18]
                mov     rsi, [rsp+58h+var_10]
                mov     rbx, [rsp+58h+arg_18]
                mov     r15, [rsp+58h+var_38]

loc_14021E3D2:                          ; CODE XREF: sub_14021E230+16↑j
                                        ; DATA XREF: .pdata:00000001400CA9F8↑o ...
                add     rsp, 50h
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14021E3D9:                          ; CODE XREF: sub_14021E230+1F↑j
                call    sub_14021E830
                add     rsp, 50h
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14021E3E5:                          ; CODE XREF: sub_14021E230+17D↑j
                                        ; DATA XREF: .pdata:00000001400CAA04↑o ...
                mov     cl, 1
                mov     byte ptr [rbx+0C1h], 1
                call    HalRequestSoftwareInterrupt
                jmp     short loc_14021E3AF
; ---------------------------------------------------------------------------

loc_14021E3F5:                          ; CODE XREF: sub_14021E230+6E↑j
                mov     r12b, 0Fh
                jmp     loc_14021E2E8
; ---------------------------------------------------------------------------

loc_14021E3FD:                          ; CODE XREF: sub_14021E230+BF↑j
                mov     ebp, 2

loc_14021E402:                          ; CODE XREF: sub_14021E230+1FE0DA↓j
                cmp     r12b, 1
                jb      loc_14041C1BA

loc_14021E40C:                          ; CODE XREF: sub_14021E230+1FDF92↓j
                                        ; sub_14021E230+1FE0E0↓j
                mov     ebp, [rsp+58h+arg_8]
                jmp     loc_14021E2F5
; ---------------------------------------------------------------------------

loc_14021E415:                          ; CODE XREF: sub_14021E230+B2↑j
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_14041C178

loc_14021E425:                          ; CODE XREF: sub_14021E230+206↓j
                                        ; sub_14021E230+1FDF4C↓j ...
                lea     rcx, [rsp+58h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rbx+40h]
                test    rax, rax
                jnz     short loc_14021E425
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jz      loc_14021E2DB
                jmp     loc_14041C19F
sub_14021E230   endp

; ---------------------------------------------------------------------------
algn_14021E44D:                         ; DATA XREF: .pdata:00000001400CAA10↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14021E460   proc near               ; CODE XREF: sub_14021E230+146↑p
                                        ; DATA XREF: .rdata:0000000140051FF8↑o ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014041C392 SIZE 00000045 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 20h
                mov     r8, gs:20h
                mov     rbp, rdx
                movzx   eax, byte ptr [r8+0D0h]
                movzx   esi, byte ptr [r8+0D1h]
                lea     rdi, ds:178h[rax*8]
                lock bts [rdi+rcx], rsi
                cmp     cs:byte_140E01840, 0
                mov     rbx, [rcx+28h]
                jz      short loc_14021E4D5
                mov     rax, rbx
                test    bl, 2
                jz      short loc_14021E4C0
                mov     rdx, 8000000000000000h
                or      rax, rdx

loc_14021E4C0:                          ; CODE XREF: sub_14021E460+51↑j
                mov     gs:9000h, rax
                movzx   ecx, byte ptr [rcx+390h]
                call    sub_14021EC00

loc_14021E4D5:                          ; CODE XREF: sub_14021E460+49↑j
                mov     eax, cs:dword_140CFC41C
                test    al, 1
                jnz     loc_14041C392
                mov     cr3, rbx

loc_14021E4E6:                          ; CODE XREF: sub_14021E460+1FDF3B↓j
                cmp     cs:byte_140CFC409, 0
                jz      loc_14041C3A0

loc_14021E4F3:                          ; CODE XREF: sub_14021E460+1FDF47↓j
                                        ; sub_14021E460+1FDF67↓j ...
                lock btr [rdi+rbp], rsi
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14021E460   endp

algn_14021E50F:                         ; DATA XREF: .rdata:0000000140051FF8↑o
                                        ; .pdata:00000001400CAA1C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14021E520   proc near               ; CODE XREF: sub_14063A690+169↓p
                                        ; DATA XREF: .pdata:00000001400CAA28↑o

; FUNCTION CHUNK AT 00000001404284FE SIZE 00000035 BYTES

                xor     eax, eax
                mov     r8d, eax
                mov     r9d, eax
                cmp     edx, 10h
                jnz     short loc_14021E542
                mov     r8d, 1000000h
                lea     r9, [rcx+460h]

loc_14021E53A:                          ; CODE XREF: sub_14021E520+209FE9↓j
                                        ; sub_14021E520+209FFC↓j ...
                test    [r9], r8d
                setnz   al
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14021E542:                          ; CODE XREF: sub_14021E520+B↑j
                cmp     edx, 20h ; ' '
                jnz     loc_1404284FE
                mov     r8d, 2000000h
                lea     r9, [rcx+460h]
                test    [r9], r8d
                setnz   al
                retn
sub_14021E520   endp

; ---------------------------------------------------------------------------
                align 20h
byte_14021E560  db 10h dup(0CCh)        ; DATA XREF: .pdata:00000001400CAA28↑o

; =============== S U B R O U T I N E =======================================


sub_14021E570   proc near               ; CODE XREF: sub_1402D3C90+2F3↓p
                                        ; KeStackAttachProcess+CF↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h
arg_20          = qword ptr  28h

; FUNCTION CHUNK AT 000000014041C3D8 SIZE 000001A6 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 20h
                mov     rdi, [rsp+48h+arg_20]
                lea     r10, [rcx+98h]
                mov     rax, [r10+20h]
                mov     rbx, rcx
                mov     ebp, r9d
                movzx   r13d, r8b
                mov     rsi, rdx
                mov     [rdi+20h], rax
                movzx   eax, byte ptr [r10+28h]
                mov     [rdi+28h], al
                movzx   eax, byte ptr [r10+29h]
                mov     [rdi+29h], al
                movzx   eax, byte ptr [r10+2Ah]
                mov     [rdi+2Ah], al
                mov     rcx, [r10]
                cmp     rcx, r10
                jnz     loc_14021E7D1
                mov     [rdi+8], rdi
                mov     [rdi], rdi
                mov     byte ptr [rdi+29h], 0

loc_14021E5DC:                          ; CODE XREF: sub_14021E570+273↓j
                mov     rdx, [r10+10h]
                lea     rax, [r10+10h]
                cmp     rdx, rax
                lea     rax, [rdi+10h]
                jnz     loc_14021E7BA
                mov     [rax+8], rax
                mov     [rax], rax
                mov     byte ptr [rdi+2Ah], 0

loc_14021E5FC:                          ; CODE XREF: sub_14021E570+25C↓j
                lea     rax, [rbx+0A8h]
                mov     [r10+8], r10
                mov     [rax+8], rax
                mov     [rax], rax
                lea     rax, [rbx+258h]
                mov     [r10], r10
                mov     word ptr [rbx+0C0h], 0
                mov     byte ptr [rbx+0C2h], 0
                cmp     rdi, rax
                jnz     short loc_14021E634
                mov     byte ptr [rbx+24Ah], 1

loc_14021E634:                          ; CODE XREF: sub_14021E570+BB↑j
                xor     r15d, r15d
                mov     r10, 0FFFFFFFFFFFFFFFFh
                test    bpl, 1
                jnz     short loc_14021E659
                mov     eax, 8
                lock xadd [rsi+348h], eax
                test    al, 7
                jnz     loc_14021E751

loc_14021E659:                          ; CODE XREF: sub_14021E570+D2↑j
                                        ; sub_14021E570+245↓j
                or      dword ptr [rbx+74h], 800h
                mov     [rbx+0B8h], rsi
                and     ebp, 2
                jnz     short loc_14021E689
                mov     [rbx+40h], r15
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14041C4A8

loc_14021E689:                          ; CODE XREF: sub_14021E570+FA↑j
                                        ; sub_14021E570+1FDF3C↓j ...
                mov     rcx, gs:20h
                mov     r12, [rdi+20h]
                movzx   eax, byte ptr [rcx+0D0h]
                movzx   r15d, byte ptr [rcx+0D1h]
                lea     r14, ds:178h[rax*8]
                lock bts [r14+rsi], r15
                cmp     cs:byte_140E01840, 0
                mov     rdi, [rsi+28h]
                jz      short loc_14021E6F2
                mov     rax, rdi
                test    dil, 2
                jz      short loc_14021E6D6
                mov     rcx, 8000000000000000h
                or      rax, rcx

loc_14021E6D6:                          ; CODE XREF: sub_14021E570+157↑j
                mov     gs:9000h, rax
                movzx   ecx, byte ptr [rsi+390h]
                call    sub_14021EC00
                mov     r10, 0FFFFFFFFFFFFFFFFh

loc_14021E6F2:                          ; CODE XREF: sub_14021E570+14E↑j
                mov     eax, cs:dword_140CFC41C
                test    al, 1
                jnz     loc_14041C4D2
                mov     cr3, rdi

loc_14021E703:                          ; CODE XREF: sub_14021E570+1FDF71↓j
                cmp     cs:byte_140CFC409, 0
                jz      loc_14041C4E6

loc_14021E710:                          ; CODE XREF: sub_14021E570+1FDF7D↓j
                                        ; sub_14021E570+1FDF9D↓j ...
                lock btr [r14+r12], r15
                and     dword ptr [rbx+74h], 0FFFFF7FFh
                test    ebp, ebp
                jnz     short loc_14021E733
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C51D

loc_14021E72F:                          ; CODE XREF: sub_14021E570+1FDFAF↓j
                                        ; sub_14021E570+1FDFBB↓j ...
                mov     cr8, r13

loc_14021E733:                          ; CODE XREF: sub_14021E570+1AF↑j
                mov     rbx, [rsp+48h+arg_0]
                mov     rbp, [rsp+48h+arg_8]
                mov     rsi, [rsp+48h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14021E751:                          ; CODE XREF: sub_14021E570+E3↑j
                mov     rcx, rbx
                call    sub_1403261B0
                movzx   r8d, r13b
                mov     rdx, rsi
                mov     rcx, rbx
                call    sub_140328BE0
                mov     rcx, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C3D8

loc_14021E783:                          ; CODE XREF: sub_14021E570+1FDE6A↓j
                                        ; sub_14021E570+1FDE73↓j ...
                mov     r14, gs:20h
                mov     [rsp+48h+arg_18], r15d
                mov     rcx, [r14+84B8h]
                test    rcx, rcx
                jnz     loc_14041C41B

loc_14021E7A1:                          ; CODE XREF: sub_14021E570+1FDEB0↓j
                                        ; sub_14021E570+1FDEBF↓j ...
                lock bts qword ptr [rbx+40h], 0
                jb      loc_14041C443
                mov     r10, 0FFFFFFFFFFFFFFFFh
                jmp     loc_14021E659
; ---------------------------------------------------------------------------

loc_14021E7BA:                          ; CODE XREF: sub_14021E570+7B↑j
                mov     rcx, [r10+18h]
                mov     [rax], rdx
                mov     [rdi+18h], rcx
                mov     [rdx+8], rax
                mov     [rcx], rax
                jmp     loc_14021E5FC
; ---------------------------------------------------------------------------

loc_14021E7D1:                          ; CODE XREF: sub_14021E570+5B↑j
                mov     rax, [r10+8]
                mov     [rdi], rcx
                mov     [rdi+8], rax
                mov     [rcx+8], rdi
                mov     [rax], rdi
                jmp     loc_14021E5DC
sub_14021E570   endp

; ---------------------------------------------------------------------------
algn_14021E7E8:                         ; DATA XREF: .rdata:00000001400520B4↑o
                                        ; .pdata:00000001400CAA34↑o
                align 10h
; Exported entry 1354. KeUnstackDetachProcess

; =============== S U B R O U T I N E =======================================


                public KeUnstackDetachProcess
KeUnstackDetachProcess proc near        ; CODE XREF: sub_140280660+756↓p
                                        ; sub_140280660+7B7↓p ...
                sub     rsp, 28h
                mov     rax, [rcx+20h]
                cmp     rax, 1
                jz      short loc_14021E81A
                xor     edx, edx
                test    rax, rax
                jnz     short loc_14021E815
                mov     rcx, gs:188h
                add     rcx, 258h

loc_14021E815:                          ; CODE XREF: KeUnstackDetachProcess+13↑j
                call    sub_14021E830

loc_14021E81A:                          ; CODE XREF: KeUnstackDetachProcess+C↑j
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
KeUnstackDetachProcess endp

byte_14021E820  db 10h dup(0CCh)        ; DATA XREF: .pdata:00000001400CAA40↑o

; =============== S U B R O U T I N E =======================================


sub_14021E830   proc near               ; CODE XREF: sub_14021E230:loc_14021E3D9↑p
                                        ; KeUnstackDetachProcess:loc_14021E815↑p ...

arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014041C57E SIZE 000003F4 BYTES

                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                sub     rsp, 20h
                mov     rbx, gs:188h
                mov     ebp, edx
                mov     r10d, 2
                xor     r14d, r14d
                mov     r12d, edx
                mov     rsi, rcx
                mov     r13, [rbx+0B8h]
                and     ebp, r10d
                jnz     loc_14041C62C
                mov     r11, cr8
                mov     [rsp+58h+arg_18], r11
                mov     cr8, r10
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C57E

loc_14021E884:                          ; CODE XREF: sub_14021E830+1FDD50↓j
                                        ; sub_14021E830+1FDD5A↓j ...
                mov     rdi, gs:20h
                mov     [rsp+58h+arg_8], r14d
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_14041C5C3

loc_14021E8A2:                          ; CODE XREF: sub_14021E830+3BD↓j
                                        ; sub_14021E830+1FDD97↓j ...
                lock bts qword ptr [rbx+40h], 0
                jb      loc_14021EBBB
                mov     r11, [rsp+58h+arg_18]
                mov     r10d, 2

loc_14021E8BA:                          ; CODE XREF: sub_14021E830+1FDE04↓j
                                        ; DATA XREF: .rdata:0000000140052198↑o ...
                mov     [rsp+58h+arg_0], r15
                cmp     [rbx+0C1h], r14b
                jnz     loc_14041C639

loc_14021E8CC:                          ; CODE XREF: sub_14021E830+1FDF91↓j
                cmp     [rbx+24Ah], r14b
                jz      loc_14041C967
                test    byte ptr [rbx+0C0h], 1
                jnz     loc_14041C967
                lea     rdi, [rbx+98h]
                cmp     [rdi], rdi
                jnz     loc_14041C967
                lea     rax, [rbx+0A8h]
                cmp     [rax], rax
                jnz     loc_14041C967
                or      dword ptr [rbx+74h], 800h
                lea     rcx, [rbx+258h]
                cmp     rsi, rcx
                jnz     loc_14021EA9A
                mov     rax, [rcx+20h]
                mov     [rdi+20h], rax
                movzx   eax, byte ptr [rcx+28h]
                mov     [rdi+28h], al
                movzx   eax, byte ptr [rcx+29h]
                mov     [rdi+29h], al
                movzx   eax, byte ptr [rcx+2Ah]
                mov     [rdi+2Ah], al
                mov     rdx, [rcx]
                cmp     rdx, rcx
                jnz     loc_14021EB7B
                mov     [rdi+8], rdi
                mov     [rdi], rdi
                mov     [rdi+29h], r14b

loc_14021E951:                          ; CODE XREF: sub_14021E830+35D↓j
                mov     rdx, [rcx+10h]
                lea     rax, [rcx+10h]
                cmp     rdx, rax
                lea     rax, [rdi+10h]
                jnz     loc_14021EB92
                mov     [rax+8], rax
                mov     [rax], rax
                mov     [rdi+2Ah], r14b

loc_14021E971:                          ; CODE XREF: sub_14021E830+374↓j
                mov     [rbx+278h], r14
                mov     [rbx+24Ah], r14b

loc_14021E97F:                          ; CODE XREF: sub_14021E830+275↓j
                test    ebp, ebp
                jnz     short loc_14021E9A0
                mov     [rbx+40h], r14
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14041C7C6

loc_14021E9A0:                          ; CODE XREF: sub_14021E830+151↑j
                                        ; sub_14021E830+1FDF9A↓j ...
                mov     rcx, gs:20h
                mov     rdx, [rbx+0B8h]
                movzx   eax, byte ptr [rcx+0D0h]
                movzx   r15d, byte ptr [rcx+0D1h]
                lea     r14, ds:178h[rax*8]
                lock bts [r14+rdx], r15
                cmp     cs:byte_140E01840, 0
                mov     rsi, [rdx+28h]
                jz      short loc_14021EA10
                mov     rax, rsi
                test    sil, 2
                jz      short loc_14021E9F0
                mov     rcx, 8000000000000000h
                or      rax, rcx

loc_14021E9F0:                          ; CODE XREF: sub_14021E830+1B1↑j
                mov     gs:9000h, rax
                movzx   ecx, byte ptr [rdx+390h]
                call    sub_14021EC00
                mov     r11, [rsp+58h+arg_18]
                mov     r10d, 2

loc_14021EA10:                          ; CODE XREF: sub_14021E830+1A8↑j
                mov     eax, cs:dword_140CFC41C
                test    al, 1
                jnz     loc_14041C7F4
                mov     cr3, rsi

loc_14021EA21:                          ; CODE XREF: sub_14021E830+1FDFD7↓j
                cmp     cs:byte_140CFC409, 0
                jz      loc_14021EBA9

loc_14021EA2E:                          ; CODE XREF: sub_14021E830+380↓j
                                        ; sub_14021E830+1FDFF6↓j ...
                lock btr [r14+r13], r15
                and     dword ptr [rbx+74h], 0FFFFF7FFh
                test    ebp, ebp
                jnz     loc_14041C8A9
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C836

loc_14021EA51:                          ; CODE XREF: sub_14021E830+1FE008↓j
                                        ; sub_14021E830+1FE014↓j ...
                mov     r14, 0FFFFFFFFFFFFFFFFh

loc_14021EA58:                          ; CODE XREF: sub_14021E830+1FE02D↓j
                                        ; sub_14021E830+1FE074↓j
                movzx   eax, r11b
                mov     cr8, rax

loc_14021EA60:                          ; CODE XREF: sub_14021E830+1FE080↓j
                test    r12b, 1
                jnz     short loc_14021EA7C
                mov     eax, 0FFFFFFF8h
                lock xadd [r13+348h], eax
                and     eax, 0FFFFFFF8h
                cmp     eax, 8
                jz      short loc_14021EAAA

loc_14021EA7C:                          ; CODE XREF: sub_14021E830+234↑j
                                        ; sub_14021E830+333↓j
                cmp     [rdi], rdi
                jnz     loc_14021EB68

loc_14021EA85:                          ; CODE XREF: sub_14021E830+346↓j
                mov     r15, [rsp+58h+arg_0]
                add     rsp, 20h
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
algn_14021EA99:                         ; DATA XREF: .pdata:00000001400CAA58↑o
                                        ; .pdata:00000001400CAA64↑o
                align 2

loc_14021EA9A:                          ; CODE XREF: sub_14021E830+E7↑j
                                        ; DATA XREF: .pdata:00000001400CAA64↑o ...
                mov     rdx, rdi
                mov     rcx, rsi
                call    sub_14021EC30
                jmp     loc_14021E97F
; ---------------------------------------------------------------------------

loc_14021EAAA:                          ; CODE XREF: sub_14021E830+24A↑j
                xor     sil, sil
                mov     rbp, cr8
                mov     cr8, r10
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C8B5

loc_14021EAC3:                          ; CODE XREF: sub_14021E830+1FE087↓j
                                        ; sub_14021E830+1FE091↓j ...
                mov     rcx, r13
                call    sub_1402AF4F0
                mov     eax, [r13+348h]
                test    al, 7
                jnz     short loc_14021EAFE
                lea     rcx, [r13+30h]
                cmp     [rcx], rcx
                jz      short loc_14021EAFE
                cmp     eax, 8
                jnb     short loc_14021EAFE

loc_14021EAE4:                          ; CODE XREF: sub_14021E830+1FE0C9↓j
                mov     ecx, eax
                and     ecx, 0FFFFFFFBh
                or      ecx, 3
                lock cmpxchg [r13+348h], ecx
                jnz     loc_14041C8F6
                mov     sil, 1

loc_14021EAFE:                          ; CODE XREF: sub_14021E830+2A4↑j
                                        ; sub_14021E830+2AD↑j ...
                lock and dword ptr [r13+0], 0FFFFFF7Fh
                test    sil, sil
                jz      short loc_14021EB4D
                add     r13, 168h
                prefetchw byte ptr cs:qword_140C31E88
                mov     rax, cs:qword_140C31E88

loc_14021EB21:                          ; CODE XREF: sub_14021E830+304↓j
                mov     [r13+0], rax
                mov     rcx, rax
                lock cmpxchg cs:qword_140C31E88, r13
                cmp     rax, rcx
                jnz     short loc_14021EB21
                test    rax, rax
                jnz     short loc_14021EB4D
                xor     r8d, r8d
                lea     edx, [rax+0Ah]
                lea     rcx, dword_140C31E40
                call    KeSetEvent

loc_14021EB4D:                          ; CODE XREF: sub_14021E830+2DA↑j
                                        ; sub_14021E830+309↑j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C904

loc_14021EB5B:                          ; CODE XREF: sub_14021E830+1FE0D6↓j
                                        ; sub_14021E830+1FE0E2↓j ...
                movzx   eax, bpl
                mov     cr8, rax
                jmp     loc_14021EA7C
; ---------------------------------------------------------------------------

loc_14021EB68:                          ; CODE XREF: sub_14021E830+24F↑j
                mov     cl, 1
                mov     byte ptr [rbx+0C1h], 1
                call    HalRequestSoftwareInterrupt
                jmp     loc_14021EA85
; ---------------------------------------------------------------------------

loc_14021EB7B:                          ; CODE XREF: sub_14021E830+110↑j
                mov     rax, [rcx+8]
                mov     [rdi], rdx
                mov     [rdi+8], rax
                mov     [rdx+8], rdi
                mov     [rax], rdi
                jmp     loc_14021E951
; ---------------------------------------------------------------------------

loc_14021EB92:                          ; CODE XREF: sub_14021E830+130↑j
                mov     rcx, [rcx+18h]
                mov     [rax], rdx
                mov     [rdi+18h], rcx
                mov     [rdx+8], rax
                mov     [rcx], rax
                jmp     loc_14021E971
; ---------------------------------------------------------------------------

loc_14021EBA9:                          ; CODE XREF: sub_14021E830+1F8↑j
                cmp     cs:byte_140E01840, 0
                jz      loc_14021EA2E
                jmp     loc_14041C80C
; ---------------------------------------------------------------------------

loc_14021EBBB:                          ; CODE XREF: sub_14021E830+79↑j
                                        ; DATA XREF: .pdata:00000001400CAA70↑o ...
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_14041C5EA
                nop     dword ptr [rax+rax+00h]

loc_14021EBD0:                          ; CODE XREF: sub_14021E830+3B1↓j
                                        ; sub_14021E830+1FDDBE↓j ...
                lea     rcx, [rsp+58h+arg_8]
                call    sub_1402C8C70
                mov     rax, [rbx+40h]
                test    rax, rax
                jnz     short loc_14021EBD0
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jz      loc_14021E8A2
                jmp     loc_14041C611
sub_14021E830   endp

; ---------------------------------------------------------------------------
algn_14021EBF8:                         ; DATA XREF: .pdata:00000001400CAA7C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14021EC00   proc near               ; CODE XREF: sub_14021E460+70↑p
                                        ; sub_14021E570+176↑p ...

var_8           = dword ptr -8

                pushfq
                sub     rsp, 20h
                cli
                call    sub_1403FECD0
                mov     eax, [rsp+28h+var_8]
                shr     eax, 9
                test    al, 1
                jz      short loc_14021EC18
                sti

loc_14021EC18:                          ; CODE XREF: sub_14021EC00+15↑j
                add     rsp, 20h
                pop     rcx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14021EC00   endp

byte_14021EC1F  db 11h dup(0CCh)        ; DATA XREF: .pdata:00000001400CAA88↑o

; =============== S U B R O U T I N E =======================================


sub_14021EC30   proc near               ; CODE XREF: sub_14021E230+119↑p
                                        ; sub_14021E830+270↑p ...
                mov     rax, [rcx+20h]
                mov     r8, rcx
                mov     [rdx+20h], rax
                movzx   eax, byte ptr [rcx+28h]
                mov     [rdx+28h], al
                movzx   eax, byte ptr [rcx+29h]
                mov     [rdx+29h], al
                movzx   eax, byte ptr [rcx+2Ah]
                mov     [rdx+2Ah], al
                mov     rcx, [rcx]
                cmp     rcx, r8
                jnz     short loc_14021EC81
                mov     [rdx+8], rdx
                mov     [rdx], rdx
                mov     byte ptr [rdx+29h], 0

loc_14021EC63:                          ; CODE XREF: sub_14021EC30+63↓j
                mov     r9, [r8+10h]
                lea     rax, [r8+10h]
                lea     rcx, [rdx+10h]
                cmp     r9, rax
                jnz     short loc_14021EC95
                mov     [rcx+8], rcx
                mov     [rcx], rcx
                mov     byte ptr [rdx+2Ah], 0
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14021EC81:                          ; CODE XREF: sub_14021EC30+26↑j
                mov     rax, [r8+8]
                mov     [rdx], rcx
                mov     [rdx+8], rax
                mov     [rcx+8], rdx
                mov     [rax], rdx
                jmp     short loc_14021EC63
; ---------------------------------------------------------------------------

loc_14021EC95:                          ; CODE XREF: sub_14021EC30+42↑j
                mov     rax, [r8+18h]
                mov     [rcx], r9
                mov     [rdx+18h], rax
                mov     [r9+8], rcx
                mov     [rax], rcx
                retn
sub_14021EC30   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14021ECA9:                         ; DATA XREF: .pdata:00000001400CAA94↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14021ECB0   proc near               ; CODE XREF: sub_14021E230+175↑p
                                        ; sub_140240710+657↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014041C972 SIZE 000000A4 BYTES

                mov     rax, rsp
                mov     [rax+8], rbx
                mov     [rax+10h], rbp
                mov     [rax+18h], rsi
                mov     [rax+20h], rdi
                push    r15
                sub     rsp, 20h
                mov     rbx, rcx
                mov     eax, 0FFFFFFF8h
                lock xadd [rcx+348h], eax
                and     eax, 0FFFFFFF8h
                cmp     eax, 8
                jz      short loc_14021ECFD

loc_14021ECE1:                          ; CODE XREF: sub_14021ECB0+AD↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r15
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14021ECFD:                          ; CODE XREF: sub_14021ECB0+2F↑j
                xor     sil, sil
                mov     rdi, cr8
                mov     r15d, 2
                mov     cr8, r15
                mov     eax, cs:dword_140CFC660
                or      rbp, 0FFFFFFFFFFFFFFFFh
                test    eax, eax
                jnz     loc_14041C972

loc_14021ED20:                          ; CODE XREF: sub_14021ECB0+1FDCC4↓j
                                        ; sub_14021ECB0+1FDCCE↓j ...
                mov     rcx, rbx
                call    sub_1402AF4F0
                mov     eax, [rbx+348h]
                test    al, 7
                jnz     short loc_14021ED3B
                lea     rcx, [rbx+30h]
                cmp     [rcx], rcx
                jnz     short loc_14021ED5F

loc_14021ED3B:                          ; CODE XREF: sub_14021ECB0+80↑j
                                        ; sub_14021ECB0+B2↓j ...
                lock and dword ptr [rbx], 0FFFFFF7Fh
                test    sil, sil
                jnz     short loc_14021ED7B

loc_14021ED47:                          ; CODE XREF: sub_14021ECB0+F7↓j
                                        ; sub_14021ECB0+10B↓j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14041C9B3

loc_14021ED55:                          ; CODE XREF: sub_14021ECB0+1FDD05↓j
                                        ; sub_14021ECB0+1FDD11↓j ...
                movzx   eax, dil
                mov     cr8, rax
                jmp     short loc_14021ECE1
; ---------------------------------------------------------------------------

loc_14021ED5F:                          ; CODE XREF: sub_14021ECB0+89↑j
                                        ; sub_14021ECB0+C4↓j
                cmp     eax, 8
                jnb     short loc_14021ED3B
                mov     ecx, eax
                and     ecx, 0FFFFFFFBh
                or      ecx, 3
                lock cmpxchg [rbx+348h], ecx
                jnz     short loc_14021ED5F
                mov     sil, 1
                jmp     short loc_14021ED3B
; ---------------------------------------------------------------------------

loc_14021ED7B:                          ; CODE XREF: sub_14021ECB0+95↑j
                add     rbx, 168h
                prefetchw byte ptr cs:qword_140C31E88
                mov     rax, cs:qword_140C31E88

loc_14021ED90:                          ; CODE XREF: sub_14021ECB0+F2↓j
                mov     [rbx], rax
                mov     rcx, rax
                lock cmpxchg cs:qword_140C31E88, rbx
                cmp     rax, rcx
                jnz     short loc_14021ED90
                test    rax, rax
                jnz     short loc_14021ED47
                xor     r8d, r8d
                lea     edx, [rax+0Ah]
                lea     rcx, dword_140C31E40
                call    KeSetEvent
                jmp     short loc_14021ED47
sub_14021ECB0   endp

; ---------------------------------------------------------------------------
byte_14021EDBD  db 13h dup(0CCh)        ; DATA XREF: .rdata:0000000140052334↑o
                                        ; .pdata:00000001400CAAA0↑o

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_14021EDD0   proc near               ; CODE XREF: sub_1402144B0+10B↑p
                                        ; sub_1402144B0+160↑p
                                        ; DATA XREF: ...

var_60          = dword ptr -60h
var_5C          = dword ptr -5Ch
var_58          = dword ptr -58h
var_54          = dword ptr -54h
var_50          = qword ptr -50h
var_48          = xmmword ptr -48h
var_38          = qword ptr -38h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
var_10          = qword ptr -10h
var_8           = qword ptr -8
arg_0           = qword ptr  20h
arg_8           = qword ptr  28h
arg_10          = word ptr  30h
arg_18          = dword ptr  38h

; FUNCTION CHUNK AT 0000000140428534 SIZE 00000414 BYTES

                mov     [rsp-18h+arg_8], rdx
                mov     [rsp-18h+arg_0], rcx
                push    rbp
                push    rbx
                push    r15
                mov     rbp, rsp
                sub     rsp, 80h
                xor     eax, eax
                xorps   xmm0, xmm0
                mov     rbx, rdx
                mov     r15, rcx
                movups  [rbp+var_48], xmm0
                mov     [rbp+var_38], rax
                cmp     [rcx+0Ch], al
                jnz     loc_140428534

loc_14021EE04:                          ; CODE XREF: sub_14021EDD0+20976A↓j
                mov     eax, [r15+4]
                test    al, 20h
                jnz     loc_14021F266

loc_14021EE10:                          ; DATA XREF: .rdata:0000000140052364↑o
                                        ; .rdata:0000000140052378↑o ...
                mov     [rsp+80h+var_8], rsi
                mov     rcx, r15
                mov     [rsp+80h+var_10], rdi
                mov     rdi, [r15+1AC0h]
                mov     [rbp+var_50], rdi
                call    sub_1402FFA68
                mov     rdx, rbx
                mov     rcx, r15
                call    sub_1402FF6D0
                mov     r8d, eax
                mov     [rbp+var_60], eax
                mov     rdx, rbx
                mov     rcx, r15
                mov     esi, eax
                call    sub_140209E68
                mov     ebx, esi
                and     ebx, 5
                jnz     loc_14042853F

loc_14021EE56:                          ; CODE XREF: sub_14021EDD0+209780↓j
                xor     eax, eax
                mov     [rbp+var_5C], eax
                mov     [rbp+var_58], eax
                test    ebx, ebx
                jnz     loc_140428555

loc_14021EE66:                          ; CODE XREF: sub_14021EDD0+209789↓j
                test    sil, 2
                jnz     loc_14021F273

loc_14021EE70:                          ; CODE XREF: sub_14021EDD0+4A6↓j
                mov     [rsp+80h+var_18], r12
                mov     rbx, rax
                mov     [rsp+80h+var_20], r13
                mov     [rsp+80h+var_28], r14
                test    sil, 40h
                jnz     loc_14021F298
                lea     rdx, [rbp+var_48]
                lea     rcx, qword_140C4ECC0
                call    KeAcquireInStackQueuedSpinLock

loc_14021EE9C:                          ; CODE XREF: sub_14021EDD0+4EA↓j
                                        ; sub_14021EDD0+500↓j ...
                mov     r11, [rbp+arg_8]
                lea     r12, [r15+1AC8h]
                mov     byte ptr [rdi+35h], 1
                xor     r9d, r9d

loc_14021EEAE:                          ; CODE XREF: sub_14021EDD0+209A7A↓j
                lea     rcx, qword_140034468

loc_14021EEB5:                          ; CODE XREF: sub_14021EDD0+209A5B↓j
                mov     r8d, esi
                mov     r13d, r9d
                and     r8d, 1
                mov     [rbp+var_54], r8d
                jnz     loc_14042856F

loc_14021EEC9:                          ; CODE XREF: sub_14021EDD0+2097BD↓j
                inc     word ptr [rdi+928h]
                movzx   edx, word ptr [rdi+928h]
                mov     rcx, [r11+50h]
                sub     rcx, [r11+60h]
                mov     [r11+58h], rcx
                mov     [rbp+arg_10], dx
                nop     word ptr [rax+rax+00000000h]

loc_14021EEF0:                          ; CODE XREF: sub_14021EDD0+327↓j
                                        ; sub_14021EDD0+2097E6↓j ...
                mov     rax, [r12]
                cmp     rax, r12
                jz      loc_14021F12F
                mov     rcx, [rax]
                cmp     [rax+8], r12
                jnz     loc_14021F40F
                cmp     [rcx+8], rax
                jnz     loc_14021F40F
                mov     [r12], rcx
                lea     rdi, [rax-18h]
                mov     [rcx+8], r12
                lea     r14, [rdi+18h]
                mov     [r14], r9
                cmp     [rdi+0ACh], dx
                jz      loc_14021F135
                mov     r15d, esi
                mov     [rdi+0ACh], dx
                and     r15d, 40h
                jnz     loc_14021F0FC

loc_14021EF48:                          ; CODE XREF: sub_14021EDD0+338↓j
                cmp     qword ptr [rdi+88h], 1
                jbe     loc_14021F3EE

loc_14021EF56:                          ; CODE XREF: sub_14021EDD0+625↓j
                mov     eax, [rdi+0B8h]
                mov     [rbp+arg_18], eax
                shr     eax, 8
                and     al, 0FBh
                or      al, 2
                mov     byte ptr [rbp+arg_18+1], al
                movzx   eax, word ptr [rbp+arg_18]
                mov     [rdi+0B8h], ax
                cmp     byte ptr [r11+2], 2
                jz      loc_140428697

loc_14021EF7F:                          ; CODE XREF: sub_14021EDD0+2098EA↓j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_1404286BF
                prefetchw byte ptr [rbp+var_48]
                mov     rax, qword ptr [rbp+var_48]
                test    rax, rax
                jnz     loc_14021F383
                mov     rcx, qword ptr [rbp+var_48+8]
                lea     rax, [rbp+var_48]
                lock cmpxchg [rcx], r9
                lea     rcx, [rbp+var_48]
                cmp     rax, rcx
                jnz     loc_14021F373

loc_14021EFB7:                          ; CODE XREF: sub_14021EDD0+5BD↓j
                                        ; sub_14021EDD0+209900↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_1404286D5

loc_14021EFD0:                          ; CODE XREF: sub_14021EDD0+209909↓j
                                        ; sub_14021EDD0+209918↓j ...
                mov     eax, cs:dword_140CFC660
                movzx   esi, byte ptr [rbp+var_38]
                test    eax, eax
                jnz     loc_1404286FC

loc_14021EFE2:                          ; CODE XREF: sub_14021EDD0+20992E↓j
                                        ; sub_14021EDD0+20993A↓j ...
                mov     cr8, rsi
                mov     esi, [rbp+var_60]
                mov     rdx, r11
                mov     r8d, esi
                mov     rcx, rdi
                call    sub_14021F420
                mov     r13d, eax
                cmp     eax, 1
                jz      loc_140428769

loc_14021F003:                          ; CODE XREF: sub_14021EDD0+2099A1↓j
                lea     r8, qword_140C4ECC0
                xor     r9d, r9d
                mov     qword ptr [rbp+var_48+8], r8
                mov     qword ptr [rbp+var_48], r9
                mov     r10, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jnz     loc_140428776

loc_14021F030:                          ; CODE XREF: sub_14021EDD0+2099A9↓j
                                        ; sub_14021EDD0+2099B3↓j ...
                mov     byte ptr [rbp+var_38], r10b
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_1404287C6

loc_14021F04D:                          ; CODE XREF: sub_14021EDD0+2099FA↓j
                                        ; sub_14021EDD0+209A09↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_1404287F3
                lea     rdx, [rbp+var_48]
                xchg    rdx, cs:qword_140C4ECC0
                test    rdx, rdx
                jnz     loc_14021F392

loc_14021F06E:                          ; CODE XREF: sub_14021EDD0+5CE↓j
                                        ; sub_14021EDD0+2098D5↓j ...
                test    r15d, r15d
                jnz     loc_14021F2FE

loc_14021F077:                          ; CODE XREF: sub_14021EDD0+53D↓j
                                        ; sub_14021EDD0+54E↓j
                mov     edx, 1

loc_14021F07C:                          ; CODE XREF: sub_14021EDD0+548↓j
                mov     eax, [rdi+0B8h]
                mov     ecx, eax
                shr     ecx, 8
                mov     [rbp+arg_18], eax
                test    edx, edx
                jz      loc_14021F323
                shr     eax, 8
                and     al, 0F9h
                mov     byte ptr [rbp+arg_18+1], al
                movzx   eax, word ptr [rbp+arg_18]
                mov     [rdi+0B8h], ax
                mov     rax, cs:qword_140C4E4C8
                movzx   ecx, word ptr [rdi+0AEh]
                mov     rdx, [rax+rcx*8]
                add     rdx, 1AC8h
                mov     rax, [rdx+8]
                cmp     [rax], rdx
                jnz     loc_14021F40F
                mov     [r14], rdx
                mov     [r14+8], rax
                mov     [rax], r14
                mov     [rdx+8], r14
                mov     rcx, [rdi+68h]
                test    rcx, rcx
                jnz     loc_14021F400

loc_14021F0E6:                          ; CODE XREF: sub_14021EDD0+56C↓j
                                        ; sub_14021EDD0+63A↓j
                mov     r11, [rbp+arg_8]
                xor     r9d, r9d
                cmp     r13d, 1
                jz      short loc_14021F12F
                movzx   edx, [rbp+arg_10]
                jmp     loc_14021EEF0
; ---------------------------------------------------------------------------

loc_14021F0FC:                          ; CODE XREF: sub_14021EDD0+172↑j
                mov     rax, [rbp+var_50]
                mov     rax, [rax+38h]
                cmp     [rdi+60h], rax
                jnb     loc_14021EF48
                mov     rax, [r12+8]
                add     rdi, 18h
                cmp     [rax], r12
                jnz     loc_14021F40F
                mov     [rdi], r12
                mov     [rdi+8], rax
                mov     [rax], rdi
                mov     [r12+8], rdi

loc_14021F12F:                          ; CODE XREF: sub_14021EDD0+127↑j
                                        ; sub_14021EDD0+321↑j
                mov     r15, [rbp+arg_0]
                jmp     short loc_14021F164
; ---------------------------------------------------------------------------

loc_14021F135:                          ; CODE XREF: sub_14021EDD0+15E↑j
                mov     rax, [r12]
                add     rdi, 18h
                cmp     [rax+8], r12
                jnz     loc_14021F40F
                cmp     [rbp+var_54], 0
                mov     r15, [rbp+arg_0]
                mov     [rdi], rax
                mov     [rdi+8], r12
                mov     [rax+8], rdi
                mov     [r12], rdi
                jnz     loc_140428805

loc_14021F164:                          ; CODE XREF: sub_14021EDD0+363↑j
                                        ; sub_14021EDD0+209A61↓j
                test    sil, 40h
                jnz     loc_14021F280

loc_14021F16E:                          ; CODE XREF: sub_14021EDD0+4C3↓j
                mov     r14d, [rbp+var_5C]
                mov     rdi, [rbp+var_50]
                or      r14d, esi
                mov     [rbp+var_5C], r14d
                cmp     r13d, 1
                jz      loc_1404288B7
                mov     eax, [rbp+var_58]
                and     esi, 0FFFFFF3Ch
                or      eax, esi
                mov     esi, [rdi+28h]
                mov     [rbp+var_58], eax
                cmp     eax, esi
                jnz     loc_140428836
                mov     byte ptr [rdi+35h], 0
                test    r14b, 5
                jnz     loc_14042884F

loc_14021F1AE:                          ; CODE XREF: sub_14021EDD0+209A83↓j
                test    esi, esi
                jnz     loc_14021F3D8

loc_14021F1B6:                          ; CODE XREF: sub_14021EDD0+619↓j
                test    r14b, 83h
                jz      short loc_14021F226
                mov     rcx, [rbp+arg_8]
                mov     rax, [rcx+8]
                mov     [rdi+970h], rax
                mov     rax, [rcx+10h]
                mov     [rdi+978h], rax
                mov     rax, [rcx+18h]
                mov     [rdi+980h], rax
                mov     rax, [rcx+20h]
                mov     [rdi+988h], rax
                mov     rax, [rcx+28h]
                mov     [rdi+990h], rax
                mov     rax, [rcx+30h]
                mov     [rdi+998h], rax
                mov     rax, [rcx+38h]
                mov     [rdi+9A0h], rax
                mov     rcx, [rcx+40h]
                mov     [rdi+9A8h], rcx
                add     rcx, [rdi+9A0h]
                mov     [rdi+968h], rcx

loc_14021F226:                          ; CODE XREF: sub_14021EDD0+3EA↑j
                lea     rcx, [rbp+var_48]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rbp+var_38]
                test    eax, eax
                jnz     loc_140428858

loc_14021F241:                          ; CODE XREF: sub_14021EDD0+209A8A↓j
                                        ; sub_14021EDD0+209A96↓j ...
                mov     cr8, rbx
                mov     rcx, r15
                call    sub_140209ED4
                mov     r13, [rsp+80h+var_20]
                mov     r12, [rsp+80h+var_18]
                mov     r14, [rsp+80h+var_28]
                mov     rsi, [rsp+80h+var_8]
                mov     rdi, [rsp+80h+var_10]

loc_14021F266:                          ; CODE XREF: sub_14021EDD0+3A↑j
                                        ; DATA XREF: .pdata:00000001400CAAB8↑o ...
                add     rsp, 80h
                pop     r15
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14021F273:                          ; CODE XREF: sub_14021EDD0+9A↑j
                                        ; DATA XREF: .pdata:00000001400CAAC4↑o ...
                inc     dword ptr [rdi+54h]
                jmp     loc_14021EE70
; ---------------------------------------------------------------------------
                align 20h

loc_14021F280:                          ; CODE XREF: sub_14021EDD0+398↑j
                                        ; sub_14021EDD0+59E↓j
                                        ; DATA XREF: ...
                mov     rcx, rbx
                test    rbx, rbx
                jnz     loc_14021F341
                mov     r11, [rbp+arg_8]
                xor     r9d, r9d
                jmp     loc_14021F16E
; ---------------------------------------------------------------------------

loc_14021F298:                          ; CODE XREF: sub_14021EDD0+B6↑j
                cmp     word ptr [rdi+92Ah], 0Ah
                ja      loc_14042855E

loc_14021F2A6:                          ; CODE XREF: sub_14021EDD0+20979A↓j
                lea     rdx, [rbp+var_48]
                lea     rcx, qword_140C4ECC0
                call    KeAcquireInStackQueuedSpinLock
                cmp     byte ptr [rdi+36h], 1
                jnz     loc_14021EE9C
                lea     r8, [r15+1AC8h]
                mov     [rdi+36h], bl
                mov     rcx, [r8]
                cmp     rcx, r8
                jz      loc_14021EE9C
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_14021F2E0:                          ; CODE XREF: sub_14021EDD0+527↓j
                mov     rax, [rdi+38h]
                mov     rdx, rcx
                mov     rcx, [rcx]
                cmp     [rdx+48h], rax
                jnb     loc_14021F3A3

loc_14021F2F4:                          ; CODE XREF: sub_14021EDD0+603↓j
                cmp     rcx, r8
                jnz     short loc_14021F2E0
                jmp     loc_14021EE9C
; ---------------------------------------------------------------------------

loc_14021F2FE:                          ; CODE XREF: sub_14021EDD0+2A1↑j
                mov     rax, [rbp+var_50]
                mov     edx, r9d
                mov     rax, [rax+38h]
                cmp     [rdi+60h], rax
                jb      loc_14021F077
                cmp     qword ptr [rdi+68h], 0
                jz      loc_14021F07C
                jmp     loc_14021F077
; ---------------------------------------------------------------------------

loc_14021F323:                          ; CODE XREF: sub_14021EDD0+2BC↑j
                or      cl, 6
                mov     [rdi+20h], rbx
                mov     byte ptr [rbp+arg_18+1], cl
                lea     rbx, [rdi+20h]
                movzx   eax, word ptr [rbp+arg_18]
                mov     [rdi+0B8h], ax
                jmp     loc_14021F0E6
; ---------------------------------------------------------------------------

loc_14021F341:                          ; CODE XREF: sub_14021EDD0+4B6↑j
                mov     eax, [rcx+98h]
                add     rcx, 0FFFFFFFFFFFFFFE0h
                mov     rbx, [rbx]
                mov     edx, 1
                mov     [rbp+arg_18], eax
                shr     eax, 8
                and     al, 0F9h
                mov     byte ptr [rbp+arg_18+1], al
                movzx   eax, word ptr [rbp+arg_18]
                mov     [rcx+0B8h], ax
                call    sub_1402B5A08
                jmp     loc_14021F280
; ---------------------------------------------------------------------------

loc_14021F373:                          ; CODE XREF: sub_14021EDD0+1E1↑j
                lea     rcx, [rbp+var_48]
                call    sub_140313680
                mov     r11, [rbp+arg_8]
                xor     r9d, r9d

loc_14021F383:                          ; CODE XREF: sub_14021EDD0+1C7↑j
                mov     qword ptr [rbp+var_48], r9
                lock xor qword ptr [rax+8], 1
                jmp     loc_14021EFB7
; ---------------------------------------------------------------------------

loc_14021F392:                          ; CODE XREF: sub_14021EDD0+298↑j
                lea     rcx, [rbp+var_48]
                call    sub_14025FC20

loc_14021F39B:                          ; CODE XREF: sub_14021EDD0+209A30↓j
                xor     r9d, r9d
                jmp     loc_14021F06E
; ---------------------------------------------------------------------------

loc_14021F3A3:                          ; CODE XREF: sub_14021EDD0+51E↑j
                mov     r9, [rdx]
                mov     rax, [rdx+8]
                cmp     [r9+8], rdx
                jnz     short loc_14021F40F
                cmp     [rax], rdx
                jnz     short loc_14021F40F
                mov     [rax], r9
                mov     [r9+8], rax
                mov     rax, [r8]
                cmp     [rax+8], r8
                jnz     short loc_14021F40F
                mov     [rdx], rax
                mov     [rdx+8], r8
                mov     [rax+8], rdx
                mov     [r8], rdx
                jmp     loc_14021F2F4
; ---------------------------------------------------------------------------

loc_14021F3D8:                          ; CODE XREF: sub_14021EDD0+3E0↑j
                xor     r8d, r8d
                mov     [rdi+28h], r9d
                xor     edx, edx
                mov     rcx, rdi
                call    KeSetEvent
                jmp     loc_14021F1B6
; ---------------------------------------------------------------------------

loc_14021F3EE:                          ; CODE XREF: sub_14021EDD0+180↑j
                test    byte ptr [rdi+0B8h], 7
                jnz     loc_14021EF56
                jmp     loc_140428592
; ---------------------------------------------------------------------------

loc_14021F400:                          ; CODE XREF: sub_14021EDD0+310↑j
                mov     edx, 1
                call    sub_1402FDDC0
                jmp     loc_14021F0E6
; ---------------------------------------------------------------------------

loc_14021F40F:                          ; CODE XREF: sub_14021EDD0+134↑j
                                        ; sub_14021EDD0+13E↑j ...
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
sub_14021EDD0   endp

; ---------------------------------------------------------------------------
algn_14021F416:                         ; DATA XREF: .pdata:00000001400CAADC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14021F420   proc near               ; CODE XREF: sub_14021EDD0+222↑p
                                        ; DATA XREF: .rdata:0000000140009110↑o ...

var_C8          = qword ptr -0C8h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = xmmword ptr -0A0h
var_90          = qword ptr -90h
var_88          = dword ptr -88h
var_80          = qword ptr -80h
var_78          = xmmword ptr -78h
var_68          = xmmword ptr -68h
var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140428948 SIZE 000005CD BYTES

; __unwind { // __GSHandlerCheck
                push    rbx
                push    r13
                push    r14
                push    r15
                sub     rsp, 0C8h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+0E8h+var_48], rax
                cmp     byte ptr [rcx+0BAh], 2
                mov     r14d, r8d
                mov     [rsp+0E8h+var_B8], rdx
                mov     rbx, rcx
                jz      loc_14021FBBE

loc_14021F459:                          ; CODE XREF: sub_14021F420+7A5↓j
                                        ; sub_14021F420+7B0↓j
                mov     rax, cs:qword_140C4E4C8
                xor     r15d, r15d
                movzx   ecx, word ptr [rbx+0AEh]
; } // starts at 14021F420

loc_14021F46A:                          ; DATA XREF: .rdata:000000014005243C↑o
                                        ; .rdata:000000014005244C↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+0E8h+arg_10], rbp
                mov     [rsp+0E8h+var_28], rsi
                mov     [rsp+0E8h+var_30], rdi
                lea     edx, [r15+1]
                mov     rcx, [rax+rcx*8]
                lea     r9d, [r15+2]
                movzx   eax, byte ptr [rbx+0B8h]
                lea     r11, [r15-1]
                mov     [rsp+0E8h+var_38], r12
                mov     r13, [rcx+1AC0h]
                mov     [rsp+0E8h+var_80], r13
                and     al, 7
                jnz     loc_14021FBA5
                mov     rax, gs:188h
                lea     rbp, [rbx-680h]
                cmp     [rax+220h], rbp
                jz      loc_14021F709
                xorps   xmm0, xmm0
                movups  [rsp+0E8h+var_78], xmm0
                movups  [rsp+0E8h+var_68], xmm0
                movups  [rsp+0E8h+var_58], xmm0
                mov     r8, gs:188h
                movzx   eax, byte ptr [r8+24Ah]
                test    al, al
                jnz     loc_140428948
                mov     rdi, gs:188h
                mov     eax, gs:32ACh
                test    eax, 10001h
                jnz     loc_140428B4C
                test    dword ptr [rbp+278h], 400h
                jnz     loc_140428B4C
                cmp     [rdi+0B8h], rbp
                jz      loc_140428965
                mov     r10, cr8
                mov     [rsp+0E8h+var_B0], r10
                mov     cr8, r9
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140428972

loc_14021F557:                          ; CODE XREF: sub_14021F420+209554↓j
                                        ; sub_14021F420+20955E↓j ...
                mov     rsi, gs:20h
                mov     [rsp+0E8h+var_88], r15d
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_1404289B3

loc_14021F575:                          ; CODE XREF: sub_14021F420+8C2↓j
                                        ; sub_14021F420+209597↓j ...
                lock bts qword ptr [rdi+40h], 0
                jb      loc_14021FCB5
                cmp     [rdi+24Ah], r15b
                jnz     loc_140428A1C
                lea     rdx, [rdi+98h]
                mov     rax, [rdx+20h]
                lea     rsi, [rdi+258h]
                mov     [rsi+20h], rax
                movzx   eax, byte ptr [rdx+28h]
                mov     [rsi+28h], al
                movzx   eax, byte ptr [rdx+29h]
                mov     [rsi+29h], al
                movzx   eax, byte ptr [rdx+2Ah]
                mov     [rsi+2Ah], al
                mov     rcx, [rdx]
                cmp     rcx, rdx
                jnz     loc_140428A43
                mov     [rsi+8], rsi
                mov     [rsi], rsi
                mov     [rsi+29h], r15b

loc_14021F5D1:                          ; CODE XREF: sub_14021F420+209635↓j
                mov     r8, [rdx+10h]
                lea     rax, [rdx+10h]
                cmp     r8, rax
                lea     rax, [rsi+10h]
                jnz     loc_140428A5A
                mov     [rax+8], rax
                mov     [rax], rax
                mov     [rsi+2Ah], r15b

loc_14021F5F1:                          ; CODE XREF: sub_14021F420+20964C↓j
                lea     rax, [rdi+0A8h]
                mov     [rdx+8], rdx
                mov     [rax+8], rax
                mov     [rax], rax
                mov     [rdx], rdx
                or      dword ptr [rdi+74h], 800h
                mov     byte ptr [rdi+24Ah], 1
                mov     [rdi+0C0h], r15w
                mov     [rdi+0C2h], r15b
                mov     [rdi+0B8h], rbp
                mov     [rdi+40h], r15
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140428A71

loc_14021F647:                          ; CODE XREF: sub_14021F420+209655↓j
                                        ; sub_14021F420+209664↓j ...
                mov     rcx, gs:20h
                mov     rdx, [rsi+20h]
                mov     [rsp+0E8h+var_A8], rdx
                movzx   eax, byte ptr [rcx+0D0h]
                movzx   r13d, byte ptr [rcx+0D1h]
                lea     r12, ds:178h[rax*8]
                lock bts [r12+rbp], r13
                cmp     cs:byte_140E01840, r15b
                mov     rsi, [rbp+28h]
                jz      short loc_14021F6B3
                mov     rax, rsi
                test    sil, 2
                jz      short loc_14021F699
                mov     rcx, 8000000000000000h
                or      rax, rcx

loc_14021F699:                          ; CODE XREF: sub_14021F420+26A↑j
                mov     gs:9000h, rax
                movzx   ecx, byte ptr [rbp+390h]
                call    sub_14021EC00
                mov     rdx, [rsp+0E8h+var_A8]

loc_14021F6B3:                          ; CODE XREF: sub_14021F420+261↑j
                mov     eax, cs:dword_140CFC41C
                test    al, 1
                jnz     loc_140428A95
                mov     cr3, rsi

loc_14021F6C4:                          ; CODE XREF: sub_14021F420+209682↓j
                cmp     cs:byte_140CFC409, r15b
                jz      loc_140428AA7

loc_14021F6D1:                          ; CODE XREF: sub_14021F420+20968E↓j
                                        ; sub_14021F420+2096AE↓j ...
                lock btr [r12+rdx], r13
                and     dword ptr [rdi+74h], 0FFFFF7FFh
                mov     eax, cs:dword_140CFC660
                mov     r10, [rsp+0E8h+var_B0]
                test    eax, eax
                jnz     loc_140428ADE

loc_14021F6F1:                          ; CODE XREF: sub_14021F420+2096C0↓j
                                        ; sub_14021F420+2096CC↓j ...
                movzx   eax, r10b
                mov     cr8, rax
                mov     r13, [rsp+0E8h+var_80]

loc_14021F6FE:                          ; CODE XREF: sub_14021F420+799↓j
                                        ; sub_14021F420+20961E↓j
                mov     r11, 0FFFFFFFFFFFFFFFFh
                lea     r9d, [r11+3]

loc_14021F709:                          ; CODE XREF: sub_14021F420+AC↑j
                                        ; sub_14021F420+787↓j ...
                test    r14b, 4
                jnz     loc_140428B7B

loc_14021F713:                          ; CODE XREF: sub_14021F420+209776↓j
                movzx   eax, byte ptr [rbx+0B8h]
                lea     rsi, unk_140C4F600
                and     al, 7
                cmp     al, 6
                jnb     loc_140428B9B
                cmp     al, 2
                jz      loc_14021FBE3
                lea     rdi, [rbx+0C0h]

loc_14021F73A:                          ; CODE XREF: sub_14021F420+7C6↓j
                mov     r12, cr8
                mov     cr8, r9
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140428BFD

loc_14021F750:                          ; CODE XREF: sub_14021F420+2097DF↓j
                                        ; sub_14021F420+2097E9↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140428C44
                mov     rbp, gs:20h
                mov     rcx, [rbp+84B8h]
                test    rcx, rcx
                jnz     loc_140428C56

loc_14021F776:                          ; CODE XREF: sub_14021F420+20983A↓j
                                        ; sub_14021F420+209849↓j ...
                prefetchw byte ptr [rdi]
                mov     eax, [rdi]
                btr     eax, 1Fh
                lea     edx, [rax+1]
                lock cmpxchg [rdi], edx
                jnz     loc_14021FC4F

loc_14021F78C:                          ; CODE XREF: sub_14021F420+84B↓j
                cmp     [rdi+4], r15d
                jnz     loc_140428C82

loc_14021F796:                          ; CODE XREF: sub_14021F420+209868↓j
                mov     [rsp+0E8h+var_B0], r12

loc_14021F79B:                          ; CODE XREF: sub_14021F420+209790↓j
                                        ; sub_14021F420+209798↓j ...
                test    r14b, 20h
                jnz     loc_140428C8D

loc_14021F7A5:                          ; CODE XREF: sub_14021F420+209874↓j
                                        ; sub_14021F420+209896↓j
                bt      r14d, 8
                jb      loc_140428CBB

loc_14021F7B0:                          ; CODE XREF: sub_14021F420+2098BA↓j
                movzx   r13d, word ptr [r13+92Ah]
                mov     ebp, r15d
                mov     edi, r15d
                test    r14b, 1
                jnz     loc_140428CDF
                test    r14b, 2
                jz      loc_14021FB36
                mov     ebp, 1
                mov     r9d, r13d
                mov     r8d, ebp
                movzx   edx, r12b
                mov     rcx, rbx
                call    sub_14021FD10
                mov     edi, eax
                test    eax, eax
                jnz     short loc_14021F819
                mov     rax, [rsp+0E8h+var_80]
                cmp     [rax+37h], bpl
                jnz     short loc_14021F819
                lea     eax, [r13-1]
                cmp     eax, 8
                ja      short loc_14021F819
                lea     r9d, [rbp+9]
                movzx   edx, r12b
                lea     r8d, [rbp+1]
                mov     rcx, rbx
                call    sub_14021FD10
                mov     edi, eax

loc_14021F819:                          ; CODE XREF: sub_14021F420+3CD↑j
                                        ; sub_14021F420+3D8↑j ...
                mov     rdx, [rsp+0E8h+var_B8]
                mov     r13, rbp

loc_14021F821:                          ; CODE XREF: sub_14021F420+74E↓j
                                        ; sub_14021F420+7F5↓j ...
                mov     r12, r15
                cmp     edi, 1
                jz      loc_140428DF8
                cmp     ebp, 1
                jnz     short loc_14021F89A
                cmp     byte ptr [rbx+0BAh], 2
                mov     ecx, 3
                mov     rax, [rbx+28h]
                cmovnz  ecx, r13d
                shr     rax, cl
                add     [rdx+8], rax
                mov     rax, [rbx+30h]
                shr     rax, cl
                add     [rdx+10h], rax
                mov     rax, [rbx+38h]
                shr     rax, cl
                add     [rdx+18h], rax
                mov     rax, [rbx+40h]
                shr     rax, cl
                add     [rdx+20h], rax
                mov     rax, [rbx+48h]
                shr     rax, cl
                add     [rdx+28h], rax
                mov     rax, [rbx+50h]
                shr     rax, cl
                add     [rdx+30h], rax
                mov     rax, [rbx+58h]
                shr     rax, cl
                add     [rdx+38h], rax
                mov     rax, [rbx+60h]
                shr     rax, cl
                add     [rdx+40h], rax

loc_14021F89A:                          ; CODE XREF: sub_14021F420+410↑j
                test    r14b, 10h
                jnz     loc_14021FC1A
                test    r14b, 8
                jnz     loc_14021FC1A
                mov     r13, [rsp+0E8h+var_B0]

loc_14021F8B3:                          ; CODE XREF: sub_14021F420+80E↓j
                xor     eax, eax
                mov     r12, 0FFFFF78000000320h
                xorps   xmm0, xmm0
                mov     r12, [r12]
                movzx   ecx, byte ptr [rbx+0B8h]
                and     cl, 7
                mov     [rsp+0E8h+var_90], rax
                lea     rax, [rbx+0C0h]
                movups  [rsp+0E8h+var_A0], xmm0
                cmp     cl, 2
                jz      loc_14021FBEB
                mov     rbp, rax

loc_14021F8ED:                          ; CODE XREF: sub_14021F420+7CE↓j
                cmp     [rbp+28h], r15
                jz      loc_14021F9CA
                cmp     cl, 2
                mov     qword ptr [rsp+0E8h+var_A0], r15
                cmovz   rax, rsi
                lea     rcx, [rax+40h]
                mov     qword ptr [rsp+0E8h+var_A0+8], rcx
                mov     rdx, gs:20h
                mov     [rsp+0E8h+var_A8], rcx
                mov     r8, [rdx+84B8h]
                test    r8, r8
                jnz     loc_140428D7C

loc_14021F92A:                          ; CODE XREF: sub_14021F420+209960↓j
                                        ; sub_14021F420+209971↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140428DA9
                lea     rdx, [rsp+0E8h+var_A0]
                xchg    rdx, [rcx]
                test    rdx, rdx
                jnz     loc_14021FC40

loc_14021F948:                          ; CODE XREF: sub_14021F420+82A↓j
                                        ; sub_14021F420+209997↓j
                mov     rcx, [rbp+28h]
                test    rcx, rcx
                jz      short loc_14021F974
                mov     rax, [rcx]
                mov     rdx, rcx
                test    rax, rax
                jnz     loc_14021FB80

loc_14021F960:                          ; CODE XREF: sub_14021F420+769↓j
                mov     rax, r12
                sub     rax, [rdx+10h]
                cmp     rax, cs:qword_140CEC080
                ja      loc_14021FBD5

loc_14021F974:                          ; CODE XREF: sub_14021F420+52F↑j
                                        ; sub_14021F420+7BE↓j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_140428DBC
                prefetchw byte ptr [rsp+0E8h+var_A0]
                mov     rax, qword ptr [rsp+0E8h+var_A0]
                test    rax, rax
                jnz     loc_14021FC8E
                mov     rcx, qword ptr [rsp+0E8h+var_A0+8]
                lea     rax, [rsp+0E8h+var_A0]
                lock cmpxchg [rcx], r15
                lea     rcx, [rsp+0E8h+var_A0]
                cmp     rax, rcx
                jnz     loc_14021FC84

loc_14021F9B1:                          ; CODE XREF: sub_14021F420+879↓j
                                        ; sub_14021F420+2099AF↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140428DD4

loc_14021F9CA:                          ; CODE XREF: sub_14021F420+4D1↑j
                                        ; sub_14021F420+2099B8↓j ...
                movzx   eax, byte ptr [rbx+0B8h]
                and     al, 7
                cmp     al, 6
                jnb     loc_14021FC70
                mov     ecx, [rbx+0B8h]
                mov     eax, ecx
                shr     eax, 18h
                test    al, 8
                jnz     loc_140428E4D
                test    al, 4
                jnz     loc_140428E4D
                test    al, 10h
                jnz     loc_140428E4D

loc_14021F9FE:                          ; CODE XREF: sub_14021F420+209A40↓j
                and     cl, 7
                cmp     cl, 2
                jz      short loc_14021FA0D
                lea     rsi, [rbx+0C0h]

loc_14021FA0D:                          ; CODE XREF: sub_14021F420+5E4↑j
                mov     ebp, 1
                mov     rcx, rbx
                mov     edx, ebp
                call    sub_140226A50
                test    byte ptr cs:xmmword_140CFC480+6, bpl
                jnz     loc_140428E65
                lock and dword ptr [rsi], 0BFFFFFFFh
                lock dec dword ptr [rsi]

loc_14021FA33:                          ; CODE XREF: sub_14021F420+209A56↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140428E7B

loc_14021FA4C:                          ; CODE XREF: sub_14021F420+209A5F↓j
                                        ; sub_14021F420+209A6D↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140428E9E

loc_14021FA5A:                          ; CODE XREF: sub_14021F420+85F↓j
                                        ; sub_14021F420+209A81↓j ...
                movzx   eax, r13b
                mov     cr8, rax
                movzx   eax, byte ptr [rbx+0B8h]
                and     al, 7
                jnz     loc_14021FB91
                mov     rax, gs:188h
                add     rbx, 0FFFFFFFFFFFFF980h
                cmp     [rax+220h], rbx
                jz      short loc_14021FAA1
                mov     rcx, gs:188h
                mov     edx, ebp
                add     rcx, 258h
                call    sub_14021E830

loc_14021FAA1:                          ; CODE XREF: sub_14021F420+668↑j
                                        ; sub_14021F420+773↓j ...
                test    edi, edi
                jnz     short loc_14021FAF4
                cmp     cs:qword_140C4E680, r15
                jz      short loc_14021FAF4
                xchg    r15, cs:qword_140C4E680
                test    r15, r15
                jz      short loc_14021FAF4
                sub     r12, [r15+10h]
                cmp     r12, cs:qword_140CEC080
                ja      loc_14021FC33
                test    r14b, 18h
                jnz     loc_14021FC33
                cmp     cs:qword_140C4E680, 0
                jnz     loc_14021FCED
                xor     eax, eax
                lock cmpxchg cs:qword_140C4E680, r15
                jnz     loc_14021FCED

loc_14021FAF4:                          ; CODE XREF: sub_14021F420+683↑j
                                        ; sub_14021F420+68C↑j ...
                mov     r12, [rsp+0E8h+var_38]
                mov     eax, edi
                mov     rdi, [rsp+0E8h+var_30]
                mov     rsi, [rsp+0E8h+var_28]
                mov     rbp, [rsp+0E8h+arg_10]
                mov     rcx, [rsp+0E8h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 0C8h
                pop     r15
                pop     r14
                pop     r13
                pop     rbx
                retn
; } // starts at 14021F46A
; ---------------------------------------------------------------------------
; __unwind { // __GSHandlerCheck
algn_14021FB35:                         ; DATA XREF: .pdata:00000001400CAAF4↑o
                                        ; .pdata:00000001400CAB00↑o
                align 2
; } // starts at 14021FB35

loc_14021FB36:                          ; CODE XREF: sub_14021F420+3AC↑j
                                        ; DATA XREF: .pdata:00000001400CAB00↑o ...
                test    r14b, 40h
                jnz     loc_14021FBF3
                test    r14b, r14b
                jns     loc_140428D6C
                mov     r8d, 2

loc_14021FB4F:                          ; CODE XREF: sub_14021F420+209947↓j
                mov     r9d, r13d
                movzx   edx, r12b
                mov     rcx, rbx
                call    sub_14021FD10
                mov     rdx, [rsp+0E8h+var_B8]
                mov     r13d, 1
                mov     ebp, r13d
                mov     edi, eax
                jmp     loc_14021F821
; ---------------------------------------------------------------------------
                align 20h

loc_14021FB80:                          ; CODE XREF: sub_14021F420+53A↑j
                                        ; sub_14021F420+76F↓j
                mov     rdx, rax
                mov     rax, [rax]
                test    rax, rax
                jz      loc_14021F960
                jmp     short loc_14021FB80
; ---------------------------------------------------------------------------

loc_14021FB91:                          ; CODE XREF: sub_14021F420+64B↑j
                cmp     al, 1
                jnz     loc_14021FAA1
                mov     ecx, ebp
                call    sub_14034AF28
                jmp     loc_14021FAA1
; ---------------------------------------------------------------------------

loc_14021FBA5:                          ; CODE XREF: sub_14021F420+8F↑j
                cmp     al, dl
                jnz     loc_14021F709
                lea     rcx, [rbx-100h]
                call    sub_14031F9F0
                jmp     loc_14021F6FE
; ---------------------------------------------------------------------------

loc_14021FBBE:                          ; CODE XREF: sub_14021F420+33↑j
                                        ; DATA XREF: .pdata:00000001400CAB0C↑o ...
; __unwind { // __GSHandlerCheck
                test    byte ptr [rcx+0B8h], 7
                jnz     loc_14021F459
                call    sub_14020875C
                jmp     loc_14021F459
; } // starts at 14021FBBE
; ---------------------------------------------------------------------------

loc_14021FBD5:                          ; CODE XREF: sub_14021F420+54E↑j
                                        ; DATA XREF: .pdata:00000001400CAB18↑o ...
; __unwind { // __GSHandlerCheck
                call    sub_1402A9060
                mov     [rbp+28h], r15
                jmp     loc_14021F974
; ---------------------------------------------------------------------------

loc_14021FBE3:                          ; CODE XREF: sub_14021F420+30D↑j
                mov     rdi, rsi
                jmp     loc_14021F73A
; ---------------------------------------------------------------------------

loc_14021FBEB:                          ; CODE XREF: sub_14021F420+4C4↑j
                mov     rbp, rsi
                jmp     loc_14021F8ED
; ---------------------------------------------------------------------------

loc_14021FBF3:                          ; CODE XREF: sub_14021F420+71A↑j
                mov     r9d, r13d
                movzx   edx, r12b
                mov     r13d, 1
                mov     rcx, rbx
                mov     r8d, r13d
                call    sub_14021FD10
                mov     rdx, [rsp+0E8h+var_B8]
                mov     edi, eax
                mov     ebp, r13d
                jmp     loc_14021F821
; ---------------------------------------------------------------------------

loc_14021FC1A:                          ; CODE XREF: sub_14021F420+47E↑j
                                        ; sub_14021F420+488↑j
                mov     r13, [rsp+0E8h+var_B0]
                mov     r8d, r14d
                movzx   edx, r13b
                mov     rcx, rbx
                call    sub_1403A092C
                jmp     loc_14021F8B3
; ---------------------------------------------------------------------------

loc_14021FC33:                          ; CODE XREF: sub_14021F420+6A5↑j
                                        ; sub_14021F420+6AF↑j
                mov     rcx, r15

loc_14021FC36:                          ; CODE XREF: sub_14021F420+8D8↓j
                call    sub_1402A941C
                jmp     loc_14021FAF4
; ---------------------------------------------------------------------------

loc_14021FC40:                          ; CODE XREF: sub_14021F420+522↑j
                lea     rcx, [rsp+0E8h+var_A0]
                call    sub_14025FC20
                jmp     loc_14021F948
; ---------------------------------------------------------------------------

loc_14021FC4F:                          ; CODE XREF: sub_14021F420+366↑j
                xor     edx, edx
                mov     rcx, rbp
                call    sub_140245F90
                movzx   edx, r12b
                mov     rcx, rdi
                call    sub_140329420

loc_14021FC65:                          ; CODE XREF: sub_14021F420+209831↓j
                mov     r9d, 2
                jmp     loc_14021F78C
; ---------------------------------------------------------------------------

loc_14021FC70:                          ; CODE XREF: sub_14021F420+5B5↑j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     short loc_14021FC9E

loc_14021FC7A:                          ; CODE XREF: sub_14021F420+880↓j
                                        ; sub_14021F420+888↓j ...
                mov     ebp, 1
                jmp     loc_14021FA5A
; ---------------------------------------------------------------------------

loc_14021FC84:                          ; CODE XREF: sub_14021F420+58B↑j
                lea     rcx, [rsp+0E8h+var_A0]
                call    sub_140313680

loc_14021FC8E:                          ; CODE XREF: sub_14021F420+56E↑j
                mov     qword ptr [rsp+0E8h+var_A0], r15
                lock xor qword ptr [rax+8], 1
                jmp     loc_14021F9B1
; ---------------------------------------------------------------------------

loc_14021FC9E:                          ; CODE XREF: sub_14021F420+858↑j
                test    al, 1
                jz      short loc_14021FC7A
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14021FC7A
                cmp     r13b, 0Fh
                ja      short loc_14021FC7A
                jmp     loc_140428E02
; ---------------------------------------------------------------------------

loc_14021FCB5:                          ; CODE XREF: sub_14021F420+15C↑j
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_1404289DA

loc_14021FCC5:                          ; CODE XREF: sub_14021F420+8B6↓j
                                        ; sub_14021F420+2095BE↓j ...
                lea     rcx, [rsp+0E8h+var_88]
                call    sub_1402C8C70
                mov     rax, [rdi+40h]
                test    rax, rax
                jnz     short loc_14021FCC5
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jz      loc_14021F575
                jmp     loc_140428A01
; ---------------------------------------------------------------------------

loc_14021FCED:                          ; CODE XREF: sub_14021F420+6BD↑j
                                        ; sub_14021F420+6CE↑j
                lea     rax, [r15+48h]
                mov     rcx, r15
                cmp     [r15+20h], rax
                jnz     loc_14021FC36
                jmp     loc_140428F08
; } // starts at 14021FBD5
sub_14021F420   endp

; ---------------------------------------------------------------------------
algn_14021FD03:                         ; DATA XREF: .pdata:00000001400CAB24↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14021FD10   proc near               ; CODE XREF: sub_14021F420+3C4↑p
                                        ; sub_14021F420+3F2↑p ...

var_4E8         = qword ptr -4E8h
var_4E0         = qword ptr -4E0h
var_4D8         = dword ptr -4D8h
var_4D0         = qword ptr -4D0h
var_4C8         = byte ptr -4C8h
var_4C7         = byte ptr -4C7h
var_4C0         = qword ptr -4C0h
var_4B8         = qword ptr -4B8h
var_4B0         = qword ptr -4B0h
var_4A8         = qword ptr -4A8h
var_4A0         = dword ptr -4A0h
var_49C         = dword ptr -49Ch
var_498         = dword ptr -498h
var_490         = qword ptr -490h
var_488         = qword ptr -488h
var_480         = qword ptr -480h
var_478         = qword ptr -478h
var_468         = dword ptr -468h
var_464         = byte ptr -464h
var_463         = byte ptr -463h
var_460         = dword ptr -460h
var_45C         = dword ptr -45Ch
var_458         = qword ptr -458h
var_450         = qword ptr -450h
var_448         = qword ptr -448h
var_440         = qword ptr -440h
var_438         = qword ptr -438h
var_430         = qword ptr -430h
var_428         = dword ptr -428h
var_424         = word ptr -424h
var_420         = qword ptr -420h
var_418         = qword ptr -418h
var_410         = qword ptr -410h
var_370         = qword ptr -370h
var_368         = word ptr -368h
var_362         = byte ptr -362h
var_350         = qword ptr -350h
var_340         = qword ptr -340h
var_330         = qword ptr -330h
var_2D0         = qword ptr -2D0h
var_2C8         = qword ptr -2C8h
var_2C0         = qword ptr -2C0h
var_2B8         = byte ptr -2B8h
var_1F8         = byte ptr -1F8h
var_1F4         = dword ptr -1F4h
var_E8          = byte ptr -0E8h
var_C8          = qword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = byte ptr -0B8h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
var_10          = qword ptr -10h
var_8           = qword ptr -8

; FUNCTION CHUNK AT 0000000140428F16 SIZE 000002AA BYTES

; __unwind { // __GSHandlerCheck
                mov     r11, rsp
                sub     rsp, 508h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+508h+var_48], rax
; } // starts at 14021FD10

loc_14021FD2C:                          ; DATA XREF: .rdata:00000001400524F0↑o
                                        ; .rdata:0000000140052504↑o ...
; __unwind { // __GSHandlerCheck
                mov     [r11-10h], rsi
                mov     esi, r9d
                mov     [r11-18h], rdi
                mov     rdi, rcx
                mov     [r11-20h], r12
                lea     rcx, [r11-2B8h]
                mov     r12d, r8d
                mov     [rsp+508h+var_4C8], dl
                mov     [r11-30h], r14
                mov     r8d, 0B8h
                xor     edx, edx
                mov     [r11-38h], r15
                call    memset
                xor     edx, edx
                lea     rcx, [rsp+508h+var_468]
                mov     r8d, 100h
                call    memset
                xor     edx, edx
                lea     rcx, [rsp+508h+var_368]
                mov     r8d, 0B0h
                call    memset
                xor     edx, edx
                lea     rcx, [rsp+508h+var_1F8]
                mov     r8d, 108h
                call    memset
                mov     r8, [rdi+10h]
                mov     r15d, 3
                mov     r14, [rdi+88h]
                xor     r9d, r9d
                mov     [rsp+508h+var_4C0], r8
                mov     rax, [r8+20h]
                lea     r11d, [r15-2]
                cmp     r14, rax
                jbe     loc_140220111
                sub     r14, rax
; } // starts at 14021FD2C

loc_14021FDCD:                          ; DATA XREF: .rdata:0000000140052504↑o
                                        ; .rdata:0000000140052518↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+508h+var_8], rbx
                test    esi, esi
; } // starts at 14021FDCD

loc_14021FDD7:                          ; DATA XREF: .rdata:0000000140052518↑o
                                        ; .rdata:0000000140052528↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+508h+var_28], r13
                mov     ebx, 0Ah
                mov     eax, r12d
                cmovnz  ebx, esi
                and     eax, 4
                mov     [rsp+508h+var_4A0], eax
                jnz     loc_1402202A8
                movzx   eax, byte ptr [rdi+0B8h]
                and     al, 7
                mov     [rsp+508h+var_4A8], r9
                cmp     al, 2
                jz      loc_140220268
                lea     rsi, [rdi+100h]

loc_14021FE14:                          ; CODE XREF: sub_14021FD10+55F↓j
                mov     [rsp+508h+var_4B0], rsi
                mov     [rsp+508h+var_4B8], r9
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140428F16

loc_14021FE37:                          ; CODE XREF: sub_14021FD10+20920A↓j
                                        ; sub_14021FD10+209219↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140428F41
                lea     rdx, [rsp+508h+var_4B8]
                xchg    rdx, [rsi]
                test    rdx, rdx
                jnz     loc_140220274

loc_14021FE55:                          ; CODE XREF: sub_14021FD10+576↓j
                xor     edx, edx
                mov     ecx, ebx
                test    r12b, 2
                jz      loc_1402201AC
                mov     r13d, [r8+18h]
                lea     rsi, [r14+r13]
                mov     rax, rsi
                div     rcx
                mov     [r8+18h], edx

loc_14021FE75:                          ; CODE XREF: sub_14021FD10+4AE↓j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_140428F54
                prefetchw byte ptr [rsp+508h+var_4B8]
                mov     rax, [rsp+508h+var_4B8]
                test    rax, rax
                jnz     loc_140220298
                mov     rcx, [rsp+508h+var_4B0]
                lea     rax, [rsp+508h+var_4B8]
                lock cmpxchg [rcx], r9
                lea     rcx, [rsp+508h+var_4B8]
                cmp     rax, rcx
                jnz     loc_14022028B

loc_14021FEB2:                          ; CODE XREF: sub_14021FD10+593↓j
                                        ; sub_14021FD10+209259↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140428F6E

loc_14021FECB:                          ; CODE XREF: sub_14021FD10+209262↓j
                                        ; sub_14021FD10+209271↓j ...
                mov     r11d, 1
                cmp     rsi, r14
                jb      loc_1402202A8

loc_14021FEDA:                          ; CODE XREF: sub_14021FD10+59B↓j
                lea     rsi, [r14+r13]
                mov     ecx, ebx
                mov     r13, [rsp+508h+var_28]
                mov     r8, 624DD2F1A9FBE77h
                imul    rsi, rcx
                mov     rax, r8
                mul     rsi
                sub     rsi, rdx
                shr     rsi, 1
                add     rsi, rdx
                shr     rsi, 9
                cmp     rsi, r14
                ja      loc_1402202B0
; } // starts at 14021FDD7

loc_14021FF12:                          ; CODE XREF: sub_14021FD10+5BA↓j
                                        ; DATA XREF: .pdata:00000001400CAB54↑o ...
; __unwind { // __GSHandlerCheck
                movzx   ecx, word ptr [rdi+0AEh]
                mov     rax, cs:qword_140C4E4C8
                mov     [rsp+508h+var_45C], ebx
                mov     rbx, r9
                mov     r8, [rax+rcx*8]
                mov     r14, [r8+1AC0h]
                test    r15b, r12b
                jz      loc_14021FFFF
                mov     rdx, [r8+900h]
                lea     rax, [r8+980h]
                add     rdx, [r8+8C0h]
                mov     rcx, r9
                add     r8, 0A48h
                cmp     rax, r8
                jnb     short loc_14021FF85
                lea     r10, [r8-28h]

loc_14021FF66:                          ; CODE XREF: sub_14021FD10+264↓j
                add     rcx, [rax]
                add     r9, [rax+28h]
                add     rax, 50h ; 'P'
                cmp     rax, r10
                jb      short loc_14021FF66
                cmp     rax, r8
                jnb     short loc_14021FF7E
                add     rdx, [rax]

loc_14021FF7E:                          ; CODE XREF: sub_14021FD10+269↑j
                lea     rax, [rcx+r9]
                add     rdx, rax

loc_14021FF85:                          ; CODE XREF: sub_14021FD10+250↑j
                mov     rcx, [r8]
                add     rcx, rdx
                cmp     rcx, [r14+48h]
                jb      loc_140428F94

loc_14021FF95:                          ; CODE XREF: sub_14021FD10+2092B9↓j
                                        ; sub_14021FD10+2092DD↓j
                cmp     rsi, 100h
                ja      loc_14022020A

loc_14021FFA2:                          ; CODE XREF: sub_14021FD10+539↓j
                xor     eax, eax
                lock cmpxchg [r14+7Ch], r11d
                jnz     loc_140428FF2
                lea     rbx, [r14+80h]
                mov     r15d, 100h

loc_14021FFBD:                          ; CODE XREF: sub_14021FD10+533↓j
                                        ; sub_14021FD10+2092F0↓j
                movzx   eax, byte ptr [rdi+0B8h]
                and     al, 7
                jnz     loc_1402201C3
                mov     eax, r11d

loc_14021FFCF:                          ; CODE XREF: sub_14021FD10+4BA↓j
                xor     r9d, r9d
                mov     [rbx], eax
                mov     [rbx+0Ch], r9d
                mov     [rbx+4], r9w
                mov     [rbx+10h], r9
                mov     [rbx+18h], r9
                mov     [rbx+8], r15d
                test    byte ptr [rdi+0B8h], 7
                jnz     short loc_14021FFFF
                cmp     [rdi+270h], r9
                jnz     loc_140429005

loc_14021FFFF:                          ; CODE XREF: sub_14021FD10+228↑j
                                        ; sub_14021FD10+2E0↑j ...
                movzx   eax, [rsp+508h+var_4C8]
                mov     [rsp+508h+var_362], al
                movzx   eax, byte ptr [rdi+0B8h]
                mov     [rsp+508h+var_350], rdi
                mov     [rsp+508h+var_468], r12d
                mov     [rsp+508h+var_438], rsi
                mov     [rsp+508h+var_430], rbx
                and     al, 7
                jnz     loc_1402201CF
                mov     eax, r11d

loc_14022003D:                          ; CODE XREF: sub_14021FD10+4C6↓j
                cmp     [rsp+508h+var_4A0], 0
                mov     [rsp+508h+var_428], eax
                lea     rax, [rsp+508h+var_468]
                mov     [rsp+508h+var_2C0], rax
                mov     eax, 0Eh
                mov     [rsp+508h+var_368], ax
                lea     rax, sub_14028BC40
                mov     [rsp+508h+var_2D0], rax
                lea     rax, sub_14031FBD0
                mov     [rsp+508h+var_2C8], rax
                mov     [rsp+508h+var_420], 14h
                mov     [rsp+508h+var_424], 4
                mov     [rsp+508h+var_418], r9
                mov     [rsp+508h+var_410], r9
                jnz     loc_140429025
                mov     rax, [rsp+508h+var_4C0]
                test    r12b, 2
                jz      loc_1402201A3
                mov     rax, [rax+10h]

loc_1402200C3:                          ; CODE XREF: sub_14021FD10+497↓j
                                        ; sub_14021FD10+209323↓j
                mov     [rsp+508h+var_330], rax
                test    rax, rax
                jz      loc_140220257

loc_1402200D4:                          ; CODE XREF: sub_14021FD10+553↓j
                lea     rcx, [rsp+508h+var_368]
                call    sub_140220490
                mov     r15d, eax
                test    rbx, rbx
                jz      short loc_1402200FF
                lea     rcx, [r14+80h]
                cmp     rbx, rcx
                jnz     loc_1402201EA
                lock and dword ptr [r14+7Ch], 0

loc_1402200FF:                          ; CODE XREF: sub_14021FD10+3D7↑j
                                        ; sub_14021FD10+4E5↓j ...
                mov     rbx, [rsp+508h+var_8]
                cmp     r15d, 4
                jz      loc_140429038
; } // starts at 14021FF12

loc_140220111:                          ; CODE XREF: sub_14021FD10+B4↑j
                                        ; sub_14021FD10+20932F↓j
                                        ; DATA XREF: ...
; __unwind { // __GSHandlerCheck
                mov     r10, cs:qword_140C4ED60
                mov     r14, [rsp+508h+var_30]
                mov     rsi, [rsp+508h+var_10]
                test    r10, r10
                jz      short loc_140220166
; } // starts at 140220111

loc_14022012D:                          ; DATA XREF: .pdata:00000001400CAB6C↑o
                                        ; .pdata:00000001400CAB78↑o
; __unwind { // __GSHandlerCheck
                movzx   edx, byte ptr [rdi+0B8h]
                and     dl, 7
                jnz     loc_1402201DB
                mov     r8d, [rdi-240h]
                add     rdi, 0FFFFFFFFFFFFFF28h

loc_14022014B:                          ; CODE XREF: sub_14021FD10+4D5↓j
                cmp     dword ptr [r10], 5
                jbe     short loc_140220166
                test    byte ptr [r10+10h], 1
                jnz     loc_140429044

loc_14022015C:                          ; CODE XREF: sub_14021FD10+209341↓j
                xor     al, al

loc_14022015E:                          ; CODE XREF: sub_14021FD10+209349↓j
                test    al, al
                jnz     loc_14042905E

loc_140220166:                          ; CODE XREF: sub_14021FD10+41B↑j
                                        ; sub_14021FD10+43F↑j ...
                mov     r12, [rsp+508h+var_20]
                cmp     r15d, 4
                mov     r15, [rsp+508h+var_38]
                mov     rdi, [rsp+508h+var_18]
                jz      loc_1404291B6
; } // starts at 14022012D

loc_140220188:                          ; DATA XREF: .pdata:00000001400CAB78↑o
                                        ; .pdata:00000001400CAB84↑o
; __unwind { // __GSHandlerCheck
                xor     eax, eax

loc_14022018A:                          ; CODE XREF: sub_14021FD10+2094AB↓j
                mov     rcx, [rsp+508h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 508h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140220188
; ---------------------------------------------------------------------------

loc_1402201A3:                          ; CODE XREF: sub_14021FD10+3A9↑j
                                        ; DATA XREF: .pdata:00000001400CAB84↑o ...
; __unwind { // __GSHandlerCheck
                mov     rax, [rax+8]
                jmp     loc_1402200C3
; } // starts at 1402201A3
; ---------------------------------------------------------------------------

loc_1402201AC:                          ; CODE XREF: sub_14021FD10+14D↑j
                                        ; DATA XREF: .pdata:00000001400CAB90↑o ...
; __unwind { // __GSHandlerCheck
                mov     r13d, [r8+1Ch]
                lea     rsi, [r14+r13]
                mov     rax, rsi
                div     rcx
                mov     [r8+1Ch], edx
                jmp     loc_14021FE75
; } // starts at 1402201AC
; ---------------------------------------------------------------------------

loc_1402201C3:                          ; CODE XREF: sub_14021FD10+2B6↑j
                                        ; DATA XREF: .pdata:00000001400CAB9C↑o ...
; __unwind { // __GSHandlerCheck
                cmp     al, 2
                sbb     eax, eax
                and     eax, 2
                jmp     loc_14021FFCF
; ---------------------------------------------------------------------------

loc_1402201CF:                          ; CODE XREF: sub_14021FD10+324↑j
                cmp     al, 2
                sbb     eax, eax
                and     eax, 2
                jmp     loc_14022003D
; } // starts at 1402201C3
; ---------------------------------------------------------------------------

loc_1402201DB:                          ; CODE XREF: sub_14021FD10+427↑j
                                        ; DATA XREF: .pdata:00000001400CABA8↑o ...
; __unwind { // __GSHandlerCheck
                cmp     dl, 2
                jb      short loc_14022024E
                xor     r8d, r8d

loc_1402201E3:                          ; CODE XREF: sub_14021FD10+545↓j
                xor     edi, edi
                jmp     loc_14022014B
; } // starts at 1402201DB
; ---------------------------------------------------------------------------

loc_1402201EA:                          ; CODE XREF: sub_14021FD10+3E3↑j
                                        ; DATA XREF: .pdata:00000001400CABB4↑o ...
; __unwind { // __GSHandlerCheck
                lea     rax, [rsp+508h+var_2B8]
                cmp     rbx, rax
                jz      loc_1402200FF
                xor     edx, edx
                mov     rcx, rbx
                call    ExFreePoolWithTag
                jmp     loc_1402200FF
; ---------------------------------------------------------------------------

loc_14022020A:                          ; CODE XREF: sub_14021FD10+28C↑j
                mov     r15d, 1FDh
                cmp     rsi, r15
                jnb     short loc_140220218
                mov     r15d, esi

loc_140220218:                          ; CODE XREF: sub_14021FD10+503↑j
                lea     eax, [r15-100h]
                mov     ecx, 40h ; '@'
                lea     rdx, ds:818h[rax*8]
                mov     r8d, 73576D4Dh
                call    sub_140268720
                mov     rbx, rax
                mov     r11d, 1
                test    rax, rax
                jnz     loc_14021FFBD
                jmp     loc_14021FFA2
; } // starts at 1402201EA
; ---------------------------------------------------------------------------

loc_14022024E:                          ; CODE XREF: sub_14021FD10+4CE↑j
                                        ; DATA XREF: .pdata:00000001400CABC0↑o ...
; __unwind { // __GSHandlerCheck
                mov     r8d, [rdi-0F8h]
                jmp     short loc_1402201E3
; } // starts at 14022024E
; ---------------------------------------------------------------------------

loc_140220257:                          ; CODE XREF: sub_14021FD10+3BE↑j
                                        ; DATA XREF: .pdata:00000001400CABCC↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+508h+var_340], 0FFFFFFFFFFFFFFFFh
                jmp     loc_1402200D4
; } // starts at 140220257
; ---------------------------------------------------------------------------

loc_140220268:                          ; CODE XREF: sub_14021FD10+F7↑j
                                        ; DATA XREF: .pdata:00000001400CABD8↑o ...
; __unwind { // __GSHandlerCheck
                lea     rsi, unk_140C4F640
                jmp     loc_14021FE14
; ---------------------------------------------------------------------------

loc_140220274:                          ; CODE XREF: sub_14021FD10+13F↑j
                lea     rcx, [rsp+508h+var_4B8]
                call    sub_14025FC20

loc_14022027E:                          ; CODE XREF: sub_14021FD10+20923F↓j
                mov     r8, [rsp+508h+var_4C0]
                xor     r9d, r9d
                jmp     loc_14021FE55
; ---------------------------------------------------------------------------

loc_14022028B:                          ; CODE XREF: sub_14021FD10+19C↑j
                lea     rcx, [rsp+508h+var_4B8]
                call    sub_140313680
                xor     r9d, r9d

loc_140220298:                          ; CODE XREF: sub_14021FD10+17F↑j
                mov     [rsp+508h+var_4B8], r9
                lock xor qword ptr [rax+8], 1
                jmp     loc_14021FEB2
; ---------------------------------------------------------------------------

loc_1402202A8:                          ; CODE XREF: sub_14021FD10+E1↑j
                                        ; sub_14021FD10+1C4↑j
                mov     r13, r9
                jmp     loc_14021FEDA
; } // starts at 140220268
; ---------------------------------------------------------------------------

loc_1402202B0:                          ; CODE XREF: sub_14021FD10+1FC↑j
                                        ; DATA XREF: .pdata:00000001400CABE4↑o ...
; __unwind { // __GSHandlerCheck
                mov     rsi, rcx
                mov     rax, r8
                imul    rsi, r14
                mul     rsi
                sub     rsi, rdx
                shr     rsi, 1
                add     rsi, rdx
                shr     rsi, 9
                jmp     loc_14021FF12
; } // starts at 1402202B0
sub_14021FD10   endp

; ---------------------------------------------------------------------------
algn_1402202CF:                         ; DATA XREF: .pdata:00000001400CABF0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402202E0   proc near               ; CODE XREF: sub_14020A35C+B↑p
                                        ; sub_140220490+F6↓p
                                        ; DATA XREF: ...

; FUNCTION CHUNK AT 00000001404291C0 SIZE 00000027 BYTES

                mov     r8d, 800h
                test    [rcx], r8w
                jnz     loc_14022039B
                mov     rax, [rcx+18h]
                mov     r8d, 1
                movzx   ecx, byte ptr [rax+0B8h]
                and     ecx, 7
                jnz     short loc_140220350
                xor     eax, eax
                mov     [rdx], rax
                mov     rax, 7FFFFFFFFFFFh
                mov     [rdx+8], rax
                mov     rax, cs:qword_140C4E1E0
                mov     [rdx+10h], rax
                mov     rcx, cs:qword_140C4E1F0
                test    rcx, rcx
                jz      loc_1404291C0

loc_140220334:                          ; CODE XREF: sub_1402202E0+208F02↓j
                mov     rax, cs:qword_140C4E1E0
                mov     r8d, 2
                dec     rax
                add     rcx, rax
                mov     [rdx+18h], rcx

loc_14022034B:                          ; CODE XREF: sub_1402202E0+16E↓j
                mov     eax, r8d
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_140220350:                          ; CODE XREF: sub_1402202E0+24↑j
                sub     ecx, r8d
                jz      short loc_1402203CE
                sub     ecx, r8d
                jz      loc_140220420
                sub     ecx, r8d
                jz      loc_1402203F5
                sub     ecx, r8d
                jnz     loc_14022044B
                mov     rax, cs:qword_140C4DF80
                mov     [rdx], rax
                mov     rcx, cs:qword_140C4DF60
                mov     rax, cs:qword_140C4DF80
                dec     rax
                shl     rcx, 15h
                add     rcx, rax
                mov     eax, r8d
                mov     [rdx+8], rcx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022039B:                          ; CODE XREF: sub_1402202E0+A↑j
                xor     eax, eax
                mov     [rdx], rax
                mov     rax, 0FFFFF68000000000h
                dec     rax
                mov     [rdx+8], rax
                mov     rax, 0FFFFF70000000000h
                mov     [rdx+10h], rax
                mov     eax, 2
                mov     qword ptr [rdx+18h], 0FFFFFFFFFFFFFFFFh
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402203CE:                          ; CODE XREF: sub_1402202E0+73↑j
                mov     rax, cs:qword_140C4DC58
                mov     rcx, 7FFFFFFFFFh
                mov     [rdx], rax
                mov     rax, cs:qword_140C4DC58
                add     rax, rcx
                mov     [rdx+8], rax
                mov     eax, r8d
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402203F5:                          ; CODE XREF: sub_1402202E0+81↑j
                mov     rax, cs:qword_140C4E010
                mov     [rdx], rax
                mov     rcx, cs:qword_140C4DFF0
                mov     rax, cs:qword_140C4E010
                dec     rax
                shl     rcx, 15h
                add     rcx, rax
                mov     eax, r8d
                mov     [rdx+8], rcx
                retn
; ---------------------------------------------------------------------------
                align 20h

loc_140220420:                          ; CODE XREF: sub_1402202E0+78↑j
                mov     rax, cs:qword_140C4E058
                mov     [rdx], rax
                mov     rcx, cs:qword_140C4E038
                mov     rax, cs:qword_140C4E058
                dec     rax
                shl     rcx, 15h
                add     rcx, rax
                mov     eax, r8d
                mov     [rdx+8], rcx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022044B:                          ; CODE XREF: sub_1402202E0+8A↑j
                cmp     ecx, 2
                jnz     loc_14022034B
                mov     rax, cs:qword_140C4DEF0
                mov     [rdx], rax
                mov     rcx, cs:qword_140C4DED0
                mov     rax, cs:qword_140C4DEF0
                dec     rax
                shl     rcx, 15h
                add     rcx, rax
                mov     eax, r8d
                mov     [rdx+8], rcx
                retn
sub_1402202E0   endp

; ---------------------------------------------------------------------------
                db 0CCh
byte_14022047F  db 11h dup(0CCh)        ; DATA XREF: .pdata:00000001400CABFC↑o

; =============== S U B R O U T I N E =======================================


sub_140220490   proc near               ; CODE XREF: sub_14020A054+1D6↑p
                                        ; sub_14021FD10+3CC↑p ...

var_D8          = qword ptr -0D8h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_40          = qword ptr -40h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 00000001404291E8 SIZE 00000134 BYTES

                mov     [rsp+arg_0], rcx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r14
                push    r15
                sub     rsp, 0C0h
                cmp     byte ptr [rcx+5], 0
                mov     rsi, rcx
                jnz     short loc_1402204B3
                mov     byte ptr [rcx+5], 0Fh

loc_1402204B3:                          ; CODE XREF: sub_140220490+1D↑j
                mov     rax, [rcx+18h]
                xor     r11d, r11d

loc_1402204BA:                          ; DATA XREF: .rdata:0000000140052794↑o
                                        ; .rdata:00000001400527A4↑o ...
                mov     [rsp+0F8h+var_40], r13
                mov     r10, 0FFFFF68000000000h
                movzx   edx, word ptr [rax+0AEh]
                mov     rax, cs:qword_140C4E4C8
                mov     rdx, [rax+rdx*8]
                mov     rax, [rcx+38h]
                mov     [rcx+48h], rdx
                mov     rcx, 0FFFFF6FB7DBEDF68h
                test    rax, rax
                jz      loc_14022088B
                mov     rcx, rcx
                cmp     rax, rcx
                jz      loc_1404291E8

loc_140220505:                          ; CODE XREF: sub_140220490+208D60↓j
                mov     r8d, 0FFFFFFFFh
                mov     rcx, r10
                cmp     rax, rcx
                jb      loc_1404291F5
                mov     r9, 0FFFFF6FFFFFFFFFFh
                mov     rcx, r9
                cmp     rax, rcx
                ja      loc_1404291F5
                mov     rdx, r10
                shl     rdx, 19h

loc_140220534:                          ; CODE XREF: sub_140220490+42C↓j
                shl     rax, 19h
                inc     r8d
                sub     rax, rdx
                sar     rax, 10h
                mov     rcx, r10
                cmp     rax, rcx
                jnb     loc_1402208B0

loc_14022054E:                          ; CODE XREF: sub_140220490+426↓j
                                        ; sub_140220490+208D6C↓j
                mov     [rsp+0F8h+var_B0], rax
                mov     r13d, 1
                mov     [rsp+0F8h+var_A8], 0FFFFFFFFFFFFFFFFh
                cmp     r8d, 0FFFFFFFFh
                jz      short loc_14022057B
                dec     rax
                mov     [rsp+0F8h+var_A0], r11
                mov     [rsp+0F8h+var_98], rax
                mov     r13d, 2

loc_14022057B:                          ; CODE XREF: sub_140220490+D6↑j
                                        ; sub_140220490+413↓j
                lea     rdx, [rsp+0F8h+var_70]
                mov     rcx, rsi
                call    sub_1402202E0
                mov     ecx, r11d
                mov     [rsp+0F8h+arg_10], eax
                lea     r12, [rsp+0F8h+var_B0]
                mov     [rsp+0F8h+arg_18], ecx
                mov     r14d, eax
                mov     [rsp+0F8h+var_D0], r12
                mov     rbx, 7FFFFFFFF8h
                mov     r9d, 400h

loc_1402205B9:                          ; CODE XREF: sub_140220490+3EE↓j
                mov     [rsp+0F8h+arg_8], r11d
                mov     edi, r11d
                test    r14d, r14d
                jz      loc_140220869
                mov     rax, [r12]
                mov     r8, [r12+8]
                mov     [rsp+0F8h+var_B8], rax
                mov     [rsp+0F8h+var_C0], r8

loc_1402205E0:                          ; CODE XREF: sub_140220490+3CC↓j
                mov     rbp, rax
                mov     eax, edi
                add     rax, rax
                mov     rdx, [rsp+rax*8+0F8h+var_68]
                cmp     rbp, rdx
                ja      loc_14022084B
                mov     rcx, [rsp+rax*8+0F8h+var_70]
                cmp     r8, rcx
                jb      loc_14022084B
                cmp     rbp, rcx
                jb      loc_1402208A8

loc_140220613:                          ; CODE XREF: sub_140220490+41B↓j
                cmp     r8, rdx
                mov     rcx, r8
                cmova   rcx, rdx
                shr     rbp, 9
                and     rbp, rbx
                mov     rax, r10
                shr     rcx, 9
                add     rbp, rax
                and     rcx, rbx
                mov     rax, r10
                mov     [rsi+50h], rbp
                add     rcx, rax
                shr     rbp, 9
                and     rbp, rbx
                mov     [rsi+58h], rcx
                mov     rax, r10
                shr     rcx, 9
                add     rbp, rax
                and     rcx, rbx
                mov     rax, r10
                mov     [rsi+60h], rbp
                add     rcx, rax
                shr     rbp, 9
                and     rbp, rbx
                mov     [rsi+68h], rcx
                mov     rax, r10
                shr     rcx, 9
                add     rbp, rax
                and     rcx, rbx
                mov     rax, r10
                mov     [rsi+70h], rbp
                add     rcx, rax
                shr     rbp, 9
                and     rbp, rbx
                mov     [rsi+78h], rcx
                mov     rax, r10
                shr     rcx, 9
                add     rbp, rax
                and     rcx, rbx
                mov     rax, r10
                add     rcx, rax
                mov     [rsi+80h], rbp
                mov     [rsi+88h], rcx
                movzx   eax, word ptr [rsi]
                mov     [rsi+40h], r11
                test    al, 4
                jz      loc_1402208C1
                mov     r15, rbp
                shr     r15, 9
                and     r15, rbx
                mov     rax, r10
                mov     r9, [rsi+18h]
                add     r15, rax
                or      byte ptr [rsi+2], 1
                mov     rcx, r15
                shl     rcx, 19h
                mov     [rsp+0F8h+var_C8], r15
                mov     [rsp+0F8h+var_D8], r9
                mov     rax, r10
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                shr     rcx, 9
                and     rcx, rbx
                mov     rax, r10
                add     rcx, rax
                mov     [rsp+0F8h+var_90], rcx
                shr     rcx, 9
                and     rcx, rbx
                mov     rax, r10
                add     rcx, rax
                mov     [rsp+0F8h+var_88], rcx
                shr     rcx, 9
                and     rcx, rbx
                mov     rax, r10
                add     rcx, rax
                mov     [rsp+0F8h+var_80], rcx
                shr     rcx, 9
                and     rcx, rbx
                mov     rax, r10
                add     rcx, rax
                mov     rax, 0FFFFF6FB7DBEDF68h
                mov     [rsp+0F8h+var_78], rcx
                mov     r14, rax
                mov     rdx, rax
                xor     r8d, r8d
                mov     rcx, r9
                call    sub_140225CC0
                mov     rsi, [rsp+0F8h+var_D8]
                mov     edi, 2
                mov     r15, 0FFFFF6FB7DBED7F8h
                mov     r12, 0FFFFF6FB7DBED000h

loc_140220775:                          ; CODE XREF: sub_140220490+326↓j
                mov     rbx, [rsp+rdi*8+0F8h+var_90]
                mov     r8, [rbx]
                mov     rax, r12
                cmp     rbx, rax
                jb      short loc_140220791
                mov     rax, r15
                cmp     rbx, rax
                jbe     loc_140429201

loc_140220791:                          ; CODE XREF: sub_140220490+2F3↑j
                                        ; sub_140220490+208D7B↓j ...
                movzx   eax, r8b
                and     al, 81h
                cmp     al, 1
                jnz     short loc_1402207B8
                test    r8b, 20h
                jz      loc_14042929D

loc_1402207A5:                          ; CODE XREF: sub_140220490+208E1C↓j
                cmp     rbx, r14
                jnz     loc_1404292B1

loc_1402207AE:                          ; CODE XREF: sub_140220490+208E3D↓j
                test    rdi, rdi
                jz      short loc_1402207B8
                dec     rdi
                jmp     short loc_140220775
; ---------------------------------------------------------------------------

loc_1402207B8:                          ; CODE XREF: sub_140220490+309↑j
                                        ; sub_140220490+321↑j
                mov     r15, [rsp+0F8h+var_C8]
                mov     rsi, [rsp+0F8h+arg_0]
                mov     r12, [rsp+0F8h+var_D0]
                cmp     r14, r15
                jnz     loc_1404292D2
                mov     edi, [rsp+0F8h+arg_8]
                mov     r14d, [rsp+0F8h+arg_10]
                mov     [rsi+30h], r15

loc_1402207E6:                          ; CODE XREF: sub_140220490+439↓j
                                        ; sub_140220490+208E70↓j
                and     byte ptr [rsi+2], 0FEh

loc_1402207EA:                          ; CODE XREF: sub_140220490+208E5E↓j
                mov     r8d, 3
                mov     rdx, rbp
                mov     rcx, rsi
                call    sub_140222F70
                mov     r9d, 400h
                mov     ebx, eax
                test    [rsi], r9w
                jnz     loc_140429305

loc_14022080D:                          ; CODE XREF: sub_140220490+208E87↓j
                cmp     ebx, 3
                jl      short loc_14022082F
                mov     eax, ebx

loc_140220814:                          ; CODE XREF: sub_140220490+3F9↓j
                mov     r13, [rsp+0F8h+var_40]
                add     rsp, 0C0h
                pop     r15
                pop     r14
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
byte_14022082E  db 0CCh                 ; DATA XREF: .pdata:00000001400CAC14↑o
                                        ; .pdata:00000001400CAC20↑o
; ---------------------------------------------------------------------------

loc_14022082F:                          ; CODE XREF: sub_140220490+380↑j
                                        ; DATA XREF: .pdata:00000001400CAC20↑o ...
                mov     r8, [rsp+0F8h+var_C0]
                xor     r11d, r11d
                mov     r10, 0FFFFF68000000000h
                mov     rbx, 7FFFFFFFF8h

loc_14022084B:                          ; CODE XREF: sub_140220490+163↑j
                                        ; sub_140220490+174↑j
                mov     rax, [rsp+0F8h+var_B8]
                inc     edi
                mov     [rsp+0F8h+arg_8], edi
                cmp     edi, r14d
                jb      loc_1402205E0
                mov     ecx, [rsp+0F8h+arg_18]

loc_140220869:                          ; CODE XREF: sub_140220490+137↑j
                inc     ecx
                add     r12, 10h
                mov     [rsp+0F8h+arg_18], ecx
                mov     [rsp+0F8h+var_D0], r12
                cmp     ecx, r13d
                jb      loc_1402205B9
                mov     eax, 3
                jmp     short loc_140220814
; ---------------------------------------------------------------------------

loc_14022088B:                          ; CODE XREF: sub_140220490+63↑j
                mov     rax, [rsi+20h]
                mov     r13d, 1
                mov     [rsp+0F8h+var_B0], rax
                mov     rax, [rsi+28h]
                mov     [rsp+0F8h+var_A8], rax
                jmp     loc_14022057B
; ---------------------------------------------------------------------------

loc_1402208A8:                          ; CODE XREF: sub_140220490+17D↑j
                mov     rbp, rcx
                jmp     loc_140220613
; ---------------------------------------------------------------------------

loc_1402208B0:                          ; CODE XREF: sub_140220490+B8↑j
                mov     rcx, r9
                cmp     rax, rcx
                ja      loc_14022054E
                jmp     loc_140220534
; ---------------------------------------------------------------------------

loc_1402208C1:                          ; CODE XREF: sub_140220490+224↑j
                mov     [rsi+30h], r11
                test    r9w, ax
                jz      loc_1402207E6
                jmp     loc_1404292F3
sub_140220490   endp

; ---------------------------------------------------------------------------
algn_1402208D4:                         ; DATA XREF: .pdata:00000001400CAC2C↑o
                align 20h
; Exported entry 1485. MmProbeAndLockPages

; =============== S U B R O U T I N E =======================================


                public MmProbeAndLockPages
MmProbeAndLockPages proc near           ; CODE XREF: sub_1403E9D90+56↓p
                                        ; sub_1405CD8DC+6EA↓p ...
                sub     rsp, 28h
                test    r8d, r8d
                movzx   eax, dl
                mov     r10d, 1
                mov     r9d, r10d
                cmovz   r9d, r8d
                test    dl, dl
                mov     r8d, r9d
                cmovz   r10d, eax
                movzx   edx, r10b
                call    sub_140221A30
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
MmProbeAndLockPages endp

algn_14022090F:                         ; DATA XREF: .pdata:00000001400CAC38↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140220920   proc near               ; CODE XREF: sub_140224940+79D↓p
                                        ; DATA XREF: .rdata:0000000140052800↑o ...

var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_8], rdx
                push    rsi
                push    r12
                push    r14
                push    r15
                sub     rsp, 48h
                mov     r14, [rcx]
                mov     rax, 7FFFFFFFF8h
                mov     r12, [rcx+8]
                mov     rdx, r14
                mov     rsi, [rcx+10h]
                mov     r15, rcx
                shr     rdx, 9
                and     rdx, rax
                mov     r9, 0FFFFF68000000000h
                mov     rax, r9
                add     rdx, rax
                mov     rcx, rsi
                mov     rax, gs:188h
                and     ecx, 1
                mov     [rsp+68h+arg_10], rdx
                mov     [rsp+68h+arg_0], rcx
                mov     r8, [rax+0B8h]
                mov     [rsp+68h+arg_18], r8
                jz      short loc_1402209C0
                mov     rcx, rsi
                and     rcx, 0FFFFFFFFFFFFFFFEh
                movzx   eax, byte ptr [rcx]
                cmp     al, 1
                jnz     short loc_1402209B7
                xor     r8d, r8d
                mov     rdx, r14
                call    sub_1402DEE60

loc_1402209A8:                          ; CODE XREF: sub_140220920+99↓j
                xor     eax, eax
                add     rsp, 48h
                pop     r15
                pop     r14
                pop     r12
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402209B7:                          ; CODE XREF: sub_140220920+7B↑j
                cmp     al, 3
                jz      short loc_1402209A8
                mov     rcx, [rsp+68h+arg_0]

loc_1402209C0:                          ; CODE XREF: sub_140220920+6D↑j
                                        ; DATA XREF: .rdata:0000000140052800↑o ...
                mov     [rsp+68h+var_28], rbx
                mov     [rsp+68h+var_30], rdi
                mov     [rsp+68h+var_38], r13
                mov     rax, r9
                mov     rbx, [rsp+68h+arg_8]
                cmp     r14, rax
                jb      short loc_140220A40
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     r14, rax
                ja      short loc_140220A40
                test    bl, bl
                jns     short loc_140220A40
                mov     rax, rsi
                and     rax, 0FFFFFFFFFFFFFFFEh
                test    rcx, rcx
                jz      short loc_140220A29
                cmp     byte ptr [rax], 1
                jz      loc_140220ED5
                test    rcx, rcx
                jz      short loc_140220A29
                cmp     byte ptr [rax], 3
                jz      loc_140220ED5
                test    rcx, rcx
                jz      short loc_140220A29
                cmp     byte ptr [rax], 6
                jz      loc_140220ED5
                test    rcx, rcx
                jnz     loc_140220F73

loc_140220A29:                          ; CODE XREF: sub_140220920+D9↑j
                                        ; sub_140220920+E7↑j ...
                xor     edx, edx
                mov     rcx, rsi
                call    sub_140338BE0
                cmp     al, 1
                jnz     loc_140220F73
                jmp     loc_140220ED5
; ---------------------------------------------------------------------------

loc_140220A40:                          ; CODE XREF: sub_140220920+BA↑j
                                        ; sub_140220920+C9↑j ...
                xor     edi, edi
                test    bl, 4
                jnz     short loc_140220A5A
                mov     rax, 7FFFFFFEFFFFh
                cmp     r14, rax
                jbe     loc_140220ED5

loc_140220A5A:                          ; CODE XREF: sub_140220920+125↑j
                mov     eax, [r15+50h]
                mov     r9, 0FFFF800000000000h
                test    al, 40h
                jnz     short loc_140220AB3
                test    rsi, rsi
                jz      short loc_140220AB3
                cmp     r14, r9
                jnb     short loc_140220AB3
                test    rcx, rcx
                jnz     short loc_140220AB3
                mov     rcx, rsi
                call    sub_140351B7C
                test    al, al
                jnz     short loc_140220AB3
                xor     edx, edx
                mov     rcx, rsi
                call    sub_140338BE0
                cmp     al, 1
                jnz     loc_140220F90
                mov     r8, [rsp+68h+arg_18]
                mov     r9, 0FFFF800000000000h
                mov     rdx, [rsp+68h+arg_10]

loc_140220AB3:                          ; CODE XREF: sub_140220920+14A↑j
                                        ; sub_140220920+14F↑j ...
                mov     r13, r12
                and     r13d, 2
                jz      loc_140220BC6
                bt      rbx, 9
                jnb     short loc_140220B34
                xor     r9d, r9d
                mov     rcx, r14
                lea     r8, [r9-1]
                call    sub_1402C50E0
                mov     edi, eax
                test    eax, eax
                jns     short loc_140220AE8
                mov     edx, eax
                mov     rcx, r15
                call    sub_140549108
                jmp     short loc_140220B16
; ---------------------------------------------------------------------------

loc_140220AE8:                          ; CODE XREF: sub_140220920+1BA↑j
                mov     rbx, [rsp+68h+arg_10]
                mov     edi, 112h

loc_140220AF5:                          ; CODE XREF: sub_140220920+35D↓j
                                        ; sub_140220920+367↓j ...
                mov     r13, [rsp+68h+arg_0]

loc_140220AFA:                          ; CODE XREF: sub_140220920+5FD↓j
                                        ; sub_140220920+60F↓j ...
                test    r13, r13
                jz      short loc_140220B16
                and     rsi, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rsi], 5
                jnz     short loc_140220B16
                mov     r8, rbx
                mov     rdx, rsi
                mov     rcx, r15
                call    sub_14054912C

loc_140220B16:                          ; CODE XREF: sub_140220920+1C6↑j
                                        ; sub_140220920+1DD↑j ...
                mov     rbx, [rsp+68h+var_28]
                mov     eax, edi
                mov     rdi, [rsp+68h+var_30]
                mov     r13, [rsp+68h+var_38]
                add     rsp, 48h
                pop     r15
                pop     r14
                pop     r12
                pop     rsi
                retn
; ---------------------------------------------------------------------------
algn_140220B33:                         ; DATA XREF: .pdata:00000001400CAC50↑o
                                        ; .pdata:00000001400CAC5C↑o
                align 4

loc_140220B34:                          ; CODE XREF: sub_140220920+1A5↑j
                                        ; DATA XREF: .pdata:00000001400CAC5C↑o ...
                bt      rbx, 0Bh
                jnb     loc_140220ED5
                mov     rax, 8000000000000000h
                test    rax, rbx
                jnz     loc_140220CBA
                test    bl, 42h
                jnz     loc_140220CBA
                mov     eax, [r8+464h]
                test    al, 10h
                jz      loc_140220CBA
                cmp     r14, r9
                jnb     loc_140220CBA
                mov     rcx, gs:188h
                mov     eax, [r15+50h]
                test    al, 40h
                jz      short loc_140220B94
                test    byte ptr [rcx+519h], 10h
                jnz     short loc_140220BBC
                mov     edi, 0C0000723h
                jmp     short loc_140220B16
; ---------------------------------------------------------------------------

loc_140220B94:                          ; CODE XREF: sub_140220920+262↑j
                test    byte ptr [rcx+519h], 20h
                jnz     short loc_140220BBC
                mov     rbx, [rsp+68h+arg_8]
                mov     rcx, r15
                mov     rdx, rbx
                call    sub_140548B84
                mov     edi, eax
                test    eax, eax
                js      loc_140220B16
                jmp     loc_140220CBA
; ---------------------------------------------------------------------------

loc_140220BBC:                          ; CODE XREF: sub_140220920+26B↑j
                                        ; sub_140220920+27B↑j
                mov     rbx, [rsp+68h+arg_8]
                jmp     loc_140220CBA
; ---------------------------------------------------------------------------

loc_140220BC6:                          ; CODE XREF: sub_140220920+19A↑j
                test    r12b, 10h
                jz      loc_140220CBA
                mov     rax, 8000000000000000h
                test    rax, rbx
                jz      loc_140220CA1
                mov     rdx, r14
                mov     rcx, r8
                call    sub_1405482A8
                cmp     eax, 1
                jnz     loc_140220ED5
                lea     rcx, [rsp+68h+arg_8]
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rcx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000028h
                add     rcx, rcx
                mov     rax, rax
                mov     rcx, [rax+rcx*8]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      loc_140220ED5
                mov     rax, 7FFFFFFFFFFFFFFFh
                and     rbx, rax
                mov     eax, cs:dword_140CFC400
                bt      eax, 8
                jb      short loc_140220C5C
                bt      eax, 9
                jnb     short loc_140220C60

loc_140220C5C:                          ; CODE XREF: sub_140220920+334↑j
                or      rbx, 20h

loc_140220C60:                          ; CODE XREF: sub_140220920+33A↑j
                mov     rdx, rbx
                mov     rbx, [rsp+68h+arg_10]
                mov     rcx, rbx
                call    sub_1402A6830
                mov     eax, cs:dword_140CFC400
                bt      eax, 8
                jb      loc_140220AF5
                bt      eax, 9
                jb      loc_140220AF5
                xor     r8d, r8d
                mov     rcx, r14
                lea     edx, [r8+1]
                call    ?_Getint@?$time_get@_WV?$istreambuf_iterator@_WU?$char_traits@_W@std@@@std@@@std@@AEBAHAEAV?$istreambuf_iterator@_WU?$char_traits@_W@std@@@2@0HHAEAH@Z ; std::time_get<wchar_t,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>>>::_Getint(std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,int,int,int &)
                jmp     loc_140220AF5
; ---------------------------------------------------------------------------

loc_140220CA1:                          ; CODE XREF: sub_140220920+2BD↑j
                mov     eax, [r15+50h]
                test    al, 40h
                jnz     short loc_140220CBA
                mov     r8d, 5
                mov     rdx, rbx
                mov     rcx, r15
                call    sub_14035A668

loc_140220CBA:                          ; CODE XREF: sub_140220920+22C↑j
                                        ; sub_140220920+235↑j ...
                mov     r12d, 1
                test    r13, r13
                jz      loc_140220EBF
                mov     rdx, rbx
                mov     r11, 0FFFFF6FB7DBED000h
                mov     rax, r11
                lea     rcx, [rsp+68h+arg_8]
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     rcx, rax
                jb      short loc_140220D62
                mov     rax, r10
                lea     rcx, [rsp+68h+arg_8]
                cmp     rcx, rax
                ja      short loc_140220D62
                call    sub_140349680
                test    eax, eax
                jz      short loc_140220D62
                test    r12b, bl
                jz      short loc_140220D62
                test    bl, 20h
                jz      short loc_140220D12
                test    bl, 42h
                jnz     short loc_140220D62

loc_140220D12:                          ; CODE XREF: sub_140220920+3EB↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     short loc_140220D38
                mov     rbx, [rsp+68h+arg_8]
                mov     rdx, rbx
                jmp     short loc_140220D62
; ---------------------------------------------------------------------------

loc_140220D38:                          ; CODE XREF: sub_140220920+40C↑j
                lea     rax, [rsp+68h+arg_8]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                test    al, 20h
                jz      short loc_140220D55
                or      rdx, 20h

loc_140220D55:                          ; CODE XREF: sub_140220920+42F↑j
                mov     rbx, [rsp+68h+arg_8]
                test    al, 42h
                jz      short loc_140220D62
                or      rdx, 42h

loc_140220D62:                          ; CODE XREF: sub_140220920+3CB↑j
                                        ; sub_140220920+3D8↑j ...
                shr     rdx, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rdx, rcx
                mov     rax, 0FFFFFA8000000028h
                lea     r8, [rdx+rdx*2]
                add     r8, r8
                mov     rax, rax
                mov     rcx, [rax+r8*8]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      loc_140220E7D
                mov     rax, 0FFFFFA8000000000h
                lea     r13, [rax+r8*8]
                mov     rdx, [r13+10h]
                lea     r9, [r13+10h]
                mov     rax, r11
                cmp     r9, rax
                jb      short loc_140220E29
                mov     rax, r10
                cmp     r9, rax
                ja      short loc_140220E29
                call    sub_140349680
                test    eax, eax
                jz      short loc_140220E29
                test    r12b, dl
                jz      short loc_140220E2E
                test    dl, 20h
                jz      short loc_140220DDC
                test    dl, 42h
                jnz     short loc_140220E29

loc_140220DDC:                          ; CODE XREF: sub_140220920+4B5↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140220E24
                mov     rax, r9
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140220E24
                or      rdx, 42h

loc_140220E24:                          ; CODE XREF: sub_140220920+4D6↑j
                                        ; sub_140220920+4FE↑j
                mov     rbx, [rsp+68h+arg_8]

loc_140220E29:                          ; CODE XREF: sub_140220920+49A↑j
                                        ; sub_140220920+4A2↑j ...
                test    r12b, dl
                jnz     short loc_140220E62

loc_140220E2E:                          ; CODE XREF: sub_140220920+4B0↑j
                test    rdx, rdx
                jz      short loc_140220E44
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_140220E44
                test    rax, rdx
                jz      short loc_140220E62

loc_140220E44:                          ; CODE XREF: sub_140220920+511↑j
                                        ; sub_140220920+51D↑j
                bt      rdx, 0Ah
                jb      short loc_140220E62
                shr     dl, 2
                test    r12b, dl
                jz      short loc_140220E62
                mov     edx, r12d
                mov     rcx, r13
                call    sub_1402A689C
                lea     r9, [r13+10h]

loc_140220E62:                          ; CODE XREF: sub_140220920+50C↑j
                                        ; sub_140220920+522↑j ...
                mov     rcx, r13
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_140220E7D
                mov     eax, [r9]
                bt      rax, 0Ah
                jnb     short loc_140220E7D
                call    sub_1402FBD58

loc_140220E7D:                          ; CODE XREF: sub_140220920+478↑j
                                        ; sub_140220920+54C↑j ...
                mov     r9, [r15+8]
                xor     r10d, r10d
                mov     r13, [rsp+68h+arg_0]
                mov     edx, r10d
                mov     r8d, r10d
                mov     rcx, rbx
                test    bl, 20h
                jz      short loc_140220EDF
                test    r13, r13
                jz      short loc_140220EA8
                mov     rax, rsi
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 5
                jz      short loc_140220EE6

loc_140220EA8:                          ; CODE XREF: sub_140220920+57A↑j
                mov     eax, cs:dword_140CFC400
                bt      eax, 8
                jb      short loc_140220EE6
                bt      eax, 9
                jb      short loc_140220EE6
                mov     edx, r12d
                jmp     short loc_140220EE6
; ---------------------------------------------------------------------------

loc_140220EBF:                          ; CODE XREF: sub_140220920+3A3↑j
                mov     eax, [r15+50h]
                test    al, 20h
                jz      short loc_140220E7D
                lea     rcx, [rsp+68h+arg_8]
                call    sub_140547B90
                test    eax, eax
                jnz     short loc_140220E7D

loc_140220ED5:                          ; CODE XREF: sub_140220920+DE↑j
                                        ; sub_140220920+EC↑j ...
                mov     edi, 0C0000005h
                jmp     loc_140220B16
; ---------------------------------------------------------------------------

loc_140220EDF:                          ; CODE XREF: sub_140220920+575↑j
                or      rcx, 20h
                mov     r8d, r12d

loc_140220EE6:                          ; CODE XREF: sub_140220920+586↑j
                                        ; sub_140220920+592↑j ...
                test    r9b, 2
                jz      short loc_140220F08
                mov     rax, rcx
                and     eax, 42h
                test    rax, 0FFFFFFFFFFFFFFBFh
                jnz     short loc_140220F08
                cmp     rax, 40h ; '@'
                cmovz   edx, r12d
                or      rcx, 62h
                jmp     short loc_140220F0D
; ---------------------------------------------------------------------------

loc_140220F08:                          ; CODE XREF: sub_140220920+5CA↑j
                                        ; sub_140220920+5D8↑j
                test    r8d, r8d
                jz      short loc_140220F25

loc_140220F0D:                          ; CODE XREF: sub_140220920+5E6↑j
                mov     rax, rbx
                mov     rbx, [rsp+68h+arg_10]
                lock cmpxchg [rbx], rcx
                jnz     loc_140220AFA
                jmp     short loc_140220F2D
; ---------------------------------------------------------------------------

loc_140220F25:                          ; CODE XREF: sub_140220920+5EB↑j
                mov     rbx, [rsp+68h+arg_10]

loc_140220F2D:                          ; CODE XREF: sub_140220920+603↑j
                test    edx, edx
                jz      loc_140220AFA
                mov     eax, cs:dword_140CFC400
                bt      eax, 8
                jb      loc_140220AFA
                bt      eax, 9
                jb      loc_140220AFA
                mov     rcx, [r15+38h]
                test    rcx, rcx
                jz      short loc_140220F60
                call    sub_140289778
                mov     r10d, eax

loc_140220F60:                          ; CODE XREF: sub_140220920+636↑j
                xor     r8d, r8d
                mov     edx, r10d
                mov     rcx, r14
                call    ?_Getint@?$time_get@_WV?$istreambuf_iterator@_WU?$char_traits@_W@std@@@std@@@std@@AEBAHAEAV?$istreambuf_iterator@_WU?$char_traits@_W@std@@@2@0HHAEAH@Z ; std::time_get<wchar_t,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>>>::_Getint(std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,int,int,int &)
                jmp     loc_140220AFA
; ---------------------------------------------------------------------------

loc_140220F73:                          ; CODE XREF: sub_140220920+103↑j
                                        ; sub_140220920+115↑j
                mov     r9, rsi
                mov     [rsp+68h+var_48], 8
                mov     r8, r12
                mov     rdx, r14
                mov     ecx, 50h ; 'P'
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140220F90:                          ; CODE XREF: sub_140220920+173↑j
                mov     r9, rsi
                mov     [rsp+68h+var_48], 0Fh
                mov     r8, r12
                mov     rdx, r14
                mov     ecx, 50h ; 'P'
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_140220920   endp

algn_140220FAD:                         ; DATA XREF: .pdata:00000001400CAC68↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140220FC0   proc near               ; CODE XREF: sub_140221EA0+455↓p
                                        ; sub_1402DDFE0+519↓p ...

arg_0           = dword ptr  8
arg_8           = dword ptr  10h
arg_18          = qword ptr  20h

                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 28h
                xor     r15d, r15d
                mov     r12d, edx
                mov     rbx, rcx
                cmp     edx, 1
                jnz     short loc_140220FE4
                mov     rsi, rcx
                jmp     short loc_140220FEE
; ---------------------------------------------------------------------------

loc_140220FE4:                          ; CODE XREF: sub_140220FC0+1D↑j
                test    r12d, r12d
                mov     rsi, r15
                cmovz   rsi, rcx

loc_140220FEE:                          ; CODE XREF: sub_140220FC0+22↑j
                mov     [rsp+68h+arg_18], rsi
                lea     rbp, unk_140C50C00
                mov     rcx, 0FFFFFFFFFh
                mov     r10, 0FFFFFA8000000000h
                mov     r9, 7FFFFFFFFFFFFFFFh
                mov     r13d, 1

loc_140221021:                          ; CODE XREF: sub_140220FC0+44C↓j
                                        ; sub_140220FC0+4A1↓j ...
                mov     r14d, 4
                mov     rdi, 3FFFFFFFFFFFFFFFh

loc_140221031:                          ; CODE XREF: sub_140220FC0+118↓j
                cmp     r12d, r13d
                jnz     short loc_14022104B
                mov     rax, [rsi+28h]
                and     rax, rcx
                lea     rbx, [rax+rax*2]
                shl     rbx, 4
                mov     rax, r10
                add     rbx, rax

loc_14022104B:                          ; CODE XREF: sub_140220FC0+74↑j
                mov     rax, [rbx+18h]
                and     rax, rdi
                cmp     rax, 10000h
                jb      loc_1402210F8
                mov     [rsp+68h+arg_8], r15d
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jnb     short loc_1402210AA
                nop     dword ptr [rax+00h]

loc_140221070:                          ; CODE XREF: sub_140220FC0+C1↓j
                                        ; sub_140220FC0+CA↓j
                lea     rcx, [rsp+68h+arg_8]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_140221070
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_140221070
                mov     r9, 7FFFFFFFFFFFFFFFh
                mov     r10, 0FFFFFA8000000000h
                mov     rcx, 0FFFFFFFFFh

loc_1402210AA:                          ; CODE XREF: sub_140220FC0+AA↑j
                cmp     r12d, r13d
                jnz     short loc_1402210DD
                mov     rax, [rsi+28h]
                and     rax, rcx
                lea     rcx, [rax+rax*2]
                shl     rcx, 4
                mov     rax, r10
                add     rcx, rax
                cmp     rbx, rcx
                jz      short loc_1402210DD
                lock and [rbx+18h], r9
                mov     rcx, 0FFFFFFFFFh
                jmp     loc_140221031
; ---------------------------------------------------------------------------

loc_1402210DD:                          ; CODE XREF: sub_140220FC0+ED↑j
                                        ; sub_140220FC0+107↑j
                mov     rcx, [rbx+18h]
                mov     rax, rcx
                and     rax, rdi
                cmp     rax, 10000h
                jnb     loc_140221475
                lock and [rbx+18h], r9

loc_1402210F8:                          ; CODE XREF: sub_140220FC0+98↑j
                cmp     r12d, 2
                jnz     short loc_140221105
                lea     edi, [r12+1]
                jmp     short loc_14022110F
; ---------------------------------------------------------------------------

loc_140221105:                          ; CODE XREF: sub_140220FC0+13C↑j
                test    r12d, r12d
                mov     rdi, r13
                cmovz   rdi, r14

loc_14022110F:                          ; CODE XREF: sub_140220FC0+143↑j
                mov     rcx, [rbx+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     r14, [rax+rcx*8]
                cmp     r14, rbp
                jnz     short loc_14022115F
                mov     r8, gs:20h
                mov     edx, [r8+831Ch]
                cmp     rdi, rdx
                ja      short loc_14022115F

loc_140221142:                          ; CODE XREF: sub_140220FC0+19D↓j
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14022115F
                mov     ecx, edx
                mov     eax, edx
                sub     ecx, edi
                lock cmpxchg [r8+831Ch], ecx
                mov     edx, eax
                jz      short loc_140221178
                cmp     rdi, rdx
                jbe     short loc_140221142

loc_14022115F:                          ; CODE XREF: sub_140220FC0+16B↑j
                                        ; sub_140220FC0+180↑j ...
                mov     r8d, 200h
                mov     rdx, rdi
                mov     rcx, r14
                call    sub_1403438BC
                test    eax, eax
                jz      loc_1402214A5

loc_140221178:                          ; CODE XREF: sub_140220FC0+198↑j
                mov     ebp, r15d
                nop     dword ptr [rax+rax+00h]

loc_140221180:                          ; CODE XREF: sub_140220FC0+3D6↓j
                mov     esi, ebp
                cmp     rsi, rdi
                jnb     loc_14022123F
                mov     [rsp+68h+arg_0], r15d
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jnb     short loc_1402211BC
                nop     dword ptr [rax+00000000h]

loc_1402211A0:                          ; CODE XREF: sub_140220FC0+1F1↓j
                                        ; sub_140220FC0+1FA↓j
                lea     rcx, [rsp+68h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_1402211A0
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_1402211A0

loc_1402211BC:                          ; CODE XREF: sub_140220FC0+1D7↑j
                cmp     r12d, r13d
                jnz     short loc_1402211FB
                mov     rax, [rsp+68h+arg_18]
                mov     rcx, 0FFFFFFFFFh
                mov     r10, 0FFFFFA8000000000h
                mov     rax, [rax+28h]
                and     rax, rcx
                lea     rcx, [rax+rax*2]
                shl     rcx, 4
                mov     rax, r10
                add     rcx, rax
                cmp     rbx, rcx
                jnz     loc_14022139B

loc_1402211FB:                          ; CODE XREF: sub_140220FC0+1FF↑j
                mov     r8, [rbx+18h]
                mov     r9, 3FFFFFFFFFFFFFFFh
                mov     rdx, r8
                mov     rax, 3FFFFFFFFFFEFDFFh
                and     rdx, r9
                test    ebp, ebp
                jnz     loc_1402212E2
                cmp     rdx, rax
                jb      loc_1402212E7
                mov     r13d, r15d

loc_14022122D:                          ; CODE XREF: sub_140220FC0+345↓j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rax
                cmp     rsi, rdi

loc_14022123F:                          ; CODE XREF: sub_140220FC0+1C5↑j
                jz      loc_1402212DA
                sub     rdi, rsi
                lea     rax, unk_140C50C00
                cmp     r14, rax
                jnz     short loc_1402212CC
                mov     r8, gs:20h
                movsxd  rdx, dword ptr [r8+831Ch]
                cmp     edx, 0FFFFFFFFh
                jz      short loc_1402212CC
                lea     rcx, [rdi+rdx]
                cmp     rcx, 100h
                ja      short loc_1402212A3

loc_140221276:                          ; CODE XREF: sub_140220FC0+2E1↓j
                cmp     rdi, 80000h
                jnb     short loc_1402212A3
                lea     ecx, [rdi+rdx]
                mov     eax, edx
                lock cmpxchg [r8+831Ch], ecx
                movsxd  rdx, eax
                jz      short loc_1402212DA
                cmp     edx, 0FFFFFFFFh
                jz      short loc_1402212A3
                lea     rax, [rdi+rdx]
                cmp     rax, 100h
                jbe     short loc_140221276

loc_1402212A3:                          ; CODE XREF: sub_140220FC0+2B4↑j
                                        ; sub_140220FC0+2BD↑j ...
                mov     r11d, 0C0h
                cmp     edx, r11d
                jle     short loc_1402212CC
                cmp     edx, 0FFFFFFFFh
                jz      short loc_1402212CC
                mov     eax, edx
                lock cmpxchg [r8+831Ch], r11d
                jnz     short loc_1402212CC
                lea     ecx, [rdx-0C0h]
                movsxd  rdx, ecx
                add     rdi, rdx

loc_1402212CC:                          ; CODE XREF: sub_140220FC0+292↑j
                                        ; sub_140220FC0+2A7↑j ...
                test    rdi, rdi
                jz      short loc_1402212DA
                lock xadd [r14+1C00h], rdi

loc_1402212DA:                          ; CODE XREF: sub_140220FC0:loc_14022123F↑j
                                        ; sub_140220FC0+2D0↑j ...
                mov     eax, r13d
                jmp     loc_1402214A7
; ---------------------------------------------------------------------------

loc_1402212E2:                          ; CODE XREF: sub_140220FC0+25B↑j
                cmp     rdx, rax
                jnb     short loc_1402212FE

loc_1402212E7:                          ; CODE XREF: sub_140220FC0+264↑j
                lea     rax, [rdx+10000h]
                mov     rcx, r8
                xor     rcx, rax
                and     rcx, r9
                xor     rcx, r8
                mov     [rbx+18h], rcx

loc_1402212FE:                          ; CODE XREF: sub_140220FC0+325↑j
                cmp     rdx, 10000h
                jnb     loc_14022122D
                movzx   r9d, byte ptr [rbx+22h]
                mov     rax, r15
                test    r9b, 10h
                jnz     short loc_140221349
                mov     edx, [rbx+10h]
                lea     rcx, [rbx+10h]
                movzx   r8d, r9b
                bt      rdx, 0Ah
                jb      short loc_140221341
                test    r9b, 8
                jnz     short loc_140221341
                xor     r8d, r8d
                mov     edx, r13d
                call    sub_140338C90
                movzx   r8d, byte ptr [rbx+22h]

loc_140221341:                          ; CODE XREF: sub_140220FC0+369↑j
                                        ; sub_140220FC0+36F↑j
                or      r8b, 10h
                mov     [rbx+22h], r8b

loc_140221349:                          ; CODE XREF: sub_140220FC0+357↑j
                mov     r9, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], r9
                test    rax, rax
                jz      short loc_14022136B
                mov     r8d, r13d
                mov     rdx, rax
                mov     rcx, r14
                call    sub_14020B2C0

loc_14022136B:                          ; CODE XREF: sub_140220FC0+39B↑j
                mov     rax, [rbx+28h]
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rbx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                inc     ebp
                jmp     loc_140221180
; ---------------------------------------------------------------------------

loc_14022139B:                          ; CODE XREF: sub_140220FC0+235↑j
                mov     r9, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], r9
                sub     rdi, rsi
                lea     rbp, unk_140C50C00
                cmp     r14, rbp
                jnz     loc_14022144C
                mov     r8, gs:20h
                movsxd  rdx, dword ptr [r8+831Ch]
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14022144C
                lea     rax, [rdi+rdx]
                cmp     rax, 100h
                ja      short loc_140221423
                xchg    ax, ax

loc_1402213E0:                          ; CODE XREF: sub_140220FC0+461↓j
                cmp     rdi, 80000h
                jnb     short loc_140221423
                lea     ecx, [rdi+rdx]
                mov     eax, edx
                lock cmpxchg [r8+831Ch], ecx
                mov     rsi, [rsp+68h+arg_18]
                mov     rcx, 0FFFFFFFFFh
                movsxd  rdx, eax
                jz      loc_140221021
                cmp     edx, 0FFFFFFFFh
                jz      short loc_140221423
                lea     rax, [rdi+rdx]
                cmp     rax, 100h
                jbe     short loc_1402213E0

loc_140221423:                          ; CODE XREF: sub_140220FC0+41C↑j
                                        ; sub_140220FC0+427↑j ...
                mov     r11d, 0C0h
                cmp     edx, r11d
                jle     short loc_14022144C
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14022144C
                mov     eax, edx
                lock cmpxchg [r8+831Ch], r11d
                jnz     short loc_14022144C
                lea     eax, [rdx-0C0h]
                movsxd  rcx, eax
                add     rdi, rcx

loc_14022144C:                          ; CODE XREF: sub_140220FC0+3F7↑j
                                        ; sub_140220FC0+410↑j ...
                mov     rsi, [rsp+68h+arg_18]
                mov     rcx, 0FFFFFFFFFh
                test    rdi, rdi
                jz      loc_140221021
                lock xadd [r14+1C00h], rdi
                jmp     loc_140221021
; ---------------------------------------------------------------------------

loc_140221475:                          ; CODE XREF: sub_140220FC0+12D↑j
                mov     rdx, 3FFFFFFFFFFEFDFFh
                cmp     rax, rdx
                jnb     short loc_14022149B
                lea     rax, [rcx+10000h]
                mov     r15d, r13d
                xor     rax, rcx
                and     rax, rdi
                xor     rax, rcx
                mov     [rbx+18h], rax

loc_14022149B:                          ; CODE XREF: sub_140220FC0+4C2↑j
                lock and [rbx+18h], r9
                mov     eax, r15d
                jmp     short loc_1402214A7
; ---------------------------------------------------------------------------

loc_1402214A5:                          ; CODE XREF: sub_140220FC0+1B2↑j
                xor     eax, eax

loc_1402214A7:                          ; CODE XREF: sub_140220FC0+31D↑j
                                        ; sub_140220FC0+4E3↑j
                add     rsp, 28h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140220FC0   endp

algn_1402214B9:                         ; DATA XREF: .pdata:00000001400CAC74↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402214C0   proc near               ; CODE XREF: sub_140221A30+54↓p
                                        ; MmProbeAndLockSelectedPages+BB↓p ...

var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_18          = dword ptr  20h
arg_20          = byte ptr  28h
arg_28          = dword ptr  30h
arg_30          = dword ptr  38h

; FUNCTION CHUNK AT 000000014042931C SIZE 0000014B BYTES

                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                sub     rsp, 30h
                mov     rax, gs:188h
                mov     rsi, r8
                mov     r8d, [rsp+58h+arg_28]
                xor     ebp, ebp
                mov     edi, r9d
                mov     rbx, rcx
                add     rdi, rsi
                mov     [rcx+48h], rax
                mov     eax, esi
                mov     [rsp+58h+arg_18], ebp
                mov     r12, 7FFFFFFF0000h
                mov     [rcx+38h], rdx
                mov     [rcx+58h], r8d
                mov     [rcx], rsi
                mov     [rcx+8], rdi
                cmp     [rsp+58h+arg_20], bpl
                jz      short loc_140221529
                cmp     rdi, r12
                ja      loc_14042931C
                cmp     rsi, rdi
                jnb     loc_14042931C

loc_140221529:                          ; CODE XREF: sub_1402214C0+55↑j
                                        ; DATA XREF: .rdata:0000000140052870↑o ...
                mov     [rsp+58h+var_30], r14
                mov     ecx, eax
                mov     r14d, [rdx+28h]
                lea     rax, [rdx+30h]
                and     ecx, 0FFFh
                mov     [rsp+58h+var_38], r15
                add     r14, 0FFFh
                mov     [rbx+30h], rax
                add     r14, rcx
                mov     r9, 0FFFFF68000000000h
                mov     rcx, rsi
                shr     r14, 0Ch
                shr     rcx, 9
                mov     r10, 7FFFFFFFF8h
                and     rcx, r10
                dec     rdi
                mov     rax, r9
                add     rcx, rax
                mov     [rbx+10h], rcx
                mov     rcx, rdi
                shr     rcx, 9
                and     rcx, r10
                mov     rax, r9
                add     rcx, rax
                mov     r9d, 80h
                mov     [rbx+18h], rcx
                mov     rax, 0FFFFFFFFFh
                mov     [rbx+88h], rax
                movzx   ecx, word ptr [rdx+0Ah]
                movzx   eax, cx
                or      ax, r9w
                mov     r9d, 0FFFFFF7Fh
                and     cx, r9w
                test    r8d, r8d
                cmovnz  cx, ax
                or      cx, 2
                mov     [rdx+0Ah], cx
                mov     [rbx+78h], rbp
                mov     [rbx+68h], rbp
                mov     [rbx+70h], rbp
                cmp     [rbx], r12
                jnb     loc_140221744
                mov     rax, [rbx+48h]
                mov     rcx, [rax+0B8h]
                mov     [rbx+50h], rcx
                mov     [rdx+10h], rcx
                cmp     r8d, 3
                jz      loc_1402218EC

loc_140221601:                          ; CODE XREF: sub_1402214C0+50D↓j
                cmp     [rsp+58h+arg_30], ebp
                jz      short loc_140221617
                mov     rax, [rbx+50h]
                lock xadd [rax+500h], r14

loc_140221617:                          ; CODE XREF: sub_1402214C0+148↑j
                                        ; sub_1402214C0+28C↓j
                mov     r14, [rbx]
                mov     rax, 0FFFF800000000000h
                mov     [rbx+20h], rbp
                cmp     r14, rax
                jnb     loc_140221751
                mov     r15d, ebp

loc_140221634:                          ; CODE XREF: sub_1402214C0+2B0↓j
                mov     r10d, 1
                cmp     r14, r12
                jnb     loc_140221775
                mov     edx, [rbx+40h]
                lea     rsi, [rbx+40h]
                mov     rdi, [rbx+50h]
                lea     r12, [rbx+60h]
                add     rdi, 680h
                and     edx, 0FFFFFFF1h
                or      edx, r10d
                mov     [r12], rdi

loc_140221663:                          ; CODE XREF: sub_1402214C0+2E0↓j
                                        ; sub_1402214C0+32D↓j ...
                mov     [rsi], edx

loc_140221665:                          ; CODE XREF: sub_1402214C0+55E↓j
                mov     [rsp+58h+arg_0], r12

loc_14022166A:                          ; CODE XREF: sub_1402214C0+3D8↓j
                                        ; sub_1402214C0+406↓j
                and     edx, 0FFFFFFCFh
                mov     [rsi], edx
                movzx   eax, byte ptr [rdi+0B8h]
                and     al, 7
                cmp     al, 6
                jnb     loc_1402217F2
                cmp     al, 2
                jz      loc_140221812
                add     rdi, 0C0h

loc_14022168F:                          ; CODE XREF: sub_1402214C0+359↓j
                mov     r12, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404293AE

loc_1402216AA:                          ; CODE XREF: sub_1402214C0+207EF1↓j
                                        ; sub_1402214C0+207EFB↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_1404293F4

loc_1402216B7:                          ; DATA XREF: .rdata:0000000140052884↑o
                                        ; .rdata:0000000140052894↑o ...
                mov     [rsp+58h+arg_8], r13
                mov     r13, gs:20h
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_140429406

loc_1402216D5:                          ; CODE XREF: sub_1402214C0+207F4A↓j
                                        ; sub_1402214C0+207F59↓j ...
                prefetchw byte ptr [rdi]
                mov     eax, [rdi]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rdi], ecx
                jnz     loc_1402218CB

loc_1402216EB:                          ; CODE XREF: sub_1402214C0+427↓j
                mov     r13, [rsp+58h+arg_8]

loc_1402216F0:                          ; CODE XREF: sub_1402214C0+207F41↓j
                                        ; DATA XREF: .pdata:00000001400CAC98↑o ...
                cmp     [rdi+4], ebp
                jnz     loc_140429455

loc_1402216F9:                          ; CODE XREF: sub_1402214C0+207F98↓j
                movzx   r9d, r12b
                mov     r12, [rsp+58h+arg_0]

loc_140221702:                          ; CODE XREF: sub_1402214C0+347↓j
                                        ; sub_1402214C0+207EAB↓j ...
                mov     ecx, [rsi]
                mov     eax, ecx
                and     al, 0Fh
                mov     [rbx+44h], r9b
                cmp     al, 1
                jnz     short loc_140221722
                mov     rax, [rbx+50h]
                cmp     qword ptr [rax+4F0h], 0
                jnz     loc_14042945D

loc_140221722:                          ; CODE XREF: sub_1402214C0+24E↑j
                                        ; sub_1402214C0+207FA2↓j
                cmp     r15d, 8
                jz      loc_14022181E

loc_14022172C:                          ; CODE XREF: sub_1402214C0+39D↓j
                xor     eax, eax

loc_14022172E:                          ; CODE XREF: sub_1402214C0+207E70↓j
                                        ; sub_1402214C0+207E7F↓j ...
                mov     r14, [rsp+58h+var_30]
                mov     r15, [rsp+58h+var_38]

loc_140221738:                          ; CODE XREF: sub_1402214C0+207E67↓j
                                        ; DATA XREF: .pdata:00000001400CACA4↑o ...
                add     rsp, 30h
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140221744:                          ; CODE XREF: sub_1402214C0+11E↑j
                                        ; DATA XREF: .pdata:00000001400CACB0↑o ...
                mov     [rbx+50h], rbp
                mov     [rdx+10h], rbp
                jmp     loc_140221617
; ---------------------------------------------------------------------------

loc_140221751:                          ; CODE XREF: sub_1402214C0+16B↑j
                mov     rcx, r14
                lea     rax, unk_140C4F848
                shr     rcx, 27h
                and     ecx, 1FFh
                add     ecx, 0FFFFFF00h
                movzx   r15d, byte ptr [rcx+rax]
                jmp     loc_140221634
; ---------------------------------------------------------------------------

loc_140221775:                          ; CODE XREF: sub_1402214C0+17D↑j
                cmp     r15d, r10d
                jz      loc_1402219FF
                cmp     r15d, 6
                jnz     short loc_1402217A5
                mov     edx, [rbx+40h]
                lea     rsi, [rbx+40h]
                and     edx, 0FFFFFFF3h
                lea     r12, [rbx+60h]
                lea     rdi, unk_140C4F100
                or      edx, 3
                mov     [r12], rdi
                jmp     loc_140221663
; ---------------------------------------------------------------------------

loc_1402217A5:                          ; CODE XREF: sub_1402214C0+2C2↑j
                cmp     r15d, 8
                jz      short loc_1402217CE
                cmp     r15d, 5
                jnz     loc_140221862

loc_1402217B5:                          ; CODE XREF: sub_1402214C0+3A6↓j
                mov     ecx, 5
                call    sub_1402A46FC
                mov     edx, [rbx+40h]
                lea     rsi, [rbx+40h]
                and     edx, 0FFFFFFF4h
                or      edx, 4
                jmp     short loc_1402217E2
; ---------------------------------------------------------------------------

loc_1402217CE:                          ; CODE XREF: sub_1402214C0+2E9↑j
                xor     ecx, ecx
                call    sub_1402A46FC
                mov     edx, [rbx+40h]
                lea     rsi, [rbx+40h]
                and     edx, 0FFFFFFF2h
                or      edx, 2

loc_1402217E2:                          ; CODE XREF: sub_1402214C0+30C↑j
                lea     r12, [rbx+60h]
                mov     rdi, rax
                mov     [r12], rax
                jmp     loc_140221663
; ---------------------------------------------------------------------------

loc_1402217F2:                          ; CODE XREF: sub_1402214C0+1BA↑j
                mov     r9, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      loc_140221702
                jmp     loc_140429368
; ---------------------------------------------------------------------------

loc_140221812:                          ; CODE XREF: sub_1402214C0+1C2↑j
                lea     rdi, unk_140C4F600
                jmp     loc_14022168F
; ---------------------------------------------------------------------------

loc_14022181E:                          ; CODE XREF: sub_1402214C0+266↑j
                mov     rcx, r14
                call    sub_140264110
                mov     rdx, [rax+18h]
                movzx   eax, dl
                mov     rcx, rdx
                and     rcx, 0FFFFFFFFFFFFFFFEh
                and     al, 1
                cmovz   rcx, rdx
                mov     rax, [rcx]
                movzx   ecx, word ptr [rax+3Ch]
                mov     rax, cs:qword_140C4E4C8
                and     ecx, 3FFh
                mov     rcx, [rax+rcx*8]
                add     rcx, 1C40h
                mov     [r12], rcx
                jmp     loc_14022172C
; ---------------------------------------------------------------------------

loc_140221862:                          ; CODE XREF: sub_1402214C0+2EF↑j
                cmp     r15d, 0Fh
                jz      loc_1402217B5
                lea     r12, [rbx+60h]
                mov     [rsp+58h+arg_0], r12
                lea     rsi, [rbx+40h]
                cmp     r15d, 0Ch
                jnz     short loc_14022189D
                mov     ecx, r10d
                call    sub_1402A46FC
                mov     edx, [rsi]
                mov     rdi, rax
                and     edx, 0FFFFFFF6h
                mov     [r12], rax
                or      edx, 6
                mov     [rsi], edx
                jmp     loc_14022166A
; ---------------------------------------------------------------------------

loc_14022189D:                          ; CODE XREF: sub_1402214C0+3BD↑j
                mov     edx, [rsi]
                mov     [rsp+58h+arg_0], r12
                cmp     r15d, 0Eh
                jnz     loc_1402219D2
                lea     ecx, [r15-0Ah]
                call    sub_1402A46FC
                and     edx, 0FFFFFFF7h
                mov     [r12], rax
                or      edx, 7
                mov     rdi, rax
                mov     [rsi], edx
                jmp     loc_14022166A
; ---------------------------------------------------------------------------

loc_1402218CB:                          ; CODE XREF: sub_1402214C0+225↑j
                                        ; DATA XREF: .pdata:00000001400CACBC↑o ...
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_14042942D

loc_1402218DB:                          ; CODE XREF: sub_1402214C0+207F72↓j
                                        ; sub_1402214C0+207F81↓j ...
                movzx   edx, r12b
                mov     rcx, rdi
                call    sub_140329420
                jmp     loc_1402216EB
; ---------------------------------------------------------------------------

loc_1402218EC:                          ; CODE XREF: sub_1402214C0+13B↑j
                                        ; DATA XREF: .pdata:00000001400CACC8↑o ...
                mov     rcx, [rbx]
                lea     r8, [rsp+58h+arg_18]
                xor     edx, edx
                call    sub_140232930
                mov     r15, rax
                test    rax, rax
                jz      loc_14042932C
                mov     rcx, rax
                call    sub_140233020
                test    eax, eax
                jnz     loc_140429356
                mov     eax, [r15+34h]
                movzx   ecx, byte ptr [r15+22h]
                btr     eax, 1Fh
                shl     rcx, 1Fh
                or      rcx, rax
                mov     rax, 7FFFFFFFDh
                cmp     rcx, rax
                jnb     loc_140429356
                mov     ecx, [r15+30h]
                mov     eax, ecx
                and     al, 70h
                cmp     al, 10h
                jz      loc_140429356
                bt      ecx, 14h
                jnb     loc_1402219EE

loc_140221958:                          ; CODE XREF: sub_1402214C0+534↓j
                movzx   edx, byte ptr [r15+20h]
                mov     eax, [r15+18h]
                shl     rdx, 20h
                or      rdx, rax
                shl     rdx, 0Ch
                cmp     rsi, rdx
                jb      loc_140429344
                movzx   ecx, byte ptr [r15+21h]
                mov     eax, [r15+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                shl     rcx, 0Ch
                or      rcx, 0FFFh
                cmp     rsi, rcx
                ja      loc_140429344
                cmp     rdi, rdx
                jb      loc_140429344
                cmp     rdi, rcx
                ja      loc_140429344
                mov     rcx, [rbx+50h]
                mov     rdx, r14
                call    sub_14063D610
                mov     [rsp+58h+arg_18], eax
                mov     edi, eax
                test    eax, eax
                js      loc_140429335
                mov     [rbx+78h], r15
                mov     [rbx+70h], r14
                jmp     loc_140221601
; ---------------------------------------------------------------------------

loc_1402219D2:                          ; CODE XREF: sub_1402214C0+3E8↑j
                mov     ecx, 3
                call    sub_1402A46FC
                and     edx, 0FFFFFFF5h
                mov     [r12], rax
                or      edx, 5
                mov     rdi, rax
                jmp     loc_140221663
; ---------------------------------------------------------------------------

loc_1402219EE:                          ; CODE XREF: sub_1402214C0+492↑j
                and     cl, 70h
                cmp     cl, 20h ; ' '
                jz      loc_140221958
                jmp     loc_140429356
; ---------------------------------------------------------------------------

loc_1402219FF:                          ; CODE XREF: sub_1402214C0+2B8↑j
                mov     edx, [rbx+40h]
                lea     rsi, [rbx+40h]
                and     edx, 0FFFFFFF8h
                or      edx, 8
                mov     [rsi], edx
                call    sub_1402642FC
                lea     r12, [rbx+60h]
                mov     rdi, rax
                mov     [r12], rax
                jmp     loc_140221665
sub_1402214C0   endp

; ---------------------------------------------------------------------------
algn_140221A23:                         ; DATA XREF: .pdata:00000001400CACD4↑o
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_140221A30   proc near               ; CODE XREF: MmProbeAndLockPages+24↑p
                                        ; sub_140234BA0+33↓p ...

var_F0          = byte ptr -0F0h
var_E8          = dword ptr -0E8h
var_E0          = dword ptr -0E0h
var_D0          = qword ptr -0D0h
var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = byte ptr -90h
var_8C          = byte ptr -8Ch
var_80          = qword ptr -80h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = dword ptr  10h
arg_8           = qword ptr  18h
arg_10          = qword ptr  20h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 0000000140429468 SIZE 00000273 BYTES

                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r14
                lea     rbp, [rsp-37h]
                sub     rsp, 0F0h
                mov     ebx, r8d
                movzx   edi, dl
                mov     rsi, rcx
                xor     edx, edx
                mov     r8d, 0A8h
                lea     rcx, [rbp+57h+var_D0]
                call    memset
                mov     r8d, [rsi+2Ch]
                lea     rcx, [rbp+57h+var_D0]
                add     r8, [rsi+20h]
                mov     rdx, rsi
                mov     r9d, [rsi+28h]
                xor     r14d, r14d
                mov     [rsp+110h+var_E0], 1
                mov     [rsp+110h+var_E8], ebx
                mov     [rsp+110h+var_F0], dil
                call    sub_1402214C0
                mov     ebx, eax
                test    eax, eax
                js      loc_140429468
                mov     rdi, [rbp+57h+var_C0]
                mov     rsi, [rbp+57h+var_D0]

loc_140221A9B:                          ; DATA XREF: .rdata:000000014005297C↑o
                                        ; .rdata:0000000140052990↑o ...
                mov     [rsp+110h+arg_8], r13
                mov     r13, 0FFFFFFFFFh
                mov     [rsp+110h+arg_10], r15
                mov     rcx, 0FFFFF6FB7DBED000h
                mov     rdx, 0FFFFF6FB7DBED7F8h

loc_140221AC9:                          ; CODE XREF: sub_140221A30+20A↓j
                test    [rbp+57h+var_90], 20h
                mov     rax, [rbp+57h+var_A0]
                mov     qword ptr [rax], 0FFFFFFFFFFFFFFFFh
                jnz     loc_140221CAF

loc_140221ADE:                          ; CODE XREF: sub_140221A30+287↓j
                                        ; sub_140221A30+290↓j
                test    r14b, 0Fh
                jnz     loc_140221B73
                mov     rdx, [rbp+57h+var_B0]
                mov     rdi, [rbp+57h+var_70]
                test    rdx, rdx
                jnz     loc_140221D5B

loc_140221AF9:                          ; CODE XREF: sub_140221A30+335↓j
                movzx   eax, byte ptr [rdi+0B8h]
                and     al, 7
                cmp     al, 2
                jz      loc_140221D2D
                add     rdi, 0C0h

loc_140221B11:                          ; CODE XREF: sub_140221A30+304↓j
                mov     eax, [rdi]
                bt      eax, 1Eh
                jb      loc_140221D8A
                mov     rcx, gs:20h
                mov     edx, [rcx+312Ch]
                mov     edi, [rcx+7BECh]
                mov     r15d, [rcx+7E9Ch]
                test    dl, 1
                jnz     loc_1404295B0
                xor     r8d, r8d
                test    dl, 1Eh
                jnz     loc_140221DA9
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jnz     loc_140221D6D
                mov     rax, [rcx+10h]
                test    rax, rax
                jnz     loc_140221DCB

loc_140221B6A:                          ; CODE XREF: sub_140221A30+39F↓j
                                        ; sub_140221A30+207B8A↓j
                cmp     edi, 7
                ja      loc_140221DDC

loc_140221B73:                          ; CODE XREF: sub_140221A30+B2↑j
                                        ; sub_140221A30+354↓j
                lea     rcx, [rbp+57h+var_D0]
                mov     [rbp+57h+arg_0], 0
                call    sub_1402225B0
                mov     rcx, cs:qword_14001D278
                mov     edx, eax
                cmp     [rbp+57h+var_A8], rcx
                jz      loc_140221D4C

loc_140221B96:                          ; CODE XREF: sub_140221A30+3F2↓j
                lea     rdx, [rbp+57h+arg_0]
                lea     rcx, [rbp+57h+var_D0]
                call    sub_1402228C0
                mov     edx, eax
                test    eax, eax
                js      loc_140221D4C
                mov     eax, [rbp+57h+arg_0]
                test    eax, eax
                jnz     loc_140221E07
                mov     rbx, [rbp+57h+var_A8]
                lea     rcx, [rbp+57h+var_A8]
                lea     rdi, [rbp+57h+var_A8]
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140429617

loc_140221BD1:                          ; CODE XREF: sub_140221A30+207BF1↓j
                                        ; sub_140221A30+207C0E↓j ...
                shr     rbx, 0Ch
                lea     rcx, [rbp+57h+var_D0]
                and     rbx, r13
                mov     [rbp+57h+var_50], rbx
                call    sub_1402DB074

loc_140221BE5:                          ; CODE XREF: sub_140221A30+2D5↓j
                                        ; sub_140221A30+317↓j ...
                lea     rcx, [rbp+57h+var_D0]
                call    sub_140221EA0
                mov     ebx, eax
                test    eax, eax
                js      short loc_140221C40
                mov     rsi, [rbp+57h+var_D0]
                mov     rcx, [rbp+57h+var_A0]
                add     rsi, 1000h
                mov     rdi, [rbp+57h+var_C0]
                add     [rbp+57h+var_A0], 8
                mov     rax, [rbp+57h+var_50]
                add     rdi, 8
                mov     [rbp+57h+var_C0], rdi
                mov     [rcx], rax
                mov     [rbp+57h+var_D0], rsi

loc_140221C1F:                          ; CODE XREF: sub_140221A30+374↓j
                inc     r14d
                mov     rcx, 0FFFFF6FB7DBED000h
                mov     rdx, 0FFFFF6FB7DBED7F8h
                cmp     rdi, [rbp+57h+var_B8]
                jbe     loc_140221AC9

loc_140221C40:                          ; CODE XREF: sub_140221A30+1C2↑j
                                        ; sub_140221A30+326↓j
                mov     rdx, [rbp+57h+var_B0]
                mov     rdi, [rbp+57h+var_70]
                mov     r15, [rsp+110h+arg_10]
                mov     r13, [rsp+110h+arg_8]
                test    rdx, rdx
                jz      short loc_140221C65

loc_140221C5D:                          ; DATA XREF: .pdata:00000001400CACEC↑o
                                        ; .pdata:00000001400CACF8↑o
                mov     rcx, rdi
                call    sub_140312B40

loc_140221C65:                          ; CODE XREF: sub_140221A30+22B↑j
                movzx   edx, [rbp+57h+var_8C]
                mov     rcx, rdi
                call    sub_140226960
                mov     eax, cs:dword_140CFC4EC
                mov     rdi, [rbp+57h+var_98]
                test    al, 1
                jnz     loc_1404296AB

loc_140221C83:                          ; CODE XREF: sub_140221A30+207CA6↓j
                test    ebx, ebx
                js      loc_140221DB0

loc_140221C8B:                          ; CODE XREF: sub_140221A30+38E↓j
                mov     rdi, [rbp+57h+var_58]
                test    rdi, rdi
                jnz     loc_140221E2D

loc_140221C98:                          ; CODE XREF: sub_140221A30+447↓j
                test    ebx, ebx
                js      loc_140221DC3
                add     rsp, 0F0h
                pop     r14
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140221CAF:                          ; CODE XREF: sub_140221A30+A8↑j
                                        ; DATA XREF: .pdata:00000001400CACF8↑o ...
                mov     r15, [rbp+57h+var_40]
                cmp     rsi, [rbp+57h+var_38]
                ja      loc_140221ADE
                cmp     rsi, r15
                jb      loc_140221ADE
                test    r14b, 3Fh
                jz      short loc_140221D0A

loc_140221CCC:                          ; CODE XREF: sub_140221A30+2FB↓j
                mov     rax, [rbp+57h+var_30]
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jnz     short loc_140221D39
                mov     rbx, [rdi]
                mov     rax, rcx
                cmp     rdi, rax
                jnb     loc_140429470

loc_140221CE5:                          ; CODE XREF: sub_140221A30+207A46↓j
                                        ; sub_140221A30+207A56↓j ...
                lea     rcx, [rbp+57h+arg_18]
                mov     [rbp+57h+arg_18], rbx
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140429516

loc_140221CFA:                          ; CODE XREF: sub_140221A30+207AF0↓j
                                        ; sub_140221A30+207B0D↓j ...
                shr     rbx, 0Ch
                and     rbx, r13
                mov     [rbp+57h+var_50], rbx
                jmp     loc_140221BE5
; ---------------------------------------------------------------------------

loc_140221D0A:                          ; CODE XREF: sub_140221A30+29A↑j
                lea     rcx, [rbp+57h+var_D0]
                call    sub_14029F354
                test    eax, eax
                jnz     short loc_140221D8A
                mov     rcx, 0FFFFF6FB7DBED000h
                mov     rdx, 0FFFFF6FB7DBED7F8h
                jmp     short loc_140221CCC
; ---------------------------------------------------------------------------

loc_140221D2D:                          ; CODE XREF: sub_140221A30+D4↑j
                lea     rdi, unk_140C4F600
                jmp     loc_140221B11
; ---------------------------------------------------------------------------

loc_140221D39:                          ; CODE XREF: sub_140221A30+2A4↑j
                sub     rsi, r15
                shr     rsi, 0Ch
                add     rsi, rax
                mov     [rbp+57h+var_50], rsi
                jmp     loc_140221BE5
; ---------------------------------------------------------------------------

loc_140221D4C:                          ; CODE XREF: sub_140221A30+160↑j
                                        ; sub_140221A30+177↑j ...
                mov     ebx, edx
                test    edx, edx
                jns     loc_140221BE5
                jmp     loc_140221C40
; ---------------------------------------------------------------------------

loc_140221D5B:                          ; CODE XREF: sub_140221A30+C3↑j
                mov     rcx, rdi
                call    sub_14029F0B0
                test    eax, eax
                jz      loc_140221AF9
                jmp     short loc_140221D8A
; ---------------------------------------------------------------------------

loc_140221D6D:                          ; CODE XREF: sub_140221A30+127↑j
                mov     esi, 3

loc_140221D72:                          ; CODE XREF: sub_140221A30+37E↓j
                                        ; sub_140221A30+3AA↓j ...
                test    dword ptr cs:xmmword_140CFC480+4, 4000000h
                jnz     loc_1404295FA

loc_140221D82:                          ; CODE XREF: sub_140221A30+207BD7↓j
                test    esi, esi
                jz      loc_140221B73

loc_140221D8A:                          ; CODE XREF: sub_140221A30+E7↑j
                                        ; sub_140221A30+2E5↑j ...
                lea     rcx, [rbp+57h+var_D0]
                call    sub_140348A5C
                lea     rcx, [rbp+57h+var_D0]
                call    sub_140348A14
                mov     rdi, [rbp+57h+var_C0]
                mov     rsi, [rbp+57h+var_D0]
                jmp     loc_140221C1F
; ---------------------------------------------------------------------------

loc_140221DA9:                          ; CODE XREF: sub_140221A30+118↑j
                mov     esi, 2
                jmp     short loc_140221D72
; ---------------------------------------------------------------------------

loc_140221DB0:                          ; CODE XREF: sub_140221A30+255↑j
                                        ; DATA XREF: .pdata:00000001400CAD04↑o ...
                mov     rcx, rdi
                call    MmUnlockPages
                inc     cs:dword_140C4E620
                jmp     loc_140221C8B
; ---------------------------------------------------------------------------

loc_140221DC3:                          ; CODE XREF: sub_140221A30+26A↑j
                mov     ecx, ebx
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140221DCB:                          ; CODE XREF: sub_140221A30+134↑j
                                        ; DATA XREF: .pdata:00000001400CAD10↑o ...
                cmp     rax, [rcx+8]
                jz      loc_140221B6A
                mov     esi, 4
                jmp     short loc_140221D72
; ---------------------------------------------------------------------------

loc_140221DDC:                          ; CODE XREF: sub_140221A30+13D↑j
                test    r8d, r8d
                jnz     loc_1404295D3

loc_140221DE5:                          ; CODE XREF: sub_140221A30+207BBA↓j
                cli
                mov     dword ptr [rcx+7BECh], 0
                mov     dword ptr [rcx+7E9Ch], 0
                call    sub_140326178
                sti
                xor     esi, esi
                jmp     loc_140221D72
; ---------------------------------------------------------------------------

loc_140221E07:                          ; CODE XREF: sub_140221A30+182↑j
                cmp     eax, 1
                jnz     short loc_140221E7C

loc_140221E0C:                          ; CODE XREF: sub_140221A30+459↓j
                lea     rcx, [rbp+57h+var_D0]
                call    sub_1402225B0
                mov     edx, eax
                mov     rax, cs:qword_14001D278
                cmp     [rbp+57h+var_A8], rax
                jnz     loc_140221B96
                jmp     loc_140221D4C
; ---------------------------------------------------------------------------

loc_140221E2D:                          ; CODE XREF: sub_140221A30+262↑j
                                        ; DATA XREF: .pdata:00000001400CAD1C↑o ...
                mov     edx, [rdi+34h]
                mov     eax, edx
                movzx   r9d, byte ptr [rdi+22h]
                btr     eax, 1Fh
                shl     r9, 1Fh
                or      r9, rax
                add     r9, [rbp+57h+var_68]
                mov     eax, r9d
                shr     r9, 1Fh
                xor     eax, edx
                btr     eax, 1Fh
                xor     eax, edx
                mov     rdx, [rbp+57h+var_60]
                mov     [rdi+34h], eax
                mov     [rdi+22h], r9b
                sub     rdx, [rbp+57h+var_68]
                jz      short loc_140221E6F
                mov     rcx, [rbp+57h+var_80]
                call    sub_14065C6A8

loc_140221E6F:                          ; CODE XREF: sub_140221A30+434↑j
                mov     rcx, rdi
                call    sub_140232610
                jmp     loc_140221C98
; ---------------------------------------------------------------------------

loc_140221E7C:                          ; CODE XREF: sub_140221A30+3DA↑j
                                        ; DATA XREF: .pdata:00000001400CAD28↑o ...
                lea     rcx, [rbp+57h+var_D0]
                call    sub_1403488E4
                mov     edx, eax
                test    eax, eax
                jns     short loc_140221E0C
                jmp     loc_14042960C
sub_140221A30   endp

; ---------------------------------------------------------------------------
algn_140221E90:                         ; DATA XREF: .pdata:00000001400CAD34↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140221EA0   proc near               ; CODE XREF: sub_140221A30+1B9↑p
                                        ; MmProbeAndLockSelectedPages+14D↓p
                                        ; DATA XREF: ...

var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
arg_0           = byte ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h

                push    rsi
                push    rdi
                push    r14
                sub     rsp, 60h
                mov     rdi, [rcx+80h]
                mov     rax, 0FFFFFFFFFh
                mov     rsi, rcx
                cmp     rdi, rax
                ja      loc_140222517
                lea     rax, [rdi+rdi*2]
                add     rax, rax
                mov     rcx, 0FFFFFA8000000028h
                mov     rax, [rcx+rax*8]
                mov     rcx, 4000000000000h
                test    rcx, rax
                jz      loc_140222517
                mov     eax, [rsi+40h]

loc_140221EF1:                          ; DATA XREF: .rdata:0000000140052A58↑o
                                        ; .rdata:0000000140052A6C↑o ...
                mov     [rsp+78h+var_20], rbx
                and     al, 0Fh
                mov     [rsp+78h+var_28], rbp
                mov     [rsp+78h+var_38], r15
                mov     [rsp+78h+arg_0], 11h
                mov     r15, 0FFFFF68000000000h
                mov     rbp, 0FFFFFA8000000000h
                cmp     al, 4
                jnz     short loc_140221F8B
                mov     rbx, [rsi]
                mov     rcx, rbx
                call    sub_140260090
                test    eax, eax
                jnz     short loc_140221F8B
                shr     rbx, 9
                mov     rcx, 7FFFFFFFF8h
                and     rcx, rbx
                mov     rax, r15
                add     rcx, rax
                lea     rdx, [rsp+78h+arg_0]
                call    sub_140544C40
                mov     rbx, rax
                mov     rax, rbp
                mov     rcx, rbx
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rdi, rdx
                sar     rdi, 3
                mov     rax, rdi
                shr     rax, 3Fh
                add     rdi, rax
                mov     [rsi+80h], rdi
                test    rbx, rbx
                jnz     short loc_140221FDF

loc_140221F8B:                          ; CODE XREF: sub_140221EA0+80↑j
                                        ; sub_140221EA0+8F↑j
                lea     rbx, [rdi+rdi*2]
                shl     rbx, 4
                mov     rax, rbp
                add     rbx, rax
                mov     [rsp+78h+arg_0], 11h
                mov     [rsp+78h+arg_8], 0
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jnb     short loc_140221FDF
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140221FC0:                          ; CODE XREF: sub_140221EA0+134↓j
                                        ; sub_140221EA0+13D↓j
                lea     rcx, [rsp+78h+arg_8]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_140221FC0
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_140221FC0

loc_140221FDF:                          ; CODE XREF: sub_140221EA0+E9↑j
                                        ; sub_140221EA0+113↑j
                movzx   r8d, byte ptr [rbx+22h]
                movzx   eax, r8b
                and     al, 7
                cmp     al, 1
                jbe     loc_140222486
                movzx   eax, word ptr [rbx+20h]
                test    ax, ax
                jz      loc_140222486
                mov     ecx, 7FFFh

loc_140222004:                          ; DATA XREF: .rdata:0000000140052A6C↑o
                                        ; .rdata:0000000140052A80↑o ...
                mov     [rsp+78h+var_30], r13
                cmp     ax, cx
                jnb     loc_1402223FA
                mov     rdx, [rbx+28h]
                mov     rcx, 1000000000h
                mov     r14d, 1
                mov     r9d, 3FFh
                mov     edi, r14d
                mov     r13, 3FFFFFFFFFFFFFFFh
                test    rcx, rdx
                jnz     loc_140222172
                mov     rcx, 2000000000000h
                test    rcx, rdx
                jnz     loc_140222172
                mov     rcx, [rbx+18h]
                and     rcx, r13
                cmp     ax, di
                jnz     short loc_140222068
                test    rcx, rcx
                jnz     short loc_140222085
                jmp     short loc_14022207B
; ---------------------------------------------------------------------------

loc_140222068:                          ; CODE XREF: sub_140221EA0+1BF↑j
                cmp     ax, 2
                jnz     loc_140222172
                test    rcx, rcx
                jz      loc_140222172

loc_14022207B:                          ; CODE XREF: sub_140221EA0+1C6↑j
                test    r8b, 8
                jz      loc_140222172

loc_140222085:                          ; CODE XREF: sub_140221EA0+1C4↑j
                mov     rcx, rbx
                xor     bpl, bpl
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_1402220A4
                mov     eax, [rbx+10h]
                bt      rax, 0Ah
                jnb     short loc_1402220A4
                movzx   ebp, dil
                jmp     short loc_1402220DE
; ---------------------------------------------------------------------------

loc_1402220A4:                          ; CODE XREF: sub_140221EA0+1F2↑j
                                        ; sub_140221EA0+1FC↑j
                mov     rax, r15
                mov     rcx, 3FFFFFFF78h
                mov     r8, 8000000000000000h
                add     rax, rcx
                mov     rcx, [rbx+8]
                or      rcx, r8
                cmp     rcx, rax
                ja      short loc_1402220DE
                mov     rax, r15
                cmp     rcx, rax
                jb      short loc_1402220DE
                test    byte ptr [rbx+23h], 20h
                movzx   ebp, bpl
                cmovnz  ebp, r14d

loc_1402220DE:                          ; CODE XREF: sub_140221EA0+202↑j
                                        ; sub_140221EA0+228↑j ...
                mov     rax, cs:qword_140C4E4C8
                shr     rdx, 27h
                and     rdx, r9
                mov     r15, [rax+rdx*8]
                test    bpl, bpl
                jz      short loc_14022210E
                mov     r8d, 8
                mov     rdx, r14
                mov     rcx, r15
                call    sub_140232160
                test    eax, eax
                jz      loc_1402223FA

loc_14022210E:                          ; CODE XREF: sub_140221EA0+253↑j
                lea     rax, unk_140C50C00
                cmp     r15, rax
                jnz     short loc_140222146
                mov     rdx, gs:20h
                mov     eax, [rdx+831Ch]
                cmp     eax, edi
                jb      short loc_140222146
                nop     dword ptr [rax]

loc_140222130:                          ; CODE XREF: sub_140221EA0+2A4↓j
                cmp     eax, 0FFFFFFFFh
                jz      short loc_140222146
                lea     ecx, [rax-1]
                lock cmpxchg [rdx+831Ch], ecx
                jz      short loc_140222172
                cmp     eax, edi
                jnb     short loc_140222130

loc_140222146:                          ; CODE XREF: sub_140221EA0+278↑j
                                        ; sub_140221EA0+28B↑j ...
                xor     r8d, r8d
                mov     rdx, r14
                mov     rcx, r15
                call    sub_1403438BC
                mov     edi, eax
                test    eax, eax
                jnz     short loc_14022216A
                test    bpl, bpl
                jz      short loc_14022216A
                mov     rdx, r14
                mov     rcx, r15
                call    sub_14026B700

loc_14022216A:                          ; CODE XREF: sub_140221EA0+2B8↑j
                                        ; sub_140221EA0+2BD↑j
                test    edi, edi
                jz      loc_1402223FA

loc_140222172:                          ; CODE XREF: sub_140221EA0+19C↑j
                                        ; sub_140221EA0+1AF↑j ...
                inc     word ptr [rbx+20h]
                test    edi, edi
                jz      loc_1402223FA
                test    [rbx+18h], r13
                jnz     short loc_1402221BC
                mov     rax, [rbx+10h]
                bt      rax, 0Ah
                jb      short loc_1402221BC
                shr     al, 2
                mov     r15d, 3FFh
                test    r14b, al
                jz      short loc_1402221C2
                mov     rcx, [rbx+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     rcx, r15
                mov     rcx, [rax+rcx*8]
                mov     [rcx+2A3h], r14b
                jmp     short loc_1402221C2
; ---------------------------------------------------------------------------

loc_1402221BC:                          ; CODE XREF: sub_140221EA0+2E2↑j
                                        ; sub_140221EA0+2ED↑j
                mov     r15d, 3FFh

loc_1402221C2:                          ; CODE XREF: sub_140221EA0+2FB↑j
                                        ; sub_140221EA0+31A↑j
                movzx   eax, byte ptr [rbx+22h]
                test    al, 20h
                jz      short loc_1402221DF
                test    al, 8
                jnz     short loc_1402221DF
                test    [rbx+18h], r13
                jnz     short loc_1402221DF
                mov     rax, [rbx]
                lock inc qword ptr [rax+0E8h]

loc_1402221DF:                          ; CODE XREF: sub_140221EA0+328↑j
                                        ; sub_140221EA0+32C↑j ...
                mov     rdi, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rdi
                movzx   ebp, [rsp+78h+arg_0]
                cmp     bpl, 11h
                jz      short loc_140222264
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14022225C
                test    r14b, al
                jz      short loc_14022225C
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14022225C
                cmp     bpl, 0Fh
                ja      short loc_14022225C
                cmp     al, 2
                jb      short loc_14022225C
                mov     r10, gs:20h
                mov     r9, 0FFFFFFFFFFFFFFFFh
                mov     r8, [r10+84B8h]
                mov     edx, [r8+14h]
                movzx   ebp, [rsp+78h+arg_0]
                lea     ecx, [rbp+1]
                shl     r9, cl
                movzx   eax, r9w
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_14022225C
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14022225C:                          ; CODE XREF: sub_140221EA0+364↑j
                                        ; sub_140221EA0+369↑j ...
                movzx   eax, bpl
                mov     cr8, rax

loc_140222264:                          ; CODE XREF: sub_140221EA0+35A↑j
                mov     eax, [rsi+40h]
                and     al, 0Fh
                cmp     al, r14b
                jnz     loc_140222380
                mov     rdx, [rbx+28h]
                mov     rax, 1000000000h
                test    rax, rdx
                jnz     loc_140222380
                mov     rax, rdx
                shr     rax, 3Ch
                and     al, 7
                cmp     al, r14b
                jz      loc_140222380
                mov     rbp, 0FFFFFFFFFh
                mov     rax, 0FFFFFFFFDh
                and     rdx, rbp
                cmp     rdx, rax
                jz      loc_140222380
                cmp     [rsi+88h], rdx
                jz      loc_140222380
                mov     rcx, rbx
                call    sub_1403F41D8
                test    eax, eax
                jnz     short loc_1402222F2
                lea     rcx, [rdx+rdx*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                add     rcx, rax
                mov     r14d, 2

loc_1402222F2:                          ; CODE XREF: sub_140221EA0+432↑j
                mov     edx, r14d
                call    sub_140220FC0
                test    eax, eax
                jnz     short loc_140222365
                mov     [rsp+78h+arg_10], eax
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jnb     short loc_14022232F
                xchg    ax, ax

loc_140222310:                          ; CODE XREF: sub_140221EA0+484↓j
                                        ; sub_140221EA0+48D↓j
                lea     rcx, [rsp+78h+arg_10]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_140222310
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_140222310

loc_14022232F:                          ; CODE XREF: sub_140221EA0+46C↑j
                mov     rcx, rbx
                call    sub_14027B630
                lock and [rbx+18h], rdi
                inc     cs:dword_140C4E614

loc_140222342:                          ; CODE XREF: sub_140221EA0+5E1↓j
                mov     eax, 0C00000A1h

loc_140222347:                          ; CODE XREF: sub_140221EA0+555↓j
                mov     r13, [rsp+78h+var_30]

loc_14022234C:                          ; CODE XREF: sub_140221EA0+672↓j
                                        ; DATA XREF: .pdata:00000001400CAD58↑o ...
                mov     rbp, [rsp+78h+var_28]
                mov     rbx, [rsp+78h+var_20]
                mov     r15, [rsp+78h+var_38]
                add     rsp, 60h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
byte_140222364  db 0CCh                 ; DATA XREF: .pdata:00000001400CAD64↑o
                                        ; .pdata:00000001400CAD70↑o
; ---------------------------------------------------------------------------

loc_140222365:                          ; CODE XREF: sub_140221EA0+45C↑j
                                        ; DATA XREF: .pdata:00000001400CAD70↑o ...
                mov     rax, [rbx+28h]
                mov     ecx, 100h
                and     rax, rbp
                mov     [rsi+88h], rax
                mov     rax, [rsi+38h]
                or      [rax+0Ah], cx

loc_140222380:                          ; CODE XREF: sub_140221EA0+3CC↑j
                                        ; sub_140221EA0+3E3↑j ...
                mov     rax, [rsi+38h]
                movzx   ecx, byte ptr [rax+0Ah]
                test    cl, cl
                jns     short loc_1402223C8
                mov     rcx, rbx
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_1402223C8
                mov     rax, [rbx+10h]
                bt      rax, 0Ah
                jnb     short loc_1402223C8
                mov     rcx, cs:qword_140C4DDC0
                test    rcx, rcx
                jz      short loc_1402223B9
                test    al, 10h
                jnz     short loc_1402223B9
                not     rcx
                and     rax, rcx

loc_1402223B9:                          ; CODE XREF: sub_140221EA0+50D↑j
                                        ; sub_140221EA0+511↑j
                sar     rax, 10h
                mov     rcx, [rax]
                add     rcx, 70h ; 'p'
                lock inc qword ptr [rcx]

loc_1402223C8:                          ; CODE XREF: sub_140221EA0+4EA↑j
                                        ; sub_140221EA0+4F6↑j ...
                mov     rax, [rbx+28h]
                shr     rax, 27h
                movzx   ecx, ax
                test    r15w, ax
                jz      short loc_1402223F3
                mov     rax, cs:qword_140C4E4C8
                and     rcx, r15
                mov     rcx, [rax+rcx*8]
                mov     rcx, [rcx+860h]
                call    ExAcquireRundownProtectionCacheAware

loc_1402223F3:                          ; CODE XREF: sub_140221EA0+537↑j
                xor     eax, eax
                jmp     loc_140222347
; ---------------------------------------------------------------------------

loc_1402223FA:                          ; CODE XREF: sub_140221EA0+16C↑j
                                        ; sub_140221EA0+268↑j ...
                mov     rdi, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rdi
                movzx   ebx, [rsp+78h+arg_0]
                cmp     bl, 11h
                jz      short loc_14022247B
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140222474
                test    al, 1
                jz      short loc_140222474
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140222474
                cmp     bl, 0Fh
                ja      short loc_140222474
                cmp     al, 2
                jb      short loc_140222474
                mov     r10, gs:20h
                mov     r9, 0FFFFFFFFFFFFFFFFh
                mov     r8, [r10+84B8h]
                mov     edx, [r8+14h]
                movzx   ebx, [rsp+78h+arg_0]
                lea     ecx, [rbx+1]
                shl     r9, cl
                movzx   eax, r9w
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_140222474
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140222474:                          ; CODE XREF: sub_140221EA0+57E↑j
                                        ; sub_140221EA0+582↑j ...
                movzx   eax, bl
                mov     cr8, rax

loc_14022247B:                          ; CODE XREF: sub_140221EA0+574↑j
                inc     cs:dword_140C4E610
                jmp     loc_140222342
; ---------------------------------------------------------------------------

loc_140222486:                          ; CODE XREF: sub_140221EA0+14C↑j
                                        ; sub_140221EA0+159↑j
                                        ; DATA XREF: ...
                mov     rdi, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rdi
                movzx   ebx, [rsp+78h+arg_0]
                cmp     bl, 11h
                jz      short loc_140222507
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140222500
                test    al, 1
                jz      short loc_140222500
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140222500
                cmp     bl, 0Fh
                ja      short loc_140222500
                cmp     al, 2
                jb      short loc_140222500
                mov     r10, gs:20h
                mov     r9, 0FFFFFFFFFFFFFFFFh
                mov     r8, [r10+84B8h]
                mov     edx, [r8+14h]
                movzx   ebx, [rsp+78h+arg_0]
                lea     ecx, [rbx+1]
                shl     r9, cl
                movzx   eax, r9w
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_140222500
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140222500:                          ; CODE XREF: sub_140221EA0+60A↑j
                                        ; sub_140221EA0+60E↑j ...
                movzx   eax, bl
                mov     cr8, rax

loc_140222507:                          ; CODE XREF: sub_140221EA0+600↑j
                inc     cs:dword_140C4E60C
                mov     eax, 0C0000005h
                jmp     loc_14022234C
; ---------------------------------------------------------------------------

loc_140222517:                          ; CODE XREF: sub_140221EA0+20↑j
                                        ; sub_140221EA0+48↑j
                                        ; DATA XREF: ...
                cmp     qword ptr [rsi+50h], 0
                jz      short loc_140222553
                mov     rcx, [rsi]
                call    sub_14026A130
                test    rax, rax
                jz      short loc_14022253E
                mov     ecx, [rax+30h]
                mov     eax, ecx
                and     al, 70h
                cmp     al, 40h ; '@'
                jz      short loc_140222553
                and     cl, 70h
                cmp     cl, 10h
                jz      short loc_140222553

loc_14022253E:                          ; CODE XREF: sub_140221EA0+689↑j
                inc     cs:dword_140C4E618
                mov     eax, 0C0000005h
                add     rsp, 60h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140222553:                          ; CODE XREF: sub_140221EA0+67C↑j
                                        ; sub_140221EA0+694↑j ...
                mov     rdx, [rsi+80h]
                xor     r9d, r9d
                mov     [rsp+78h+var_50], 0
                xor     ecx, ecx
                mov     [rsp+78h+var_58], 0
                lea     r8d, [r9+1]
                call    sub_1402E7DF4
                test    eax, eax
                jns     short loc_14022258E
                inc     cs:dword_140C4E61C
                add     rsp, 60h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14022258E:                          ; CODE XREF: sub_140221EA0+6DC↑j
                mov     rax, [rsi+38h]
                mov     ecx, 800h
                or      [rax+0Ah], cx
                xor     eax, eax
                add     rsp, 60h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140221EA0   endp

algn_1402225A7:                         ; DATA XREF: .pdata:00000001400CAD94↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402225B0   proc near               ; CODE XREF: sub_140221A30+14E↑p
                                        ; sub_140221A30+3E0↑p ...

var_48          = qword ptr -48h
var_28          = byte ptr -28h
arg_0           = qword ptr  8

; FUNCTION CHUNK AT 00000001404296DC SIZE 00000138 BYTES

                mov     r11, rsp
                mov     [r11+10h], rbx
                mov     [r11+18h], rbp
                mov     [r11+20h], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 40h
                mov     rbp, [rcx]
                mov     r9, 7FFFFFFFF8h
                mov     rax, cs:qword_14001D278
                mov     rsi, rbp
                mov     r14, [rcx+60h]
                mov     rdi, rcx
                shr     rsi, 9
                and     rsi, r9
                mov     [rcx+28h], rax
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                add     rsi, rax
                mov     rcx, rsi
                mov     [r11-48h], rsi
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                add     rcx, rax
                mov     [r11-40h], rcx
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                add     rcx, rax
                mov     [r11-38h], rcx
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                mov     rdx, [rdi+20h]
                add     rcx, rax
                mov     [r11-30h], rcx
                mov     r12, 0FFFFF6FB7DBEDF68h
                mov     r13, 0FFFFF6FB7DBED000h
                mov     r10, 0FFFFF6FB7DBED7F8h
                test    rdx, rdx
                jnz     short loc_1402226D3

loc_140222666:                          ; CODE XREF: sub_1402225B0+14D↓j
                mov     r8d, 4
                mov     rdx, rbp
                mov     rcx, r14
                call    sub_1402258A0
                movsxd  rbx, eax
                test    eax, eax
                jz      loc_140222876
                mov     rcx, [rsp+rbx*8+68h+var_48]
                mov     [rdi+20h], rcx
                cmp     ebx, 1
                jnz     short loc_14022270F

loc_140222690:                          ; CODE XREF: sub_1402225B0+166↓j
                                        ; sub_1402225B0+1CC↓j
                mov     r10, 0FFFFF6FB7DBED7F8h

loc_14022269A:                          ; CODE XREF: sub_1402225B0+137↓j
                mov     rcx, [rsi]
                mov     rax, r13
                cmp     rsi, rax
                jnb     short loc_140222702

loc_1402226A5:                          ; CODE XREF: sub_1402225B0+158↓j
                                        ; sub_1402225B0+2071C2↓j ...
                test    cl, 1
                jz      loc_140222834
                mov     [rdi+28h], rcx

loc_1402226B2:                          ; CODE XREF: sub_1402225B0+1B1↓j
                xor     eax, eax

loc_1402226B4:                          ; CODE XREF: sub_1402225B0+2C1↓j
                                        ; sub_1402225B0+20725F↓j
                lea     r11, [rsp+68h+var_28]
                mov     rbx, [r11+38h]
                mov     rbp, [r11+40h]
                mov     rsi, [r11+48h]
                mov     rsp, r11
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402226D3:                          ; CODE XREF: sub_1402225B0+B4↑j
                mov     rcx, [rdi+10h]
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                add     rcx, rax
                cmp     rdx, rcx
                jz      short loc_14022269A
                mov     rcx, r14
                call    sub_140312B40
                and     dword ptr [rdi+40h], 0FFFFFFDFh
                mov     qword ptr [rdi+20h], 0
                jmp     loc_140222666
; ---------------------------------------------------------------------------

loc_140222702:                          ; CODE XREF: sub_1402225B0+F3↑j
                mov     rax, r10
                cmp     rsi, rax
                ja      short loc_1402226A5
                jmp     loc_140429768
; ---------------------------------------------------------------------------

loc_14022270F:                          ; CODE XREF: sub_1402225B0+DE↑j
                dec     ebx

loc_140222711:                          ; CODE XREF: sub_1402225B0+2AA↓j
                                        ; sub_1402225B0+2E0↓j
                movsxd  r15, ebx
                test    ebx, ebx
                jz      loc_140222690

loc_14022271C:                          ; CODE XREF: sub_1402225B0+1C5↓j
                mov     rsi, [rsp+r15*8+68h+var_48]
                mov     rcx, rsi
                call    sub_1402805F0
                mov     [rsp+68h+arg_0], rax
                mov     rbx, rax
                test    al, 1
                jz      loc_14022285F
                test    bl, bl
                js      short loc_140222781
                xor     r12b, r12b

loc_140222740:                          ; CODE XREF: sub_1402225B0+27F↓j
                xor     r8d, r8d
                mov     rdx, rsi
                mov     rcx, r14
                call    sub_140225CC0
                mov     rdx, [rdi+20h]
                mov     rcx, r14
                call    sub_140312B40
                mov     [rdi+20h], rsi
                test    r12b, r12b
                jnz     loc_1402226B2
                mov     r12, 0FFFFF6FB7DBEDF68h

loc_140222771:                          ; CODE XREF: sub_1402225B0+300↓j
                sub     r15, 1
                jnz     short loc_14022271C
                mov     rsi, [rsp+68h+var_48]
                jmp     loc_140222690
; ---------------------------------------------------------------------------

loc_140222781:                          ; CODE XREF: sub_1402225B0+18B↑j
                cmp     dword ptr [rdi+58h], 1
                jnz     short loc_140222792
                bt      rbx, 0Bh
                jnb     loc_140429804

loc_140222792:                          ; CODE XREF: sub_1402225B0+1D5↑j
                lea     rcx, [rsp+68h+arg_0]
                mov     r12b, 1
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_1404296DC

loc_1402227A7:                          ; CODE XREF: sub_1402225B0+207136↓j
                                        ; sub_1402225B0+207153↓j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                shr     rbp, 0Ch
                mov     r9d, 1
                test    r15, r15
                jz      short loc_1402227E4

loc_1402227C7:                          ; CODE XREF: sub_1402225B0+232↓j
                mov     rax, rbp
                shr     rbp, 9
                and     eax, 1FFh
                imul    rax, r9
                shl     r9, 9
                add     rbx, rax
                sub     r15, 1
                jnz     short loc_1402227C7

loc_1402227E4:                          ; CODE XREF: sub_1402225B0+215↑j
                mov     rcx, [rdi]
                mov     r8, r9
                shl     r8, 0Ch
                mov     rax, rcx
                mov     [rdi+80h], rbx
                lea     rdx, [r8-1]
                not     rdx
                and     rax, rdx
                mov     [rdi+90h], rax
                lea     rax, [r8+rcx]
                and     rax, rdx
                dec     rax
                mov     [rdi+98h], rax
                lea     rax, [r9-1]
                not     rax
                and     rax, rbx
                or      dword ptr [rdi+40h], 20h
                mov     [rdi+0A0h], rax
                jmp     loc_140222740
; ---------------------------------------------------------------------------

loc_140222834:                          ; CODE XREF: sub_1402225B0+F8↑j
                mov     rcx, rdi
                call    sub_1403488E4
                test    eax, eax
                js      short loc_14022286B
                mov     rax, r12
                mov     [rdi+20h], rax
                mov     rdx, r12
                xor     r8d, r8d
                mov     rcx, r14
                call    sub_140225CC0
                mov     ebx, 3
                jmp     loc_140222711
; ---------------------------------------------------------------------------

loc_14022285F:                          ; CODE XREF: sub_1402225B0+183↑j
                mov     rcx, rdi
                call    sub_1403488E4
                test    eax, eax
                jns     short loc_140222895

loc_14022286B:                          ; CODE XREF: sub_1402225B0+28E↑j
                inc     cs:dword_140C4E5FC
                jmp     loc_1402226B4
; ---------------------------------------------------------------------------

loc_140222876:                          ; CODE XREF: sub_1402225B0+CC↑j
                mov     ebx, 3
                mov     rax, r12
                mov     [rdi+20h], rax
                mov     rdx, r12
                xor     r8d, r8d
                mov     rcx, r14
                call    sub_140225CC0
                jmp     loc_140222711
; ---------------------------------------------------------------------------

loc_140222895:                          ; CODE XREF: sub_1402225B0+2B9↑j
                mov     rax, r12
                mov     [rdi+20h], rax
                mov     rdx, r12
                xor     r8d, r8d
                mov     rcx, r14
                call    sub_140225CC0
                mov     r15d, 4
                jmp     loc_140222771
sub_1402225B0   endp

; ---------------------------------------------------------------------------
algn_1402228B5:                         ; DATA XREF: .rdata:0000000140052B14↑o
                                        ; .pdata:00000001400CADA0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402228C0   proc near               ; CODE XREF: sub_140221A30+16E↑p
                                        ; sub_140348750+36↓p
                                        ; DATA XREF: ...

var_38          = qword ptr -38h
arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_8], rdx
                push    rbx
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 28h
                mov     rbx, [rcx+28h]
                xor     r15d, r15d
                mov     r14d, [rcx+40h]
                mov     r9, rdx
                mov     r12, [rcx]
                and     r14d, 0Fh
                mov     r13d, [rcx+58h]
                mov     rdi, rcx
                mov     [rdx], r15d
                mov     [rsp+58h+arg_18], rbx
                test    bl, 4
                jnz     short loc_14022291D
                cmp     r14d, 1
                jnz     short loc_14022291D
                inc     cs:dword_140C4E608
                mov     eax, 0C0000005h
                add     rsp, 28h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022291D:                          ; CODE XREF: sub_1402228C0+3A↑j
                                        ; sub_1402228C0+40↑j
                mov     rcx, 0FFFFF6FB7DBED000h
                lea     rax, [rsp+58h+arg_18]
                cmp     rax, rcx
                jb      short loc_1402229A5
                mov     rcx, 0FFFFF6FB7DBED7F8h
                lea     rax, [rsp+58h+arg_18]
                cmp     rax, rcx
                ja      short loc_1402229A5
                mov     rdx, rbx
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402229A8
                test    dl, 1
                jz      short loc_1402229A8
                test    dl, 20h
                jz      short loc_140222960
                test    dl, 42h
                jnz     short loc_1402229A8

loc_140222960:                          ; CODE XREF: sub_1402228C0+99↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14022299E
                or      rdx, 20h
                lea     rax, [rsp+58h+arg_18]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                test    al, 42h

loc_14022299E:                          ; CODE XREF: sub_1402228C0+BA↑j
                mov     rbx, [rsp+58h+arg_18]
                jmp     short loc_1402229A8
; ---------------------------------------------------------------------------

loc_1402229A5:                          ; CODE XREF: sub_1402228C0+6F↑j
                                        ; sub_1402228C0+83↑j
                mov     rdx, rbx

loc_1402229A8:                          ; CODE XREF: sub_1402228C0+8F↑j
                                        ; sub_1402228C0+94↑j ...
                shr     rdx, 0Ch
                mov     r10, 0FFFFFFFFFh
                and     rdx, r10

loc_1402229B9:                          ; DATA XREF: .rdata:0000000140052B44↑o
                                        ; .rdata:0000000140052B54↑o ...
                mov     [rsp+58h+var_38], rsi
                lea     r8, [rdx+rdx*2]
                shl     r8, 4
                mov     rax, 0FFFFFA8000000028h
                mov     rax, [r8+rax]
                mov     r11, 0FFFF800000000000h
                shr     rax, 32h
                and     eax, 1
                jz      loc_140222B79
                mov     rax, 0FFFFFA8000000000h
                mov     rcx, cs:qword_140C4ED00
                lea     rsi, [r8+rax]
                test    rcx, rcx
                jz      short loc_140222A53
                mov     rax, [rsi+28h]
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 1
                jnz     short loc_140222A53
                mov     rax, 0AAAAAAAAAAAAAAABh
                mul     r8
                shr     rdx, 5
                test    rcx, rcx
                jz      short loc_140222A53
                nop     dword ptr [rax+00000000h]

loc_140222A30:                          ; CODE XREF: sub_1402228C0+191↓j
                mov     r8, [rcx+18h]
                cmp     rdx, r8
                jb      short loc_140222A4B
                mov     rax, rdx
                sub     rax, r8
                cmp     rax, [rcx+20h]
                jb      short loc_140222AC2
                mov     rcx, [rcx+8]
                jmp     short loc_140222A4E
; ---------------------------------------------------------------------------

loc_140222A4B:                          ; CODE XREF: sub_1402228C0+177↑j
                mov     rcx, [rcx]

loc_140222A4E:                          ; CODE XREF: sub_1402228C0+189↑j
                test    rcx, rcx
                jnz     short loc_140222A30

loc_140222A53:                          ; CODE XREF: sub_1402228C0+143↑j
                                        ; sub_1402228C0+151↑j ...
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                jnz     short loc_140222AAE
                mov     rdx, [rsi+28h]
                mov     rax, 1000000000h
                test    rax, rdx
                jz      short loc_140222AD2
                lea     r8, [rsp+58h+arg_10]
                mov     [rsp+58h+arg_0], r15d
                lea     rdx, [rsp+58h+arg_0]
                mov     [rsp+58h+arg_10], r15d
                call    sub_1403F6524
                cmp     eax, 3
                jz      loc_140222B69
                cmp     [rsp+58h+arg_0], 6
                jnz     loc_140222B69
                mov     r9, [rsp+58h+arg_8]
                mov     r11, 0FFFF800000000000h

loc_140222AAE:                          ; CODE XREF: sub_1402228C0+19D↑j
                                        ; sub_1402228C0+238↓j ...
                mov     ecx, r15d
                cmp     r12, r11
                jnb     loc_140222B81
                mov     eax, r15d
                jmp     loc_140222B9D
; ---------------------------------------------------------------------------

loc_140222AC2:                          ; CODE XREF: sub_1402228C0+183↑j
                inc     cs:dword_140C4E638
                mov     eax, 0C0000005h
                jmp     loc_140222F3A
; ---------------------------------------------------------------------------

loc_140222AD2:                          ; CODE XREF: sub_1402228C0+1B0↑j
                mov     rcx, [rsi+8]
                shl     rcx, 19h
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                mov     rax, r8
                cmp     rcx, rax
                jb      short loc_140222AAE
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     rcx, rax
                ja      short loc_140222AAE
                and     rdx, r10
                mov     rax, 0FFFFFFFFDh
                cmp     rdx, rax
                jz      short loc_140222AAE
                movzx   ecx, byte ptr [rsi+22h]
                test    cl, 20h
                jz      short loc_140222B3F
                mov     rdx, 3FFFFFFFFFFFFFFFh
                test    [rsi+18h], rdx
                jnz     short loc_140222B3F
                cmp     [rsi+20h], r15w
                jnz     loc_140222AAE

loc_140222B3F:                          ; CODE XREF: sub_1402228C0+262↑j
                                        ; sub_1402228C0+272↑j
                test    cl, 8
                jnz     loc_140222AAE
                mov     rax, [rsi]
                mov     rcx, 0FFFF800000000030h
                shr     rax, 0Dh
                and     rax, 0FFFFFFFFFFFFFFF0h
                or      rax, r11
                cmp     rax, rcx
                jz      loc_140222AAE

loc_140222B69:                          ; CODE XREF: sub_1402228C0+1CE↑j
                                        ; sub_1402228C0+1D9↑j
                inc     cs:dword_140C4E634

loc_140222B6F:                          ; CODE XREF: sub_1402228C0+30D↓j
                                        ; sub_1402228C0+60F↓j
                mov     eax, 0C0000005h
                jmp     loc_140222F3A
; ---------------------------------------------------------------------------

loc_140222B79:                          ; CODE XREF: sub_1402228C0+125↑j
                mov     rsi, r15
                jmp     loc_140222AAE
; ---------------------------------------------------------------------------

loc_140222B81:                          ; CODE XREF: sub_1402228C0+1F4↑j
                mov     rax, r12
                lea     rdx, unk_140C4F848
                shr     rax, 27h
                and     eax, 1FFh
                sub     eax, 100h
                movzx   eax, byte ptr [rax+rdx]

loc_140222B9D:                          ; CODE XREF: sub_1402228C0+1FD↑j
                mov     r10d, 1
                cmp     r14d, 6
                jnz     short loc_140222BB0
                cmp     eax, 0Ch
                cmovz   ecx, r10d

loc_140222BB0:                          ; CODE XREF: sub_1402228C0+2E7↑j
                mov     r8, 8000000000000000h
                cmp     r13d, 3
                jnz     short loc_140222BED
                mov     rax, 7FFFFFFEFFFFh
                cmp     r12, rax
                ja      short loc_140222B6F
                test    r8, rbx
                jz      loc_140222CAD
                bt      rbx, 0Bh
                jnb     loc_140222CB4
                mov     eax, 0C0000018h
                jmp     loc_140222F3A
; ---------------------------------------------------------------------------

loc_140222BED:                          ; CODE XREF: sub_1402228C0+2FE↑j
                test    r13d, r13d
                jnz     loc_140222CAD
                test    ecx, ecx
                jz      loc_140222D8C
                test    rsi, rsi
                jz      loc_140222F38
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_140222D8C
                call    sub_1402E39C0
                cmp     eax, r10d
                jz      short loc_140222C32
                mov     rcx, rsi
                call    sub_1402303F0
                cmp     eax, r10d
                jnz     loc_140222D8C

loc_140222C32:                          ; CODE XREF: sub_1402228C0+35F↑j
                mov     rax, [rsi+10h]
                bt      rax, 0Ah
                jnb     short loc_140222C65
                mov     rcx, cs:qword_140C4DDC0
                test    rcx, rcx
                jz      short loc_140222C53
                test    al, 10h
                jnz     short loc_140222C53
                not     rcx
                and     rax, rcx

loc_140222C53:                          ; CODE XREF: sub_1402228C0+387↑j
                                        ; sub_1402228C0+38B↑j
                sar     rax, 10h
                mov     rcx, [rax]
                mov     eax, [rcx+38h]
                test    al, 20h
                jz      loc_140222D8C

loc_140222C65:                          ; CODE XREF: sub_1402228C0+37B↑j
                mov     rcx, [rdi+10h]
                call    sub_140261B30
                mov     r14, rax
                test    rax, rax
                jz      loc_140222D7C
                mov     rcx, rdi
                call    sub_140348A5C
                mov     rdx, [rdi+10h]
                mov     rcx, r14
                call    sub_1408C6484
                mov     rcx, rdi
                mov     ebx, eax
                call    sub_140348A14
                test    ebx, ebx
                jns     loc_140222F2D
                inc     cs:dword_140C4E630
                mov     eax, ebx
                jmp     loc_140222F3A
; ---------------------------------------------------------------------------

loc_140222CAD:                          ; CODE XREF: sub_1402228C0+312↑j
                                        ; sub_1402228C0+330↑j
                bt      rbx, 0Bh
                jb      short loc_140222D1A

loc_140222CB4:                          ; CODE XREF: sub_1402228C0+31D↑j
                cmp     r13d, 3
                jz      short loc_140222CD0
                cmp     r14d, 6
                jnz     short loc_140222CC4
                test    ecx, ecx
                jnz     short loc_140222CD0

loc_140222CC4:                          ; CODE XREF: sub_1402228C0+3FE↑j
                mov     dword ptr [r9], 2
                jmp     loc_140222F38
; ---------------------------------------------------------------------------

loc_140222CD0:                          ; CODE XREF: sub_1402228C0+3F8↑j
                                        ; sub_1402228C0+402↑j
                test    rsi, rsi
                jz      loc_140222E3A
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                jnz     loc_140222E3A
                test    cs:dword_140CFC400, 8000h
                jz      loc_140222F38
                mov     rax, [rsi+28h]
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 3
                jnz     loc_140222F38
                mov     edx, 8
                call    sub_1402D69E8
                jmp     loc_140222F38
; ---------------------------------------------------------------------------

loc_140222D1A:                          ; CODE XREF: sub_1402228C0+3F2↑j
                test    bl, 42h
                jnz     short loc_140222D8C
                cmp     r14d, r10d
                jnz     short loc_140222D8C
                mov     rax, [rdi+50h]
                test    dword ptr [rax+464h], 8000h
                jnz     short loc_140222D43
                mov     rdx, r12
                mov     rcx, rbx
                call    sub_14033F9E4
                test    eax, eax
                jnz     short loc_140222D8C

loc_140222D43:                          ; CODE XREF: sub_1402228C0+472↑j
                mov     rcx, rdi
                call    sub_140348A5C
                xor     r9d, r9d
                xor     r8d, r8d
                mov     rdx, r12
                lea     ecx, [r9+2]
                call    sub_140224260
                mov     rcx, rdi
                mov     ebx, eax
                call    sub_140348A14
                test    ebx, ebx
                jns     loc_140222F2D
                inc     cs:dword_140C4E600
                mov     eax, ebx
                jmp     loc_140222F3A
; ---------------------------------------------------------------------------

loc_140222D7C:                          ; CODE XREF: sub_1402228C0+3B4↑j
                mov     r10d, 1
                mov     r8, 8000000000000000h

loc_140222D8C:                          ; CODE XREF: sub_1402228C0+338↑j
                                        ; sub_1402228C0+351↑j ...
                test    rsi, rsi
                jz      loc_140222F38
                movzx   eax, byte ptr [rsi+22h]
                test    al, 20h
                jz      short loc_140222DB5
                test    al, 8
                jnz     short loc_140222DB5
                mov     rcx, 3FFFFFFFFFFFFFFFh
                test    [rsi+18h], rcx
                jz      loc_140222F38

loc_140222DB5:                          ; CODE XREF: sub_1402228C0+4DB↑j
                                        ; sub_1402228C0+4DF↑j
                mov     rcx, [rsi+28h]
                mov     rax, rcx
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 1
                jz      short loc_140222DE0
                mov     rax, 1000000000h
                test    rax, rcx
                jnz     short loc_140222DE0
                mov     rax, [rsi+8]
                test    rax, rax
                js      short loc_140222DE0
                jnz     short loc_140222E3A

loc_140222DE0:                          ; CODE XREF: sub_1402228C0+504↑j
                                        ; sub_1402228C0+513↑j ...
                test    r13d, r13d
                jnz     loc_140222F38
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_140222F38
                mov     rcx, [rdi+50h]
                test    rcx, rcx
                jz      loc_140222F38
                mov     eax, [rdi+40h]
                test    al, 10h
                jz      loc_140222F38
                mov     rdx, [rsi+8]
                or      rdx, r8
                call    sub_1402C6E74
                test    rax, rax
                jz      loc_140222F38
                mov     rcx, [rcx+690h]
                mov     rax, [rax+60h]
                cmp     [rcx+168h], rax
                ja      short loc_140222E88

loc_140222E3A:                          ; CODE XREF: sub_1402228C0+413↑j
                                        ; sub_1402228C0+423↑j ...
                cmp     r13d, 3
                jnz     loc_140222EDC
                test    r8, rbx
                jz      short loc_140222E53
                mov     eax, 0C0000045h
                jmp     loc_140222F3A
; ---------------------------------------------------------------------------

loc_140222E53:                          ; CODE XREF: sub_1402228C0+587↑j
                mov     rcx, [rdi+50h]
                test    rcx, rcx
                jz      short loc_140222EA3
                mov     eax, [rdi+40h]
                test    al, 10h
                jz      short loc_140222EA3
                mov     rdx, [rsi+8]
                or      rdx, r8
                call    sub_1402C6E74
                test    rax, rax
                jz      short loc_140222EA3
                mov     rcx, [rcx+690h]
                mov     rax, [rax+60h]
                cmp     [rcx+168h], rax
                jbe     short loc_140222EDC

loc_140222E88:                          ; CODE XREF: sub_1402228C0+578↑j
                mov     rcx, rdi
                call    sub_140530F64
                test    eax, eax
                jns     loc_140222F2D
                inc     cs:dword_140C4E62C
                jmp     loc_140222F3A
; ---------------------------------------------------------------------------

loc_140222EA3:                          ; CODE XREF: sub_1402228C0+59A↑j
                                        ; sub_1402228C0+5A1↑j ...
                bt      rbx, 9
                jb      short loc_140222EDC
                mov     rcx, 1000000000h
                test    [rsi+28h], rcx
                jnz     short loc_140222EC5
                mov     rax, [rsi+8]
                test    rax, rax
                js      short loc_140222EC5
                jnz     short loc_140222EDC

loc_140222EC5:                          ; CODE XREF: sub_1402228C0+5F8↑j
                                        ; sub_1402228C0+601↑j
                mov     rcx, r12
                call    sub_140201780
                test    eax, eax
                jz      loc_140222B6F
                inc     qword ptr [rdi+68h]
                mov     r15d, r10d

loc_140222EDC:                          ; CODE XREF: sub_1402228C0+57E↑j
                                        ; sub_1402228C0+5C6↑j ...
                mov     rdx, [rdi+10h]
                xor     r9d, r9d
                mov     rcx, r12
                lea     r8, [r9-1]
                call    sub_1402C50E0
                mov     ebx, eax
                test    eax, eax
                jns     short loc_140222F2D
                test    r15d, r15d
                jz      short loc_140222EFE
                dec     qword ptr [rdi+68h]

loc_140222EFE:                          ; CODE XREF: sub_1402228C0+638↑j
                cmp     byte ptr [rdi+44h], 2
                jz      short loc_140222F4F
                mov     rcx, [rdi+48h]
                mov     eax, [rcx+514h]
                test    al, 0Ch
                jnz     short loc_140222F4F
                mov     rcx, rdi
                call    sub_140348A5C
                mov     rcx, [rdi+60h]
                mov     edx, ebx
                call    sub_14055C0F8
                mov     rcx, rdi
                call    sub_140348A14

loc_140222F2D:                          ; CODE XREF: sub_1402228C0+3DA↑j
                                        ; sub_1402228C0+4A9↑j ...
                mov     rax, [rsp+58h+arg_8]
                mov     dword ptr [rax], 1

loc_140222F38:                          ; CODE XREF: sub_1402228C0+341↑j
                                        ; sub_1402228C0+40B↑j ...
                xor     eax, eax

loc_140222F3A:                          ; CODE XREF: sub_1402228C0+20D↑j
                                        ; sub_1402228C0+2B4↑j ...
                mov     rsi, [rsp+58h+var_38]
                add     rsp, 28h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
byte_140222F4E  db 0CCh                 ; DATA XREF: .pdata:00000001400CADB8↑o
                                        ; .pdata:00000001400CADC4↑o
; ---------------------------------------------------------------------------

loc_140222F4F:                          ; CODE XREF: sub_1402228C0+642↑j
                                        ; sub_1402228C0+650↑j
                                        ; DATA XREF: ...
                inc     cs:dword_140C4E630
                mov     eax, 0C0000017h
                jmp     short loc_140222F3A
sub_1402228C0   endp

; ---------------------------------------------------------------------------
byte_140222F5C  db 14h dup(0CCh)        ; DATA XREF: .pdata:00000001400CADD0↑o

; =============== S U B R O U T I N E =======================================


sub_140222F70   proc near               ; CODE XREF: sub_140220490+366↑p
                                        ; sub_140222F70+886↓p
                                        ; DATA XREF: ...

var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = byte ptr -58h
arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_10], r8d
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 58h
                mov     rax, [rcx+98h]
                mov     r12, rdx
                mov     rsi, [rcx+18h]
                lea     rdx, [rcx+50h]
                mov     [rsp+98h+var_60], rax
                xor     r15d, r15d
                movsxd  rbp, r8d
                mov     rdi, rcx
                mov     rax, rbp
                mov     [rsp+98h+arg_8], rsi
                mov     [rsp+98h+var_70], rax
                mov     r14d, r15d
                shl     rax, 4
                add     rdx, rax
                mov     [rsp+98h+var_78], rax
                mov     [rsp+98h+arg_18], rdx
                mov     rax, [rdx]
                cmp     r12, rax
                cmovb   r12, rax
                cmp     ebp, 3
                jnz     short loc_140222FE4
                mov     rcx, [rcx+88h]
                jmp     short loc_140223000
; ---------------------------------------------------------------------------

loc_140222FE4:                          ; CODE XREF: sub_140222F70+69↑j
                mov     rax, [rdx+8]
                mov     rcx, r12
                and     rcx, 0FFFFFFFFFFFFF000h
                add     rcx, 0FF8h
                cmp     rcx, rax
                cmova   rcx, rax

loc_140223000:                          ; CODE XREF: sub_140222F70+72↑j
                mov     [rsp+98h+var_68], rcx
                mov     r13d, r15d
                mov     ebx, 4
                cmp     r12, rcx
                ja      loc_140223187

loc_140223016:                          ; CODE XREF: sub_140222F70+BD4↓j
                mov     rcx, 0FFFFF68000000000h
                mov     rdx, 7FFFFFFFF8h
                test    r13d, r13d
                jz      loc_1402230F6
                mov     r13d, r15d
                cmp     r14d, 3
                jge     loc_14022317F
                test    byte ptr [rdi+2], 1
                jz      loc_1402230F6
                cmp     ebp, 3
                jnz     loc_140223BB9
                test    byte ptr [rdi], 4
                mov     rbx, [rdi+18h]
                jz      short loc_1402230C5
                mov     rsi, r12
                shr     rsi, 9
                and     rsi, rdx
                mov     rax, rcx
                mov     rcx, rbx
                add     rsi, rax
                call    sub_140231340
                mov     rdx, rsi
                mov     rax, 0FFFFF68000000000h
                shl     rdx, 19h
                mov     rax, rax
                shl     rax, 19h
                lea     r8, [rsp+98h+var_58]
                sub     rdx, rax
                mov     rcx, rbx
                sar     rdx, 10h
                call    sub_1402A82C0
                cmp     rax, rsi
                jz      short loc_1402230BF
                mov     rdx, rax
                mov     rcx, rbx
                call    sub_140312B40
                movzx   edx, byte ptr [rdi+6]
                mov     rcx, [rdi+18h]
                call    sub_140226960
                jmp     short loc_1402230F6
; ---------------------------------------------------------------------------

loc_1402230BF:                          ; CODE XREF: sub_140222F70+133↑j
                mov     [rdi+30h], rsi
                jmp     short loc_1402230F2
; ---------------------------------------------------------------------------

loc_1402230C5:                          ; CODE XREF: sub_140222F70+EA↑j
                mov     rcx, rbx
                call    sub_1402325E0
                mov     rcx, rax
                mov     rbx, rax
                call    ExAcquireSpinLockExclusive
                mov     ecx, 400h
                mov     [rbx+4], r15d
                test    [rdi], cx
                jz      short loc_1402230F2
                lea     rcx, dword_140C4E19C
                call    ExAcquireSpinLockExclusiveAtDpcLevel

loc_1402230F2:                          ; CODE XREF: sub_140222F70+153↑j
                                        ; sub_140222F70+174↑j
                and     byte ptr [rdi+2], 0FEh

loc_1402230F6:                          ; CODE XREF: sub_140222F70+BD↑j
                                        ; sub_140222F70+D4↑j ...
                inc     qword ptr [rdi+90h]
                movzx   esi, word ptr [rdi]
                mov     rbx, [rdi+90h]
                test    sil, 8
                jz      loc_1402231DC
                test    bl, 0Fh
                jnz     loc_1402231DC
                mov     rax, [rdi+48h]
                mov     r8, [rax+1BC0h]
                cmp     r8, 420h
                jnb     loc_1402231DC
                mov     r9d, cs:dword_140C4DD7C
                lea     r10, [rax+1068h]
                mov     r11, r15

loc_140223143:                          ; CODE XREF: sub_140222F70+205↓j
                mov     rax, [r10]
                mov     edx, r15d
                test    r9d, r9d
                jz      short loc_14022316A
                xchg    ax, ax

loc_140223150:                          ; CODE XREF: sub_140222F70+1F8↓j
                movzx   ecx, word ptr [rax]
                add     r8, rcx
                cmp     r8, 420h
                jnb     short loc_1402231DC
                inc     edx
                add     rax, 10h
                cmp     edx, r9d
                jb      short loc_140223150

loc_14022316A:                          ; CODE XREF: sub_140222F70+1DC↑j
                inc     r11
                add     r10, 8
                cmp     r11, 1
                jle     short loc_140223143
                mov     ebx, 4
                mov     r14d, ebx

loc_14022317F:                          ; CODE XREF: sub_140222F70+CA↑j
                                        ; sub_140222F70+BCE↓j
                mov     rsi, [rsp+98h+arg_8]

loc_140223187:                          ; CODE XREF: sub_140222F70+A0↑j
                cmp     ebp, 3
                jnz     loc_140223BB9
                movzx   ecx, byte ptr [rdi+2]
                movzx   eax, cl
                test    cl, 1
                jnz     loc_140223B72
                test    byte ptr [rdi], 40h
                jz      short loc_1402231AE
                cmp     r14d, ebp
                jz      loc_140223B72

loc_1402231AE:                          ; CODE XREF: sub_140222F70+233↑j
                mov     rdx, [rdi+0A0h]
                movzx   eax, cl
                or      al, 2
                mov     [rdi+2], al
                test    rdx, rdx
                jz      loc_140223B49
                mov     rcx, rdi
                mov     rax, rdx
                call    sub_1404079D0
                mov     ebx, eax
                movzx   eax, byte ptr [rdi+2]
                jmp     loc_140223B4C
; ---------------------------------------------------------------------------

loc_1402231DC:                          ; CODE XREF: sub_140222F70+19B↑j
                                        ; sub_140222F70+1A4↑j ...
                test    sil, 2
                jz      loc_140223534
                test    [rdi+5], bl
                jnz     loc_140223534
                mov     r10, [rdi+18h]
                movzx   eax, byte ptr [r10+0B8h]
                and     al, 7
                cmp     al, 2
                lea     rax, unk_140C4F600
                jz      short loc_14022320F
                lea     rax, [r10+0C0h]

loc_14022320F:                          ; CODE XREF: sub_140222F70+296↑j
                mov     eax, [rax]
                bt      eax, 1Eh
                jb      loc_140223514
                test    byte ptr [rdi], 4
                jz      loc_140223422
                mov     rax, 7FFFFFFFF8h
                mov     r9, r12
                shr     r9, 9
                and     r9, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                movzx   edx, byte ptr [r10+0B8h]
                add     r9, rax
                and     dl, 7
                mov     [rsp+98h+arg_0], r15d
                mov     rax, 0FFFFF6FB7DBEDF68h
                mov     rax, rax
                cmp     r9, rax
                jnz     short loc_1402232C8
                mov     rax, gs:20h
                test    dl, dl
                jnz     short loc_14022328B
                add     rax, 8D70h
                mov     rax, [rax]
                test    rax, rax
                jmp     loc_14022341C
; ---------------------------------------------------------------------------

loc_14022328B:                          ; CODE XREF: sub_140222F70+308↑j
                cmp     dl, 7
                jnz     short loc_1402232A1
                add     rax, 8D58h
                mov     rax, [rax]
                test    rax, rax
                jmp     loc_14022341C
; ---------------------------------------------------------------------------

loc_1402232A1:                          ; CODE XREF: sub_140222F70+31E↑j
                cmp     dl, 5
                jnz     short loc_1402232B7
                add     rax, 8D40h
                mov     rax, [rax]
                test    rax, rax
                jmp     loc_14022341C
; ---------------------------------------------------------------------------

loc_1402232B7:                          ; CODE XREF: sub_140222F70+334↑j
                add     rax, 8D88h
                mov     rax, [rax]
                test    rax, rax
                jmp     loc_14022341C
; ---------------------------------------------------------------------------

loc_1402232C8:                          ; CODE XREF: sub_140222F70+2FB↑j
                mov     r8, 0FFFFF6FB7DBED000h
                test    dl, dl
                jnz     short loc_14022332D
                mov     rax, r8
                mov     rcx, 0FFFFF6FB7DBEDFFFh
                cmp     r9, rax
                jb      short loc_140223337
                mov     rax, rcx
                cmp     r9, rax
                ja      short loc_140223337
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+690h]
                mov     rcx, [rax+260h]
                test    rcx, rcx
                jz      short loc_14022332D
                shr     r9d, 3
                and     r9d, 1FFh
                mov     ecx, [rcx+r9*4]
                shr     ecx, 1Eh
                and     ecx, 1
                jmp     loc_14022341A
; ---------------------------------------------------------------------------

loc_14022332D:                          ; CODE XREF: sub_140222F70+364↑j
                                        ; sub_140222F70+3A1↑j
                mov     rcx, 0FFFFF6FB7DBEDFFFh

loc_140223337:                          ; CODE XREF: sub_140222F70+376↑j
                                        ; sub_140222F70+37E↑j
                test    dl, dl
                jz      short loc_140223377
                mov     rax, r8
                cmp     r9, rax
                jb      short loc_140223377
                mov     rax, rcx
                cmp     r9, rax
                ja      short loc_140223377
                lea     r8, [rsp+98h+arg_0]
                mov     rdx, r9
                mov     rcx, r10
                call    sub_140312D68
                mov     edx, [rax]
                mov     ecx, [rsp+98h+arg_0]
                shr     edx, cl
                test    dl, 2
                jz      loc_140223422
                jmp     loc_140223514
; ---------------------------------------------------------------------------

loc_140223377:                          ; CODE XREF: sub_140222F70+3C9↑j
                                        ; sub_140222F70+3D1↑j ...
                mov     rcx, [r9]
                mov     rax, r8
                cmp     r9, rax
                jb      loc_140223413
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r9, rax
                ja      short loc_140223413
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140223413
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_140223413
                test    cl, 1
                jz      short loc_140223413
                test    cl, 20h
                jz      short loc_1402233CC
                test    cl, 42h
                jnz     short loc_140223413

loc_1402233CC:                          ; CODE XREF: sub_140222F70+455↑j
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     rax, [rdx+788h]
                test    rax, rax
                jz      short loc_140223413
                shr     r9, 3
                mov     r8, rcx
                and     r9d, 1FFh
                or      r8, 20h
                mov     rax, [rax+r9*8]
                movzx   edx, al
                and     dl, 20h
                cmovz   r8, rcx
                mov     rcx, r8
                test    al, 42h
                jz      short loc_140223413
                or      rcx, 42h

loc_140223413:                          ; CODE XREF: sub_140222F70+410↑j
                                        ; sub_140222F70+426↑j ...
                shr     rcx, 3Ch
                and     ecx, 2

loc_14022341A:                          ; CODE XREF: sub_140222F70+3B8↑j
                test    ecx, ecx

loc_14022341C:                          ; CODE XREF: sub_140222F70+316↑j
                                        ; sub_140222F70+32C↑j ...
                jnz     loc_140223514

loc_140223422:                          ; CODE XREF: sub_140222F70+2AE↑j
                                        ; sub_140222F70+3FC↑j
                mov     ecx, 400h
                test    [rdi], cx
                jz      short loc_14022343C
                mov     eax, cs:dword_140C4E19C
                bt      eax, 1Eh
                jb      loc_140223514

loc_14022343C:                          ; CODE XREF: sub_140222F70+4BA↑j
                cmp     byte ptr [rdi+6], 2
                jnb     loc_140223534
                mov     rcx, gs:20h
                mov     r8d, [rcx+312Ch]
                mov     esi, [rcx+7BECh]
                mov     ebp, [rcx+7E9Ch]
                test    r8b, 1
                jz      short loc_140223481
                mov     edx, 1
                cmp     ebp, 7
                jbe     short loc_1402234B9
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jz      short loc_1402234C2
                mov     ebx, edx
                jmp     short loc_1402234F8
; ---------------------------------------------------------------------------

loc_140223481:                          ; CODE XREF: sub_140222F70+4F6↑j
                mov     edx, r15d
                test    r8b, 1Eh
                jz      short loc_140223491
                mov     ebx, 2
                jmp     short loc_1402234F8
; ---------------------------------------------------------------------------

loc_140223491:                          ; CODE XREF: sub_140222F70+518↑j
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jz      short loc_1402234A3
                mov     ebx, 3
                jmp     short loc_1402234F8
; ---------------------------------------------------------------------------

loc_1402234A3:                          ; CODE XREF: sub_140222F70+52A↑j
                mov     rax, [rcx+10h]
                test    rax, rax
                jz      short loc_1402234B9
                cmp     rax, [rcx+8]
                jz      short loc_1402234B9
                mov     ebx, 4
                jmp     short loc_1402234F8
; ---------------------------------------------------------------------------

loc_1402234B9:                          ; CODE XREF: sub_140222F70+500↑j
                                        ; sub_140222F70+53A↑j ...
                cmp     esi, 7
                jbe     short loc_14022352D
                test    edx, edx
                jz      short loc_1402234E0

loc_1402234C2:                          ; CODE XREF: sub_140222F70+50B↑j
                test    r8b, 1Eh
                jz      short loc_1402234CF
                mov     ebx, 5
                jmp     short loc_1402234F8
; ---------------------------------------------------------------------------

loc_1402234CF:                          ; CODE XREF: sub_140222F70+556↑j
                mov     rax, [rcx+18h]
                cmp     [rcx+8], rax
                jz      short loc_1402234E0
                mov     ebx, 6
                jmp     short loc_1402234F8
; ---------------------------------------------------------------------------

loc_1402234E0:                          ; CODE XREF: sub_140222F70+550↑j
                                        ; sub_140222F70+567↑j
                cli
                mov     [rcx+7BECh], r15d
                mov     [rcx+7E9Ch], r15d
                call    sub_140326178
                sti
                mov     ebx, r15d

loc_1402234F8:                          ; CODE XREF: sub_140222F70+50F↑j
                                        ; sub_140222F70+51F↑j ...
                test    dword ptr cs:xmmword_140CFC480+4, 4000000h
                jz      short loc_140223510
                mov     r8d, ebp
                mov     edx, esi
                mov     ecx, ebx
                call    sub_1405A83BC

loc_140223510:                          ; CODE XREF: sub_140222F70+592↑j
                test    ebx, ebx
                jz      short loc_14022352D

loc_140223514:                          ; CODE XREF: sub_140222F70+2A5↑j
                                        ; sub_140222F70+402↑j ...
                mov     edx, 1
                mov     rcx, rdi
                call    sub_14033E080
                cmp     eax, 3
                cmovge  r14d, eax
                jmp     loc_140223B27
; ---------------------------------------------------------------------------

loc_14022352D:                          ; CODE XREF: sub_140222F70+54C↑j
                                        ; sub_140222F70+5A2↑j
                mov     ebp, [rsp+98h+arg_10]

loc_140223534:                          ; CODE XREF: sub_140222F70+270↑j
                                        ; sub_140222F70+279↑j ...
                test    byte ptr [rdi], 20h
                mov     r8d, ebp
                mov     rdx, r12
                mov     rcx, rdi
                jz      loc_1402236FA
                call    sub_140223F80
                mov     ecx, eax
                cmp     eax, 3
                jnz     short loc_14022355A
                mov     r14d, eax
                jmp     loc_140223B27
; ---------------------------------------------------------------------------

loc_14022355A:                          ; CODE XREF: sub_140222F70+5E0↑j
                test    byte ptr [rdi+2], 1
                jnz     loc_140223B27
                mov     rax, [rdi+40h]
                test    rax, rax
                jz      loc_140223701
                cmp     rax, r12
                jnz     loc_140223701
                mov     [rdi+40h], r15

loc_14022357E:                          ; CODE XREF: sub_140222F70+79C↓j
                                        ; sub_140222F70+7B0↓j
                mov     rsi, [rsp+98h+arg_8]

loc_140223586:                          ; CODE XREF: sub_140222F70+A42↓j
                mov     rbx, [rsp+98h+arg_18]

loc_14022358E:                          ; CODE XREF: sub_140222F70+A78↓j
                mov     r14, 0FFFFF68000000000h

loc_140223598:                          ; CODE XREF: sub_140222F70+A8D↓j
                movzx   r9d, word ptr [rdi]
                movzx   r10d, r9w
                and     r10w, 1
                jnz     loc_14022368D
                test    ebp, ebp
                jnz     loc_14022368D
                mov     r8, r12
                shl     r8, 19h
                mov     rax, r14
                shl     rax, 19h
                sub     r8, rax
                mov     rax, 0FFFFFFFFF000h
                sar     r8, 10h
                and     r8, rax
                shr     r8, 9
                mov     rax, r14
                add     r8, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rdx, [r8]
                mov     rax, rax
                cmp     r8, rax
                jb      short loc_140223665
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r8, rax
                ja      short loc_140223665
                call    sub_140349680
                test    eax, eax
                jz      short loc_140223665
                test    dl, 1
                jz      short loc_140223665
                test    dl, 20h
                jz      short loc_14022361E
                test    dl, 42h
                jnz     short loc_140223665

loc_14022361E:                          ; CODE XREF: sub_140222F70+6A7↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140223665
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140223665
                or      rdx, 42h

loc_140223665:                          ; CODE XREF: sub_140222F70+682↑j
                                        ; sub_140222F70+694↑j ...
                shr     rdx, 38h
                and     dl, 0Fh
                cmp     dl, 0Ah
                jz      loc_140223A29
                cmp     dl, 9
                jz      loc_140223A29
                cmp     dl, 8
                jnz     short loc_14022368D
                test    r9w, r9w
                jns     loc_140223A29

loc_14022368D:                          ; CODE XREF: sub_140222F70+635↑j
                                        ; sub_140222F70+63D↑j ...
                mov     rax, [rdi+40h]
                test    rax, rax
                jz      short loc_14022369F
                cmp     rax, [rbx]
                jnz     short loc_14022369F
                mov     [rdi+40h], r15

loc_14022369F:                          ; CODE XREF: sub_140222F70+724↑j
                                        ; sub_140222F70+729↑j
                mov     rax, [rdi+38h]
                test    rax, rax
                jz      short loc_1402236B1
                cmp     rax, [rbx]
                jnz     short loc_1402236B1
                mov     [rdi+38h], r15

loc_1402236B1:                          ; CODE XREF: sub_140222F70+736↑j
                                        ; sub_140222F70+73B↑j
                cmp     ebp, 1
                jl      short loc_1402236C9
                test    byte ptr [rsi+0B8h], 7
                jz      short loc_1402236C9
                test    r10w, r10w
                jz      loc_140223A29

loc_1402236C9:                          ; CODE XREF: sub_140222F70+744↑j
                                        ; sub_140222F70+74D↑j
                test    r9b, 40h
                jnz     loc_140223A29
                mov     rax, [rsp+98h+var_60]
                mov     r8d, ebp
                mov     rdx, r12
                mov     rcx, rdi
                call    sub_1404079D0
                mov     r14d, eax
                cmp     eax, 1
                jnz     loc_140223A02
                mov     r14d, r15d
                jmp     loc_140223B1B
; ---------------------------------------------------------------------------

loc_1402236FA:                          ; CODE XREF: sub_140222F70+5D0↑j
                call    sub_140223C20
                mov     ecx, eax

loc_140223701:                          ; CODE XREF: sub_140222F70+5FB↑j
                                        ; sub_140222F70+604↑j
                test    ecx, ecx
                jz      loc_140223A29
                cmp     ecx, 1
                jz      loc_14022357E
                movzx   ecx, byte ptr [rdi+2]
                mov     eax, ecx
                shr     eax, 2
                and     eax, 7
                cmp     ebp, eax
                jle     loc_14022357E
                mov     rax, [rdi+0A0h]
                or      cl, 2
                mov     [rdi+2], cl
                test    rax, rax
                jz      loc_140223857
                mov     rcx, rdi
                call    sub_1404079D0
                movzx   ecx, byte ptr [rdi+2]

loc_140223748:                          ; CODE XREF: sub_140222F70+8EE↓j
                and     cl, 0FDh
                mov     [rdi+2], cl
                cmp     eax, 3
                jge     loc_1402239C4

loc_140223757:                          ; CODE XREF: sub_140222F70+8FA↓j
                test    cl, 1
                jnz     loc_1402239C4
                mov     r14, 0FFFFF68000000000h
                mov     rsi, r14
                shl     rsi, 19h
                mov     rbx, r12
                shl     rbx, 19h
                sub     rbx, rsi
                movsxd  rdx, ebp
                add     rdx, rdx
                sar     rbx, 10h
                mov     rcx, rbx
                mov     rax, [rdi+rdx*8+40h]
                cmp     rbx, rax
                cmovb   rcx, rax
                cmp     rcx, [rdi+rdx*8+48h]
                ja      loc_1402239ED
                test    byte ptr [rdi], 4
                jz      short loc_1402237E2
                mov     rcx, [rsp+98h+arg_8]
                xor     r8d, r8d
                mov     rdx, r12
                call    sub_140225CC0
                mov     rdx, r12
                mov     rax, 7FFFFFFFF8h
                shr     rdx, 9
                and     rdx, rax
                mov     rax, r14
                mov     rcx, [rsp+98h+arg_8]
                add     rdx, rax
                call    sub_140312B40
                mov     [rdi+30h], r12

loc_1402237E2:                          ; CODE XREF: sub_140222F70+832↑j
                mov     r8d, [rsp+98h+arg_10]
                mov     rdx, rbx
                dec     r8d
                mov     rcx, rdi
                mov     ebp, r15d
                call    sub_140222F70
                mov     rbx, [rsp+98h+arg_18]
                mov     r14d, eax
                mov     rax, [rbx]
                cmp     rax, r12
                jz      loc_14022393C
                movzx   edx, word ptr [rdi]
                test    rax, 0FFFh
                mov     r11d, 4000h
                setz    bpl
                and     dx, r11w
                jz      short loc_14022386F
                cmp     r12, rax
                jnb     short loc_14022386F
                test    byte ptr [rdi+2], 1
                jnz     short loc_14022384F
                mov     edx, 1
                mov     rcx, rdi
                call    sub_14033E080
                cmp     eax, 4
                mov     eax, 4
                cmovz   r14d, eax

loc_14022384F:                          ; CODE XREF: sub_140222F70+8C4↑j
                mov     r12, [rbx]
                jmp     loc_140223B27
; ---------------------------------------------------------------------------

loc_140223857:                          ; CODE XREF: sub_140222F70+7C6↑j
                cmp     byte ptr [rdi+6], 11h
                mov     eax, r15d
                jnz     loc_140223748
                and     cl, 0FDh
                mov     [rdi+2], cl
                jmp     loc_140223757
; ---------------------------------------------------------------------------

loc_14022386F:                          ; CODE XREF: sub_140222F70+8B9↑j
                                        ; sub_140222F70+8BE↑j
                mov     rax, [rsp+98h+var_78]
                mov     rcx, r12
                mov     [rdi+40h], r12
                test    dx, dx
                jz      short loc_14022388C
                lea     r9, [rax+50h]
                add     r9, rdi
                cmp     r12, [r9]
                jbe     short loc_140223896

loc_14022388C:                          ; CODE XREF: sub_140222F70+90E↑j
                lea     r9, [rdi+50h]
                add     r9, rax
                mov     [r9], r12

loc_140223896:                          ; CODE XREF: sub_140222F70+91A↑j
                mov     r10, [rsp+98h+var_70]
                cmp     r10, 3
                jge     short loc_1402238F7
                mov     r8d, 3
                mov     rbx, 0FFFFF68000000000h
                sub     r8, r10
                lea     rdx, [r9+10h]
                mov     r10, 7FFFFFFFF8h
                nop     dword ptr [rax+00h]
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_1402238D0:                          ; CODE XREF: sub_140222F70+978↓j
                shr     rcx, 9
                and     rcx, r10
                mov     rax, rbx
                add     rcx, rax
                mov     [rdx], rcx
                lea     rdx, [rdx+10h]
                sub     r8, 1
                jnz     short loc_1402238D0
                mov     r10, [rsp+98h+var_70]
                mov     rbx, [rsp+98h+arg_18]

loc_1402238F7:                          ; CODE XREF: sub_140222F70+92F↑j
                mov     rax, r12
                mov     r8, r10
                test    r10, r10
                jz      short loc_14022393C
                lea     rcx, [r9-10h]
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140223910:                          ; CODE XREF: sub_140222F70+9CA↓j
                shl     rax, 19h
                sub     rax, rsi
                sar     rax, 10h
                mov     rdx, rax
                test    [rdi], r11w
                jz      short loc_14022392C
                mov     rax, [rcx]
                cmp     rdx, rax
                jbe     short loc_140223932

loc_14022392C:                          ; CODE XREF: sub_140222F70+9B2↑j
                mov     rax, rdx
                mov     [rcx], rdx

loc_140223932:                          ; CODE XREF: sub_140222F70+9BA↑j
                sub     rcx, 10h
                sub     r8, 1
                jnz     short loc_140223910

loc_14022393C:                          ; CODE XREF: sub_140222F70+89C↑j
                                        ; sub_140222F70+990↑j
                cmp     r14d, 3
                jge     loc_140223B27
                test    byte ptr [rdi+2], 1
                jnz     loc_140223B27
                test    byte ptr [rdi], 4
                jz      loc_1402239D9
                test    ebp, ebp
                jnz     short loc_1402239B7
                mov     rax, 7FFFFFFFF8h
                mov     rbx, r12
                shr     rbx, 9
                and     rbx, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                mov     rsi, [rsp+98h+arg_8]
                lea     r8d, [rbp+1]
                add     rbx, rax
                mov     rcx, rsi
                mov     rdx, rbx
                call    sub_140225CC0
                test    eax, eax
                jz      short loc_1402239B7
                mov     rdx, r12
                mov     rcx, rsi
                call    sub_140312B40
                mov     ebp, [rsp+98h+arg_10]
                mov     [rdi+30h], rbx
                jmp     loc_140223586
; ---------------------------------------------------------------------------

loc_1402239B7:                          ; CODE XREF: sub_140222F70+9EB↑j
                                        ; sub_140222F70+A2A↑j
                mov     edx, 1
                mov     rcx, rdi
                call    sub_14033E080

loc_1402239C4:                          ; CODE XREF: sub_140222F70+7E1↑j
                                        ; sub_140222F70+7EA↑j
                mov     ebx, 4
                cmp     eax, 4
                cmovz   r14d, ebx
                lea     r13d, [rbx-3]
                jmp     loc_140223B32
; ---------------------------------------------------------------------------

loc_1402239D9:                          ; CODE XREF: sub_140222F70+9E3↑j
                mov     ebp, [rsp+98h+arg_10]
                mov     rsi, [rsp+98h+arg_8]
                jmp     loc_14022358E
; ---------------------------------------------------------------------------

loc_1402239ED:                          ; CODE XREF: sub_140222F70+829↑j
                mov     rsi, [rsp+98h+arg_8]
                mov     rbx, [rsp+98h+arg_18]
                jmp     loc_140223598
; ---------------------------------------------------------------------------

loc_140223A02:                          ; CODE XREF: sub_140222F70+77C↑j
                cmp     eax, 2
                jnz     short loc_140223A2C
                lea     edx, [rax-1]
                mov     rcx, rdi
                mov     r14d, r15d
                call    sub_14033E080
                mov     rcx, [rdi+48h]
                call    sub_14055C3FC
                mov     r13d, 1
                jmp     loc_140223B1B
; ---------------------------------------------------------------------------

loc_140223A29:                          ; CODE XREF: sub_140222F70+6FF↑j
                                        ; sub_140222F70+708↑j ...
                mov     r14d, r15d

loc_140223A2C:                          ; CODE XREF: sub_140222F70+A95↑j
                movzx   eax, byte ptr [rdi+3]
                mov     [rdi+3], r15b
                lea     r12, [r12+rax*8]
                add     r12, 8
                test    ebp, ebp
                jnz     short loc_140223A52
                test    r12, 0FFFh
                jz      short loc_140223A52
                mov     [rdi+50h], r12
                jmp     loc_140223B1B
; ---------------------------------------------------------------------------

loc_140223A52:                          ; CODE XREF: sub_140222F70+ACE↑j
                                        ; sub_140222F70+AD7↑j
                mov     rax, [rsp+98h+var_78]
                mov     ebx, 4000h
                mov     rcx, r12
                test    [rdi], bx
                jz      short loc_140223A70
                lea     r9, [rax+50h]
                add     r9, rdi
                cmp     r12, [r9]
                jbe     short loc_140223A7A

loc_140223A70:                          ; CODE XREF: sub_140222F70+AF2↑j
                lea     r9, [rdi+50h]
                add     r9, rax
                mov     [r9], r12

loc_140223A7A:                          ; CODE XREF: sub_140222F70+AFE↑j
                movsxd  r10, ebp
                mov     r11, 0FFFFF68000000000h
                cmp     r10, 3
                jge     short loc_140223ACD
                mov     r8d, 3
                lea     rdx, [r9+10h]
                sub     r8, r10
                mov     r10, 7FFFFFFFF8h
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_140223AB0:                          ; CODE XREF: sub_140222F70+B58↓j
                shr     rcx, 9
                and     rcx, r10
                mov     rax, r11
                add     rcx, rax
                mov     [rdx], rcx
                lea     rdx, [rdx+10h]
                sub     r8, 1
                jnz     short loc_140223AB0
                movsxd  r10, ebp

loc_140223ACD:                          ; CODE XREF: sub_140222F70+B1B↑j
                mov     rax, r12
                mov     r8, r10
                test    r10, r10
                jz      short loc_140223B1B
                mov     r10, r11
                shl     r10, 19h
                lea     rcx, [r9-10h]
                nop     dword ptr [rax+00h]
                nop     word ptr [rax+rax+00000000h]

loc_140223AF0:                          ; CODE XREF: sub_140222F70+BA9↓j
                shl     rax, 19h
                sub     rax, r10
                sar     rax, 10h
                mov     rdx, rax
                test    [rdi], bx
                jz      short loc_140223B0B
                mov     rax, [rcx]
                cmp     rdx, rax
                jbe     short loc_140223B11

loc_140223B0B:                          ; CODE XREF: sub_140222F70+B91↑j
                mov     rax, rdx
                mov     [rcx], rdx

loc_140223B11:                          ; CODE XREF: sub_140222F70+B99↑j
                sub     rcx, 10h
                sub     r8, 1
                jnz     short loc_140223AF0

loc_140223B1B:                          ; CODE XREF: sub_140222F70+785↑j
                                        ; sub_140222F70+AB4↑j ...
                test    byte ptr [rdi+2], 1
                jnz     short loc_140223B27
                cmp     r14d, 3
                jl      short loc_140223B2D

loc_140223B27:                          ; CODE XREF: sub_140222F70+5B8↑j
                                        ; sub_140222F70+5E5↑j ...
                mov     r13d, 1

loc_140223B2D:                          ; CODE XREF: sub_140222F70+BB5↑j
                mov     ebx, 4

loc_140223B32:                          ; CODE XREF: sub_140222F70+A64↑j
                mov     ebp, [rsp+98h+arg_10]
                cmp     r12, [rsp+98h+var_68]
                ja      loc_14022317F
                jmp     loc_140223016
; ---------------------------------------------------------------------------

loc_140223B49:                          ; CODE XREF: sub_140222F70+250↑j
                mov     ebx, r15d

loc_140223B4C:                          ; CODE XREF: sub_140222F70+267↑j
                mov     rdx, [rdi+30h]
                and     al, 0FDh
                mov     [rdi+2], al
                test    rdx, rdx
                jz      short loc_140223B6A
                mov     rcx, rsi
                call    sub_140312B40
                movzx   eax, byte ptr [rdi+2]
                mov     [rdi+30h], r15

loc_140223B6A:                          ; CODE XREF: sub_140222F70+BE8↑j
                cmp     ebx, 4
                jnz     short loc_140223B72
                mov     r14d, ebx

loc_140223B72:                          ; CODE XREF: sub_140222F70+22A↑j
                                        ; sub_140222F70+238↑j ...
                test    al, 1
                jz      short loc_140223BF1
                test    byte ptr [rdi], 4
                mov     rcx, rsi
                jz      short loc_140223B89
                call    sub_140231340
                and     byte ptr [rdi+2], 0FEh
                jmp     short loc_140223BF1
; ---------------------------------------------------------------------------

loc_140223B89:                          ; CODE XREF: sub_140222F70+C0C↑j
                call    sub_1402325E0
                mov     rcx, rax
                mov     rbx, rax
                call    ExAcquireSpinLockExclusive
                mov     ecx, 400h
                mov     [rbx+4], r15d
                test    [rdi], cx
                jz      short loc_140223BB3
                lea     rcx, dword_140C4E19C
                call    ExAcquireSpinLockExclusiveAtDpcLevel

loc_140223BB3:                          ; CODE XREF: sub_140222F70+C35↑j
                and     byte ptr [rdi+2], 0FEh
                jmp     short loc_140223BF1
; ---------------------------------------------------------------------------

loc_140223BB9:                          ; CODE XREF: sub_140222F70+DD↑j
                                        ; sub_140222F70+21A↑j
                movzx   eax, byte ptr [rdi+2]
                test    al, 1
                jnz     short loc_140223BF1
                mov     rdx, [rdi+0A0h]
                or      al, 2
                mov     [rdi+2], al
                test    rdx, rdx
                jz      short loc_140223C06
                mov     rcx, rdi
                mov     rax, rdx
                call    sub_1404079D0
                mov     r15d, eax
                movzx   eax, byte ptr [rdi+2]

loc_140223BE4:                          ; CODE XREF: sub_140222F70+C9A↓j
                and     al, 0FDh
                cmp     r15d, 4
                cmovz   r14d, ebx

loc_140223BEE:                          ; CODE XREF: sub_140222F70+C9E↓j
                mov     [rdi+2], al

loc_140223BF1:                          ; CODE XREF: sub_140222F70+C04↑j
                                        ; sub_140222F70+C17↑j ...
                mov     eax, r14d
                add     rsp, 58h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140223C06:                          ; CODE XREF: sub_140222F70+C60↑j
                cmp     byte ptr [rdi+6], 11h
                jnz     short loc_140223BE4
                and     al, 0FDh
                jmp     short loc_140223BEE
sub_140222F70   endp

; ---------------------------------------------------------------------------
algn_140223C10:                         ; DATA XREF: .pdata:00000001400CADDC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140223C20   proc near               ; CODE XREF: sub_140222F70:loc_1402236FA↑p
                                        ; DATA XREF: .rdata:0000000140009128↑o ...

var_28          = qword ptr -28h
var_20          = qword ptr -20h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140429814 SIZE 00000061 BYTES

                push    rbx
                push    rsi
                push    rdi
                sub     rsp, 30h
                mov     r9, [rdx]
                mov     rdi, rdx
                movsxd  rsi, r8d
                mov     rbx, rcx
                cmp     esi, 3
                jz      short loc_140223CB3

loc_140223C39:                          ; CODE XREF: sub_140223C20+A0↓j
                                        ; sub_140223C20+B3↓j ...
                mov     [rsp+48h+arg_0], rbp
                mov     [rsp+48h+arg_8], r12
                mov     [rsp+48h+arg_10], r13
                mov     [rsp+48h+var_20], r14
                mov     [rsp+48h+var_28], r15
                test    r9b, 1
                jnz     short loc_140223C81

loc_140223C58:                          ; CODE XREF: sub_140223C20+2B9↓j
                                        ; sub_140223C20+2C7↓j ...
                test    byte ptr [rbx], 1
                jnz     short loc_140223CAC

loc_140223C5D:                          ; CODE XREF: sub_140223C20+14C↓j
                                        ; sub_140223C20+341↓j ...
                xor     eax, eax

loc_140223C5F:                          ; CODE XREF: sub_140223C20+91↓j
                                        ; sub_140223C20+1C0↓j ...
                mov     r15, [rsp+48h+var_28]
                mov     r14, [rsp+48h+var_20]
                mov     r13, [rsp+48h+arg_10]
                mov     r12, [rsp+48h+arg_8]
                mov     rbp, [rsp+48h+arg_0]
                add     rsp, 30h
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
byte_140223C80  db 0CCh                 ; DATA XREF: .pdata:00000001400CADF4↑o
                                        ; .pdata:00000001400CAE00↑o
; ---------------------------------------------------------------------------

loc_140223C81:                          ; CODE XREF: sub_140223C20+36↑j
                                        ; DATA XREF: .pdata:00000001400CAE00↑o ...
                movzx   r14d, word ptr [rbx]
                lea     r8, qword_140C4C740
                movzx   ebp, r14w
                mov     eax, 4000h
                mov     rdx, 0FFFFFFFFFh
                and     bp, ax
                jnz     loc_140223EBF

loc_140223CA8:                          ; CODE XREF: sub_140223C20+2D2↓j
                                        ; sub_140223C20+2DC↓j
                test    esi, esi
                jnz     short loc_140223D29

loc_140223CAC:                          ; CODE XREF: sub_140223C20+3B↑j
                                        ; sub_140223C20+199↓j ...
                mov     eax, 1
                jmp     short loc_140223C5F
; ---------------------------------------------------------------------------

loc_140223CB3:                          ; CODE XREF: sub_140223C20+17↑j
                                        ; DATA XREF: .pdata:00000001400CAE0C↑o ...
                mov     rax, 0FFFFF6FB7DBED000h
                cmp     rdi, rax
                jb      loc_140223C39
                mov     rax, 0FFFFF6FB7DBED7F8h
                cmp     rdi, rax
                ja      loc_140223C39
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_140223C39
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      loc_140223C39
                test    r9b, 1
                jz      loc_140223C39
                test    r9b, 20h
                jz      loc_140429814
                test    r9b, 42h
                jnz     loc_140223C39
                jmp     loc_140429814
; ---------------------------------------------------------------------------

loc_140223D29:                          ; CODE XREF: sub_140223C20+8A↑j
                                        ; DATA XREF: .pdata:00000001400CAE18↑o ...
                mov     rcx, [rbx+40h]
                mov     r12d, 1
                test    rcx, rcx
                jnz     loc_140223EA2

loc_140223D3C:                          ; CODE XREF: sub_140223C20+28D↓j
                                        ; sub_140223C20+29A↓j
                mov     rcx, [rbx+38h]
                test    rcx, rcx
                jz      short loc_140223D56
                lea     rax, [rsi+5]
                add     rax, rax
                cmp     rcx, [rbx+rax*8]
                jz      loc_140429869

loc_140223D56:                          ; CODE XREF: sub_140223C20+123↑j
                                        ; sub_140223C20+205C50↓j
                test    r9b, r9b
                js      loc_140223F66
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     rdi, rax
                jz      loc_140223C5D
                mov     eax, 200h
                test    ax, r14w
                jnz     loc_140223F35

loc_140223D81:                          ; CODE XREF: sub_140223C20+323↓j
                                        ; sub_140223C20+33B↓j
                movzx   r15d, r14w
                and     r15w, 1
                jnz     short loc_140223DC4
                shr     r9, 0Ch
                and     r9, rdx
                lea     rax, [r9+r9*2]
                add     rax, rax
                mov     rcx, 0FFFFFA8000000018h
                mov     rcx, [rcx+rax*8]
                mov     rax, 3FFFFFFFFFFFFFFFh
                and     rcx, rax
                cmp     rcx, 1
                jz      loc_140223CAC
                cmp     esi, 1
                jz      short loc_140223E33

loc_140223DC4:                          ; CODE XREF: sub_140223C20+16A↑j
                                        ; sub_140223C20+223↓j ...
                test    r12d, r12d
                jz      loc_140223CAC
                cmp     esi, 1
                jz      short loc_140223DE5

loc_140223DD2:                          ; CODE XREF: sub_140223C20+1C9↓j
                                        ; sub_140223C20+1CF↓j ...
                test    bp, bp
                jnz     loc_140223F07

loc_140223DDB:                          ; CODE XREF: sub_140223C20+2EA↓j
                                        ; sub_140223C20+2FC↓j ...
                mov     eax, 2
                jmp     loc_140223C5F
; ---------------------------------------------------------------------------

loc_140223DE5:                          ; CODE XREF: sub_140223C20+1B0↑j
                test    r14b, 10h
                jz      short loc_140223DD2
                test    r15w, r15w
                jnz     short loc_140223DD2
                mov     rax, [rdi]
                shr     rax, 0Ch
                and     rax, rdx
                lea     rax, [rax+rax*2]
                add     rax, rax
                mov     rcx, 0FFFFFA8000000000h
                mov     rcx, [rcx+rax*8]
                mov     rax, rcx
                shr     rax, 4
                test    eax, 3FFh
                jz      loc_140223CAC
                shr     rcx, 0Eh
                and     cl, 7
                cmp     cl, [rbx+4]
                jnb     short loc_140223DD2
                jmp     loc_140223CAC
; ---------------------------------------------------------------------------

loc_140223E33:                          ; CODE XREF: sub_140223C20+1A2↑j
                mov     r13, [rbx+18h]
                movzx   eax, byte ptr [r13+0B8h]
                and     al, 7
                cmp     al, 2
                jnz     loc_140223DC4
                mov     rax, 0FFFFF68000000000h
                shl     rax, 19h
                mov     rcx, rdi
                shl     rcx, 19h
                sub     rcx, rax
                sar     rcx, 10h
                shl     rcx, 19h
                sub     rcx, rax
                sar     rcx, 10h
                call    sub_140264110
                mov     ecx, [rax+20h]
                movzx   eax, word ptr [r13+0AEh]
                shr     rcx, 6
                and     ecx, 3FFh
                cmp     rcx, rax
                jnz     loc_140223CAC
                mov     rdx, 0FFFFFFFFFh
                jmp     loc_140223DC4
; ---------------------------------------------------------------------------

loc_140223EA2:                          ; CODE XREF: sub_140223C20+116↑j
                lea     rax, [rsi+5]
                add     rax, rax
                cmp     rcx, [rbx+rax*8]
                jnz     loc_140223D3C
                xor     r12d, r12d
                mov     [rbx+40h], r12
                jmp     loc_140223D3C
; ---------------------------------------------------------------------------

loc_140223EBF:                          ; CODE XREF: sub_140223C20+82↑j
                mov     rax, r9
                lea     rcx, ds:0[rsi*8]
                shr     rax, 0Ch
                and     rax, rdx
                cmp     rax, [rcx+r8+2508h]
                jz      loc_140223C58
                cmp     rax, [rcx+r8+24E8h]
                jz      loc_140223C58
                bt      r9, 0Bh
                jb      loc_140223CA8
                test    r9b, 42h
                jnz     loc_140223CA8
                jmp     loc_140223C58
; ---------------------------------------------------------------------------

loc_140223F07:                          ; CODE XREF: sub_140223C20+1B5↑j
                cmp     esi, 1
                jle     loc_140223DDB
                movzx   eax, byte ptr [rbx+2]
                shr     eax, 2
                and     eax, 7
                cmp     esi, eax
                jnz     loc_140223DDB
                mov     r8d, esi
                mov     rdx, rdi
                mov     rcx, rbx
                call    sub_14037960C
                jmp     loc_140223DDB
; ---------------------------------------------------------------------------

loc_140223F35:                          ; CODE XREF: sub_140223C20+15B↑j
                mov     rax, cs:qword_140C4EC50
                cmp     cs:qword_140C4EC48, rax
                jz      loc_140223D81
                mov     rax, r9
                shr     rax, 0Ch
                and     rax, rdx
                cmp     rax, [r8+rsi*8+2508h]
                jnz     loc_140223D81
                jmp     loc_140223C5D
; ---------------------------------------------------------------------------

loc_140223F66:                          ; CODE XREF: sub_140223C20+139↑j
                test    r14b, 1
                jz      loc_140223C5D
                mov     eax, 1
                jmp     loc_140223C5F
sub_140223C20   endp

; ---------------------------------------------------------------------------
algn_140223F7A:                         ; DATA XREF: .pdata:00000001400CAE24↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140223F80   proc near               ; CODE XREF: sub_140222F70+5D6↑p
                                        ; DATA XREF: .rdata:0000000140009170↑o ...

var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140429876 SIZE 000000B6 BYTES

                mov     [rsp+arg_10], rbx
                push    rsi
                push    rdi
                push    r14
                sub     rsp, 30h
                mov     rbx, [rdx]
                mov     rsi, rdx
                movsxd  rdi, r8d
                mov     r14, rcx
                cmp     edi, 3
                jz      loc_1402240D0

loc_140223FA2:                          ; CODE XREF: sub_140223F80+15A↓j
                                        ; sub_140223F80+16A↓j ...
                mov     [rsp+48h+arg_0], rbp
                mov     [rsp+48h+arg_18], rbx
                test    rbx, rbx
                jz      short loc_140224014
                test    bl, 1
                jz      short loc_140224020
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     rsi, rax
                jz      short loc_14022401C
                test    bl, bl
                js      loc_1402241CB
                movzx   ebx, word ptr [r14]
                mov     eax, 200h
                test    ax, bx
                jnz     loc_140224231

loc_140223FDF:                          ; CODE XREF: sub_140223F80+2BF↓j
                                        ; sub_140223F80+2059A7↓j
                movzx   eax, byte ptr [r14+2]
                shr     eax, 2
                and     eax, 7
                cmp     edi, eax
                jg      loc_1402240C6
                test    bl, 40h
                jnz     loc_14022412D

loc_140223FFB:                          ; CODE XREF: sub_140223F80+AB↓j
                                        ; sub_140223F80+12A↓j ...
                mov     eax, 1

loc_140224000:                          ; CODE XREF: sub_140223F80+9E↓j
                                        ; sub_140223F80+141↓j ...
                mov     rbp, [rsp+48h+arg_0]
                mov     rbx, [rsp+48h+arg_10]
                add     rsp, 30h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
algn_140224013:                         ; DATA XREF: .pdata:00000001400CAE3C↑o
                                        ; .pdata:00000001400CAE48↑o
                align 4

loc_140224014:                          ; CODE XREF: sub_140223F80+2F↑j
                                        ; DATA XREF: .pdata:00000001400CAE48↑o ...
                test    edi, edi
                jz      loc_1402240B5

loc_14022401C:                          ; CODE XREF: sub_140223F80+43↑j
                                        ; sub_140223F80+B3↓j ...
                xor     eax, eax
                jmp     short loc_140224000
; ---------------------------------------------------------------------------

loc_140224020:                          ; CODE XREF: sub_140223F80+34↑j
                cmp     edi, 1
                jge     loc_1402241BB

loc_140224029:                          ; CODE XREF: sub_140223F80+245↓j
                test    edi, edi
                jz      short loc_140223FFB
                movzx   eax, byte ptr [r14]
                test    al, al
                js      short loc_14022401C
                mov     rcx, [r14+10h]
                test    rcx, rcx
                jz      short loc_140224043
                call    sub_14028EDB0

loc_140224043:                          ; CODE XREF: sub_140223F80+BC↑j
                mov     rax, [r14+0A0h]
                test    rax, rax
                jz      short loc_140224057
                mov     rcx, r14
                call    sub_1404079D0

loc_140224057:                          ; CODE XREF: sub_140223F80+CD↑j
                test    byte ptr [r14+2], 1
                jnz     short loc_140224066
                mov     rcx, r14
                call    sub_14033E0FC

loc_140224066:                          ; CODE XREF: sub_140223F80+DC↑j
                mov     ecx, [r14+8]
                mov     rax, 100000000000002h
                shl     rcx, 39h
                or      rcx, rax
                shl     rsi, 19h
                mov     rbp, 0FFFFF68000000000h
                mov     rax, rbp
                shl     rax, 19h
                xor     r9d, r9d
                sub     rsi, rax
                xor     r8d, r8d
                sar     rsi, 10h
                mov     rdx, rsi
                call    sub_140224260
                movsxd  rbx, eax
                test    eax, eax
                jns     loc_140223FFB
                jmp     loc_1404298CB
; ---------------------------------------------------------------------------

loc_1402240B5:                          ; CODE XREF: sub_140223F80+96↑j
                test    byte ptr [r14], 1
                jnz     loc_140223FFB
                xor     eax, eax
                jmp     loc_140224000
; ---------------------------------------------------------------------------

loc_1402240C6:                          ; CODE XREF: sub_140223F80+6C↑j
                mov     eax, 2
                jmp     loc_140224000
; ---------------------------------------------------------------------------

loc_1402240D0:                          ; CODE XREF: sub_140223F80+1C↑j
                                        ; DATA XREF: .pdata:00000001400CAE54↑o ...
                mov     rcx, rsi
                call    sub_1402433C0
                test    eax, eax
                jz      loc_140223FA2
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_140223FA2
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      loc_140223FA2
                test    bl, 1
                jz      loc_140223FA2
                test    bl, 20h
                jz      loc_140429876
                test    bl, 42h
                jnz     loc_140223FA2
                jmp     loc_140429876
; ---------------------------------------------------------------------------

loc_14022412D:                          ; CODE XREF: sub_140223F80+75↑j
                                        ; DATA XREF: .pdata:00000001400CAE60↑o ...
                mov     [rsp+48h+arg_8], r15
                mov     rdi, 7FFFFFFFF8h
                mov     r15, [r14+0A8h]
                mov     rbp, 0FFFFF68000000000h
                test    bl, 4
                jz      short loc_14022417E
                mov     rcx, [r14+18h]
                xor     r8d, r8d
                mov     rdx, rsi
                call    sub_140225CC0
                mov     rdx, rsi
                shr     rdx, 9
                and     rdx, rdi
                mov     rax, rbp
                mov     rcx, [r14+18h]
                add     rdx, rax
                call    sub_140312B40
                mov     [r14+30h], rsi

loc_14022417E:                          ; CODE XREF: sub_140223F80+1D0↑j
                shl     rsi, 19h
                mov     rax, rbp
                mov     rcx, [r14+20h]
                shl     rax, 19h
                sub     rsi, rax
                shr     rcx, 9
                sar     rsi, 10h
                and     rcx, rdi
                mov     rax, rbp
                add     rcx, rax
                mov     eax, 3
                cmp     rsi, rcx
                cmovnb  rcx, rsi
                mov     [r15+8], rcx
                mov     r15, [rsp+48h+arg_8]
                jmp     loc_140224000
; ---------------------------------------------------------------------------

loc_1402241BB:                          ; CODE XREF: sub_140223F80+A3↑j
                                        ; DATA XREF: .rdata:0000000140052CC4↑o ...
                mov     rcx, rsi
                call    sub_140361E20
                test    eax, eax
                jnz     loc_140224029

loc_1402241CB:                          ; CODE XREF: sub_140223F80+47↑j
                test    byte ptr [r14], 40h
                jz      loc_140223FFB
                mov     rdx, [r14+0A8h]
                mov     rbp, 0FFFFF68000000000h
                mov     [rdx], edi
                test    edi, edi
                jz      short loc_140224203
                mov     rax, rbp
                shl     rax, 19h

loc_1402241F3:                          ; CODE XREF: sub_140223F80+281↓j
                shl     rsi, 19h
                sub     rsi, rax
                sar     rsi, 10h
                sub     edi, 1
                jnz     short loc_1402241F3

loc_140224203:                          ; CODE XREF: sub_140223F80+26A↑j
                mov     r8, [r14+20h]
                mov     rdi, 7FFFFFFFF8h
                shr     r8, 9
                and     r8, rdi
                mov     rax, rbp
                add     r8, rax
                cmp     rsi, r8
                jb      short loc_14022424A

loc_140224223:                          ; CODE XREF: sub_140223F80+2CD↓j
                mov     [rdx+8], rsi
                mov     eax, 3
                jmp     loc_140224000
; ---------------------------------------------------------------------------

loc_140224231:                          ; CODE XREF: sub_140223F80+59↑j
                mov     rax, cs:qword_140C4EC50
                cmp     cs:qword_140C4EC48, rax
                jz      loc_140223FDF
                jmp     loc_1404298FB
; ---------------------------------------------------------------------------

loc_14022424A:                          ; CODE XREF: sub_140223F80+2A1↑j
                mov     rsi, r8
                jmp     short loc_140224223
sub_140223F80   endp

; ---------------------------------------------------------------------------
algn_14022424F:                         ; DATA XREF: .rdata:0000000140052CC4↑o
                                        ; .pdata:00000001400CAE78↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140224260   proc near               ; CODE XREF: sub_1402228C0+498↑p
                                        ; sub_140223F80+120↑p ...

var_178         = qword ptr -178h
var_168         = qword ptr -168h
var_158         = byte ptr -158h
var_140         = xmmword ptr -140h
var_130         = qword ptr -130h
var_D8          = qword ptr -0D8h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_A0          = xmmword ptr -0A0h
var_90          = xmmword ptr -90h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h

; FUNCTION CHUNK AT 000000014042992C SIZE 000002F7 BYTES

; __unwind { // __GSHandlerCheck
                mov     r11, rsp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r14
                sub     rsp, 170h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+198h+var_48], rax
                xor     r12d, r12d
                movsx   esi, r8b
                movzx   eax, cl
                mov     [rsp+198h+var_168], r12
                and     al, 9
                mov     r14, r9
                mov     rdi, rdx
                mov     rbx, rcx
                cmp     al, 9
                jz      loc_14042992C
                mov     rax, rdx
                sar     rax, 2Fh
                inc     rax
                cmp     rax, 1
                ja      loc_14022489F
                bt      rcx, 0Fh
                jb      loc_14042999B
                xorps   xmm0, xmm0
                mov     rcx, rdx
                movups  [rsp+198h+var_A0], xmm0
                shr     rcx, 9
                mov     r8, 7FFFFFFFF8h
                movups  [rsp+198h+var_90], xmm0
                and     rcx, r8
                mov     rdx, 0FFFFF68000000000h
                movups  xmmword ptr [r11-80h], xmm0
                movups  xmmword ptr [r11-70h], xmm0
                movups  xmmword ptr [r11-60h], xmm0
                mov     rax, rdx
                add     rcx, rax
                mov     [r11-0C0h], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     [r11-0B8h], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     [r11-0B0h], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     [r11-0A8h], rcx
                mov     ecx, dword ptr [rsp+198h+var_90+8]
                test    bl, 40h
                jnz     loc_1404299B9

loc_14022435D:                          ; CODE XREF: sub_140224260+205760↓j
                mov     eax, esi
                mov     [rsp+198h+var_D0], rbx
                shl     eax, 6
                xor     eax, ecx
                mov     [rsp+198h+var_D8], rdi
                and     eax, 40h
                mov     [rsp+198h+var_C8], r14
                xor     ecx, eax
                mov     dword ptr [rsp+198h+var_90+8], ecx
                mov     rax, cr8
                cmp     al, 1
                ja      loc_140224742
; } // starts at 140224260

loc_140224394:                          ; DATA XREF: .rdata:0000000140052D30↑o
                                        ; .rdata:0000000140052D44↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+198h+var_30], r13
                mov     r13, 0FFFF800000000000h
                mov     [rsp+198h+var_38], r15

loc_1402243AE:                          ; CODE XREF: sub_140224260+630↓j
                mov     r15d, 1000h
                cmp     rdi, r13
                jnb     loc_140224653

loc_1402243BD:                          ; CODE XREF: sub_140224260+407↓j
                lea     rcx, [rsp+198h+var_D8]
                call    sub_140224940
                mov     ebx, eax
                cmp     eax, 0C0000016h
                jnz     loc_14022447B

loc_1402243D7:                          ; CODE XREF: sub_140224260+412↓j
                lea     rdx, [rsp+198h+var_168]
                lea     rcx, [rsp+198h+var_D8]
                call    sub_1402260D0
                mov     ebx, eax
                cmp     eax, 0C0000016h
                jz      loc_140224776
                mov     rdx, [rsp+198h+var_168]
                test    rdx, rdx
                jnz     loc_14022468C

loc_140224404:                          ; CODE XREF: sub_140224260+46A↓j
                mov     [rsp+198h+var_78], r12

loc_14022440C:                          ; CODE XREF: sub_140224260+5D2↓j
                test    byte ptr [rsp+198h+var_90+8], 10h
                jnz     loc_140429A20
                mov     rdx, qword ptr [rsp+198h+var_90]
                mov     rdi, qword ptr [rsp+198h+var_A0]
                test    rdx, rdx
                jz      loc_140429A65
                cmp     word ptr [rsp+198h+var_A0+0Ah], r12w
                jnz     loc_140224754

loc_140224442:                          ; CODE XREF: sub_140224260+509↓j
                mov     rcx, rdi
                call    sub_140312B40
                movzx   eax, byte ptr [rsp+198h+var_A0+0Dh]
                or      al, 2
                mov     qword ptr [rsp+198h+var_90], r12
                mov     byte ptr [rsp+198h+var_A0+0Dh], al

loc_140224463:                          ; CODE XREF: sub_140224260+20580D↓j
                movzx   edx, byte ptr [rsp+198h+var_A0+0Ch]
                mov     rcx, rdi
                test    al, 1
                jnz     loc_140429A72
                call    sub_140226960

loc_14022447B:                          ; CODE XREF: sub_140224260+171↑j
                                        ; sub_140224260+2057BB↓j ...
                test    byte ptr [rsp+198h+var_90+8], 1
                jnz     loc_1402248D2

loc_140224489:                          ; CODE XREF: sub_140224260+687↓j
                mov     rcx, [rsp+198h+var_68]
                test    rcx, rcx
                jnz     loc_140429A7D

loc_14022449A:                          ; CODE XREF: sub_140224260+205844↓j
                mov     rcx, [rsp+198h+var_60]
                test    rcx, rcx
                jnz     loc_1402248EC
                test    byte ptr [rsp+198h+var_C8], 1
                jnz     loc_140224583

loc_1402244B9:                          ; CODE XREF: sub_140224260+332↓j
                                        ; sub_140224260+6D1↓j ...
                mov     rdx, qword ptr [rsp+198h+var_A0]
                test    byte ptr [rdx+0B8h], 7
                jnz     loc_14022467D
                mov     rax, gs:188h
                cmp     byte ptr [rax+0C3h], 10h
                jge     loc_1402246CF

loc_1402244E4:                          ; CODE XREF: sub_140224260+418↓j
                                        ; sub_140224260+424↓j ...
                test    ebx, ebx
                jz      short loc_140224516
                cmp     ebx, 0C0000434h
                jz      loc_14022476E
                test    ebx, ebx
                js      loc_14022459D

loc_1402244FC:                          ; CODE XREF: sub_140224260+349↓j
                cmp     [rsp+198h+var_78], r12
                jnz     short loc_140224516
                test    dword ptr cs:xmmword_140CFC480, 1000h
                jnz     loc_140429BA3

loc_140224516:                          ; CODE XREF: sub_140224260+286↑j
                                        ; sub_140224260+2A4↑j ...
                test    byte ptr [rsp+198h+var_90+8], 2
                jnz     loc_140429BDC

loc_140224524:                          ; CODE XREF: sub_140224260+20598F↓j
                test    byte ptr [rsp+198h+var_90+8], 4
                jnz     loc_140429BF4

loc_140224532:                          ; CODE XREF: sub_140224260+2059A7↓j
                cmp     [rsp+198h+var_78], r12
                jnz     loc_140224837
                mov     rcx, [rsp+198h+var_70]
                mov     r15, [rsp+198h+var_38]
                mov     r13, [rsp+198h+var_30]
                test    rcx, rcx
                jnz     loc_140224895
; } // starts at 140224394

loc_140224561:                          ; CODE XREF: sub_140224260+63A↓j
                                        ; DATA XREF: .pdata:00000001400CAE90↑o ...
; __unwind { // __GSHandlerCheck
                mov     eax, ebx

loc_140224563:                          ; CODE XREF: sub_140224260+4EF↓j
                                        ; sub_140224260+64E↓j ...
                mov     rcx, [rsp+198h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 170h
                pop     r14
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140224561
; ---------------------------------------------------------------------------

loc_140224583:                          ; CODE XREF: sub_140224260+253↑j
                                        ; DATA XREF: .pdata:00000001400CAE9C↑o ...
; __unwind { // __GSHandlerCheck
                mov     rax, [rsp+198h+var_C8]
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 5
                jnz     loc_1402244B9
                jmp     loc_140429AB4
; ---------------------------------------------------------------------------

loc_14022459D:                          ; CODE XREF: sub_140224260+296↑j
                                        ; sub_140224260+20577F↓j
                mov     edx, r15d
                mov     ecx, ebx
                call    sub_14033ADF4
                test    eax, eax
                jz      loc_1402244FC
                mov     rcx, gs:188h
                test    byte ptr [rcx+518h], 4
                jnz     loc_140429B99
                mov     eax, [rcx+514h]
                test    al, 0Ch
                jnz     loc_140429B99
                test    byte ptr [rsp+198h+var_C8], 1
                jnz     loc_140429B04

loc_1402245E1:                          ; CODE XREF: sub_140224260+2058B3↓j
                                        ; sub_140224260+2058BE↓j
                test    byte ptr [rsp+198h+var_90+8], 80h
                mov     rax, qword ptr [rsp+198h+var_A0]
                movzx   ecx, word ptr [rax+0AEh]
                mov     rax, cs:qword_140C4E4C8
                mov     rbx, [rax+rcx*8]
                jnz     loc_140429B2E
                mov     edx, 420h
                mov     rcx, rbx
                call    sub_140269070
                test    eax, eax
                jz      loc_140429B2E
                cmp     qword ptr [rbx+1C00h], 400h
                jb      loc_140429B2E

loc_14022462F:                          ; CODE XREF: sub_140224260+2058DF↓j
                mov     rdx, [rbx+1BC0h]
                test    rdx, rdx
                jz      short loc_14022463E
                dec     rdx

loc_14022463E:                          ; CODE XREF: sub_140224260+3D9↑j
                cmp     rdx, 9Fh
                jb      loc_140429B44

loc_14022464B:                          ; CODE XREF: sub_140224260+2058F9↓j
                                        ; sub_140224260+20591A↓j ...
                mov     ebx, r12d
                jmp     loc_140224516
; ---------------------------------------------------------------------------

loc_140224653:                          ; CODE XREF: sub_140224260+157↑j
                lea     rcx, [rsp+198h+var_D8]
                call    sub_140263560
                mov     ebx, eax
                cmp     eax, 0C0h
                jz      loc_1402243BD
                cmp     eax, 0C0000016h
                jz      loc_1402243D7
                jmp     loc_1402244E4
; ---------------------------------------------------------------------------

loc_14022467D:                          ; CODE XREF: sub_140224260+268↑j
                test    dword ptr [rdx+4], 0FFFh
                jnz     loc_1402244E4
                jmp     short loc_140224701
; ---------------------------------------------------------------------------

loc_14022468C:                          ; CODE XREF: sub_140224260+19E↑j
                mov     rax, [rdx+100h]
                mov     r15d, [rdx+138h]
                test    rax, rax
                jnz     loc_1404299F1

loc_1402246A3:                          ; CODE XREF: sub_140224260+205795↓j
                cmp     sil, 1
                jz      loc_140224733

loc_1402246AD:                          ; CODE XREF: sub_140224260+4DD↓j
                mov     eax, [rdx+0C0h]
                test    al, 1
                jnz     loc_1404299FA

loc_1402246BB:                          ; CODE XREF: sub_140224260+20579E↓j
                lea     rcx, [rsp+198h+var_D8]
                call    sub_14026E700
                mov     ebx, eax
                jmp     loc_140224404
; ---------------------------------------------------------------------------

loc_1402246CF:                          ; CODE XREF: sub_140224260+27E↑j
                mov     eax, [rax+514h]
                test    al, 0Ch
                setz    cl
                test    al, 2
                setz    al
                test    al, cl
                jz      loc_1402244E4
                mov     rdx, qword ptr [rsp+198h+var_A0]
                mov     rcx, [rdx+78h]
                sub     rcx, [rdx+70h]
                cmp     rcx, 64h ; 'd'
                jle     loc_1402244E4

loc_140224701:                          ; CODE XREF: sub_140224260+42A↑j
                movzx   ecx, word ptr [rdx+0AEh]
                mov     rax, cs:qword_140C4E4C8
                mov     rcx, [rax+rcx*8]
                test    rcx, rcx
                jz      loc_1402244E4
                mov     edx, 420h
                call    sub_140269070
                test    eax, eax
                jnz     loc_1402244E4
                jmp     loc_140429AEE
; ---------------------------------------------------------------------------

loc_140224733:                          ; CODE XREF: sub_140224260+447↑j
                or      dword ptr [rdx+0C0h], 40000h
                jmp     loc_1402246AD
; } // starts at 140224583
; ---------------------------------------------------------------------------

loc_140224742:                          ; CODE XREF: sub_140224260+12E↑j
                                        ; DATA XREF: .pdata:00000001400CAEA8↑o ...
; __unwind { // __GSHandlerCheck
                lea     rcx, [rsp+198h+var_D8]
                call    sub_140338AA8
                jmp     loc_140224563
; } // starts at 140224742
; ---------------------------------------------------------------------------

loc_140224754:                          ; CODE XREF: sub_140224260+1DC↑j
                                        ; DATA XREF: .pdata:00000001400CAEB4↑o ...
; __unwind { // __GSHandlerCheck
                lea     rcx, [rsp+198h+var_A0]
                call    sub_14026F5D0
                mov     rdx, qword ptr [rsp+198h+var_90]
                jmp     loc_140224442
; ---------------------------------------------------------------------------

loc_14022476E:                          ; CODE XREF: sub_140224260+28E↑j
                mov     ebx, r12d
                jmp     loc_140224516
; ---------------------------------------------------------------------------

loc_140224776:                          ; CODE XREF: sub_140224260+190↑j
                mov     rdx, [rsp+198h+var_D8]
                cmp     rdx, r13
                jnb     loc_140224824
                mov     rcx, [rsp+198h+var_78]
                cmp     rcx, cs:qword_140C4DCB8
                jz      loc_140224824
                mov     rax, cs:qword_140C4DCC0
                test    rax, rax
                jz      short loc_1402247AD
                cmp     rcx, rax
                jz      short loc_140224824

loc_1402247AD:                          ; CODE XREF: sub_140224260+546↑j
                mov     rax, [rsp+198h+var_80]
                test    rax, rax
                jnz     short loc_1402247D2
                mov     rcx, rdx
                call    sub_14026A130
                mov     rdx, [rsp+198h+var_D8]
                mov     [rsp+198h+var_80], rax

loc_1402247D2:                          ; CODE XREF: sub_140224260+558↑j
                test    dword ptr [rsp+198h+var_90+8], 100h
                lea     r9, [rsp+198h+var_70]
                mov     r8d, 4
                mov     ecx, 2
                cmovnz  r8d, ecx
                shr     rdx, 0Ch
                mov     rcx, rax
                call    sub_140283270
                test    rax, rax
                jz      loc_1404299C5
                cmp     [rsp+198h+var_78], rax
                jnz     loc_1404299E4

loc_140224817:                          ; CODE XREF: sub_140224260+20578C↓j
                mov     rcx, [rsp+198h+var_70]
                call    sub_1402FD738

loc_140224824:                          ; CODE XREF: sub_140224260+521↑j
                                        ; sub_140224260+536↑j ...
                and     dword ptr [rsp+198h+var_90+8], 0FFFFFEFFh
                mov     ebx, r12d
                jmp     loc_14022440C
; ---------------------------------------------------------------------------

loc_140224837:                          ; CODE XREF: sub_140224260+2DA↑j
                mov     rcx, r14
                mov     rax, r14
                and     ecx, 1
                and     rax, 0FFFFFFFFFFFFFFFEh
                test    rcx, rcx
                jnz     short loc_1402248B3

loc_140224849:                          ; CODE XREF: sub_140224260+65B↓j
                                        ; sub_140224260+66D↓j ...
                mov     r14, r12

loc_14022484C:                          ; CODE XREF: sub_140224260+2059B8↓j
                mov     rdx, [rsp+198h+var_78]
                lea     rax, [rsp+198h+var_D8]
                mov     rbx, [rsp+198h+var_70]
                xor     r8d, r8d
                mov     r9, r14
                mov     [rsp+198h+var_178], rax
                lea     ecx, [r8+2]
                call    sub_14029F150
                or      dword ptr [rsp+198h+var_90+8], 8
                mov     rdi, [rsp+198h+var_D8]
                mov     [rsp+198h+var_70], rbx
                jmp     loc_1402243AE
; } // starts at 140224754
; ---------------------------------------------------------------------------

loc_140224895:                          ; CODE XREF: sub_140224260+2FB↑j
                                        ; DATA XREF: .pdata:00000001400CAEC0↑o ...
; __unwind { // __GSHandlerCheck
                call    sub_14035BA8C
                jmp     loc_140224561
; ---------------------------------------------------------------------------

loc_14022489F:                          ; CODE XREF: sub_140224260+53↑j
                cmp     sil, 1
                jnz     loc_140429947

loc_1402248A9:                          ; CODE XREF: sub_140224260+205704↓j
                                        ; sub_140224260+205718↓j
                mov     eax, 0C0000005h
                jmp     loc_140224563
; } // starts at 140224895
; ---------------------------------------------------------------------------

loc_1402248B3:                          ; CODE XREF: sub_140224260+5E7↑j
                                        ; DATA XREF: .pdata:00000001400CAECC↑o ...
; __unwind { // __GSHandlerCheck
                cmp     byte ptr [rax], 1
                jz      short loc_1402248C9
                test    rcx, rcx
                jz      short loc_140224849
                movzx   ecx, byte ptr [rax]
                cmp     cl, 2
                jnz     loc_140429C0C

loc_1402248C9:                          ; CODE XREF: sub_140224260+656↑j
                mov     byte ptr [rax+1], 1
                jmp     loc_140224849
; ---------------------------------------------------------------------------

loc_1402248D2:                          ; CODE XREF: sub_140224260+223↑j
                mov     rdx, [rsp+198h+var_D8]
                mov     rcx, [rsp+198h+var_80]
                call    sub_140381BF0
                jmp     loc_140224489
; ---------------------------------------------------------------------------

loc_1402248EC:                          ; CODE XREF: sub_140224260+245↑j
                test    byte ptr [rsp+198h+var_90+8], 40h
                jz      loc_140429AA9
                mov     r9d, r12d

loc_1402248FD:                          ; CODE XREF: sub_140224260+20584F↓j
                mov     rax, [rsp+198h+var_70]
                mov     r8, [rsp+198h+var_58]
                mov     rdx, [rax]
                movzx   eax, word ptr [rdx+3Ch]
                mov     rdx, cs:qword_140C4E4C8
                and     eax, 3FFh
                mov     rdx, [rdx+rax*8]
                call    sub_1403927F4
                mov     [rsp+198h+var_60], r12
                jmp     loc_1402244B9
; } // starts at 1402248B3
sub_140224260   endp

; ---------------------------------------------------------------------------
algn_140224936:                         ; DATA XREF: .pdata:00000001400CAED8↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140224940   proc near               ; CODE XREF: sub_140224260+165↑p
                                        ; DATA XREF: .rdata:0000000140052E00↑o ...

var_68          = qword ptr -68h
var_58          = qword ptr -58h
var_40          = qword ptr -40h
arg_0           = byte ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                push    rbx
                push    rbp
                push    rsi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 50h
                mov     rax, gs:188h
                xor     r13d, r13d
                mov     r12, rcx
                mov     [rsp+88h+arg_8], r13d
                mov     [rsp+88h+arg_18], r13
                mov     r11, [rax+0B8h]
                lea     r15d, [r13+3]
                mov     [rsp+88h+var_58], r11
                lea     rbx, [r11+680h]
                mov     [rcx+38h], rbx
                cmp     dword ptr [r11+7D0h], 10h
                jbe     loc_140224AA6
                test    dword ptr [r11+87Ch], 1000h
                jnz     loc_140224AA6
                movzx   eax, word ptr [rbx+0AEh]
                mov     rcx, cs:qword_140C4E4C8
                mov     rax, [rcx+rax*8]
                cmp     [rax+488h], r13d
                jz      short loc_1402249D1
                cmp     [rax+500h], r11
                jz      loc_140224AA6

loc_1402249D1:                          ; CODE XREF: sub_140224940+82↑j
                cmp     cs:word_140CFB000, 1
                mov     r10, rax
                mov     r9, [rax+1D40h]
                jbe     loc_140224A6B
                mov     rax, gs:20h
                mov     rcx, [rax+0C0h]
                movzx   eax, word ptr [rcx+92h]
                imul    rdx, rax, 11C0h
                add     rdx, [r10+10h]
                mov     rcx, [rdx+8]
                add     rcx, [rdx]
                mov     rax, [rdx+438h]
                add     rax, [rdx+430h]
                mov     r8, [rdx+1028h]
                add     r8, [rdx+1020h]
                shl     rax, 9
                shl     rcx, 12h
                add     rcx, rax
                mov     rax, [rdx+868h]
                add     rax, [rdx+860h]
                shl     rax, 4
                add     rcx, rax
                add     r8, rcx
                cmp     r8, 420h
                jnb     short loc_140224A66
                mov     rax, r8
                shr     rax, 4
                cmp     r9, rax
                jnb     short loc_140224A6B

loc_140224A66:                          ; CODE XREF: sub_140224940+118↑j
                test    r8, r8
                jnz     short loc_140224A72

loc_140224A6B:                          ; CODE XREF: sub_140224940+A3↑j
                                        ; sub_140224940+124↑j
                mov     r8, [r10+1BC0h]

loc_140224A72:                          ; CODE XREF: sub_140224940+129↑j
                cmp     r8, 420h
                jnb     short loc_140224AA6
                cmp     r9, 4000h
                jnb     short loc_140224A8D
                shr     r8, 4
                cmp     r9, r8
                jb      short loc_140224AA6

loc_140224A8D:                          ; CODE XREF: sub_140224940+142↑j
                cmp     byte ptr [r11+280h], 9
                mov     ecx, r13d
                mov     [r11+7D0h], r13d
                setnl   cl
                inc     ecx
                jmp     short loc_140224AB2
; ---------------------------------------------------------------------------

loc_140224AA6:                          ; CODE XREF: sub_140224940+52↑j
                                        ; sub_140224940+63↑j ...
                cmp     cs:dword_140C4EBCC, r13d
                jz      short loc_140224AB7
                mov     ecx, r15d

loc_140224AB2:                          ; CODE XREF: sub_140224940+164↑j
                call    sub_140548554

loc_140224AB7:                          ; CODE XREF: sub_140224940+16D↑j
                movzx   eax, byte ptr [rbx+0B8h]
                lea     rbp, unk_140C4F600
                and     al, 7

loc_140224AC7:                          ; DATA XREF: .rdata:0000000140052E00↑o
                                        ; .rdata:0000000140052E10↑o ...
                mov     [rsp+88h+var_40], rdi
                mov     ecx, 1
                cmp     al, 6
                jb      short loc_140224B37
                mov     rsi, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      loc_140224C2A
                test    cl, al
                jz      loc_140224C2A
                cmp     sil, 0Fh
                ja      loc_140224C2A
                mov     rax, gs:20h
                mov     edx, ecx
                mov     r9, [rax+84B8h]
                movzx   eax, sil
                inc     eax
                movzx   ecx, al
                mov     r8d, [r9+14h]
                shl     rdx, cl
                dec     edx
                not     edx
                and     edx, 4
                or      edx, r8d
                mov     [r9+14h], edx
                jmp     loc_140224C2A
; ---------------------------------------------------------------------------

loc_140224B37:                          ; CODE XREF: sub_140224940+193↑j
                cmp     al, 2
                jnz     short loc_140224B40
                mov     rbx, rbp
                jmp     short loc_140224B47
; ---------------------------------------------------------------------------

loc_140224B40:                          ; CODE XREF: sub_140224940+1F9↑j
                add     rbx, 0C0h

loc_140224B47:                          ; CODE XREF: sub_140224940+1FE↑j
                mov     rsi, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140224B96
                test    cl, al
                jz      short loc_140224B96
                cmp     sil, 0Fh
                ja      short loc_140224B96
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_140224B96:                          ; CODE XREF: sub_140224940+21C↑j
                                        ; sub_140224940+220↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_140224BAD
                movzx   edx, sil
                mov     rcx, rbx
                call    sub_1405B5F24
                jmp     short loc_140224C1E
; ---------------------------------------------------------------------------

loc_140224BAD:                          ; CODE XREF: sub_140224940+25D↑j
                mov     rdi, gs:20h
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jz      short loc_140224BDB
                cmp     byte ptr [rdi+20h], 1
                ja      short loc_140224BDB
                mov     eax, [rcx+18h]
                add     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_140224BDB
                mov     rcx, rdi
                call    sub_1403F2EC4

loc_140224BDB:                          ; CODE XREF: sub_140224940+280↑j
                                        ; sub_140224940+286↑j ...
                prefetchw byte ptr [rbx]
                mov     eax, [rbx]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rbx], ecx
                jz      short loc_140224C1E
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jz      short loc_140224C12
                cmp     byte ptr [rdi+20h], 1
                ja      short loc_140224C12
                mov     eax, [rcx+18h]
                sub     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_140224C12
                mov     rcx, rdi
                call    sub_1403F2EC4

loc_140224C12:                          ; CODE XREF: sub_140224940+2B7↑j
                                        ; sub_140224940+2BD↑j ...
                movzx   edx, sil
                mov     rcx, rbx
                call    sub_140329420

loc_140224C1E:                          ; CODE XREF: sub_140224940+26B↑j
                                        ; sub_140224940+2AB↑j
                cmp     [rbx+4], r13d
                jz      short loc_140224C2A
                mov     eax, r13d
                xchg    eax, [rbx+4]

loc_140224C2A:                          ; CODE XREF: sub_140224940+1AA↑j
                                        ; sub_140224940+1B2↑j ...
                mov     [r12+44h], sil
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                movzx   eax, byte ptr [rcx+738h]
                and     al, 7
                cmp     al, 2
                jz      short loc_140224C53
                lea     rbp, [rcx+740h]

loc_140224C53:                          ; CODE XREF: sub_140224940+30A↑j
                movzx   eax, byte ptr [rcx+73Bh]
                mov     rcx, 0FFFF800000000000h
                and     al, 60h
                cmp     al, 60h ; '`'
                jnz     short loc_140224C98
                cmp     [rbp+20h], r13
                jz      short loc_140224C98
                cmp     r12, rcx
                jnb     short loc_140224C98
                mov     rcx, r12
                call    sub_14026A130
                test    rax, rax
                jz      short loc_140224C8E
                mov     rcx, rax
                call    sub_14052B878
                test    eax, eax
                jz      short loc_140224C98

loc_140224C8E:                          ; CODE XREF: sub_140224940+340↑j
                                        ; sub_140224940+B99↓j ...
                mov     ebx, 0C0000005h
                jmp     loc_14022580F
; ---------------------------------------------------------------------------

loc_140224C98:                          ; CODE XREF: sub_140224940+328↑j
                                        ; sub_140224940+32E↑j ...
                mov     rcx, [r12]
                mov     rax, 0FFFF800000010000h
                add     rax, rcx
                mov     rdx, 0FFFF00000000FFFFh
                cmp     rax, rdx
                ja      short loc_140224CC2
                mov     ebx, 0C0000005h
                jmp     loc_14022580F
; ---------------------------------------------------------------------------

loc_140224CC2:                          ; CODE XREF: sub_140224940+376↑j
                mov     rax, gs:188h
                mov     rbx, [rax+0B8h]
                cmp     [rbx+4D8h], r13
                jz      short loc_140224CEE
                lea     rdx, [r12+38h]
                call    sub_140363430
                cmp     eax, 1
                jz      loc_14022580C

loc_140224CEE:                          ; CODE XREF: sub_140224940+399↑j
                mov     rcx, [rbx+9F8h]
                test    rcx, rcx
                jz      short loc_140224D0B
                mov     rdx, r12
                call    sub_14053E4AC
                cmp     eax, 1
                jz      loc_14022580C

loc_140224D0B:                          ; CODE XREF: sub_140224940+3B8↑j
                test    byte ptr [r12+45h], 1
                mov     rbp, [r12+38h]
                mov     rbx, 0FFFFF6FB7DBED7F8h
                mov     rcx, 0FFFFF68000000000h
                mov     rdi, 0FFFFF6FFFFFFFFFFh
                jnz     short loc_140224D7C
                mov     rdx, [r12]
                mov     rax, rcx
                cmp     rdx, rax
                jb      short loc_140224D4A
                mov     rax, rdi
                cmp     rdx, rax
                jbe     short loc_140224D7C

loc_140224D4A:                          ; CODE XREF: sub_140224940+400↑j
                xor     r8d, r8d
                mov     rcx, rbp
                call    sub_1402258A0
                movsxd  rcx, eax
                test    eax, eax
                jz      short loc_140224D7C
                mov     rdx, [r12+rcx*8+18h]
                mov     [r12+48h], rdx
                cmp     ecx, 1
                jz      loc_140225053
                mov     rcx, rbp
                call    sub_140312B40
                mov     [r12+48h], r13

loc_140224D7C:                          ; CODE XREF: sub_140224940+3F4↑j
                                        ; sub_140224940+408↑j ...
                test    byte ptr [r12+45h], 1
                mov     ebx, r13d
                jnz     short loc_140224DA7
                mov     rcx, 0FFFFF6FB7DBEDF68h
                mov     rax, rcx
                mov     [r12+48h], rax
                mov     rdx, rcx
                xor     r8d, r8d
                mov     rcx, rbp
                call    sub_140225CC0

loc_140224DA7:                          ; CODE XREF: sub_140224940+445↑j
                lea     rsi, [r12+30h]
                nop     dword ptr [rax+00h]

loc_140224DB0:                          ; CODE XREF: sub_140224940+635↓j
                mov     rdi, [rsi]
                mov     r9, 0FFFFF6FB7DBED000h
                mov     rdx, [rdi]
                mov     rcx, rdx
                mov     rax, r9
                mov     r8, 0FFFFF6FB7DBED7F8h
                cmp     rdi, rax
                jb      loc_140224E72
                mov     rax, r8
                cmp     rdi, rax
                ja      loc_140224E72
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140224E5E
                mov     rax, gs:188h
                mov     r8, [rax+0B8h]
                cmp     byte ptr [r8+390h], 1
                jz      short loc_140224E5E
                test    cl, 1
                jz      short loc_140224E5E
                test    cl, 20h
                jz      short loc_140224E1A
                test    cl, 42h
                jnz     short loc_140224E5E

loc_140224E1A:                          ; CODE XREF: sub_140224940+4D3↑j
                mov     rax, gs:188h
                mov     r8, [rax+0B8h]
                mov     r9, [r8+788h]
                test    r9, r9
                jz      short loc_140224E5E
                or      rcx, 20h
                mov     rax, rdi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r9+rax*8]
                movzx   r8d, al
                and     r8b, 20h
                cmovz   rcx, rdx
                test    al, 42h
                jz      short loc_140224E5E
                or      rcx, 42h

loc_140224E5E:                          ; CODE XREF: sub_140224940+4AF↑j
                                        ; sub_140224940+4C9↑j ...
                mov     r8, 0FFFFF6FB7DBED7F8h
                mov     r9, 0FFFFF6FB7DBED000h

loc_140224E72:                          ; CODE XREF: sub_140224940+493↑j
                                        ; sub_140224940+49F↑j
                test    cl, 1
                jnz     loc_140224F3A
                mov     rax, r9
                cmp     rdi, rax
                jb      short loc_140224EE9
                mov     rax, r8
                cmp     rdi, rax
                ja      short loc_140224EE9
                call    sub_140349680
                test    eax, eax
                jz      short loc_140224EE9
                test    dl, 1
                jz      short loc_140224EEE
                test    dl, 20h
                jz      short loc_140224EA3
                test    dl, 42h
                jnz     short loc_140224EE9

loc_140224EA3:                          ; CODE XREF: sub_140224940+55C↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140224EE9
                shr     rdi, 3
                mov     r8, rdx
                and     edi, 1FFh
                or      r8, 20h
                mov     rax, [rax+rdi*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140224EE9
                or      rdx, 42h

loc_140224EE9:                          ; CODE XREF: sub_140224940+541↑j
                                        ; sub_140224940+549↑j ...
                test    dl, 1
                jnz     short loc_140224F1C

loc_140224EEE:                          ; CODE XREF: sub_140224940+557↑j
                test    rdx, rdx
                jz      short loc_140224F1C
                bt      rdx, 0Ah
                jb      short loc_140224F1C
                bt      rdx, 0Bh
                jnb     short loc_140224F0D
                shr     rdx, 5
                and     edx, 1Fh
                cmp     dl, 18h
                jmp     short loc_140224F1A
; ---------------------------------------------------------------------------

loc_140224F0D:                          ; CODE XREF: sub_140224940+5BF↑j
                mov     ecx, 200h
                call    sub_14027C6C0
                cmp     rdx, rax

loc_140224F1A:                          ; CODE XREF: sub_140224940+5CB↑j
                jz      short loc_140224F85

loc_140224F1C:                          ; CODE XREF: sub_140224940+5AC↑j
                                        ; sub_140224940+5B1↑j ...
                mov     edx, r15d
                mov     rcx, r12
                call    sub_14029AEC0
                mov     ebx, eax
                test    eax, eax
                js      loc_140224FF2
                inc     r15d
                add     rsi, 8
                jmp     short loc_140224F6D
; ---------------------------------------------------------------------------

loc_140224F3A:                          ; CODE XREF: sub_140224940+535↑j
                test    cl, cl
                js      short loc_140224F99
                mov     rax, [r12+48h]
                test    rax, rax
                jz      short loc_140224F6D
                cmp     rdi, rax
                jz      short loc_140224F6D
                xor     r8d, r8d
                mov     rdx, rdi
                mov     rcx, rbp
                call    sub_140225CC0
                mov     rdx, [r12+48h]
                mov     rcx, rbp
                call    sub_140312B40
                mov     [r12+48h], rdi

loc_140224F6D:                          ; CODE XREF: sub_140224940+5F8↑j
                                        ; sub_140224940+606↑j ...
                sub     rsi, 8
                sub     r15d, 1
                jnz     loc_140224DB0
                test    ebx, ebx
                jns     loc_14022502B
                jmp     short loc_140224FF2
; ---------------------------------------------------------------------------

loc_140224F85:                          ; CODE XREF: sub_140224940:loc_140224F1A↑j
                lea     rcx, [r12+38h]
                call    sub_1402642A8
                mov     ebx, 0C0000005h
                jmp     loc_14022580F
; ---------------------------------------------------------------------------

loc_140224F99:                          ; CODE XREF: sub_140224940+5FC↑j
                mov     r9, [r12+10h]
                test    r9b, 1
                jz      short loc_140224FB0
                mov     rax, r9
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 1
                jz      short loc_140224FDC

loc_140224FB0:                          ; CODE XREF: sub_140224940+662↑j
                mov     rdx, [r12]
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rdx, rax
                jb      short loc_140224FDC
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rdx, rax
                jbe     loc_14022587F

loc_140224FDC:                          ; CODE XREF: sub_140224940+66E↑j
                                        ; sub_140224940+684↑j
                mov     rdx, rdi
                mov     rcx, r12
                call    sub_140548C84
                mov     ebx, eax
                test    eax, eax
                js      short loc_140224FF2
                mov     ebx, 0C0000434h

loc_140224FF2:                          ; CODE XREF: sub_140224940+5EB↑j
                                        ; sub_140224940+643↑j ...
                mov     rdx, [r12+48h]
                mov     rdi, [r12+38h]
                test    rdx, rdx
                jz      short loc_14022502B
                cmp     [r12+42h], r13w
                jz      short loc_140225018
                lea     rcx, [r12+38h]
                call    sub_14026F5D0
                mov     rdx, [r12+48h]

loc_140225018:                          ; CODE XREF: sub_140224940+6C7↑j
                mov     rcx, rdi
                call    sub_140312B40
                or      byte ptr [r12+45h], 2
                mov     [r12+48h], r13

loc_14022502B:                          ; CODE XREF: sub_140224940+63D↑j
                                        ; sub_140224940+6BF↑j
                cmp     ebx, 0C0000434h
                jz      loc_14022580C
                test    ebx, ebx
                js      loc_14022580F
                mov     rdi, 0FFFFF6FFFFFFFFFFh
                mov     rbx, 0FFFFF6FB7DBED7F8h

loc_140225053:                          ; CODE XREF: sub_140224940+429↑j
                mov     rsi, [r12+18h]
                mov     rbp, 0FFFFF6FB7DBED000h
                mov     rdx, [rsi]
                mov     rax, rbp
                cmp     rsi, rax
                jb      short loc_1402250D5
                mov     rax, rbx
                cmp     rsi, rax
                ja      short loc_1402250D5
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402250D5
                test    dl, 1
                jz      short loc_1402250E9
                test    dl, 20h
                jz      short loc_14022508D
                test    dl, 42h
                jnz     short loc_1402250D5

loc_14022508D:                          ; CODE XREF: sub_140224940+746↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_1402250D5
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_1402250D5
                or      rdx, 42h

loc_1402250D5:                          ; CODE XREF: sub_140224940+72B↑j
                                        ; sub_140224940+733↑j ...
                test    dl, 1
                jz      short loc_1402250E9
                mov     rcx, r12
                call    sub_140220920
                mov     ebx, eax
                jmp     loc_14022580F
; ---------------------------------------------------------------------------

loc_1402250E9:                          ; CODE XREF: sub_140224940+741↑j
                                        ; sub_140224940+798↑j
                mov     rcx, [r12+8]
                mov     r15, [rsp+88h+var_58]
                test    cl, 2
                jz      short loc_14022511C
                mov     eax, [r15+464h]
                test    al, 10h
                jz      short loc_14022511C
                mov     rax, 0FFFF800000000000h
                cmp     [r12], rax
                jnb     short loc_14022511C
                and     rcx, 0FFFFFFFFFFFFFFFDh
                mov     [r12+8], rcx

loc_14022511C:                          ; CODE XREF: sub_140224940+7B6↑j
                                        ; sub_140224940+7C1↑j ...
                test    rdx, rdx
                jnz     loc_140225345
                lea     r9, [rsp+88h+arg_18]
                mov     [rsp+88h+arg_0], r13b
                lea     r8, [rsp+88h+arg_8]
                mov     rcx, r12
                lea     rdx, [rsp+88h+arg_0]
                call    sub_1402498E0
                movzx   ebp, [rsp+88h+arg_0]
                mov     edi, eax
                test    bpl, bpl
                jz      short loc_1402251D1
                mov     rdx, [r12+48h]
                mov     rbx, [r12+38h]
                test    rdx, rdx
                jz      short loc_140225195
                cmp     [r12+42h], r13w
                jz      short loc_140225182
                lea     rcx, [r12+38h]
                call    sub_14026F5D0
                mov     rdx, [r12+48h]

loc_140225182:                          ; CODE XREF: sub_140224940+831↑j
                mov     rcx, rbx
                call    sub_140312B40
                or      byte ptr [r12+45h], 2
                mov     [r12+48h], r13

loc_140225195:                          ; CODE XREF: sub_140224940+829↑j
                movzx   eax, byte ptr [r12+45h]
                mov     rcx, rbx
                movzx   edx, byte ptr [r12+44h]
                test    al, 1
                jz      short loc_1402251AF
                call    sub_140234180
                jmp     short loc_1402251B4
; ---------------------------------------------------------------------------

loc_1402251AF:                          ; CODE XREF: sub_140224940+866↑j
                call    sub_140226960

loc_1402251B4:                          ; CODE XREF: sub_140224940+86D↑j
                cmp     bpl, 2
                jnz     short loc_1402251CA
                mov     rcx, [r12]
                mov     edx, 1
                call    sub_1406F9F64
                mov     edi, eax

loc_1402251CA:                          ; CODE XREF: sub_140224940+878↑j
                mov     eax, edi
                jmp     loc_140225869
; ---------------------------------------------------------------------------

loc_1402251D1:                          ; CODE XREF: sub_140224940+81A↑j
                mov     rbp, 0FFFFF6FB7DBED000h

loc_1402251DB:                          ; CODE XREF: sub_140224940+A1B↓j
                mov     r10d, 1

loc_1402251E1:                          ; CODE XREF: sub_140224940+CC5↓j
                cmp     [rsp+88h+arg_8], 100h
                jz      loc_1402257F8
                mov     r8d, [r12+8]
                mov     eax, [r12+50h]
                and     r8d, 2
                mov     r9, [r12+10h]
                shr     eax, 6
                test    al, 1
                jz      short loc_14022523B
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                mov     rcx, 3FFFFFFF78h
                add     rax, rcx
                cmp     rsi, rax
                ja      loc_1402252DF
                mov     rax, rdx
                cmp     rsi, rax
                jb      loc_1402252DF

loc_14022523B:                          ; CODE XREF: sub_140224940+8CA↑j
                mov     rdi, [rsi]
                mov     rax, rbp
                cmp     rsi, rax
                jb      short loc_1402252BF
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rsi, rax
                ja      short loc_1402252BF
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402252BF
                test    dil, 1
                jz      loc_140225615
                test    dil, 20h
                jz      short loc_140225277
                test    dil, 42h
                jnz     short loc_1402252BF

loc_140225277:                          ; CODE XREF: sub_140224940+92F↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_1402252BF
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_1402252BF
                or      rdi, 42h

loc_1402252BF:                          ; CODE XREF: sub_140224940+904↑j
                                        ; sub_140224940+916↑j ...
                test    dil, 1
                jz      loc_140225615
                test    r8, r8
                jz      loc_1402257F8
                test    rdi, 0A00h
                jnz     loc_1402257F8

loc_1402252DF:                          ; CODE XREF: sub_140224940+8E9↑j
                                        ; sub_140224940+8F5↑j ...
                mov     rcx, [r12]
                mov     rax, 0FFFF800000000000h
                cmp     rcx, rax
                jnb     short loc_1402252FE
                call    sub_14026A130
                mov     rcx, [r12]
                mov     r13, rax

loc_1402252FE:                          ; CODE XREF: sub_140224940+9B0↑j
                mov     r8, [r12+8]
                mov     r9, r15
                mov     rdx, r13
                call    sub_140352580
                mov     [r12+58h], r13
                mov     ebx, 0C0000005h

loc_140225318:                          ; CODE XREF: sub_140224940+E1F↓j
                                        ; sub_140224940+E78↓j ...
                xor     r8d, r8d
                lea     rcx, [r12+38h]
                mov     dl, 11h
                call    sub_14026EDF8
                cmp     ebx, 80000001h
                jnz     loc_140225867
                mov     rcx, [r12]
                xor     edx, edx
                call    sub_1406F9F64
                mov     ebx, eax
                jmp     loc_140225867
; ---------------------------------------------------------------------------

loc_140225345:                          ; CODE XREF: sub_140224940+7DF↑j
                mov     rax, rdx
                shr     rax, 5
                and     eax, 1Fh
                mov     [rsp+88h+arg_8], eax
                bt      rdx, 0Ah
                jnb     loc_1402251DB
                mov     rdx, [rsi]
                mov     [rsp+88h+arg_10], r13d
                mov     rax, rbp
                cmp     rsi, rax
                jb      short loc_1402253DC
                mov     rax, rbx
                cmp     rsi, rax
                ja      short loc_1402253DC
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402253DC
                test    dl, 1
                jz      short loc_1402253DC
                test    dl, 20h
                jz      short loc_140225394
                test    dl, 42h
                jnz     short loc_1402253DC

loc_140225394:                          ; CODE XREF: sub_140224940+A4D↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_1402253DC
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_1402253DC
                or      rdx, 42h

loc_1402253DC:                          ; CODE XREF: sub_140224940+A32↑j
                                        ; sub_140224940+A3A↑j ...
                mov     rbx, rdx
                shr     rbx, 5
                and     ebx, 1Fh
                bt      rdx, 0Ah
                jnb     loc_1402255C0
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rdx
                test    rcx, rcx
                jz      short loc_14022540E
                test    dl, 10h
                jnz     short loc_14022540E
                mov     rax, rcx
                not     rax
                and     rax, rdx

loc_14022540E:                          ; CODE XREF: sub_140224940+ABE↑j
                                        ; sub_140224940+AC3↑j
                shr     rax, 20h
                mov     ecx, 0FFFFFFFFh
                cmp     rax, rcx
                jnz     loc_1402255C0
                mov     r9, rsi
                mov     rcx, 0FFFFF68000000000h
                shl     r9, 19h
                mov     rax, rcx
                shl     rax, 19h
                sub     r9, rax
                mov     rax, 7FFFFFFEFFFFh
                sar     r9, 10h
                cmp     r9, rax
                ja      loc_140225596
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     eax, [rcx+87Ch]
                test    al, 1
                jnz     short loc_1402254BF
                mov     rax, r9
                and     rax, 0FFFFFFFFFFFFF000h
                cmp     rax, 7FFE0000h
                jnz     short loc_140225497
                mov     rcx, cs:qword_140C4DCB8
                mov     r10d, 1
                mov     [rsp+88h+arg_10], r10d
                jmp     loc_1402255F3
; ---------------------------------------------------------------------------

loc_140225497:                          ; CODE XREF: sub_140224940+B3B↑j
                cmp     rax, cs:qword_140C4DCC8
                jnz     short loc_1402254BF
                test    rax, rax
                jz      short loc_1402254BF
                mov     rcx, cs:qword_140C4DCC0
                mov     r10d, 1
                mov     [rsp+88h+arg_10], r10d
                jmp     loc_1402255F3
; ---------------------------------------------------------------------------

loc_1402254BF:                          ; CODE XREF: sub_140224940+B2A↑j
                                        ; sub_140224940+B5E↑j ...
                mov     rax, gs:188h
                mov     r10, [rax+0B8h]
                mov     r8, [r10+7E0h]
                test    r8, r8
                jz      loc_140224C8E
                movzx   ecx, byte ptr [r8+20h]
                mov     rdx, r9
                mov     eax, [r8+18h]
                shl     rcx, 20h
                or      rcx, rax
                shr     rdx, 0Ch
                cmp     rdx, rcx
                jb      short loc_140225510
                movzx   ecx, byte ptr [r8+21h]
                mov     eax, [r8+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rdx, rcx
                jbe     short loc_140225572

loc_140225510:                          ; CODE XREF: sub_140224940+BB9↑j
                mov     r8, [r10+7D8h]
                test    r8, r8
                jz      loc_140224C8E

loc_140225520:                          ; CODE XREF: sub_140224940+C16↓j
                movzx   ecx, byte ptr [r8+21h]
                mov     eax, [r8+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rdx, rcx
                ja      short loc_14022554F
                movzx   ecx, byte ptr [r8+20h]
                mov     eax, [r8+18h]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rdx, rcx
                jnb     short loc_140225562
                mov     r8, [r8]
                jmp     short loc_140225553
; ---------------------------------------------------------------------------

loc_14022554F:                          ; CODE XREF: sub_140224940+BF3↑j
                mov     r8, [r8+8]

loc_140225553:                          ; CODE XREF: sub_140224940+C0D↑j
                test    r8, r8
                jnz     short loc_140225520
                mov     ebx, 0C0000005h
                jmp     loc_14022580F
; ---------------------------------------------------------------------------

loc_140225562:                          ; CODE XREF: sub_140224940+C08↑j
                test    r8, r8
                jz      loc_140224C8E
                mov     [r10+7E0h], r8

loc_140225572:                          ; CODE XREF: sub_140224940+BCE↑j
                test    r8, r8
                jz      loc_140224C8E
                lea     rdx, [rsp+88h+arg_10]
                mov     rcx, r9
                call    sub_140281130
                mov     rcx, rax
                mov     r10d, 1
                jmp     short loc_1402255F3
; ---------------------------------------------------------------------------

loc_140225596:                          ; CODE XREF: sub_140224940+B0C↑j
                mov     rax, rcx
                cmp     r9, rax
                jb      short loc_1402255AA
                mov     rax, rdi
                cmp     r9, rax
                jbe     loc_140224C8E

loc_1402255AA:                          ; CODE XREF: sub_140224940+C5C↑j
                mov     [rsp+88h+arg_10], 18h
                mov     rcx, r13
                mov     r10d, 1
                jmp     short loc_1402255F3
; ---------------------------------------------------------------------------

loc_1402255C0:                          ; CODE XREF: sub_140224940+AAB↑j
                                        ; sub_140224940+ADA↑j
                mov     rax, cs:qword_140C4DDC0
                mov     rcx, rdx
                test    rax, rax
                jz      short loc_1402255DD
                test    dl, 10h
                jnz     short loc_1402255DD
                mov     rcx, rax
                not     rcx
                and     rcx, rdx

loc_1402255DD:                          ; CODE XREF: sub_140224940+C8D↑j
                                        ; sub_140224940+C92↑j
                sar     rcx, 10h
                mov     ebx, 100h
                test    dl, 8
                mov     r10d, 1
                cmovnz  ebx, r10d

loc_1402255F3:                          ; CODE XREF: sub_140224940+B52↑j
                                        ; sub_140224940+B7A↑j ...
                mov     [rsp+88h+arg_8], ebx
                mov     [rsp+88h+arg_18], rcx
                test    rcx, rcx
                jnz     loc_1402251E1
                mov     ebx, 0C0000005h
                jmp     loc_14022580F
; ---------------------------------------------------------------------------

loc_140225615:                          ; CODE XREF: sub_140224940+925↑j
                                        ; sub_140224940+983↑j
                mov     edx, [rsp+88h+arg_8]
                lea     rcx, qword_140011808
                test    r8, r8
                mov     eax, edx
                mov     ebx, edx
                cmovnz  r8, r10
                and     eax, 7
                movsx   eax, byte ptr [rax+rcx]
                sub     eax, r8d
                cmp     eax, 0Ah
                jl      loc_1402252DF
                and     edx, 0FFFFFFF8h
                cmp     edx, 10h
                jnz     loc_1402257F8
                test    r9b, 1
                jz      short loc_140225663
                mov     rax, r9
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 1
                jz      loc_1402257F8

loc_140225663:                          ; CODE XREF: sub_140224940+D11↑j
                mov     rcx, r9
                call    sub_140338B70
                test    eax, eax
                jz      loc_1402252DF
                bt      rdi, 0Bh
                jnb     loc_140225764
                bt      rdi, 0Ah
                jb      loc_140225764
                xor     edx, edx
                mov     rcx, rsi
                call    sub_1402A886C
                mov     rcx, rsi
                mov     rbp, rax
                call    sub_1402805F0
                and     ebx, 0Fh
                mov     rdi, rax
                test    rbp, rbp
                jz      short loc_1402256C1
                mov     rcx, [rbp+10h]
                mov     eax, ebx
                and     rcx, 0FFFFFFFFFFFFFC1Fh
                shl     rax, 5
                or      rcx, rax
                mov     [rbp+10h], rcx

loc_1402256C1:                          ; CODE XREF: sub_140224940+D67↑j
                and     rdi, 0FFFFFFFFFFFFFC1Fh
                shl     rbx, 5
                mov     rcx, rsi
                or      rdi, rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14022573F
                call    sub_140349680
                test    eax, eax
                jz      short loc_140225710
                cmp     byte ptr cs:word_140C4DE88+1, r13b
                jnz     short loc_140225700
                test    dil, 1
                jz      short loc_140225700
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_140225700:                          ; CODE XREF: sub_140224940+DAB↑j
                                        ; sub_140224940+DB1↑j
                mov     rdx, rdi
                mov     [rsi], rdi
                mov     rcx, rsi
                call    sub_140349620
                jmp     short loc_140225742
; ---------------------------------------------------------------------------

loc_140225710:                          ; CODE XREF: sub_140224940+DA2↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022573F
                test    dil, 1
                jz      short loc_14022573F
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_14022573F:                          ; CODE XREF: sub_140224940+D99↑j
                                        ; sub_140224940+DEA↑j ...
                mov     [rsi], rdi

loc_140225742:                          ; CODE XREF: sub_140224940+DCE↑j
                test    rbp, rbp
                jz      loc_1402257EE
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbp+18h], rax
                mov     ebx, 80000001h
                jmp     loc_140225318
; ---------------------------------------------------------------------------

loc_140225764:                          ; CODE XREF: sub_140224940+D38↑j
                                        ; sub_140224940+D43↑j
                and     ebx, 0Fh
                and     rdi, 0FFFFFFFFFFFFFC1Fh
                shl     rbx, 5
                mov     rcx, rsi
                or      rbx, rdi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_1402257EB
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402257BD
                cmp     byte ptr cs:word_140C4DE88+1, r13b
                jnz     short loc_1402257A5
                test    bl, 1
                jz      short loc_1402257A5
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_1402257A5:                          ; CODE XREF: sub_140224940+E51↑j
                                        ; sub_140224940+E56↑j
                mov     rdx, rbx
                mov     [rsi], rbx
                mov     rcx, rsi
                call    sub_140349620
                mov     ebx, 80000001h
                jmp     loc_140225318
; ---------------------------------------------------------------------------

loc_1402257BD:                          ; CODE XREF: sub_140224940+E48↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_1402257EB
                test    bl, 1
                jz      short loc_1402257EB
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_1402257EB:                          ; CODE XREF: sub_140224940+E3F↑j
                                        ; sub_140224940+E97↑j ...
                mov     [rsi], rbx

loc_1402257EE:                          ; CODE XREF: sub_140224940+E05↑j
                mov     ebx, 80000001h
                jmp     loc_140225318
; ---------------------------------------------------------------------------

loc_1402257F8:                          ; CODE XREF: sub_140224940+8AC↑j
                                        ; sub_140224940+98C↑j ...
                mov     rax, [rsp+88h+arg_18]
                mov     [r12+60h], rax
                mov     eax, 0C0000016h
                jmp     short loc_140225869
; ---------------------------------------------------------------------------

loc_14022580C:                          ; CODE XREF: sub_140224940+3A8↑j
                                        ; sub_140224940+3C5↑j ...
                mov     ebx, r13d

loc_14022580F:                          ; CODE XREF: sub_140224940+353↑j
                                        ; sub_140224940+37D↑j ...
                mov     rdx, [r12+48h]
                mov     rdi, [r12+38h]
                test    rdx, rdx
                jz      short loc_140225848
                cmp     [r12+42h], r13w
                jz      short loc_140225835
                lea     rcx, [r12+38h]
                call    sub_14026F5D0
                mov     rdx, [r12+48h]

loc_140225835:                          ; CODE XREF: sub_140224940+EE4↑j
                mov     rcx, rdi
                call    sub_140312B40
                or      byte ptr [r12+45h], 2
                mov     [r12+48h], r13

loc_140225848:                          ; CODE XREF: sub_140224940+EDC↑j
                movzx   eax, byte ptr [r12+45h]
                mov     rcx, rdi
                movzx   edx, byte ptr [r12+44h]
                test    al, 1
                jz      short loc_140225862
                call    sub_140234180
                jmp     short loc_140225867
; ---------------------------------------------------------------------------

loc_140225862:                          ; CODE XREF: sub_140224940+F19↑j
                call    sub_140226960

loc_140225867:                          ; CODE XREF: sub_140224940+9ED↑j
                                        ; sub_140224940+A00↑j ...
                mov     eax, ebx

loc_140225869:                          ; CODE XREF: sub_140224940+88C↑j
                                        ; sub_140224940+ECA↑j
                mov     rdi, [rsp+88h+var_40]
                add     rsp, 50h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
byte_14022587E  db 0CCh                 ; DATA XREF: .pdata:00000001400CAEF0↑o
                                        ; .pdata:00000001400CAEFC↑o
; ---------------------------------------------------------------------------

loc_14022587F:                          ; CODE XREF: sub_140224940+696↑j
                                        ; DATA XREF: .pdata:00000001400CAEFC↑o ...
                mov     r8, [r12+8]
                mov     ecx, 50h ; 'P'
                mov     [rsp+88h+var_68], 8
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_140224940   endp

algn_140225898:                         ; DATA XREF: .pdata:00000001400CAF08↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402258A0   proc near               ; CODE XREF: sub_1402225B0+C2↑p
                                        ; sub_140224940+410↑p ...

var_58          = dword ptr -58h
var_54          = dword ptr -54h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140429C24 SIZE 00000024 BYTES

; __unwind { // __C_specific_handler
                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], r8d
                mov     [rsp+arg_0], rcx
                push    rsi
                push    rdi
                push    r12
                push    r14
                push    r15
                sub     rsp, 50h
                mov     r9, rdx
                mov     rdi, rcx
                xor     r10d, r10d
                movzx   eax, byte ptr [rcx+0B8h]
                and     al, 7
                lea     r8d, [rax-1]
                cmp     r8b, 2
                jbe     short loc_1402258ED
                cmp     al, 7
                jz      short loc_1402258ED
                cmp     al, 5
                jz      loc_140225C7E
                test    al, al
                jnz     short loc_1402258ED

loc_1402258E7:                          ; CODE XREF: sub_1402258A0+3E8↓j
                                        ; sub_1402258A0+3FE↓j
                mov     r10d, 1

loc_1402258ED:                          ; CODE XREF: sub_1402258A0+35↑j
                                        ; sub_1402258A0+39↑j ...
                mov     rax, gs:20h
                mov     rbx, [rax+7FF8h]
                mov     [rsp+78h+var_38], rbx
                test    byte ptr cs:dword_140CFC400+3, 1
                jz      loc_140225CA4
                test    rbx, rbx
                jz      loc_140225CA4
                cmp     dword ptr [rbx+30C0h], 0
                jnz     loc_140225CA4
                mov     dword ptr [rbx+30C0h], 1
                mov     [rsp+78h+var_54], 0
                xor     edx, edx
                mov     [rsp+78h+var_58], edx
                shr     r9, 12h
                and     r9d, 3FFFFFF8h
                mov     r11, 0FFFFF6FB40000000h
                mov     rax, r11
                lea     r14, [r9+rax]
                mov     [rsp+78h+var_30], r14
                mov     rsi, r14
                mov     [rsp+78h+arg_18], r14

loc_140225969:                          ; DATA XREF: .rdata:0000000140052E50↑o
;   __try { // __except at loc_140225BF7
                or      [rsp+78h+arg_10], 2
                mov     r12, 7FFFFFFFF8h
                mov     r15, 0FFFFF68000000000h
                test    r10d, r10d
                jz      loc_140225BA1
                mov     [rsp+78h+var_40], rdx
                mov     r8, r14
                shr     r8, 9
                and     r8, r12
                mov     rax, r15
                add     r8, rax
                mov     [rsp+78h+var_40], r8
                mov     rax, [r8]
                mov     r9, 0FFFFF6FB7DBED000h
                mov     rcx, r9
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     r8, rcx
                jnb     loc_140225ABE

loc_1402259CB:                          ; CODE XREF: sub_1402258A0+224↓j
                                        ; sub_1402258A0+239↓j ...
                test    al, 1
                jz      loc_140225B91
                test    al, al
                js      loc_140225BBA

loc_1402259DB:                          ; CODE XREF: sub_1402258A0+2EC↓j
                                        ; sub_1402258A0+315↓j ...
                mov     rax, [rsi]
                mov     rcx, r9
                cmp     rsi, rcx
                jnb     short loc_140225A16

loc_1402259E6:                          ; CODE XREF: sub_1402258A0+17C↓j
                                        ; sub_1402258A0+18D↓j ...
                test    al, 1
                jz      loc_140225B5C
                test    al, al
                js      loc_140225B67
                mov     r8d, [rsp+78h+arg_10]
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_140225CC0
                test    eax, eax
                jz      loc_140225B96
                jmp     loc_140225BEC
; ---------------------------------------------------------------------------

loc_140225A16:                          ; CODE XREF: sub_1402258A0+144↑j
                mov     rcx, r10
                cmp     rsi, rcx
                ja      short loc_1402259E6
                mov     [rsp+78h+var_48], rax
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_1402259E6
                mov     rcx, gs:188h
                mov     rcx, [rcx+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      loc_140225BDF
                test    al, 1
                jz      loc_140225BDF
                test    al, 20h
                jz      short loc_140225A60
                test    al, 42h
                jnz     loc_140225BDF

loc_140225A60:                          ; CODE XREF: sub_1402258A0+1B6↑j
                mov     rcx, gs:188h
                mov     rcx, [rcx+0B8h]
                mov     rdx, [rcx+788h]
                mov     rsi, [rsp+78h+arg_18]
                test    rdx, rdx
                jz      loc_1402259E6
                mov     rcx, rsi
                shr     rcx, 3
                and     ecx, 1FFh
                mov     rcx, [rdx+rcx*8]
                test    cl, 20h
                jz      short loc_140225AA7
                or      rax, 20h
                mov     [rsp+78h+var_48], rax

loc_140225AA7:                          ; CODE XREF: sub_1402258A0+1FC↑j
                test    cl, 42h
                jz      loc_1402259E6
                or      rax, 42h
                mov     [rsp+78h+var_48], rax
                jmp     loc_1402259E6
; ---------------------------------------------------------------------------

loc_140225ABE:                          ; CODE XREF: sub_1402258A0+125↑j
                mov     rcx, r10
                cmp     r8, rcx
                ja      loc_1402259CB
                mov     [rsp+78h+var_50], rax
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_1402259CB
                mov     rcx, gs:188h
                mov     rcx, [rcx+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140225B4B
                test    al, 1
                jz      short loc_140225B4B
                test    al, 20h
                jz      short loc_140225B04
                test    al, 42h
                jnz     short loc_140225B4B

loc_140225B04:                          ; CODE XREF: sub_1402258A0+25E↑j
                mov     rcx, gs:188h
                mov     rcx, [rcx+0B8h]
                mov     rcx, [rcx+788h]
                test    rcx, rcx
                jz      short loc_140225B4B
                shr     r8, 3
                and     r8d, 1FFh
                mov     rcx, [rcx+r8*8]
                test    cl, 20h
                jz      short loc_140225B3D
                or      rax, 20h
                mov     [rsp+78h+var_50], rax

loc_140225B3D:                          ; CODE XREF: sub_1402258A0+292↑j
                test    cl, 42h
                jz      short loc_140225B4B
                or      rax, 42h
                mov     [rsp+78h+var_50], rax

loc_140225B4B:                          ; CODE XREF: sub_1402258A0+256↑j
                                        ; sub_1402258A0+25A↑j ...
                mov     rsi, [rsp+78h+arg_18]
                mov     edx, [rsp+78h+var_58]
                jmp     loc_1402259CB
; ---------------------------------------------------------------------------

loc_140225B5C:                          ; CODE XREF: sub_1402258A0+148↑j
                xor     edx, edx
                mov     [rsp+78h+var_58], edx
                jmp     loc_140225C2B
; ---------------------------------------------------------------------------

loc_140225B67:                          ; CODE XREF: sub_1402258A0+150↑j
                mov     [rsp+78h+var_58], 2
                mov     [rsp+78h+var_54], 2
                shr     rsi, 9
                and     rsi, r12
                mov     rax, r15
                add     rsi, rax
                mov     [rsp+78h+arg_18], rsi
                jmp     loc_1402259DB
; ---------------------------------------------------------------------------

loc_140225B91:                          ; CODE XREF: sub_1402258A0+12D↑j
                jmp     loc_140225C2B
; ---------------------------------------------------------------------------

loc_140225B96:                          ; CODE XREF: sub_1402258A0+16B↑j
                xor     edx, edx
                mov     [rsp+78h+var_58], edx
                jmp     loc_140225C2B
; ---------------------------------------------------------------------------

loc_140225BA1:                          ; CODE XREF: sub_1402258A0+E8↑j
                mov     r9, 0FFFFF6FB7DBED000h
                mov     r10, 0FFFFF6FB7DBED7F8h
                jmp     loc_1402259DB
; ---------------------------------------------------------------------------

loc_140225BBA:                          ; CODE XREF: sub_1402258A0+135↑j
                mov     [rsp+78h+var_54], 3
                shr     rsi, 12h
                and     esi, 3FFFFFF8h
                mov     rax, r11
                add     rsi, rax
                mov     [rsp+78h+arg_18], rsi
                jmp     loc_1402259DB
; ---------------------------------------------------------------------------

loc_140225BDF:                          ; CODE XREF: sub_1402258A0+1A6↑j
                                        ; sub_1402258A0+1AE↑j ...
                mov     rsi, [rsp+78h+arg_18]
                jmp     loc_1402259E6
; ---------------------------------------------------------------------------

loc_140225BEC:                          ; CODE XREF: sub_1402258A0+171↑j
                mov     edx, 1
                mov     [rsp+78h+var_58], edx
                jmp     short loc_140225C2B
;   } // starts at 140225969
; ---------------------------------------------------------------------------

loc_140225BF7:                          ; DATA XREF: .rdata:0000000140052E50↑o
;   __except(1) // owned by 140225969
                xor     edx, edx
                mov     [rsp+78h+var_58], edx
                mov     r12, 7FFFFFFFF8h
                mov     r15, 0FFFFF68000000000h
                mov     rdi, [rsp+78h+arg_0]
                mov     rsi, [rsp+78h+arg_18]
                mov     rbx, [rsp+78h+var_38]
                mov     r14, [rsp+78h+var_30]

loc_140225C2B:                          ; CODE XREF: sub_1402258A0+2C2↑j
                                        ; sub_1402258A0:loc_140225B91↑j ...
                dec     dword ptr [rbx+30C0h]
                test    edx, edx
                jz      short loc_140225C3D
                mov     eax, [rsp+78h+var_54]
                test    eax, eax
                jnz     short loc_140225C55

loc_140225C3D:                          ; CODE XREF: sub_1402258A0+393↑j
                                        ; sub_1402258A0+3DC↓j ...
                mov     eax, edx

loc_140225C3F:                          ; CODE XREF: sub_1402258A0+406↓j
                mov     rbx, [rsp+78h+arg_8]
                add     rsp, 50h
                pop     r15
                pop     r14
                pop     r12
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140225C55:                          ; CODE XREF: sub_1402258A0+39B↑j
                cmp     eax, 3
                jz      loc_140429C24

loc_140225C5E:                          ; CODE XREF: sub_1402258A0+204391↓j
                mov     rcx, r14
                call    sub_1402805F0
                and     al, 81h
                cmp     al, 81h
                jnz     loc_140429C36
                cmp     [rsp+78h+var_54], 3
                jz      short loc_140225CA8
                mov     edx, 2
                jmp     short loc_140225C3D
; ---------------------------------------------------------------------------

loc_140225C7E:                          ; CODE XREF: sub_1402258A0+3D↑j
                mov     rax, cs:qword_140C4F988
                cmp     r9, rax
                jb      loc_1402258E7
                mov     rcx, 100000000000h
                add     rax, rcx
                cmp     r9, rax
                jnb     loc_1402258E7

loc_140225CA4:                          ; CODE XREF: sub_1402258A0+69↑j
                                        ; sub_1402258A0+72↑j ...
                xor     eax, eax
                jmp     short loc_140225C3F
; ---------------------------------------------------------------------------

loc_140225CA8:                          ; CODE XREF: sub_1402258A0+3D5↑j
                mov     edx, 3
                jmp     short loc_140225C3D
; } // starts at 1402258A0
sub_1402258A0   endp

; ---------------------------------------------------------------------------
algn_140225CAF:                         ; DATA XREF: .rdata:0000000140052E64↑o
                                        ; .pdata:00000001400CAF14↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140225CC0   proc near               ; CODE XREF: sub_140209860+146↑p
                                        ; sub_140209860+457↑p ...

var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 0000000140429C48 SIZE 000000DE BYTES

                push    rbx
                push    rbp
                push    rsi
                push    rdi
                sub     rsp, 48h
                mov     rdi, rdx
                xor     esi, esi
                movzx   edx, byte ptr [rcx+0B8h]
                mov     ebp, r8d
                and     dl, 7
                mov     [rsp+68h+arg_8], esi
                mov     r9, rcx
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     rdi, rax
                jz      loc_140225E62
                mov     r8, 0FFFFF6FB7DBED000h
                mov     r10, 0FFFFF6FB7DBEDFFFh
                test    dl, dl
                jnz     loc_140225ED5
                mov     rax, r8
                cmp     rdi, rax
                jnb     loc_140225E2A

loc_140225D1D:                          ; CODE XREF: sub_140225CC0+170↓j
                                        ; sub_140225CC0+197↓j
                test    dl, dl
                jnz     loc_140225ED5

loc_140225D25:                          ; CODE XREF: sub_140225CC0+21B↓j
                                        ; sub_140225CC0+227↓j
                mov     rcx, [rdi]
                mov     ebx, esi
                mov     rax, r8
                cmp     rdi, rax
                jnb     loc_140225DCA

loc_140225D36:                          ; CODE XREF: sub_140225CC0+117↓j
                                        ; sub_140225CC0+127↓j ...
                mov     [rsp+68h+arg_0], r12
                mov     [rsp+68h+var_28], r13
                mov     [rsp+68h+var_30], r14
                mov     [rsp+68h+var_38], r15
                test    cl, 1
                jz      short loc_140225DAA
                mov     edx, ebp
                mov     r8, rcx
                and     edx, 1
                mov     r13, 2000000000000000h
                mov     r14, 1000000000000000h
                mov     r15, 0DFFFFFFFFFFFFFFFh
                mov     r12, 1000000000000020h

loc_140225D7F:                          ; CODE XREF: sub_140225CC0+2CD↓j
                mov     rax, rcx
                shr     rax, 3Ch
                test    al, 1
                jnz     loc_140225F49
                and     rcx, r15
                mov     rax, r8
                or      rcx, r12
                lock cmpxchg [rdi], rcx
                mov     rcx, rax
                jnz     loc_140225FE8
                mov     esi, 1

loc_140225DAA:                          ; CODE XREF: sub_140225CC0+8D↑j
                                        ; sub_140225CC0+28D↓j ...
                mov     r15, [rsp+68h+var_38]
                mov     eax, esi
                mov     r14, [rsp+68h+var_30]
                mov     r13, [rsp+68h+var_28]
                mov     r12, [rsp+68h+arg_0]
                add     rsp, 48h
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
algn_140225DC9:                         ; DATA XREF: .pdata:00000001400CAF2C↑o
                                        ; .pdata:00000001400CAF38↑o
                align 2

loc_140225DCA:                          ; CODE XREF: sub_140225CC0+70↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                cmp     rdi, rax
                ja      loc_140225D36
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_140225D36
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      loc_140225D36
                test    cl, 1
                jz      loc_140225D36
                test    cl, 20h
                jz      loc_140429CD1
                test    cl, 42h
                jnz     loc_140225D36
                jmp     loc_140429CD1
; ---------------------------------------------------------------------------

loc_140225E2A:                          ; CODE XREF: sub_140225CC0+57↑j
                mov     rax, r10
                cmp     rdi, rax
                ja      loc_140225D1D
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+690h]
                mov     rcx, [rax+260h]
                test    rcx, rcx
                jz      loc_140225D1D
                jmp     loc_140429C7D
; ---------------------------------------------------------------------------

loc_140225E62:                          ; CODE XREF: sub_140225CC0+2F↑j
                test    dl, dl
                jnz     loc_140225FC2
                mov     rax, gs:20h
                lea     rbx, [rcx+0B0h]
                lea     rdi, [rax+8D70h]

loc_140225E81:                          ; CODE XREF: sub_140225CC0+323↓j
                                        ; sub_140225CC0+348↓j ...
                mov     [rdi], rsi
                mov     [rdi+8], rbx
                and     ebp, 1
                jnz     loc_140225FAD
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140429C48

loc_140225EAA:                          ; CODE XREF: sub_140225CC0+203F8C↓j
                                        ; sub_140225CC0+203F9B↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140429C6C
                mov     rdx, rdi
                xchg    rdx, [rbx]
                test    rdx, rdx
                jnz     loc_140226047

loc_140225EC6:                          ; CODE XREF: sub_140225CC0+282↓j
                                        ; sub_140225CC0+203FB8↓j ...
                mov     eax, 1
                add     rsp, 48h
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140225ED5:                          ; CODE XREF: sub_140225CC0+4B↑j
                                        ; sub_140225CC0+5F↑j
                mov     rax, r8
                cmp     rdi, rax
                jb      loc_140225D25
                mov     rax, r10
                cmp     rdi, rax
                ja      loc_140225D25
                lea     r8, [rsp+68h+arg_8]
                mov     [rsp+68h+arg_18], esi
                mov     rdx, rdi
                mov     rcx, r9
                call    sub_140312D68
                mov     rbx, rax
                mov     r9d, [rax]
                mov     ecx, [rsp+68h+arg_8]

loc_140225F0E:                          ; CODE XREF: sub_140225CC0+3C1↓j
                                        ; sub_140225CC0+3CA↓j ...
                mov     r8d, ebp
                and     r8d, 1

loc_140225F15:                          ; CODE XREF: sub_140225CC0+20400C↓j
                mov     edx, r9d
                shr     edx, cl
                test    dl, 1
                jnz     loc_14022605E
                mov     edx, 1
                mov     eax, 2
                shl     eax, cl
                shl     edx, cl
                not     eax
                or      edx, r9d
                and     edx, eax
                mov     eax, r9d
                lock cmpxchg [rbx], edx
                mov     r9d, eax
                jz      short loc_140225EC6
                jmp     loc_140429CBF
; ---------------------------------------------------------------------------

loc_140225F49:                          ; CODE XREF: sub_140225CC0+C8↑j
                                        ; DATA XREF: .pdata:00000001400CAF38↑o ...
                test    bpl, 1
                jnz     loc_140225DAA
                test    al, 2
                jz      short loc_140225F98
                nop     word ptr [rax+rax+00000000h]

loc_140225F60:                          ; CODE XREF: sub_140225CC0+2C0↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jz      loc_140226020

loc_140225F6E:                          ; CODE XREF: sub_140225CC0+368↓j
                                        ; sub_140225CC0+375↓j
                pause

loc_140225F70:                          ; CODE XREF: sub_140225CC0+382↓j
                mov     rax, [rdi]
                mov     [rsp+68h+var_48], rax
                mov     rcx, [rsp+68h+var_48]
                test    r14, rcx
                jnz     short loc_140225F60

loc_140225F82:                          ; CODE XREF: sub_140225CC0+2E6↓j
                                        ; sub_140225CC0+2EB↓j
                mov     edx, ebp
                and     edx, 1

loc_140225F87:                          ; CODE XREF: sub_140225CC0+32A↓j
                mov     r8, rcx
                test    cl, 1
                jnz     loc_140225D7F
                jmp     loc_140225DAA
; ---------------------------------------------------------------------------

loc_140225F98:                          ; CODE XREF: sub_140225CC0+295↑j
                or      rcx, r13
                mov     rax, r8
                lock cmpxchg [rdi], rcx
                cmp     rax, r8
                jz      short loc_140225F82
                mov     rcx, rax
                jmp     short loc_140225F82
; ---------------------------------------------------------------------------

loc_140225FAD:                          ; CODE XREF: sub_140225CC0+1CB↑j
                                        ; DATA XREF: .pdata:00000001400CAF44↑o ...
                mov     rdx, rbx
                mov     rcx, rdi
                call    sub_1402E44F4
                add     rsp, 48h
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140225FC2:                          ; CODE XREF: sub_140225CC0+1A4↑j
                cmp     dl, 7
                jz      short loc_140225FF1
                mov     rdi, gs:20h
                cmp     dl, 5
                jz      short loc_14022600D
                lea     rbx, unk_140C4E388
                add     rdi, 8D88h
                jmp     loc_140225E81
; ---------------------------------------------------------------------------

loc_140225FE8:                          ; CODE XREF: sub_140225CC0+DF↑j
                                        ; DATA XREF: .pdata:00000001400CAF50↑o ...
                test    edx, edx
                jz      short loc_140225F87
                jmp     loc_140225DAA
; ---------------------------------------------------------------------------

loc_140225FF1:                          ; CODE XREF: sub_140225CC0+305↑j
                                        ; DATA XREF: .pdata:00000001400CAF5C↑o ...
                mov     rax, gs:20h
                lea     rbx, unk_140C4E378
                lea     rdi, [rax+8D58h]
                jmp     loc_140225E81
; ---------------------------------------------------------------------------

loc_14022600D:                          ; CODE XREF: sub_140225CC0+313↑j
                lea     rbx, unk_140C4E370
                add     rdi, 8D40h
                jmp     loc_140225E81
; ---------------------------------------------------------------------------

loc_140226020:                          ; CODE XREF: sub_140225CC0+2A8↑j
                                        ; DATA XREF: .pdata:00000001400CAF68↑o ...
                mov     eax, cs:dword_140CFC41C
                test    al, 40h
                jz      loc_140225F6E
                call    sub_140390EA0
                test    al, al
                jz      loc_140225F6E
                mov     ecx, ebx
                call    sub_1403900C0
                jmp     loc_140225F70
; ---------------------------------------------------------------------------

loc_140226047:                          ; CODE XREF: sub_140225CC0+200↑j
                                        ; DATA XREF: .pdata:00000001400CAF74↑o ...
                mov     rcx, rdi
                call    sub_14025FC20
                mov     eax, 1
                add     rsp, 48h
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14022605E:                          ; CODE XREF: sub_140225CC0+25D↑j
                test    bpl, 1
                jnz     short loc_1402260B2
                test    dl, 2
                jnz     short loc_140226090
                mov     edx, 2
                mov     eax, r9d
                shl     edx, cl
                or      edx, r9d
                lock cmpxchg [rbx], edx
                mov     ecx, [rsp+68h+arg_8]
                mov     r9d, eax
                jnz     loc_140225F0E
                mov     r9d, edx
                jmp     loc_140225F0E
; ---------------------------------------------------------------------------
                align 10h

loc_140226090:                          ; CODE XREF: sub_140225CC0+3A7↑j
                                        ; sub_140225CC0+3EB↓j
                lea     rcx, [rsp+68h+arg_18]
                call    sub_1402C8C70
                mov     r9d, [rbx]
                mov     eax, r9d
                mov     ecx, [rsp+68h+arg_8]
                shr     eax, cl
                test    al, 1
                jnz     short loc_140226090
                jmp     loc_140225F0E
; ---------------------------------------------------------------------------

loc_1402260B2:                          ; CODE XREF: sub_140225CC0+3A2↑j
                                        ; sub_140225CC0+203FE9↓j ...
                xor     eax, eax
                add     rsp, 48h
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140225CC0   endp

byte_1402260BE  db 12h dup(0CCh)        ; DATA XREF: .pdata:00000001400CAF80↑o

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=30h

sub_1402260D0   proc near               ; CODE XREF: sub_140224260+184↑p
                                        ; sub_14029AEC0+407↓p
                                        ; DATA XREF: ...

var_118         = qword ptr -118h
var_110         = byte ptr -110h
var_108         = dword ptr -108h
var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_D8          = xmmword ptr -0D8h
var_C8          = xmmword ptr -0C8h
var_B0          = xmmword ptr -0B0h
var_A0          = xmmword ptr -0A0h
var_90          = xmmword ptr -90h
var_80          = xmmword ptr -80h
var_70          = xmmword ptr -70h
var_60          = xmmword ptr -60h
var_50          = qword ptr -50h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_10          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140429D26 SIZE 00000149 BYTES

; __unwind { // __GSHandlerCheck
                mov     r11, rsp
                push    rbp
                push    rsi
                lea     rbp, [r11-38h]
                sub     rsp, 128h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+30h+var_40], rax
; } // starts at 1402260D0

loc_1402260EE:                          ; DATA XREF: .rdata:0000000140052F80↑o
                                        ; .rdata:0000000140052FA4↑o ...
; __unwind { // __GSHandlerCheck
                mov     [r11-18h], rdi
                xor     r8d, r8d
                mov     [rdx], r8
                mov     rax, 7FFFFFFFF8h
                movups  xmm3, xmmword ptr [rcx]
; } // starts at 1402260EE

loc_140226105:                          ; DATA XREF: .rdata:0000000140052FA4↑o
                                        ; .rdata:0000000140052FB4↑o ...
; __unwind { // __GSHandlerCheck
                mov     [r11-20h], r12
                mov     rdi, rcx
                movups  xmm0, xmmword ptr [rcx+20h]
                mov     [r11-28h], r13
                movups  xmm1, xmmword ptr [rcx+50h]
                mov     [r11-30h], r14
                movups  xmm2, xmmword ptr [rcx+30h]
                mov     [r11-38h], r15
                movups  xmm4, xmmword ptr [rcx+10h]
                mov     [rsp+50h], rdx
                movaps  [rbp+30h+var_B0], xmm0
                movq    r15, xmm3
                movups  xmm0, xmmword ptr [rcx+40h]
                mov     [rsp+130h+var_F0], r8
                movaps  [rbp+30h+var_80], xmm1
                movups  xmm1, xmmword ptr [rcx+70h]
                movaps  [rbp+30h+var_90], xmm0
                movups  xmm0, xmmword ptr [rcx+60h]
                movaps  [rbp+30h+var_60], xmm1
                movdqa  xmm1, xmm3
                movaps  [rsp+130h+var_D8+8], xmm3
                mov     qword ptr [rsp+130h+var_D8+8], r15
                psrldq  xmm1, 8
                movq    r13, xmm1
                movaps  [rbp+30h+var_70], xmm0
                movsd   xmm0, qword ptr [rcx+80h]
                movaps  [rbp+30h+var_A0], xmm2
                shr     r15, 9
                psrldq  xmm2, 8
                and     r15, rax
                mov     qword ptr [rsp+130h+var_C8], r13
                and     r13d, 2
                movsd   [rbp+30h+var_50], xmm0
                movaps  [rsp+130h+var_C8+8], xmm4
                movq    [rsp+130h+var_E8], xmm2
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     r15, rax
                movq    qword ptr [rsp+130h+var_C8+8], xmm4
                movq    rax, xmm4
                mov     esi, r8d
                and     eax, 1
                jnz     loc_14022665F

loc_1402261C7:                          ; CODE XREF: sub_1402260D0+5A0↓j
                test    rax, rax
                jnz     loc_14022667B

loc_1402261D0:                          ; CODE XREF: sub_1402260D0+5C5↓j
                                        ; sub_1402260D0+5E2↓j
                mov     [rsp+130h+var_F8], r8

loc_1402261D5:                          ; CODE XREF: sub_1402260D0+5A6↓j
                                        ; sub_1402260D0+5BC↓j ...
                xor     edx, edx
                lea     rcx, [rsp+130h+var_D8+8]
                mov     r12, r8
                call    sub_140226820
                mov     r14, rax
                cmp     rax, 1
                ja      loc_14022674A

loc_1402261F1:                          ; CODE XREF: sub_1402260D0+67E↓j
                and     byte ptr [rbp+30h+var_90+5], 0FDh
                mov     [rsp+130h+arg_10], rbx
                test    rax, rax
                jz      loc_14022637E
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rcx, 0FFFFF6FB7DBED7F8h

loc_14022621F:                          ; CODE XREF: sub_1402260D0+2A8↓j
                test    byte ptr [rbp+30h+var_90+5], 8
                jnz     loc_14022657A

loc_140226229:                          ; CODE XREF: sub_1402260D0+53F↓j
                mov     rbx, [r15]
                mov     rax, rax
                cmp     r15, rax
                jnb     loc_14022650D

loc_140226238:                          ; CODE XREF: sub_1402260D0+443↓j
                                        ; sub_1402260D0+453↓j ...
                test    rbx, rbx
                jz      loc_140226658
                test    bl, 1
                jnz     loc_140226658
                mov     dword ptr [rsp+130h+var_100], 100h
                bt      rbx, 0Ah
                jb      loc_140226413
                test    byte ptr [rbp+30h+var_90+5], 8
                jnz     loc_14022673B

loc_140226267:                          ; CODE XREF: sub_1402260D0+348↓j
                                        ; sub_1402260D0+377↓j ...
                test    byte ptr [rsp+130h+var_C8+8], 1
                jnz     loc_140226614

loc_140226272:                          ; CODE XREF: sub_1402260D0+54E↓j
                                        ; sub_1402260D0+563↓j
                bt      rbx, 0Ah
                jb      loc_140226493
                bt      rbx, 0Bh
                jb      loc_1402264B1
                movzx   eax, bl
                shr     al, 2
                test    al, 1
                jnz     loc_1402267DC
                xor     ecx, ecx
                mov     r10, r11
                and     r10d, 1
                jnz     loc_1402266C9

loc_1402262A5:                          ; CODE XREF: sub_1402260D0+603↓j
                                        ; sub_1402260D0+616↓j
                test    r10, r10
                jnz     loc_1402266EB

loc_1402262AE:                          ; CODE XREF: sub_1402260D0+62E↓j
                                        ; sub_1402260D0+647↓j ...
                test    r11, r11
                jz      short loc_1402262EA
                movzx   eax, word ptr [r11+170h]
                xor     dl, dl
                cmp     ax, 10h
                jz      loc_1402264DA
                cmp     ax, 33h ; '3'
                jnz     short loc_1402262EA
                mov     rcx, cs:qword_140CFCA08

loc_1402262D4:                          ; CODE XREF: sub_1402260D0+438↓j
                                        ; sub_1402260D0+203D33↓j
                cmp     [r11+168h], rcx
                jz      loc_1402267AD
                cmp     dl, 1
                jz      loc_1402267AD

loc_1402262EA:                          ; CODE XREF: sub_1402260D0+1E1↑j
                                        ; sub_1402260D0+1FB↑j ...
                mov     r9, r13
                lea     rcx, [rsp+130h+var_D8+8]
                xor     r8d, r8d
                mov     rdx, r15
                call    sub_140226D20
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                mov     ecx, eax

loc_140226304:                          ; CODE XREF: sub_1402260D0+3BE↓j
                                        ; sub_1402260D0+3DC↓j ...
                movzx   eax, byte ptr [rbp+30h+var_90+5]
                mov     ebx, ecx
                test    al, 8
                cmovnz  ebx, esi
                test    ecx, ecx
                js      loc_140226638
                add     qword ptr [rsp+130h+var_D8+8], 1000h
                or      al, 8
                add     r15, 8
                mov     byte ptr [rbp+30h+var_90+5], al
                inc     r12
                mov     [rsp+78h], r15
                test    al, 2
                jnz     loc_140226753

loc_140226339:                          ; CODE XREF: sub_1402260D0+6B8↓j
                mov     rcx, r11
                mov     qword ptr [rbp+30h+var_70], 0
                and     ecx, 1
                jnz     loc_140226550

loc_14022634D:                          ; CODE XREF: sub_1402260D0+490↓j
                xor     r13d, r13d
                and     qword ptr [rsp+130h+var_C8], 0FFFFFFFFFFFFFFFDh

loc_140226356:                          ; CODE XREF: sub_1402260D0+48A↓j
                test    rcx, rcx
                jnz     loc_140226565

loc_14022635F:                          ; CODE XREF: sub_1402260D0+49F↓j
                                        ; sub_1402260D0+203D7B↓j
                mov     rax, 0FFFFF6FB7DBED000h
                mov     esi, ebx
                mov     rcx, 0FFFFF6FB7DBED7F8h
                cmp     r12, r14
                jb      loc_14022621F

loc_14022637E:                          ; CODE XREF: sub_1402260D0+130↑j
                                        ; sub_1402260D0+4B7↓j ...
                mov     edx, dword ptr [rbp+30h+var_80]

loc_140226381:                          ; CODE XREF: sub_1402260D0+57D↓j
                                        ; sub_1402260D0+203D87↓j
                mov     rax, qword ptr [rbp+30h+var_60]
                movsd   xmm1, qword ptr [rbp+30h+var_90+8]
                mov     r15, [rsp+130h+var_30]
                mov     r14, [rsp+130h+var_28]
                mov     r13, [rsp+130h+var_20]
                mov     r12, [rsp+130h+var_18]
                mov     rbx, [rsp+130h+arg_10]
                mov     [rdi+70h], rax
                mov     rax, qword ptr [rbp+30h+var_60+8]
                mov     [rdi+78h], rax
                mov     rax, [rbp+30h+var_50]
                mov     [rdi+80h], rax
                mov     rax, qword ptr [rbp+30h+var_70+8]
                mov     [rdi+68h], rax
                movups  xmm0, [rbp+30h+var_A0+8]
                movups  xmmword ptr [rdi+38h], xmm0
                movsd   qword ptr [rdi+48h], xmm1
                test    dl, dl
                js      loc_140429E5C
; } // starts at 140226105

loc_1402263E6:                          ; CODE XREF: sub_1402260D0+203D9A↓j
                                        ; DATA XREF: .pdata:00000001400CAFA4↑o ...
; __unwind { // __GSHandlerCheck
                mov     rdi, [rsp+120h]
                cmp     esi, 0C0033333h
                jz      loc_1402266B7
; } // starts at 1402263E6

loc_1402263FA:                          ; CODE XREF: sub_1402260D0+5F4↓j
                                        ; DATA XREF: .pdata:00000001400CAFB0↑o ...
; __unwind { // __GSHandlerCheck
                mov     eax, esi
                mov     rcx, [rbp+30h+var_40]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 128h
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 1402263FA
; ---------------------------------------------------------------------------

loc_140226413:                          ; CODE XREF: sub_1402260D0+187↑j
                                        ; DATA XREF: .pdata:00000001400CAFBC↑o ...
; __unwind { // __GSHandlerCheck
                cmp     qword ptr [rbp+30h+var_70], 0
                jnz     loc_140226267
                lea     rdx, [rsp+130h+var_100]
                mov     rcx, r15
                call    sub_14031C520
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                test    rax, rax
                jz      loc_140429D94
                mov     ecx, dword ptr [rsp+130h+var_100]
                mov     qword ptr [rbp+30h+var_70], rax

loc_140226441:                          ; CODE XREF: sub_1402260D0+675↓j
                cmp     ecx, 100h
                jz      loc_140226267
                mov     eax, ecx
                and     eax, 0FFFFFFF8h
                cmp     eax, 10h
                jz      loc_140429D9E

loc_14022645B:                          ; CODE XREF: sub_1402260D0+203CD2↓j
                mov     r8d, dword ptr [rbp+30h+var_80]
                mov     r9d, ecx
                shr     r8d, 6
                mov     rdx, r13
                and     r8b, 1
                mov     byte ptr [rsp+130h+var_108], 0
                mov     rcx, r15
                mov     qword ptr [rsp+130h+var_110], r11
                call    sub_1403547F0
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                mov     ecx, eax
                test    eax, eax
                jz      loc_140226267
                jmp     loc_140226304
; ---------------------------------------------------------------------------

loc_140226493:                          ; CODE XREF: sub_1402260D0+1A7↑j
                lea     r8, [rsp+130h+var_F0]
                mov     rdx, r13
                lea     rcx, [rsp+130h+var_D8+8]
                call    sub_14022CA60
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                mov     ecx, eax
                jmp     loc_140226304
; ---------------------------------------------------------------------------

loc_1402264B1:                          ; CODE XREF: sub_1402260D0+1B2↑j
                lea     rax, [rsp+130h+var_F0]
                mov     r9, r13
                xor     r8d, r8d
                mov     qword ptr [rsp+130h+var_110], rax
                mov     rdx, r15
                lea     rcx, [rsp+130h+var_D8+8]
                call    sub_14022DE20
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                mov     ecx, eax
                jmp     loc_140226304
; ---------------------------------------------------------------------------

loc_1402264DA:                          ; CODE XREF: sub_1402260D0+1F1↑j
                test    dword ptr [r11+178h], 200h
                jz      loc_140429DB2

loc_1402264EB:                          ; CODE XREF: sub_1402260D0+203D0B↓j
                cmp     cs:dword_140CFC52C, 0
                lea     rcx, loc_140406D67
                mov     rax, [r11+168h]
                jnz     loc_140429DE0

loc_140226506:                          ; CODE XREF: sub_1402260D0+203D17↓j
                                        ; sub_1402260D0+203D24↓j
                xor     dl, dl
                jmp     loc_1402262D4
; ---------------------------------------------------------------------------

loc_14022650D:                          ; CODE XREF: sub_1402260D0+162↑j
                mov     rax, rcx
                cmp     r15, rax
                ja      loc_140226238
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_140226238
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jnz     loc_14022678D

loc_140226546:                          ; CODE XREF: sub_1402260D0+6C0↓j
                                        ; sub_1402260D0+6D2↓j ...
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                jmp     loc_140226238
; ---------------------------------------------------------------------------

loc_140226550:                          ; CODE XREF: sub_1402260D0+277↑j
                mov     rax, r11
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 2
                jz      loc_140226356
                jmp     loc_14022634D
; ---------------------------------------------------------------------------

loc_140226565:                          ; CODE XREF: sub_1402260D0+289↑j
                mov     rax, r11
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 5
                jnz     loc_14022635F
                jmp     loc_140429E43
; ---------------------------------------------------------------------------

loc_14022657A:                          ; CODE XREF: sub_1402260D0+153↑j
                mov     r8, [rsp+130h+var_E8]
                test    byte ptr [r8+0BBh], 8
                jnz     loc_14022637E
                test    byte ptr [r8+0B8h], 40h
                jnz     loc_140429D26

loc_14022659B:                          ; CODE XREF: sub_1402260D0+203C6A↓j
                mov     rcx, r8
                call    sub_14029A5E0
                test    eax, eax
                jnz     loc_14022637E
                test    byte ptr [rbp+30h+var_90+5], 1
                jnz     loc_14022637E
                mov     rax, 7FFFFFFFF8h
                mov     rdx, r15
                shr     rdx, 9
                and     rdx, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     rdx, rax
                mov     rcx, r8
                call    sub_14029F0B0
                test    eax, eax
                jnz     loc_14022637E
                call    KeShouldYieldProcessor
                test    eax, eax
                jnz     loc_14022637E
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rcx, 0FFFFF6FB7DBED7F8h
                jmp     loc_140226229
; ---------------------------------------------------------------------------

loc_140226614:                          ; CODE XREF: sub_1402260D0+19C↑j
                mov     rax, r11
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 2
                jnz     loc_140226272
                lea     rcx, [rsp+130h+var_D8+8]
                call    sub_14034F368
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                jmp     loc_140226272
; ---------------------------------------------------------------------------

loc_140226638:                          ; CODE XREF: sub_1402260D0+241↑j
                mov     esi, ebx
                cmp     ecx, 0C0000016h
                jnz     loc_14022637E
                mov     edx, dword ptr [rbp+30h+var_80]
                bt      edx, 8
                jnb     loc_140226381
                jmp     loc_140429E50
; ---------------------------------------------------------------------------

loc_140226658:                          ; CODE XREF: sub_1402260D0+16B↑j
                                        ; sub_1402260D0+174↑j
                xor     ecx, ecx
                jmp     loc_140226304
; } // starts at 140226413
; ---------------------------------------------------------------------------

loc_14022665F:                          ; CODE XREF: sub_1402260D0+F1↑j
                                        ; DATA XREF: .pdata:00000001400CAFC8↑o ...
; __unwind { // __GSHandlerCheck
                movq    rdx, xmm4
                and     rdx, 0FFFFFFFFFFFFFFFEh
                mov     [rsp+130h+var_F8], rdx
                cmp     byte ptr [rdx], 5
                jnz     loc_1402261C7
                jmp     loc_1402261D5
; ---------------------------------------------------------------------------

loc_14022667B:                          ; CODE XREF: sub_1402260D0+FA↑j
                movq    rdx, xmm4
                and     rdx, 0FFFFFFFFFFFFFFFEh
                mov     [rsp+130h+var_F8], rdx
                cmp     byte ptr [rdx], 2
                jz      loc_1402261D5
                test    rax, rax
                jz      loc_1402261D0
                movq    rax, xmm4
                and     rax, 0FFFFFFFFFFFFFFFEh
                mov     [rsp+130h+var_F8], rax
                cmp     byte ptr [rax], 1
                jz      loc_1402261D5
                jmp     loc_1402261D0
; } // starts at 14022665F
; ---------------------------------------------------------------------------

loc_1402266B7:                          ; CODE XREF: sub_1402260D0+324↑j
                                        ; DATA XREF: .pdata:00000001400CAFD4↑o ...
; __unwind { // __GSHandlerCheck
                mov     rax, [rsp+50h]
                mov     rcx, [rsp+130h+var_F0]
                mov     [rax], rcx
                jmp     loc_1402263FA
; } // starts at 1402266B7
; ---------------------------------------------------------------------------

loc_1402266C9:                          ; CODE XREF: sub_1402260D0+1CF↑j
                                        ; DATA XREF: .pdata:00000001400CAFE0↑o ...
; __unwind { // __GSHandlerCheck
                mov     rax, r11
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 1
                jnz     loc_1402262A5
                mov     eax, [rax+50h]
                bt      eax, 0Eh
                jnb     loc_140226304
                jmp     loc_1402262A5
; ---------------------------------------------------------------------------

loc_1402266EB:                          ; CODE XREF: sub_1402260D0+1D8↑j
                mov     rax, r11
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 1
                jz      loc_1402267AD
                test    r10, r10
                jz      loc_1402262AE
                mov     rax, r11
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 3
                jz      loc_1402267AD
                test    r10, r10
                jz      loc_1402262AE
                mov     rax, r11
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 6
                jz      loc_1402267AD
                test    r10, r10
                jnz     loc_1402262EA
                jmp     loc_1402262AE
; ---------------------------------------------------------------------------

loc_14022673B:                          ; CODE XREF: sub_1402260D0+191↑j
                mov     rcx, rbx
                shr     rcx, 5
                and     ecx, 1Fh
                jmp     loc_140226441
; } // starts at 1402266C9
; ---------------------------------------------------------------------------

loc_14022674A:                          ; CODE XREF: sub_1402260D0+11B↑j
                                        ; DATA XREF: .pdata:00000001400CAFEC↑o ...
; __unwind { // __GSHandlerCheck
                or      byte ptr [rbp+30h+var_90+5], 4
                jmp     loc_1402261F1
; } // starts at 14022674A
; ---------------------------------------------------------------------------

loc_140226753:                          ; CODE XREF: sub_1402260D0+263↑j
                                        ; DATA XREF: .pdata:00000001400CAFF8↑o ...
; __unwind { // __GSHandlerCheck
                and     al, 0FDh
                mov     esi, ebx
                mov     byte ptr [rbp+30h+var_90+5], al
                cmp     r12, r14
                jz      loc_14022637E
                sub     r14, r12
                lea     rcx, [rsp+130h+var_D8+8]
                mov     rdx, r14
                call    sub_140226820
                mov     r14, rax
                cmp     rax, 1
                jz      loc_140226807

loc_140226780:                          ; CODE XREF: sub_1402260D0+73B↓j
                                        ; sub_1402260D0+745↓j
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                xor     r12d, r12d
                jmp     loc_140226339
; ---------------------------------------------------------------------------

loc_14022678D:                          ; CODE XREF: sub_1402260D0+470↑j
                test    bl, 1
                jz      loc_140226546
                test    bl, 20h
                jz      loc_140429D3F
                test    bl, 42h
                jnz     loc_140226546
                jmp     loc_140429D3F
; ---------------------------------------------------------------------------

loc_1402267AD:                          ; CODE XREF: sub_1402260D0+20B↑j
                                        ; sub_1402260D0+214↑j ...
                test    r10, r10
                jz      short loc_1402267C2
                mov     rax, r11
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 6
                jz      loc_1402262EA

loc_1402267C2:                          ; CODE XREF: sub_1402260D0+6E0↑j
                mov     rax, 0FFFF800000000000h
                cmp     qword ptr [rsp+130h+var_D8+8], rax
                jb      loc_1402262EA
                jmp     loc_140429E08
; ---------------------------------------------------------------------------

loc_1402267DC:                          ; CODE XREF: sub_1402260D0+1C0↑j
                test    byte ptr [rbp+30h+var_90+5], 8
                jnz     loc_140429E22
                lea     r9, [rsp+130h+var_F0]
                xor     r8d, r8d
                mov     rdx, r15
                lea     rcx, [rsp+130h+var_D8+8]
                call    sub_14031A2D8
                mov     r11, qword ptr [rsp+130h+var_C8+8]
                mov     ecx, eax
                jmp     loc_140226304
; ---------------------------------------------------------------------------

loc_140226807:                          ; CODE XREF: sub_1402260D0+6AA↑j
                test    byte ptr [rbp+30h+var_90+5], 4
                jz      loc_140226780
                and     byte ptr [rbp+30h+var_90+5], 0FBh
                jmp     loc_140226780
; } // starts at 140226753
sub_1402260D0   endp

; ---------------------------------------------------------------------------
algn_14022681A:                         ; DATA XREF: .pdata:00000001400CB004↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140226820   proc near               ; CODE XREF: sub_1402260D0+10F↑p
                                        ; sub_1402260D0+69E↑p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8

; FUNCTION CHUNK AT 0000000140429E70 SIZE 0000006A BYTES

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 20h
                mov     r10, [rcx+10h]
                mov     rdi, rdx
                mov     rbx, [rcx]
                mov     r8, r10
                and     r8, 0FFFFFFFFFFFFFFFEh
                and     rbx, 0FFFFFFFFFFFFF000h
                mov     r11, rcx
                cmp     r10, r8
                jnz     short loc_1402268A3
                mov     rax, r10
                and     eax, 1
                jnz     loc_140429E7A

loc_140226856:                          ; CODE XREF: sub_140226820+203664↓j
                test    rax, rax
                jnz     short loc_14022686B
                test    r10, r10
                jz      short loc_14022686B
                cmp     word ptr [r10+170h], 10h
                jz      short loc_14022687C

loc_14022686B:                          ; CODE XREF: sub_140226820+39↑j
                                        ; sub_140226820+3E↑j ...
                mov     eax, 1
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14022687C:                          ; CODE XREF: sub_140226820+49↑j
                mov     ecx, 200h
                test    [r10+178h], ecx
                jz      loc_140429E89

loc_14022688E:                          ; CODE XREF: sub_140226820+203692↓j
                cmp     cs:dword_140CFC52C, 0
                mov     rax, [r10+168h]
                jz      short loc_14022686B
                jmp     loc_140429EB7
; ---------------------------------------------------------------------------

loc_1402268A3:                          ; CODE XREF: sub_140226820+28↑j
                call    sub_140349240
                cmp     rax, 1
                jz      short loc_14022686B
                test    rdi, rdi
                jnz     loc_14022693F

loc_1402268B7:                          ; CODE XREF: sub_140226820+128↓j
                mov     rdi, rax

loc_1402268BA:                          ; CODE XREF: sub_140226820+122↓j
                mov     rax, rbx
                shr     rax, 9
                mov     rcx, 0FFFFF68000000000h
                add     eax, ecx
                mov     ecx, 200h
                shr     rax, 3
                and     eax, 1FFh
                sub     rcx, rax
                mov     rax, 0FFFF800000000000h
                cmp     rdi, rcx
                mov     r10, rcx
                cmovbe  r10, rdi
                cmp     rbx, rax
                jnb     short loc_140226929
                mov     rax, [r11+58h]
                test    rax, rax
                jnz     short loc_140226911
                mov     rcx, rbx
                call    sub_14026A130
                test    rax, rax
                jz      loc_140429E70

loc_140226911:                          ; CODE XREF: sub_140226820+DE↑j
                movzx   ecx, byte ptr [rax+21h]
                mov     eax, [rax+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                shr     rbx, 0Ch
                sub     rcx, rbx
                inc     rcx

loc_140226929:                          ; CODE XREF: sub_140226820+D5↑j
                                        ; sub_140226820+203655↓j
                mov     rbx, [rsp+28h+arg_0]
                cmp     r10, rcx
                cmovbe  rcx, r10
                mov     rax, rcx
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022693F:                          ; CODE XREF: sub_140226820+91↑j
                cmp     rdi, rax
                jbe     loc_1402268BA
                jmp     loc_1402268B7
sub_140226820   endp

; ---------------------------------------------------------------------------
algn_14022694D:                         ; DATA XREF: .rdata:00000001400530F8↑o
                                        ; .pdata:00000001400CB010↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140226960   proc near               ; CODE XREF: sub_140209860+3C6↑p
                                        ; sub_140213C50+157↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 0000000140429EDA SIZE 000000FC BYTES

                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                movzx   eax, byte ptr [rcx+0B8h]
                mov     rdi, rcx
                and     al, 7
                movzx   esi, dl
                cmp     al, 6
                jnb     loc_140226A22
                mov     eax, [rcx+0B8h]
                mov     ecx, eax
                shr     ecx, 18h
                test    cl, 8
                jnz     loc_140226A31
                test    cl, 4
                jnz     loc_140226A31
                test    cl, 10h
                jnz     loc_140226A31

loc_1402269A7:                          ; CODE XREF: sub_140226960+E4↓j
                and     al, 7

loc_1402269A9:                          ; DATA XREF: .rdata:0000000140053118↑o
                                        ; .rdata:000000014005312C↑o ...
                mov     [rsp+28h+arg_0], rbx
                cmp     al, 2
                jz      short loc_140226A19
                lea     rbx, [rdi+0C0h]

loc_1402269B9:                          ; CODE XREF: sub_140226960+C0↓j
                mov     edx, 1
                mov     rcx, rdi
                call    sub_140226A50
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_140429F38
                lock and dword ptr [rbx], 0BFFFFFFFh
                lock dec dword ptr [rbx]

loc_1402269DD:                          ; CODE XREF: sub_140226960+2035E6↓j
                mov     rcx, gs:20h
                mov     rbx, [rsp+28h+arg_0]
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140429F4B

loc_1402269FB:                          ; CODE XREF: sub_140226960+2035EF↓j
                                        ; sub_140226960+2035FE↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140429F6F

loc_140226A09:                          ; CODE XREF: sub_140226960+CA↓j
                                        ; sub_140226960+20357C↓j ...
                mov     cr8, rsi
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140226A19:                          ; CODE XREF: sub_140226960+50↑j
                                        ; DATA XREF: .pdata:00000001400CB034↑o ...
                lea     rbx, unk_140C4F600
                jmp     short loc_1402269B9
; ---------------------------------------------------------------------------

loc_140226A22:                          ; CODE XREF: sub_140226960+1B↑j
                                        ; DATA XREF: .pdata:00000001400CB040↑o ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140226A09
                jmp     loc_140429EDA
; ---------------------------------------------------------------------------

loc_140226A31:                          ; CODE XREF: sub_140226960+2F↑j
                                        ; sub_140226960+38↑j ...
                movzx   edx, sil
                mov     rcx, rdi
                call    sub_1403580AC
                movzx   eax, byte ptr [rdi+0B8h]
                jmp     loc_1402269A7
sub_140226960   endp

; ---------------------------------------------------------------------------
algn_140226A49:                         ; DATA XREF: .pdata:00000001400CB04C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140226A50   proc near               ; CODE XREF: sub_14021F420+5F7↑p
                                        ; sub_140226960+61↑p ...

var_38          = qword ptr -38h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140429FD6 SIZE 000002B6 BYTES

                push    rbx
                push    rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 30h
                test    cs:dword_140CFC400, 0C00000h
                mov     esi, edx
                mov     rbx, rcx
                jz      short loc_140226A7F
                test    byte ptr [rcx+0B8h], 7
                jnz     short loc_140226A7F
                cmp     byte ptr [rcx-2F0h], 1
                jnz     short loc_140226A91

loc_140226A7F:                          ; CODE XREF: sub_140226A50+1B↑j
                                        ; sub_140226A50+24↑j ...
                mov     eax, 0FFFFFFFFh

loc_140226A84:                          ; CODE XREF: sub_140226A50+228↓j
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140226A91:                          ; CODE XREF: sub_140226A50+2D↑j
                mov     ecx, esi
                and     ecx, 4
                jnz     short loc_140226AA9
                rdtsc
                shl     rdx, 20h
                or      rax, rdx
                test    rax, 3FF0h
                jnz     short loc_140226A7F

loc_140226AA9:                          ; CODE XREF: sub_140226A50+46↑j
                mov     r14, [rbx+108h]
                test    ecx, ecx
                jnz     loc_140226CD4
                test    r14, r14

loc_140226ABB:                          ; CODE XREF: sub_140226A50+28F↓j
                jz      short loc_140226A7F
                cmp     qword ptr [rbx+10h], 0
                jz      short loc_140226A7F
                cmp     qword ptr [rbx+18h], 0
                jz      short loc_140226A7F
                mov     rdx, 0FFFFF6FB7DBEDF68h
                test    ecx, ecx
                jnz     loc_140226CE4
                mov     rcx, rbx
                call    sub_14029A5E0
                test    eax, eax
                jnz     short loc_140226A7F
                mov     r15d, esi
                and     r15d, 1
                jz      short loc_140226B09
                mov     rdx, rdx
                lea     r8d, [rax+1]
                mov     rcx, rbx
                call    sub_140225CC0
                test    eax, eax
                jz      loc_140226A7F

loc_140226B09:                          ; CODE XREF: sub_140226A50+A0↑j
                                        ; sub_140226A50+29B↓j ...
                mov     [rsp+58h+arg_0], rbp
                xor     ebp, ebp
                mov     [rsp+58h+arg_8], r12
                mov     [rsp+58h+arg_10], r13
                mov     r12, 0FFFFF6FB7DBED000h
                mov     r10, r12
                mov     r11d, 100h
                mov     r13, 0FFFFF6FB7DBED7F8h
                mov     rdx, 8000000000000000h
                mov     edi, 0FFFFFFFFh
                mov     r8, 0CFFFFFFFFFFFFFFFh

loc_140226B50:                          ; CODE XREF: sub_140226A50+17A↓j
                mov     r9, [r10]
                mov     rax, r12
                cmp     r10, rax
                jb      short loc_140226B92
                mov     rax, r13
                cmp     r10, rax
                ja      short loc_140226B92
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140226B92
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140226B92
                test    r9b, 1
                jnz     loc_140226C88

loc_140226B92:                          ; CODE XREF: sub_140226A50+109↑j
                                        ; sub_140226A50+111↑j ...
                mov     rcx, [r14]
                mov     rax, r12
                cmp     r14, rax
                jb      short loc_140226BA9
                mov     rax, r13
                cmp     r14, rax
                jbe     loc_14042A02D

loc_140226BA9:                          ; CODE XREF: sub_140226A50+14B↑j
                                        ; sub_140226A50+2035E7↓j ...
                test    r9b, 1
                jnz     loc_140226CA1
                test    rcx, rcx
                jnz     loc_14042A0E4

loc_140226BBC:                          ; CODE XREF: sub_140226A50+26B↓j
                add     r10, 8
                add     r14, 8
                inc     rbp
                add     r11d, edi
                jnz     short loc_140226B50

loc_140226BCC:                          ; CODE XREF: sub_140226A50+2036BE↓j
                cmp     cs:qword_140C4C070, 0
                jnz     short loc_140226C3A
                test    r10, 0FFFh
                jz      short loc_140226C3A
                nop

loc_140226BE0:                          ; CODE XREF: sub_140226A50+1DF↓j
                mov     r9, [r10]
                mov     rax, r12
                cmp     r10, rax
                jb      short loc_140226BF7
                mov     rax, r13
                cmp     r10, rax
                jbe     loc_14042A113

loc_140226BF7:                          ; CODE XREF: sub_140226A50+199↑j
                                        ; sub_140226A50+2036CD↓j ...
                mov     rcx, [r14]
                mov     rax, r12
                cmp     r14, rax
                jb      short loc_140226C0E
                mov     rax, r13
                cmp     r14, rax
                jbe     loc_14042A1AF

loc_140226C0E:                          ; CODE XREF: sub_140226A50+1B0↑j
                                        ; sub_140226A50+203769↓j ...
                test    r9b, 1
                jnz     short loc_140226C7D

loc_140226C14:                          ; CODE XREF: sub_140226A50+231↓j
                test    cl, 1
                jnz     loc_140226CC6

loc_140226C1D:                          ; CODE XREF: sub_140226A50+279↓j
                add     r10, 8
                add     r14, 8
                inc     rbp
                test    r10, 0FFFh
                jnz     short loc_140226BE0

loc_140226C31:                          ; CODE XREF: sub_140226A50+2037FC↓j
                                        ; sub_140226A50+20381E↓j
                test    r10, 0FFFh
                jnz     short loc_140226C3D

loc_140226C3A:                          ; CODE XREF: sub_140226A50+184↑j
                                        ; sub_140226A50+18D↑j
                mov     rbp, rdi

loc_140226C3D:                          ; CODE XREF: sub_140226A50+1E8↑j
                                        ; sub_140226A50+2036B8↓j
                test    r15d, r15d
                jz      short loc_140226C57
                mov     rax, 0FFFFF6FB7DBEDF68h
                mov     rdx, rax
                mov     rcx, rbx
                call    sub_140312B40

loc_140226C57:                          ; CODE XREF: sub_140226A50+1F0↑j
                cmp     rbp, rdi
                jnz     short loc_140226C66
                test    sil, 10h
                jnz     loc_140226D04

loc_140226C66:                          ; CODE XREF: sub_140226A50+20A↑j
                                        ; sub_140226A50+2BE↓j
                mov     r12, [rsp+58h+arg_8]
                mov     rax, rbp
                mov     rbp, [rsp+58h+arg_0]
                mov     r13, [rsp+58h+arg_10]
                jmp     loc_140226A84
; ---------------------------------------------------------------------------

loc_140226C7D:                          ; CODE XREF: sub_140226A50+1C2↑j
                                        ; DATA XREF: .pdata:00000001400CB064↑o ...
                test    r9b, 4
                jz      short loc_140226C14
                jmp     loc_14042A248
; ---------------------------------------------------------------------------

loc_140226C88:                          ; CODE XREF: sub_140226A50+13C↑j
                test    r9b, 20h
                jz      loc_140429FD6
                test    r9b, 42h
                jnz     loc_140226B92
                jmp     loc_140429FD6
; ---------------------------------------------------------------------------

loc_140226CA1:                          ; CODE XREF: sub_140226A50+15D↑j
                and     r9, r8
                or      r9, 20h
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140226CB4
                or      rcx, rdx

loc_140226CB4:                          ; CODE XREF: sub_140226A50+25F↑j
                or      rcx, 20h
                cmp     r9, rcx
                jz      loc_140226BBC
                jmp     loc_14042A0C6
; ---------------------------------------------------------------------------

loc_140226CC6:                          ; CODE XREF: sub_140226A50+1C7↑j
                test    cl, 4
                jz      loc_140226C1D
                jmp     loc_14042A26A
; ---------------------------------------------------------------------------

loc_140226CD4:                          ; CODE XREF: sub_140226A50+62↑j
                                        ; DATA XREF: .pdata:00000001400CB070↑o ...
                mov     eax, [rbx-21Ch]
                test    eax, 4000000h
                jmp     loc_140226ABB
; ---------------------------------------------------------------------------

loc_140226CE4:                          ; CODE XREF: sub_140226A50+87↑j
                mov     r15d, esi
                and     r15d, 1
                jz      loc_140226B09
                mov     rdx, rdx
                xor     r8d, r8d
                mov     rcx, rbx
                call    sub_140225CC0
                jmp     loc_140226B09
; ---------------------------------------------------------------------------

loc_140226D04:                          ; CODE XREF: sub_140226A50+210↑j
                                        ; DATA XREF: .pdata:00000001400CB07C↑o ...
                mov     ecx, esi
                call    sub_14033BCE0
                mov     rbp, rax
                jmp     loc_140226C66
sub_140226A50   endp

; ---------------------------------------------------------------------------
algn_140226D13:                         ; DATA XREF: .pdata:00000001400CB088↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_140226D20   proc near               ; CODE XREF: sub_1402260D0+228↑p
                                        ; sub_14022CA60+11D1↓p ...

var_C0          = qword ptr -0C0h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = dword ptr -90h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = dword ptr -60h
var_5C          = dword ptr -5Ch
var_58          = qword ptr -58h
var_50          = dword ptr -50h
var_4C          = dword ptr -4Ch
var_48          = qword ptr -48h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = dword ptr  10h
arg_8           = qword ptr  18h
arg_10          = qword ptr  20h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 000000014042A28C SIZE 00000255 BYTES

                mov     [rsp-8+arg_18], r9
                mov     [rsp-8+arg_10], r8
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r15
                lea     rbp, [rsp-2Fh]
                sub     rsp, 0B8h
                mov     rax, [rcx+38h]
                xor     edi, edi
                mov     [rbp+57h+var_80], rdi
                mov     r12, rdx
                mov     rsi, rcx
                mov     [rbp+57h+var_58], rdi
                mov     [rbp+57h+var_4C], edi
                mov     r10d, edi
                movzx   r15d, byte ptr [rax+0B8h]
                mov     dword ptr [rbp+57h+var_80], edi
                mov     [rbp+57h+var_38], rdi
                and     r15b, 7
                jnz     short loc_140226D77
                mov     r10d, 40h ; '@'
                mov     dword ptr [rbp+57h+var_80], r10d

loc_140226D77:                          ; CODE XREF: sub_140226D20+4B↑j
                mov     r11, [rcx+10h]
                mov     rcx, r11
                and     r11, 0FFFFFFFFFFFFFFFEh
                and     ecx, 1
                test    rcx, rcx
                jnz     loc_140227119

loc_140226D8E:                          ; CODE XREF: sub_140226D20+406↓j
                                        ; sub_140226D20+419↓j ...
                test    r10b, 0Bh
                jnz     loc_14022715C
                mov     rbx, rdi

loc_140226D9B:                          ; CODE XREF: sub_140226D20+460↓j
                                        ; sub_140226D20+2035A5↓j ...
                mov     [rbp+57h+var_48], rbx
                test    r10b, 2
                jnz     loc_14042A2D8

loc_140226DA9:                          ; CODE XREF: sub_140226D20+2035BC↓j
                test    r10b, 8
                jnz     loc_14042A2F8

loc_140226DB3:                          ; CODE XREF: sub_140226D20+2035DD↓j
                mov     rax, gs:188h
                lea     rdx, cs:140000000h
                mov     r10, [rsi+8]
                mov     r9, [rsi]

loc_140226DCA:                          ; DATA XREF: .rdata:0000000140053244↑o
                                        ; .rdata:0000000140053258↑o ...
                mov     [rsp+0E0h+arg_8], r13
                mov     r13, [rax+0B8h]
                shr     r10, 39h
                mov     [rsp+0E0h+var_30], r14
                mov     r14, rdi
                mov     [rbp+57h+var_A0], r13
                mov     [rbp+57h+var_B0], r9
                mov     [rbp+57h+var_A8], rdi
                mov     rax, 0FFFFF68000000000h
                test    r10d, r10d
                jnz     short loc_140226E6F
                test    rcx, rcx
                jnz     loc_1402271A2
                mov     r11, rdi

loc_140226E0F:                          ; CODE XREF: sub_140226D20+4A9↓j
                test    r15b, r15b
                jnz     short loc_140226E6F
                mov     r15, gs:188h
                mov     r13, [r15+0B8h]
                mov     rcx, [r13+690h]
                mov     rax, rax
                cmp     r9, rax
                jnb     loc_1402270D2

loc_140226E37:                          ; CODE XREF: sub_140226D20+3BF↓j
                test    r11, r11
                jnz     loc_1402271DB
                cmp     [rcx+1A8h], rdi
                jnz     loc_1402271DB
                cmp     [rcx+1B0h], rdi
                jnz     loc_1402271DB
                cmp     byte ptr [rcx+160h], 1
                jz      loc_1402271DB
                mov     r14, [rbp+57h+var_A8]

loc_140226E6B:                          ; CODE XREF: sub_140226D20+3CC↓j
                                        ; sub_140226D20+3DA↓j ...
                mov     r13, [rbp+57h+var_A0]

loc_140226E6F:                          ; CODE XREF: sub_140226D20+E1↑j
                                        ; sub_140226D20+F2↑j ...
                mov     [rbp+57h+var_50], r10d
                mov     [rbp+57h+var_70], r9
                mov     [rbp+57h+var_78], rsi
                test    r14, r14
                jnz     short loc_140226ECF
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                mov     rcx, 3FFFFFFF78h
                add     rax, rcx
                cmp     r12, rax
                ja      short loc_140226ECF
                mov     rax, rdx
                cmp     r12, rax
                jb      short loc_140226ECF
                movzx   ecx, word ptr [r13+72Eh]
                mov     rax, cs:qword_140C4E4C8
                mov     rdx, [rax+rcx*8]
                cmp     [rdx+488h], edi
                jz      short loc_140226ECF
                cmp     [rdx+500h], r13
                jz      loc_14042A34E

loc_140226ECF:                          ; CODE XREF: sub_140226D20+15E↑j
                                        ; sub_140226D20+17D↑j ...
                mov     rcx, [r12]
                mov     [rbp+57h+var_40], r14
                mov     rax, 0FFFFF6FB7DBED000h
                cmp     r12, rax
                jnb     loc_140227089

loc_140226EEA:                          ; CODE XREF: sub_140226D20+376↓j
                                        ; sub_140226D20+386↓j ...
                mov     r8, [rbp+57h+arg_10]
                test    r8, r8
                jnz     short loc_140226F49
                mov     rdx, [rsi+10h]
                mov     rax, rcx
                shr     rax, 5
                and     eax, 1Fh
                test    dl, 1
                jnz     loc_14022718B

loc_140226F0A:                          ; CODE XREF: sub_140226D20+472↓j
                bt      rcx, 0Ah
                jb      loc_140227198

loc_140226F15:                          ; CODE XREF: sub_140226D20+47D↓j
                lea     rcx, [rbp+57h+var_80]
                mov     [rbp+57h+var_60], eax
                mov     [rbp+57h+var_5C], eax
                mov     [rbp+57h+var_68], rdi
                call    sub_1402272F0

loc_140226F28:                          ; CODE XREF: sub_140226D20+364↓j
                                        ; sub_140226D20+203712↓j
                mov     r13, [rsp+0E0h+arg_8]
                mov     r14, [rsp+0E0h+var_30]

loc_140226F38:                          ; CODE XREF: sub_140226D20+2035D3↓j
                                        ; sub_140226D20+2035F7↓j
                                        ; DATA XREF: ...
                add     rsp, 0B8h
                pop     r15
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140226F49:                          ; CODE XREF: sub_140226D20+1D1↑j
                                        ; DATA XREF: .pdata:00000001400CB0AC↑o ...
                mov     r13d, dword ptr [rbp+57h+var_80]
                xor     r15b, r15b
                mov     [rbp+57h+var_68], r12
                mov     ecx, 18h
                mov     [rbp+57h+var_98], 1
                mov     rdx, rdi
                mov     [rbp+57h+arg_0], ecx
                test    r13b, 15h
                jz      short loc_140226F77
                test    r13b, 40h
                jnz     loc_140227251

loc_140226F77:                          ; CODE XREF: sub_140226D20+24B↑j
                test    r14, r14
                jnz     loc_14042A3BB

loc_140226F80:                          ; CODE XREF: sub_140226D20+2036A3↓j
                                        ; sub_140226D20+2036C3↓j ...
                mov     [rbp+57h+var_60], ecx
                mov     [rbp+57h+var_5C], ecx
                cmp     r15b, 1
                jz      loc_140227275

loc_140226F90:                          ; CODE XREF: sub_140226D20+562↓j
                                        ; sub_140226D20+56B↓j ...
                lea     rdx, [rbp+57h+var_98]
                lea     rcx, [rbp+57h+var_80]
                call    sub_1402C3EA0
                mov     r14, [rbp+57h+arg_10]
                mov     r13d, eax
                mov     [rbp+57h+var_90], edi
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      loc_1402272C0

loc_140226FB4:                          ; CODE XREF: sub_140226D20+5B9↓j
                movzx   eax, byte ptr [r14+22h]
                mov     rcx, r14
                and     al, 0DFh
                mov     [r14+22h], al
                call    sub_14027B630
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], rax
                test    r13d, r13d
                js      loc_140227081
                mov     ecx, dword ptr [rbp+57h+var_80]
                test    cl, 4
                jnz     loc_140227081
                mov     rax, [rbp+57h+var_B0]
                mov     r15, [rbp+57h+var_70]
                sub     rax, r15
                mov     [rbp+57h+var_A0], rdi
                shr     rax, 0Ch
                mov     eax, eax
                neg     rax
                lea     r14, [r12+rax*8]
                mov     r12, [rsi]
                mov     [rbp+57h+var_B0], r12
                test    cl, 8
                jnz     loc_14042A437

loc_140227017:                          ; CODE XREF: sub_140226D20+20371B↓j
                cmp     [rbp+57h+var_98], rdi
                jbe     short loc_14022707E
                mov     r12, [rbp+57h+var_A0]

loc_140227021:                          ; CODE XREF: sub_140226D20+358↓j
                mov     rbx, [r14]
                mov     rcx, r14
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_14042A440

loc_140227034:                          ; CODE XREF: sub_140226D20+20372A↓j
                                        ; sub_140226D20+203747↓j ...
                mov     r8, [rbp+57h+arg_18]
                mov     r9d, 1
                mov     rdx, rbx
                mov     [rsi], r15
                mov     rcx, rsi
                mov     [rsp+0E0h+var_C0], r12
                call    sub_14022B420
                add     r15, 1000h
                test    rdi, rdi
                jnz     short loc_140227065
                test    eax, eax
                js      loc_14042A4D9

loc_140227065:                          ; CODE XREF: sub_140226D20+33B↑j
                                        ; sub_140226D20+2037BC↓j
                inc     dword ptr gs:2E9Ch
                inc     rdi
                add     r14, 8
                cmp     rdi, [rbp+57h+var_98]
                jb      short loc_140227021
                mov     r12, [rbp+57h+var_B0]

loc_14022707E:                          ; CODE XREF: sub_140226D20+2FB↑j
                mov     [rsi], r12

loc_140227081:                          ; CODE XREF: sub_140226D20+2B9↑j
                                        ; sub_140226D20+2C5↑j
                mov     eax, r13d
                jmp     loc_140226F28
; ---------------------------------------------------------------------------

loc_140227089:                          ; CODE XREF: sub_140226D20+1C4↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                cmp     r12, rax
                ja      loc_140226EEA
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_140226EEA
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jnz     loc_140227231

loc_1402270C9:                          ; CODE XREF: sub_140226D20+514↓j
                                        ; sub_140226D20+526↓j ...
                mov     r14, [rbp+57h+var_A8]
                jmp     loc_140226EEA
; ---------------------------------------------------------------------------

loc_1402270D2:                          ; CODE XREF: sub_140226D20+111↑j
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     r9, rax
                ja      loc_140226E37
                mov     r14, [rbp+57h+var_A8]

loc_1402270E9:                          ; CODE XREF: sub_140226D20+4ED↓j
                test    r11, r11
                jz      loc_140226E6B
                cmp     byte ptr [r15+24Ah], 1
                jnz     loc_140226E6B
                movzx   eax, word ptr [r15+248h]
                movzx   r10d, word ptr [r13+rax*2+304h]
                inc     r10d
                jmp     loc_140226E6B
; ---------------------------------------------------------------------------

loc_140227119:                          ; CODE XREF: sub_140226D20+68↑j
                                        ; DATA XREF: .pdata:00000001400CB0B8↑o ...
                cmp     byte ptr [r11], 2
                jz      loc_1402271CE
                test    rcx, rcx
                jz      loc_140226D8E
                cmp     byte ptr [r11], 1
                jz      loc_14042A28C
                test    rcx, rcx
                jz      loc_140226D8E
                cmp     byte ptr [r11], 5
                jz      loc_14042A295

loc_140227149:                          ; CODE XREF: sub_140226D20+4B6↓j
                test    rcx, rcx
                jz      loc_140226D8E
                cmp     byte ptr [r11], 4
                jnz     loc_140226D8E

loc_14022715C:                          ; CODE XREF: sub_140226D20+72↑j
                mov     rbx, r11
                test    rcx, rcx
                jz      short loc_140227172
                cmp     byte ptr [r11], 4
                jnz     short loc_140227172
                mov     rax, [r11+28h]
                mov     [rbp+57h+var_38], rax

loc_140227172:                          ; CODE XREF: sub_140226D20+442↑j
                                        ; sub_140226D20+448↑j
                test    r10b, 2
                jnz     loc_14042A29E

loc_14022717C:                          ; CODE XREF: sub_140226D20+203586↓j
                                        ; sub_140226D20+203594↓j
                test    r10b, 8
                jz      loc_140226D9B
                jmp     loc_14042A2B9
; ---------------------------------------------------------------------------

loc_14022718B:                          ; CODE XREF: sub_140226D20+1E4↑j
                                        ; DATA XREF: .pdata:00000001400CB0C4↑o ...
                and     rdx, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rdx], 4
                jnz     loc_140226F0A

loc_140227198:                          ; CODE XREF: sub_140226D20+1EF↑j
                mov     eax, 4
                jmp     loc_140226F15
; ---------------------------------------------------------------------------

loc_1402271A2:                          ; CODE XREF: sub_140226D20+E6↑j
                movzx   eax, byte ptr [r11]
                cmp     al, 4
                jz      loc_14042A31C
                cmp     al, 2
                jnz     short loc_1402271BF
                mov     r10d, [r11+28h]

loc_1402271B6:                          ; CODE XREF: sub_140226D20+203620↓j
                test    r10d, r10d
                jnz     loc_140226E6F

loc_1402271BF:                          ; CODE XREF: sub_140226D20+490↑j
                mov     rax, 0FFFFF68000000000h
                jmp     loc_140226E0F
; ---------------------------------------------------------------------------

loc_1402271CE:                          ; CODE XREF: sub_140226D20+3FD↑j
                                        ; DATA XREF: .pdata:00000001400CB0D0↑o ...
                or      r10d, 1

loc_1402271D2:                          ; CODE XREF: sub_140226D20+203570↓j
                                        ; sub_140226D20+203579↓j
                mov     dword ptr [rbp+57h+var_80], r10d
                jmp     loc_140227149
; ---------------------------------------------------------------------------

loc_1402271DB:                          ; CODE XREF: sub_140226D20+11A↑j
                                        ; sub_140226D20+127↑j ...
                mov     rcx, r9
                call    sub_14026A130
                mov     [rbp+57h+var_A8], rax
                mov     r14, rax
                test    rax, rax
                jz      short loc_140227209
                mov     ecx, [rax+30h]
                mov     r10d, ecx
                shr     r10d, 0Ch
                and     r10d, 3Fh
                jnz     loc_14042A345
                bt      ecx, 14h
                jnb     short loc_140227212

loc_140227209:                          ; CODE XREF: sub_140226D20+4CD↑j
                                        ; sub_140226D20+4FC↓j ...
                mov     r9, [rbp+57h+var_B0]
                jmp     loc_1402270E9
; ---------------------------------------------------------------------------

loc_140227212:                          ; CODE XREF: sub_140226D20+4E7↑j
                mov     rax, [rax+48h]
                mov     rcx, [rax]
                test    rcx, rcx
                jz      short loc_140227209
                mov     r10d, [rcx+38h]
                shr     r10d, 14h
                and     r10d, 3Fh
                jz      short loc_140227209
                jmp     loc_14042A345
; ---------------------------------------------------------------------------

loc_140227231:                          ; CODE XREF: sub_140226D20+3A3↑j
                test    cl, 1
                jz      loc_1402270C9
                test    cl, 20h
                jz      loc_14042A366
                test    cl, 42h
                jnz     loc_1402270C9
                jmp     loc_14042A366
; ---------------------------------------------------------------------------

loc_140227251:                          ; CODE XREF: sub_140226D20+251↑j
                lea     r8, [rbp+57h+var_A8]
                mov     rcx, r9
                lea     rdx, [rbp+57h+arg_0]
                call    sub_14031C8B0
                mov     ecx, [rbp+57h+arg_0]
                mov     rdx, rax
                mov     r14, [rbp+57h+var_A8]
                mov     r8, [rbp+57h+arg_10]
                mov     [rbp+57h+var_60], ecx
                mov     [rbp+57h+var_5C], ecx

loc_140227275:                          ; CODE XREF: sub_140226D20+26A↑j
                test    r13b, 4
                jnz     loc_14042A40A

loc_14022727F:                          ; CODE XREF: sub_140226D20+2036F2↓j
                                        ; sub_140226D20+203700↓j
                test    rdx, rdx
                jz      loc_140226F90
                test    r14, r14
                jz      loc_140226F90
                cmp     ecx, 18h
                jz      loc_140226F90
                and     ecx, 0FFFFFFF8h
                cmp     ecx, 10h
                jz      loc_140226F90
                lea     rcx, [rbp+57h+var_80]
                call    sub_1402DF3CC
                mov     [rbp+57h+var_98], rax
                jmp     loc_140226F90
; ---------------------------------------------------------------------------
                align 20h

loc_1402272C0:                          ; CODE XREF: sub_140226D20+28E↑j
                                        ; sub_140226D20+5B0↓j ...
                lea     rcx, [rbp+57h+var_90]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_1402272C0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jnb     loc_140226FB4
                jmp     short loc_1402272C0
sub_140226D20   endp

; ---------------------------------------------------------------------------
algn_1402272E1:                         ; DATA XREF: .pdata:00000001400CB0E8↑o
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=20h

sub_1402272F0   proc near               ; CODE XREF: sub_140226D20+203↑p
                                        ; sub_1402498E0+37B↓p
                                        ; DATA XREF: ...

var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_C0          = xmmword ptr -0C0h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = xmmword ptr -0A0h
var_90          = xmmword ptr -90h
var_80          = xmmword ptr -80h
var_70          = xmmword ptr -70h
var_60          = xmmword ptr -60h
var_50          = xmmword ptr -50h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
arg_0           = qword ptr  10h
arg_8           = byte ptr  18h
arg_10          = dword ptr  20h
arg_18          = qword ptr  28h

                mov     [rsp-8+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r15
                lea     rbp, [rsp-8]
                sub     rsp, 108h
                mov     edi, [rcx]
                mov     r15, rcx
                mov     rsi, [rcx+10h]
                mov     r9, [rcx+38h]
                test    dil, 2
                jz      short loc_140227366
                mov     edx, [rcx+20h]
                mov     eax, edx
                shr     eax, 3
                cmp     eax, 3
                jnz     short loc_140227343
                test    dl, 7
                jnz     short loc_140227348
                mov     rcx, r9
                call    sub_14031D4E8
                xor     eax, eax
                add     rsp, 108h
                pop     r15
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140227343:                          ; CODE XREF: sub_1402272F0+34↑j
                cmp     eax, 1
                jnz     short loc_14022734E

loc_140227348:                          ; CODE XREF: sub_1402272F0+39↑j
                test    dil, 4
                jnz     short loc_140227366

loc_14022734E:                          ; CODE XREF: sub_1402272F0+56↑j
                mov     rcx, r9
                call    sub_14031D4E8
                xor     eax, eax
                add     rsp, 108h
                pop     r15
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140227366:                          ; CODE XREF: sub_1402272F0+27↑j
                                        ; sub_1402272F0+5C↑j
                                        ; DATA XREF: ...
                mov     [rsp+120h+var_20], rbx
                mov     [rsp+120h+var_28], r12
                test    dil, 8
                jz      short loc_140227388
                mov     eax, [r9+38h]
                test    al, 8
                jnz     loc_1402279E0

loc_140227388:                          ; CODE XREF: sub_1402272F0+8A↑j
                mov     rdx, [rcx+8]
                mov     r8d, edi
                mov     rax, cs:qword_140C4E4C8
                mov     r11, [rdx+38h]
                mov     [rsp+120h+var_E0], r11
                movzx   ecx, word ptr [r11+0AEh]
                mov     rax, [rax+rcx*8]
                mov     [rsp+120h+var_C8], rax
                and     r8d, 40h
                jz      short loc_1402273EB
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r10, [rcx+4E0h]
                test    r10, r10
                jz      short loc_1402273EB
                mov     rax, gs:188h
                cmp     r10, rax
                jz      short loc_1402273EB
                or      dword ptr [rdx+50h], 4
                xor     eax, eax
                jmp     loc_1402279F7
; ---------------------------------------------------------------------------

loc_1402273EB:                          ; CODE XREF: sub_1402272F0+C4↑j
                                        ; sub_1402272F0+E0↑j ...
                mov     rax, 7FFFFFFFF8h

loc_1402273F5:                          ; DATA XREF: .rdata:0000000140053330↑o
                                        ; .rdata:0000000140053344↑o ...
                mov     [rsp+120h+var_30], r13
                mov     [rsp+120h+var_38], r14
                mov     r12d, 1
                mov     r14, rsi
                mov     [rsp+120h+var_D8], r12
                shr     r14, 9
                and     r14, rax
                mov     [rsp+120h+var_D0], 0FFFFFFFFFFFFFFFFh
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                mov     r13, [r15+40h]
                xor     edx, edx
                mov     ebx, [r15+30h]
                add     r14, rax
                mov     [rbp+20h+arg_10], edx
                mov     r10d, edx
                mov     [rbp+20h+arg_18], rdx
                test    r13, r13
                jnz     short loc_140227492
                test    r8d, r8d
                jnz     loc_140227940
                test    r12b, dil
                jz      loc_140227940
                movzx   eax, byte ptr [r11+0B8h]
                and     al, 7
                cmp     al, 2
                jb      loc_140227940
                xor     r8d, r8d
                mov     rdx, r11
                mov     rcx, r9
                call    sub_140342A84
                mov     r11, rax
                cmp     rax, r12
                jbe     loc_140227935
                mov     esi, r12d
                jmp     loc_140227780
; ---------------------------------------------------------------------------

loc_140227492:                          ; CODE XREF: sub_1402272F0+15A↑j
                and     edi, 15h
                jz      short loc_1402274B7
                mov     r8, r13
                mov     rdx, r11
                mov     rcx, r9
                call    sub_140342A84
                mov     r10, [rbp+20h+arg_18]
                mov     r11, [rsp+120h+var_E0]
                mov     [rsp+120h+var_D0], rax
                mov     [rbp+20h+arg_10], r12d

loc_1402274B7:                          ; CODE XREF: sub_1402272F0+1A5↑j
                mov     edx, [r13+30h]
                mov     ebx, edx
                shr     ebx, 0Ch
                mov     r8d, edx
                and     ebx, 3Fh
                and     r8d, 100000h
                jz      loc_14022758E
                mov     eax, edx
                lea     rcx, qword_14002DE90
                shr     rax, 12h
                and     eax, 3
                cmp     qword ptr [rcx+rax*8], 10h
                jnz     loc_14022758E
                mov     r9d, [r15+20h]
                lea     rax, [rbp+20h+arg_8]
                mov     [rsp+120h+var_F8], rax
                mov     r8d, 10h
                mov     eax, [r15+24h]
                mov     rdx, rsi
                mov     rcx, r13
                mov     dword ptr [rsp+120h+var_100], eax
                mov     [rbp+20h+arg_8], 0
                call    sub_140555B70
                mov     [rbp+20h+arg_18], rax
                mov     r10, rax
                test    rax, rax
                jz      loc_140227767
                mov     rcx, [rax+18h]
                mov     rax, 0FFFFFFFFFh
                and     rcx, rax
                cmp     rcx, rax
                jnz     short loc_140227551
                cmp     [rbp+20h+arg_8], r12b
                jnz     loc_140227767
                or      dword ptr [r15], 4
                jmp     loc_140227767
; ---------------------------------------------------------------------------

loc_140227551:                          ; CODE XREF: sub_1402272F0+24C↑j
                and     rsi, 0FFFFFFFFFFFF0000h
                mov     [rsp+120h+var_D8], 10h
                mov     rax, 7FFFFFFFF8h
                mov     [r15+10h], rsi
                mov     r14, rsi
                shr     r14, 9
                and     r14, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     r14, rax
                jmp     loc_140227767
; ---------------------------------------------------------------------------

loc_14022758E:                          ; CODE XREF: sub_1402272F0+1DD↑j
                                        ; sub_1402272F0+1F8↑j
                test    edi, edi
                jnz     loc_140227767
                test    r14b, 7Fh
                jnz     loc_140227767
                test    r8d, r8d
                jz      loc_140227767
                and     edx, 300000h
                cmp     edx, 300000h
                jz      loc_140227767
                cmp     [r15+24h], edi
                jnz     loc_140227767
                movzx   ecx, byte ptr [r13+20h]
                mov     eax, [r13+18h]
                shl     rcx, 20h
                or      rcx, rax
                add     rcx, 10h
                shl     rcx, 0Ch
                cmp     rsi, rcx
                jb      loc_140227767
                test    r14, 0FFFh
                jz      loc_140227767
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rsi, rax
                jb      short loc_140227618
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     rsi, rax
                jbe     loc_140227767

loc_140227618:                          ; CODE XREF: sub_1402272F0+313↑j
                xor     r10d, r10d
                mov     rdi, 0FFFFF6FB7DBED000h
                lea     r9, [r14-8]
                mov     r15, 0FFFFF6FB7DBED7F8h
                nop     dword ptr [rax+00h]
                nop     word ptr [rax+rax+00000000h]

loc_140227640:                          ; CODE XREF: sub_1402272F0+3F8↓j
                mov     rcx, [r9]
                mov     rax, rdi
                cmp     r9, rax
                jb      loc_1402276D3
                mov     rax, r15
                cmp     r9, rax
                ja      short loc_1402276D3
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_1402276D3
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     [rdx+390h], r12b
                jz      short loc_1402276D3
                test    r12b, cl
                jz      short loc_1402276EE
                test    cl, 20h
                jz      short loc_14022768B
                test    cl, 42h
                jnz     short loc_1402276D3

loc_14022768B:                          ; CODE XREF: sub_1402272F0+394↑j
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     r8, [rdx+788h]
                test    r8, r8
                jz      short loc_1402276D3
                mov     rax, r9
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rcx
                or      r8, 20h
                movzx   edx, al
                and     dl, 20h
                cmovz   r8, rcx
                mov     rcx, r8
                test    al, 42h
                jz      short loc_1402276D3
                or      rcx, 42h

loc_1402276D3:                          ; CODE XREF: sub_1402272F0+359↑j
                                        ; sub_1402272F0+365↑j ...
                test    r12b, cl
                jz      short loc_1402276EE
                test    cl, 20h
                jz      short loc_1402276EE
                inc     r10
                sub     r9, 8
                cmp     r10, 10h
                jb      loc_140227640

loc_1402276EE:                          ; CODE XREF: sub_1402272F0+38F↑j
                                        ; sub_1402272F0+3E6↑j ...
                mov     r15, [rbp+20h+arg_0]
                cmp     r10, 10h
                jnz     short loc_140227763
                xorps   xmm0, xmm0
                mov     [rsp+120h+var_A8], 10000h
                movups  [rbp+20h+var_90], xmm0
                lea     rax, [rsp+120h+var_B0]
                mov     qword ptr [rbp+20h+var_90], r12
                movups  [rbp+20h+var_A0], xmm0
                mov     qword ptr [rbp+20h+var_A0+8], rax
                lea     rcx, [rbp+20h+var_A0]
                xor     eax, eax
                and     rsi, 0FFFFFFFFFFFFF000h
                movups  [rbp+20h+var_80], xmm0
                mov     r8, r13
                mov     qword ptr [rbp+20h+var_90+8], rax
                mov     rdx, r11
                mov     qword ptr [rbp+20h+var_80], rax
                movups  [rbp+20h+var_70], xmm0
                mov     [rsp+120h+var_B0], rsi
                movups  [rbp+20h+var_60], xmm0
                movups  [rbp+20h+var_50], xmm0
                call    sub_140342A84
                cmp     rax, 10h
                jb      loc_140227935
                mov     esi, 2
                lea     r11d, [rsi+0Eh]
                jmp     short loc_14022778C
; ---------------------------------------------------------------------------

loc_140227763:                          ; CODE XREF: sub_1402272F0+406↑j
                mov     r10, [rbp+20h+arg_18]

loc_140227767:                          ; CODE XREF: sub_1402272F0+232↑j
                                        ; sub_1402272F0+252↑j ...
                mov     esi, [rbp+20h+arg_10]
                test    esi, esi
                jz      loc_140227939
                test    r10, r10
                jnz     loc_140227939
                mov     r11, [rsp+120h+var_D0]

loc_140227780:                          ; CODE XREF: sub_1402272F0+19D↑j
                mov     rdi, r12
                cmp     r11, r12
                jbe     loc_14022787F

loc_14022778C:                          ; CODE XREF: sub_1402272F0+471↑j
                mov     r10d, [r15+24h]
                lea     r9, [r14+8]
                mov     rdi, r12
                mov     r15, 0FFFFF6FB7DBED000h
                mov     r12, 0FFFFF6FB7DBED7F8h
                nop     dword ptr [rax+rax+00h]

loc_1402277B0:                          ; CODE XREF: sub_1402272F0+57F↓j
                mov     rdx, [r9]
                mov     rax, r15
                cmp     r9, rax
                jb      loc_140227843
                mov     rax, r12
                cmp     r9, rax
                ja      short loc_140227843
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140227843
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140227843
                test    dl, 1
                jz      short loc_140227843
                test    dl, 20h
                jz      short loc_1402277FB
                test    dl, 42h
                jnz     short loc_140227843

loc_1402277FB:                          ; CODE XREF: sub_1402272F0+504↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140227843
                mov     rax, r9
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140227843
                or      rdx, 42h

loc_140227843:                          ; CODE XREF: sub_1402272F0+4C9↑j
                                        ; sub_1402272F0+4D5↑j ...
                test    r10d, r10d
                jnz     short loc_14022784D
                test    rdx, rdx
                jmp     short loc_140227863
; ---------------------------------------------------------------------------

loc_14022784D:                          ; CODE XREF: sub_1402272F0+556↑j
                mov     rcx, rdx
                call    sub_1402CA91C
                test    eax, eax
                jnz     short loc_140227875
                shr     rdx, 5
                and     edx, 1Fh
                cmp     r10d, edx

loc_140227863:                          ; CODE XREF: sub_1402272F0+55B↑j
                jnz     short loc_140227875
                inc     rdi
                add     r9, 8
                cmp     rdi, r11
                jb      loc_1402277B0

loc_140227875:                          ; CODE XREF: sub_1402272F0+567↑j
                                        ; sub_1402272F0:loc_140227863↑j
                mov     r15, [rbp+20h+arg_0]
                mov     r12d, 1

loc_14022787F:                          ; CODE XREF: sub_1402272F0+496↑j
                cmp     esi, 2
                jnz     loc_14022792A
                cmp     rdi, r11
                jnz     loc_140227927
                mov     rcx, [rsp+120h+var_E0]
                lea     r8, [rsp+120h+var_C0]
                xorps   xmm0, xmm0
                mov     edx, ebx
                movups  [rsp+120h+var_C0], xmm0
                call    sub_1402C68C0
                mov     r8, qword ptr [rsp+120h+var_C0]
                mov     eax, r12d
                lock xadd [r8], eax
                mov     r9d, dword ptr [rsp+120h+var_C0+8]
                mov     ecx, [r15+20h]
                and     r9d, eax
                or      r9d, dword ptr [rsp+120h+var_C0+0Ch]
                call    sub_1402C4570
                mov     rcx, [rsp+120h+var_C8]
                xor     esi, esi
                mov     r8d, eax
                mov     [rsp+120h+var_F8], rsi
                mov     dword ptr [rsp+120h+var_100], 4
                lea     edx, [rsi+2]
                call    sub_1402DA06C
                mov     [rbp+20h+arg_18], rax
                mov     r10, rax
                test    rax, rax
                jz      short loc_14022792E
                or      dword ptr [r15], 80h
                mov     edx, 2
                mov     r8d, edx
                mov     [rsp+120h+var_F8], rsi
                mov     r9d, r12d
                mov     [rsp+120h+var_100], rsi
                mov     rcx, rax
                call    sub_1403F5644
                mov     r10, [rbp+20h+arg_18]
                mov     [rsp+120h+var_D8], rdi
                jmp     short loc_140227939
; ---------------------------------------------------------------------------

loc_140227927:                          ; CODE XREF: sub_1402272F0+59B↑j
                mov     rdi, r12

loc_14022792A:                          ; CODE XREF: sub_1402272F0+592↑j
                mov     r10, [rbp+20h+arg_18]

loc_14022792E:                          ; CODE XREF: sub_1402272F0+606↑j
                mov     [rsp+120h+var_D8], rdi
                jmp     short loc_140227939
; ---------------------------------------------------------------------------

loc_140227935:                          ; CODE XREF: sub_1402272F0+194↑j
                                        ; sub_1402272F0+462↑j
                mov     r10, [rbp+20h+arg_18]

loc_140227939:                          ; CODE XREF: sub_1402272F0+47C↑j
                                        ; sub_1402272F0+485↑j ...
                mov     r11, [rsp+120h+var_E0]
                xor     edx, edx

loc_140227940:                          ; CODE XREF: sub_1402272F0+15F↑j
                                        ; sub_1402272F0+168↑j ...
                mov     rax, [r15+48h]
                mov     r14, [rsp+120h+var_38]
                mov     r13, [rsp+120h+var_30]
                test    rax, rax
                jz      short loc_140227974

loc_140227959:                          ; DATA XREF: .pdata:00000001400CB10C↑o
                                        ; .pdata:00000001400CB118↑o
                mov     rax, [rax+220h]
                movzx   ecx, word ptr [rax+72Eh]
                mov     rax, cs:qword_140C4E4C8
                mov     rdi, [rax+rcx*8]
                jmp     short loc_140227979
; ---------------------------------------------------------------------------

loc_140227974:                          ; CODE XREF: sub_1402272F0+667↑j
                mov     rdi, [rsp+120h+var_C8]

loc_140227979:                          ; CODE XREF: sub_1402272F0+682↑j
                test    r10, r10
                jnz     short loc_1402279E7
                mov     eax, [r15+20h]
                test    eax, eax
                jnz     short loc_14022798C
                lea     r12d, [r10+3]
                jmp     short loc_1402279AC
; ---------------------------------------------------------------------------

loc_14022798C:                          ; CODE XREF: sub_1402272F0+694↑j
                cmp     eax, 1Fh
                jz      short loc_1402279AC
                mov     ecx, eax
                shr     ecx, 3
                cmp     ecx, 3
                jnz     short loc_1402279A5
                test    al, 7
                jz      short loc_1402279AC
                lea     r12d, [rcx-1]
                jmp     short loc_1402279AC
; ---------------------------------------------------------------------------

loc_1402279A5:                          ; CODE XREF: sub_1402272F0+6A9↑j
                cmp     ecx, 1
                cmovz   r12d, edx

loc_1402279AC:                          ; CODE XREF: sub_1402272F0+69A↑j
                                        ; sub_1402272F0+69F↑j ...
                lea     rax, [rsp+120h+var_D8]
                mov     r9d, r12d
                mov     [rsp+120h+var_F0], rax
                mov     r8d, ebx
                mov     [rsp+120h+var_F8], 0FFFFFFFFFFFFFFFFh
                mov     rdx, r11
                mov     rcx, rdi
                mov     dword ptr [rsp+120h+var_100], 102h
                call    sub_140229EE0
                mov     r10, rax
                test    rax, rax
                jnz     short loc_1402279E7

loc_1402279E0:                          ; CODE XREF: sub_1402272F0+92↑j
                mov     eax, 0C0000017h
                jmp     short loc_1402279F7
; ---------------------------------------------------------------------------

loc_1402279E7:                          ; CODE XREF: sub_1402272F0+68C↑j
                                        ; sub_1402272F0+6EE↑j
                mov     r8, [rsp+120h+var_D8]
                mov     rdx, r10
                mov     rcx, r15
                call    sub_140227A20

loc_1402279F7:                          ; CODE XREF: sub_1402272F0+F6↑j
                                        ; sub_1402272F0+6F5↑j
                mov     rbx, [rsp+120h+var_20]
                mov     r12, [rsp+120h+var_28]
                add     rsp, 108h
                pop     r15
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
algn_140227A14:                         ; DATA XREF: .pdata:00000001400CB118↑o
                                        ; .pdata:00000001400CB124↑o ...
                align 20h
sub_1402272F0   endp


; =============== S U B R O U T I N E =======================================


sub_140227A20   proc near               ; CODE XREF: sub_1402272F0+702↑p
                                        ; DATA XREF: .rdata:000000014005337C↑o ...

var_118         = qword ptr -118h
var_110         = dword ptr -110h
var_108         = qword ptr -108h
var_F8          = dword ptr -0F8h
var_F4          = dword ptr -0F4h
var_F0          = qword ptr -0F0h
var_E8          = dword ptr -0E8h
var_E4          = dword ptr -0E4h
var_E0          = qword ptr -0E0h
var_D8          = dword ptr -0D8h
var_D4          = dword ptr -0D4h
var_D0          = dword ptr -0D0h
var_CC          = dword ptr -0CCh
var_C8          = dword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h

                mov     [rsp+arg_10], r8
                mov     [rsp+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r14
                push    r15
                sub     rsp, 108h
                mov     rbp, [rcx+10h]
                mov     r9, r8
                mov     r8, [rcx+38h]
                mov     rdi, 7FFFFFFFF8h
                shr     rbp, 9
                mov     r15, rcx

loc_140227A56:                          ; DATA XREF: .rdata:000000014005337C↑o
                                        ; .rdata:0000000140053390↑o ...
                mov     [rsp+138h+var_40], r13
                and     rbp, rdi
                mov     r13, rdx
                mov     [rsp+138h+var_98], r8
                mov     r10, 0FFFFF68000000000h
                mov     rax, r10
                mov     rcx, [rcx+8]
                add     rbp, rax
                xor     r11d, r11d
                mov     [rsp+138h+var_A0], rbp
                mov     edx, 1
                mov     [rsp+138h+var_F8], r11d
                mov     r14d, r11d
                mov     rax, [rcx+38h]
                mov     [rsp+138h+var_78], rax
                mov     rax, [rcx+10h]
                test    dl, al
                jz      short loc_140227ABC
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 3
                cmovz   r14d, edx
                mov     [rsp+138h+var_F8], r14d

loc_140227ABC:                          ; CODE XREF: sub_140227A20+8A↑j
                mov     eax, [r15]
                test    al, 8
                mov     rax, r8
                cmovz   rax, r11
                mov     [rsp+138h+var_80], rax
                mov     rax, gs:188h
                mov     rcx, [rcx]
                shr     rcx, 9
                and     rcx, rdi
                mov     rdx, [rax+0B8h]
                mov     [rsp+138h+var_F0], rdx
                mov     rax, r10
                mov     rdx, [r15+40h]
                add     rcx, rax
                mov     [rsp+138h+var_90], rcx
                mov     r12d, 10h
                mov     [rsp+138h+var_88], rdx
                mov     [rsp+138h+var_F4], r11d
                test    rdx, rdx
                jz      short loc_140227B41
                mov     eax, [rdx+34h]
                movzx   ecx, byte ptr [rdx+22h]
                btr     eax, 1Fh
                shl     rcx, 1Fh
                mov     edx, 50h ; 'P'
                or      rcx, rax
                mov     rax, 7FFFFFFFEh
                cmp     rcx, rax
                cmovz   r12d, edx

loc_140227B41:                          ; CODE XREF: sub_140227A20+F7↑j
                mov     r14d, [r15+20h]
                mov     rcx, 3FFFFFFF78h
                mov     [rsp+138h+var_E4], r14d
                test    r14b, 2
                jz      short loc_140227B6D
                mov     rax, r10
                add     rax, rcx
                cmp     rbp, rax
                ja      short loc_140227B6D
                mov     rax, r10
                cmp     rbp, rax
                jnb     short loc_140227B77

loc_140227B6D:                          ; CODE XREF: sub_140227A20+138↑j
                                        ; sub_140227A20+143↑j
                bts     r14d, 1Fh
                mov     [rsp+138h+var_E4], r14d

loc_140227B77:                          ; CODE XREF: sub_140227A20+14B↑j
                cmp     [r15+24h], r11d
                jnz     short loc_140227B85
                inc     dword ptr gs:2E9Ch

loc_140227B85:                          ; CODE XREF: sub_140227A20+15B↑j
                mov     esi, r14d

loc_140227B88:                          ; DATA XREF: .rdata:0000000140053390↑o
                                        ; .pdata:00000001400CB13C↑o ...
                mov     [rsp+138h+var_38], rbx
                lea     rax, qword_140017520
                mov     [rsp+138h+arg_18], r11d
                and     esi, 1Fh
                mov     r8d, r11d
                mov     rdi, [rax+rsi*8]
                mov     rax, 0FFFF000000000E7Fh
                and     rdi, rax
                or      rdi, 21h
                mov     rax, r10
                mov     rcx, 8000000000000000h
                mov     rdx, 7FFFFFFFFFFFFFFFh
                cmp     rbp, rax
                jb      loc_140227DDF
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rbp, rax
                ja      loc_140227DDF
                mov     rbx, rbp
                shl     rbx, 19h
                mov     rax, r10
                shl     rax, 19h
                sub     rbx, rax
                mov     rax, 0FFFFF6FB40000000h
                sar     rbx, 10h
                mov     rax, rax
                cmp     rbp, rax
                jb      short loc_140227C5E
                mov     rax, 0FFFFF6FB7FFFFFFFh
                cmp     rbp, rax
                ja      short loc_140227C5E
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     rbp, rax
                jnz     short loc_140227C3A
                or      rdi, rcx
                jmp     short loc_140227C44
; ---------------------------------------------------------------------------

loc_140227C3A:                          ; CODE XREF: sub_140227A20+213↑j
                bt      r14d, 1Ah
                jb      short loc_140227C44
                and     rdi, rdx

loc_140227C44:                          ; CODE XREF: sub_140227A20+218↑j
                                        ; sub_140227A20+21F↑j
                mov     rcx, rbp
                call    sub_14033FA34
                mov     r10, 0FFFFF68000000000h
                test    eax, eax
                jz      short loc_140227C5E
                or      rdi, 4

loc_140227C5E:                          ; CODE XREF: sub_140227A20+1F5↑j
                                        ; sub_140227A20+204↑j ...
                mov     rcx, rdi
                mov     rax, r10
                or      rdi, 4
                mov     rdx, 3FFFFFFF78h
                add     rax, rdx
                cmp     rbp, rax
                cmova   rdi, rcx
                bt      r14d, 1Ah
                jnb     short loc_140227C8E
                mov     rcx, rbx
                call    sub_14027F590
                mov     rbx, rax

loc_140227C8E:                          ; CODE XREF: sub_140227A20+261↑j
                mov     rax, 0FFFF800000000000h
                cmp     rbx, rax
                jnb     short loc_140227CA6
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jmp     short loc_140227CF7
; ---------------------------------------------------------------------------

loc_140227CA6:                          ; CODE XREF: sub_140227A20+27B↑j
                mov     rcx, rbx
                call    sub_140245330
                cmp     eax, 1
                jz      short loc_140227D00
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rbx, rax
                jb      short loc_140227CD7
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rbx, rax
                jbe     short loc_140227D00

loc_140227CD7:                          ; CODE XREF: sub_140227A20+2A3↑j
                cmp     rbx, cs:qword_140C4F9B8
                jb      short loc_140227CF0
                cmp     rbx, cs:qword_140C4E1E8
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jbe     short loc_140227CF7

loc_140227CF0:                          ; CODE XREF: sub_140227A20+2BE↑j
                movzx   eax, byte ptr cs:word_140C4DE88

loc_140227CF7:                          ; CODE XREF: sub_140227A20+284↑j
                                        ; sub_140227A20+2CE↑j
                test    eax, eax
                jz      short loc_140227D00
                bts     rdi, 8

loc_140227D00:                          ; CODE XREF: sub_140227A20+291↑j
                                        ; sub_140227A20+2B5↑j ...
                mov     r9, [rsp+138h+arg_10]
                xor     r11d, r11d
                mov     r8d, [rsp+138h+arg_18]

loc_140227D13:                          ; CODE XREF: sub_140227A20+3C4↓j
                test    r14d, r14d
                jns     short loc_140227D26
                and     sil, 5
                cmp     sil, 4
                jnz     short loc_140227D26
                or      rdi, 42h

loc_140227D26:                          ; CODE XREF: sub_140227A20+2F6↑j
                                        ; sub_140227A20+300↑j
                mov     rax, rdi
                mov     ecx, r14d
                and     rax, 0FFFFFFFFFFFFFFFBh
                and     ecx, 40000000h
                cmovz   rax, rdi
                bt      r14d, 1Dh
                jnb     short loc_140227D58
                movzx   ecx, byte ptr cs:word_140C4DE88
                shl     rcx, 8
                xor     rcx, rax
                and     ecx, 100h
                xor     rax, rcx

loc_140227D58:                          ; CODE XREF: sub_140227A20+31F↑j
                mov     rdx, rax
                mov     r10, 0FFFFF6FB7DBED7F8h
                btr     rdx, 8
                mov     rdi, 0FFFFFA8000000000h
                mov     ecx, r14d
                and     ecx, 8000000h
                mov     rcx, r11
                cmovz   rdx, rax
                mov     [rsp+138h+var_B8], rcx
                mov     eax, r14d
                mov     rsi, rdx
                bts     rsi, 7
                mov     r14d, 1FFh
                and     eax, 4000000h
                mov     rax, 0FAFFFFFFFFFFFFFFh
                cmovz   rsi, rdx
                and     rsi, rax
                mov     rax, 0A00000000000000h
                or      rsi, rax
                mov     rax, 0FFFFF6FB7DBED000h
                test    r9, r9
                jz      loc_140228A3A
                mov     r9, 0FFFFFFF000000000h
                jmp     short loc_140227DFA
; ---------------------------------------------------------------------------

loc_140227DDF:                          ; CODE XREF: sub_140227A20+1B4↑j
                                        ; sub_140227A20+1CA↑j
                bts     rdi, 8
                jmp     loc_140227D13
; ---------------------------------------------------------------------------
                align 10h

loc_140227DF0:                          ; CODE XREF: sub_140227A20+1014↓j
                mov     rdi, 0FFFFFA8000000000h

loc_140227DFA:                          ; CODE XREF: sub_140227A20+3BD↑j
                mov     rbx, [rbp+0]
                mov     rax, rax
                cmp     rbp, rax
                jb      loc_140227E98
                mov     rax, r10
                cmp     rbp, rax
                ja      loc_140227E98
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140227E90
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140227E90
                test    bl, 1
                jz      short loc_140227E90
                test    bl, 20h
                jz      short loc_140227E4A
                test    bl, 42h
                jnz     short loc_140227E90

loc_140227E4A:                          ; CODE XREF: sub_140227A20+423↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140227E90
                mov     rax, rbp
                shr     rax, 3
                and     rax, r14
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140227E90
                or      rbx, 42h

loc_140227E90:                          ; CODE XREF: sub_140227A20+400↑j
                                        ; sub_140227A20+419↑j ...
                mov     rcx, [rsp+138h+var_B8]

loc_140227E98:                          ; CODE XREF: sub_140227A20+3E4↑j
                                        ; sub_140227A20+3F0↑j
                cmp     dword ptr [r15+24h], 0
                jnz     loc_140227F6E
                test    rbx, rbx
                jnz     loc_140227F85
                mov     ebx, [r15+20h]
                inc     r8d
                mov     rcx, cs:qword_140C4DDC0
                and     ebx, 1Fh
                shl     rbx, 5
                mov     [rsp+138h+arg_18], r8d
                test    rcx, rcx
                jz      short loc_140227EDF
                mov     rax, rcx
                and     rax, rbx
                jnz     short loc_140227EDB
                or      rbx, rcx
                jmp     short loc_140227EDF
; ---------------------------------------------------------------------------

loc_140227EDB:                          ; CODE XREF: sub_140227A20+4B4↑j
                or      rbx, 10h

loc_140227EDF:                          ; CODE XREF: sub_140227A20+4AC↑j
                                        ; sub_140227A20+4B9↑j
                mov     rcx, rbp
                mov     rdi, rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_140227F68
                call    sub_140349680
                test    eax, eax
                jz      short loc_140227F3A
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140227F12
                test    bl, 1
                jz      short loc_140227F12
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_140227F12:                          ; CODE XREF: sub_140227A20+4DE↑j
                                        ; sub_140227A20+4E3↑j
                mov     rdx, rdi
                mov     [rbp+0], rdi
                mov     rcx, rbp
                call    sub_140349620

loc_140227F21:                          ; CODE XREF: sub_140227A20+54C↓j
                xor     r11d, r11d
                mov     rdi, 0FFFFFA8000000000h
                mov     r9, 0FFFFFFF000000000h
                jmp     short loc_140227F85
; ---------------------------------------------------------------------------

loc_140227F3A:                          ; CODE XREF: sub_140227A20+4D5↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140227F68
                test    bl, 1
                jz      short loc_140227F68
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_140227F68:                          ; CODE XREF: sub_140227A20+4CC↑j
                                        ; sub_140227A20+534↑j ...
                mov     [rbp+0], rdi
                jmp     short loc_140227F21
; ---------------------------------------------------------------------------

loc_140227F6E:                          ; CODE XREF: sub_140227A20+47D↑j
                bt      rbx, 0Ah
                jb      short loc_140227F85
                bt      rbx, 1Ah
                jnb     short loc_140227F85
                test    rcx, rcx
                jnz     short loc_140227F85
                or      rsi, 40h

loc_140227F85:                          ; CODE XREF: sub_140227A20+486↑j
                                        ; sub_140227A20+518↑j ...
                mov     rax, [r13+18h]
                lea     r14, [r13+18h]
                mov     rcx, 0FFFFFFFFFh
                mov     [rsp+138h+var_E0], r13
                and     rax, rcx
                mov     r10, r13
                cmp     rax, rcx
                jnz     short loc_140227FB1
                mov     [rsp+138h+arg_8], r11
                jmp     short loc_140227FC7
; ---------------------------------------------------------------------------

loc_140227FB1:                          ; CODE XREF: sub_140227A20+585↑j
                lea     r8, [rax+rax*2]
                shl     r8, 4
                mov     rax, rdi
                add     r8, rax
                mov     [rsp+138h+arg_8], r8

loc_140227FC7:                          ; CODE XREF: sub_140227A20+58F↑j
                mov     rdx, [r14]
                mov     rcx, rdx
                mov     rax, rdx
                and     rcx, r9
                lock cmpxchg [r14], rcx
                mov     rdi, rax
                cmp     rdx, rax
                jz      short loc_140227FF6

loc_140227FE0:                          ; CODE XREF: sub_140227A20+5D4↓j
                mov     rcx, rdi
                and     rdi, r9
                mov     rax, rcx
                lock cmpxchg [r14], rdi
                mov     rdi, rax
                cmp     rcx, rax
                jnz     short loc_140227FE0

loc_140227FF6:                          ; CODE XREF: sub_140227A20+5BE↑j
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                mov     rcx, r13
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rdi, rdx
                sar     rdi, 3
                mov     rax, rdi
                shr     rax, 3Fh
                add     rdi, rax
                cmp     dword ptr [r15+24h], 0
                mov     [rsp+138h+var_A8], rdi
                jz      loc_14022812E
                cmp     qword ptr [r15+48h], 0
                jnz     loc_14022812E
                bt      rbx, 0Ah
                jnb     loc_14022812E
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_14022806D
                test    bl, 10h
                jnz     short loc_14022806D
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_14022806D:                          ; CODE XREF: sub_140227A20+63D↑j
                                        ; sub_140227A20+642↑j
                sar     rax, 10h
                test    rax, rax
                jz      short loc_1402280D2
                mov     [rsp+138h+var_D8], r11d
                lock bts qword ptr [r14], 3Fh ; '?'
                jnb     short loc_1402280A0

loc_140228083:                          ; CODE XREF: sub_140227A20+673↓j
                                        ; sub_140227A20+67B↓j
                lea     rcx, [rsp+138h+var_D8]
                call    sub_1402C8C70
                mov     rax, [r14]
                test    rax, rax
                js      short loc_140228083
                lock bts qword ptr [r14], 3Fh ; '?'
                jb      short loc_140228083
                mov     r10, r13

loc_1402280A0:                          ; CODE XREF: sub_140227A20+661↑j
                mov     rax, [r10+28h]
                mov     rcx, 0CFFFFFFFFFFFFFFFh
                and     rax, rcx
                mov     rcx, 4000000000000000h
                or      rax, rcx
                mov     [r10+28h], rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r14], rax
                jmp     short loc_1402280E5
; ---------------------------------------------------------------------------

loc_1402280D2:                          ; CODE XREF: sub_140227A20+654↑j
                test    rbx, 3E0h
                jz      short loc_1402280E2
                btr     rbx, 0Ah
                jmp     short loc_1402280E5
; ---------------------------------------------------------------------------

loc_1402280E2:                          ; CODE XREF: sub_140227A20+6B9↑j
                mov     rbx, r11

loc_1402280E5:                          ; CODE XREF: sub_140227A20+6B0↑j
                                        ; sub_140227A20+6C0↑j
                xor     edx, edx
                mov     r8d, 80000000h
                mov     rcx, rdi
                call    sub_1402D6810
                mov     r9, rax
                mov     rdi, rax
                and     rbx, 0FFFFFFFFFFFFFFFDh
                mov     ecx, 200h
                mov     rax, rbx
                mov     r8d, 80000000h
                rep stosq
                mov     rcx, r9
                mov     dl, 11h
                call    sub_1402432B0
                mov     ecx, 80h
                call    sub_14027C6C0
                mov     rbx, rax
                or      r12d, 8
                mov     r10, r13

loc_14022812E:                          ; CODE XREF: sub_140227A20+614↑j
                                        ; sub_140227A20+61F↑j ...
                mov     eax, [r15]
                mov     ecx, r12d
                mov     r9d, [r15+20h]
                or      ecx, 20h
                mov     rdx, [rbp+0]
                and     al, 4
                mov     eax, r9d
                mov     edi, r9d
                cmovz   ecx, r12d
                mov     r12, 0FFFFF6FB7DBED000h
                mov     r11d, ecx
                or      r11d, 20h
                and     al, 2
                cmovz   r11d, ecx
                mov     [rsp+138h+var_E8], r11d
                mov     rax, r12
                mov     r15, 0FFFFF6FB7DBED7F8h
                cmp     rbp, rax
                jb      short loc_1402281E1
                mov     rax, r15
                cmp     rbp, rax
                ja      short loc_1402281E1
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402281E1
                test    dl, 1
                jz      short loc_1402281E1
                test    dl, 20h
                jz      short loc_140228199
                test    dl, 42h
                jnz     short loc_1402281E1

loc_140228199:                          ; CODE XREF: sub_140227A20+772↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_1402281E1
                mov     rax, rbp
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_1402281E1
                or      rdx, 42h

loc_1402281E1:                          ; CODE XREF: sub_140227A20+757↑j
                                        ; sub_140227A20+75F↑j ...
                test    r11b, 4
                jz      short loc_14022820A
                and     edi, 1Fh
                shl     rdi, 5
                test    rdx, rdx
                jnz     short loc_140228200
                mov     rcx, rdi
                call    sub_14027C6C0
                mov     rdx, rax
                jmp     short loc_14022820A
; ---------------------------------------------------------------------------

loc_140228200:                          ; CODE XREF: sub_140227A20+7D1↑j
                and     rdx, 0FFFFFFFFFFFFFC1Fh
                or      rdx, rdi

loc_14022820A:                          ; CODE XREF: sub_140227A20+7C5↑j
                                        ; sub_140227A20+7DE↑j
                bt      rdx, 0Ah
                mov     rax, 0FFFFFFFFFFFFFFF7h
                mov     rcx, 0FFFFFFFFFFFFF7FFh
                cmovb   rax, rcx
                and     rax, rdx
                mov     [r10+10h], rax
                test    r11b, 2
                jz      short loc_14022823E
                mov     rax, 8000000000000000h
                or      [r10+28h], rax
                jmp     short loc_140228255
; ---------------------------------------------------------------------------

loc_14022823E:                          ; CODE XREF: sub_140227A20+80C↑j
                test    r11b, 8
                jnz     short loc_140228255
                and     rax, 0FFFFFFFFFC00FFFFh
                and     qword ptr [r10], 0FFFFFFFFFFFFC00Fh
                mov     [r10+10h], rax

loc_140228255:                          ; CODE XREF: sub_140227A20+81C↑j
                                        ; sub_140227A20+822↑j
                test    r9d, r9d
                jnz     short loc_140228263
                lea     r13d, [r9+3]
                xor     r8d, r8d
                jmp     short loc_14022829F
; ---------------------------------------------------------------------------

loc_140228263:                          ; CODE XREF: sub_140227A20+838↑j
                cmp     r9d, 1Fh
                jnz     short loc_140228272
                lea     r13d, [r9-1Eh]
                xor     r8d, r8d
                jmp     short loc_14022829F
; ---------------------------------------------------------------------------

loc_140228272:                          ; CODE XREF: sub_140227A20+847↑j
                mov     eax, r9d
                shr     eax, 3
                cmp     eax, 3
                jnz     short loc_14022828C
                test    r9b, 7
                jz      short loc_14022828C
                lea     r13d, [rax-1]
                xor     r8d, r8d
                jmp     short loc_14022829F
; ---------------------------------------------------------------------------

loc_14022828C:                          ; CODE XREF: sub_140227A20+85B↑j
                                        ; sub_140227A20+861↑j
                mov     r13d, 1
                mov     r8d, 0
                cmp     eax, r13d
                cmovz   r13d, r8d

loc_14022829F:                          ; CODE XREF: sub_140227A20+841↑j
                                        ; sub_140227A20+850↑j ...
                mov     eax, 1
                mov     rdx, rbp
                mov     [r10+20h], ax
                mov     rax, 7FFFFFFFF8h
                shr     rdx, 9
                and     rdx, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     rdx, rax
                mov     rdi, [rdx]
                mov     rax, r12
                cmp     rdx, rax
                jb      short loc_140228341
                mov     rax, r15
                cmp     rdx, rax
                ja      short loc_140228341
                call    sub_140349680
                test    eax, eax
                jz      short loc_140228341
                test    dil, 1
                jz      short loc_140228341
                test    dil, 20h
                jz      short loc_1402282FB
                test    dil, 42h
                jnz     short loc_140228341

loc_1402282FB:                          ; CODE XREF: sub_140227A20+8D3↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140228341
                shr     rdx, 3
                and     edx, 1FFh
                mov     rax, [rax+rdx*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_140228341
                or      rdi, 42h

loc_140228341:                          ; CODE XREF: sub_140227A20+8B6↑j
                                        ; sub_140227A20+8BE↑j ...
                mov     [rsp+138h+var_C0], rdi
                mov     rax, r12
                lea     rcx, [rsp+138h+var_C0]
                cmp     rcx, rax
                jb      short loc_1402283C5
                mov     rax, r15
                lea     rcx, [rsp+138h+var_C0]
                cmp     rcx, rax
                ja      short loc_1402283C5
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402283C5
                test    dil, 1
                jz      short loc_1402283C5
                test    dil, 20h
                jz      short loc_14022837B
                test    dil, 42h
                jnz     short loc_1402283C5

loc_14022837B:                          ; CODE XREF: sub_140227A20+953↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_1402283C5
                lea     rax, [rsp+138h+var_C0]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_1402283C5
                or      rdi, 42h

loc_1402283C5:                          ; CODE XREF: sub_140227A20+931↑j
                                        ; sub_140227A20+93E↑j ...
                shr     rdi, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdi, rax
                mov     rcx, 0FFFFFFF000000000h
                mov     rax, [r10+28h]
                and     rax, rcx
                or      rax, rdi
                lea     rdi, [rdi+rdi*2]
                mov     [r10+28h], rax
                shl     rdi, 4
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                add     rdi, rax
                mov     rax, gs:188h
                mov     ebp, [rax+518h]
                bt      ebp, 8
                jnb     short loc_140228420
                shr     ebp, 9
                jmp     short loc_14022844B
; ---------------------------------------------------------------------------

loc_140228420:                          ; CODE XREF: sub_140227A20+9F9↑j
                mov     ebp, [rax+510h]
                mov     rax, [rax+220h]
                shr     ebp, 0Ch
                and     ebp, 7
                test    dword ptr [rax+464h], 100000h
                jz      short loc_14022844B
                mov     eax, 2
                cmp     ebp, eax
                cmovb   eax, ebp
                mov     ebp, eax

loc_14022844B:                          ; CODE XREF: sub_140227A20+9FE↑j
                                        ; sub_140227A20+A1D↑j
                mov     r15d, r11d
                mov     r12b, 11h
                and     r15d, 1
                jnz     short loc_140228498
                test    r11b, 10h
                jz      short loc_14022848C
                mov     [rsp+138h+var_D4], r8d
                lock bts qword ptr [r14], 3Fh ; '?'
                jnb     short loc_140228498
                nop     word ptr [rax+rax+00h]

loc_140228470:                          ; CODE XREF: sub_140227A20+A60↓j
                                        ; sub_140227A20+A68↓j
                lea     rcx, [rsp+138h+var_D4]
                call    sub_1402C8C70
                mov     rax, [r14]
                test    rax, rax
                js      short loc_140228470
                lock bts qword ptr [r14], 3Fh ; '?'
                jb      short loc_140228470
                jmp     short loc_140228498
; ---------------------------------------------------------------------------

loc_14022848C:                          ; CODE XREF: sub_140227A20+A3B↑j
                mov     rcx, r10
                call    sub_1402DAA00
                movzx   r12d, al

loc_140228498:                          ; CODE XREF: sub_140227A20+A35↑j
                                        ; sub_140227A20+A48↑j ...
                mov     [rsp+138h+var_D0], 0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_1402284CC
                nop     dword ptr [rax+00000000h]

loc_1402284B0:                          ; CODE XREF: sub_140227A20+AA1↓j
                                        ; sub_140227A20+AAA↓j
                lea     rcx, [rsp+138h+var_D0]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_1402284B0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_1402284B0

loc_1402284CC:                          ; CODE XREF: sub_140227A20+A87↑j
                mov     rdx, [rdi+18h]
                mov     rcx, rdx
                lea     rax, [rdx+1]
                xor     rcx, rax
                mov     rax, 3FFFFFFFFFFFFFFFh
                and     rcx, rax
                xor     rcx, rdx
                mov     rdx, 7FFFFFFFFFFFFFFFh
                mov     [rdi+18h], rcx
                lock and [rdi+18h], rdx
                mov     rax, [rsp+138h+var_E0]
                movzx   ecx, byte ptr [rax+22h]
                mov     eax, ecx
                shr     eax, 6
                cmp     eax, r13d
                jz      short loc_140228537
                mov     edx, r13d
                mov     r8d, 1
                mov     r13, [rsp+138h+var_E0]
                mov     rcx, r13
                call    sub_14031F848
                movzx   ecx, byte ptr [r13+22h]
                mov     rdx, 7FFFFFFFFFFFFFFFh
                jmp     short loc_14022853C
; ---------------------------------------------------------------------------

loc_140228537:                          ; CODE XREF: sub_140227A20+AEE↑j
                mov     r13, [rsp+138h+var_E0]

loc_14022853C:                          ; CODE XREF: sub_140227A20+B15↑j
                mov     rax, [r14]
                and     cl, 0FEh
                or      cl, 6
                mov     rdi, 0C000000000000001h
                and     rax, rdi
                or      rax, 1
                mov     [r14], rax
                movzx   eax, byte ptr [r13+23h]
                xor     al, bpl
                mov     rbp, [rsp+138h+var_A0]
                and     al, 7
                mov     [r13+8], rbp
                xor     [r13+23h], al
                mov     [r13+22h], cl
                mov     ecx, [rsp+138h+var_E8]
                test    cl, 20h
                jnz     short loc_14022858B
                movzx   eax, byte ptr [r13+22h]
                or      al, 10h
                mov     [r13+22h], al

loc_14022858B:                          ; CODE XREF: sub_140227A20+B5E↑j
                test    cl, 40h
                jz      short loc_140228595
                or      byte ptr [r13+23h], 20h

loc_140228595:                          ; CODE XREF: sub_140227A20+B6E↑j
                test    r15d, r15d
                jnz     short loc_140228604
                lock and [r14], rdx
                test    cl, 10h
                jnz     short loc_140228604
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_1402285FC
                test    al, 1
                jz      short loc_1402285FC
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_1402285FC
                cmp     r12b, 0Fh
                ja      short loc_1402285FC
                cmp     al, 2
                jb      short loc_1402285FC
                mov     r9, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r12b
                inc     ecx
                shl     rdx, cl
                mov     r8, [r9+84B8h]
                movzx   eax, dx
                not     eax
                mov     edi, [r8+14h]
                and     edi, eax
                mov     [r8+14h], edi
                jnz     short loc_1402285FC
                mov     rcx, r9
                call    sub_1403F2EC4

loc_1402285FC:                          ; CODE XREF: sub_140227A20+B8B↑j
                                        ; sub_140227A20+B8F↑j ...
                movzx   eax, r12b
                mov     cr8, rax

loc_140228604:                          ; CODE XREF: sub_140227A20+B78↑j
                                        ; sub_140227A20+B81↑j
                mov     r12d, [rsp+138h+var_E8]
                test    r12b, 8
                jz      short loc_140228613
                mov     [r13+10h], rbx

loc_140228613:                          ; CODE XREF: sub_140227A20+BED↑j
                mov     r15, [rsp+138h+arg_0]
                mov     rcx, [rsp+138h+var_A8]
                mov     eax, [r15]
                test    al, 4
                jz      loc_14022873A
                mov     edx, [r15+20h]
                call    sub_1402810E0
                mov     rcx, rbp
                mov     rdi, rax
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_1402286AB
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022867C
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022866B
                test    dil, 1
                jz      short loc_14022866B
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_14022866B:                          ; CODE XREF: sub_140227A20+C36↑j
                                        ; sub_140227A20+C3C↑j
                mov     rdx, rdi
                mov     [rbp+0], rdi
                mov     rcx, rbp
                call    sub_140349620
                jmp     short loc_1402286AF
; ---------------------------------------------------------------------------

loc_14022867C:                          ; CODE XREF: sub_140227A20+C2D↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_1402286AB
                test    dil, 1
                jz      short loc_1402286AB
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_1402286AB:                          ; CODE XREF: sub_140227A20+C24↑j
                                        ; sub_140227A20+C76↑j ...
                mov     [rbp+0], rdi

loc_1402286AF:                          ; CODE XREF: sub_140227A20+C5A↑j
                mov     eax, [r15]
                test    al, 40h
                jz      short loc_1402286C9
                mov     rcx, [rsp+138h+var_F0]
                mov     eax, 1
                lock xadd [rcx+4F8h], rax

loc_1402286C9:                          ; CODE XREF: sub_140227A20+C94↑j
                xor     edx, edx
                mov     rcx, r13
                call    sub_140209CE0
                mov     r8, [rsp+138h+var_98]
                test    r8, r8
                jz      loc_1402289D3
                mov     rax, [r8+8]
                mov     rcx, [r8+18h]
                mov     rdx, [r8+20h]
                add     rcx, rcx
                shl     rdx, 0Ch
                add     rdx, [rax+rcx*8]
                mov     rcx, rbp
                shl     rcx, 19h
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                cmp     rcx, rdx
                jnz     loc_1402289D3
                cmp     byte ptr [r8], 5
                jz      loc_1402289D3
                mov     rcx, r8
                call    sub_14031D4E8
                jmp     loc_1402289D3
; ---------------------------------------------------------------------------

loc_14022873A:                          ; CODE XREF: sub_140227A20+C08↑j
                shl     rcx, 0Ch
                mov     rdx, 0FFFFFFFFF000h
                xor     rcx, rsi
                and     rcx, rdx
                xor     rsi, rcx
                or      rsi, 20h
                cmp     qword ptr [r15+48h], 0
                jz      loc_1402287E0
                mov     rcx, rbp
                mov     rdi, rsi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_1402287D7
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402287A8
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140228794
                test    sil, 1
                jz      short loc_140228794
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_140228794:                          ; CODE XREF: sub_140227A20+D5F↑j
                                        ; sub_140227A20+D65↑j
                mov     rdx, rdi
                mov     [rbp+0], rdi
                mov     rcx, rbp
                call    sub_140349620
                jmp     loc_1402289D3
; ---------------------------------------------------------------------------

loc_1402287A8:                          ; CODE XREF: sub_140227A20+D56↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_1402287D7
                test    sil, 1
                jz      short loc_1402287D7
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_1402287D7:                          ; CODE XREF: sub_140227A20+D4D↑j
                                        ; sub_140227A20+DA2↑j ...
                mov     [rbp+0], rdi
                jmp     loc_1402289D3
; ---------------------------------------------------------------------------

loc_1402287E0:                          ; CODE XREF: sub_140227A20+D3A↑j
                cmp     rbp, [rsp+138h+var_90]
                jz      loc_140228890
                test    al, al
                jns     loc_140228890
                and     rsi, 0FFFFFFFFFFFFFFDFh
                cmp     [rsp+138h+var_E4], 0
                jge     loc_140228890
                mov     rcx, 0FFFFF68000000000h
                mov     rax, rcx
                mov     rdx, 3FFFFFFF78h
                add     rax, rdx
                cmp     rbp, rax
                ja      short loc_140228890
                mov     rax, rcx
                mov     rbx, [rsp+138h+var_F0]
                cmp     rbp, rax
                jb      short loc_140228895
                test    dword ptr [rbx+464h], 8000h
                jz      short loc_140228895
                mov     eax, [rsp+138h+var_F4]
                test    eax, eax
                jnz     short loc_140228885
                mov     rax, [rsp+138h+var_88]
                test    rax, rax
                jnz     short loc_14022885B
                mov     rcx, [r15+10h]
                call    sub_14026A130

loc_14022885B:                          ; CODE XREF: sub_140227A20+E30↑j
                mov     eax, [rax+30h]
                and     eax, 300000h
                cmp     eax, 300000h
                jnz     short loc_140228878
                mov     [rsp+138h+var_F4], 2
                and     rsi, 0FFFFFFFFFFFFFFBDh
                jmp     short loc_140228895
; ---------------------------------------------------------------------------

loc_140228878:                          ; CODE XREF: sub_140227A20+E48↑j
                mov     r14d, 1
                mov     [rsp+138h+var_F4], r14d
                jmp     short loc_14022889B
; ---------------------------------------------------------------------------

loc_140228885:                          ; CODE XREF: sub_140227A20+E23↑j
                cmp     eax, 2
                jnz     short loc_140228895
                and     rsi, 0FFFFFFFFFFFFFFBDh
                jmp     short loc_140228895
; ---------------------------------------------------------------------------

loc_140228890:                          ; CODE XREF: sub_140227A20+DC8↑j
                                        ; sub_140227A20+DD0↑j ...
                mov     rbx, [rsp+138h+var_F0]

loc_140228895:                          ; CODE XREF: sub_140227A20+E0F↑j
                                        ; sub_140227A20+E1B↑j ...
                mov     r14d, 1

loc_14022889B:                          ; CODE XREF: sub_140227A20+E63↑j
                mov     rdi, [r15+8]
                movzx   edx, byte ptr [rdi+45h]
                movzx   eax, dl
                and     al, 5
                cmp     al, 4
                jnz     loc_140228973
                test    dl, 2
                jnz     loc_140228973
                movzx   eax, word ptr [rdi+42h]
                mov     r8d, 1FFh
                test    ax, ax
                jz      short loc_140228902
                movzx   ecx, word ptr [rdi+40h]
                add     ecx, eax
                mov     eax, ebp
                shr     eax, 3
                and     eax, r8d
                cmp     ecx, eax
                jnz     short loc_1402288F3
                mov     rcx, r13
                and     dl, 10h
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_1402288EF
                test    dl, dl
                jz      short loc_140228902
                jmp     short loc_1402288F3
; ---------------------------------------------------------------------------

loc_1402288EF:                          ; CODE XREF: sub_140227A20+EC7↑j
                test    dl, dl
                jnz     short loc_140228902

loc_1402288F3:                          ; CODE XREF: sub_140227A20+EB8↑j
                                        ; sub_140227A20+ECD↑j
                lea     rcx, [rdi+38h]
                call    sub_14026F5D0
                mov     r8d, 1FFh

loc_140228902:                          ; CODE XREF: sub_140227A20+EA6↑j
                                        ; sub_140227A20+ECB↑j ...
                movzx   eax, word ptr [rdi+42h]
                test    ax, ax
                jnz     short loc_14022893D
                movzx   edx, byte ptr [rdi+45h]
                mov     eax, ebp
                shr     eax, 3
                mov     rcx, r13
                and     ax, r8w
                mov     [rdi+42h], r14w
                mov     [rdi+40h], ax
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_140228935
                and     dl, 0EFh
                mov     [rdi+45h], dl
                jmp     short loc_140228944
; ---------------------------------------------------------------------------

loc_140228935:                          ; CODE XREF: sub_140227A20+F0B↑j
                or      dl, 10h
                mov     [rdi+45h], dl
                jmp     short loc_140228944
; ---------------------------------------------------------------------------

loc_14022893D:                          ; CODE XREF: sub_140227A20+EE9↑j
                inc     ax
                mov     [rdi+42h], ax

loc_140228944:                          ; CODE XREF: sub_140227A20+F13↑j
                                        ; sub_140227A20+F1B↑j
                mov     r14d, [rsp+138h+var_F8]
                mov     rcx, [r15+8]
                or      r14d, 4
                mov     [rsp+138h+var_F8], r14d
                test    byte ptr [rcx+45h], 8
                jz      short loc_140228981
                mov     rax, [rcx+10h]
                test    al, 1
                jz      short loc_14022896D
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 2
                jz      short loc_140228981

loc_14022896D:                          ; CODE XREF: sub_140227A20+F42↑j
                and     rsi, 0FFFFFFFFFFFFFFDFh
                jmp     short loc_140228981
; ---------------------------------------------------------------------------

loc_140228973:                          ; CODE XREF: sub_140227A20+E8A↑j
                                        ; sub_140227A20+E93↑j
                mov     r14d, [rsp+138h+var_F8]
                and     r14d, 0FFFFFFFBh
                mov     [rsp+138h+var_F8], r14d

loc_140228981:                          ; CODE XREF: sub_140227A20+F3A↑j
                                        ; sub_140227A20+F4B↑j ...
                mov     rax, [rsp+138h+var_80]
                xor     r9d, r9d
                mov     rcx, [rsp+138h+var_78]
                mov     r8, r13
                mov     [rsp+138h+var_108], rax
                mov     rdx, rbp
                mov     [rsp+138h+var_110], r14d
                mov     [rsp+138h+var_118], rsi
                call    sub_140228E90
                test    eax, eax
                jz      loc_140228AB7
                mov     eax, [r15]
                test    al, 40h
                jz      short loc_1402289CB
                mov     eax, 1
                lock xadd [rbx+4F8h], rax

loc_1402289CB:                          ; CODE XREF: sub_140227A20+F9B↑j
                inc     dword ptr gs:2E9Ch

loc_1402289D3:                          ; CODE XREF: sub_140227A20+CBE↑j
                                        ; sub_140227A20+CFD↑j ...
                mov     rcx, [rsp+138h+var_B8]
                add     rbp, 8
                mov     r13, [rsp+138h+arg_8]
                inc     rcx
                mov     r11d, 0
                mov     r8d, [rsp+138h+arg_18]
                mov     r14d, 1FFh
                mov     [rsp+138h+var_B8], rcx
                mov     r9, 0FFFFFFF000000000h
                mov     [rsp+138h+var_A0], rbp
                mov     r10, 0FFFFF6FB7DBED7F8h
                mov     rax, 0FFFFF6FB7DBED000h
                cmp     rcx, [rsp+138h+arg_10]
                jb      loc_140227DF0

loc_140228A3A:                          ; CODE XREF: sub_140227A20+3AD↑j
                mov     r12, 0FFFFFA8000000000h
                mov     ebx, 111h

loc_140228A49:                          ; CODE XREF: sub_140227A20+1156↓j
                cmp     dword ptr [r15+24h], 0
                mov     r13, [rsp+138h+var_40]
                jnz     loc_140228E67

loc_140228A5C:                          ; DATA XREF: .pdata:00000001400CB148↑o
                                        ; .pdata:00000001400CB154↑o
                mov     esi, [rsp+138h+arg_18]
                test    esi, esi
                jz      loc_140228E67
                mov     r8, [r15+10h]
                mov     edi, r11d
                mov     rdx, r8
                mov     rbp, 0FFFFF68000000000h
                mov     rax, 7FFFFFFEFFFFh
                nop     dword ptr [rax+00000000h]

loc_140228A90:                          ; CODE XREF: sub_140227A20+1090↓j
                cmp     rdx, rax
                jbe     loc_140228B7B
                shl     rdx, 19h
                mov     rcx, rbp
                shl     rcx, 19h
                inc     edi
                sub     rdx, rcx
                sar     rdx, 10h
                cmp     edi, 3
                jb      short loc_140228A90
                jmp     loc_140228E67
; ---------------------------------------------------------------------------

loc_140228AB7:                          ; CODE XREF: sub_140227A20+F90↑j
                                        ; DATA XREF: .pdata:00000001400CB154↑o ...
                mov     rax, [r13+28h]
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                mov     r12, 0FFFFFA8000000000h
                lea     rbx, [rax+rax*2]
                shl     rbx, 4
                mov     rax, r12
                add     rbx, rax
                mov     [rsp+138h+var_CC], 0
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jnb     short loc_140228B0D

loc_140228AF1:                          ; CODE XREF: sub_140227A20+10E2↓j
                                        ; sub_140227A20+10EB↓j
                lea     rcx, [rsp+138h+var_CC]
                call    sub_1402C8C70
                mov     rax, [r13+18h]
                test    rax, rax
                js      short loc_140228AF1
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jb      short loc_140228AF1

loc_140228B0D:                          ; CODE XREF: sub_140227A20+10CF↑j
                xor     r8d, r8d
                lea     rcx, [r13+10h]
                lea     edx, [r8+1]
                call    sub_140338C90
                and     qword ptr [r13+10h], 0FFFFFFFFFFFFFFFDh
                mov     rax, 4000000000000000h
                or      [r13+18h], rax
                mov     rcx, r13
                call    sub_1402C5FA0
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax
                xor     edx, edx
                mov     rcx, rbx
                call    sub_140209CE0
                mov     rcx, [rsp+138h+arg_8]
                mov     ebx, 0C0000017h
                call    sub_14031B244
                xor     r11d, r11d
                mov     r10, 0FFFFF6FB7DBED7F8h
                mov     r14d, 1FFh
                jmp     loc_140228A49
; ---------------------------------------------------------------------------

loc_140228B7B:                          ; CODE XREF: sub_140227A20+1073↑j
                                        ; DATA XREF: .pdata:00000001400CB160↑o ...
                shr     r8, 12h
                and     r8d, 3FFFFFF8h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                mov     rdx, [r8+rax]
                lea     rdi, [r8+rax]
                mov     r15, 0FFFFF6FB7DBED000h
                mov     rax, r15
                cmp     rdi, rax
                jb      short loc_140228C10
                mov     rax, r10
                cmp     rdi, rax
                ja      short loc_140228C10
                call    sub_140349680
                test    eax, eax
                jz      short loc_140228C10
                test    dl, 1
                jz      short loc_140228C10
                test    dl, 20h
                jz      short loc_140228BCD
                test    dl, 42h
                jnz     short loc_140228C10

loc_140228BCD:                          ; CODE XREF: sub_140227A20+11A6↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140228C10
                shr     rdi, 3
                and     rdi, r14
                mov     rax, [rax+rdi*8]
                mov     rdi, rdx
                or      rdi, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdi, rdx
                mov     rdx, rdi
                test    al, 42h
                jz      short loc_140228C10
                or      rdx, 42h

loc_140228C10:                          ; CODE XREF: sub_140227A20+118B↑j
                                        ; sub_140227A20+1193↑j ...
                mov     [rsp+138h+var_B0], rdx
                mov     rax, r15
                lea     rcx, [rsp+138h+var_B0]
                cmp     rcx, rax
                jb      short loc_140228C9B
                mov     rax, r10
                lea     rcx, [rsp+138h+var_B0]
                cmp     rcx, rax
                ja      short loc_140228C9B
                call    sub_140349680
                test    eax, eax
                jz      short loc_140228C9B
                test    dl, 1
                jz      short loc_140228C9B
                test    dl, 20h
                jz      short loc_140228C50
                test    dl, 42h
                jnz     short loc_140228C9B

loc_140228C50:                          ; CODE XREF: sub_140227A20+1229↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rcx, [rcx+788h]
                test    rcx, rcx
                jz      short loc_140228C9B
                mov     rdi, rdx
                lea     rax, [rsp+138h+var_B0]
                shr     rax, 3
                or      rdi, 20h
                and     rax, r14
                mov     rax, [rcx+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdi, rdx
                mov     rdx, rdi
                test    al, 42h
                jz      short loc_140228C9B
                or      rdx, 42h

loc_140228C9B:                          ; CODE XREF: sub_140227A20+1206↑j
                                        ; sub_140227A20+1216↑j ...
                shr     rdx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax
                lea     rdi, [rdx+rdx*2]
                shl     rdi, 4
                mov     rax, r12
                add     rdi, rax
                mov     [rsp+138h+var_C8], r11d
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_140228CEC
                nop     dword ptr [rax+rax+00000000h]

loc_140228CD0:                          ; CODE XREF: sub_140227A20+12C1↓j
                                        ; sub_140227A20+12CA↓j
                lea     rcx, [rsp+138h+var_C8]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140228CD0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140228CD0

loc_140228CEC:                          ; CODE XREF: sub_140227A20+12A6↑j
                mov     rax, [rdi+10h]
                movzx   ecx, si
                shl     rcx, 10h
                add     rcx, rax
                xor     rcx, rax
                and     ecx, 3FF0000h
                xor     rcx, rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                mov     [rdi+10h], rcx
                lock and [rdi+18h], rax
                cmp     esi, 1
                ja      loc_140228E67
                mov     rcx, [rdi+8]
                mov     rax, 8000000000000000h
                or      rcx, rax
                mov     rax, rcx
                sar     rax, 2Fh
                inc     rax
                cmp     rax, 1
                ja      loc_140228E67
                shr     rcx, 9
                mov     rdx, 7FFFFFFFF8h
                and     rcx, rdx
                mov     rax, rbp
                add     rcx, rax
                mov     [rsp+138h+var_70], rcx
                shr     rcx, 9
                and     rcx, rdx
                mov     rax, rbp
                add     rcx, rax
                mov     [rsp+138h+var_68], rcx
                shr     rcx, 9
                and     rcx, rdx
                mov     rax, rbp
                add     rcx, rax
                mov     [rsp+138h+var_60], rcx
                shr     rcx, 9
                and     rcx, rdx
                mov     rax, rbp
                add     rcx, rax
                mov     r9, 0FFFFF6FB7DBED7F8h
                mov     [rsp+138h+var_58], rcx
                mov     r8d, 4
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140228DC0:                          ; CODE XREF: sub_140227A20+1441↓j
                mov     rdi, [rsp+r8*8+138h+var_78]
                dec     r8
                mov     rcx, [rdi]
                mov     rax, r15
                cmp     rdi, rax
                jb      short loc_140228E55
                mov     rax, r9
                cmp     rdi, rax
                ja      short loc_140228E55
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140228E55
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_140228E55
                test    cl, 1
                jz      short loc_140228E67
                test    cl, 20h
                jz      short loc_140228E12
                test    cl, 42h
                jnz     short loc_140228E55

loc_140228E12:                          ; CODE XREF: sub_140227A20+13EB↑j
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     rax, [rdx+788h]
                test    rax, rax
                jz      short loc_140228E55
                shr     rdi, 3
                and     rdi, r14
                mov     rax, [rax+rdi*8]
                mov     rdi, rcx
                or      rdi, 20h
                movzx   edx, al
                and     dl, 20h
                cmovz   rdi, rcx
                mov     rcx, rdi
                test    al, 42h
                jz      short loc_140228E55
                or      rcx, 42h

loc_140228E55:                          ; CODE XREF: sub_140227A20+13B4↑j
                                        ; sub_140227A20+13BC↑j ...
                test    cl, 1
                jz      short loc_140228E67
                test    cl, cl
                js      short loc_140228E67
                test    r8, r8
                jnz     loc_140228DC0

loc_140228E67:                          ; CODE XREF: sub_140227A20+1036↑j
                                        ; sub_140227A20+1045↑j ...
                mov     eax, ebx
                mov     rbx, [rsp+138h+var_38]
                add     rsp, 108h
                pop     r15
                pop     r14
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
algn_140228E82:                         ; DATA XREF: .pdata:00000001400CB16C↑o
                                        ; .pdata:00000001400CB178↑o ...
                align 10h
sub_140227A20   endp


; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_140228E90   proc near               ; CODE XREF: sub_140227A20+F89↑p
                                        ; sub_14022B420+150F↓p ...

var_60          = qword ptr -60h
var_50          = dword ptr -50h
var_4C          = dword ptr -4Ch
var_48          = qword ptr -48h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = qword ptr -30h
var_28          = xmmword ptr -28h
var_18          = xmmword ptr -18h
var_8           = qword ptr -8
arg_0           = qword ptr  40h
arg_8           = qword ptr  48h
arg_10          = qword ptr  50h
arg_18          = qword ptr  58h
arg_20          = qword ptr  60h
arg_28          = dword ptr  68h
arg_30          = qword ptr  70h

                mov     [rsp-38h+arg_18], rbx
                mov     [rsp-38h+arg_10], r8
                mov     [rsp-38h+arg_8], rdx
                mov     [rsp-38h+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                mov     rbp, rsp
                sub     rsp, 80h
                mov     esi, [rcx+0B8h]
                mov     r13d, r9d
                mov     rcx, rdx
                mov     rdx, 0FFFFF68000000000h
                shl     rcx, 19h
                mov     rax, rdx
                shl     rax, 19h
                sub     rcx, rax
                mov     [rbp+var_4C], 0
                sar     rcx, 10h
                mov     [rbp+var_48], rcx
                mov     rax, rdx
                mov     rdx, 0FFFFF6FFFFFFFFFFh
                mov     r15d, 1
                cmp     rcx, rax
                jb      short loc_140228F2E
                mov     rax, rdx
                cmp     rcx, rax
                ja      short loc_140228F2E
                xor     r9d, r9d
                mov     [rbp+var_30], r9
                test    sil, 7
                jnz     short loc_140228F39
                mov     rcx, [r8]
                movzx   eax, cl
                shr     al, 1
                test    al, 7
                jz      short loc_140228F39
                and     rcx, 0FFFFFFFFFFFFFFF1h
                mov     [r8], rcx
                jmp     short loc_140228F39
; ---------------------------------------------------------------------------

loc_140228F2E:                          ; CODE XREF: sub_140228E90+72↑j
                                        ; sub_140228E90+7A↑j
                mov     r9, r15
                mov     [rbp+var_30], r15
                mov     [rbp+var_4C], r15d

loc_140228F39:                          ; CODE XREF: sub_140228E90+87↑j
                                        ; sub_140228E90+93↑j ...
                mov     rax, gs:188h
                xor     r8b, r8b
                mov     [rbp+var_50], r8d
                mov     edx, [rax+518h]
                bt      edx, 8
                jnb     short loc_140228F5A
                shr     edx, 9
                jmp     short loc_140228F85
; ---------------------------------------------------------------------------

loc_140228F5A:                          ; CODE XREF: sub_140228E90+C3↑j
                mov     edx, [rax+510h]
                mov     rax, [rax+220h]
                shr     edx, 0Ch
                and     edx, 7
                test    dword ptr [rax+464h], 100000h
                jz      short loc_140228F85
                mov     eax, 2
                cmp     edx, eax
                cmovb   eax, edx
                mov     edx, eax

loc_140228F85:                          ; CODE XREF: sub_140228E90+C8↑j
                                        ; sub_140228E90+E7↑j
                mov     eax, [rbp+arg_28]
                and     edx, 7
                mov     rbx, [rbp+arg_20]
                mov     r12d, 5
                lea     edi, ds:0[rdx*8]
                test    r9, r9
                jnz     short loc_140228FB6
                cmp     edx, r12d
                mov     edi, r12d
                cmova   edi, edx
                xor     r13b, r13b
                lea     edi, ds:0[rdi*8]
                jmp     short loc_140228FF1
; ---------------------------------------------------------------------------

loc_140228FB6:                          ; CODE XREF: sub_140228E90+10F↑j
                test    al, 2
                jz      short loc_140228FBF
                mov     r8b, 9
                jmp     short loc_140228FE2
; ---------------------------------------------------------------------------

loc_140228FBF:                          ; CODE XREF: sub_140228E90+128↑j
                cmp     edx, r12d
                jnb     short loc_140228FC9
                mov     r8b, 7
                jmp     short loc_140228FE2
; ---------------------------------------------------------------------------

loc_140228FC9:                          ; CODE XREF: sub_140228E90+132↑j
                test    al, 8
                jz      short loc_140228FD2
                mov     r8b, 6
                jmp     short loc_140228FE2
; ---------------------------------------------------------------------------

loc_140228FD2:                          ; CODE XREF: sub_140228E90+13B↑j
                test    r15b, bl
                jz      short loc_140228FE6
                test    bl, 20h
                movzx   r8d, r8b
                cmovz   r8d, r15d

loc_140228FE2:                          ; CODE XREF: sub_140228E90+12D↑j
                                        ; sub_140228E90+137↑j ...
                mov     [rbp+var_50], r8d

loc_140228FE6:                          ; CODE XREF: sub_140228E90+145↑j
                and     r13b, 7
                shl     r13b, 4
                or      r13b, r8b

loc_140228FF1:                          ; CODE XREF: sub_140228E90+124↑j
                mov     rdx, 7FFFFFFFFFFFFFFFh
                test    r15b, al
                jz      loc_14022908D
                mov     r14, [rbp+arg_10]
                mov     [rbp+var_40], 0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jnb     short loc_14022903B
                nop     dword ptr [rax+rax+00000000h]

loc_140229020:                          ; CODE XREF: sub_140228E90+1A0↓j
                                        ; sub_140228E90+1A9↓j
                lea     rcx, [rbp+var_40]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_140229020
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_140229020

loc_14022903B:                          ; CODE XREF: sub_140228E90+186↑j
                mov     rbx, [rbp+arg_10]
                mov     rcx, rbx
                call    sub_14030320C
                mov     rdx, [rbx+28h]
                mov     rcx, cs:qword_140C4E4C8
                shr     rdx, 27h
                and     edx, 3FFh
                mov     rcx, [rcx+rdx*8]
                mov     rdx, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], rdx
                test    rax, rax
                jz      short loc_140229089
                mov     r8d, r15d
                mov     rdx, rax
                call    sub_14020B2C0
                mov     rdx, 7FFFFFFFFFFFFFFFh

loc_140229089:                          ; CODE XREF: sub_140228E90+1E2↑j
                mov     rbx, [rbp+arg_20]

loc_14022908D:                          ; CODE XREF: sub_140228E90+16E↑j
                mov     r14, [rbp+arg_10]
                movzx   eax, byte ptr [r14+23h]
                test    al, 8
                jnz     short loc_1402290A1
                mov     r12d, eax
                and     r12d, 7

loc_1402290A1:                          ; CODE XREF: sub_140228E90+208↑j
                mov     r15d, edi
                shr     r15d, 3
                cmp     r12d, r15d
                jnb     short loc_140229100
                mov     [rbp+var_3C], 0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jnb     short loc_1402290E5
                nop     dword ptr [rax]

loc_1402290C0:                          ; CODE XREF: sub_140228E90+240↓j
                                        ; sub_140228E90+249↓j
                lea     rcx, [rbp+var_3C]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_1402290C0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_1402290C0
                mov     rdx, 7FFFFFFFFFFFFFFFh

loc_1402290E5:                          ; CODE XREF: sub_140228E90+22B↑j
                movzx   eax, byte ptr [r14+23h]
                and     al, 0F8h
                or      al, r15b
                mov     [r14+23h], al
                lock and [r14+18h], rdx
                mov     rbx, [rbp+arg_20]
                mov     r14, [rbp+arg_10]

loc_140229100:                          ; CODE XREF: sub_140228E90+21B↑j
                test    byte ptr [r14], 1
                jnz     short loc_14022915A
                mov     [rbp+var_38], 0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jnb     short loc_14022913B

loc_140229116:                          ; CODE XREF: sub_140228E90+296↓j
                                        ; sub_140228E90+29F↓j
                lea     rcx, [rbp+var_38]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_140229116
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_140229116
                mov     rdx, 7FFFFFFFFFFFFFFFh

loc_14022913B:                          ; CODE XREF: sub_140228E90+284↑j
                mov     rcx, [rbp+arg_10]
                mov     rax, [rcx]
                test    al, 1
                jnz     short loc_14022914D
                or      rax, 1
                mov     [rcx], rax

loc_14022914D:                          ; CODE XREF: sub_140228E90+2B4↑j
                lock and [r14+18h], rdx
                mov     rbx, [rbp+arg_20]
                mov     r14, [rbp+arg_10]

loc_14022915A:                          ; CODE XREF: sub_140228E90+274↑j
                test    bl, 1
                jz      loc_140229499
                movzx   r15d, sil
                mov     rcx, 8000000000000000h
                and     r15b, 7
                cmp     r15b, 2
                jnz     loc_14022923D
                or      rbx, rcx
                mov     [rbp+arg_20], rbx

loc_140229186:                          ; CODE XREF: sub_140228E90+3B4↓j
                mov     r12, [rbp+var_48]

loc_14022918A:                          ; CODE XREF: sub_140228E90+3E0↓j
                                        ; sub_140228E90+3E9↓j ...
                test    cs:dword_140CFC400, 8000h
                jz      loc_14022930A
                test    byte ptr cs:dword_140CFC400+2, 1
                jz      loc_14022930A
                mov     rcx, r14
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14022930A
                mov     rax, [r14+28h]
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 3
                jnz     loc_14022930A
                cmp     r15b, 4
                jz      short loc_1402291D9
                cmp     r15b, 1
                jnz     loc_14022930A

loc_1402291D9:                          ; CODE XREF: sub_140228E90+33D↑j
                xorps   xmm0, xmm0
                lea     r8, [rbp+var_28]
                xor     edx, edx
                movups  [rbp+var_28], xmm0
                call    sub_14027B160
                test    al, 8
                jz      loc_14022930A
                mov     rax, 0FFFFFA8000000000h
                mov     rcx, r14
                mov     r8d, 400h
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rcx, rdx
                lea     rdx, [rbp+var_28]
                sar     rcx, 3
                mov     rax, rcx
                shr     rax, 3Fh
                add     rcx, rax
                call    sub_140512FD8
                test    eax, eax
                js      loc_140229564
                jmp     loc_14022930A
; ---------------------------------------------------------------------------

loc_14022923D:                          ; CODE XREF: sub_140228E90+2E9↑j
                test    byte ptr cs:dword_140CFC400+2, 1
                jz      loc_140229186
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                mov     r12, [rbp+var_48]
                cmp     r12, rax
                jb      short loc_140229276
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r12, rax
                jbe     loc_14022918A

loc_140229276:                          ; CODE XREF: sub_140228E90+3CE↑j
                test    rcx, rbx
                jnz     loc_14022918A
                test    cs:dword_140CFC400, 40000h
                jnz     short loc_140229294
                test    r15b, r15b
                jz      loc_14022918A

loc_140229294:                          ; CODE XREF: sub_140228E90+3F9↑j
                mov     [rbp+var_34], 0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jnb     short loc_1402292BF

loc_1402292A4:                          ; CODE XREF: sub_140228E90+424↓j
                                        ; sub_140228E90+42D↓j
                lea     rcx, [rbp+var_34]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_1402292A4
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_1402292A4

loc_1402292BF:                          ; CODE XREF: sub_140228E90+412↑j
                mov     rbx, [rbp+arg_10]
                xor     r8d, r8d
                mov     rcx, rbx
                lea     edx, [r8+1]
                call    sub_14027B160
                test    eax, eax
                jnz     short loc_1402292EE
                test    r15b, r15b
                mov     edx, 26h ; '&'
                mov     eax, 7
                mov     rcx, rbx
                cmovz   edx, eax
                call    sub_14034A1A4

loc_1402292EE:                          ; CODE XREF: sub_140228E90+444↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], rax
                mov     rbx, [rbp+arg_20]
                mov     r14, [rbp+arg_10]
                jmp     loc_14022918A
; ---------------------------------------------------------------------------

loc_14022930A:                          ; CODE XREF: sub_140228E90+304↑j
                                        ; sub_140228E90+311↑j ...
                mov     r11, [rbp+arg_30]
                test    r11, r11
                jz      short loc_14022935F
                mov     rdx, r12
                mov     rcx, r11
                call    sub_14054893C
                mov     r15, rax
                test    rax, rax
                jz      short loc_14022935F
                mov     edx, [r11+38h]
                test    dl, 20h
                jz      short loc_14022934A
                mov     rax, 1000000000h
                test    [r14+28h], rax
                jnz     short loc_14022934A
                mov     rcx, [r14+8]
                test    rcx, rcx
                js      short loc_14022934A
                jnz     short loc_14022935F

loc_14022934A:                          ; CODE XREF: sub_140228E90+49D↑j
                                        ; sub_140228E90+4AD↑j ...
                test    dl, 10h
                jz      short loc_140229362
                cmp     byte ptr [rbp+var_50], 6
                jnb     short loc_140229362
                and     r13b, 0F6h
                or      r13b, 6
                jmp     short loc_140229362
; ---------------------------------------------------------------------------

loc_14022935F:                          ; CODE XREF: sub_140228E90+481↑j
                                        ; sub_140228E90+494↑j ...
                xor     r15d, r15d

loc_140229362:                          ; CODE XREF: sub_140228E90+4BD↑j
                                        ; sub_140228E90+4C3↑j ...
                cmp     [rbp+var_30], 0
                jz      short loc_14022938E
                mov     rax, rbx
                movzx   ecx, r13b
                shl     rcx, 38h
                mov     rdx, 80FFFFFFFFFFFFFFh
                and     rax, rdx
                mov     rbx, rcx
                or      rbx, rax
                mov     [rbp+arg_20], rbx
                or      edi, 1

loc_14022938E:                          ; CODE XREF: sub_140228E90+4D7↑j
                mov     rdx, rbx
                mov     rax, 0FFFFF6FB7DBED000h
                mov     r8, [rbp+arg_8]
                cmp     r8, rax
                jb      short loc_14022941A
                mov     rax, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                ja      short loc_14022941A
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402293E4
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_1402293D7
                test    dl, 1
                jz      short loc_1402293D7
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_1402293D7:                          ; CODE XREF: sub_140228E90+533↑j
                                        ; sub_140228E90+538↑j
                mov     rcx, r8
                mov     [r8], rdx
                call    sub_140349620
                jmp     short loc_14022941D
; ---------------------------------------------------------------------------

loc_1402293E4:                          ; CODE XREF: sub_140228E90+52A↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140229412
                test    dl, 1
                jz      short loc_140229412
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_140229412:                          ; CODE XREF: sub_140228E90+56E↑j
                                        ; sub_140228E90+573↑j
                mov     r14, [rbp+arg_10]
                mov     rbx, [rbp+arg_20]

loc_14022941A:                          ; CODE XREF: sub_140228E90+512↑j
                                        ; sub_140228E90+521↑j
                mov     [r8], rdx

loc_14022941D:                          ; CODE XREF: sub_140228E90+552↑j
                test    r15, r15
                jz      short loc_14022949D
                mov     eax, [r11+38h]
                test    al, 1
                jz      short loc_14022942F
                test    bl, 42h
                jz      short loc_14022949D

loc_14022942F:                          ; CODE XREF: sub_140228E90+598↑j
                test    al, 2
                jz      short loc_140229442
                mov     rcx, 8000000000000000h
                test    rcx, rbx
                jnz     short loc_14022949D

loc_140229442:                          ; CODE XREF: sub_140228E90+5A1↑j
                or      edi, 4
                test    al, 20h
                jz      short loc_14022946C
                lea     r8, [r11+30h]
                lea     rdx, [rbp+arg_20]
                lea     rcx, [rbp+arg_10]
                call    sub_140548354
                mov     rbx, [rbp+arg_20]
                mov     r14, [rbp+arg_10]
                shl     eax, 2
                xor     eax, edi
                and     eax, 4
                xor     edi, eax

loc_14022946C:                          ; CODE XREF: sub_140228E90+5B7↑j
                test    dil, 4
                jz      short loc_14022949D
                lea     rcx, [rbp+arg_20]
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rdx, 0FFFFFFFFFh
                and     rdx, rax
                mov     r8, rbx
                mov     rcx, r15
                call    sub_1405486B4
                jmp     short loc_14022949D
; ---------------------------------------------------------------------------

loc_140229499:                          ; CODE XREF: sub_140228E90+2CD↑j
                mov     r12, [rbp+var_48]

loc_14022949D:                          ; CODE XREF: sub_140228E90+590↑j
                                        ; sub_140228E90+59D↑j ...
                mov     rdx, [rbp+var_30]
                test    rdx, rdx
                jz      short loc_1402294AF
                test    dil, 1
                jnz     short loc_1402294AF
                mov     [rdx], r13b

loc_1402294AF:                          ; CODE XREF: sub_140228E90+614↑j
                                        ; sub_140228E90+61A↑j
                mov     eax, [rbp+arg_28]
                test    al, 2
                jnz     short loc_1402294F4
                test    al, 4
                jnz     short loc_140229525
                mov     rcx, r14
                call    sub_1403F41D8
                mov     r9d, [rbp+var_4C]
                or      r9d, 2
                test    eax, eax
                cmovnz  r9d, [rbp+var_4C]
                test    rdx, rdx
                jnz     short loc_1402294DC
                test    sil, 7
                jnz     short loc_1402294E0

loc_1402294DC:                          ; CODE XREF: sub_140228E90+644↑j
                or      r9d, 4

loc_1402294E0:                          ; CODE XREF: sub_140228E90+64A↑j
                mov     rcx, [rbp+arg_0]
                mov     r8d, 1
                mov     rdx, r12
                call    sub_140229590
                jmp     short loc_140229525
; ---------------------------------------------------------------------------

loc_1402294F4:                          ; CODE XREF: sub_140228E90+624↑j
                mov     rcx, [rbp+arg_0]
                lea     rdx, [rbp+var_18]
                xorps   xmm0, xmm0
                xor     eax, eax
                movups  [rbp+var_18], xmm0
                mov     [rbp+var_8], rax
                call    sub_14054F980
                mov     rcx, [rbp+arg_0]
                mov     edx, 1
                call    sub_1405306E0
                lea     rcx, [rbp+var_18]
                call    sub_14054FAEC

loc_140229525:                          ; CODE XREF: sub_140228E90+628↑j
                                        ; sub_140228E90+662↑j
                test    dword ptr cs:xmmword_140CFC480+4, 8000001h
                jz      short loc_140229543
                movzx   edx, sil
                mov     r8, r12
                and     edx, 7
                mov     rcx, r14
                call    sub_140530708

loc_140229543:                          ; CODE XREF: sub_140228E90+69F↑j
                mov     rbx, [rsp+80h+arg_18]
                mov     eax, 1
                add     rsp, 80h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140229564:                          ; CODE XREF: sub_140228E90+3A2↑j
                movsxd  r9, eax
                mov     r8, r14
                mov     edx, 515E4h
                mov     [rsp+80h+var_60], 0
                mov     ecx, 1Ah
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_140228E90   endp

algn_140229583:                         ; DATA XREF: .pdata:00000001400CB184↑o
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_140229590   proc near               ; CODE XREF: sub_140228E90+65D↑p
                                        ; sub_14026F5D0+69↓p ...

var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = xmmword ptr -98h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = xmmword ptr -70h
var_60          = qword ptr -60h
var_58          = dword ptr -58h
var_38          = qword ptr -38h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 000000014042A4E2 SIZE 00000421 BYTES

; __unwind { // __GSHandlerCheck
                mov     [rsp-8+arg_18], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-27h]
                sub     rsp, 0B0h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+57h+var_38], rax
                movzx   eax, byte ptr [rcx+0B8h]
                xor     r10d, r10d
                and     al, 7
                mov     [rbp+57h+var_B0], r10
                mov     [rbp+57h+var_78], rdx
                mov     r15d, r9d
                mov     rsi, r8
                mov     r14, rdx
                mov     rdi, rcx
                cmp     al, 2
                jz      loc_140229B7A
                lea     rbx, [rcx+100h]

loc_1402295E9:                          ; CODE XREF: sub_140229590+5F1↓j
                mov     [rbp+57h+var_B8], rbx
                mov     [rbp+57h+var_C0], r10
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042A4E2

loc_14022960A:                          ; CODE XREF: sub_140229590+200F56↓j
                                        ; sub_140229590+200F65↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14042A508
                lea     rdx, [rbp+57h+var_C0]
                xchg    rdx, [rbx]
                test    rdx, rdx
                jnz     loc_140229E1D

loc_140229627:                          ; CODE XREF: sub_140229590+899↓j
                mov     edx, 1
                test    dl, r15b
                jz      short loc_1402296A6
                mov     rbx, [rdi+78h]
                add     rbx, rsi
                cmp     rbx, [rdi+70h]
                jbe     short loc_1402296A6
                test    byte ptr [rdi+0BBh], 8
                jnz     short loc_1402296A6
                mov     rax, [rdi+10h]
                mov     r8, [rdi+88h]
                mov     r9, [rax+20h]
                cmp     r8, r9
                jbe     short loc_140229699
                movzx   ecx, word ptr [rdi+0AEh]
                mov     r11, r8
                mov     rax, cs:qword_140C4E4C8
                mov     r13, [rax+rcx*8]
                mov     rcx, [r13+1B10h]
                and     r11d, 3Fh
                jz      loc_140229CD5
                lea     r12, [rdx-2]

loc_140229685:                          ; CODE XREF: sub_140229590+76B↓j
                                        ; sub_140229590+200F92↓j
                shr     rcx, 2
                sub     r8, r9
                lea     rax, [rcx+rcx*2]
                cmp     r8, rax
                jnb     loc_14042A52D

loc_140229699:                          ; CODE XREF: sub_140229590+C9↑j
                                        ; sub_140229590+200FE8↓j ...
                test    byte ptr [rdi+0B8h], 40h
                jnz     loc_140229C3A

loc_1402296A6:                          ; CODE XREF: sub_140229590+9F↑j
                                        ; sub_140229590+AC↑j ...
                movzx   eax, byte ptr [rdi+0B8h]
                add     [rdi+4], esi
                and     al, 7
                cmp     al, 2
                jz      loc_140229BB9

loc_1402296BA:                          ; CODE XREF: sub_140229590+62F↓j
                add     gs:2E90h, esi
                add     [rdi+88h], rsi
                mov     r13, 0FFFFF68000000000h
                mov     rax, r13
                mov     r11, 0FFFFF6FFFFFFFFFFh
                cmp     r14, rax
                jnb     loc_140229BF0

loc_1402296E9:                          ; CODE XREF: sub_140229590+666↓j
                add     [rdi+78h], rsi

loc_1402296ED:                          ; CODE XREF: sub_140229590+66F↓j
                mov     rcx, [rdi+78h]
                add     rcx, rsi
                cmp     rcx, [rdi+0A0h]
                ja      loc_1402299AB

loc_140229701:                          ; CODE XREF: sub_140229590+422↓j
                movzx   eax, byte ptr [rdi+0B8h]
                and     al, 7
                cmp     al, 2
                jz      loc_140229B86

loc_140229712:                          ; CODE XREF: sub_140229590+617↓j
                                        ; sub_140229590+624↓j
                test    r15b, 2
                jz      short loc_14022973F
                add     [rdi+90h], rsi
                xorps   xmm0, xmm0
                xor     eax, eax
                movups  [rbp+57h+var_70], xmm0
                mov     [rbp+57h+var_60], rax
                mov     rax, r13
                cmp     r14, rax
                jnb     loc_140229CC4

loc_140229738:                          ; CODE XREF: sub_140229590+740↓j
                add     [rdi+80h], rsi

loc_14022973F:                          ; CODE XREF: sub_140229590+186↑j
                                        ; sub_140229590+73A↓j
                movzx   r9d, byte ptr [rdi+0B8h]
                mov     rbx, 7FFFFFFFF8h
                movzx   eax, r9b
                and     al, 7
                cmp     al, 2
                jnb     loc_140229A38

loc_14022975F:                          ; CODE XREF: sub_140229590+4E7↓j
                                        ; sub_140229590+544↓j ...
                mov     r12, 0FFFFF6FB7DBED000h
                mov     r8, 0FFFFF6FB7DBED7F8h
                and     r15d, 4
                jz      loc_14022989C
                test    rsi, rsi
                jz      loc_14022989C

loc_140229786:                          ; CODE XREF: sub_140229590+567↓j
                mov     rax, r13
                cmp     r14, rax
                jnb     loc_140229AFC

loc_140229792:                          ; CODE XREF: sub_140229590+572↓j
                mov     rdx, r14
                shr     rdx, 9
                and     rdx, rbx
                mov     rax, r13
                add     rdx, rax
                mov     rbx, [rdx]
                mov     rax, r12
                cmp     rdx, rax
                jnb     loc_140229BC4

loc_1402297B1:                          ; CODE XREF: sub_140229590+63A↓j
                                        ; sub_140229590+201004↓j ...
                shr     rbx, 38h
                and     bl, 0Fh

loc_1402297B8:                          ; CODE XREF: sub_140229590+5CA↓j
                mov     rax, r13
                cmp     r14, rax
                jnb     loc_140229B5F

loc_1402297C4:                          ; CODE XREF: sub_140229590+5DF↓j
                mov     rdx, r14
                mov     rax, 0FFFFF6FB40000000h
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rax, rax
                add     rdx, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     r12, [rdx]
                mov     rax, rax
                cmp     rdx, rax
                jnb     loc_140229BD5

loc_1402297FA:                          ; CODE XREF: sub_140229590+655↓j
                                        ; sub_140229590+20109B↓j ...
                lea     rcx, [rbp+57h+var_A8]
                mov     [rbp+57h+var_A8], r12
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_14042A6BB

loc_14022980F:                          ; CODE XREF: sub_140229590+201135↓j
                                        ; sub_140229590+201152↓j ...
                mov     rax, 0FFFFFFFFFh
                shr     r12, 0Ch
                and     r12, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rdx, [r12+r12*2]
                shl     rdx, 4
                mov     rax, rax
                add     rdx, rax
                mov     r8, [rdx]
                mov     rax, r8
                mov     rcx, r8
                shr     rax, 0Eh
                and     al, 7
                shr     rcx, 4
                and     ecx, 3FFh
                jz      short loc_140229870
                cmp     bl, al
                jnz     loc_140229A12
                inc     ecx
                shl     rcx, 4
                xor     rcx, r8
                and     ecx, 3FF0h
                xor     rcx, r8
                mov     [rdx], rcx

loc_140229870:                          ; CODE XREF: sub_140229590+2C1↑j
                                        ; sub_140229590:loc_140229A12↓j ...
                movzx   eax, bl
                inc     qword ptr [rdi+rax*8+28h]
                cmp     bl, 7
                jz      loc_1402299B7

loc_140229881:                          ; CODE XREF: sub_140229590+47D↓j
                add     r14, 1000h
                mov     r12, 0FFFFF6FB7DBED000h
                sub     rsi, 1
                jnz     loc_140229AD9

loc_14022989C:                          ; CODE XREF: sub_140229590+1E7↑j
                                        ; sub_140229590+1F0↑j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14042A79B
                prefetchw byte ptr [rbp+57h+var_C0]
                mov     rax, [rbp+57h+var_C0]
                xor     ebx, ebx
                test    rax, rax
                jnz     loc_140229E0E
                mov     rcx, [rbp+57h+var_B8]
                lea     rax, [rbp+57h+var_C0]
                lock cmpxchg [rcx], rbx
                lea     rcx, [rbp+57h+var_C0]
                cmp     rax, rcx
                jnz     loc_140229E05

loc_1402298D6:                          ; CODE XREF: sub_140229590+888↓j
                                        ; sub_140229590+201219↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042A7AE

loc_1402298EF:                          ; CODE XREF: sub_140229590+201222↓j
                                        ; sub_140229590+201231↓j ...
                test    r15d, r15d
                jz      loc_140229983
                mov     rax, r13
                mov     rdi, [rbp+57h+var_78]
                cmp     rdi, rax
                jnb     loc_140229C04

loc_140229908:                          ; CODE XREF: sub_140229590+684↓j
                mov     rdx, rdi
                mov     rax, 0FFFFF6FB40000000h
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rax, rax
                add     rdx, rax
                mov     rbx, [rdx]
                mov     rax, r12
                cmp     rdx, rax
                jnb     loc_140229C1F

loc_140229934:                          ; CODE XREF: sub_140229590+69F↓j
                                        ; sub_140229590+20124C↓j ...
                lea     rcx, [rbp+57h+var_A0]
                mov     [rbp+57h+var_A0], rbx
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_14042A869

loc_140229949:                          ; CODE XREF: sub_140229590+2012E3↓j
                                        ; sub_140229590+201300↓j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rbx, [rbx+rbx*2]
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                mov     eax, [rbx]
                shr     rax, 4
                test    eax, 3FFh
                jz      loc_140229D15

loc_140229983:                          ; CODE XREF: sub_140229590+362↑j
                                        ; sub_140229590+68A↓j ...
                mov     rcx, [rbp+57h+var_38]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+0E0h+arg_18]
                add     rsp, 0B0h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402299AB:                          ; CODE XREF: sub_140229590+16B↑j
                mov     [rdi+0A0h], rcx
                jmp     loc_140229701
; ---------------------------------------------------------------------------

loc_1402299B7:                          ; CODE XREF: sub_140229590+2EB↑j
                movzx   ecx, word ptr [rdi+0AEh]
                xor     eax, eax
                mov     rdx, [rdi+60h]
                xorps   xmm0, xmm0
                mov     [rbp+57h+var_88], rax
                mov     rax, cs:qword_140C4E4C8
                movups  [rbp+57h+var_98], xmm0
                mov     r8, [rax+rcx*8]
                mov     r13, [r8+1AC0h]
                cmp     rdx, [r13+38h]
                jb      short loc_140229A03
                cmp     qword ptr [rdi+18h], 0
                lea     rbx, [rdi+18h]
                jz      short loc_140229A03
                lea     r12, [r8+1AC8h]
                cmp     [r12], rbx
                jnz     loc_140229C5B

loc_140229A03:                          ; CODE XREF: sub_140229590+455↑j
                                        ; sub_140229590+460↑j ...
                mov     r13, 0FFFFF68000000000h
                jmp     loc_140229881
; ---------------------------------------------------------------------------

loc_140229A12:                          ; CODE XREF: sub_140229590+2C5↑j
                jbe     loc_140229870
                movzx   eax, bl
                and     r8, 0FFFFFFFFFFFE001Fh
                and     eax, 7
                shl     rax, 0Eh
                or      rax, r8
                or      rax, 10h
                mov     [rdx], rax
                jmp     loc_140229870
; ---------------------------------------------------------------------------

loc_140229A38:                          ; CODE XREF: sub_140229590+1C9↑j
                mov     rax, cs:qword_140C4E4C8
                movzx   ecx, word ptr [rdi+0AEh]
                mov     r8, [rax+rcx*8]
                mov     eax, r9d
                and     eax, 7
                sub     eax, 2
                mov     r10, [r8+1100h]
                add     r10, [rdi+88h]
                cmp     r10, [r8+rax*8+1108h]
                ja      loc_140229D00

loc_140229A6F:                          ; CODE XREF: sub_140229590+780↓j
                and     r9b, 7
                cmp     r9b, 4
                jnz     loc_14022975F
                mov     rax, cs:qword_140CFC470
                test    rax, rax
                jz      short loc_140229A9F
                cmp     r14, rax
                jnb     loc_140229E2E

loc_140229A92:                          ; CODE XREF: sub_140229590+8A5↓j
                cmp     r14, cs:qword_140CFC648
                jb      loc_140229E46

loc_140229A9F:                          ; CODE XREF: sub_140229590+4F7↑j
                                        ; sub_140229590+8BD↓j
                mov     rcx, r14
                call    sub_140245330
                cmp     eax, 0Ch
                jnz     short loc_140229ACA
                mov     rcx, r14
                shr     rcx, 9
                and     rcx, rbx
                mov     rax, r13
                add     rcx, rax
                call    sub_140261B30
                test    rax, rax
                jnz     loc_140229EB8

loc_140229ACA:                          ; CODE XREF: sub_140229590+51A↑j
                                        ; sub_140229590+92E↓j
                mov     r11, 0FFFFF6FFFFFFFFFFh
                jmp     loc_14022975F
; ---------------------------------------------------------------------------

loc_140229AD9:                          ; CODE XREF: sub_140229590+306↑j
                mov     rbx, 7FFFFFFFF8h
                mov     r8, 0FFFFF6FB7DBED7F8h
                mov     r11, 0FFFFF6FFFFFFFFFFh
                jmp     loc_140229786
; ---------------------------------------------------------------------------

loc_140229AFC:                          ; CODE XREF: sub_140229590+1FC↑j
                mov     rax, r11
                cmp     r14, rax
                ja      loc_140229792
                mov     r12, r14
                shr     r12, 9
                and     r12, rbx
                mov     rax, r13
                add     r12, rax
                mov     rcx, r12
                mov     rbx, [r12]
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140229D72

loc_140229B2C:                          ; CODE XREF: sub_140229590+7EC↓j
                                        ; sub_140229590+809↓j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rbx, [rbx+rbx*2]
                add     rbx, rbx
                mov     rax, rax
                movzx   ebx, byte ptr [rax+rbx*8]
                shr     bl, 1
                and     bl, 7
                jmp     loc_1402297B8
; ---------------------------------------------------------------------------

loc_140229B5F:                          ; CODE XREF: sub_140229590+22E↑j
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r14, rax
                ja      loc_1402297C4
                jmp     loc_140229870
; ---------------------------------------------------------------------------

loc_140229B7A:                          ; CODE XREF: sub_140229590+4C↑j
                lea     rbx, unk_140C4F640
                jmp     loc_1402295E9
; ---------------------------------------------------------------------------

loc_140229B86:                          ; CODE XREF: sub_140229590+17C↑j
                add     cs:qword_140C4F688, rsi
                cmp     edx, 1
                jnz     short loc_140229B99
                add     cs:qword_140C4F690, rsi

loc_140229B99:                          ; CODE XREF: sub_140229590+600↑j
                mov     rax, cs:qword_140C4F690
                cmp     rax, cs:qword_140C4F698
                jbe     loc_140229712
                mov     cs:qword_140C4F698, rax
                jmp     loc_140229712
; ---------------------------------------------------------------------------

loc_140229BB9:                          ; CODE XREF: sub_140229590+124↑j
                add     cs:dword_140C4F680, esi
                jmp     loc_1402296BA
; ---------------------------------------------------------------------------

loc_140229BC4:                          ; CODE XREF: sub_140229590+21B↑j
                mov     rax, r8
                cmp     rdx, rax
                ja      loc_1402297B1
                jmp     loc_14042A58A
; ---------------------------------------------------------------------------

loc_140229BD5:                          ; CODE XREF: sub_140229590+264↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdx, rax
                ja      loc_1402297FA
                jmp     loc_14042A621
; ---------------------------------------------------------------------------

loc_140229BF0:                          ; CODE XREF: sub_140229590+153↑j
                mov     rax, r11
                cmp     r14, rax
                ja      loc_1402296E9
                mov     edx, r10d
                jmp     loc_1402296ED
; ---------------------------------------------------------------------------

loc_140229C04:                          ; CODE XREF: sub_140229590+372↑j
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rdi, rax
                ja      loc_140229908
                jmp     loc_140229983
; ---------------------------------------------------------------------------

loc_140229C1F:                          ; CODE XREF: sub_140229590+39E↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdx, rax
                ja      loc_140229934
                jmp     loc_14042A7D2
; ---------------------------------------------------------------------------

loc_140229C3A:                          ; CODE XREF: sub_140229590+110↑j
                cmp     rbx, [rdi+98h]
                jbe     loc_1402296A6

loc_140229C47:                          ; CODE XREF: sub_140229590+200F98↓j
                                        ; sub_140229590+200FE2↓j
                movzx   eax, byte ptr [rdi+0BBh]
                or      al, 8
                mov     [rdi+0BBh], al
                jmp     loc_1402296A6
; ---------------------------------------------------------------------------

loc_140229C5B:                          ; CODE XREF: sub_140229590+46D↑j
                xor     eax, eax
                lea     r8, qword_140C4ECC0
                mov     qword ptr [rbp+57h+var_98+8], r8
                mov     qword ptr [rbp+57h+var_98], rax
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042A758

loc_140229C85:                          ; CODE XREF: sub_140229590+2011CC↓j
                                        ; sub_140229590+2011DB↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14042A782
                lea     rdx, [rbp+57h+var_98]
                xchg    rdx, cs:qword_140C4ECC0
                test    rdx, rdx
                jnz     loc_140229EC3

loc_140229CA6:                          ; CODE XREF: sub_140229590+93C↓j
                                        ; sub_140229590+2011FF↓j
                cmp     byte ptr [r13+35h], 0
                jz      loc_140229E55

loc_140229CB1:                          ; CODE XREF: sub_140229590+8CB↓j
                lea     rcx, [rbp+57h+var_98]
                mov     byte ptr [r13+36h], 1
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                jmp     loc_140229A03
; ---------------------------------------------------------------------------

loc_140229CC4:                          ; CODE XREF: sub_140229590+1A2↑j
                mov     rax, r11
                cmp     r14, rax
                jbe     loc_14022973F
                jmp     loc_140229738
; ---------------------------------------------------------------------------

loc_140229CD5:                          ; CODE XREF: sub_140229590+EB↑j
                mov     r12, [r13+1BC0h]
                mov     rax, 0CCCCCCCCCCCCCCCDh
                mul     rcx
                shr     rdx, 4
                cmp     r12, rdx
                jb      loc_14042A51A
                mov     edx, 1
                jmp     loc_140229685
; ---------------------------------------------------------------------------

loc_140229D00:                          ; CODE XREF: sub_140229590+4D9↑j
                mov     [r8+rax*8+1108h], r10
                movzx   r9d, byte ptr [rdi+0B8h]
                jmp     loc_140229A6F
; ---------------------------------------------------------------------------

loc_140229D15:                          ; CODE XREF: sub_140229590+3ED↑j
                lea     r8, [rbp+57h+var_58]
                mov     rdx, rdi
                call    sub_1402FD640
                mov     cl, 8
                nop     dword ptr [rax+00h]
                nop     word ptr [rax+rax+00000000h]

loc_140229D30:                          ; CODE XREF: sub_140229590+7B0↓j
                add     cl, 0FFh
                movzx   eax, cl
                mov     edx, [rbp+rax*4+57h+var_58]
                test    edx, edx
                jnz     short loc_140229D47
                test    cl, cl
                jnz     short loc_140229D30
                jmp     loc_140229983
; ---------------------------------------------------------------------------

loc_140229D47:                          ; CODE XREF: sub_140229590+7AC↑j
                mov     rax, [rbx]
                and     edx, 3FFh
                movzx   ecx, cl
                and     rax, 0FFFFFFFFFFFE000Fh
                and     ecx, 7
                shl     rcx, 0Ah
                or      rcx, rdx
                shl     rcx, 4
                or      rcx, rax
                mov     [rbx], rcx
                jmp     loc_140229983
; ---------------------------------------------------------------------------

loc_140229D72:                          ; CODE XREF: sub_140229590+596↑j
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_140229B2C
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      loc_140229B2C
                test    bl, 1
                jz      loc_140229B2C
                test    bl, 20h
                jnz     loc_140229EAA

loc_140229DB1:                          ; CODE XREF: sub_140229590+923↓j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      loc_140229B2C
                shr     r12, 3
                mov     rdx, rbx
                and     r12d, 1FFh
                or      rdx, 20h
                mov     rax, [rax+r12*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      loc_140229B2C
                or      rbx, 42h
                jmp     loc_140229B2C
; ---------------------------------------------------------------------------

loc_140229E05:                          ; CODE XREF: sub_140229590+340↑j
                lea     rcx, [rbp+57h+var_C0]
                call    sub_140313680

loc_140229E0E:                          ; CODE XREF: sub_140229590+326↑j
                mov     [rbp+57h+var_C0], rbx
                lock xor qword ptr [rax+8], 1
                jmp     loc_1402298D6
; ---------------------------------------------------------------------------

loc_140229E1D:                          ; CODE XREF: sub_140229590+91↑j
                lea     rcx, [rbp+57h+var_C0]
                call    sub_14025FC20

loc_140229E26:                          ; CODE XREF: sub_140229590+200F85↓j
                xor     r10d, r10d
                jmp     loc_140229627
; ---------------------------------------------------------------------------

loc_140229E2E:                          ; CODE XREF: sub_140229590+4FC↑j
                cmp     r14, cs:qword_140CFC640
                jnb     loc_140229A92

loc_140229E3B:                          ; CODE XREF: sub_140229590+8C3↓j
                add     dword ptr cs:xmmword_140C4CBC8, esi
                jmp     loc_14022975F
; ---------------------------------------------------------------------------

loc_140229E46:                          ; CODE XREF: sub_140229590+509↑j
                cmp     r14, cs:qword_140CFC500
                jb      loc_140229A9F
                jmp     short loc_140229E3B
; ---------------------------------------------------------------------------

loc_140229E55:                          ; CODE XREF: sub_140229590+71B↑j
                mov     rax, [rbx]
                test    rax, rax
                jz      loc_140229CB1
                mov     rcx, [rbx+8]
                cmp     [rax+8], rbx
                jnz     loc_14042A794
                cmp     [rcx], rbx
                jnz     loc_14042A794
                mov     [rcx], rax
                mov     [rax+8], rcx
                mov     rax, [r12]
                cmp     [rax+8], r12
                jnz     loc_14042A794
                mov     [rbx], rax
                lea     rcx, [rbp+57h+var_98]
                mov     [rbx+8], r12
                mov     [rax+8], rbx
                mov     [r12], rbx
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                jmp     loc_140229A03
; ---------------------------------------------------------------------------

loc_140229EAA:                          ; CODE XREF: sub_140229590+81B↑j
                test    bl, 42h
                jnz     loc_140229B2C
                jmp     loc_140229DB1
; ---------------------------------------------------------------------------

loc_140229EB8:                          ; CODE XREF: sub_140229590+534↑j
                add     dword ptr cs:xmmword_140C4CBC8+4, esi
                jmp     loc_140229ACA
; ---------------------------------------------------------------------------

loc_140229EC3:                          ; CODE XREF: sub_140229590+710↑j
                lea     rcx, [rbp+57h+var_98]
                call    sub_14025FC20
                jmp     loc_140229CA6
; } // starts at 140229590
sub_140229590   endp

; ---------------------------------------------------------------------------
algn_140229ED1:                         ; DATA XREF: .rdata:0000000140053438↑o
                                        ; .pdata:00000001400CB190↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=130h

sub_140229EE0   proc near               ; CODE XREF: sub_1402272F0+6E3↑p
                                        ; sub_1402C3EA0+87↓p ...

var_230         = dword ptr -230h
var_210         = qword ptr -210h
var_208         = qword ptr -208h
var_200         = byte ptr -200h
var_1FC         = dword ptr -1FCh
var_1F8         = dword ptr -1F8h
var_1F4         = dword ptr -1F4h
var_1F0         = dword ptr -1F0h
var_1E8         = qword ptr -1E8h
var_1E0         = dword ptr -1E0h
var_1D8         = qword ptr -1D8h
var_1D0         = qword ptr -1D0h
var_1C8         = qword ptr -1C8h
var_1C0         = dword ptr -1C0h
var_1BC         = dword ptr -1BCh
var_1B8         = qword ptr -1B8h
var_1B0         = qword ptr -1B0h
var_1A8         = qword ptr -1A8h
var_1A0         = qword ptr -1A0h
var_198         = qword ptr -198h
var_190         = qword ptr -190h
var_188         = qword ptr -188h
var_180         = qword ptr -180h
var_178         = qword ptr -178h
var_170         = qword ptr -170h
var_160         = xmmword ptr -160h
var_150         = xmmword ptr -150h
var_140         = xmmword ptr -140h
var_130         = xmmword ptr -130h
var_120         = xmmword ptr -120h
var_110         = xmmword ptr -110h
var_100         = xmmword ptr -100h
var_F0          = xmmword ptr -0F0h
var_E0          = xmmword ptr -0E0h
var_D0          = qword ptr -0D0h
var_50          = qword ptr -50h
arg_20          = dword ptr  30h
arg_28          = qword ptr  38h
arg_30          = qword ptr  40h

; __unwind { // __GSHandlerCheck
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-0F8h]
                sub     rsp, 1F8h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+130h+var_50], rax
                mov     rsi, [rbp+130h+arg_30]
                xorps   xmm0, xmm0
                mov     [rbp+130h+var_170], rsi
                mov     edi, r9d
                movups  [rbp+130h+var_160], xmm0
                mov     [rsp+230h+var_1FC], r9d
                mov     r10, rdx
                movups  [rbp+130h+var_150], xmm0
                mov     [rbp+130h+var_188], rdx
                mov     r11, rcx
                movups  [rbp+130h+var_140], xmm0
                mov     [rsp+230h+var_1D8], rcx
                movups  [rbp+130h+var_130], xmm0
                movups  [rbp+130h+var_120], xmm0
                movups  [rbp+130h+var_110], xmm0
                movups  [rbp+130h+var_100], xmm0
                movups  [rbp+130h+var_F0], xmm0
                movups  [rbp+130h+var_E0], xmm0
                mov     r9, cr8
                mov     [rsp+230h+var_1D0], r9
                lea     rdx, cs:140000000h
                test    r8d, r8d
                jz      short loc_140229F83
                mov     rdx, gs:20h
                lea     ebx, [r8-1]
                movzx   ecx, cs:byte_140C4DD0C
                shl     ebx, cl
                jmp     short loc_140229FA0
; ---------------------------------------------------------------------------

loc_140229F83:                          ; CODE XREF: sub_140229EE0+89↑j
                mov     rax, gs:188h
                mov     ecx, [rax+24Ch]
                mov     rdx, ds:rva qword_140CFDCC0[rdx+rcx*8]
                mov     ebx, [rdx+7F18h]

loc_140229FA0:                          ; CODE XREF: sub_140229EE0+A1↑j
                movzx   ecx, cs:byte_140C4DD0D
                mov     r8d, 1
                shl     r8d, cl
                dec     r8d
                mov     [rsp+230h+var_1E0], ebx
                mov     [rsp+230h+var_1F4], r8d
                test    r10, r10
                jz      short loc_140229FD2
                movzx   eax, byte ptr [r10+0B8h]
                mov     rcx, r10
                and     al, 7
                cmp     al, 2
                jb      short loc_140229FD9

loc_140229FD2:                          ; CODE XREF: sub_140229EE0+DF↑j
                lea     rcx, [rdx+7F10h]

loc_140229FD9:                          ; CODE XREF: sub_140229EE0+F0↑j
                mov     rax, [rsi]
                xor     r10d, r10d
                mov     r14d, [rbp+130h+arg_20]
                mov     rdx, 0FFFFFFFFFh
                mov     rsi, [rbp+130h+arg_28]
                and     r14d, 0FFFFF0FFh
                mov     [rsp+230h+var_1B8], rcx
                mov     r12, rdx
                mov     [rsp+230h+var_1F8], r14d
                mov     r13d, r10d
                mov     [rsp+230h+var_1C8], rax
                mov     r15d, r10d
                mov     [rbp+130h+var_1A8], rdx
                mov     [rbp+130h+var_1A0], r10
                mov     [rsp+230h+var_1F0], r10d
                mov     [rsp+230h+var_1E8], r10
                cmp     rsi, 0FFFFFFFFFFFFFFFFh
                jz      short loc_14022A038
                bts     r14d, 0Eh
                jmp     loc_14022A2D7
; ---------------------------------------------------------------------------

loc_14022A038:                          ; CODE XREF: sub_140229EE0+14C↑j
                cmp     rax, 10h
                jb      loc_14022A2D7
                mov     edx, 1
                mov     dword ptr [rbp+130h+var_160+8], 10h
                mov     qword ptr [rbp+130h+var_160], rdx
                mov     r15d, edx
                mov     r14b, 11h
                mov     r10, rax
                jmp     short loc_14022A06A
; ---------------------------------------------------------------------------
                align 20h

loc_14022A060:                          ; CODE XREF: sub_140229EE0+38F↓j
                mov     r9, [rsp+230h+var_1D0]
                mov     edx, 1

loc_14022A06A:                          ; CODE XREF: sub_140229EE0+17B↑j
                mov     eax, edx
                lock xadd [rcx], eax
                and     eax, r8d
                or      ebx, eax
                cmp     r9b, 2
                jnb     short loc_14022A0CF
                mov     r14, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14022A0CF
                test    al, 1
                jz      short loc_14022A0CF
                cmp     r14b, 0Fh
                ja      short loc_14022A0CF
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r14b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     edx, 1
                mov     [r9+14h], r8d

loc_14022A0CF:                          ; CODE XREF: sub_140229EE0+199↑j
                                        ; sub_140229EE0+1B0↑j ...
                cmp     r10, 200h
                jb      short loc_14022A10A
                cmp     r15d, 1
                jnz     short loc_14022A10A
                lea     rax, [rbp+130h+var_160]
                mov     r9d, ebx
                mov     [rsp+230h+var_208], rax
                mov     r8d, edi
                mov     rcx, r11
                mov     dword ptr [rsp+230h+var_210], 4
                call    sub_1402DA06C
                mov     rsi, rax
                test    rax, rax
                jnz     short loc_14022A13B
                mov     r11, [rsp+230h+var_1D8]

loc_14022A10A:                          ; CODE XREF: sub_140229EE0+1F6↑j
                                        ; sub_140229EE0+1FC↑j
                mov     ecx, 2
                lea     rax, [rbp+130h+var_160]
                mov     r15d, ecx
                mov     [rsp+230h+var_208], rax
                mov     edx, ecx
                mov     dword ptr [rsp+230h+var_210], 4
                mov     rcx, r11
                mov     r9d, ebx
                mov     r8d, edi
                call    sub_1402DA06C
                mov     rsi, rax
                test    rax, rax
                jz      short loc_14022A15A

loc_14022A13B:                          ; CODE XREF: sub_140229EE0+223↑j
                xor     eax, eax
                mov     edx, r15d
                mov     [rsp+230h+var_208], rax
                mov     rcx, rsi
                mov     [rsp+230h+var_210], rax
                lea     r9d, [rax+1]
                lea     r8d, [rax+2]
                call    sub_1403F5644

loc_14022A15A:                          ; CODE XREF: sub_140229EE0+259↑j
                mov     rbx, [rsp+230h+var_1D0]
                cmp     bl, 2
                jnb     short loc_14022A1C6
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14022A1BE
                test    al, 1
                jz      short loc_14022A1BE
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14022A1BE
                cmp     r14b, 0Fh
                ja      short loc_14022A1BE
                cmp     al, 2
                jb      short loc_14022A1BE
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r14b
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14022A1BE
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14022A1BE:                          ; CODE XREF: sub_140229EE0+28C↑j
                                        ; sub_140229EE0+290↑j ...
                movzx   eax, r14b
                mov     cr8, rax

loc_14022A1C6:                          ; CODE XREF: sub_140229EE0+282↑j
                test    rsi, rsi
                jz      loc_14022A27A
                mov     r9, 0FFFFFA8000000000h
                mov     rax, r9
                mov     rcx, rsi
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                lea     rcx, cs:140000000h
                lea     rbx, rva qword_14001A848[rcx]
                mov     rdi, rdx
                sar     rdi, 3
                mov     rax, rdi
                shr     rax, 3Fh
                add     rdi, rax
                mov     eax, r15d
                mov     rcx, [rbx+rax*8]
                lea     rbx, [rbx+rax*8]
                add     rcx, rdi
                lea     r8, [rcx+rcx*2]
                shl     r8, 4
                mov     rax, r9
                lea     rcx, [rax-30h]
                mov     rdx, r12
                add     rcx, r8
                xor     r8d, r8d
                call    sub_14026B590
                mov     rax, [rsp+230h+var_1E8]
                mov     r12, rdi
                add     rax, [rbx]
                mov     r13, rsi
                mov     r10, [rsp+230h+var_1C8]
                mov     edi, [rsp+230h+var_1FC]
                sub     r10, rax
                mov     rcx, [rsp+230h+var_1B8]
                mov     r11, [rsp+230h+var_1D8]
                mov     r8d, [rsp+230h+var_1F4]
                mov     ebx, [rsp+230h+var_1E0]
                mov     [rsp+230h+var_1E8], rax
                cmp     r10, 10h
                jnb     loc_14022A060
                mov     rbx, [rsp+230h+var_1D0]

loc_14022A27A:                          ; CODE XREF: sub_140229EE0+2E9↑j
                cmp     dword ptr [rbp+130h+var_160+4], 0
                mov     [rbp+130h+var_1A8], r12
                jz      short loc_14022A28D
                lea     rcx, [rbp+130h+var_160]
                call    sub_14055FFC4

loc_14022A28D:                          ; CODE XREF: sub_140229EE0+3A2↑j
                cmp     bl, 2
                jb      short loc_14022A2B7
                mov     rcx, [rbp+130h+var_188]
                call    sub_14029A5E0
                test    eax, eax
                jnz     loc_14022AC15
                call    KeShouldYieldProcessor
                mov     r15, [rsp+230h+var_1E8]
                test    eax, eax
                jnz     loc_14022AC1A
                jmp     short loc_14022A2BC
; ---------------------------------------------------------------------------

loc_14022A2B7:                          ; CODE XREF: sub_140229EE0+3B0↑j
                mov     r15, [rsp+230h+var_1E8]

loc_14022A2BC:                          ; CODE XREF: sub_140229EE0+3D5↑j
                mov     rax, [rsp+230h+var_1C8]
                mov     r8d, [rsp+230h+var_1F4]
                mov     r11, [rsp+230h+var_1D8]
                mov     r14d, [rsp+230h+var_1F8]
                mov     rsi, [rbp+130h+arg_28]

loc_14022A2D7:                          ; CODE XREF: sub_140229EE0+153↑j
                                        ; sub_140229EE0+15C↑j
                cmp     r15, rax
                jnb     loc_14022AC1A
                movsxd  rax, edi
                mov     [rbp+130h+var_180], rax
                nop     word ptr [rax+rax+00000000h]

loc_14022A2F0:                          ; CODE XREF: sub_140229EE0+D30↓j
                mov     rcx, [rsp+230h+var_1B8]
                mov     eax, 1
                lock xadd [rcx], eax
                mov     ebx, [rsp+230h+var_1E0]
                and     eax, r8d
                or      ebx, eax
                cmp     rsi, 0FFFFFFFFFFFFFFFFh
                jz      short loc_14022A35C
                mov     eax, cs:dword_140C4DD78
                mov     edi, 0Fh
                cmp     rax, rdi
                mov     r8d, r14d
                mov     rcx, r11
                cmovb   edi, eax
                and     ebx, 0FFFFFFF0h
                and     rsi, rdi
                or      ebx, esi
                mov     edx, ebx
                call    sub_14022ACA0
                mov     [rbp+130h+var_1B0], rax
                mov     r12, rax
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jnz     short loc_14022A345
                btr     r14d, 0Eh

loc_14022A345:                          ; CODE XREF: sub_140229EE0+45E↑j
                inc     rsi
                and     rsi, rdi
                mov     edi, [rsp+230h+var_1FC]
                mov     [rbp+130h+arg_28], rsi
                cmp     r12, 0FFFFFFFFFFFFFFFFh
                jnz     short loc_14022A37C

loc_14022A35C:                          ; CODE XREF: sub_140229EE0+42B↑j
                mov     rcx, [rsp+230h+var_1D8]
                mov     r8d, r14d
                mov     edx, ebx
                call    sub_14022ACA0
                mov     [rbp+130h+var_1B0], rax
                mov     r12, rax
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jz      loc_14022AC1A

loc_14022A37C:                          ; CODE XREF: sub_140229EE0+47A↑j
                mov     eax, r14d
                lea     r13, [r12+r12*2]
                bts     eax, 0Eh
                cmp     rsi, 0FFFFFFFFFFFFFFFFh
                cmovz   eax, r14d
                shl     r13, 4
                mov     [rsp+230h+var_1F8], eax
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                add     r13, rax
                mov     ebx, 1
                movzx   r14d, byte ptr [r13+22h]
                shr     r14d, 6
                mov     [rsp+230h+var_1C0], r14d
                cmp     r14d, edi
                jz      short loc_14022A40C
                mov     ecx, r14d
                mov     eax, ebx
                shl     al, cl
                movzx   ecx, al
                bts     ecx, edi
                test    cs:byte_140C4DE58, cl
                jz      short loc_14022A40C
                mov     r10d, [rsp+230h+var_1F0]
                mov     [rbp+r10*8+130h+var_D0], r12
                inc     r10d
                mov     [rsp+230h+var_1F0], r10d
                cmp     r10d, 10h
                jnz     loc_14022AA1C
                mov     r8d, edi
                lea     rcx, [rbp+130h+var_D0]
                mov     edx, r10d
                call    sub_14054F518
                mov     [rsp+230h+var_1F0], 0
                jmp     loc_14022AA1C
; ---------------------------------------------------------------------------

loc_14022A40C:                          ; CODE XREF: sub_140229EE0+4DD↑j
                                        ; sub_140229EE0+4F2↑j
                mov     eax, [r13+10h]
                test    rax, 3E0h
                jz      loc_14022A9A1
                test    [rbp+130h+arg_20], 100h
                jz      loc_14022A9A1
                mov     rcx, [rbp+130h+var_180]
                lea     rax, cs:140000000h
                lea     rdi, [r13+22h]
                mov     [rbp+130h+var_198], rdi
                lea     rcx, [rcx+r14*4]
                mov     r15d, rva dword_140C4DE18[rax+rcx*4]
                mov     [rsp+230h+var_1BC], r15d
                cmp     r15d, r14d
                jz      short loc_14022A463
                xor     r8d, r8d
                mov     edx, r15d
                mov     rcx, r13
                call    sub_14031F848

loc_14022A463:                          ; CODE XREF: sub_140229EE0+573↑j
                mov     rax, gs:20h
                xor     esi, esi
                cmp     [rax+8200h], rsi
                jnz     loc_14022A56C
                mov     edx, ebx
                lea     rcx, qword_140C4EDC0
                call    sub_1402583E0
                mov     rsi, rax
                test    rax, rax
                jz      loc_14022A56C
                mov     rdx, r13
                mov     ecx, 4
                call    sub_1402994FC
                or      eax, 0A0000000h
                mov     rdx, r12
                mov     r8d, eax
                mov     rcx, rsi
                call    sub_140280E60
                mov     rcx, rsi
                mov     rbx, rax
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14022A526
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022A4F8
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022A4E8
                test    bl, 1
                jz      short loc_14022A4E8
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022A4E8:                          ; CODE XREF: sub_140229EE0+5F4↑j
                                        ; sub_140229EE0+5F9↑j
                mov     rdx, rbx
                mov     [rsi], rbx
                mov     rcx, rsi
                call    sub_140349620
                jmp     short loc_14022A529
; ---------------------------------------------------------------------------

loc_14022A4F8:                          ; CODE XREF: sub_140229EE0+5EB↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022A526
                test    bl, 1
                jz      short loc_14022A526
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022A526:                          ; CODE XREF: sub_140229EE0+5E2↑j
                                        ; sub_140229EE0+632↑j ...
                mov     [rsi], rbx

loc_14022A529:                          ; CODE XREF: sub_140229EE0+616↑j
                mov     rcx, rsi
                mov     rax, 0FFFFF68000000000h
                shl     rcx, 19h
                mov     rax, rax
                shl     rax, 19h
                mov     edx, 1000h
                sub     rcx, rax
                sar     rcx, 10h
                call    sub_1404023E0
                mov     r8d, 1
                lea     rcx, qword_140C4EDC0
                mov     rdx, rsi
                call    sub_14025EFB0
                jmp     loc_14022A910
; ---------------------------------------------------------------------------

loc_14022A56C:                          ; CODE XREF: sub_140229EE0+595↑j
                                        ; sub_140229EE0+5AF↑j
                mov     rax, gs:20h
                mov     [rsp+230h+var_200], 11h
                cmp     qword ptr [rax+8200h], 0
                mov     rax, gs:20h
                cmovnz  rsi, rbx
                xor     r15d, r15d
                mov     [rbp+130h+var_178], rsi
                mov     rax, [rax+8200h]
                mov     [rbp+130h+var_190], rax

loc_14022A5A1:                          ; CODE XREF: sub_140229EE0+A18↓j
                test    rax, rax
                jz      loc_14022A772
                movzx   eax, byte ptr [rdi]
                mov     r8d, 4
                shr     eax, 6
                test    eax, eax
                jz      short loc_14022A5CA
                cmp     eax, 3
                jz      short loc_14022A5CA
                cmp     eax, 2
                jnz     short loc_14022A5D0
                lea     r8d, [rax+1Ah]
                jmp     short loc_14022A5D0
; ---------------------------------------------------------------------------

loc_14022A5CA:                          ; CODE XREF: sub_140229EE0+6D8↑j
                                        ; sub_140229EE0+6DD↑j
                mov     r8d, 0Ch

loc_14022A5D0:                          ; CODE XREF: sub_140229EE0+6E2↑j
                                        ; sub_140229EE0+6E8↑j
                or      r8d, 0A0000000h
                mov     rdx, r12
                xor     ecx, ecx
                call    sub_140280E60
                mov     rbx, rax
                mov     r10, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14022A633
                test    al, 1
                jz      short loc_14022A633
                cmp     r10b, 0Fh
                ja      short loc_14022A633
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r10b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_14022A633:                          ; CODE XREF: sub_140229EE0+719↑j
                                        ; sub_140229EE0+71D↑j ...
                mov     rsi, gs:20h
                mov     [rsp+230h+var_200], r10b
                mov     rdi, [rsi+7FF8h]
                test    rdi, rdi
                jz      short loc_14022A697
                xor     r9d, r9d
                lea     rcx, [rdi+30A0h]
                lea     edx, [r9+3]
                lea     r8d, [r9+1]
                call    sub_140292240
                mov     r8, rax
                mov     r14, rax
                mov     rax, 7FFFFFFFF8h
                shr     r8, 9
                and     r8, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     r8, rax
                mov     [rdi+3038h], r8
                test    r14, r14
                jnz     short loc_14022A6D9

loc_14022A697:                          ; CODE XREF: sub_140229EE0+76B↑j
                mov     r14, [rsi+8200h]
                mov     rax, r14
                and     r14d, 0FFFh
                and     rax, 0FFFFFFFFFFFFF000h
                shl     r14, 0Ch
                add     r14, rax
                mov     rax, 7FFFFFFFF8h
                mov     r8, r14
                shr     r8, 9
                and     r8, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     r8, rax

loc_14022A6D9:                          ; CODE XREF: sub_140229EE0+7B5↑j
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r8, rax
                jb      short loc_14022A766
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r8, rax
                ja      short loc_14022A766
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022A738
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022A721
                test    bl, 1
                jz      short loc_14022A721
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022A721:                          ; CODE XREF: sub_140229EE0+82D↑j
                                        ; sub_140229EE0+832↑j
                mov     rdx, rbx
                mov     [r8], rbx
                mov     rcx, r8
                call    sub_140349620
                mov     rdi, [rbp+130h+var_198]
                jmp     loc_14022A82C
; ---------------------------------------------------------------------------

loc_14022A738:                          ; CODE XREF: sub_140229EE0+824↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022A766
                test    bl, 1
                jz      short loc_14022A766
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022A766:                          ; CODE XREF: sub_140229EE0+809↑j
                                        ; sub_140229EE0+81B↑j ...
                mov     rdi, [rbp+130h+var_198]
                mov     [r8], rbx
                jmp     loc_14022A82C
; ---------------------------------------------------------------------------

loc_14022A772:                          ; CODE XREF: sub_140229EE0+6C4↑j
                call    sub_140A5962C
                mov     r14, rax
                test    rax, rax
                jz      loc_14022AC7C
                mov     r15, rax
                mov     rax, 7FFFFFFFF8h
                shr     r15, 9
                and     r15, rax
                mov     rax, 0FFFFF68000000000h
                mov     rcx, rax
                add     r15, rcx
                mov     r8d, 0A0000004h
                mov     rcx, r15
                mov     rdx, r12
                call    sub_140280E60
                mov     rcx, r15
                mov     rbx, rax
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14022A829
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022A7FB
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022A7EB
                test    bl, 1
                jz      short loc_14022A7EB
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022A7EB:                          ; CODE XREF: sub_140229EE0+8F7↑j
                                        ; sub_140229EE0+8FC↑j
                mov     rdx, rbx
                mov     [r15], rbx
                mov     rcx, r15
                call    sub_140349620
                jmp     short loc_14022A82C
; ---------------------------------------------------------------------------

loc_14022A7FB:                          ; CODE XREF: sub_140229EE0+8EE↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022A829
                test    bl, 1
                jz      short loc_14022A829
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022A829:                          ; CODE XREF: sub_140229EE0+8E5↑j
                                        ; sub_140229EE0+935↑j ...
                mov     [r15], rbx

loc_14022A82C:                          ; CODE XREF: sub_140229EE0+853↑j
                                        ; sub_140229EE0+88D↑j ...
                mov     edx, 1000h
                mov     rcx, r14
                call    sub_1404023E0
                cmp     [rbp+130h+var_190], 0
                jz      short loc_14022A858
                movzx   edx, [rsp+230h+var_200]
                mov     r8d, 80000000h
                mov     rcx, r14
                call    sub_1402432B0
                jmp     loc_14022A8DE
; ---------------------------------------------------------------------------

loc_14022A858:                          ; CODE XREF: sub_140229EE0+95E↑j
                mov     rbx, cs:qword_14001D278
                mov     rcx, r15
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14022A8CD
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022A89F
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022A88F
                test    bl, 1
                jz      short loc_14022A88F
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022A88F:                          ; CODE XREF: sub_140229EE0+99B↑j
                                        ; sub_140229EE0+9A0↑j
                mov     rdx, rbx
                mov     [r15], rbx
                mov     rcx, r15
                call    sub_140349620
                jmp     short loc_14022A8D0
; ---------------------------------------------------------------------------

loc_14022A89F:                          ; CODE XREF: sub_140229EE0+992↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022A8CD
                test    bl, 1
                jz      short loc_14022A8CD
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022A8CD:                          ; CODE XREF: sub_140229EE0+989↑j
                                        ; sub_140229EE0+9D9↑j ...
                mov     [r15], rbx

loc_14022A8D0:                          ; CODE XREF: sub_140229EE0+9BD↑j
                xor     edx, edx
                mov     rcx, r14
                lea     r8d, [rdx+1]
                call    ?_Getint@?$time_get@_WV?$istreambuf_iterator@_WU?$char_traits@_W@std@@@std@@@std@@AEBAHAEAV?$istreambuf_iterator@_WU?$char_traits@_W@std@@@2@0HHAEAH@Z ; std::time_get<wchar_t,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>>>::_Getint(std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,int,int,int &)

loc_14022A8DE:                          ; CODE XREF: sub_140229EE0+973↑j
                inc     r12
                add     rdi, 30h ; '0'
                mov     rax, r12
                mov     [rbp+130h+var_198], rdi
                sub     rax, [rbp+130h+var_1B0]
                cmp     rax, 1
                mov     rax, [rbp+130h+var_190]
                jb      loc_14022A5A1
                mov     rsi, [rbp+130h+var_178]
                mov     r14d, [rsp+230h+var_1C0]
                mov     r15d, [rsp+230h+var_1BC]
                mov     r12, [rbp+130h+var_1B0]

loc_14022A910:                          ; CODE XREF: sub_140229EE0+687↑j
                mov     edi, [rsp+230h+var_1FC]
                cmp     r15d, r14d
                jz      short loc_14022A931
                cmp     r15d, edi
                jz      short loc_14022A931
                test    rsi, rsi
                jz      short loc_14022A931
                xor     r8d, r8d
                mov     edx, r14d
                mov     rcx, r13
                call    sub_14031F848

loc_14022A931:                          ; CODE XREF: sub_140229EE0+A37↑j
                                        ; sub_140229EE0+A3C↑j ...
                and     qword ptr [r13+10h], 0FFFFFFFFFFFFFC1Fh
                lock or [rsp+230h+var_230], 0
                mov     r9d, cs:dword_140D23080
                mov     rbx, 0F0FFFFFFFFFFFFFFh
                mov     rdx, [r13+18h]
                and     r9d, 0Fh
                mov     rcx, rdx
                shl     r9, 38h
                and     rcx, rbx
                mov     rax, rdx
                or      rcx, r9
                lock cmpxchg [r13+18h], rcx
                mov     r8, rax
                cmp     rdx, rax
                jz      short loc_14022A99A
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_14022A980:                          ; CODE XREF: sub_140229EE0+AB8↓j
                mov     rcx, r8
                and     r8, rbx
                or      r8, r9
                mov     rax, rcx
                lock cmpxchg [r13+18h], r8
                mov     r8, rax
                cmp     rcx, rax
                jnz     short loc_14022A980

loc_14022A99A:                          ; CODE XREF: sub_140229EE0+A93↑j
                mov     r15, [rsp+230h+var_1E8]
                jmp     short loc_14022A9AB
; ---------------------------------------------------------------------------

loc_14022A9A1:                          ; CODE XREF: sub_140229EE0+536↑j
                                        ; sub_140229EE0+546↑j
                mov     rbx, 0F0FFFFFFFFFFFFFFh

loc_14022A9AB:                          ; CODE XREF: sub_140229EE0+ABF↑j
                movzx   eax, byte ptr [r13+22h]
                shr     eax, 6
                cmp     eax, edi
                jz      short loc_14022A9D9
                cmp     eax, 1
                jz      loc_14022AB2D
                cmp     eax, 3
                jnz     loc_14022AAFE

loc_14022A9C9:                          ; CODE XREF: sub_140229EE0+C39↓j
                                        ; sub_140229EE0+C47↓j
                mov     r8d, 4
                mov     edx, edi
                mov     rcx, r13
                call    sub_14031F848

loc_14022A9D9:                          ; CODE XREF: sub_140229EE0+AD5↑j
                mov     rdx, [r13+18h]
                mov     rcx, rdx
                mov     rax, rdx
                and     rcx, rbx
                lock cmpxchg [r13+18h], rcx
                mov     r8, rax
                cmp     rdx, rax
                jz      short loc_14022AA17
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_14022AA00:                          ; CODE XREF: sub_140229EE0+B35↓j
                mov     rcx, r8
                and     r8, rbx
                mov     rax, rcx
                lock cmpxchg [r13+18h], r8
                mov     r8, rax
                cmp     rcx, rax
                jnz     short loc_14022AA00

loc_14022AA17:                          ; CODE XREF: sub_140229EE0+B12↑j
                                        ; sub_140229EE0+C75↓j
                mov     ebx, 1

loc_14022AA1C:                          ; CODE XREF: sub_140229EE0+50A↑j
                                        ; sub_140229EE0+527↑j
                mov     rdx, [r13+18h]
                mov     rax, 0FFFFFFFFFh
                mov     r9, [rbp+130h+var_1A8]
                mov     rcx, rdx
                and     r9, rax
                mov     r10, 0FFFFFFF000000000h
                and     rcx, r10
                mov     rax, rdx
                or      rcx, r9
                lock cmpxchg [r13+18h], rcx
                mov     r8, rax
                cmp     rdx, rax
                jz      short loc_14022AA7A
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_14022AA60:                          ; CODE XREF: sub_140229EE0+B98↓j
                mov     rcx, r8
                and     r8, r10
                or      r8, r9
                mov     rax, rcx
                lock cmpxchg [r13+18h], r8
                mov     r8, rax
                cmp     rcx, rax
                jnz     short loc_14022AA60

loc_14022AA7A:                          ; CODE XREF: sub_140229EE0+B73↑j
                inc     r15
                mov     [rbp+130h+var_1A8], r12
                cmp     byte ptr [rsp+230h+var_1D0], 2
                mov     [rsp+230h+var_1E8], r15
                jb      loc_14022ABF3
                mov     r10, [rbp+130h+var_188]
                movzx   eax, byte ptr [r10+0B8h]
                and     al, 7
                cmp     al, 2
                lea     rax, unk_140C4F600
                jz      short loc_14022AAB1
                lea     rax, [r10+0C0h]

loc_14022AAB1:                          ; CODE XREF: sub_140229EE0+BC8↑j
                mov     eax, [rax]
                bt      eax, 1Eh
                jb      loc_14022AC1A
                mov     rcx, gs:20h
                mov     r8d, [rcx+312Ch]
                mov     edi, [rcx+7BECh]
                mov     esi, [rcx+7E9Ch]
                test    r8b, 1
                jz      short loc_14022AB5A
                mov     edx, ebx
                cmp     esi, 7
                jbe     loc_14022AB8F
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jz      loc_14022AB98
                jmp     loc_14022ABD3
; ---------------------------------------------------------------------------

loc_14022AAFE:                          ; CODE XREF: sub_140229EE0+AE3↑j
                movzx   ecx, byte ptr [r13+1Fh]
                and     ecx, 0Fh
                lock or [rsp+230h+var_230], 0
                mov     eax, cs:dword_140D23080
                sub     eax, ecx
                and     eax, 0Fh
                cmp     eax, 2
                ja      loc_14022A9C9
                test    cl, 1
                jnz     short loc_14022AB2D
                cmp     eax, 2
                jnb     loc_14022A9C9

loc_14022AB2D:                          ; CODE XREF: sub_140229EE0+ADA↑j
                                        ; sub_140229EE0+C42↑j
                mov     eax, [r13+10h]
                test    rax, 3E0h
                jz      short loc_14022AB49
                mov     r8d, edi
                mov     edx, 1
                mov     rcx, r12
                call    sub_1402E5704

loc_14022AB49:                          ; CODE XREF: sub_140229EE0+C57↑j
                mov     rax, [rbp+130h+var_1A0]
                mov     [r13+10h], rax
                mov     [rbp+130h+var_1A0], r13
                jmp     loc_14022AA17
; ---------------------------------------------------------------------------

loc_14022AB5A:                          ; CODE XREF: sub_140229EE0+BFD↑j
                xor     edx, edx
                test    r8b, 1Eh
                jz      short loc_14022AB67
                lea     ebx, [rdx+2]
                jmp     short loc_14022ABD3
; ---------------------------------------------------------------------------

loc_14022AB67:                          ; CODE XREF: sub_140229EE0+C80↑j
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jz      short loc_14022AB79
                mov     ebx, 3
                jmp     short loc_14022ABD3
; ---------------------------------------------------------------------------

loc_14022AB79:                          ; CODE XREF: sub_140229EE0+C90↑j
                mov     rax, [rcx+10h]
                test    rax, rax
                jz      short loc_14022AB8F
                cmp     rax, [rcx+8]
                jz      short loc_14022AB8F
                mov     ebx, 4
                jmp     short loc_14022ABD3
; ---------------------------------------------------------------------------

loc_14022AB8F:                          ; CODE XREF: sub_140229EE0+C04↑j
                                        ; sub_140229EE0+CA0↑j ...
                cmp     edi, 7
                jbe     short loc_14022ABEF
                test    edx, edx
                jz      short loc_14022ABB6

loc_14022AB98:                          ; CODE XREF: sub_140229EE0+C13↑j
                test    r8b, 1Eh
                jz      short loc_14022ABA5
                mov     ebx, 5
                jmp     short loc_14022ABD3
; ---------------------------------------------------------------------------

loc_14022ABA5:                          ; CODE XREF: sub_140229EE0+CBC↑j
                mov     rax, [rcx+18h]
                cmp     [rcx+8], rax
                jz      short loc_14022ABB6
                mov     ebx, 6
                jmp     short loc_14022ABD3
; ---------------------------------------------------------------------------

loc_14022ABB6:                          ; CODE XREF: sub_140229EE0+CB6↑j
                                        ; sub_140229EE0+CCD↑j
                cli
                mov     dword ptr [rcx+7BECh], 0
                mov     dword ptr [rcx+7E9Ch], 0
                call    sub_140326178
                sti
                xor     ebx, ebx

loc_14022ABD3:                          ; CODE XREF: sub_140229EE0+C19↑j
                                        ; sub_140229EE0+C85↑j ...
                test    dword ptr cs:xmmword_140CFC480+4, 4000000h
                jz      short loc_14022ABEB
                mov     r8d, esi
                mov     edx, edi
                mov     ecx, ebx
                call    sub_1405A83BC

loc_14022ABEB:                          ; CODE XREF: sub_140229EE0+CFD↑j
                test    ebx, ebx
                jnz     short loc_14022AC1A

loc_14022ABEF:                          ; CODE XREF: sub_140229EE0+CB2↑j
                mov     edi, [rsp+230h+var_1FC]

loc_14022ABF3:                          ; CODE XREF: sub_140229EE0+BAB↑j
                cmp     r15, [rsp+230h+var_1C8]
                jnb     short loc_14022AC1A
                mov     rsi, [rbp+130h+arg_28]
                mov     r14d, [rsp+230h+var_1F8]
                mov     r11, [rsp+230h+var_1D8]
                mov     r8d, [rsp+230h+var_1F4]
                jmp     loc_14022A2F0
; ---------------------------------------------------------------------------

loc_14022AC15:                          ; CODE XREF: sub_140229EE0+3BD↑j
                mov     r15, [rsp+230h+var_1E8]

loc_14022AC1A:                          ; CODE XREF: sub_140229EE0+3CF↑j
                                        ; sub_140229EE0+3FA↑j ...
                mov     rax, [rbp+130h+var_170]
                mov     ebx, [rsp+230h+var_1FC]
                mov     [rax], r15
                mov     eax, [rsp+230h+var_1F0]
                test    eax, eax
                jz      short loc_14022AC3B
                mov     r8d, ebx
                lea     rcx, [rbp+130h+var_D0]
                mov     edx, eax
                call    sub_14054F518

loc_14022AC3B:                          ; CODE XREF: sub_140229EE0+D4B↑j
                mov     rax, [rbp+130h+var_1A0]
                test    rax, rax
                jz      short loc_14022AC55
                mov     r8, cs:qword_14001D278
                mov     edx, ebx
                mov     rcx, rax
                call    sub_1402D6454

loc_14022AC55:                          ; CODE XREF: sub_140229EE0+D62↑j
                mov     rax, r13
                mov     rcx, [rbp+130h+var_50]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 1F8h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14022AC7C:                          ; CODE XREF: sub_140229EE0+89D↑j
                xor     r9d, r9d
                mov     [rsp+230h+var_210], 0
                mov     r8, r12
                mov     edx, 3030305h
                lea     ecx, [r9+1Ah]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140229EE0
sub_140229EE0   endp

algn_14022AC9A:                         ; DATA XREF: .pdata:00000001400CB19C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14022ACA0   proc near               ; CODE XREF: sub_140229EE0+44E↑p
                                        ; sub_140229EE0+486↑p ...

var_B8          = qword ptr -0B8h
var_A8          = dword ptr -0A8h
var_A4          = dword ptr -0A4h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = dword ptr -88h
var_84          = byte ptr -84h
var_83          = byte ptr -83h
var_80          = dword ptr -80h
var_7C          = dword ptr -7Ch
var_78          = dword ptr -78h
var_70          = qword ptr -70h
var_68          = xmmword ptr -68h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 000000014042A904 SIZE 000007A8 BYTES

                mov     [rsp+arg_10], rbx
                mov     [rsp+arg_8], edx
                mov     [rsp+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 0A0h
                mov     r10d, cs:dword_140CFB004
                lea     r11, qword_14000A820
                mov     r14, rcx
                mov     [rsp+0D8h+var_78], r10d
                movzx   ecx, cs:byte_140C4DD0C
                mov     ebx, edx
                shr     ebx, cl
                xor     esi, esi
                xor     r9d, r9d
                mov     r15d, 1
                xor     r13d, r13d
                mov     [rsp+0D8h+var_88], r15d
                mov     [rsp+0D8h+var_A8], r13d
                mov     ebp, r8d
                mov     r12d, edx
                mov     edi, ebx

loc_14022AD01:                          ; CODE XREF: sub_14022ACA0+20027C↓j
                mov     [rsp+0D8h+var_90], r9

loc_14022AD06:                          ; CODE XREF: sub_14022ACA0+200251↓j
                mov     eax, edi
                imul    rdx, rax, 11C0h
                add     rdx, [r14+10h]
                cmp     qword ptr [rdx+1050h], 0
                jz      loc_14022B325

loc_14022AD21:                          ; CODE XREF: sub_14022ACA0+68C↓j
                cmp     r10d, r15d
                ja      loc_14042A920

loc_14022AD2A:                          ; CODE XREF: sub_14022ACA0+1FFC8E↓j
                                        ; sub_14022ACA0+1FFD28↓j
                mov     eax, r10d
                mov     r8d, ebp
                add     rax, r9
                and     r8d, 2
                mov     [rsp+0D8h+var_40], rax
                mov     [rsp+0D8h+var_80], r8d

loc_14022AD44:                          ; CODE XREF: sub_14022ACA0+200216↓j
                test    r9, r9
                jnz     loc_14042A9CD
                mov     ecx, [rsp+0D8h+arg_8]

loc_14022AD54:                          ; CODE XREF: sub_14022ACA0+1FFD5B↓j
                test    r8d, r8d
                mov     edx, ecx
                lea     r12, qword_14000A818
                mov     r8d, ecx
                cmovz   r12, r11
                mov     [rsp+0D8h+var_48], r8
                shl     rdx, 4
                mov     [rsp+0D8h+var_50], rdx
                mov     r13d, [r12]

loc_14022AD7F:                          ; CODE XREF: sub_14022ACA0+1FFD63↓j
                movsxd  rax, r13d
                mov     rcx, [r14+rax*8+1068h]
                add     rcx, rdx
                cmp     word ptr [rcx], 0
                jz      loc_14022AF35
                call    ExpInterlockedPopEntrySList
                mov     r14, rax
                test    rax, rax
                jz      loc_14022AF25
                mov     rax, cs:qword_14001D278
                mov     [r14+10h], rax
                test    r13d, r13d
                jnz     loc_14022B0AB
                mov     eax, cs:dword_140CFC400
                test    al, al
                js      loc_14042AA08

loc_14022ADCA:                          ; CODE XREF: sub_14022ACA0+43F↓j
                                        ; sub_14022ACA0+1FFD7C↓j ...
                mov     qword ptr [r14], 0

loc_14022ADD1:                          ; CODE XREF: sub_14022ACA0+2F8↓j
                                        ; sub_14022ACA0+200019↓j
                mov     r13, [rsp+0D8h+arg_0]

loc_14022ADD9:                          ; CODE XREF: sub_14022ACA0+62F↓j
                                        ; sub_14022ACA0+64B↓j
                cmp     r14, r15
                jz      loc_14022B367
                test    r14, r14
                jz      loc_14022AF9D

loc_14022ADEB:                          ; CODE XREF: sub_14022ACA0+3AD↓j
                                        ; sub_14022ACA0+3DB↓j ...
                mov     r13d, [rsp+0D8h+var_A8]

loc_14022ADF0:                          ; CODE XREF: sub_14022ACA0+2002DC↓j
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                mov     qword ptr [r14], 0
                mov     rcx, r14
                sub     rcx, rax
                mov     r8, 2AAAAAAAAAAAAAABh
                mov     rax, r8
                imul    rcx
                movsxd  rcx, cs:dword_140C4DD04
                mov     rdi, rdx
                mov     edx, cs:dword_140C4DD08
                sar     rdi, 3
                mov     rax, rdi
                shr     rax, 3Fh
                add     rdi, rax
                cmp     ecx, edx
                ja      loc_14022AED9
                mov     rax, rcx
                shl     rax, 4
                add     rax, cs:qword_140C4DD48
                cmp     rdi, [rax]
                jb      loc_14022AED9
                cmp     ecx, edx
                jnz     short loc_14022AED3

loc_14022AE5B:                          ; CODE XREF: sub_14022ACA0+237↓j
                                        ; sub_14022ACA0+487↓j
                cmp     [rax+8], ebx
                jnz     loc_14042AFD1
                cmp     cs:qword_140C4DD50, 0
                jnz     loc_14042AFAC
                xor     eax, eax

loc_14022AE74:                          ; CODE XREF: sub_14022ACA0+20031E↓j
                cmp     eax, r13d
                jnz     loc_14042AFC3

loc_14022AE7D:                          ; CODE XREF: sub_14022ACA0+200329↓j
                                        ; sub_14022ACA0+200338↓j ...
                bt      ebp, 9
                jb      short loc_14022AEA0
                bt      ebp, 0Ah
                jb      loc_14042B086
                bt      ebp, 0Bh
                mov     r15d, 3
                mov     ecx, 2
                cmovb   r15d, ecx

loc_14022AEA0:                          ; CODE XREF: sub_14022ACA0+1E1↑j
                                        ; sub_14022ACA0+2003E9↓j
                bt      ebp, 8
                jb      loc_14022B2F0

loc_14022AEAA:                          ; CODE XREF: sub_14022ACA0+65D↓j
                                        ; sub_14022ACA0+680↓j
                cmp     r15d, 3
                jnz     loc_14022B12C

loc_14022AEB4:                          ; CODE XREF: sub_14022ACA0+497↓j
                                        ; sub_14022ACA0+4AB↓j
                mov     rax, rdi

loc_14022AEB7:                          ; CODE XREF: sub_14022ACA0+6CE↓j
                mov     rbx, [rsp+0D8h+arg_10]
                add     rsp, 0A0h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022AED3:                          ; CODE XREF: sub_14022ACA0+1B9↑j
                cmp     rdi, [rax+10h]
                jb      short loc_14022AE5B

loc_14022AED9:                          ; CODE XREF: sub_14022ACA0+19A↑j
                                        ; sub_14022ACA0+1B1↑j
                xor     r8d, r8d
                test    edx, edx
                js      loc_14042B08E

loc_14022AEE4:                          ; CODE XREF: sub_14022ACA0+27E↓j
                lea     ecx, [r8+rdx]
                sar     ecx, 1
                movsxd  rax, ecx
                shl     rax, 4
                add     rax, cs:qword_140C4DD48
                cmp     rdi, [rax]
                jb      loc_14042AF81
                cmp     ecx, cs:dword_140C4DD08
                jz      loc_14022B117
                cmp     rdi, [rax+10h]
                jb      loc_14022B117
                lea     r8d, [rcx+1]

loc_14022AF1B:                          ; CODE XREF: sub_14022ACA0+2002E8↓j
                cmp     edx, r8d
                jge     short loc_14022AEE4
                jmp     loc_14042B08E
; ---------------------------------------------------------------------------

loc_14022AF25:                          ; CODE XREF: sub_14022ACA0+102↑j
                mov     rdx, [rsp+0D8h+var_50]
                mov     r14, [rsp+0D8h+arg_0]

loc_14022AF35:                          ; CODE XREF: sub_14022ACA0+F1↑j
                mov     eax, [r12+4]
                cmp     r13d, eax
                jnz     loc_14042AA00
                movsxd  rdx, dword ptr [r12]
                xorps   xmm0, xmm0
                mov     rax, [rsp+0D8h+var_48]
                mov     [rsp+0D8h+arg_18], edx
                movups  [rsp+0D8h+var_68], xmm0
                mov     rcx, [r14+rdx*8+880h]
                lea     rax, [rax+rax*4]
                mov     r12, [rcx+rax*8+10h]
                lea     r13, [rcx+rax*8]
                xor     eax, eax
                mov     [rsp+0D8h+var_70], r13
                mov     [rsp+0D8h+var_58], rax
                mov     rax, 0FFFFFFFFFh
                cmp     r12, rax
                jnz     loc_14022B19E

loc_14022AF95:                          ; CODE XREF: sub_14022ACA0+6A7↓j
                                        ; sub_14022ACA0+70E↓j ...
                xor     r14d, r14d
                jmp     loc_14022ADD1
; ---------------------------------------------------------------------------

loc_14022AF9D:                          ; CODE XREF: sub_14022ACA0+145↑j
                mov     r12, [rsp+0D8h+var_50]
                lea     rdx, qword_14000A818
                mov     eax, ebp
                mov     r8d, ebp
                or      eax, 2
                and     r8d, 0FFFFFFFDh
                cmp     [rsp+0D8h+var_80], 0
                cmovz   r8d, eax
                lea     rax, qword_14000A820
                test    r8b, 2
                mov     [rsp+0D8h+var_A4], r8d
                cmovz   rdx, rax
                mov     [rsp+0D8h+var_70], rdx
                mov     eax, [rdx]

loc_14022AFDC:                          ; CODE XREF: sub_14022ACA0+4BA↓j
                mov     [rsp+0D8h+arg_18], eax
                cdqe
                mov     rcx, [r13+rax*8+1068h]
                add     rcx, r12
                cmp     word ptr [rcx], 0
                jz      loc_14022B150
                call    ExpInterlockedPopEntrySList
                mov     r14, rax
                test    rax, rax
                jz      loc_14042AE03
                cmp     [rsp+0D8h+arg_18], 0
                mov     rax, cs:qword_14001D278
                mov     [r14+10h], rax
                jnz     loc_14022B0E4
                mov     eax, cs:dword_140CFC400
                test    al, al
                js      loc_14042AE0D

loc_14022B032:                          ; CODE XREF: sub_14022ACA0+472↓j
                                        ; sub_14022ACA0+200181↓j ...
                mov     r12d, [rsp+0D8h+arg_8]
                mov     qword ptr [r14], 0

loc_14022B041:                          ; CODE XREF: sub_14022ACA0+4F9↓j
                cmp     r14, r15
                jz      loc_14022B367
                test    r14, r14
                jnz     loc_14022ADEB
                mov     edx, r12d
                mov     rcx, r13
                call    sub_14026C480
                mov     r8d, ebp
                mov     edx, r12d
                mov     rcx, r13
                call    sub_1402E4D4C
                mov     r14, rax
                cmp     rax, r15
                jz      loc_14022B367
                test    rax, rax
                jnz     loc_14022ADEB
                mov     r8d, [rsp+0D8h+var_A4]
                mov     edx, r12d
                mov     rcx, r13
                call    sub_1402E4D4C
                mov     r14, rax
                cmp     rax, r15
                jz      loc_14022B367
                test    rax, rax
                jnz     loc_14022ADEB
                jmp     loc_14042AE7B
; ---------------------------------------------------------------------------

loc_14022B0AB:                          ; CODE XREF: sub_14022ACA0+116↑j
                test    rax, rax
                jnz     loc_14042AA6B
                mov     rcx, cs:qword_140C4DDC0
                mov     eax, 80h
                test    rcx, rcx
                jz      short loc_14022B0DB
                mov     rax, rcx
                and     eax, 80h
                jnz     loc_14042AA61
                mov     rax, rcx

loc_14022B0D6:                          ; CODE XREF: sub_14022ACA0+1FFDD1↓j
                bts     rax, 7

loc_14022B0DB:                          ; CODE XREF: sub_14022ACA0+423↑j
                                        ; sub_14022ACA0+1FFDC6↓j
                mov     [r14+10h], rax
                jmp     loc_14022ADCA
; ---------------------------------------------------------------------------

loc_14022B0E4:                          ; CODE XREF: sub_14022ACA0+37E↑j
                test    rax, rax
                jnz     loc_14042AE70
                mov     rcx, cs:qword_140C4DDC0
                mov     eax, 80h
                test    rcx, rcx
                jz      short loc_14022B10E
                test    cl, cl
                js      loc_14042AE66
                mov     rax, rcx

loc_14022B109:                          ; CODE XREF: sub_14022ACA0+2001D6↓j
                bts     rax, 7

loc_14022B10E:                          ; CODE XREF: sub_14022ACA0+45C↑j
                                        ; sub_14022ACA0+2001CB↓j
                mov     [r14+10h], rax
                jmp     loc_14022B032
; ---------------------------------------------------------------------------

loc_14022B117:                          ; CODE XREF: sub_14022ACA0+267↑j
                                        ; sub_14022ACA0+271↑j
                mov     cs:dword_140C4DD04, ecx
                mov     r8, 2AAAAAAAAAAAAAABh
                jmp     loc_14022AE5B
; ---------------------------------------------------------------------------

loc_14022B12C:                          ; CODE XREF: sub_14022ACA0+20E↑j
                movzx   eax, byte ptr [r14+22h]
                shr     eax, 6
                cmp     eax, r15d
                jz      loc_14022AEB4
                xor     r8d, r8d
                mov     edx, r15d
                mov     rcx, r14
                call    sub_14031F848
                jmp     loc_14022AEB4
; ---------------------------------------------------------------------------

loc_14022B150:                          ; CODE XREF: sub_14022ACA0+354↑j
                                        ; sub_14022ACA0+200168↓j
                mov     eax, [rdx+4]
                cmp     [rsp+0D8h+arg_18], eax
                jnz     loc_14022AFDC
                movsxd  r9, dword ptr [rdx]
                mov     rax, [rsp+0D8h+var_48]
                mov     r12d, [rsp+0D8h+arg_8]
                mov     r8d, r12d
                mov     rcx, [r13+r9*8+880h]
                lea     rax, [rax+rax*4]
                lea     rdx, [rcx+rax*8]
                mov     eax, [rsp+0D8h+var_A4]
                mov     rcx, r13
                mov     dword ptr [rsp+0D8h+var_B8], eax
                call    sub_1402E42D0
                mov     r14, rax
                jmp     loc_14022B041
; ---------------------------------------------------------------------------

loc_14022B19E:                          ; CODE XREF: sub_14022ACA0+2EF↑j
                mov     ecx, ebp
                and     ecx, r15d
                mov     [rsp+0D8h+var_A4], ecx

loc_14022B1A7:                          ; CODE XREF: sub_14022ACA0+718↓j
                lea     r14, [r12+r12*2]
                mov     rax, 0FFFFFA8000000000h
                shl     r14, 4
                mov     rax, rax
                add     r14, rax
                test    ecx, ecx
                jnz     loc_14022B337
                mov     r11, cr8
                mov     [rsp+0D8h+var_98], r11
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042AA76

loc_14022B1E7:                          ; CODE XREF: sub_14022ACA0+1FFDD9↓j
                                        ; sub_14022ACA0+1FFDE3↓j ...
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                lea     rcx, [r14+18h]
                setb    al
                mov     [rsp+0D8h+var_A0], rcx
                bt      ebp, 0Eh
                jb      loc_14042AAC3
                mov     [rsp+0D8h+var_A0], rcx
                test    al, al
                jnz     loc_14022B3FA

loc_14022B211:                          ; CODE XREF: sub_14022ACA0+6B5↓j
                                        ; sub_14022ACA0+1FFE2D↓j ...
                movzx   eax, byte ptr [r14+22h]
                and     eax, 7
                cmp     eax, edx
                jnz     loc_14022B373
                mov     qword ptr [rsp+0D8h+var_68], 0
                lea     rdx, [r13+20h]
                mov     qword ptr [rsp+0D8h+var_68+8], rdx
                lea     rcx, [rsp+0D8h+var_68]
                bt      ebp, 0Eh
                jb      loc_14042AB7F
                call    sub_1402E44F4
                test    eax, eax
                jz      loc_14022B3BD

loc_14022B24F:                          ; CODE XREF: sub_14022ACA0+1FFEE5↓j
                cmp     r12, [r13+10h]
                jnz     loc_14042AB8A
                mov     r8d, ebp
                mov     rdx, r13
                mov     rcx, r12
                call    sub_140293F00
                test    eax, eax
                jz      loc_14042AC21
                mov     rax, [rsp+0D8h+var_A0]
                mov     rcx, 7FFFFFFFFFFFFFFFh
                lock and [rax], rcx
                cmp     [rsp+0D8h+var_A4], 0
                jnz     loc_14022B35A
                mov     rax, 0FFFFFFFFFh
                cmp     [r13+10h], rax
                mov     r13, [rsp+0D8h+arg_0]
                jz      short loc_14022B2BC
                mov     r8d, [rsp+0D8h+arg_8]
                mov     rcx, r13
                mov     edx, [rsp+0D8h+arg_18]
                call    sub_14026BE30

loc_14022B2BC:                          ; CODE XREF: sub_14022ACA0+603↑j
                                        ; sub_14022ACA0+6C2↓j
                lea     rcx, [rsp+0D8h+var_68]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     r12, [rsp+0D8h+var_98]
                cmp     r12b, 11h
                jz      loc_14022ADD9
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042ACBE

loc_14022B2E3:                          ; CODE XREF: sub_14022ACA0+200021↓j
                                        ; sub_14022ACA0+20002D↓j ...
                movzx   eax, r12b
                mov     cr8, rax
                jmp     loc_14022ADD9
; ---------------------------------------------------------------------------

loc_14022B2F0:                          ; CODE XREF: sub_14022ACA0+204↑j
                mov     edx, r15d
                mov     rcx, r14
                call    sub_1402966A0
                test    eax, eax
                jz      loc_14022AEAA
                shr     ebp, 0Fh
                mov     r8d, r15d
                not     ebp
                mov     rcx, rdi
                and     ebp, 1
                mov     edx, ebp
                call    sub_1402E5704
                and     qword ptr [r14+10h], 0FFFFFFFFFFFFFC1Fh
                jmp     loc_14022AEAA
; ---------------------------------------------------------------------------

loc_14022B325:                          ; CODE XREF: sub_14022ACA0+7B↑j
                cmp     cs:dword_140C4C058, 0
                jz      loc_14022AD21
                jmp     loc_14042A904
; ---------------------------------------------------------------------------

loc_14022B337:                          ; CODE XREF: sub_14022ACA0+521↑j
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                lea     rcx, [r14+18h]
                mov     [rsp+0D8h+var_A0], rcx
                jb      loc_14022AF95
                mov     r11b, 11h
                mov     [rsp+0D8h+var_98], r11
                jmp     loc_14022B211
; ---------------------------------------------------------------------------

loc_14022B35A:                          ; CODE XREF: sub_14022ACA0+5E7↑j
                mov     r13, [rsp+0D8h+arg_0]
                jmp     loc_14022B2BC
; ---------------------------------------------------------------------------

loc_14022B367:                          ; CODE XREF: sub_14022ACA0+13C↑j
                                        ; sub_14022ACA0+3A4↑j ...
                mov     rax, 0FFFFFFFFFFFFFFFFh
                jmp     loc_14022AEB7
; ---------------------------------------------------------------------------

loc_14022B373:                          ; CODE XREF: sub_14022ACA0+57B↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rcx], rax
                cmp     r11b, 11h
                jz      short loc_14022B39D
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042AB0D

loc_14022B395:                          ; CODE XREF: sub_14022ACA0+1FFE70↓j
                                        ; sub_14022ACA0+1FFE7C↓j ...
                movzx   eax, r11b
                mov     cr8, rax

loc_14022B39D:                          ; CODE XREF: sub_14022ACA0+6E5↑j
                                        ; sub_14022ACA0+1FFF7C↓j
                mov     r12, [r13+10h]
                mov     rax, 0FFFFFFFFFh
                cmp     r12, rax
                jz      loc_14022AF95
                mov     ecx, [rsp+0D8h+var_A4]
                jmp     loc_14022B1A7
; ---------------------------------------------------------------------------

loc_14022B3BD:                          ; CODE XREF: sub_14022ACA0+5A9↑j
                mov     rax, [rsp+0D8h+var_A0]
                mov     rcx, 7FFFFFFFFFFFFFFFh
                lock and [rax], rcx
                mov     r12, [rsp+0D8h+var_98]
                cmp     r12b, 11h
                jz      loc_14022AF95
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042AD29

loc_14022B3ED:                          ; CODE XREF: sub_14022ACA0+20008C↓j
                                        ; sub_14022ACA0+200098↓j ...
                movzx   eax, r12b
                mov     cr8, rax
                jmp     loc_14022AF95
; ---------------------------------------------------------------------------

loc_14022B3FA:                          ; CODE XREF: sub_14022ACA0+56B↑j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042AD94

loc_14022B408:                          ; CODE XREF: sub_14022ACA0+2000F7↓j
                                        ; sub_14022ACA0+200103↓j ...
                movzx   eax, r11b
                mov     cr8, rax
                jmp     loc_14022AF95
sub_14022ACA0   endp

; ---------------------------------------------------------------------------
algn_14022B415:                         ; DATA XREF: .rdata:000000014005348C↑o
                                        ; .pdata:00000001400CB1A8↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=40h

sub_14022B420   proc near               ; CODE XREF: sub_140226D20+32C↑p
                                        ; sub_14022CA60+BB1↓p ...

var_120         = qword ptr -120h
var_118         = dword ptr -118h
var_110         = qword ptr -110h
var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = dword ptr -0D0h
var_C8          = qword ptr -0C8h
var_C0          = dword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
arg_0           = qword ptr  10h
arg_8           = qword ptr  18h
arg_10          = qword ptr  20h
arg_18          = dword ptr  28h
arg_20          = qword ptr  30h

                mov     [rsp-8+arg_18], r9d
                mov     [rsp-8+arg_10], r8
                mov     [rsp-8+arg_8], rdx
                mov     [rsp-8+arg_0], rcx
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-8]
                sub     rsp, 108h
                mov     rax, [rcx+38h]
                xor     r9d, r9d
                mov     [rbp+40h+var_78], rax
                mov     r14, rdx
                mov     rax, [rcx]
                mov     esi, r9d
                mov     r15, rax
                mov     [rsp+140h+var_D8], rax
                mov     rax, 7FFFFFFFF8h
                shr     r15, 9
                and     r15, rax
                mov     [rbp+40h+var_80], r9
                mov     rax, 0FFFFF68000000000h
                mov     [rsp+140h+var_F8], r9
                mov     [rsp+140h+var_D0], r9d
                mov     rax, rax
                add     r15, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     [rsp+140h+var_F0], r15
                mov     rax, rax
                lea     rcx, [rbp+40h+arg_8]
                mov     r10, 0FFFFF6FB7DBED7F8h
                mov     edi, 1FFh
                cmp     rcx, rax
                jb      short loc_14022B526
                mov     rax, r10
                lea     rcx, [rbp+40h+arg_8]
                cmp     rcx, rax
                ja      short loc_14022B526
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022B526
                test    dl, 1
                jz      short loc_14022B526
                test    dl, 20h
                jz      short loc_14022B4E5
                test    dl, 42h
                jnz     short loc_14022B526

loc_14022B4E5:                          ; CODE XREF: sub_14022B420+BE↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jnz     short loc_14022B507
                mov     r14, [rbp+40h+arg_8]
                jmp     short loc_14022B526
; ---------------------------------------------------------------------------

loc_14022B507:                          ; CODE XREF: sub_14022B420+DF↑j
                lea     rax, [rbp+40h+arg_8]
                shr     rax, 3
                and     rax, rdi
                mov     rax, [r8+rax*8]
                test    al, 20h
                jz      short loc_14022B51E
                or      r14, 20h

loc_14022B51E:                          ; CODE XREF: sub_14022B420+F8↑j
                test    al, 42h
                jz      short loc_14022B526
                or      r14, 42h

loc_14022B526:                          ; CODE XREF: sub_14022B420+9F↑j
                                        ; sub_14022B420+AB↑j ...
                shr     r14, 0Ch
                mov     r13, 0FFFFFFFFFh
                and     r14, r13
                mov     rax, 0FFFFFA8000000000h
                mov     [rbp+40h+var_90], r14
                lea     r12, [r14+r14*2]
                shl     r12, 4
                mov     rax, rax
                add     r12, rax
                mov     rax, cs:qword_140C4E4C8
                lea     rbx, [r12+10h]
                mov     [rsp+140h+var_100], r12
                mov     [rbp+40h+var_88], rbx
                mov     rcx, [r12+28h]
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rax, [rax+rcx*8]
                mov     rcx, [rbx]
                mov     [rbp+40h+var_68], rax
                mov     [rbp+40h+var_60], rcx
                mov     [rsp+140h+var_C8], rcx
                bt      rcx, 0Ah
                jnb     loc_14022C09B
                mov     rax, cs:qword_140C4DDC0
                mov     rdi, rcx
                test    rax, rax
                jz      short loc_14022B5B3
                test    cl, 10h
                jnz     short loc_14022B5B3
                mov     rdi, rax
                not     rdi
                and     rdi, rcx

loc_14022B5B3:                          ; CODE XREF: sub_14022B420+183↑j
                                        ; sub_14022B420+188↑j
                sar     rdi, 10h
                cmp     cs:dword_140C4C40C, esi
                mov     [rbp+40h+var_A0], rdi
                mov     rax, [rdi]
                mov     [rsp+140h+var_E0], rax
                jz      loc_14022BE38
                lea     r14, [rax+40h]
                mov     [rbp+40h+var_B8], r14
                prefetchw byte ptr [r14]
                mov     rdx, [r14]
                test    dl, 0Fh
                jz      short loc_14022B605
                nop     dword ptr [rax+00h]
                nop     word ptr [rax+rax+00000000h]

loc_14022B5F0:                          ; CODE XREF: sub_14022B420+1E3↓j
                lea     rcx, [rdx-1]
                mov     rax, rdx
                lock cmpxchg [r14], rcx
                jz      short loc_14022B605
                mov     rdx, rax
                test    al, 0Fh
                jnz     short loc_14022B5F0

loc_14022B605:                          ; CODE XREF: sub_14022B420+1C1↑j
                                        ; sub_14022B420+1DC↑j
                mov     r13, rdx
                mov     r15, 0FFFFFFFFFFFFFFF1h
                and     r13, 0FFFFFFFFFFFFFFF0h
                and     edx, 0Fh
                mov     [rbp+40h+var_B0], r13
                cmp     edx, 1
                ja      loc_14022B6BB
                test    edx, edx
                jz      loc_14022B6C4
                lea     edx, [r15+1Eh]
                mov     rcx, r13
                call    sub_14032D980
                prefetchw byte ptr [r14]
                mov     rax, [r14]
                mov     rcx, rax
                and     ecx, 0Fh
                add     rcx, 0Fh
                cmp     rcx, 0Fh
                ja      short loc_14022B677
                xchg    ax, ax

loc_14022B650:                          ; CODE XREF: sub_14022B420+255↓j
                mov     rcx, rax
                and     rcx, 0FFFFFFFFFFFFFFF0h
                cmp     r13, rcx
                jnz     short loc_14022B677
                lea     rcx, [rax+0Fh]
                lock cmpxchg [r14], rcx
                jz      short loc_14022B6BB
                mov     rcx, rax
                and     ecx, 0Fh
                add     rcx, 0Fh
                cmp     rcx, 0Fh
                jbe     short loc_14022B650

loc_14022B677:                          ; CODE XREF: sub_14022B420+22C↑j
                                        ; sub_14022B420+23A↑j
                mov     edx, 0Fh
                lea     rcx, [r13-30h]
                mov     r8d, 746C6644h
                call    sub_1402C0620
                mov     rax, r15
                lock xadd [r13-30h], rax
                add     rax, r15
                test    rax, rax
                jg      short loc_14022B6BB
                mov     rcx, [r13-28h]
                test    rcx, rcx
                jnz     loc_14022C9EF
                test    rax, rax
                js      loc_14022CA33
                lea     rcx, [r13-30h]
                call    sub_14034EBC0

loc_14022B6BB:                          ; CODE XREF: sub_14022B420+1FD↑j
                                        ; sub_14022B420+245↑j ...
                test    r13, r13
                jnz     loc_14022B74C

loc_14022B6C4:                          ; CODE XREF: sub_14022B420+205↑j
                mov     rbx, [rsp+140h+var_E0]
                lea     rcx, [rbx+48h]
                call    ExAcquireSpinLockShared
                mov     rcx, r14
                movzx   edi, al
                call    sub_14021AEA8
                lea     rcx, [rbx+48h]
                mov     [rbp+40h+var_B0], rax
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jz      short loc_14022B744
                test    cl, 1
                jz      short loc_14022B744
                mov     rcx, cr8
                cmp     cl, 0Fh
                ja      short loc_14022B744
                cmp     dil, 0Fh
                ja      short loc_14022B744
                cmp     cl, 2
                jb      short loc_14022B744
                mov     r10, gs:20h
                lea     ecx, [rdi+1]
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14022B744
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14022B744:                          ; CODE XREF: sub_14022B420+2D2↑j
                                        ; sub_14022B420+2D7↑j ...
                mov     cr8, rdi
                mov     rdi, [rbp+40h+var_A0]

loc_14022B74C:                          ; CODE XREF: sub_14022B420+29E↑j
                mov     rbx, [r12+8]
                mov     rax, 8000000000000000h
                or      rbx, rax
                mov     rcx, 0FFFF800000000000h
                mov     rax, [rsp+140h+var_D8]
                cmp     rax, rcx
                jb      short loc_14022B77F
                mov     rcx, rax
                call    sub_140245330
                cmp     eax, 1
                jnz     short loc_14022B7AD

loc_14022B77F:                          ; CODE XREF: sub_14022B420+350↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+558h]
                test    rdx, rdx
                jz      short loc_14022B7AD
                test    dword ptr [rcx+87Ch], 1000h
                jnz     short loc_14022B7AD
                mov     r9d, [rdx+8]
                jmp     short loc_14022B7B3
; ---------------------------------------------------------------------------

loc_14022B7AD:                          ; CODE XREF: sub_14022B420+35D↑j
                                        ; sub_14022B420+379↑j ...
                mov     r9d, 0FFFFFFFFh

loc_14022B7B3:                          ; CODE XREF: sub_14022B420+38B↑j
                mov     r10, [rdi]
                mov     rdx, [rdi+8]
                mov     eax, [r10+38h]
                test    al, 20h
                jz      short loc_14022B82F
                cmp     rbx, rdx
                jb      short loc_14022B7F1
                mov     eax, [rdi+2Ch]
                lea     rcx, [rdx+rax*8]
                cmp     rbx, rcx
                jnb     short loc_14022B7F1
                shl     rdx, 9
                shl     rbx, 9
                sub     rbx, rdx

loc_14022B7DE:                          ; CODE XREF: sub_14022B420+3F4↓j
                                        ; sub_14022B420+40D↓j
                mov     eax, [rdi+24h]
                and     rbx, 0FFFFFFFFFFFFF000h
                shl     rax, 9
                add     rbx, rax
                jmp     short loc_14022B85C
; ---------------------------------------------------------------------------

loc_14022B7F1:                          ; CODE XREF: sub_14022B420+3A5↑j
                                        ; sub_14022B420+3B1↑j
                test    byte ptr [rdi+22h], 2
                jz      short loc_14022B816
                mov     r8, rdi
                mov     edx, r9d
                mov     rcx, r10
                call    sub_1403A61F8
                shl     rbx, 9
                mov     rax, [rax+48h]
                shl     rax, 9
                sub     rbx, rax
                jmp     short loc_14022B7DE
; ---------------------------------------------------------------------------

loc_14022B816:                          ; CODE XREF: sub_14022B420+3D5↑j
                mov     rcx, rdi
                call    sub_1402A3500
                shl     rbx, 9
                mov     rax, [rax+48h]
                shl     rax, 9
                sub     rbx, rax
                jmp     short loc_14022B7DE
; ---------------------------------------------------------------------------

loc_14022B82F:                          ; CODE XREF: sub_14022B420+3A0↑j
                test    rdx, rdx
                jnz     short loc_14022B838
                xor     ebx, ebx
                jmp     short loc_14022B843
; ---------------------------------------------------------------------------

loc_14022B838:                          ; CODE XREF: sub_14022B420+412↑j
                sub     rbx, rdx
                sar     rbx, 3
                shl     rbx, 0Ch

loc_14022B843:                          ; CODE XREF: sub_14022B420+416↑j
                movzx   ecx, word ptr [rdi+20h]
                mov     eax, [rdi+24h]
                and     rcx, 0FFFFFFFFFFFFFFC0h
                shl     rcx, 1Ah
                or      rcx, rax
                shl     rcx, 0Ch
                add     rbx, rcx

loc_14022B85C:                          ; CODE XREF: sub_14022B420+3CF↑j
                mov     rax, [rsp+140h+var_E0]
                mov     r13, gs:188h
                mov     [rsp+140h+var_E8], rbx
                mov     r12d, [rax+38h]
                mov     rbx, [r13+0B8h]
                and     r12d, 20h
                prefetchw byte ptr [rbx+600h]
                mov     rdx, [rbx+600h]
                test    dl, 0Fh
                jz      short loc_14022B8B9
                nop     dword ptr [rax+00h]
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_14022B8A0:                          ; CODE XREF: sub_14022B420+497↓j
                lea     rcx, [rdx-1]
                mov     rax, rdx
                lock cmpxchg [rbx+600h], rcx
                jz      short loc_14022B8B9
                mov     rdx, rax
                test    al, 0Fh
                jnz     short loc_14022B8A0

loc_14022B8B9:                          ; CODE XREF: sub_14022B420+46F↑j
                                        ; sub_14022B420+490↑j
                mov     rdi, rdx
                and     rdi, 0FFFFFFFFFFFFFFF0h
                jz      loc_14022BDD6
                and     edx, 0Fh
                cmp     edx, 1
                ja      loc_14022BA48
                test    edx, edx
                jnz     loc_14022B983
                lea     rcx, qword_140C502D0
                mov     r15b, 1
                call    KeAcquireSpinLockRaiseToDpc
                mov     rdi, [rbx+600h]
                movzx   r14d, al
                and     rdi, 0FFFFFFFFFFFFFFF0h
                jz      short loc_14022B90A
                lea     rcx, [rdi+168h]
                call    sub_14024C840
                movzx   r15d, al

loc_14022B90A:                          ; CODE XREF: sub_14022B420+4D8↑j
                lea     rcx, qword_140C502D0
                call    KeReleaseSpinLockFromDpcLevel
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jz      short loc_14022B971
                test    cl, 1
                jz      short loc_14022B971
                mov     rcx, cr8
                cmp     cl, 0Fh
                ja      short loc_14022B971
                cmp     r14b, 0Fh
                ja      short loc_14022B971
                cmp     cl, 2
                jb      short loc_14022B971
                mov     r10, gs:20h
                lea     ecx, [r14+1]
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14022B971
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14022B971:                          ; CODE XREF: sub_14022B420+4FE↑j
                                        ; sub_14022B420+503↑j ...
                mov     cr8, r14
                test    r15b, r15b
                jnz     loc_14022BA48
                jmp     loc_14022BDD2
; ---------------------------------------------------------------------------

loc_14022B983:                          ; CODE XREF: sub_14022B420+4B4↑j
                mov     edx, 0Fh
                lea     rcx, [rdi+168h]
                call    ExAcquireRundownProtectionEx
                test    al, al
                jz      loc_14022BA48
                prefetchw byte ptr [rbx+600h]
                mov     rax, [rbx+600h]
                mov     rcx, rax
                and     ecx, 0Fh
                add     rcx, 0Fh
                cmp     rcx, 0Fh
                ja      short loc_14022B9EB
                nop     word ptr [rax+rax+00h]

loc_14022B9C0:                          ; CODE XREF: sub_14022B420+5C9↓j
                mov     rcx, rax
                and     rcx, 0FFFFFFFFFFFFFFF0h
                cmp     rdi, rcx
                jnz     short loc_14022B9EB
                lea     rcx, [rax+0Fh]
                lock cmpxchg [rbx+600h], rcx
                jz      short loc_14022BA48
                mov     rcx, rax
                and     ecx, 0Fh
                add     rcx, 0Fh
                cmp     rcx, 0Fh
                jbe     short loc_14022B9C0

loc_14022B9EB:                          ; CODE XREF: sub_14022B420+598↑j
                                        ; sub_14022B420+5AA↑j
                xorps   xmm0, xmm0
                xor     eax, eax
                movups  [rbp+40h+var_58], xmm0
                mov     [rbp+40h+var_48], rax
                prefetchw byte ptr [rdi+168h]
                mov     rax, [rdi+168h]
                test    al, 1
                jnz     short loc_14022BA23
                nop     word ptr [rax+rax+00h]

loc_14022BA10:                          ; CODE XREF: sub_14022B420+601↓j
                lea     rcx, [rax-1Eh]
                lock cmpxchg [rdi+168h], rcx
                jz      short loc_14022BA48
                test    al, 1
                jz      short loc_14022BA10

loc_14022BA23:                          ; CODE XREF: sub_14022B420+5E8↑j
                and     rax, 0FFFFFFFFFFFFFFFEh
                lock xadd [rax], r15
                cmp     r15, 0Fh
                jnz     short loc_14022BA48
                lock btr dword ptr [rax+20h], 0
                jb      short loc_14022BA48
                lea     rcx, [rax+8]
                xor     r8d, r8d
                xor     edx, edx
                call    KeSetEvent

loc_14022BA48:                          ; CODE XREF: sub_14022B420+4AC↑j
                                        ; sub_14022B420+558↑j ...
                test    rdi, rdi
                jz      loc_14022BDD2
                test    byte ptr [r13+518h], 40h
                jnz     loc_14022BDC6
                mov     rax, [r13+220h]
                mov     edx, [r13+510h]
                test    dword ptr [rax+464h], 100000h
                jnz     short loc_14022BA87
                and     edx, 0E00h
                cmp     edx, 400h
                jnb     short loc_14022BAA6

loc_14022BA87:                          ; CODE XREF: sub_14022B420+657↑j
                mov     rax, gs:188h
                cmp     r13, rax
                jnz     loc_14022BDBF
                cmp     [r13+550h], esi
                jz      loc_14022BDBF

loc_14022BAA6:                          ; CODE XREF: sub_14022B420+665↑j
                mov     rax, [rdi+1B0h]
                test    rax, rax
                jz      short loc_14022BACF
                cmp     rax, r13
                jnz     loc_14022BDC6
                mov     rax, [r13+480h]
                cmp     [rdi+1B8h], rax
                jnz     loc_14022BDC6

loc_14022BACF:                          ; CODE XREF: sub_14022B420+690↑j
                mov     rax, [rbp+40h+var_B0]
                mov     rcx, rdi
                mov     rdx, rax
                mov     r14, [rax+18h]
                call    sub_14026F190
                mov     r15d, 1
                test    [rdi+1E4h], r15b
                jnz     short loc_14022BB0A
                mov     rax, [rdi+160h]
                cmp     byte ptr [rax+73Ah], 2
                jnz     short loc_14022BB0A
                lock or [rdi+1E4h], r15w

loc_14022BB0A:                          ; CODE XREF: sub_14022B420+6CF↑j
                                        ; sub_14022B420+6DF↑j
                mov     r8, [rsp+140h+var_E8]
                mov     rax, 20000000000h
                cmp     r8, rax
                jnb     loc_14022BDC6
                mov     ebx, cs:dword_140CEC0D0
                xor     eax, eax
                shr     r8, 9
                mov     r13d, eax
                test    r12d, r12d
                mov     [rsp+140h+var_E8], r8
                mov     [rbp+40h+var_98], rax
                setnz   r13b
                mov     eax, [rdi+194h]
                cmp     ebx, eax
                jz      short loc_14022BB8C
                lea     r8, [rbp+40h+var_98]
                mov     edx, r15d
                mov     rcx, rdi
                call    sub_14026EE70
                mov     r8, [rsp+140h+var_E8]
                test    eax, eax
                js      short loc_14022BB8C
                mov     rcx, [rbp+40h+var_98]
                mov     rax, [rcx]
                and     rax, 0FFFFFFFFFFFFFFFAh
                or      rax, 2
                mov     [rcx], rax
                lea     rax, [rdi+1A0h]
                mov     [rcx+8], ebx
                mov     [rdi+194h], ebx
                mov     [rdi+198h], rax

loc_14022BB8C:                          ; CODE XREF: sub_14022B420+729↑j
                                        ; sub_14022B420+741↑j
                test    r13d, r13d
                jnz     short loc_14022BBAE
                mov     rcx, [rdi+198h]
                mov     rax, [rcx]
                shr     rax, 3
                cmp     rax, r8
                jnz     short loc_14022BBAE
                cmp     [rcx+8], r14
                jz      loc_14022BDC6

loc_14022BBAE:                          ; CODE XREF: sub_14022B420+76F↑j
                                        ; sub_14022B420+782↑j
                mov     eax, r15d
                lock xadd [rdi+158h], eax
                inc     eax
                cmp     eax, [rdi+154h]
                jle     short loc_14022BBF9
                mov     eax, 0FFFFFFFFh
                lock xadd [rdi+158h], eax
                xor     eax, eax
                mov     ecx, 3
                lock cmpxchg [rdi+190h], ecx
                jnz     loc_14022BDC6
                lea     rcx, [rdi+170h]
                mov     edx, r15d
                call    ExQueueWorkItem
                jmp     loc_14022BDC6
; ---------------------------------------------------------------------------

loc_14022BBF9:                          ; CODE XREF: sub_14022B420+7A1↑j
                mov     rbx, [rdi+60h]
                mov     eax, r15d
                lock xadd [rbx+10h], eax
                add     eax, 1
                jle     loc_14022BD6C
                xchg    ax, ax

loc_14022BC10:                          ; CODE XREF: sub_14022B420+946↓j
                cmp     eax, [rbx+14h]
                jle     loc_14022BD82
                mov     eax, 0FFFFFFFFh
                lock xadd [rbx+10h], eax
                call    sub_1402EFC84
                mov     r15, rax
                test    rax, rax
                jz      loc_14022BD6C
                lea     rcx, [rdi+80h]
                call    KeAcquireSpinLockRaiseToDpc
                mov     rdx, [rdi+60h]
                movzx   r12d, al
                cmp     rdx, rbx
                jz      short loc_14022BCC6
                lea     rcx, [rdi+80h]
                call    KeReleaseSpinLockFromDpcLevel
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jz      short loc_14022BCB3
                test    cl, 1
                jz      short loc_14022BCB3
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14022BCB3
                cmp     r12b, 0Fh
                ja      short loc_14022BCB3
                cmp     al, 2
                jb      short loc_14022BCB3
                mov     r10, gs:20h
                lea     ecx, [r12+1]
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14022BCB3
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14022BCB3:                          ; CODE XREF: sub_14022B420+841↑j
                                        ; sub_14022B420+846↑j ...
                mov     cr8, r12
                xor     edx, edx
                mov     rcx, r15
                call    ExFreePoolWithTag
                jmp     loc_14022BD55
; ---------------------------------------------------------------------------

loc_14022BCC6:                          ; CODE XREF: sub_14022B420+82B↑j
                mov     rcx, [rdi+70h]
                lea     rax, [rdi+68h]
                cmp     [rcx], rax
                jnz     loc_14022BD7B
                mov     [r15+8], rcx
                mov     [r15], rax
                mov     [rcx], r15
                lea     rcx, [rdi+80h]
                mov     [rax+8], r15
                inc     dword ptr [rdi+78h]
                mov     [rdi+60h], r15
                call    KeReleaseSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14022BD51
                test    al, 1
                jz      short loc_14022BD51
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14022BD51
                cmp     r12b, 0Fh
                ja      short loc_14022BD51
                cmp     al, 2
                jb      short loc_14022BD51
                mov     r10, gs:20h
                lea     ecx, [r12+1]
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14022BD51
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14022BD51:                          ; CODE XREF: sub_14022B420+8E0↑j
                                        ; sub_14022B420+8E4↑j ...
                mov     cr8, r12

loc_14022BD55:                          ; CODE XREF: sub_14022B420+8A1↑j
                mov     rbx, [rdi+60h]
                mov     eax, 1
                lock xadd [rbx+10h], eax
                add     eax, 1
                jg      loc_14022BC10

loc_14022BD6C:                          ; CODE XREF: sub_14022B420+7E8↑j
                                        ; sub_14022B420+80E↑j
                mov     eax, 0FFFFFFFFh
                lock xadd [rdi+158h], eax
                jmp     short loc_14022BDC6
; ---------------------------------------------------------------------------

loc_14022BD7B:                          ; CODE XREF: sub_14022B420+8B1↑j
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
; ---------------------------------------------------------------------------

loc_14022BD82:                          ; CODE XREF: sub_14022B420+7F3↑j
                mov     rcx, [rsp+140h+var_E8]
                movsxd  rdx, eax
                shl     rdx, 4
                add     rdx, 8
                mov     eax, r13d
                add     rdx, rbx
                lea     rcx, ds:0[rcx*8]
                or      rcx, rax
                mov     [rdx+8], r14
                mov     [rdx], rcx
                lock inc dword ptr [rdi+14Ch]
                test    r13d, r13d
                jnz     short loc_14022BDC6
                mov     [rdi+198h], rdx
                jmp     short loc_14022BDC6
; ---------------------------------------------------------------------------

loc_14022BDBF:                          ; CODE XREF: sub_14022B420+673↑j
                                        ; sub_14022B420+680↑j
                lock inc dword ptr [rdi+150h]

loc_14022BDC6:                          ; CODE XREF: sub_14022B420+639↑j
                                        ; sub_14022B420+695↑j ...
                lea     rcx, [rdi+168h]
                call    sub_14024C380

loc_14022BDD2:                          ; CODE XREF: sub_14022B420+55E↑j
                                        ; sub_14022B420+62B↑j
                mov     r14, [rbp+40h+var_B8]

loc_14022BDD6:                          ; CODE XREF: sub_14022B420+4A0↑j
                prefetchw byte ptr [r14]
                mov     rax, [r14]
                mov     r8, [rbp+40h+var_B0]
                mov     rcx, rax
                xor     rcx, r8
                cmp     rcx, 0Fh
                jnb     short loc_14022BE07
                nop     dword ptr [rax]

loc_14022BDF0:                          ; CODE XREF: sub_14022B420+9E5↓j
                lea     rdx, [rax+1]
                lock cmpxchg [r14], rdx
                jz      short loc_14022BE0F
                mov     rdx, rax
                xor     rdx, r8
                cmp     rdx, 0Fh
                jb      short loc_14022BDF0

loc_14022BE07:                          ; CODE XREF: sub_14022B420+9CB↑j
                mov     rcx, r8
                call    ObDereferenceObjectDeferDelete

loc_14022BE0F:                          ; CODE XREF: sub_14022B420+9D9↑j
                mov     rbx, [rbp+40h+var_88]
                mov     r13, 0FFFFFFFFFh
                mov     r15, [rsp+140h+var_F0]
                xor     r9d, r9d
                mov     r12, [rsp+140h+var_100]
                mov     r14, [rbp+40h+var_90]
                mov     r10, 0FFFFF6FB7DBED7F8h

loc_14022BE38:                          ; CODE XREF: sub_14022B420+1A9↑j
                mov     edi, 1FFh

loc_14022BE3D:                          ; CODE XREF: sub_14022B420+C84↓j
                mov     rax, 7FFFFFFFF8h
                mov     rdx, r15
                shr     rdx, 9
                and     rdx, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     rdx, rax
                mov     r11, 0FFFFF6FB7DBED000h
                mov     r8, [rdx]
                mov     rax, r11
                cmp     rdx, rax
                jb      short loc_14022BEDC
                mov     rax, r10
                cmp     rdx, rax
                ja      short loc_14022BEDC
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022BEDC
                test    r8b, 1
                jz      short loc_14022BEDC
                test    r8b, 20h
                jz      short loc_14022BE99
                test    r8b, 42h
                jnz     short loc_14022BEDC

loc_14022BE99:                          ; CODE XREF: sub_14022B420+A71↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14022BEDC
                shr     rdx, 3
                and     rdx, rdi
                mov     rax, [rax+rdx*8]
                mov     rdx, r8
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_14022BEDC
                or      r8, 42h

loc_14022BEDC:                          ; CODE XREF: sub_14022B420+A54↑j
                                        ; sub_14022B420+A5C↑j ...
                mov     [rbp+40h+var_A8], r8
                mov     rax, r11
                lea     rcx, [rbp+40h+var_A8]
                cmp     rcx, rax
                jb      short loc_14022BF5A
                mov     rax, r10
                lea     rcx, [rbp+40h+var_A8]
                cmp     rcx, rax
                ja      short loc_14022BF5A
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022BF5A
                test    r8b, 1
                jz      short loc_14022BF5A
                test    r8b, 20h
                jz      short loc_14022BF13
                test    r8b, 42h
                jnz     short loc_14022BF5A

loc_14022BF13:                          ; CODE XREF: sub_14022B420+AEB↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14022BF5A
                lea     rax, [rbp+40h+var_A8]
                shr     rax, 3
                and     rax, rdi
                mov     rax, [rdx+rax*8]
                mov     rdx, r8
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_14022BF5A
                or      r8, 42h

loc_14022BF5A:                          ; CODE XREF: sub_14022B420+ACA↑j
                                        ; sub_14022B420+AD6↑j ...
                shr     r8, 0Ch
                and     r8, r13
                mov     rax, 0FFFFFA8000000000h
                lea     r13, [r8+r8*2]
                shl     r13, 4
                mov     rax, rax
                add     r13, rax
                mov     [rbp+40h+var_C0], r9d
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jnb     short loc_14022BFAE

loc_14022BF86:                          ; CODE XREF: sub_14022B420+B76↓j
                                        ; sub_14022B420+B7F↓j
                lea     rcx, [rbp+40h+var_C0]
                call    sub_1402C8C70
                mov     rax, [r13+18h]
                test    rax, rax
                js      short loc_14022BF86
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jb      short loc_14022BF86
                xor     r9d, r9d
                mov     r11, 0FFFFF6FB7DBED000h

loc_14022BFAE:                          ; CODE XREF: sub_14022B420+B64↑j
                mov     rax, [r13+18h]
                mov     rdx, 3FFFFFFFFFFFFFFFh
                mov     r10, 7FFFFFFFFFFFFFFFh
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     rcx, rdx
                xor     rcx, rax
                mov     [r13+18h], rcx
                lock and [r13+18h], r10
                mov     rdi, [r15]
                mov     rax, r11
                mov     r11, 0FFFFF6FB7DBED7F8h
                cmp     r15, rax
                jb      short loc_14022C05C
                mov     rax, r11
                cmp     r15, rax
                ja      short loc_14022C05C
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022C05C
                test    dil, 1
                jz      short loc_14022C05C
                test    dil, 20h
                jz      short loc_14022C014
                test    dil, 42h
                jnz     short loc_14022C05C

loc_14022C014:                          ; CODE XREF: sub_14022B420+BEC↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14022C05C
                mov     rax, r15
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_14022C05C
                or      rdi, 42h

loc_14022C05C:                          ; CODE XREF: sub_14022B420+BCF↑j
                                        ; sub_14022B420+BD7↑j ...
                bt      rdi, 0Ah
                jnb     short loc_14022C0A9
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rdi
                test    rcx, rcx
                jz      short loc_14022C081
                test    dil, 10h
                jnz     short loc_14022C081
                mov     rax, rcx
                not     rax
                and     rax, rdi

loc_14022C081:                          ; CODE XREF: sub_14022B420+C50↑j
                                        ; sub_14022B420+C56↑j
                shr     rax, 20h
                mov     ecx, 0FFFFFFFFh
                cmp     rax, rcx
                jnz     short loc_14022C0A9
                shr     rdi, 5
                and     edi, 1Fh
                jmp     loc_14022C163
; ---------------------------------------------------------------------------

loc_14022C09B:                          ; CODE XREF: sub_14022B420+170↑j
                mov     [rbp+40h+var_A0], r9
                mov     [rsp+140h+var_E0], r9
                jmp     loc_14022BE3D
; ---------------------------------------------------------------------------

loc_14022C0A9:                          ; CODE XREF: sub_14022B420+C41↑j
                                        ; sub_14022B420+C6D↑j
                mov     rdx, [rsp+140h+var_C8]
                mov     r8, rdx
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                lea     rcx, [rsp+140h+var_C8]
                cmp     rcx, rax
                jb      short loc_14022C138
                mov     rax, r11
                lea     rcx, [rsp+140h+var_C8]
                cmp     rcx, rax
                ja      short loc_14022C138
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022C138
                test    r8b, 1
                jz      short loc_14022C138
                test    r8b, 20h
                jz      short loc_14022C0F0
                test    r8b, 42h
                jnz     short loc_14022C138

loc_14022C0F0:                          ; CODE XREF: sub_14022B420+CC8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     short loc_14022C113
                mov     rdx, [rsp+140h+var_C8]
                jmp     short loc_14022C138
; ---------------------------------------------------------------------------

loc_14022C113:                          ; CODE XREF: sub_14022B420+CEA↑j
                lea     rax, [rsp+140h+var_C8]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r8
                test    al, 20h
                jz      short loc_14022C130
                or      rdx, 20h

loc_14022C130:                          ; CODE XREF: sub_14022B420+D0A↑j
                test    al, 42h
                jz      short loc_14022C138
                or      rdx, 42h

loc_14022C138:                          ; CODE XREF: sub_14022B420+CA6↑j
                                        ; sub_14022B420+CB3↑j ...
                shr     rdx, 5
                mov     eax, 1
                and     edx, 1Fh
                mov     esi, eax
                test    dil, 8
                cmovnz  edx, eax
                mov     rax, [rbp+40h+arg_10]
                mov     edi, edx
                test    rax, rax
                jz      short loc_14022C163
                test    dl, 4
                cmovz   rax, r9
                mov     [rbp+40h+arg_10], rax

loc_14022C163:                          ; CODE XREF: sub_14022B420+C76↑j
                                        ; sub_14022B420+D36↑j
                test    byte ptr cs:dword_140CFC400+2, 1
                mov     r8, 0FFFFF6FFFFFFFFFFh
                mov     r11, 0FFFFF68000000000h
                jz      loc_14022C24F
                mov     rdx, [rsp+140h+var_D8]
                mov     rax, 0FFFF800000000000h
                cmp     rdx, rax
                jb      loc_14022C24F
                mov     rax, r11
                cmp     rdx, rax
                jb      short loc_14022C1B0
                mov     rax, r8
                cmp     rdx, rax
                jbe     loc_14022C24F

loc_14022C1B0:                          ; CODE XREF: sub_14022B420+D82↑j
                test    dil, 2
                jz      loc_14022C24F
                test    cs:dword_140CFC400, 20000h
                jnz     short loc_14022C1F3
                mov     rcx, r12
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022C1F3
                mov     eax, [rbx]
                bt      rax, 0Ah
                jb      short loc_14022C1F3
                mov     rcx, rdx
                mov     ebx, r9d
                call    sub_14053A9F8
                test    eax, eax
                mov     eax, 1
                jz      short loc_14022C207
                mov     ebx, eax
                jmp     short loc_14022C207
; ---------------------------------------------------------------------------

loc_14022C1F3:                          ; CODE XREF: sub_14022B420+DA4↑j
                                        ; sub_14022B420+DB0↑j ...
                xor     r8d, r8d
                xor     edx, edx
                mov     rcx, r12
                call    sub_14027B160
                mov     ebx, eax
                mov     eax, 1

loc_14022C207:                          ; CODE XREF: sub_14022B420+DCD↑j
                                        ; sub_14022B420+DD1↑j
                mov     r11, 0FFFFF68000000000h
                mov     r10, 7FFFFFFFFFFFFFFFh
                test    bl, 1
                jz      short loc_14022C22F
                mov     edi, 3
                mov     [rbp+40h+arg_10], 0
                jmp     short loc_14022C245
; ---------------------------------------------------------------------------

loc_14022C22F:                          ; CODE XREF: sub_14022B420+DFE↑j
                test    bl, 8
                jz      short loc_14022C23F
                xor     r8d, r8d
                mov     edi, eax
                mov     [rbp+40h+arg_10], r8
                jmp     short loc_14022C245
; ---------------------------------------------------------------------------

loc_14022C23F:                          ; CODE XREF: sub_14022B420+E12↑j
                and     edi, 0FFFFFFFDh
                cmovz   edi, eax

loc_14022C245:                          ; CODE XREF: sub_14022B420+E0D↑j
                                        ; sub_14022B420+E1D↑j
                mov     r8, 0FFFFF6FFFFFFFFFFh

loc_14022C24F:                          ; CODE XREF: sub_14022B420+D5E↑j
                                        ; sub_14022B420+D76↑j ...
                movzx   ecx, byte ptr [r12+22h]
                mov     eax, edi
                and     eax, 0FFFFFFE7h
                shr     cl, 6
                cmp     cl, 1
                jz      short loc_14022C273
                test    cl, cl
                jnz     short loc_14022C26B
                or      eax, 8
                jmp     short loc_14022C273
; ---------------------------------------------------------------------------

loc_14022C26B:                          ; CODE XREF: sub_14022B420+E44↑j
                cmp     cl, 2
                jnz     short loc_14022C273
                or      eax, 18h

loc_14022C273:                          ; CODE XREF: sub_14022B420+E40↑j
                                        ; sub_14022B420+E49↑j ...
                mov     ebx, eax
                lea     rax, cs:140000000h
                shl     r14, 0Ch
                mov     rbx, ds:rva qword_140017520[rax+rbx*8]
                mov     rax, 0FFFF000000000E7Fh
                and     rbx, rax
                or      rbx, r14
                or      rbx, 21h
                mov     rax, r11
                cmp     r15, rax
                jb      loc_14022C3A8
                mov     rax, r8
                cmp     r15, rax
                ja      loc_14022C3A8
                mov     r14, r15
                shl     r14, 19h
                mov     rax, r11
                shl     rax, 19h
                sub     r14, rax
                sar     r14, 10h
                mov     rax, 0FFFFF6FB40000000h
                cmp     r15, rax
                jb      short loc_14022C322
                mov     rax, 0FFFFF6FB7FFFFFFFh
                cmp     r15, rax
                ja      short loc_14022C322
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     r15, rax
                jnz     short loc_14022C305
                mov     rax, 8000000000000000h
                or      rbx, rax
                jmp     short loc_14022C308
; ---------------------------------------------------------------------------

loc_14022C305:                          ; CODE XREF: sub_14022B420+ED4↑j
                and     rbx, r10

loc_14022C308:                          ; CODE XREF: sub_14022B420+EE3↑j
                mov     rcx, r15
                call    sub_14033FA34
                mov     r11, 0FFFFF68000000000h
                test    eax, eax
                jz      short loc_14022C322
                or      rbx, 4

loc_14022C322:                          ; CODE XREF: sub_14022B420+EB6↑j
                                        ; sub_14022B420+EC5↑j ...
                mov     rax, r11
                mov     rcx, 3FFFFFFF78h
                add     rax, rcx
                cmp     r15, rax
                ja      short loc_14022C33B
                or      rbx, 4

loc_14022C33B:                          ; CODE XREF: sub_14022B420+F15↑j
                mov     rax, 0FFFF800000000000h
                cmp     r14, rax
                jnb     short loc_14022C353
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jmp     short loc_14022C3A4
; ---------------------------------------------------------------------------

loc_14022C353:                          ; CODE XREF: sub_14022B420+F28↑j
                mov     rcx, r14
                call    sub_140245330
                cmp     eax, 1
                jz      short loc_14022C3AD
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     r14, rax
                jb      short loc_14022C384
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r14, rax
                jbe     short loc_14022C3AD

loc_14022C384:                          ; CODE XREF: sub_14022B420+F50↑j
                cmp     r14, cs:qword_140C4F9B8
                jb      short loc_14022C39D
                cmp     r14, cs:qword_140C4E1E8
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jbe     short loc_14022C3A4

loc_14022C39D:                          ; CODE XREF: sub_14022B420+F6B↑j
                movzx   eax, byte ptr cs:word_140C4DE88

loc_14022C3A4:                          ; CODE XREF: sub_14022B420+F31↑j
                                        ; sub_14022B420+F7B↑j
                test    eax, eax
                jz      short loc_14022C3AD

loc_14022C3A8:                          ; CODE XREF: sub_14022B420+E82↑j
                                        ; sub_14022B420+E8E↑j
                bts     rbx, 8

loc_14022C3AD:                          ; CODE XREF: sub_14022B420+F3E↑j
                                        ; sub_14022B420+F62↑j ...
                mov     rax, 0FAFFFFFFFFFFFFFFh
                and     rbx, rax
                mov     rax, 0A00000000000000h
                or      rbx, rax
                cmp     [rbp+40h+arg_10], 0
                mov     [rsp+140h+var_F8], rbx
                jz      loc_14022C575
                mov     rax, [rbp+40h+arg_0]
                mov     rcx, 7FFFFFFEFFFFh
                mov     rax, [rax]
                cmp     rax, rcx
                ja      short loc_14022C438
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    rbx, rbx
                js      short loc_14022C40C
                mov     eax, [rcx+464h]
                test    al, 10h
                jnz     short loc_14022C421

loc_14022C40C:                          ; CODE XREF: sub_14022B420+FE0↑j
                mov     rax, [rcx+9F8h]
                test    rax, rax
                jz      short loc_14022C433
                add     rax, 18h
                cmp     [rax], rax
                jz      short loc_14022C433

loc_14022C421:                          ; CODE XREF: sub_14022B420+FEA↑j
                mov     rbx, [rsp+140h+var_F8]
                mov     [rbp+40h+arg_10], 0
                jmp     loc_14022C575
; ---------------------------------------------------------------------------

loc_14022C433:                          ; CODE XREF: sub_14022B420+FF6↑j
                                        ; sub_14022B420+FFF↑j
                mov     rbx, [rsp+140h+var_F8]

loc_14022C438:                          ; CODE XREF: sub_14022B420+FCB↑j
                mov     eax, edi
                and     eax, 5
                cmp     al, 5
                jz      loc_14022C575
                or      rbx, 42h
                test    byte ptr [r12+22h], 10h
                mov     [rsp+140h+var_F8], rbx
                jnz     loc_14022C552
                mov     eax, [r12+10h]
                bt      rax, 0Ah
                jb      loc_14022C552
                lea     rcx, [r12+10h]
                call    sub_1402DF6E4
                test    eax, eax
                jz      loc_14022C552
                mov     rcx, r12
                xor     ebx, ebx
                call    sub_1402DAA00
                movzx   r8d, byte ptr [r12+22h]
                movzx   r14d, al
                test    r8b, 10h
                jnz     short loc_14022C4CA
                mov     edx, [r12+10h]
                bt      rdx, 0Ah
                jb      short loc_14022C4CA
                test    r8b, 8
                jnz     short loc_14022C4C1
                xor     r8d, r8d
                lea     edx, [rbx+1]
                lea     rcx, [r12+10h]
                call    sub_140338C90
                movzx   r8d, byte ptr [r12+22h]
                mov     rbx, rax

loc_14022C4C1:                          ; CODE XREF: sub_14022B420+1086↑j
                or      r8b, 10h
                mov     [r12+22h], r8b

loc_14022C4CA:                          ; CODE XREF: sub_14022B420+1074↑j
                                        ; sub_14022B420+1080↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r12+18h], rax
                test    rbx, rbx
                jz      short loc_14022C4F1
                mov     rcx, [rbp+40h+var_68]
                mov     r8d, 1
                mov     rdx, rbx
                call    sub_14020B2C0

loc_14022C4F1:                          ; CODE XREF: sub_14022B420+10BD↑j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14022C549
                test    al, 1
                jz      short loc_14022C549
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14022C549
                cmp     r14b, 0Fh
                ja      short loc_14022C549
                cmp     al, 2
                jb      short loc_14022C549
                mov     r10, gs:20h
                lea     ecx, [r14+1]
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14022C549
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14022C549:                          ; CODE XREF: sub_14022B420+10D9↑j
                                        ; sub_14022B420+10DD↑j ...
                mov     cr8, r14
                mov     rbx, [rsp+140h+var_F8]

loc_14022C552:                          ; CODE XREF: sub_14022B420+1034↑j
                                        ; sub_14022B420+1044↑j ...
                test    [rbp+40h+var_60], 400h
                jz      short loc_14022C575
                mov     rax, [rbp+40h+var_78]
                movzx   eax, byte ptr [rax+0B8h]
                and     al, 7
                cmp     al, 2
                jz      short loc_14022C575
                mov     rcx, r12
                call    sub_1402FBD58

loc_14022C575:                          ; CODE XREF: sub_14022B420+FB1↑j
                                        ; sub_14022B420+100E↑j ...
                xor     r11d, r11d
                mov     r15d, r11d
                mov     r14d, r11d
                cmp     [rbp+40h+arg_18], r11d
                jnz     loc_14022C7D6
                mov     rcx, 1000000000h
                test    [r12+28h], rcx
                jnz     short loc_14022C5A9
                mov     rax, [r12+8]
                test    rax, rax
                js      short loc_14022C5A9
                jnz     loc_14022C7D6

loc_14022C5A9:                          ; CODE XREF: sub_14022B420+1177↑j
                                        ; sub_14022B420+1181↑j
                mov     r9, [rsp+140h+var_D8]
                mov     rax, 0FFFF800000000000h
                cmp     r9, rax
                jb      short loc_14022C5F5
                mov     rax, [rsp+140h+var_E0]
                test    rax, rax
                jz      short loc_14022C5D2
                mov     eax, [rax+38h]
                test    al, 20h
                jz      loc_14022C7D6

loc_14022C5D2:                          ; CODE XREF: sub_14022B420+11A5↑j
                lea     r8, [rsp+140h+var_D0]
                mov     rcx, r9
                lea     rdx, [rsp+140h+var_E0]
                call    sub_140340184
                mov     ecx, [rsp+140h+var_D0]
                xor     r11d, r11d
                mov     rdx, [rsp+140h+var_E0]
                jmp     loc_14022C6E5
; ---------------------------------------------------------------------------

loc_14022C5F5:                          ; CODE XREF: sub_14022B420+119B↑j
                cmp     [rbp+40h+var_A0], r11
                jz      short loc_14022C60E
                mov     rax, [rsp+140h+var_E0]
                mov     ecx, [rax+38h]
                test    cl, 20h
                jz      loc_14022C7D6
                jmp     short loc_14022C647
; ---------------------------------------------------------------------------

loc_14022C60E:                          ; CODE XREF: sub_14022B420+11D9↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     [rcx+4F0h], r11
                jz      short loc_14022C647
                mov     rdx, [r12+8]
                mov     rax, 8000000000000000h
                or      rdx, rax
                call    sub_1402C6E74
                test    rax, rax
                jnz     loc_14022C7D1

loc_14022C647:                          ; CODE XREF: sub_14022B420+11EC↑j
                                        ; sub_14022B420+1205↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+690h]
                cmp     [rax+180h], r11
                jz      loc_14022C7D1
                mov     rcx, r9
                call    sub_14026A130
                mov     r10, rax
                test    rax, rax
                jz      loc_14022C7D1
                mov     eax, [rax+30h]
                mov     ecx, eax
                and     cl, 70h
                cmp     cl, 20h ; ' '
                jnz     loc_14022C7D1
                bt      eax, 14h
                jb      loc_14022C7D1
                bt      eax, 15h
                jnb     loc_14022C7D1
                mov     rax, [r10+48h]
                mov     rcx, [r10+50h]
                mov     rdx, [rax]
                mov     rax, [rsp+140h+var_D8]
                shr     rax, 0Ch
                sub     rcx, [rdx+88h]
                sar     rcx, 3
                sub     ecx, [r10+18h]
                add     ecx, eax
                mov     rax, [r10+98h]
                bt      [rax], ecx
                jnb     loc_14022C7D1
                mov     rax, [r10+88h]
                mov     rbx, [rsp+140h+var_F8]

loc_14022C6E5:                          ; CODE XREF: sub_14022B420+11D0↑j
                test    rax, rax
                jz      loc_14022C7D6
                mov     r8d, ecx
                mov     [rsp+140h+var_120], rax
                mov     rcx, [rbp+40h+arg_0]
                mov     r9, r12
                call    sub_14031BDC8
                xor     edx, edx
                mov     rcx, r12
                mov     r14d, eax
                call    sub_140209CE0
                cmp     r14d, 129h
                jz      loc_14022C79F
                cmp     r14d, 0C000009Ah
                jz      short loc_14022C79F
                test    r14d, r14d
                js      loc_14022C7B9
                mov     rcx, [rsp+140h+var_F0]
                call    sub_1403451C0
                lea     rcx, [rsp+140h+var_F8]
                mov     [rsp+140h+var_F8], rax
                mov     rbx, rax
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     r8, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     r8, 4
                mov     rax, rax
                add     r8, rax
                mov     esi, 2
                mov     rax, 0FFFF800000000000h
                mov     [rsp+140h+var_100], r8
                cmp     [rsp+140h+var_D8], rax
                jb      short loc_14022C797
                test    byte ptr [r8+23h], 8
                cmovnz  r15d, esi

loc_14022C797:                          ; CODE XREF: sub_14022B420+136C↑j
                xor     r11d, r11d
                mov     edi, r11d
                jmp     short loc_14022C7DB
; ---------------------------------------------------------------------------

loc_14022C79F:                          ; CODE XREF: sub_14022B420+12F6↑j
                                        ; sub_14022B420+1303↑j
                xor     edx, edx
                mov     rcx, r13
                call    sub_140209CE0
                cmp     r14d, 129h
                mov     eax, 0C0000434h
                cmovz   r14d, eax

loc_14022C7B9:                          ; CODE XREF: sub_14022B420+1308↑j
                                        ; sub_14022B420+1537↓j ...
                mov     eax, r14d

loc_14022C7BC:                          ; CODE XREF: sub_14022B420+15CA↓j
                add     rsp, 108h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022C7D1:                          ; CODE XREF: sub_14022B420+1221↑j
                                        ; sub_14022B420+1245↑j ...
                mov     rbx, [rsp+140h+var_F8]

loc_14022C7D6:                          ; CODE XREF: sub_14022B420+1162↑j
                                        ; sub_14022B420+1183↑j ...
                mov     r8, [rsp+140h+var_100]

loc_14022C7DB:                          ; CODE XREF: sub_14022B420+137D↑j
                mov     rcx, [rbp+40h+arg_20]
                test    sil, 1
                mov     rax, rcx
                mov     r12d, r11d
                cmovz   r12d, edi
                and     eax, 1
                and     rcx, 0FFFFFFFFFFFFFFFEh
                test    rax, rax
                jz      short loc_14022C810
                cmp     byte ptr [rcx], 5
                jnz     short loc_14022C802
                mov     [rbp+40h+var_80], rcx

loc_14022C802:                          ; CODE XREF: sub_14022B420+13DC↑j
                test    rax, rax
                jz      short loc_14022C810
                cmp     byte ptr [rcx], 3
                jnz     short loc_14022C810
                or      r15d, 1

loc_14022C810:                          ; CODE XREF: sub_14022B420+13D7↑j
                                        ; sub_14022B420+13E5↑j ...
                mov     r10, [rbp+40h+arg_0]
                movzx   edx, byte ptr [r10+45h]
                lea     rdi, [r10+38h]
                test    dl, 8
                jz      short loc_14022C837
                mov     rax, [r10+10h]
                test    al, 1
                jz      short loc_14022C833
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 2
                jz      short loc_14022C837

loc_14022C833:                          ; CODE XREF: sub_14022B420+1408↑j
                and     rbx, 0FFFFFFFFFFFFFFDFh

loc_14022C837:                          ; CODE XREF: sub_14022B420+1400↑j
                                        ; sub_14022B420+1411↑j
                movzx   eax, dl
                and     al, 5
                cmp     al, 4
                jnz     loc_14022C905
                test    dl, 2
                jnz     loc_14022C905
                movzx   eax, word ptr [rdi+0Ah]
                mov     r11d, 1FFh
                mov     r9, [rsp+140h+var_F0]
                test    ax, ax
                jz      short loc_14022C8A4
                movzx   ecx, word ptr [rdi+8]
                add     ecx, eax
                mov     eax, r9d
                shr     eax, 3
                and     eax, r11d
                cmp     ecx, eax
                jnz     short loc_14022C88D
                mov     rcx, r8
                and     dl, 10h
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022C889
                test    dl, dl
                jz      short loc_14022C8A4
                jmp     short loc_14022C88D
; ---------------------------------------------------------------------------

loc_14022C889:                          ; CODE XREF: sub_14022B420+1461↑j
                test    dl, dl
                jnz     short loc_14022C8A4

loc_14022C88D:                          ; CODE XREF: sub_14022B420+1452↑j
                                        ; sub_14022B420+1467↑j
                mov     rcx, rdi
                call    sub_14026F5D0
                mov     r10, [rbp+40h+arg_0]
                mov     r11d, 1FFh
                mov     r9, [rsp+140h+var_F0]

loc_14022C8A4:                          ; CODE XREF: sub_14022B420+143F↑j
                                        ; sub_14022B420+1465↑j ...
                movzx   eax, word ptr [rdi+0Ah]
                test    ax, ax
                jnz     short loc_14022C8F3
                movzx   edx, byte ptr [rdi+0Dh]
                mov     eax, 1
                mov     [rdi+0Ah], ax
                mov     eax, r9d
                shr     eax, 3
                and     ax, r11w
                mov     [rdi+8], ax
                mov     rdi, [rsp+140h+var_100]
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022C8E6
                and     dl, 0EFh
                mov     [r10+45h], dl
                or      r15d, 4
                jmp     short loc_14022C90A
; ---------------------------------------------------------------------------

loc_14022C8E6:                          ; CODE XREF: sub_14022B420+14B7↑j
                or      dl, 10h
                mov     [r10+45h], dl
                or      r15d, 4
                jmp     short loc_14022C90A
; ---------------------------------------------------------------------------

loc_14022C8F3:                          ; CODE XREF: sub_14022B420+148B↑j
                inc     ax
                mov     [rdi+0Ah], ax
                or      r15d, 4
                mov     rdi, [rsp+140h+var_100]
                jmp     short loc_14022C90A
; ---------------------------------------------------------------------------

loc_14022C905:                          ; CODE XREF: sub_14022B420+141E↑j
                                        ; sub_14022B420+1427↑j
                mov     rdi, [rsp+140h+var_100]

loc_14022C90A:                          ; CODE XREF: sub_14022B420+14C4↑j
                                        ; sub_14022B420+14D1↑j ...
                mov     rax, [rbp+40h+var_80]
                mov     r9d, r12d
                mov     rcx, [rbp+40h+var_78]
                mov     r8, rdi
                mov     [rsp+140h+var_110], rax
                mov     [rsp+140h+var_118], r15d
                mov     r15, [rsp+140h+var_F0]
                mov     rdx, r15
                mov     [rsp+140h+var_120], rbx
                call    sub_140228E90
                test    eax, eax
                jnz     short loc_14022C95C
                xor     edx, edx
                mov     rcx, rdi
                call    sub_140209CE0
                cmp     esi, 2
                jnb     short loc_14022C951
                xor     edx, edx
                mov     rcx, r13
                call    sub_140209CE0

loc_14022C951:                          ; CODE XREF: sub_14022B420+1525↑j
                mov     r14d, 0C0000017h
                jmp     loc_14022C7B9
; ---------------------------------------------------------------------------

loc_14022C95C:                          ; CODE XREF: sub_14022B420+1516↑j
                cmp     [rbp+40h+arg_10], 0
                jz      loc_14022C7B9
                bt      rbx, 0Bh
                jb      loc_14022C7B9
                bt      rbx, 9
                jnb     loc_14022C7B9
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     qword ptr [rdx+4E0h], 0
                jnz     loc_14022C7B9
                mov     rbx, [rbp+40h+arg_0]
                cmp     qword ptr [rbx+48h], 0
                lea     rcx, [rbx+38h]
                jz      short loc_14022C9BC
                test    byte ptr [rcx+0Dh], 1
                jnz     short loc_14022C9BC
                cmp     word ptr [rcx+0Ah], 0
                jz      short loc_14022C9BC
                call    sub_14026F5D0

loc_14022C9BC:                          ; CODE XREF: sub_14022B420+1588↑j
                                        ; sub_14022B420+158E↑j ...
                mov     rcx, [rsp+140h+var_D8]
                xor     r9d, r9d
                mov     rdx, r15
                lea     r8, [r9-1]
                call    sub_1402C50E0
                mov     r14d, eax
                test    eax, eax
                jns     loc_14022C7B9
                mov     edx, eax
                mov     rcx, rbx
                call    sub_140549108
                mov     eax, 0C0000434h
                jmp     loc_14022C7BC
; ---------------------------------------------------------------------------

loc_14022C9EF:                          ; CODE XREF: sub_14022B420+283↑j
                mov     r9d, 6
                mov     [rsp+140h+var_120], rcx
                lea     rax, [r13-30h]
                mov     r8, r13
                shr     rax, 8
                movzx   edx, al
                movzx   eax, byte ptr [r13-18h]
                lea     ecx, [r9+12h]
                xor     rdx, rax
                movzx   eax, byte ptr cs:dword_140CFC728
                xor     rdx, rax
                lea     rax, cs:140000000h
                mov     rdx, ds:rva qword_140CFCE60[rax+rdx*8]
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14022CA33:                          ; CODE XREF: sub_14022B420+28C↑j
                xor     edx, edx
                mov     [rsp+140h+var_120], rax
                mov     r9d, 5
                mov     r8, r13
                lea     ecx, [rdx+18h]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_14022B420   endp

algn_14022CA4C:                         ; DATA XREF: .pdata:00000001400CB1B4↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14022CA60   proc near               ; CODE XREF: sub_1402260D0+3D0↑p
                                        ; DATA XREF: .rdata:00000001400534D8↑o ...

var_D8          = qword ptr -0D8h
var_C8          = qword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = dword ptr -80h
var_7C          = dword ptr -7Ch
var_78          = dword ptr -78h
var_74          = dword ptr -74h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = byte ptr  20h

                mov     [rsp+arg_10], r8
                mov     [rsp+arg_8], rdx
                mov     [rsp+arg_0], rcx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r15
                sub     rsp, 0D0h
                mov     rax, r8
                mov     r10, 0FFFFF68000000000h
                mov     r8, rcx
                xor     r13d, r13d
                mov     r9, 7FFFFFFFF8h
                mov     [rsp+0F8h+var_A8], r13
                mov     [rax], r13
                mov     rax, [rcx+38h]
                mov     [rsp+0F8h+var_58], rax
                mov     rax, [rcx]
                mov     rcx, rax
                mov     [rsp+0F8h+var_88], rax
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r10
                add     rcx, rax
                mov     [rsp+0F8h+var_70], rcx
                mov     rcx, [r8+10h]
                mov     rax, rcx
                mov     [rsp+0F8h+var_C0], rcx
                and     eax, 1
                mov     [rsp+0F8h+var_B0], rax
                jz      short loc_14022CAF6
                mov     rdx, rcx
                and     rdx, 0FFFFFFFFFFFFFFFEh
                mov     [rsp+0F8h+var_90], rdx
                cmp     byte ptr [rdx], 1
                jz      short loc_14022CAFB

loc_14022CAF6:                          ; CODE XREF: sub_14022CA60+83↑j
                mov     [rsp+0F8h+var_90], r13

loc_14022CAFB:                          ; CODE XREF: sub_14022CA60+94↑j
                mov     rdi, [r8+60h]
                mov     r15, rdi

loc_14022CB02:                          ; DATA XREF: .rdata:00000001400534D8↑o
                                        ; .rdata:00000001400534E8↑o ...
                mov     [rsp+0F8h+var_30], rbx
                shr     r15, 9
                and     r15, r9
                mov     [rsp+0F8h+var_38], r14
                mov     [rsp+0F8h+var_A0], rdi
                mov     rax, r10
                add     r15, rax
                mov     rsi, [r15]
                mov     [rsp+0F8h+var_B8], rsi
                and     esi, 1
                nop

loc_14022CB30:                          ; CODE XREF: sub_14022CA60+1AD↓j
                mov     r12, 0FFFFFFFFFh
                test    rsi, rsi
                jz      loc_14022DDDD
                mov     rbx, [rsp+0F8h+var_B8]
                bt      rbx, 9
                jb      loc_14022DDDD
                lea     rcx, [rsp+0F8h+var_B8]
                call    sub_1402433C0
                mov     r14d, eax
                test    eax, eax
                jz      short loc_14022CBD8
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14022CBD8
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14022CBD8
                test    bl, 20h
                jz      short loc_14022CB93
                test    bl, 42h
                jnz     short loc_14022CBD8

loc_14022CB93:                          ; CODE XREF: sub_14022CA60+12C↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     short loc_14022CBB6
                mov     rbx, [rsp+0F8h+var_B8]
                jmp     short loc_14022CBD8
; ---------------------------------------------------------------------------

loc_14022CBB6:                          ; CODE XREF: sub_14022CA60+14D↑j
                lea     rax, [rsp+0F8h+var_B8]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                test    al, 20h
                jz      short loc_14022CBD0
                or      rbx, 20h

loc_14022CBD0:                          ; CODE XREF: sub_14022CA60+16A↑j
                test    al, 42h
                jz      short loc_14022CBD8
                or      rbx, 42h

loc_14022CBD8:                          ; CODE XREF: sub_14022CA60+102↑j
                                        ; sub_14022CA60+10E↑j ...
                shr     rbx, 0Ch
                and     rbx, r12
                mov     rax, 0FFFFFA8000000028h
                lea     r12, [rbx+rbx*2]
                shl     r12, 4
                mov     [rsp+0F8h+var_50], r12
                mov     rax, rax
                mov     rcx, [r12+rax]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      loc_14022CB30
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                lea     r8, [r12+rax]
                mov     [rsp+0F8h+var_80], r13d
                mov     [rsp+0F8h+var_C8], r8
                mov     rdi, 0FFFFFA8000000018h
                lock bts qword ptr [r12+rdi], 3Fh ; '?'
                jnb     short loc_14022CC5D

loc_14022CC41:                          ; CODE XREF: sub_14022CA60+1F2↓j
                                        ; sub_14022CA60+1FB↓j
                lea     rcx, [rsp+0F8h+var_80]
                call    sub_1402C8C70
                mov     rax, [r12+rdi]
                test    rax, rax
                js      short loc_14022CC41
                lock bts qword ptr [r12+rdi], 3Fh ; '?'
                jb      short loc_14022CC41

loc_14022CC5D:                          ; CODE XREF: sub_14022CA60+1DF↑j
                mov     rax, [r15]
                mov     [rsp+0F8h+var_B8], rax
                test    al, 1
                jz      loc_14022DDCE
                bt      rax, 9
                jb      loc_14022DDCE
                test    r14d, r14d
                jz      short loc_14022CCF2
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14022CCF2
                mov     rcx, gs:188h
                mov     rdx, [rcx+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_14022CCF2
                test    al, 20h
                jz      short loc_14022CCAA
                test    al, 42h
                jnz     short loc_14022CCF2

loc_14022CCAA:                          ; CODE XREF: sub_14022CA60+244↑j
                mov     rcx, gs:188h
                mov     rdx, [rcx+0B8h]
                mov     r8, [rdx+788h]
                test    r8, r8
                jnz     short loc_14022CCCD
                mov     rax, [rsp+0F8h+var_B8]
                jmp     short loc_14022CCF2
; ---------------------------------------------------------------------------

loc_14022CCCD:                          ; CODE XREF: sub_14022CA60+264↑j
                lea     rcx, [rsp+0F8h+var_B8]
                shr     rcx, 3
                and     ecx, 1FFh
                mov     rcx, [r8+rcx*8]
                test    cl, 20h
                jz      short loc_14022CCE9
                or      rax, 20h

loc_14022CCE9:                          ; CODE XREF: sub_14022CA60+283↑j
                test    cl, 42h
                jz      short loc_14022CCF2
                or      rax, 42h

loc_14022CCF2:                          ; CODE XREF: sub_14022CA60+21B↑j
                                        ; sub_14022CA60+227↑j ...
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                cmp     rbx, rax
                jnz     loc_14022DDCE
                mov     r14, [rsp+0F8h+var_C8]
                mov     rcx, 1000000000h
                mov     rdx, 0FFFFFA8000000008h
                mov     r13d, 1
                mov     r11, 0FFFFFA8000000023h
                mov     rax, 2000000000000h
                mov     r15, 0FFFFFA8000000022h
                mov     r10, 3FFFFFFFFFFFFFFFh
                mov     r8, [r14+28h]
                mov     r9, 0FFFFFA8000000020h
                test    rcx, r8
                jnz     loc_14022CED7
                test    rax, r8
                jnz     loc_14022CED7
                mov     rax, r9
                movzx   ecx, word ptr [r12+rax]
                lea     rsi, [r12+rax]
                mov     rax, [r12+rdi]
                and     rax, r10
                test    cx, cx
                jz      short loc_14022CDB9
                cmp     cx, r13w
                jnz     short loc_14022CD98
                test    rax, rax
                jnz     short loc_14022CDB9
                jmp     short loc_14022CDAB
; ---------------------------------------------------------------------------

loc_14022CD98:                          ; CODE XREF: sub_14022CA60+32F↑j
                cmp     cx, 2
                jnz     loc_14022CED7
                test    rax, rax
                jz      loc_14022CED7

loc_14022CDAB:                          ; CODE XREF: sub_14022CA60+336↑j
                mov     rax, r15
                test    byte ptr [r12+rax], 8
                jz      loc_14022CED7

loc_14022CDB9:                          ; CODE XREF: sub_14022CA60+329↑j
                                        ; sub_14022CA60+334↑j
                mov     rcx, r14
                xor     bl, bl
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022CDE5
                mov     rax, 0FFFFFA8000000010h
                mov     rax, rax
                mov     ecx, [r12+rax]
                bt      rcx, 0Ah
                jnb     short loc_14022CDE5
                movzx   ebx, r13b
                jmp     short loc_14022CE2F
; ---------------------------------------------------------------------------

loc_14022CDE5:                          ; CODE XREF: sub_14022CA60+365↑j
                                        ; sub_14022CA60+37D↑j
                mov     r9, 0FFFFF68000000000h
                mov     rcx, r9
                mov     rax, 3FFFFFFF78h
                add     rcx, rax
                mov     rax, rdx
                mov     rdx, [r12+rax]
                mov     rax, 8000000000000000h
                or      rdx, rax
                cmp     rdx, rcx
                ja      short loc_14022CE2F
                mov     rax, r9
                cmp     rdx, rax
                jb      short loc_14022CE2F
                mov     rax, r11
                test    byte ptr [r12+rax], 20h
                movzx   ebx, bl
                cmovnz  ebx, r13d

loc_14022CE2F:                          ; CODE XREF: sub_14022CA60+383↑j
                                        ; sub_14022CA60+3B6↑j ...
                mov     rax, cs:qword_140C4E4C8
                shr     r8, 27h
                and     r8d, 3FFh
                mov     rdi, [rax+r8*8]
                test    bl, bl
                jz      short loc_14022CE67
                mov     r8d, 4
                mov     [rsp+0F8h+var_98], rsi
                mov     rdx, r13
                mov     rcx, rdi
                call    sub_140232160
                test    eax, eax
                jz      loc_14022CEF7

loc_14022CE67:                          ; CODE XREF: sub_14022CA60+3E7↑j
                lea     rax, unk_140C50C00
                cmp     rdi, rax
                jnz     short loc_14022CEA7
                mov     rdx, gs:20h
                mov     eax, [rdx+831Ch]
                cmp     eax, r13d
                jb      short loc_14022CEA7
                mov     r8d, 0FFFFFFFFh
                nop     dword ptr [rax]

loc_14022CE90:                          ; CODE XREF: sub_14022CA60+445↓j
                cmp     eax, r8d
                jz      short loc_14022CEA7
                lea     ecx, [rax-1]
                lock cmpxchg [rdx+831Ch], ecx
                jz      short loc_14022CED7
                cmp     eax, r13d
                jnb     short loc_14022CE90

loc_14022CEA7:                          ; CODE XREF: sub_14022CA60+411↑j
                                        ; sub_14022CA60+425↑j ...
                mov     r8d, 0FFFFFFFFh
                mov     rdx, r13
                mov     rcx, rdi
                call    sub_1403438BC
                test    eax, eax
                jnz     short loc_14022CED7
                mov     [rsp+0F8h+var_98], rsi
                test    bl, bl
                jz      short loc_14022CEF7
                mov     rdx, r13
                mov     rcx, rdi
                call    sub_14026B700
                mov     [rsp+0F8h+var_98], rsi
                jmp     short loc_14022CEF7
; ---------------------------------------------------------------------------

loc_14022CED7:                          ; CODE XREF: sub_14022CA60+304↑j
                                        ; sub_14022CA60+30D↑j ...
                mov     rax, 0FFFFFA8000000020h
                mov     rax, rax
                inc     word ptr [r12+rax]
                lea     r14, [r12+rax]
                mov     [rsp+0F8h+var_98], r14
                mov     r14, [rsp+0F8h+var_C8]

loc_14022CEF7:                          ; CODE XREF: sub_14022CA60+401↑j
                                        ; sub_14022CA60+463↑j ...
                mov     rax, 0FFFFFA8000000008h
                mov     rax, rax
                add     rax, r12
                mov     [rsp+0F8h+var_60], rax
                mov     rdi, [rax]
                mov     rax, 8000000000000000h
                or      rdi, rax
                mov     [rsp+0F8h+var_68], rdi
                mov     rax, r15
                lea     r15, [r12+rax]
                xor     esi, esi
                movzx   eax, byte ptr [r15]
                mov     [rsp+0F8h+var_48], r15
                test    al, 20h
                jz      loc_14022CFCB
                mov     r13, 7FFFFFFFFFFFFFFFh
                mov     rdi, 0FFFFFA8000000018h
                nop     dword ptr [rax+rax+00000000h]

loc_14022CF60:                          ; CODE XREF: sub_14022CA60+55B↓j
                lock and [r12+rdi], r13
                movzx   eax, byte ptr [r15]
                mov     ebx, esi
                mov     [rsp+0F8h+arg_18], al
                test    al, 20h
                jz      short loc_14022CFAD

loc_14022CF76:                          ; CODE XREF: sub_14022CA60+54B↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jnz     short loc_14022CF9C
                mov     eax, cs:dword_140CFC41C
                test    al, 40h
                jz      short loc_14022CF9C
                call    sub_140390EA0
                test    al, al
                jz      short loc_14022CF9C
                mov     ecx, ebx
                call    sub_1403900C0
                jmp     short loc_14022CF9E
; ---------------------------------------------------------------------------

loc_14022CF9C:                          ; CODE XREF: sub_14022CA60+51E↑j
                                        ; sub_14022CA60+528↑j ...
                pause

loc_14022CF9E:                          ; CODE XREF: sub_14022CA60+53A↑j
                movzx   eax, byte ptr [r15]
                mov     [rsp+0F8h+arg_18], al
                test    al, 20h
                jnz     short loc_14022CF76

loc_14022CFAD:                          ; CODE XREF: sub_14022CA60+514↑j
                mov     rcx, r14
                call    sub_1402DAA00
                movzx   eax, byte ptr [r15]
                test    al, 20h
                jnz     short loc_14022CF60
                mov     rdi, [rsp+0F8h+var_68]
                mov     r13d, 1

loc_14022CFCB:                          ; CODE XREF: sub_14022CA60+4DE↑j
                or      al, 20h
                mov     [r15], al
                mov     r14, 0FFFFFA8000000018h
                mov     rax, [r12+r14]
                shr     rax, 3Eh
                test    al, 1
                jnz     short loc_14022CFF9
                test    byte ptr [rdi], 20h
                jnz     short loc_14022CFF9
                xor     r8d, r8d
                mov     rdx, r13
                mov     rcx, rdi
                call    sub_1402C67E0

loc_14022CFF9:                          ; CODE XREF: sub_14022CA60+584↑j
                                        ; sub_14022CA60+589↑j
                mov     r8, 7FFFFFFFFFFFFFFFh
                lock and [r12+r14], r8
                mov     rdi, [rsp+0F8h+var_A0]
                nop     dword ptr [rax]

loc_14022D010:                          ; CODE XREF: sub_14022CA60+5E7↓j
                                        ; sub_14022CA60+63C↓j ...
                mov     rbx, [rdi]
                test    bl, 1
                jz      short loc_14022D01D
                mov     rax, rbx
                jmp     short loc_14022D066
; ---------------------------------------------------------------------------

loc_14022D01D:                          ; CODE XREF: sub_14022CA60+5B6↑j
                bt      rbx, 0Ah
                jb      loc_14022D0F5
                bt      rbx, 0Bh
                jnb     loc_14022D0F5
                test    rbx, rbx
                jz      short loc_14022D049
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14022D049
                test    rax, rbx
                jz      short loc_14022D010

loc_14022D049:                          ; CODE XREF: sub_14022CA60+5D6↑j
                                        ; sub_14022CA60+5E2↑j
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_14022D066
                test    bl, 10h
                jnz     short loc_14022D066
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_14022D066:                          ; CODE XREF: sub_14022CA60+5BB↑j
                                        ; sub_14022CA60+5F6↑j ...
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rdx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000028h
                add     rdx, rdx
                mov     rax, rax
                mov     rcx, [rax+rdx*8]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      loc_14022D010
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                lea     r14, [rax+rdx*8]
                mov     [rsp+0F8h+var_7C], esi
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jnb     short loc_14022D0E6

loc_14022D0C0:                          ; CODE XREF: sub_14022CA60+671↓j
                                        ; sub_14022CA60+67A↓j
                lea     rcx, [rsp+0F8h+var_7C]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_14022D0C0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_14022D0C0
                mov     r8, 7FFFFFFFFFFFFFFFh

loc_14022D0E6:                          ; CODE XREF: sub_14022CA60+65E↑j
                cmp     [rdi], rbx
                jz      short loc_14022D0F8
                lock and [r14+18h], r8
                jmp     loc_14022D010
; ---------------------------------------------------------------------------

loc_14022D0F5:                          ; CODE XREF: sub_14022CA60+5C2↑j
                                        ; sub_14022CA60+5CD↑j
                mov     r14, rsi

loc_14022D0F8:                          ; CODE XREF: sub_14022CA60+689↑j
                mov     rbx, rdi
                mov     rdx, 0FFFFF6FB7DBED000h
                mov     rdi, [rbx]
                mov     rsi, rdi
                mov     rax, rdx
                mov     r9, 0FFFFF6FB7DBED7F8h
                cmp     rbx, rax
                jb      short loc_14022D18C
                mov     rax, r9
                cmp     rbx, rax
                ja      short loc_14022D18C
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022D182
                test    sil, 1
                jz      short loc_14022D182
                test    sil, 20h
                jz      short loc_14022D140
                test    sil, 42h
                jnz     short loc_14022D182

loc_14022D140:                          ; CODE XREF: sub_14022CA60+6D8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14022D182
                or      rsi, 20h
                mov     rax, rbx
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rsi, rdi
                test    al, 42h
                jz      short loc_14022D182
                or      rsi, 42h

loc_14022D182:                          ; CODE XREF: sub_14022CA60+6CC↑j
                                        ; sub_14022CA60+6D2↑j ...
                mov     rdx, 0FFFFF6FB7DBED000h

loc_14022D18C:                          ; CODE XREF: sub_14022CA60+6BB↑j
                                        ; sub_14022CA60+6C3↑j
                mov     [rsp+0F8h+var_A8], rsi
                test    sil, 1
                jz      loc_14022D625
                mov     rax, [rsp+0F8h+var_90]
                mov     rcx, r14
                test    rax, rax
                jz      short loc_14022D1DC
                mov     edx, [rax+50h]
                and     edx, 7
                call    sub_14022FC60
                cmp     edx, eax
                jbe     short loc_14022D1C4
                movzx   eax, byte ptr [r14+23h]
                and     al, 0F8h
                or      al, dl
                mov     [r14+23h], al

loc_14022D1C4:                          ; CODE XREF: sub_14022CA60+755↑j
                lock and [r14+18h], r8
                mov     rcx, [rsp+0F8h+var_C8]
                mov     dl, 11h
                call    sub_140297330
                xor     eax, eax
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022D1DC:                          ; CODE XREF: sub_14022CA60+746↑j
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14022D27E
                mov     rcx, [r14+10h]
                bt      rcx, 0Ah
                jnb     loc_14022D27E
                mov     rax, [r14+28h]
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 3
                jz      short loc_14022D27E
                mov     rax, cs:qword_140C4DDC0
                mov     r11, rcx
                test    rax, rax
                jz      short loc_14022D221
                test    r11b, 10h
                jnz     short loc_14022D221
                not     rax
                and     r11, rax

loc_14022D221:                          ; CODE XREF: sub_14022CA60+7B3↑j
                                        ; sub_14022CA60+7B9↑j
                sar     r11, 10h
                mov     r10, [r11]
                mov     eax, [r10+38h]
                test    al, 20h
                jz      short loc_14022D27E
                mov     r10, [r10+60h]
                mov     r10, [r10+28h]
                test    r10, r10
                jz      short loc_14022D27E
                mov     rax, r10
                and     rax, 0FFFFFFFFFFFFFFF8h
                cmp     rax, 8
                jz      short loc_14022D27E
                movzx   eax, r10b
                and     al, 3
                cmp     al, 2
                jz      short loc_14022D27E
                mov     rax, [rsp+0F8h+var_88]
                mov     rdi, 0FFFF800000000000h
                cmp     rax, rdi
                jb      loc_14022D315
                test    byte ptr cs:dword_140CFC400+2, 1
                jz      short loc_14022D27E
                test    cl, 40h
                jnz     loc_14022D36C

loc_14022D27E:                          ; CODE XREF: sub_14022CA60+783↑j
                                        ; sub_14022CA60+792↑j ...
                mov     rax, [r14+18h]
                mov     r10, 3FFFFFFFFFFFFFFFh
                mov     rbx, 7FFFFFFFFFFFFFFFh
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     rcx, r10
                xor     rcx, rax
                mov     [r14+18h], rcx
                lock and [r14+18h], rbx
                xor     r14d, r14d
                mov     [rsp+0F8h+var_78], r14d
                mov     rdi, 0FFFFFA8000000018h
                lock bts qword ptr [r12+rdi], 3Fh ; '?'
                jnb     short loc_14022D2F9
                nop     word ptr [rax+rax+00h]

loc_14022D2D0:                          ; CODE XREF: sub_14022CA60+884↓j
                                        ; sub_14022CA60+88D↓j
                lea     rcx, [rsp+0F8h+var_78]
                call    sub_1402C8C70
                mov     rax, [r12+rdi]
                test    rax, rax
                js      short loc_14022D2D0
                lock bts qword ptr [r12+rdi], 3Fh ; '?'
                jb      short loc_14022D2D0
                mov     r10, 3FFFFFFFFFFFFFFFh

loc_14022D2F9:                          ; CODE XREF: sub_14022CA60+868↑j
                movzx   eax, byte ptr [r15]
                and     al, 0DFh
                mov     [r15], al
                mov     rax, [rsp+0F8h+var_98]
                movzx   edx, word ptr [rax]
                test    dx, dx
                jz      loc_14022DE03
                jmp     short loc_14022D391
; ---------------------------------------------------------------------------

loc_14022D315:                          ; CODE XREF: sub_14022CA60+806↑j
                mov     rcx, rax
                call    sub_14026A130
                mov     rdx, rax
                test    rax, rax
                jz      short loc_14022D36C
                mov     ecx, [rax+30h]
                mov     eax, ecx
                and     al, 70h
                cmp     al, 20h ; ' '
                jnz     short loc_14022D36C
                and     ecx, 0F80h
                cmp     ecx, 80h
                jz      loc_14022D27E
                mov     eax, [rdx+40h]
                bt      eax, 1Bh
                jnb     short loc_14022D355
                test    r10b, 4
                jz      loc_14022D27E

loc_14022D355:                          ; CODE XREF: sub_14022CA60+8E9↑j
                test    cs:dword_140CFC400, 400h
                jz      short loc_14022D36C
                test    byte ptr [r11+22h], 2
                jnz     loc_14022D27E

loc_14022D36C:                          ; CODE XREF: sub_14022CA60+818↑j
                                        ; sub_14022CA60+8C3↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], rax
                mov     rcx, [rsp+0F8h+var_C8]
                mov     dl, 11h
                call    sub_140297330
                mov     eax, 0C0000428h
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022D391:                          ; CODE XREF: sub_14022CA60+8B3↑j
                mov     r11, [rsp+0F8h+var_C8]
                mov     ecx, 0FFFFh
                add     dx, cx
                mov     [rax], dx
                jnz     short loc_14022D3B3
                mov     rcx, r11
                call    sub_1402303F0
                test    eax, eax
                jnz     loc_14022D5B7

loc_14022D3B3:                          ; CODE XREF: sub_14022CA60+941↑j
                mov     r8, [r11+28h]
                mov     rax, 1000000000h
                test    rax, r8
                jnz     loc_14022D5DA
                mov     rax, 2000000000000h
                test    rax, r8
                jnz     loc_14022D5DA
                mov     r9, [r12+rdi]
                mov     rax, r9
                and     rax, r10
                test    dx, dx
                jz      short loc_14022D41B
                cmp     dx, 1
                jnz     short loc_14022D3F9
                test    rax, rax
                jnz     short loc_14022D416
                jmp     short loc_14022D40C
; ---------------------------------------------------------------------------

loc_14022D3F9:                          ; CODE XREF: sub_14022CA60+990↑j
                cmp     dx, 2
                jnz     loc_14022D5DA
                test    rax, rax
                jz      loc_14022D5DA

loc_14022D40C:                          ; CODE XREF: sub_14022CA60+997↑j
                test    byte ptr [r15], 8
                jz      loc_14022D5DA

loc_14022D416:                          ; CODE XREF: sub_14022CA60+995↑j
                mov     edi, r14d
                jmp     short loc_14022D41E
; ---------------------------------------------------------------------------

loc_14022D41B:                          ; CODE XREF: sub_14022CA60+98A↑j
                mov     edi, r13d

loc_14022D41E:                          ; CODE XREF: sub_14022CA60+9B9↑j
                mov     r15, 0FFFFF68000000000h
                mov     rax, r15
                mov     rdx, [rsp+0F8h+var_60]
                mov     r10, 3FFFFFFF78h
                add     r10, rax
                mov     rax, 8000000000000000h
                mov     rdx, [rdx]
                or      rdx, rax
                cmp     rdx, r10
                ja      short loc_14022D45D
                mov     rax, r15
                cmp     rdx, rax
                jnb     short loc_14022D480

loc_14022D45D:                          ; CODE XREF: sub_14022CA60+9F3↑j
                mov     r15, 0FFFFFA8000000023h
                mov     rax, r15
                lea     rcx, [r12+rax]
                movzx   eax, byte ptr [r12+rax]
                test    al, 20h
                jz      short loc_14022D48A
                and     al, 0DFh
                mov     [rcx], al
                jmp     loc_14022D5B3
; ---------------------------------------------------------------------------

loc_14022D480:                          ; CODE XREF: sub_14022CA60+9FB↑j
                mov     r15, 0FFFFFA8000000023h

loc_14022D48A:                          ; CODE XREF: sub_14022CA60+A15↑j
                mov     rcx, r11
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022D4B3
                mov     rax, 0FFFFFA8000000010h
                mov     rax, rax
                mov     ecx, [r12+rax]
                bt      rcx, 0Ah
                jnb     short loc_14022D4B3
                mov     r14d, r13d
                jmp     short loc_14022D4E9
; ---------------------------------------------------------------------------

loc_14022D4B3:                          ; CODE XREF: sub_14022CA60+A34↑j
                                        ; sub_14022CA60+A4C↑j
                cmp     rdx, r10
                ja      short loc_14022D4D9
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rdx, rax
                jb      short loc_14022D4D9
                mov     rax, r15
                test    byte ptr [r12+rax], 20h
                jz      short loc_14022D4D9
                mov     r14d, r13d
                jmp     short loc_14022D4E9
; ---------------------------------------------------------------------------

loc_14022D4D9:                          ; CODE XREF: sub_14022CA60+A56↑j
                                        ; sub_14022CA60+A68↑j ...
                cmp     edi, 1
                jnz     short loc_14022D4E9
                shr     r9, 3Eh
                test    dil, r9b
                cmovnz  r14d, r13d

loc_14022D4E9:                          ; CODE XREF: sub_14022CA60+A51↑j
                                        ; sub_14022CA60+A77↑j ...
                mov     rax, cs:qword_140C4E4C8
                shr     r8, 27h
                and     r8d, 3FFh
                mov     rbx, [rax+r8*8]
                cmp     r14d, 1
                jnz     short loc_14022D515
                mov     rdx, r13
                mov     rcx, rbx
                call    sub_14026B700
                mov     r11, [rsp+0F8h+var_C8]

loc_14022D515:                          ; CODE XREF: sub_14022CA60+AA3↑j
                lea     rax, unk_140C50C00
                cmp     rbx, rax
                jnz     short loc_14022D5A0
                mov     r8, gs:20h
                mov     r9d, 0FFFFFFFFh
                movsxd  rdx, dword ptr [r8+831Ch]
                cmp     edx, r9d
                jz      short loc_14022D5A0
                lea     rax, [rdx+1]
                cmp     rax, 100h
                ja      short loc_14022D574
                nop     dword ptr [rax+rax+00000000h]

loc_14022D550:                          ; CODE XREF: sub_14022CA60+B12↓j
                lea     ecx, [rdx+1]
                mov     eax, edx
                lock cmpxchg [r8+831Ch], ecx
                movsxd  rdx, eax
                jz      short loc_14022D5A9
                cmp     edx, r9d
                jz      short loc_14022D574
                lea     rax, [rdx+1]
                cmp     rax, 100h
                jbe     short loc_14022D550

loc_14022D574:                          ; CODE XREF: sub_14022CA60+AE6↑j
                                        ; sub_14022CA60+B06↑j
                mov     ecx, 0C0h
                cmp     edx, ecx
                jle     short loc_14022D59B
                cmp     edx, r9d
                jz      short loc_14022D59B
                mov     eax, edx
                lock cmpxchg [r8+831Ch], ecx
                jnz     short loc_14022D59B
                lea     eax, [rdx-0C0h]
                movsxd  r13, eax
                inc     r13

loc_14022D59B:                          ; CODE XREF: sub_14022CA60+B1B↑j
                                        ; sub_14022CA60+B20↑j ...
                test    r13, r13
                jz      short loc_14022D5A9

loc_14022D5A0:                          ; CODE XREF: sub_14022CA60+ABF↑j
                                        ; sub_14022CA60+ADA↑j
                lock xadd [rbx+1C00h], r13

loc_14022D5A9:                          ; CODE XREF: sub_14022CA60+B01↑j
                                        ; sub_14022CA60+B3E↑j
                mov     rbx, 7FFFFFFFFFFFFFFFh

loc_14022D5B3:                          ; CODE XREF: sub_14022CA60+A1B↑j
                test    edi, edi
                jz      short loc_14022D5DA

loc_14022D5B7:                          ; CODE XREF: sub_14022CA60+94D↑j
                mov     rax, 2AAAAAAAAAAAAAABh
                mov     rcx, r11
                imul    r12
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                call    sub_140278860

loc_14022D5DA:                          ; CODE XREF: sub_14022CA60+964↑j
                                        ; sub_14022CA60+977↑j ...
                mov     r14, 0FFFFFA8000000018h
                lock and [r12+r14], rbx
                mov     rcx, [rsp+0F8h+var_C0]
                xor     r9d, r9d
                mov     r8, [rsp+0F8h+arg_8]
                mov     rdx, rsi
                inc     dword ptr gs:2E98h
                mov     [rsp+0F8h+var_D8], rcx
                mov     rcx, [rsp+0F8h+arg_0]
                call    sub_14022B420
                test    eax, eax
                mov     ecx, 110h
                cmovns  eax, ecx
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022D625:                          ; CODE XREF: sub_14022CA60+735↑j
                test    rsi, rsi
                jnz     short loc_14022D640

loc_14022D62A:                          ; CODE XREF: sub_14022CA60+1318↓j
                mov     rcx, [rsp+0F8h+var_C8]
                mov     dl, 11h
                call    sub_140297330

loc_14022D636:                          ; CODE XREF: sub_14022CA60+10A5↓j
                mov     eax, 0C0000005h
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022D640:                          ; CODE XREF: sub_14022CA60+BC8↑j
                mov     r8, [rsp+0F8h+var_70]
                xor     r12d, r12d
                mov     r15, [r8]
                mov     rax, rdx
                cmp     r8, rax
                jb      short loc_14022D6CB
                mov     rax, r9
                cmp     r8, rax
                ja      short loc_14022D6CB
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022D6C1
                test    r15b, 1
                jz      short loc_14022D6C1
                test    r15b, 20h
                jz      short loc_14022D679
                test    r15b, 42h
                jnz     short loc_14022D6C1

loc_14022D679:                          ; CODE XREF: sub_14022CA60+C11↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14022D6C1
                mov     rax, r8
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r15
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r15
                mov     r15, rdx
                test    al, 42h
                jz      short loc_14022D6C1
                or      r15, 42h

loc_14022D6C1:                          ; CODE XREF: sub_14022CA60+C05↑j
                                        ; sub_14022CA60+C0B↑j ...
                mov     rdx, 0FFFFF6FB7DBED000h

loc_14022D6CB:                          ; CODE XREF: sub_14022CA60+BF4↑j
                                        ; sub_14022CA60+BFC↑j
                bt      r15, 0Ah
                jnb     short loc_14022D739
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, r15
                test    rcx, rcx
                jz      short loc_14022D6F0
                test    r15b, 10h
                jnz     short loc_14022D6F0
                mov     rax, rcx
                not     rax
                and     rax, r15

loc_14022D6F0:                          ; CODE XREF: sub_14022CA60+C7F↑j
                                        ; sub_14022CA60+C85↑j
                shr     rax, 20h
                mov     ecx, 0FFFFFFFFh
                cmp     rax, rcx
                jnz     short loc_14022D739
                mov     r14, [rsp+0F8h+arg_0]
                mov     r12, r15
                shr     r12, 5
                and     r12d, 1Fh
                mov     eax, r12d
                and     eax, 0FFFFFFF8h
                cmp     eax, 10h
                jnz     short loc_14022D727
                test    byte ptr [r14+45h], 8
                jnz     loc_14022DDA1

loc_14022D727:                          ; CODE XREF: sub_14022CA60+CBA↑j
                mov     r13, [rsp+0F8h+var_B0]
                mov     rdx, [rsp+0F8h+arg_8]
                jmp     loc_14022D95C
; ---------------------------------------------------------------------------

loc_14022D739:                          ; CODE XREF: sub_14022CA60+C70↑j
                                        ; sub_14022CA60+C9C↑j
                test    r15b, 8
                jnz     loc_14022D947
                mov     rax, rsi
                shr     rax, 5
                and     eax, 1Fh
                mov     r8d, eax
                mov     r12d, eax
                shr     r8d, 3
                cmp     r8d, 2
                jnz     short loc_14022D771
                mov     rax, [rsp+0F8h+arg_0]
                movzx   eax, byte ptr [rax+45h]
                test    al, 8
                jnz     loc_14022DDA1

loc_14022D771:                          ; CODE XREF: sub_14022CA60+CFB↑j
                mov     rax, rdx
                cmp     rbx, rax
                jb      short loc_14022D7E8
                mov     rax, r9
                cmp     rbx, rax
                ja      short loc_14022D7E8
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022D7E8
                test    dil, 1
                jz      loc_14022D816
                test    dil, 20h
                jz      short loc_14022D7A0
                test    dil, 42h
                jnz     short loc_14022D7E8

loc_14022D7A0:                          ; CODE XREF: sub_14022CA60+D38↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14022D7E8
                mov     rax, rbx
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_14022D7E8
                or      rdi, 42h

loc_14022D7E8:                          ; CODE XREF: sub_14022CA60+D17↑j
                                        ; sub_14022CA60+D1F↑j ...
                test    dil, 1
                jz      short loc_14022D816
                mov     rdx, [rsp+0F8h+arg_8]
                test    rdx, rdx
                jz      loc_14022D94F
                test    rdi, 0A00h
                jnz     loc_14022D94F
                mov     ebx, 0C0000005h
                jmp     loc_14022D919
; ---------------------------------------------------------------------------

loc_14022D816:                          ; CODE XREF: sub_14022CA60+D2E↑j
                                        ; sub_14022CA60+D8C↑j
                mov     rdx, [rsp+0F8h+arg_8]
                lea     rcx, qword_140011808
                mov     rax, r12
                mov     rbx, r12
                and     eax, 7
                test    rdx, rdx
                movsx   ecx, byte ptr [rax+rcx]
                movzx   eax, dl
                cmovz   r13d, eax
                movsx   eax, r13b
                sub     ecx, eax
                cmp     ecx, 0Ah
                jge     short loc_14022D851
                mov     ebx, 0C0000005h
                jmp     loc_14022D919
; ---------------------------------------------------------------------------

loc_14022D851:                          ; CODE XREF: sub_14022CA60+DE5↑j
                mov     r13, [rsp+0F8h+var_B0]
                cmp     r8d, 2
                jnz     loc_14022D940
                mov     rcx, [rsp+0F8h+var_C0]
                test    r13, r13
                jz      short loc_14022D87A
                mov     rax, rcx
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 1
                jz      loc_14022D940

loc_14022D87A:                          ; CODE XREF: sub_14022CA60+E08↑j
                call    sub_140338B70
                test    eax, eax
                jnz     short loc_14022D88D
                mov     ebx, 0C0000005h
                jmp     loc_14022D919
; ---------------------------------------------------------------------------

loc_14022D88D:                          ; CODE XREF: sub_14022CA60+E21↑j
                and     ebx, 0Fh
                and     rdi, 0FFFFFFFFFFFFFC1Fh
                shl     rbx, 5
                or      rbx, rdi
                mov     rdi, [rsp+0F8h+var_A0]
                mov     rcx, rdi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14022D911
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022D8E3
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022D8D3
                test    bl, 1
                jz      short loc_14022D8D3
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022D8D3:                          ; CODE XREF: sub_14022CA60+E5F↑j
                                        ; sub_14022CA60+E64↑j
                mov     rdx, rbx
                mov     [rdi], rbx
                mov     rcx, rdi
                call    sub_140349620
                jmp     short loc_14022D914
; ---------------------------------------------------------------------------

loc_14022D8E3:                          ; CODE XREF: sub_14022CA60+E56↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022D911
                test    bl, 1
                jz      short loc_14022D911
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022D911:                          ; CODE XREF: sub_14022CA60+E4D↑j
                                        ; sub_14022CA60+E9D↑j ...
                mov     [rdi], rbx

loc_14022D914:                          ; CODE XREF: sub_14022CA60+E81↑j
                mov     ebx, 80000001h

loc_14022D919:                          ; CODE XREF: sub_14022CA60+DB1↑j
                                        ; sub_14022CA60+DEC↑j ...
                test    r14, r14
                jz      short loc_14022D92D
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], rax

loc_14022D92D:                          ; CODE XREF: sub_14022CA60+EBC↑j
                mov     rcx, [rsp+0F8h+var_C8]
                mov     dl, 11h
                call    sub_140297330
                mov     eax, ebx
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022D940:                          ; CODE XREF: sub_14022CA60+DFA↑j
                                        ; sub_14022CA60+E14↑j
                mov     rbx, [rsp+0F8h+var_A0]
                jmp     short loc_14022D954
; ---------------------------------------------------------------------------

loc_14022D947:                          ; CODE XREF: sub_14022CA60+CDD↑j
                mov     rdx, [rsp+0F8h+arg_8]

loc_14022D94F:                          ; CODE XREF: sub_14022CA60+D99↑j
                                        ; sub_14022CA60+DA6↑j
                mov     r13, [rsp+0F8h+var_B0]

loc_14022D954:                          ; CODE XREF: sub_14022CA60+EE5↑j
                mov     r14, [rsp+0F8h+arg_0]

loc_14022D95C:                          ; CODE XREF: sub_14022CA60+CD4↑j
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rsi
                test    rcx, rcx
                jz      short loc_14022D97A
                test    sil, 10h
                jnz     short loc_14022D97A
                mov     rax, rcx
                not     rax
                and     rax, rsi

loc_14022D97A:                          ; CODE XREF: sub_14022CA60+F09↑j
                                        ; sub_14022CA60+F0F↑j
                mov     rdi, 0FFFF800000000000h
                bt      rax, 0Ah
                jb      loc_14022DC3B
                bt      rax, 0Bh
                jb      loc_14022DC3B
                test    al, 4
                jnz     loc_14022DC3B
                mov     eax, r12d
                and     eax, 5
                cmp     al, 5
                jnz     loc_14022DC3B
                test    rdx, rdx
                jnz     short loc_14022D9CC
                lea     rcx, [rsp+0F8h+var_A8]
                call    sub_1402805F0
                shr     al, 5
                and     al, 5
                cmp     al, 4
                jz      loc_14022DC3B

loc_14022D9CC:                          ; CODE XREF: sub_14022CA60+F53↑j
                mov     rax, [rsp+0F8h+var_58]
                movzx   eax, byte ptr [rax+0B8h]
                test    al, 7
                jnz     short loc_14022D9FD
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     qword ptr [rcx+4F0h], 0
                jnz     loc_14022DC3B

loc_14022D9FD:                          ; CODE XREF: sub_14022CA60+F7D↑j
                test    byte ptr cs:dword_140CFC400+2, 1
                jz      short loc_14022DA17
                cmp     [rsp+0F8h+var_88], rdi
                jb      short loc_14022DA17
                test    r12b, 2
                jnz     loc_14022DC3B

loc_14022DA17:                          ; CODE XREF: sub_14022CA60+FA4↑j
                                        ; sub_14022CA60+FAB↑j
                mov     rbx, [rsp+0F8h+var_50]
                mov     [rsp+0F8h+var_74], 0
                mov     r12, 0FFFFFA8000000018h
                lock bts qword ptr [rbx+r12], 3Fh ; '?'
                jnb     short loc_14022DA5F
                nop     dword ptr [rax]

loc_14022DA40:                          ; CODE XREF: sub_14022CA60+FF4↓j
                                        ; sub_14022CA60+FFD↓j
                lea     rcx, [rsp+0F8h+var_74]
                call    sub_1402C8C70
                mov     rax, [rbx+r12]
                test    rax, rax
                js      short loc_14022DA40
                lock bts qword ptr [rbx+r12], 3Fh ; '?'
                jb      short loc_14022DA40

loc_14022DA5F:                          ; CODE XREF: sub_14022CA60+FDB↑j
                mov     rcx, [rsp+0F8h+var_48]
                movzx   eax, byte ptr [rcx]
                and     al, 0DFh
                mov     [rcx], al
                mov     rcx, [rsp+0F8h+var_C8]
                call    sub_14027B630
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+r12], rax
                cmp     [rsp+0F8h+var_90], 0
                jz      short loc_14022DAB2
                test    r13, r13
                jz      short loc_14022DAAB
                mov     rbx, [rsp+0F8h+var_C0]
                and     rbx, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rbx], 1
                jnz     short loc_14022DAAB
                test    dword ptr [rbx+50h], 4000h
                jnz     short loc_14022DAC0

loc_14022DAAB:                          ; CODE XREF: sub_14022CA60+1032↑j
                                        ; sub_14022CA60+1040↑j
                xor     eax, eax
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022DAB2:                          ; CODE XREF: sub_14022CA60+102D↑j
                mov     rax, [rsp+0F8h+var_C0]
                mov     rbx, rax
                and     rbx, 0FFFFFFFFFFFFFFFEh
                jmp     short loc_14022DAC5
; ---------------------------------------------------------------------------

loc_14022DAC0:                          ; CODE XREF: sub_14022CA60+1049↑j
                mov     rax, [rsp+0F8h+var_C0]

loc_14022DAC5:                          ; CODE XREF: sub_14022CA60+105E↑j
                test    r13, r13
                jz      short loc_14022DAE8
                cmp     byte ptr [rbx], 1
                jz      short loc_14022DAF6
                test    r13, r13
                jz      short loc_14022DAE8
                cmp     byte ptr [rbx], 3
                jz      short loc_14022DAF6
                test    r13, r13
                jz      short loc_14022DAE8
                cmp     byte ptr [rbx], 6
                jz      short loc_14022DAF6
                test    r13, r13
                jnz     short loc_14022DB0B

loc_14022DAE8:                          ; CODE XREF: sub_14022CA60+1068↑j
                                        ; sub_14022CA60+1072↑j ...
                xor     edx, edx
                mov     rcx, rax
                call    sub_140338BE0
                cmp     al, 1
                jnz     short loc_14022DB0B

loc_14022DAF6:                          ; CODE XREF: sub_14022CA60+106D↑j
                                        ; sub_14022CA60+1077↑j ...
                test    r13, r13
                jz      short loc_14022DB00
                cmp     byte ptr [rbx], 6
                jz      short loc_14022DB0B

loc_14022DB00:                          ; CODE XREF: sub_14022CA60+1099↑j
                cmp     [rsp+0F8h+var_88], rdi
                jnb     loc_14022D636

loc_14022DB0B:                          ; CODE XREF: sub_14022CA60+1086↑j
                                        ; sub_14022CA60+1094↑j ...
                bt      r15, 0Ah
                jnb     short loc_14022DB3E
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, r15
                test    rcx, rcx
                jz      short loc_14022DB30
                test    r15b, 10h
                jnz     short loc_14022DB30
                mov     rax, rcx
                not     rax
                and     rax, r15

loc_14022DB30:                          ; CODE XREF: sub_14022CA60+10BF↑j
                                        ; sub_14022CA60+10C5↑j
                shr     rax, 20h
                mov     ecx, 0FFFFFFFFh
                cmp     rax, rcx
                jz      short loc_14022DB5F

loc_14022DB3E:                          ; CODE XREF: sub_14022CA60+10B0↑j
                lea     rcx, [rsp+0F8h+var_A8]
                mov     r15, rsi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14022DB5F
                mov     rdx, rsi
                lea     rcx, [rsp+0F8h+var_A8]
                call    sub_1402A8730
                mov     r15, rax

loc_14022DB5F:                          ; CODE XREF: sub_14022CA60+10DC↑j
                                        ; sub_14022CA60+10ED↑j
                shr     r15, 5
                mov     eax, r15d
                and     r15d, 18h
                and     eax, 2
                or      eax, 4
                cmp     r15d, 8
                jnz     short loc_14022DB7B
                or      eax, r15d
                jmp     short loc_14022DB84
; ---------------------------------------------------------------------------

loc_14022DB7B:                          ; CODE XREF: sub_14022CA60+1114↑j
                cmp     r15d, 18h
                jnz     short loc_14022DB84
                or      eax, r15d

loc_14022DB84:                          ; CODE XREF: sub_14022CA60+1119↑j
                                        ; sub_14022CA60+111F↑j
                mov     ecx, eax
                shl     rcx, 5
                call    sub_14027C6C0
                mov     rdx, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                mov     r11, [rsp+0F8h+var_70]
                cmp     r11, rax
                jb      short loc_14022DC1D
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r11, rax
                ja      short loc_14022DC1D
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022DBEF
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022DBE2
                test    dl, 1
                jz      short loc_14022DBE2
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14022DBE2:                          ; CODE XREF: sub_14022CA60+116E↑j
                                        ; sub_14022CA60+1173↑j
                mov     rcx, r11
                mov     [r11], rdx
                call    sub_140349620
                jmp     short loc_14022DC20
; ---------------------------------------------------------------------------

loc_14022DBEF:                          ; CODE XREF: sub_14022CA60+1165↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022DC1D
                test    dl, 1
                jz      short loc_14022DC1D
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14022DC1D:                          ; CODE XREF: sub_14022CA60+114A↑j
                                        ; sub_14022CA60+115C↑j ...
                mov     [r11], rdx

loc_14022DC20:                          ; CODE XREF: sub_14022CA60+118D↑j
                mov     r9, [rsp+0F8h+arg_8]
                xor     r8d, r8d
                mov     rdx, r11
                mov     rcx, r14
                call    sub_140226D20
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022DC3B:                          ; CODE XREF: sub_14022CA60+F29↑j
                                        ; sub_14022CA60+F34↑j ...
                bt      rsi, 0Ah
                jnb     short loc_14022DC6A
                test    byte ptr [r14+45h], 8
                jnz     loc_14022DDA1
                mov     r9, [rsp+0F8h+arg_10]
                mov     rdx, rbx
                mov     r8, [rsp+0F8h+var_C8]
                mov     rcx, r14
                call    sub_14026CF00
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022DC6A:                          ; CODE XREF: sub_14022CA60+11E0↑j
                bt      rsi, 0Bh
                jnb     short loc_14022DC9B
                mov     r9, [rsp+0F8h+arg_10]
                mov     rdx, rbx
                mov     r8, [rsp+0F8h+var_C8]
                mov     rcx, r14
                mov     [rsp+0F8h+var_D8], r9
                mov     r9, [rsp+0F8h+arg_8]
                call    sub_14022DE20
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022DC9B:                          ; CODE XREF: sub_14022CA60+120F↑j
                lea     rcx, [rsp+0F8h+var_A8]
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14022DCB9
                mov     rdx, rsi
                lea     rcx, [rsp+0F8h+var_A8]
                call    sub_1402A8730
                mov     rsi, rax

loc_14022DCB9:                          ; CODE XREF: sub_14022CA60+1247↑j
                shr     sil, 2
                test    sil, 1
                jnz     loc_14022DD9A
                cmp     [rsp+0F8h+var_90], 0
                jz      short loc_14022DCFE
                test    r13, r13
                jz      short loc_14022DCEB
                mov     rbx, [rsp+0F8h+var_C0]
                and     rbx, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rbx], 1
                jnz     short loc_14022DCEB
                test    dword ptr [rbx+50h], 4000h
                jnz     short loc_14022DD0C

loc_14022DCEB:                          ; CODE XREF: sub_14022CA60+1272↑j
                                        ; sub_14022CA60+1280↑j
                mov     rcx, [rsp+0F8h+var_C8]
                mov     dl, 11h
                call    sub_140297330
                xor     eax, eax
                jmp     loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022DCFE:                          ; CODE XREF: sub_14022CA60+126D↑j
                mov     rax, [rsp+0F8h+var_C0]
                mov     rbx, rax
                and     rbx, 0FFFFFFFFFFFFFFFEh
                jmp     short loc_14022DD11
; ---------------------------------------------------------------------------

loc_14022DD0C:                          ; CODE XREF: sub_14022CA60+1289↑j
                mov     rax, [rsp+0F8h+var_C0]

loc_14022DD11:                          ; CODE XREF: sub_14022CA60+12AA↑j
                test    r13, r13
                jz      short loc_14022DD34
                cmp     byte ptr [rbx], 1
                jz      short loc_14022DD42
                test    r13, r13
                jz      short loc_14022DD34
                cmp     byte ptr [rbx], 3
                jz      short loc_14022DD42
                test    r13, r13
                jz      short loc_14022DD34
                cmp     byte ptr [rbx], 6
                jz      short loc_14022DD42
                test    r13, r13
                jnz     short loc_14022DD7E

loc_14022DD34:                          ; CODE XREF: sub_14022CA60+12B4↑j
                                        ; sub_14022CA60+12BE↑j ...
                xor     edx, edx
                mov     rcx, rax
                call    sub_140338BE0
                cmp     al, 1
                jnz     short loc_14022DD7E

loc_14022DD42:                          ; CODE XREF: sub_14022CA60+12B9↑j
                                        ; sub_14022CA60+12C3↑j ...
                test    r13, r13
                jz      short loc_14022DD4C
                cmp     byte ptr [rbx], 6
                jz      short loc_14022DD7E

loc_14022DD4C:                          ; CODE XREF: sub_14022CA60+12E5↑j
                cmp     [rsp+0F8h+var_88], rdi
                jb      short loc_14022DD7E
                mov     rcx, r15
                call    sub_14031C870
                test    eax, eax
                jnz     short loc_14022DD6C
                lea     rcx, [rsp+0F8h+var_A8]
                call    sub_1402805F0
                mov     r15, rax

loc_14022DD6C:                          ; CODE XREF: sub_14022CA60+12FD↑j
                shr     r15, 5
                and     r15b, 18h
                cmp     r15b, 10h
                jz      loc_14022D62A

loc_14022DD7E:                          ; CODE XREF: sub_14022CA60+12D2↑j
                                        ; sub_14022CA60+12E0↑j ...
                mov     r9, [rsp+0F8h+arg_8]
                mov     rcx, r14
                mov     r8, [rsp+0F8h+var_C8]
                mov     rdx, [rsp+0F8h+var_A0]
                call    sub_140226D20
                jmp     short loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022DD9A:                          ; CODE XREF: sub_14022CA60+1261↑j
                test    byte ptr [r14+45h], 8
                jz      short loc_14022DDB4

loc_14022DDA1:                          ; CODE XREF: sub_14022CA60+CC1↑j
                                        ; sub_14022CA60+D0B↑j ...
                mov     rcx, [rsp+0F8h+var_C8]
                mov     dl, 11h
                call    sub_140297330
                mov     eax, 0C0000434h
                jmp     short loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022DDB4:                          ; CODE XREF: sub_14022CA60+133F↑j
                mov     r9, [rsp+0F8h+arg_10]
                mov     rdx, rbx
                mov     r8, [rsp+0F8h+var_C8]
                mov     rcx, r14
                call    sub_14031A2D8
                jmp     short loc_14022DDE2
; ---------------------------------------------------------------------------

loc_14022DDCE:                          ; CODE XREF: sub_14022CA60+207↑j
                                        ; sub_14022CA60+212↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r12+rdi], rax

loc_14022DDDD:                          ; CODE XREF: sub_14022CA60+DD↑j
                                        ; sub_14022CA60+ED↑j
                mov     eax, 0C0000016h

loc_14022DDE2:                          ; CODE XREF: sub_14022CA60+777↑j
                                        ; sub_14022CA60+92C↑j ...
                mov     r14, [rsp+0F8h+var_38]
                mov     rbx, [rsp+0F8h+var_30]
                add     rsp, 0D0h
                pop     r15
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
byte_14022DE02  db 0CCh                 ; DATA XREF: .pdata:00000001400CB1CC↑o
                                        ; .pdata:00000001400CB1D8↑o
; ---------------------------------------------------------------------------

loc_14022DE03:                          ; CODE XREF: sub_14022CA60+8AD↑j
                                        ; DATA XREF: .pdata:00000001400CB1D8↑o ...
                mov     rcx, [rsp+0F8h+var_C8]
                call    sub_1403F41EC
; ---------------------------------------------------------------------------
                db 0CCh
sub_14022CA60   endp

algn_14022DE0E:                         ; DATA XREF: .pdata:00000001400CB1E4↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14022DE20   proc near               ; CODE XREF: sub_1402260D0+3F9↑p
                                        ; sub_14022CA60+1231↑p
                                        ; DATA XREF: ...

var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_78          = dword ptr -78h
var_74          = dword ptr -74h
var_70          = dword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
arg_0           = qword ptr  8
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h
arg_20          = qword ptr  28h

                mov     [rsp+arg_18], r9
                mov     [rsp+arg_10], r8
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 80h
                mov     r9, [rsp+0B8h+arg_20]
                xor     r15d, r15d
                mov     rax, [rcx+38h]
                mov     rdi, r8
                mov     r10, [rcx+10h]
                mov     r13, rdx
                mov     [rsp+0B8h+var_78], r15d
                mov     r11, rcx
                mov     [r9], r15
                mov     [rsp+0B8h+var_40], rax
                mov     [rsp+0B8h+var_68], r10
                mov     [rsp+0B8h+var_58], r15
                test    r8, r8
                jnz     loc_14022E05B
                mov     rcx, rdx
                call    sub_1402805F0
                mov     rbx, rax
                bt      rax, 0Bh
                jnb     loc_14022DF7E
                mov     r14, 0FFFFFFFFFh
                mov     r12, 0FFFFFA8000000028h

loc_14022DEA7:                          ; CODE XREF: sub_14022DE20+158↓j
                mov     r8, 0FFFFFA8000000000h
                mov     r9, 4000000000000h
                test    bl, 1
                jnz     loc_14022DF68
                test    rbx, rbx
                jz      short loc_14022DEDE
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14022DEDE
                test    rbx, rax
                jz      loc_14022DF68

loc_14022DEDE:                          ; CODE XREF: sub_14022DE20+A7↑j
                                        ; sub_14022DE20+B3↑j
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_14022DEFB
                test    bl, 10h
                jnz     short loc_14022DEFB
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_14022DEFB:                          ; CODE XREF: sub_14022DE20+CB↑j
                                        ; sub_14022DE20+D0↑j
                shr     rax, 0Ch
                and     rax, r14
                lea     rdx, [rax+rax*2]
                add     rdx, rdx
                mov     rax, r12
                test    [rax+rdx*8], r9
                jz      short loc_14022DF68
                mov     rax, r8
                lea     rsi, [rax+rdx*8]
                mov     [rsp+0B8h+var_74], r15d
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jnb     short loc_14022DF4C
                nop     word ptr [rax+rax+00000000h]

loc_14022DF30:                          ; CODE XREF: sub_14022DE20+121↓j
                                        ; sub_14022DE20+12A↓j
                lea     rcx, [rsp+0B8h+var_74]
                call    sub_1402C8C70
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_14022DF30
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_14022DF30

loc_14022DF4C:                          ; CODE XREF: sub_14022DE20+105↑j
                mov     rcx, r13
                call    sub_1402805F0
                cmp     rax, rbx
                jz      short loc_14022DF88
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], rax

loc_14022DF68:                          ; CODE XREF: sub_14022DE20+9E↑j
                                        ; sub_14022DE20+B8↑j ...
                mov     rcx, r13
                call    sub_1402805F0
                mov     rbx, rax
                bt      rax, 0Bh
                jb      loc_14022DEA7

loc_14022DF7E:                          ; CODE XREF: sub_14022DE20+6D↑j
                mov     eax, 0C0000434h
                jmp     loc_14022E8E9
; ---------------------------------------------------------------------------

loc_14022DF88:                          ; CODE XREF: sub_14022DE20+137↑j
                mov     rcx, [rsi+8]
                mov     rdx, 8000000000000000h
                mov     rax, rcx
                or      rax, rdx
                cmp     rax, r13
                jz      short loc_14022DFB5
                mov     rdx, 1000000000h
                test    [rsi+28h], rdx
                jz      loc_14022EAA8

loc_14022DFB5:                          ; CODE XREF: sub_14022DE20+17F↑j
                mov     rbx, [r13+0]
                mov     r12, 0FFFFF6FB7DBED000h
                mov     rax, r12
                mov     r15, 0FFFFF6FB7DBED7F8h
                mov     r8d, 1FFh
                cmp     r13, rax
                jb      short loc_14022E041
                mov     rax, r15
                cmp     r13, rax
                ja      short loc_14022E041
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022E041
                test    bl, 1
                jz      short loc_14022E041
                test    bl, 20h
                jz      short loc_14022DFFB
                test    bl, 42h
                jnz     short loc_14022E041

loc_14022DFFB:                          ; CODE XREF: sub_14022DE20+1D4↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14022E041
                mov     rax, r13
                shr     rax, 3
                and     rax, r8
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14022E041
                or      rbx, 42h

loc_14022E041:                          ; CODE XREF: sub_14022DE20+1B9↑j
                                        ; sub_14022DE20+1C1↑j ...
                mov     r9, [rsp+0B8h+arg_20]
                mov     r10, [rsp+0B8h+var_68]
                mov     r11, [rsp+0B8h+arg_0]
                jmp     loc_14022E12C
; ---------------------------------------------------------------------------

loc_14022E05B:                          ; CODE XREF: sub_14022DE20+57↑j
                mov     rbx, [rdx]
                mov     r12, 0FFFFF6FB7DBED000h
                mov     rax, r12
                mov     r15, 0FFFFF6FB7DBED7F8h
                mov     r8d, 1FFh
                cmp     r13, rax
                jb      short loc_14022E0E6
                mov     rax, r15
                cmp     r13, rax
                ja      short loc_14022E0E6
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022E0E6
                test    bl, 1
                jz      short loc_14022E0E6
                test    bl, 20h
                jz      short loc_14022E0A0
                test    bl, 42h
                jnz     short loc_14022E0E6

loc_14022E0A0:                          ; CODE XREF: sub_14022DE20+279↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14022E0E6
                mov     rax, r13
                shr     rax, 3
                and     rax, r8
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14022E0E6
                or      rbx, 42h

loc_14022E0E6:                          ; CODE XREF: sub_14022DE20+25E↑j
                                        ; sub_14022DE20+266↑j ...
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_14022E103
                test    bl, 10h
                jnz     short loc_14022E103
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_14022E103:                          ; CODE XREF: sub_14022DE20+2D3↑j
                                        ; sub_14022DE20+2D8↑j
                shr     rax, 0Ch
                mov     r14, 0FFFFFFFFFh
                and     rax, r14
                lea     rsi, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rsi, 4
                mov     rax, rax
                add     rsi, rax

loc_14022E12C:                          ; CODE XREF: sub_14022DE20+236↑j
                test    byte ptr [rsi+23h], 10h
                jz      short loc_14022E13C
                mov     ebx, 0C0000709h
                jmp     loc_14022E1BC
; ---------------------------------------------------------------------------

loc_14022E13C:                          ; CODE XREF: sub_14022DE20+310↑j
                mov     rdx, r10
                and     edx, 1
                mov     [rsp+0B8h+var_48], rdx
                jz      short loc_14022E16A
                mov     rax, r10
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 1
                jnz     short loc_14022E16A
                mov     edx, [rax+50h]
                xor     r8d, r8d
                and     edx, 7
                mov     rcx, rsi
                call    sub_1402DED24
                xor     ebx, ebx
                jmp     short loc_14022E1BC
; ---------------------------------------------------------------------------

loc_14022E16A:                          ; CODE XREF: sub_14022DE20+327↑j
                                        ; sub_14022DE20+333↑j
                inc     dword ptr gs:2E98h
                movzx   ecx, byte ptr [rsi+22h]
                test    cl, 8
                jz      short loc_14022E1E1
                test    cs:dword_140CFC400, 40000h
                jz      short loc_14022E197
                mov     rax, [rsi+10h]
                shr     rax, 5
                test    al, 1Fh
                jnz     short loc_14022E197
                test    al, 2
                jnz     short loc_14022E1AF

loc_14022E197:                          ; CODE XREF: sub_14022DE20+365↑j
                                        ; sub_14022DE20+371↑j
                test    rdx, rdx
                jz      short loc_14022E1E1
                mov     rax, r10
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 5
                jnz     short loc_14022E1E1
                mov     eax, [rax+38h]
                test    al, 20h
                jz      short loc_14022E1E1

loc_14022E1AF:                          ; CODE XREF: sub_14022DE20+375↑j
                or      dword ptr [r11+50h], 80h
                mov     ebx, 0C0000017h

loc_14022E1BC:                          ; CODE XREF: sub_14022DE20+317↑j
                                        ; sub_14022DE20+348↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], rax
                test    rdi, rdi
                jz      short loc_14022E1DA
                mov     dl, 11h
                mov     rcx, rdi
                call    sub_140297330

loc_14022E1DA:                          ; CODE XREF: sub_14022DE20+3AE↑j
                mov     eax, ebx
                jmp     loc_14022E8E9
; ---------------------------------------------------------------------------

loc_14022E1E1:                          ; CODE XREF: sub_14022DE20+359↑j
                                        ; sub_14022DE20+37A↑j ...
                test    cl, 20h
                mov     r8, rdi
                mov     rcx, r11
                mov     rdx, r13
                jz      short loc_14022E21A
                lea     rax, [rsp+0B8h+var_78]
                mov     [rsp+0B8h+var_90], rax
                mov     [rsp+0B8h+var_98], r9
                mov     r9, rsi
                call    sub_14031B2A4
                cmp     [rsp+0B8h+var_78], 1
                jbe     loc_14022E8E9
                test    eax, eax
                jns     short loc_14022E258
                jmp     loc_14022E8E9
; ---------------------------------------------------------------------------

loc_14022E21A:                          ; CODE XREF: sub_14022DE20+3CD↑j
                lea     rax, [rsp+0B8h+var_58]
                mov     [rsp+0B8h+var_60], 0
                mov     [rsp+0B8h+var_88], rax
                mov     r9, rsi
                lea     rax, [rsp+0B8h+var_60]
                mov     [rsp+0B8h+var_90], rbx
                mov     [rsp+0B8h+var_98], rax
                call    sub_14022EAE0
                test    eax, eax
                js      loc_14022E8E9
                mov     rax, [rsp+0B8h+var_60]
                test    rax, rax
                cmovnz  rsi, rax

loc_14022E258:                          ; CODE XREF: sub_14022DE20+3F3↑j
                mov     rax, [rsp+0B8h+arg_0]
                mov     r14, [rsp+0B8h+arg_18]
                mov     rax, [rax+10h]
                test    al, 1
                jz      short loc_14022E290
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 4
                jnz     short loc_14022E290
                mov     rax, [r13+0]
                mov     rbx, 0FFFFFFFFFFFFFC9Fh
                and     rax, rbx
                bts     rax, 7
                mov     [r13+0], rax

loc_14022E290:                          ; CODE XREF: sub_14022DE20+44E↑j
                                        ; sub_14022DE20+457↑j
                shr     rbx, 5
                and     ebx, 1Fh
                cmp     ebx, 18h
                jnz     short loc_14022E2A7
                mov     rdx, rsi
                mov     rcx, r13
                call    sub_14053AA68

loc_14022E2A7:                          ; CODE XREF: sub_14022DE20+47A↑j
                mov     rbx, [r13+0]
                mov     rax, r12
                cmp     r13, rax
                jb      short loc_14022E31B
                mov     rax, r15
                cmp     r13, rax
                ja      short loc_14022E31B
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022E31B
                test    bl, 1
                jz      short loc_14022E31B
                test    bl, 20h
                jz      short loc_14022E2D3
                test    bl, 42h
                jnz     short loc_14022E31B

loc_14022E2D3:                          ; CODE XREF: sub_14022DE20+4AC↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14022E31B
                mov     rax, r13
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14022E31B
                or      rbx, 42h

loc_14022E31B:                          ; CODE XREF: sub_14022DE20+491↑j
                                        ; sub_14022DE20+499↑j ...
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_14022E338
                test    bl, 10h
                jnz     short loc_14022E338
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_14022E338:                          ; CODE XREF: sub_14022DE20+508↑j
                                        ; sub_14022DE20+50D↑j
                shr     rbx, 5
                lea     rcx, qword_140017520
                and     ebx, 1Fh
                mov     rbx, [rcx+rbx*8]
                mov     rcx, 0FFFF000000000E7Fh
                and     rbx, rcx
                mov     rcx, 0FFFFFFFFF000h
                and     rax, rcx
                or      rbx, rax
                mov     rax, 0FFFFF68000000000h
                or      rbx, 21h
                mov     rax, rax
                cmp     r13, rax
                jb      loc_14022E447
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     r13, rax
                ja      loc_14022E447
                mov     rdi, r13
                mov     rax, 0FFFFF68000000000h
                shl     rdi, 19h
                mov     rax, rax
                shl     rax, 19h
                sub     rdi, rax
                sar     rdi, 10h
                mov     rax, 0FFFFF6FB40000000h
                cmp     r13, rax
                jb      short loc_14022E40C
                mov     rax, 0FFFFF6FB7FFFFFFFh
                cmp     r13, rax
                ja      short loc_14022E40C
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     r13, rax
                jnz     short loc_14022E3EF
                mov     rax, 8000000000000000h
                or      rbx, rax
                jmp     short loc_14022E3FC
; ---------------------------------------------------------------------------

loc_14022E3EF:                          ; CODE XREF: sub_14022DE20+5BE↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                and     rbx, rax

loc_14022E3FC:                          ; CODE XREF: sub_14022DE20+5CD↑j
                mov     rcx, r13
                call    sub_14033FA34
                test    eax, eax
                jz      short loc_14022E40C
                or      rbx, 4

loc_14022E40C:                          ; CODE XREF: sub_14022DE20+5A0↑j
                                        ; sub_14022DE20+5AF↑j ...
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                mov     rcx, 3FFFFFFF78h
                add     rax, rcx
                cmp     r13, rax
                ja      short loc_14022E42F
                or      rbx, 4

loc_14022E42F:                          ; CODE XREF: sub_14022DE20+609↑j
                mov     rcx, rdi
                mov     r8, rbx
                call    sub_140271580
                bts     rbx, 8
                test    eax, eax
                cmovz   rbx, r8
                jmp     short loc_14022E44C
; ---------------------------------------------------------------------------

loc_14022E447:                          ; CODE XREF: sub_14022DE20+55B↑j
                                        ; sub_14022DE20+56E↑j
                bts     rbx, 8

loc_14022E44C:                          ; CODE XREF: sub_14022DE20+625↑j
                mov     rcx, [rsi+28h]
                mov     rax, 0FAFFFFFFFFFFFFFFh
                mov     rdi, cs:qword_14001D278
                and     rbx, rax
                shr     rcx, 27h
                mov     rax, 0A00000000000000h
                or      rbx, rax
                and     ecx, 3FFh
                mov     rax, cs:qword_140C4E4C8
                mov     rdx, [rax+rcx*8]
                mov     rax, [rsi+10h]
                mov     [rsp+0B8h+var_50], rdx
                bt      rax, 0Ah
                jb      short loc_14022E4BB
                movzx   ecx, al
                shr     cl, 2
                test    cl, 1
                jz      short loc_14022E4BB
                shr     rax, 0Ch
                and     eax, 0Fh
                cmp     eax, [rdx+484h]
                jnz     short loc_14022E4BB
                mov     rcx, rsi
                call    sub_1402A6940
                mov     rdi, rax

loc_14022E4BB:                          ; CODE XREF: sub_14022DE20+674↑j
                                        ; sub_14022DE20+67F↑j ...
                mov     rax, [rsi+10h]
                bt      rax, 0Ah
                jb      short loc_14022E4D1
                bt      rax, 1Ah
                jnb     short loc_14022E4D1
                or      rbx, 40h

loc_14022E4D1:                          ; CODE XREF: sub_14022DE20+6A4↑j
                                        ; sub_14022DE20+6AB↑j
                bt      rbx, 0Bh
                jnb     short loc_14022E53A
                cmp     [rsp+0B8h+arg_18], 0
                mov     r8, [rsp+0B8h+arg_0]
                jz      short loc_14022E501
                mov     rdx, [r8]
                mov     rcx, rbx
                call    sub_14033F9E4
                test    eax, eax
                mov     eax, 0
                cmovz   r14, rax

loc_14022E501:                          ; CODE XREF: sub_14022DE20+6C9↑j
                test    byte ptr [rsi+22h], 10h
                jz      short loc_14022E51D
                test    r14, r14
                jnz     short loc_14022E536
                mov     rax, 0FFFF800000000000h
                cmp     [r8], rax
                jb      short loc_14022E53A
                jmp     short loc_14022E536
; ---------------------------------------------------------------------------

loc_14022E51D:                          ; CODE XREF: sub_14022DE20+6E5↑j
                test    r14, r14
                jz      short loc_14022E53A
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                jnz     short loc_14022E53A
                call    sub_1402A6940
                mov     rdi, rax

loc_14022E536:                          ; CODE XREF: sub_14022DE20+6EA↑j
                                        ; sub_14022DE20+6FB↑j
                or      rbx, 42h

loc_14022E53A:                          ; CODE XREF: sub_14022DE20+6B6↑j
                                        ; sub_14022DE20+6F9↑j ...
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022E5B3
                mov     rdx, rbx
                mov     rax, r12
                cmp     r13, rax
                jb      short loc_14022E5AF
                mov     rax, r15
                cmp     r13, rax
                ja      short loc_14022E5AF
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022E586
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022E578
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14022E578:                          ; CODE XREF: sub_14022DE20+749↑j
                mov     rcx, r13
                mov     [r13+0], rdx
                call    sub_140349620
                jmp     short loc_14022E5B3
; ---------------------------------------------------------------------------

loc_14022E586:                          ; CODE XREF: sub_14022DE20+740↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022E5AF
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14022E5AF:                          ; CODE XREF: sub_14022DE20+72F↑j
                                        ; sub_14022DE20+737↑j ...
                mov     [r13+0], rdx

loc_14022E5B3:                          ; CODE XREF: sub_14022DE20+724↑j
                                        ; sub_14022DE20+764↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], rax
                mov     r14, [rsp+0B8h+arg_10]
                xor     r12d, r12d
                mov     r15d, 1
                test    r14, r14
                jz      loc_14022E871
                mov     [rsp+0B8h+var_70], r12d
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jnb     short loc_14022E60C
                nop     word ptr [rax+rax+00h]

loc_14022E5F0:                          ; CODE XREF: sub_14022DE20+7E1↓j
                                        ; sub_14022DE20+7EA↓j
                lea     rcx, [rsp+0B8h+var_70]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_14022E5F0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_14022E5F0

loc_14022E60C:                          ; CODE XREF: sub_14022DE20+7C8↑j
                movzx   eax, byte ptr [r14+22h]
                and     al, 0DFh
                mov     [r14+22h], al
                movzx   edx, word ptr [r14+20h]
                test    dx, dx
                jz      loc_14022EAC3
                mov     eax, 0FFFFh
                add     dx, ax
                mov     [r14+20h], dx
                jnz     short loc_14022E644
                mov     rcx, r14
                call    sub_1402303F0
                test    eax, eax
                jnz     loc_14022E826

loc_14022E644:                          ; CODE XREF: sub_14022DE20+812↑j
                mov     r9, [r14+28h]
                mov     rax, 1000000000h
                test    rax, r9
                jnz     loc_14022E85C
                mov     rax, 2000000000000h
                test    rax, r9
                jnz     loc_14022E85C
                mov     r11, [r14+18h]
                mov     rcx, 3FFFFFFFFFFFFFFFh
                mov     rax, r11
                and     rax, rcx
                test    dx, dx
                jz      short loc_14022E6B5
                cmp     dx, r15w
                jnz     short loc_14022E694
                test    rax, rax
                jnz     short loc_14022E6B2
                jmp     short loc_14022E6A7
; ---------------------------------------------------------------------------

loc_14022E694:                          ; CODE XREF: sub_14022DE20+86B↑j
                cmp     dx, 2
                jnz     loc_14022E85C
                test    rax, rax
                jz      loc_14022E85C

loc_14022E6A7:                          ; CODE XREF: sub_14022DE20+872↑j
                test    byte ptr [r14+22h], 8
                jz      loc_14022E85C

loc_14022E6B2:                          ; CODE XREF: sub_14022DE20+870↑j
                mov     r15d, r12d

loc_14022E6B5:                          ; CODE XREF: sub_14022DE20+865↑j
                mov     rcx, 0FFFFF68000000000h
                mov     rax, rcx
                mov     r8, [r14+8]
                mov     r10, 3FFFFFFF78h
                add     r10, rax
                mov     rax, 8000000000000000h
                or      r8, rax
                cmp     r8, r10
                ja      short loc_14022E6ED
                mov     rax, rcx
                cmp     r8, rax
                jnb     short loc_14022E701

loc_14022E6ED:                          ; CODE XREF: sub_14022DE20+8C3↑j
                movzx   eax, byte ptr [r14+23h]
                test    al, 20h
                jz      short loc_14022E701
                and     al, 0DFh
                mov     [r14+23h], al
                jmp     loc_14022E821
; ---------------------------------------------------------------------------

loc_14022E701:                          ; CODE XREF: sub_14022DE20+8CB↑j
                                        ; sub_14022DE20+8D4↑j
                mov     rcx, r14
                mov     edx, r12d
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022E724
                mov     eax, [r14+10h]
                bt      rax, 0Ah
                jnb     short loc_14022E724
                mov     ecx, 1
                mov     edx, ecx
                jmp     short loc_14022E75F
; ---------------------------------------------------------------------------

loc_14022E724:                          ; CODE XREF: sub_14022DE20+8EE↑j
                                        ; sub_14022DE20+8F9↑j
                cmp     r8, r10
                ja      short loc_14022E74B
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     r8, rax
                jb      short loc_14022E74B
                test    byte ptr [r14+23h], 20h
                jz      short loc_14022E74B
                mov     ecx, 1
                mov     edx, ecx
                jmp     short loc_14022E75F
; ---------------------------------------------------------------------------

loc_14022E74B:                          ; CODE XREF: sub_14022DE20+907↑j
                                        ; sub_14022DE20+919↑j ...
                mov     ecx, 1
                cmp     r15d, ecx
                jnz     short loc_14022E75F
                shr     r11, 3Eh
                test    cl, r11b
                cmovnz  edx, ecx

loc_14022E75F:                          ; CODE XREF: sub_14022DE20+902↑j
                                        ; sub_14022DE20+929↑j ...
                mov     rax, cs:qword_140C4E4C8
                shr     r9, 27h
                and     r9d, 3FFh
                mov     r14, [rax+r9*8]
                cmp     edx, 1
                jnz     short loc_14022E785
                mov     rdx, rcx
                mov     rcx, r14
                call    sub_14026B700

loc_14022E785:                          ; CODE XREF: sub_14022DE20+958↑j
                lea     rax, unk_140C50C00
                mov     ecx, 1
                mov     r8d, ecx
                cmp     r14, rax
                jnz     short loc_14022E810
                mov     r9, gs:20h
                movsxd  rdx, dword ptr [r9+831Ch]
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14022E810
                lea     rcx, [rdx+1]
                cmp     rcx, 100h
                ja      short loc_14022E7E4
                nop     dword ptr [rax+rax+00h]

loc_14022E7C0:                          ; CODE XREF: sub_14022DE20+9C2↓j
                lea     ecx, [rdx+1]
                mov     eax, edx
                lock cmpxchg [r9+831Ch], ecx
                movsxd  rdx, eax
                jz      short loc_14022E819
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14022E7E4
                lea     rax, [rdx+1]
                cmp     rax, 100h
                jbe     short loc_14022E7C0

loc_14022E7E4:                          ; CODE XREF: sub_14022DE20+999↑j
                                        ; sub_14022DE20+9B6↑j
                mov     ecx, 0C0h
                cmp     edx, ecx
                jle     short loc_14022E80B
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14022E80B
                mov     eax, edx
                lock cmpxchg [r9+831Ch], ecx
                jnz     short loc_14022E80B
                lea     eax, [rdx-0C0h]
                movsxd  r8, eax
                inc     r8

loc_14022E80B:                          ; CODE XREF: sub_14022DE20+9CB↑j
                                        ; sub_14022DE20+9D0↑j ...
                test    r8, r8
                jz      short loc_14022E819

loc_14022E810:                          ; CODE XREF: sub_14022DE20+977↑j
                                        ; sub_14022DE20+98C↑j
                lock xadd [r14+1C00h], r8

loc_14022E819:                          ; CODE XREF: sub_14022DE20+9B1↑j
                                        ; sub_14022DE20+9EE↑j
                mov     r14, [rsp+0B8h+arg_10]

loc_14022E821:                          ; CODE XREF: sub_14022DE20+8DC↑j
                test    r15d, r15d
                jz      short loc_14022E85C

loc_14022E826:                          ; CODE XREF: sub_14022DE20+81E↑j
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                mov     rcx, r14
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rcx, r14
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                call    sub_140278860

loc_14022E85C:                          ; CODE XREF: sub_14022DE20+835↑j
                                        ; sub_14022DE20+848↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], rax
                mov     r15d, 1

loc_14022E871:                          ; CODE XREF: sub_14022DE20+7B6↑j
                test    rdi, rdi
                jz      short loc_14022E886
                mov     rcx, [rsp+0B8h+var_50]
                mov     r8d, r15d
                mov     rdx, rdi
                call    sub_14020B2C0

loc_14022E886:                          ; CODE XREF: sub_14022DE20+A54↑j
                mov     rdi, [rsp+0B8h+var_58]
                test    rdi, rdi
                jz      short loc_14022E8AF
                cmp     dword ptr [rdi+0B0h], 1
                jle     short loc_14022E8A7
                lea     rcx, [rdi+38h]
                xor     r8d, r8d
                xor     edx, edx
                call    KeSetEvent

loc_14022E8A7:                          ; CODE XREF: sub_14022DE20+A77↑j
                mov     rcx, rdi
                call    sub_140299AD8

loc_14022E8AF:                          ; CODE XREF: sub_14022DE20+A6E↑j
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022E8FD
                mov     rax, [rsp+0B8h+var_68]
                xor     r9d, r9d
                mov     r8, [rsp+0B8h+arg_18]
                mov     rdx, rbx
                mov     rcx, [rsp+0B8h+arg_0]
                mov     [rsp+0B8h+var_98], rax
                call    sub_14022B420
                test    eax, eax
                js      short loc_14022E8E9

loc_14022E8E4:                          ; CODE XREF: sub_14022DE20+B2F↓j
                                        ; sub_14022DE20+B5E↓j ...
                mov     eax, 110h

loc_14022E8E9:                          ; CODE XREF: sub_14022DE20+163↑j
                                        ; sub_14022DE20+3BC↑j ...
                add     rsp, 80h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022E8FD:                          ; CODE XREF: sub_14022DE20+A99↑j
                mov     rcx, [rsp+0B8h+var_68]
                mov     rax, [rsp+0B8h+var_48]
                and     rcx, 0FFFFFFFFFFFFFFFEh
                test    rax, rax
                jz      short loc_14022E983
                cmp     byte ptr [rcx], 4
                jnz     short loc_14022E983
                mov     rcx, r13
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14022E97A
                call    sub_140349680
                test    eax, eax
                jz      short loc_14022E951
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14022E940
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022E940:                          ; CODE XREF: sub_14022DE20+B11↑j
                mov     rdx, rbx
                mov     [r13+0], rbx
                mov     rcx, r13
                call    sub_140349620
                jmp     short loc_14022E8E4
; ---------------------------------------------------------------------------

loc_14022E951:                          ; CODE XREF: sub_14022DE20+B08↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14022E97A
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14022E97A:                          ; CODE XREF: sub_14022DE20+AFF↑j
                                        ; sub_14022DE20+B4B↑j
                mov     [r13+0], rbx
                jmp     loc_14022E8E4
; ---------------------------------------------------------------------------

loc_14022E983:                          ; CODE XREF: sub_14022DE20+AEE↑j
                                        ; sub_14022DE20+AF3↑j
                mov     rdi, r12
                test    rax, rax
                jz      short loc_14022E9A5
                cmp     byte ptr [rcx], 3
                jnz     short loc_14022E999
                and     rbx, 0FFFFFFFFFFFFFFDFh
                mov     r12d, r15d
                jmp     short loc_14022E9A5
; ---------------------------------------------------------------------------

loc_14022E999:                          ; CODE XREF: sub_14022DE20+B6E↑j
                test    rax, rax
                jz      short loc_14022E9A5
                cmp     byte ptr [rcx], 5
                cmovz   rdi, rcx

loc_14022E9A5:                          ; CODE XREF: sub_14022DE20+B69↑j
                                        ; sub_14022DE20+B77↑j ...
                mov     rcx, [rsp+0B8h+arg_0]
                test    byte ptr [rcx+45h], 8
                jz      short loc_14022E9C8
                mov     rax, [rcx+10h]
                test    al, 1
                jz      short loc_14022E9C4
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 2
                jz      short loc_14022E9C8

loc_14022E9C4:                          ; CODE XREF: sub_14022DE20+B99↑j
                and     rbx, 0FFFFFFFFFFFFFFDFh

loc_14022E9C8:                          ; CODE XREF: sub_14022DE20+B91↑j
                                        ; sub_14022DE20+BA2↑j
                movzx   edx, byte ptr [rcx+45h]
                lea     r14, [rcx+38h]
                movzx   eax, dl
                and     al, 5
                cmp     al, 4
                jnz     loc_14022EA6A
                test    dl, 2
                jnz     loc_14022EA6A
                movzx   eax, word ptr [r14+0Ah]
                mov     r8d, 1FFh
                test    ax, ax
                jz      short loc_14022EA1D
                movzx   ecx, word ptr [r14+8]
                add     ecx, eax
                mov     eax, r13d
                shr     eax, 3
                and     eax, r8d
                cmp     ecx, eax
                jnz     short loc_14022EA0F
                test    dl, 10h
                jnz     short loc_14022EA1D

loc_14022EA0F:                          ; CODE XREF: sub_14022DE20+BE8↑j
                mov     rcx, r14
                call    sub_14026F5D0
                mov     r8d, 1FFh

loc_14022EA1D:                          ; CODE XREF: sub_14022DE20+BD4↑j
                                        ; sub_14022DE20+BED↑j
                movzx   eax, word ptr [r14+0Ah]
                test    ax, ax
                jnz     short loc_14022EA5E
                movzx   edx, byte ptr [r14+0Dh]
                mov     eax, r13d
                shr     eax, 3
                mov     rcx, rsi
                and     ax, r8w
                mov     [r14+0Ah], r15w
                mov     [r14+8], ax
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022EA55
                and     dl, 0EFh
                mov     [r14+0Dh], dl
                jmp     short loc_14022EA66
; ---------------------------------------------------------------------------

loc_14022EA55:                          ; CODE XREF: sub_14022DE20+C2A↑j
                or      dl, 10h
                mov     [r14+0Dh], dl
                jmp     short loc_14022EA66
; ---------------------------------------------------------------------------

loc_14022EA5E:                          ; CODE XREF: sub_14022DE20+C05↑j
                inc     ax
                mov     [r14+0Ah], ax

loc_14022EA66:                          ; CODE XREF: sub_14022DE20+C33↑j
                                        ; sub_14022DE20+C3C↑j
                or      r12d, 4

loc_14022EA6A:                          ; CODE XREF: sub_14022DE20+BB7↑j
                                        ; sub_14022DE20+BC0↑j
                mov     rcx, [rsp+0B8h+var_40]
                xor     r9d, r9d
                mov     [rsp+0B8h+var_88], rdi
                mov     r8, rsi
                mov     dword ptr [rsp+0B8h+var_90], r12d
                mov     rdx, r13
                mov     [rsp+0B8h+var_98], rbx
                call    sub_140228E90
                test    eax, eax
                jnz     loc_14022E8E4
                xor     edx, edx
                mov     rcx, rsi
                call    sub_140209CE0
                mov     eax, 0C0000017h
                jmp     loc_14022E8E9
; ---------------------------------------------------------------------------

loc_14022EAA8:                          ; CODE XREF: sub_14022DE20+18F↑j
                mov     [rsp+0B8h+var_98], rcx
                mov     r9, rbx
                mov     ecx, 1Ah
                mov     r8, r13
                mov     edx, 411h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14022EAC3:                          ; CODE XREF: sub_14022DE20+7FF↑j
                mov     rcx, r14
                call    sub_1403F41EC
; ---------------------------------------------------------------------------
                db 0CCh
sub_14022DE20   endp

algn_14022EACC:                         ; DATA XREF: .pdata:00000001400CB1F0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14022EAE0   proc near               ; CODE XREF: sub_14022DE20+41F↑p
                                        ; DATA XREF: .rdata:0000000140053548↑o ...

var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_38          = byte ptr -38h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h
arg_20          = qword ptr  28h
arg_28          = qword ptr  30h
arg_30          = qword ptr  38h

                mov     [rsp+arg_18], rbx
                mov     [rsp+arg_0], rcx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r15
                sub     rsp, 50h
                mov     r15, [rsp+78h+arg_30]
                mov     r12, rdx
                mov     r13, [rsp+78h+arg_20]
                xor     edx, edx
                mov     rdi, rcx
                mov     [rsp+78h+var_38], 0
                mov     rcx, r9
                mov     rbx, r9
                mov     [r15], rdx
                mov     rsi, r8
                mov     [r13+0], rdx
                call    sub_1403F41D8
                mov     r8d, eax
                test    eax, eax
                jnz     short loc_14022EB4C
                mov     r9, [r9+8]
                mov     rax, 8000000000000000h
                mov     rcx, r9
                or      rcx, rax
                cmp     r12, rcx
                jnz     loc_14022EF19

loc_14022EB4C:                          ; CODE XREF: sub_14022EAE0+4D↑j
                                        ; DATA XREF: .rdata:0000000140053548↑o ...
                mov     [rsp+78h+arg_8], rbp
                mov     rbp, rdx
                mov     rdx, [rbx+10h]
                mov     rcx, rdx
                mov     [rsp+78h+arg_10], r14
                mov     r14, [rdi]
                mov     rax, rdx
                shr     rax, 0Bh
                and     ecx, 400h
                shr     rdx, 3
                test    rcx, rcx
                cmovnz  edx, eax
                mov     rax, 7FFFFFFEFFFFh
                test    dl, 1
                jz      short loc_14022EBBF
                cmp     r14, rax
                ja      short loc_14022EBA4
                test    r8d, r8d
                jnz     short loc_14022EBA4
                mov     rcx, r14
                call    sub_14026A130
                mov     rbp, rax

loc_14022EBA4:                          ; CODE XREF: sub_14022EAE0+B2↑j
                                        ; sub_14022EAE0+B7↑j
                xor     r8d, r8d
                mov     rdx, rbp
                mov     rcx, rbx
                call    sub_14055FC70
                mov     [rdi+70h], rax
                test    rax, rax
                jnz     loc_14022EC72

loc_14022EBBF:                          ; CODE XREF: sub_14022EAE0+AD↑j
                mov     rcx, rbx
                mov     r8, rbp
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14022EC56
                mov     rcx, [rbx+10h]
                bt      rcx, 0Ah
                jnb     short loc_14022EC56
                mov     rax, [rbx+28h]
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 3
                jz      short loc_14022EC56
                mov     rax, cs:qword_140C4DDC0
                mov     r11, rcx
                test    rax, rax
                jz      short loc_14022EC06
                test    r11b, 10h
                jnz     short loc_14022EC06
                not     rax
                and     r11, rax

loc_14022EC06:                          ; CODE XREF: sub_14022EAE0+118↑j
                                        ; sub_14022EAE0+11E↑j
                sar     r11, 10h
                mov     r10, [r11]
                mov     eax, [r10+38h]
                test    al, 20h
                jz      short loc_14022EC56
                mov     r10, [r10+60h]
                mov     r10, [r10+28h]
                test    r10, r10
                jz      short loc_14022EC56
                mov     rax, r10
                and     rax, 0FFFFFFFFFFFFFFF8h
                cmp     rax, 8
                jz      short loc_14022EC56
                movzx   eax, r10b
                and     al, 3
                cmp     al, 2
                jz      short loc_14022EC56
                mov     rax, 0FFFF800000000000h
                cmp     r14, rax
                jb      short loc_14022EC9E
                test    byte ptr cs:dword_140CFC400+2, 1
                jz      short loc_14022EC56
                test    cl, 40h
                jnz     short loc_14022ECAE

loc_14022EC56:                          ; CODE XREF: sub_14022EAE0+EC↑j
                                        ; sub_14022EAE0+FB↑j ...
                xor     edx, edx
                mov     rcx, rbx
                call    sub_14022EF40
                mov     rcx, rbx
                test    eax, eax
                jnz     loc_14022ED22
                xor     edx, edx
                call    sub_140388B84

loc_14022EC72:                          ; CODE XREF: sub_14022EAE0+D9↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rax
                test    rsi, rsi
                jz      loc_14022EEC2
                mov     dl, 11h
                mov     rcx, rsi
                call    sub_140297330
                mov     eax, 0C0000434h
                jmp     loc_14022EEF3
; ---------------------------------------------------------------------------

loc_14022EC9E:                          ; CODE XREF: sub_14022EAE0+166↑j
                test    rbp, rbp
                jnz     short loc_14022ECB3
                mov     rcx, r14
                call    sub_14026A130
                mov     r8, rax

loc_14022ECAE:                          ; CODE XREF: sub_14022EAE0+174↑j
                test    r8, r8
                jz      short loc_14022ECFA

loc_14022ECB3:                          ; CODE XREF: sub_14022EAE0+1C1↑j
                mov     edx, [r8+30h]
                mov     ecx, edx
                and     cl, 70h
                cmp     cl, 20h ; ' '
                jnz     short loc_14022ECFA
                and     edx, 0F80h
                cmp     edx, 80h
                jz      short loc_14022EC56
                mov     eax, [r8+40h]
                bt      eax, 1Bh
                jnb     short loc_14022ECE3
                test    r10b, 4
                jz      loc_14022EC56

loc_14022ECE3:                          ; CODE XREF: sub_14022EAE0+1F7↑j
                test    cs:dword_140CFC400, 400h
                jz      short loc_14022ECFA
                test    byte ptr [r11+22h], 2
                jnz     loc_14022EC56

loc_14022ECFA:                          ; CODE XREF: sub_14022EAE0+1D1↑j
                                        ; sub_14022EAE0+1DF↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rax
                test    rsi, rsi
                jz      short loc_14022ED18
                mov     dl, 11h
                mov     rcx, rsi
                call    sub_140297330

loc_14022ED18:                          ; CODE XREF: sub_14022EAE0+22C↑j
                mov     eax, 0C0000428h
                jmp     loc_14022EEF3
; ---------------------------------------------------------------------------

loc_14022ED22:                          ; CODE XREF: sub_14022EAE0+185↑j
                call    sub_1402303F0
                test    eax, eax
                jnz     loc_14022EEC9
                lea     edi, [rax+1]
                mov     rax, 7FFFFFFEFFFFh
                cmp     r14, rax
                ja      loc_14022EE6C
                cmp     word ptr [rbx+20h], 0
                jnz     loc_14022EE6C
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+690h]
                mov     rcx, rbx
                call    sub_1403F41D8
                test    eax, eax
                jnz     short loc_14022ED7D
                cmp     qword ptr [rdx+1A8h], 0
                jmp     short loc_14022ED93
; ---------------------------------------------------------------------------

loc_14022ED7D:                          ; CODE XREF: sub_14022EAE0+291↑j
                mov     eax, [rbx+10h]
                bt      rax, 0Ah
                jb      loc_14022EE6C
                cmp     qword ptr [rdx+1B0h], 0

loc_14022ED93:                          ; CODE XREF: sub_14022EAE0+29B↑j
                jz      loc_14022EE6C
                test    rbp, rbp
                jnz     short loc_14022EDB2
                mov     rcx, r14
                call    sub_14026A130
                mov     rbp, rax
                test    rax, rax
                jz      loc_14022EE56

loc_14022EDB2:                          ; CODE XREF: sub_14022EAE0+2BC↑j
                mov     edx, [rbp+30h]
                lea     rcx, qword_14002DE90
                mov     eax, edx
                shr     rax, 12h
                and     eax, 3
                cmp     qword ptr [rcx+rax*8], 10h
                jnz     loc_14022EE56
                mov     rcx, rbx
                call    sub_1403F41D8
                and     edx, 100000h
                test    eax, eax
                jz      short loc_14022EDEA
                test    edx, edx
                jnz     short loc_14022EE56
                test    eax, eax
                jnz     short loc_14022EDEE

loc_14022EDEA:                          ; CODE XREF: sub_14022EAE0+300↑j
                test    edx, edx
                jz      short loc_14022EE56

loc_14022EDEE:                          ; CODE XREF: sub_14022EAE0+308↑j
                mov     r14, [rsp+78h+arg_0]
                lea     rax, [rsp+78h+var_38]
                mov     r9, [rsp+78h+arg_28]
                mov     r8, r12
                mov     [rsp+78h+var_48], rax
                mov     rdx, rbp
                mov     [rsp+78h+var_50], rsi
                mov     rcx, r14
                mov     [rsp+78h+var_58], rbx
                call    sub_140556014
                mov     rdi, rax
                test    rax, rax
                jz      short loc_14022EE36
                cmp     rbx, rax
                jz      short loc_14022EE5E
                mov     rbx, rax
                mov     [r13+0], rax
                jmp     short loc_14022EE5E
; ---------------------------------------------------------------------------

loc_14022EE36:                          ; CODE XREF: sub_14022EAE0+346↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rax
                test    rsi, rsi
                jz      short loc_14022EE5E
                mov     dl, 11h
                mov     rcx, rsi
                call    sub_140297330
                jmp     short loc_14022EE5E
; ---------------------------------------------------------------------------

loc_14022EE56:                          ; CODE XREF: sub_14022EAE0+2CC↑j
                                        ; sub_14022EAE0+2EA↑j ...
                mov     r14, [rsp+78h+arg_0]

loc_14022EE5E:                          ; CODE XREF: sub_14022EAE0+34B↑j
                                        ; sub_14022EAE0+354↑j ...
                cmp     [rsp+78h+var_38], 0
                jnz     short loc_14022EE8F
                test    rdi, rdi
                jz      short loc_14022EE94
                jmp     short loc_14022EE74
; ---------------------------------------------------------------------------

loc_14022EE6C:                          ; CODE XREF: sub_14022EAE0+25F↑j
                                        ; sub_14022EAE0+26A↑j ...
                mov     r14, [rsp+78h+arg_0]

loc_14022EE74:                          ; CODE XREF: sub_14022EAE0+38A↑j
                mov     r9, r15
                mov     r8, rsi
                mov     rdx, rbx
                mov     rcx, r14
                call    sub_14022FC80
                mov     rdi, rax
                mov     [r13+0], rax
                mov     rbx, rax

loc_14022EE8F:                          ; CODE XREF: sub_14022EAE0+383↑j
                test    rdi, rdi
                jnz     short loc_14022EEC9

loc_14022EE94:                          ; CODE XREF: sub_14022EAE0+388↑j
                mov     rbx, [r15]
                test    rbx, rbx
                jz      short loc_14022EEC2
                cmp     dword ptr [rbx+0B0h], 1
                jle     short loc_14022EEB3
                lea     rcx, [rbx+38h]
                xor     r8d, r8d
                xor     edx, edx
                call    KeSetEvent

loc_14022EEB3:                          ; CODE XREF: sub_14022EAE0+3C3↑j
                mov     rcx, rbx
                call    sub_140299AD8
                mov     qword ptr [r15], 0

loc_14022EEC2:                          ; CODE XREF: sub_14022EAE0+1A4↑j
                                        ; sub_14022EAE0+3BA↑j
                mov     eax, 0C0000434h
                jmp     short loc_14022EEF3
; ---------------------------------------------------------------------------

loc_14022EEC9:                          ; CODE XREF: sub_14022EAE0+249↑j
                                        ; sub_14022EAE0+3B2↑j
                mov     rax, [rbx+18h]
                mov     rcx, 0C000000000000001h
                inc     word ptr [rbx+20h]
                and     rax, rcx
                or      rax, 1
                mov     [rbx+18h], rax
                movzx   eax, byte ptr [rbx+22h]
                and     al, 0FEh
                or      al, 6
                mov     [rbx+22h], al
                xor     eax, eax

loc_14022EEF3:                          ; CODE XREF: sub_14022EAE0+1B9↑j
                                        ; sub_14022EAE0+23D↑j ...
                mov     rbp, [rsp+78h+arg_8]
                mov     r14, [rsp+78h+arg_10]
                mov     rbx, [rsp+78h+arg_18]
                add     rsp, 50h
                pop     r15
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
byte_14022EF18  db 0CCh                 ; DATA XREF: .pdata:00000001400CB208↑o
                                        ; .pdata:00000001400CB214↑o
; ---------------------------------------------------------------------------

loc_14022EF19:                          ; CODE XREF: sub_14022EAE0+66↑j
                mov     r8, r12
                mov     [rsp+78h+var_58], rbx
                mov     edx, 888Ah
                mov     ecx, 1Ah
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_14022EAE0   endp

algn_14022EF31:                         ; DATA XREF: .pdata:00000001400CB214↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14022EF40   proc near               ; CODE XREF: sub_140213950+3A↑p
                                        ; sub_14022EAE0+17B↑p ...

var_68          = qword ptr -68h
var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h

                mov     [rsp+arg_8], edx
                push    rsi
                push    rdi
                sub     rsp, 78h
                xor     eax, eax
                mov     rdi, rcx
                movzx   ecx, word ptr [rcx+20h]
                xorps   xmm0, xmm0
                mov     [rsp+88h+var_48], rax
                mov     r10d, edx
                movups  [rsp+88h+var_58], xmm0
                test    cx, cx
                jz      short loc_14022EF89
                mov     rdx, 3FFFFFFFFFFFFFFFh
                test    [rdi+18h], rdx
                jnz     loc_14022FB85
                mov     eax, 1
                add     rsp, 78h
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022EF89:                          ; CODE XREF: sub_14022EF40+26↑j
                mov     rax, cs:qword_140C4E4C8
                mov     r8, [rdi+28h]
                mov     rcx, r8

loc_14022EF97:                          ; DATA XREF: .rdata:0000000140053580↑o
                                        ; .rdata:0000000140053590↑o ...
                mov     [rsp+88h+var_38], r15
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     r15, [rax+rcx*8]
                movzx   ecx, byte ptr [rdi+22h]
                mov     eax, ecx
                and     cl, 7
                and     eax, 7
                mov     rsi, [r15+rax*8+1078h]
                mov     r9d, [rsi+8]
                mov     dword ptr [rsp+88h+arg_0], r9d
                cmp     cl, 5
                jnz     short loc_14022EFEB
                xor     edx, edx
                mov     rcx, rdi
                call    sub_14054F710
                mov     r15, [rsp+88h+var_38]
                mov     eax, 1
                add     rsp, 78h
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
byte_14022EFEA  db 0CCh                 ; DATA XREF: .pdata:00000001400CB22C↑o
                                        ; .pdata:00000001400CB238↑o
; ---------------------------------------------------------------------------

loc_14022EFEB:                          ; CODE XREF: sub_14022EF40+8D↑j
                                        ; DATA XREF: .pdata:00000001400CB238↑o ...
                mov     [rsp+88h+var_18], rbx
                mov     [rsp+88h+var_28], r13
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                mov     rcx, rdi
                mov     ebx, 41h ; 'A'
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     r13, rdx
                sar     r13, 3
                mov     rax, r13
                shr     rax, 3Fh
                add     r13, rax
                mov     rax, cs:qword_140C4E820
                mov     [rsp+88h+arg_10], r13
                cmp     r13, rax
                jb      short loc_14022F051
                add     rax, 800h
                cmp     r13, rax
                jnb     short loc_14022F051
                mov     ebx, 45h ; 'E'
                jmp     short loc_14022F074
; ---------------------------------------------------------------------------

loc_14022F051:                          ; CODE XREF: sub_14022EF40+FD↑j
                                        ; sub_14022EF40+108↑j
                cmp     cs:byte_140C51EDE, 0
                jz      short loc_14022F074
                mov     rax, cs:qword_140C52408
                mov     rcx, r13
                shr     rcx, 9
                bt      [rax], rcx
                mov     eax, 51h ; 'Q'
                cmovb   ebx, eax

loc_14022F074:                          ; CODE XREF: sub_14022EF40+10F↑j
                                        ; sub_14022EF40+118↑j
                mov     [rsp+88h+var_20], r12
                mov     edx, ebx
                mov     [rsp+88h+var_30], r14
                mov     rcx, 2000000000000h
                cmp     r9d, 2
                jnz     loc_14022F411
                test    rcx, r8
                jz      short loc_14022F0C9
                test    byte ptr [rdi+23h], 40h
                jz      short loc_14022F0A9
                xor     edx, edx
                mov     rcx, rdi
                call    sub_14054F710

loc_14022F0A9:                          ; CODE XREF: sub_14022EF40+15D↑j
                mov     esi, 1
                mov     qword ptr [rdi], 0
                mov     r8d, esi
                xor     edx, edx
                mov     rcx, rdi
                call    sub_14026B590
                mov     eax, esi
                jmp     loc_14022FB64
; ---------------------------------------------------------------------------

loc_14022F0C9:                          ; CODE XREF: sub_14022EF40+157↑j
                mov     rcx, rdi
                call    sub_14022FC60
                or      ebx, 2
                mov     r14d, eax
                test    bl, 4
                jz      short loc_14022F0E6
                mov     ebx, edx
                and     ebx, 0FFFFFFBDh
                test    bl, 4
                jnz     short loc_14022F0EF

loc_14022F0E6:                          ; CODE XREF: sub_14022EF40+19A↑j
                test    byte ptr [rdi+23h], 8
                jz      short loc_14022F0EF
                or      ebx, 8

loc_14022F0EF:                          ; CODE XREF: sub_14022EF40+1A4↑j
                                        ; sub_14022EF40+1AA↑j
                lea     rsi, [r14+4Ch]
                lea     rsi, [r14+rsi*4]
                lea     rsi, [r15+rsi*8]
                test    bl, 10h
                jz      short loc_14022F12F
                mov     rcx, 8000000000000000h
                test    [rdi], rcx
                jz      short loc_14022F129
                xor     edx, edx
                mov     rcx, rdi
                call    sub_140553084
                mov     r10d, [rsp+88h+arg_8]
                mov     rsi, rax
                or      ebx, 20h
                jmp     short loc_14022F12C
; ---------------------------------------------------------------------------

loc_14022F129:                          ; CODE XREF: sub_14022EF40+1CD↑j
                and     ebx, 0FFFFFFBFh

loc_14022F12C:                          ; CODE XREF: sub_14022EF40+1E7↑j
                and     ebx, 0FFFFFFFDh

loc_14022F12F:                          ; CODE XREF: sub_14022EF40+1BE↑j
                test    bl, 2
                jz      short loc_14022F152
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022F14A
                lock dec qword ptr [r15+1100h]
                jmp     short loc_14022F152
; ---------------------------------------------------------------------------

loc_14022F14A:                          ; CODE XREF: sub_14022EF40+1FE↑j
                lock dec qword ptr [r15+13C0h]

loc_14022F152:                          ; CODE XREF: sub_14022EF40+1F2↑j
                                        ; sub_14022EF40+208↑j
                xor     r12d, r12d
                test    r10d, r10d
                jnz     short loc_14022F1CA
                mov     qword ptr [rsp+88h+var_58], 0
                lea     r12, [rsi+20h]
                mov     qword ptr [rsp+88h+var_58+8], r12
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14022F197
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14022F197
                mov     eax, [rdx+18h]
                add     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14022F197
                call    sub_1403F2EC4

loc_14022F197:                          ; CODE XREF: sub_14022EF40+23F↑j
                                        ; sub_14022EF40+245↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_14022F1AF
                mov     rdx, r12
                lea     rcx, [rsp+88h+var_58]
                call    sub_14051652C
                jmp     short loc_14022F1C7
; ---------------------------------------------------------------------------

loc_14022F1AF:                          ; CODE XREF: sub_14022EF40+25E↑j
                lea     rdx, [rsp+88h+var_58]
                xchg    rdx, [r12]
                test    rdx, rdx
                jz      short loc_14022F1C7
                lea     rcx, [rsp+88h+var_58]
                call    sub_14025FC20

loc_14022F1C7:                          ; CODE XREF: sub_14022EF40+26D↑j
                                        ; sub_14022EF40+27B↑j
                xor     r12d, r12d

loc_14022F1CA:                          ; CODE XREF: sub_14022EF40+218↑j
                mov     r10, [rdi]
                mov     r8, 0FFFFFFFFFh
                mov     r9, [rdi+18h]
                and     r10, r8
                and     r9, r8
                test    bl, 8
                jz      loc_14022F37C
                mov     r8, cs:qword_140C4E820
                cmp     r10, r8
                jb      short loc_14022F214
                lea     rax, [r8+800h]
                cmp     r10, rax
                jnb     short loc_14022F214
                cmp     r9, r10
                jnz     short loc_14022F214
                mov     rcx, rdi
                call    sub_14033EB84
                jmp     loc_14022F34A
; ---------------------------------------------------------------------------

loc_14022F214:                          ; CODE XREF: sub_14022EF40+2B4↑j
                                        ; sub_14022EF40+2C0↑j ...
                lea     rdx, [r9+r9*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rdx, 4
                mov     rax, rax
                add     rdx, rax
                cmp     r9, r8
                jb      loc_14022F2B8
                lea     rax, [r8+800h]
                cmp     r9, rax
                jnb     short loc_14022F2B8
                mov     r11, cs:qword_140C4DDC0
                mov     rcx, [rdx+10h]
                test    r11, r11
                jz      short loc_14022F265
                test    cl, 10h
                jnz     short loc_14022F261
                mov     rax, r11
                not     rax
                and     rcx, rax
                jmp     short loc_14022F265
; ---------------------------------------------------------------------------

loc_14022F261:                          ; CODE XREF: sub_14022EF40+314↑j
                and     rcx, 0FFFFFFFFFFFFFFEFh

loc_14022F265:                          ; CODE XREF: sub_14022EF40+30F↑j
                                        ; sub_14022EF40+31F↑j
                mov     r13, 0FFFF000000000FFFh
                mov     rax, r10
                and     rcx, r13
                shl     rax, 0Ch
                mov     r13, [rsp+88h+arg_10]
                or      rax, rcx
                test    r11, r11
                jz      short loc_14022F2A8
                mov     rcx, rax
                and     rcx, r11
                jnz     short loc_14022F2A4
                or      rax, r11
                mov     rcx, 0FFFFFFF000000000h
                mov     [rdx+10h], rax
                jmp     short loc_14022F2CE
; ---------------------------------------------------------------------------

loc_14022F2A4:                          ; CODE XREF: sub_14022EF40+34F↑j
                or      rax, 10h

loc_14022F2A8:                          ; CODE XREF: sub_14022EF40+347↑j
                mov     [rdx+10h], rax
                mov     rcx, 0FFFFFFF000000000h
                jmp     short loc_14022F2CE
; ---------------------------------------------------------------------------

loc_14022F2B8:                          ; CODE XREF: sub_14022EF40+2EF↑j
                                        ; sub_14022EF40+2FF↑j
                mov     rax, [rdx]
                mov     rcx, 0FFFFFFF000000000h
                and     rax, rcx
                or      rax, r10
                mov     [rdx], rax

loc_14022F2CE:                          ; CODE XREF: sub_14022EF40+362↑j
                                        ; sub_14022EF40+376↑j
                lea     r11, [r10+r10*2]
                mov     rax, 0FFFFFA8000000000h
                shl     r11, 4
                mov     rax, rax
                add     r11, rax
                cmp     r10, r8
                jb      short loc_14022F307
                lea     rax, [r8+800h]
                cmp     r10, rax
                jnb     short loc_14022F307
                mov     rax, [r11+28h]
                and     rax, rcx
                or      rax, r9
                mov     [r11+28h], rax
                jmp     short loc_14022F34A
; ---------------------------------------------------------------------------

loc_14022F307:                          ; CODE XREF: sub_14022EF40+3A9↑j
                                        ; sub_14022EF40+3B5↑j
                mov     rdx, [r11+18h]
                mov     r10, 0FFFFFFF000000000h
                mov     rcx, rdx
                mov     rax, rdx
                and     rcx, r10
                or      rcx, r9
                lock cmpxchg [r11+18h], rcx
                mov     r8, rax
                cmp     rdx, rax
                jz      short loc_14022F34A
                nop

loc_14022F330:                          ; CODE XREF: sub_14022EF40+408↓j
                mov     rcx, r8
                and     r8, r10
                or      r8, r9
                mov     rax, rcx
                lock cmpxchg [r11+18h], r8
                mov     r8, rax
                cmp     rcx, rax
                jnz     short loc_14022F330

loc_14022F34A:                          ; CODE XREF: sub_14022EF40+2CF↑j
                                        ; sub_14022EF40+3C5↑j ...
                mov     r8, 0FFFFFFFFFh
                mov     r10, r8
                mov     r9, r8

loc_14022F35A:                          ; CODE XREF: sub_14022EF40+490↓j
                                        ; sub_14022EF40+4A7↓j ...
                movzx   eax, byte ptr [r15+12DCh]
                cmp     r14d, eax
                jnb     loc_14022F5D1
                test    bl, 20h
                jnz     loc_14022F5D1
                and     ebx, 0FFFFFFFEh
                jmp     loc_14022F5D1
; ---------------------------------------------------------------------------

loc_14022F37C:                          ; CODE XREF: sub_14022EF40+2A4↑j
                cmp     r10, r8
                jz      short loc_14022F3C3
                mov     rax, cs:qword_140C4E820
                cmp     r10, rax
                jb      short loc_14022F398
                add     rax, 800h
                cmp     r10, rax
                jb      short loc_14022F3C3

loc_14022F398:                          ; CODE XREF: sub_14022EF40+44B↑j
                lea     rdx, [r10+r10*2]
                mov     r11, 0FFFFFA8000000000h
                shl     rdx, 4
                mov     rax, r11
                add     rdx, rax
                mov     rcx, rdx
                call    sub_14022FC60
                cmp     r14d, eax
                jnz     loc_14022FBCA
                jmp     short loc_14022F3CD
; ---------------------------------------------------------------------------

loc_14022F3C3:                          ; CODE XREF: sub_14022EF40+43F↑j
                                        ; sub_14022EF40+456↑j
                mov     r11, 0FFFFFA8000000000h

loc_14022F3CD:                          ; CODE XREF: sub_14022EF40+481↑j
                cmp     r9, r8
                jz      short loc_14022F35A
                mov     rax, cs:qword_140C4E820
                cmp     r9, rax
                jb      short loc_14022F3ED
                add     rax, 800h
                cmp     r9, rax
                jb      loc_14022F35A

loc_14022F3ED:                          ; CODE XREF: sub_14022EF40+49C↑j
                lea     rdx, [r9+r9*2]
                shl     rdx, 4
                mov     rax, r11
                add     rdx, rax
                mov     rcx, rdx
                call    sub_14022FC60
                cmp     r14d, eax
                jnz     loc_14022FBF1
                jmp     loc_14022F35A
; ---------------------------------------------------------------------------

loc_14022F411:                          ; CODE XREF: sub_14022EF40+14E↑j
                xor     r12d, r12d
                mov     rcx, rdi
                cmp     r9d, 3
                jnz     loc_14022F584
                lock dec qword ptr [rsi]
                call    sub_1403F41D8
                test    eax, eax
                mov     ecx, 1100h
                mov     edx, 13C0h
                cmovz   ecx, edx
                lock dec qword ptr [rcx+r15]
                mov     eax, [rdi+10h]
                bt      rax, 0Ah
                jb      loc_14022F4FA
                test    r10d, r10d
                jnz     short loc_14022F4B9
                add     rsi, 20h ; ' '
                mov     qword ptr [rsp+88h+var_58], r12
                mov     qword ptr [rsp+88h+var_58+8], rsi
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14022F48A
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14022F48A
                mov     eax, [rdx+18h]
                add     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14022F48A
                call    sub_1403F2EC4

loc_14022F48A:                          ; CODE XREF: sub_14022EF40+532↑j
                                        ; sub_14022EF40+538↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_14022F4A2
                mov     rdx, rsi
                lea     rcx, [rsp+88h+var_58]
                call    sub_14051652C
                jmp     short loc_14022F4B9
; ---------------------------------------------------------------------------

loc_14022F4A2:                          ; CODE XREF: sub_14022EF40+551↑j
                lea     rdx, [rsp+88h+var_58]
                xchg    rdx, [rsi]
                test    rdx, rdx
                jz      short loc_14022F4B9
                lea     rcx, [rsp+88h+var_58]
                call    sub_14025FC20

loc_14022F4B9:                          ; CODE XREF: sub_14022EF40+50F↑j
                                        ; sub_14022EF40+560↑j ...
                dec     qword ptr [r15+1DB0h]
                mov     rax, [rdi+10h]
                mov     rcx, rax
                shr     al, 1
                shr     rcx, 0Ch
                and     ecx, 0Fh
                test    al, 1
                jnz     short loc_14022F4E9
                cmp     ecx, [r15+484h]
                jz      short loc_14022F4E9
                lea     rsi, [r15+0AC0h]
                jmp     loc_14022F5BA
; ---------------------------------------------------------------------------

loc_14022F4E9:                          ; CODE XREF: sub_14022EF40+592↑j
                                        ; sub_14022EF40+59B↑j
                lea     rsi, [rcx+58h]
                lea     rsi, [rcx+rsi*4]
                lea     rsi, [r15+rsi*8]
                jmp     loc_14022F5BA
; ---------------------------------------------------------------------------

loc_14022F4FA:                          ; CODE XREF: sub_14022EF40+506↑j
                movzx   eax, byte ptr [rdi+27h]
                and     eax, 0Fh
                lea     rsi, [rax+6Ch]
                lea     rsi, [rax+rsi*4]
                lea     rsi, [r15+rsi*8]
                test    r10d, r10d
                jnz     short loc_14022F57E
                mov     qword ptr [rsp+88h+var_58], r12
                lea     r14, [rsi+20h]
                mov     qword ptr [rsp+88h+var_58+8], r14
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14022F54B
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14022F54B
                mov     eax, [rdx+18h]
                add     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14022F54B
                call    sub_1403F2EC4

loc_14022F54B:                          ; CODE XREF: sub_14022EF40+5F3↑j
                                        ; sub_14022EF40+5F9↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_14022F567
                mov     rdx, r14
                lea     rcx, [rsp+88h+var_58]
                call    sub_14051652C
                and     byte ptr [rdi+27h], 0F0h
                jmp     short loc_14022F5BA
; ---------------------------------------------------------------------------

loc_14022F567:                          ; CODE XREF: sub_14022EF40+612↑j
                lea     rdx, [rsp+88h+var_58]
                xchg    rdx, [r14]
                test    rdx, rdx
                jz      short loc_14022F57E
                lea     rcx, [rsp+88h+var_58]
                call    sub_14025FC20

loc_14022F57E:                          ; CODE XREF: sub_14022EF40+5D0↑j
                                        ; sub_14022EF40+632↑j
                and     byte ptr [rdi+27h], 0F0h
                jmp     short loc_14022F5BA
; ---------------------------------------------------------------------------

loc_14022F584:                          ; CODE XREF: sub_14022EF40+4DB↑j
                call    sub_1403F41D8
                test    eax, eax
                mov     ecx, 1100h
                mov     edx, 13C0h
                cmovz   ecx, edx
                lock dec qword ptr [rcx+r15]
                test    r10d, r10d
                jnz     short loc_14022F5BA
                lea     rdx, [rsi+20h]
                mov     qword ptr [rsp+88h+var_58], r12
                lea     rcx, [rsp+88h+var_58]
                mov     qword ptr [rsp+88h+var_58+8], rdx
                call    sub_14024B3F0

loc_14022F5BA:                          ; CODE XREF: sub_14022EF40+5A4↑j
                                        ; sub_14022EF40+5B5↑j ...
                mov     r10, [rdi]
                mov     r8, 0FFFFFFFFFh
                mov     r9, [rdi+18h]
                and     r10, r8
                and     r9, r8

loc_14022F5D1:                          ; CODE XREF: sub_14022EF40+425↑j
                                        ; sub_14022EF40+42E↑j ...
                cmp     r10, r8
                jz      loc_14022F692
                lea     r11, [r10+r10*2]
                shl     r11, 4
                mov     rax, 0FFFFFA8000000018h
                mov     r14d, dword ptr [rsp+88h+arg_0]
                add     r11, rax
                mov     rax, 0FFFFFFF000000000h
                mov     rdx, [r11]
                mov     rcx, rdx
                and     rcx, rax
                mov     rax, rdx
                or      rcx, r9
                lock cmpxchg [r11], rcx
                mov     r8, rax
                cmp     r14d, 2
                jnz     short loc_14022F64B
                cmp     rdx, rax
                jz      short loc_14022F681
                mov     r13, 0FFFFFFF000000000h
                nop     dword ptr [rax]

loc_14022F630:                          ; CODE XREF: sub_14022EF40+707↓j
                mov     rcx, r8
                and     r8, r13
                or      r8, r9
                mov     rax, rcx
                lock cmpxchg [r11], r8
                mov     r8, rax
                cmp     rcx, rax
                jnz     short loc_14022F630
                jmp     short loc_14022F679
; ---------------------------------------------------------------------------

loc_14022F64B:                          ; CODE XREF: sub_14022EF40+6DC↑j
                cmp     rdx, rax
                jz      short loc_14022F681
                mov     r13, 0FFFFFFF000000000h
                nop     word ptr [rax+rax+00h]

loc_14022F660:                          ; CODE XREF: sub_14022EF40+737↓j
                mov     rcx, r8
                and     r8, r13
                or      r8, r9
                mov     rax, rcx
                lock cmpxchg [r11], r8
                mov     r8, rax
                cmp     rcx, rax
                jnz     short loc_14022F660

loc_14022F679:                          ; CODE XREF: sub_14022EF40+709↑j
                mov     r13, [rsp+88h+arg_10]

loc_14022F681:                          ; CODE XREF: sub_14022EF40+6E1↑j
                                        ; sub_14022EF40+70E↑j
                mov     eax, ebx
                mov     r8, 0FFFFFFFFFh
                shr     eax, 3
                jmp     short loc_14022F6A7
; ---------------------------------------------------------------------------

loc_14022F692:                          ; CODE XREF: sub_14022EF40+694↑j
                mov     r14d, dword ptr [rsp+88h+arg_0]
                mov     eax, ebx
                shr     eax, 3
                test    al, 1
                jnz     short loc_14022F6A7
                mov     [rsi+18h], r9

loc_14022F6A7:                          ; CODE XREF: sub_14022EF40+750↑j
                                        ; sub_14022EF40+761↑j
                cmp     r9, r8
                jz      short loc_14022F6DC
                lea     rdx, [r9+r9*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rdx, 4
                mov     rax, rax
                add     rdx, rax
                mov     rcx, 0FFFFFFF000000000h
                mov     rax, [rdx]
                and     rax, rcx
                or      rax, r10
                mov     [rdx], rax
                jmp     short loc_14022F6E4
; ---------------------------------------------------------------------------

loc_14022F6DC:                          ; CODE XREF: sub_14022EF40+76A↑j
                test    al, 1
                jnz     short loc_14022F6E4
                mov     [rsi+10h], r10

loc_14022F6E4:                          ; CODE XREF: sub_14022EF40+79A↑j
                                        ; sub_14022EF40+79E↑j
                cmp     ebx, 40h ; '@'
                jb      short loc_14022F6EC
                dec     qword ptr [rsi]

loc_14022F6EC:                          ; CODE XREF: sub_14022EF40+7A7↑j
                cmp     r14d, 2
                jnz     loc_14022F91A
                test    bl, 14h
                jnz     loc_14022F91A
                movzx   eax, byte ptr [rdi+23h]
                test    al, 8
                jz      short loc_14022F70D
                lea     r12d, [r14+3]
                jmp     short loc_14022F714
; ---------------------------------------------------------------------------

loc_14022F70D:                          ; CODE XREF: sub_14022EF40+7C5↑j
                mov     r12, rax
                and     r12d, 7

loc_14022F714:                          ; CODE XREF: sub_14022EF40+7CB↑j
                mov     r14, [rdi]
                mov     rax, 0FFFFFFF00h
                movzx   r11d, word ptr [rdi+24h]
                mov     rcx, 0FFFFF0000h
                mov     edx, cs:dword_140C4DD08
                shr     r14, 1Ch
                and     r14, rax
                movzx   eax, byte ptr [rdi+27h]
                or      r14, rax
                mov     rax, [rdi+18h]
                shr     rax, 14h
                and     rax, rcx
                movsxd  rcx, cs:dword_140C4DD04
                or      r11, rax
                mov     [rsp+88h+arg_0], r11
                cmp     ecx, edx
                ja      short loc_14022F782
                mov     rax, rcx
                shl     rax, 4
                add     rax, cs:qword_140C4DD48
                cmp     r13, [rax]
                jb      short loc_14022F782
                cmp     ecx, edx
                jz      short loc_14022F7D9
                cmp     r13, [rax+10h]
                jb      short loc_14022F7D9

loc_14022F782:                          ; CODE XREF: sub_14022EF40+823↑j
                                        ; sub_14022EF40+836↑j
                xor     r8d, r8d
                test    edx, edx
                js      loc_14022FC18
                nop     dword ptr [rax]

loc_14022F790:                          ; CODE XREF: sub_14022EF40+891↓j
                lea     ecx, [r8+rdx]
                sar     ecx, 1
                movsxd  rax, ecx
                shl     rax, 4
                add     rax, cs:qword_140C4DD48
                cmp     r13, [rax]
                jnb     short loc_14022F7B6
                test    ecx, ecx
                jz      loc_14022FC36
                lea     edx, [rcx-1]
                jmp     short loc_14022F7C8
; ---------------------------------------------------------------------------

loc_14022F7B6:                          ; CODE XREF: sub_14022EF40+867↑j
                cmp     ecx, cs:dword_140C4DD08
                jz      short loc_14022F7D3
                cmp     r13, [rax+10h]
                jb      short loc_14022F7D3
                lea     r8d, [rcx+1]

loc_14022F7C8:                          ; CODE XREF: sub_14022EF40+874↑j
                cmp     edx, r8d
                jl      loc_14022FC18
                jmp     short loc_14022F790
; ---------------------------------------------------------------------------

loc_14022F7D3:                          ; CODE XREF: sub_14022EF40+87C↑j
                                        ; sub_14022EF40+882↑j
                mov     cs:dword_140C4DD04, ecx

loc_14022F7D9:                          ; CODE XREF: sub_14022EF40+83A↑j
                                        ; sub_14022EF40+840↑j
                mov     eax, [rax+8]
                mov     rdx, [rdi+28h]
                mov     rcx, cs:qword_140C4E4C8
                shr     rdx, 27h
                imul    rsi, rax, 11C0h
                and     edx, 3FFh
                mov     rdx, [rcx+rdx*8]
                add     rsi, [rdx+10h]
                cmp     cs:qword_140C4DD50, 0
                jz      short loc_14022F81C
                mov     rcx, r13
                call    sub_1403216F8
                mov     r11, [rsp+88h+arg_0]
                jmp     short loc_14022F81E
; ---------------------------------------------------------------------------

loc_14022F81C:                          ; CODE XREF: sub_14022EF40+8C8↑j
                xor     eax, eax

loc_14022F81E:                          ; CODE XREF: sub_14022EF40+8DA↑j
                mov     eax, eax
                lea     rcx, [r12+rax*8]
                mov     r12, 0FFFFFA8000000000h
                lea     rax, [rcx+rcx*2]
                lea     r10, [rsi+rax*8]
                mov     rsi, 0FFFFFFFFFh
                cmp     r14, rsi
                jz      loc_14022F8F2
                lea     r9, [r14+r14*2]
                shl     r9, 4
                mov     rax, r12
                add     r9, rax
                mov     rax, 0FF00000FFFFFFFFFh
                mov     [r9+24h], r11w
                and     r11, 0FFFFFFFFFFFF0000h
                mov     rdx, [r9+18h]
                mov     rcx, rdx
                shl     r11, 14h
                and     rcx, rax
                mov     rax, rdx
                or      rcx, r11
                lock cmpxchg [r9+18h], rcx
                mov     r8, rax
                cmp     rdx, rax
                jz      short loc_14022F8BA
                mov     rdx, 0FF00000FFFFFFFFFh
                nop     dword ptr [rax+00000000h]

loc_14022F8A0:                          ; CODE XREF: sub_14022EF40+978↓j
                mov     rcx, r8
                and     r8, rdx
                or      r8, r11
                mov     rax, rcx
                lock cmpxchg [r9+18h], r8
                mov     r8, rax
                cmp     rcx, rax
                jnz     short loc_14022F8A0

loc_14022F8BA:                          ; CODE XREF: sub_14022EF40+94D↑j
                mov     r11, [rsp+88h+arg_0]

loc_14022F8C2:                          ; CODE XREF: sub_14022EF40+9B9↓j
                cmp     r11, rsi
                jz      short loc_14022F8FB
                lea     rcx, [r11+r11*2]
                shl     rcx, 4
                mov     rax, r12
                add     rcx, rax
                mov     rax, r14
                shl     rax, 1Ch
                xor     rax, [rcx]
                mov     [rcx+27h], r14b
                and     rax, rsi
                shl     r14, 1Ch
                xor     rax, r14
                mov     [rcx], rax
                jmp     short loc_14022F902
; ---------------------------------------------------------------------------

loc_14022F8F2:                          ; CODE XREF: sub_14022EF40+903↑j
                mov     [r10+0CC8h], r11
                jmp     short loc_14022F8C2
; ---------------------------------------------------------------------------

loc_14022F8FB:                          ; CODE XREF: sub_14022EF40+985↑j
                mov     [r10+0CC0h], r14

loc_14022F902:                          ; CODE XREF: sub_14022EF40+9B0↑j
                dec     qword ptr [r10+0CB8h]
                test    bl, 8
                jz      short loc_14022F917
                movzx   eax, byte ptr [rdi+23h]
                and     al, 0F7h
                mov     [rdi+23h], al

loc_14022F917:                          ; CODE XREF: sub_14022EF40+9CC↑j
                xor     r12d, r12d

loc_14022F91A:                          ; CODE XREF: sub_14022EF40+7B0↑j
                                        ; sub_14022EF40+7B9↑j
                mov     [rdi], r12
                mov     r14, 0FFFFFFFFFFFFFFFFh
                test    bl, 4
                jnz     loc_14022F9EF
                mov     rax, 0FFFFFFF000000000h
                mov     rcx, 2000000000000h
                and     [rdi+18h], rax
                test    [rdi+28h], rcx
                jnz     loc_14022F9FC
                cmp     cs:dword_140C4E54C, 1
                jnz     loc_14022F9FC
                mov     rax, cs:qword_140C4E5A8
                mov     r10, r13
                and     r10d, 1Fh
                mov     rcx, r13
                shr     rcx, 5
                mov     esi, 1
                mov     r9d, esi
                lea     r8, [rax+rcx*4]
                lea     rax, [r10+1]
                cmp     rax, 20h ; ' '
                ja      short loc_14022F992
                mov     ecx, r10d
                shl     esi, cl
                lock or [r8], esi
                jmp     short loc_14022F9FC
; ---------------------------------------------------------------------------

loc_14022F992:                          ; CODE XREF: sub_14022EF40+A45↑j
                test    r10, r10
                jz      short loc_14022F9E2
                and     r13d, 1Fh
                mov     edx, 20h ; ' '
                sub     edx, r13d
                mov     eax, esi
                mov     ecx, edx
                shl     eax, cl
                mov     rcx, r10
                dec     eax
                shl     eax, cl
                lock or [r8], eax
                mov     eax, edx
                add     r8, 4
                sub     r9, rax
                cmp     r9, 20h ; ' '
                jb      short loc_14022F9DD
                mov     rdx, r9
                shr     rdx, 5
                imul    rax, rdx, -20h
                add     r9, rax

loc_14022F9D1:                          ; CODE XREF: sub_14022EF40+A9B↓j
                mov     [r8], r14d
                add     r8, 4
                sub     rdx, rsi
                jnz     short loc_14022F9D1

loc_14022F9DD:                          ; CODE XREF: sub_14022EF40+A81↑j
                test    r9, r9
                jz      short loc_14022F9FC

loc_14022F9E2:                          ; CODE XREF: sub_14022EF40+A55↑j
                mov     rcx, r9
                shl     esi, cl
                dec     esi
                lock or [r8], esi
                jmp     short loc_14022F9FC
; ---------------------------------------------------------------------------

loc_14022F9EF:                          ; CODE XREF: sub_14022EF40+9E7↑j
                xor     r8d, r8d
                xor     edx, edx
                mov     rcx, rdi
                call    sub_14026B590

loc_14022F9FC:                          ; CODE XREF: sub_14022EF40+A09↑j
                                        ; sub_14022EF40+A16↑j ...
                cmp     [rsp+88h+arg_8], 0
                jnz     loc_14022FA8F
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_14022FA27
                mov     rdx, [rsp+88h]
                lea     rcx, [rsp+88h+var_58]
                call    sub_1405165EC
                jmp     short loc_14022FA64
; ---------------------------------------------------------------------------

loc_14022FA27:                          ; CODE XREF: sub_14022EF40+AD1↑j
                prefetchw byte ptr [rsp+88h+var_58]
                mov     rax, qword ptr [rsp+88h+var_58]
                test    rax, rax
                jnz     short loc_14022FA59
                mov     rcx, qword ptr [rsp+88h+var_58+8]
                lea     rax, [rsp+88h+var_58]
                lock cmpxchg [rcx], r12
                lea     rcx, [rsp+88h+var_58]
                cmp     rax, rcx
                jz      short loc_14022FA64
                lea     rcx, [rsp+88h+var_58]
                call    sub_140313680

loc_14022FA59:                          ; CODE XREF: sub_14022EF40+AF4↑j
                mov     qword ptr [rsp+88h+var_58], r12
                lock xor qword ptr [rax+8], 1

loc_14022FA64:                          ; CODE XREF: sub_14022EF40+AE5↑j
                                        ; sub_14022EF40+B0D↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14022FA8F
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14022FA8F
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14022FA8F
                call    sub_1403F2EC4

loc_14022FA8F:                          ; CODE XREF: sub_14022EF40+AC4↑j
                                        ; sub_14022EF40+B37↑j ...
                test    bl, 2
                jz      loc_14022FB5F
                lock xadd [r15+1BC0h], r14
                dec     r14
                cmp     r14, [r15+1430h]
                jz      short loc_14022FAB6
                cmp     r14, [r15+1438h]
                jnz     short loc_14022FABE

loc_14022FAB6:                          ; CODE XREF: sub_14022EF40+B6B↑j
                mov     rcx, r15
                call    sub_1403B69C4

loc_14022FABE:                          ; CODE XREF: sub_14022EF40+B74↑j
                lea     rdi, [r14+1]
                cmp     r14, 420h
                ja      short loc_14022FB15
                mov     rax, [r15+1AC0h]
                test    rax, rax
                jz      short loc_14022FADF
                movzx   eax, byte ptr [rax+34h]
                test    al, al
                jnz     short loc_14022FAE7

loc_14022FADF:                          ; CODE XREF: sub_14022EF40+B95↑j
                mov     rcx, r15
                call    sub_14053B754

loc_14022FAE7:                          ; CODE XREF: sub_14022EF40+B9D↑j
                cmp     r14, 0A0h
                jnb     short loc_14022FB15
                cmp     rdi, 0A0h
                jb      short loc_14022FB15
                mov     eax, [r15+488h]
                test    eax, eax
                jz      short loc_14022FB15
                lea     rcx, [r15+3F0h]
                xor     r8d, r8d
                xor     edx, edx
                call    KeSetEvent

loc_14022FB15:                          ; CODE XREF: sub_14022EF40+B89↑j
                                        ; sub_14022EF40+BAE↑j ...
                cmp     r14, 9Fh
                jnb     short loc_14022FB5F
                mov     rax, gs:188h
                mov     ecx, [rax+514h]
                mov     eax, ecx
                and     al, 0Ch
                cmp     al, 8
                jz      short loc_14022FB5F
                cmp     r14, 20h ; ' '
                jnb     short loc_14022FB47
                lea     rax, unk_140C50C00
                cmp     r15, rax
                jz      short loc_14022FB5A

loc_14022FB47:                          ; CODE XREF: sub_14022EF40+BF9↑j
                test    cl, 2
                jz      short loc_14022FB52
                cmp     r14, 21h ; '!'
                jnb     short loc_14022FB5F

loc_14022FB52:                          ; CODE XREF: sub_14022EF40+C0A↑j
                mov     eax, [r15+4]
                test    al, 20h
                jnz     short loc_14022FB5F

loc_14022FB5A:                          ; CODE XREF: sub_14022EF40+C05↑j
                mov     ebx, 0FFFFFFFEh

loc_14022FB5F:                          ; CODE XREF: sub_14022EF40+B52↑j
                                        ; sub_14022EF40+BDC↑j ...
                and     ebx, 1
                mov     eax, ebx

loc_14022FB64:                          ; CODE XREF: sub_14022EF40+184↑j
                mov     r14, [rsp+88h+var_30]
                mov     r12, [rsp+88h+var_20]
                mov     r13, [rsp+88h+var_28]
                mov     rbx, [rsp+88h+var_18]
                mov     r15, [rsp+88h+var_38]
                add     rsp, 78h
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
byte_14022FB84  db 0CCh                 ; DATA XREF: .pdata:00000001400CB244↑o
                                        ; .pdata:00000001400CB250↑o
; ---------------------------------------------------------------------------

loc_14022FB85:                          ; CODE XREF: sub_14022EF40+36↑j
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                mov     r9, cs:qword_140C52708
                sub     rdi, rax
                mov     [rsp+88h+var_68], rcx
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rdi
                sar     rdx, 3
                mov     r8, rdx
                shr     r8, 3Fh
                add     r8, rdx
                mov     edx, 2
                lea     ecx, [rdx+4Ch]
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14022FBCA:                          ; CODE XREF: sub_14022EF40+47B↑j
                                        ; DATA XREF: .pdata:00000001400CB250↑o ...
                shl     r14d, 8
                mov     r9, rdx
                mov     eax, eax
                mov     r8, rdi
                mov     ecx, r14d
                mov     edx, 8886h
                or      rcx, rax
                mov     [rsp+88h+var_68], rcx
                mov     ecx, 1Ah
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14022FBF1:                          ; CODE XREF: sub_14022EF40+4C6↑j
                shl     r14d, 8
                mov     r9, rdx
                mov     eax, eax
                mov     r8, rdi
                mov     ecx, r14d
                mov     edx, 8887h
                or      rcx, rax
                mov     [rsp+88h+var_68], rcx
                mov     ecx, 1Ah
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14022FC18:                          ; CODE XREF: sub_14022EF40+847↑j
                                        ; sub_14022EF40+88B↑j
                xor     r9d, r9d
                mov     [rsp+88h+var_68], 0
                mov     r8, r13
                mov     edx, 6201h
                lea     ecx, [r9+1Ah]
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14022FC36:                          ; CODE XREF: sub_14022EF40+86B↑j
                mov     r9, rax
                mov     [rsp+88h+var_68], 0
                mov     r8, r13
                mov     edx, 6200h
                mov     ecx, 1Ah
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_14022EF40   endp

algn_14022FC55:                         ; DATA XREF: .pdata:00000001400CB25C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14022FC60   proc near               ; CODE XREF: sub_14020CDB0+1D0↑p
                                        ; sub_14022CA60+74E↑p ...
                movzx   eax, byte ptr [rcx+23h]
                test    al, 8
                jnz     short loc_14022FC6D
                and     eax, 7
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022FC6D:                          ; CODE XREF: sub_14022FC60+6↑j
                mov     eax, 5
                retn
sub_14022FC60   endp

; ---------------------------------------------------------------------------
                align 4
algn_14022FC74:                         ; DATA XREF: .pdata:00000001400CB268↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14022FC80   proc near               ; CODE XREF: sub_14022EAE0+3A0↑p
                                        ; DATA XREF: .pdata:00000001400CB274↑o

var_68          = dword ptr -68h
var_64          = dword ptr -64h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
arg_0           = dword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_10], rbx
                mov     [rsp+arg_18], r9
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 50h
                mov     rax, [rcx]
                mov     r10, rcx
                mov     r15, [rcx+38h]
                mov     rsi, r8
                mov     [rsp+88h+var_40], rax
                mov     rbp, rdx
                mov     rax, [rcx+10h]
                mov     rcx, 2000000000000h
                mov     [rsp+88h+var_58], rax
                test    [rdx+28h], rcx
                jnz     loc_14022FF59
                cmp     cs:byte_140C51EDE, 0
                mov     rdx, 2AAAAAAAAAAAAAABh
                mov     r12, 0FFFFFA8000000000h
                jz      short loc_14022FD1A
                mov     rax, r12
                mov     rcx, rbp
                sub     rcx, rax
                mov     rax, rdx
                imul    rcx
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                mov     rax, cs:qword_140C52408
                shr     rdx, 9
                bt      [rax], rdx
                jb      loc_14022FF59

loc_14022FD1A:                          ; CODE XREF: sub_14022FC80+66↑j
                cmp     cs:word_140CFB000, 1
                jbe     loc_14022FF59
                cmp     word ptr [rbp+20h], 0
                jnz     loc_14022FF59
                mov     rax, gs:188h
                test    byte ptr [rax+518h], 40h
                jnz     loc_14022FF59
                mov     rcx, rbp
                call    sub_1402E39C0
                test    eax, eax
                jz      loc_14022FF59
                xor     edi, edi
                lea     r8, [rsp+88h+var_48]
                xor     edx, edx
                mov     [rsp+88h+var_48], rdi
                mov     rcx, r10
                call    sub_1402C6940
                test    eax, eax
                jz      short loc_14022FD8C
                mov     rdx, gs:20h
                lea     r13d, [rax-1]
                movzx   ecx, cs:byte_140C4DD0C
                shl     r13d, cl
                jmp     short loc_14022FDAD
; ---------------------------------------------------------------------------

loc_14022FD8C:                          ; CODE XREF: sub_14022FC80+F1↑j
                mov     rax, gs:188h
                lea     rdx, qword_140CFDCC0
                mov     ecx, [rax+24Ch]
                mov     rdx, [rdx+rcx*8]
                mov     r13d, [rdx+7F18h]

loc_14022FDAD:                          ; CODE XREF: sub_14022FC80+10A↑j
                movzx   ecx, cs:byte_140C4DD0D
                mov     r14d, 1
                shl     r14d, cl
                dec     r14d
                test    r15, r15
                jz      short loc_14022FDD3
                movzx   eax, byte ptr [r15+0B8h]
                and     al, 7
                cmp     al, 2
                jb      short loc_14022FDDA

loc_14022FDD3:                          ; CODE XREF: sub_14022FC80+143↑j
                lea     r15, [rdx+7F10h]

loc_14022FDDA:                          ; CODE XREF: sub_14022FC80+151↑j
                movzx   ecx, cs:byte_140C4DD0C
                mov     ebx, r13d
                shr     ebx, cl
                mov     rax, r12
                mov     rcx, rbp
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     r12, rdx
                sar     r12, 3
                mov     rax, r12
                shr     rax, 3Fh
                add     r12, rax
                mov     rcx, r12
                mov     [rsp+88h+var_50], r12
                call    sub_14027DEC0
                mov     eax, [rax+8]
                cmp     ebx, eax
                jz      loc_14022FF59
                mov     rax, cs:qword_140C4E4C8
                mov     r11d, 1
                mov     rcx, [rbp+28h]
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     r10, [rax+rcx*8]
                mov     eax, r11d
                mov     [rsp+88h+var_60], r10
                lock xadd [r15], eax
                movzx   edx, cs:word_140CFB000
                and     eax, r14d
                mov     ecx, edx
                or      r13d, eax
                mov     rax, cs:qword_140C4DD18
                imul    ecx, ebx
                lea     r14, [rax+rcx*4]
                lea     r15, [r14+rdx*4]
                cmp     r14, r15
                jnb     short loc_14022FEBF

loc_14022FE77:                          ; CODE XREF: sub_14022FC80+237↓j
                mov     rcx, r12
                call    sub_14027DEC0
                mov     ecx, [r14]
                mov     eax, [rax+8]
                cmp     ecx, eax
                jz      loc_14022FF59
                mov     r10, [rsp+88h+var_60]
                imul    rax, rcx, 11C0h
                add     rax, [r10+10h]
                mov     rcx, [rax+1020h]
                mov     rax, [rax+1028h]
                or      rax, rcx
                jnz     short loc_14022FEB9
                add     r14, 4
                cmp     r14, r15
                jb      short loc_14022FE77

loc_14022FEB9:                          ; CODE XREF: sub_14022FC80+22E↑j
                mov     r11d, 1

loc_14022FEBF:                          ; CODE XREF: sub_14022FC80+1F5↑j
                mov     rcx, rbp
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14022FEDA
                mov     eax, [rbp+10h]
                bt      rax, 0Ah
                jnb     short loc_14022FEDA
                mov     r12d, r11d
                jmp     short loc_14022FEED
; ---------------------------------------------------------------------------

loc_14022FEDA:                          ; CODE XREF: sub_14022FC80+249↑j
                                        ; sub_14022FC80+253↑j
                call    sub_140279D40
                test    eax, eax
                mov     r12d, edi
                mov     ecx, 5
                cmovnz  r12d, ecx

loc_14022FEED:                          ; CODE XREF: sub_14022FC80+258↑j
                mov     r8d, r12d
                mov     edx, r11d
                mov     rcx, r10
                call    sub_140233120
                test    eax, eax
                jz      short loc_14022FF59
                mov     rax, [rsp+88h+var_58]
                mov     r14d, 1
                test    r14b, al
                jz      short loc_14022FF18
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 4
                jz      short loc_14022FF27

loc_14022FF18:                          ; CODE XREF: sub_14022FC80+28D↑j
                mov     rcx, [rsp+88h+var_40]
                call    sub_140245330
                cmp     eax, 0Ch
                jnz     short loc_14022FF2D

loc_14022FF27:                          ; CODE XREF: sub_14022FC80+296↑j
                mov     r14d, 9

loc_14022FF2D:                          ; CODE XREF: sub_14022FC80+2A5↑j
                mov     r8d, r14d
                mov     edx, r13d
                mov     r14, [rsp+88h+var_60]
                mov     rcx, r14
                call    sub_14022ACA0
                mov     [rsp+88h+var_58], rax
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jnz     short loc_14022FF75
                mov     r8d, r12d
                lea     edx, [rax+2]
                mov     rcx, r14

loc_14022FF54:                          ; CODE XREF: sub_14022FC80+3CB↓j
                call    sub_14031D584

loc_14022FF59:                          ; CODE XREF: sub_14022FC80+45↑j
                                        ; sub_14022FC80+94↑j ...
                mov     rax, rbp

loc_14022FF5C:                          ; CODE XREF: sub_14022FC80+754↓j
                                        ; sub_14022FC80+75C↓j
                mov     rbx, [rsp+88h+arg_10]
                add     rsp, 50h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14022FF75:                          ; CODE XREF: sub_14022FC80+2C9↑j
                lea     r14, [rax+rax*2]
                mov     rdx, 0FFFFFA8000000000h
                shl     r14, 4
                mov     rcx, rdx
                add     r14, rcx
                mov     rcx, rdx
                mov     rdx, r14
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rdx, rcx
                imul    rdx
                mov     r13, rdx
                sar     r13, 3
                mov     rax, r13
                shr     rax, 3Fh
                add     r13, rax
                mov     rcx, r13
                call    sub_14027DEC0
                mov     eax, [rax+8]
                cmp     ebx, eax
                jz      short loc_140230009
                movzx   ecx, cs:word_140CFB000
                mov     rax, cs:qword_140C4DD18
                imul    ecx, ebx
                lea     rbx, [rax+rcx*4]
                cmp     rbx, r15
                jnb     short loc_140230009
                nop     dword ptr [rax]

loc_14022FFE0:                          ; CODE XREF: sub_14022FC80+387↓j
                mov     rcx, [rsp+88h+var_50]
                call    sub_14027DEC0
                mov     eax, [rax+8]
                cmp     [rbx], eax
                jz      short loc_14023001D
                mov     rcx, r13
                call    sub_14027DEC0
                mov     eax, [rax+8]
                cmp     [rbx], eax
                jz      short loc_140230009
                add     rbx, 4
                cmp     rbx, r15
                jb      short loc_14022FFE0

loc_140230009:                          ; CODE XREF: sub_14022FC80+341↑j
                                        ; sub_14022FC80+35B↑j ...
                test    rsi, rsi
                jz      short loc_140230050
                mov     ecx, 6
                call    sub_1402C6ABC
                test    rax, rax
                jnz     short loc_140230055

loc_14023001D:                          ; CODE XREF: sub_14022FC80+36F↑j
                mov     rcx, r14
                call    sub_14032F060
                xor     edx, edx
                mov     rcx, r14
                call    sub_1402D9A60
                mov     r13, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], r13
                mov     rcx, [rsp+88h+var_60]
                mov     r8d, r12d
                mov     edx, 1
                jmp     loc_14022FF54
; ---------------------------------------------------------------------------

loc_140230050:                          ; CODE XREF: sub_14022FC80+38C↑j
                mov     r12, rdi
                jmp     short loc_140230058
; ---------------------------------------------------------------------------

loc_140230055:                          ; CODE XREF: sub_14022FC80+39B↑j
                mov     r12, rax

loc_140230058:                          ; CODE XREF: sub_14022FC80+3D3↑j
                movzx   ebx, byte ptr [rbp+22h]
                mov     rcx, r14
                shr     ebx, 6
                call    sub_14032F060
                movzx   eax, byte ptr [r14+22h]
                shr     eax, 6
                cmp     eax, ebx
                jz      short loc_140230083
                mov     r8d, 1
                mov     edx, ebx
                mov     rcx, r14
                call    sub_14031F848

loc_140230083:                          ; CODE XREF: sub_14022FC80+3F1↑j
                mov     ebx, 1
                xor     edx, edx
                mov     r8d, ebx
                mov     rcx, r14
                call    sub_1402C5F40
                mov     rdx, rbp
                mov     rcx, r14
                call    sub_1402E1CC0
                mov     rax, 0C000000000000000h
                mov     [r14+20h], bx
                and     [r14+18h], rax
                movzx   eax, byte ptr [rbp+22h]
                and     al, 0FDh
                or      al, 5
                mov     [rbp+22h], al
                test    r12, r12
                jz      short loc_1402300E7
                or      dword ptr [r12+0C0h], 20h
                movzx   eax, byte ptr [r14+22h]
                or      al, 20h
                mov     [r14+22h], al
                lea     rax, [r12+20h]
                mov     [r14], rax
                mov     [r12+0F8h], r14

loc_1402300E7:                          ; CODE XREF: sub_14022FC80+441↑j
                mov     r15, [r14+8]
                mov     r13, 8000000000000000h
                or      r15, r13
                mov     rcx, r15
                call    sub_1402805F0
                mov     rdx, [rsp+88h+var_58]
                mov     rcx, rax
                call    sub_1402E1C70
                mov     rcx, r15
                mov     rbx, rax
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14023016A
                call    sub_140349680
                test    eax, eax
                jz      short loc_140230146
                cmp     byte ptr cs:word_140C4DE88+1, dil
                jnz     short loc_140230136
                test    bl, 1
                jz      short loc_140230136
                or      rbx, r13

loc_140230136:                          ; CODE XREF: sub_14022FC80+4AC↑j
                                        ; sub_14022FC80+4B1↑j
                mov     rdx, rbx
                mov     [r15], rbx
                mov     rcx, r15
                call    sub_140349620
                jmp     short loc_14023016D
; ---------------------------------------------------------------------------

loc_140230146:                          ; CODE XREF: sub_14022FC80+4A3↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14023016A
                test    bl, 1
                jz      short loc_14023016A
                or      rbx, r13

loc_14023016A:                          ; CODE XREF: sub_14022FC80+49A↑j
                                        ; sub_14022FC80+4E0↑j ...
                mov     [r15], rbx

loc_14023016D:                          ; CODE XREF: sub_14022FC80+4C4↑j
                mov     r13, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], r13
                mov     ebx, 2
                test    rsi, rsi
                jz      loc_140230212
                mov     rcx, rsi
                call    sub_14032F060
                mov     rcx, rsi
                call    sub_140275EA0
                test    eax, eax
                jz      short loc_1402301AD
                lea     edx, [rbx+1]
                mov     rcx, rsi
                call    sub_14027B510
                test    eax, eax
                jz      short loc_1402301B1

loc_1402301AD:                          ; CODE XREF: sub_14022FC80+51C↑j
                inc     word ptr [rsi+20h]

loc_1402301B1:                          ; CODE XREF: sub_14022FC80+52B↑j
                lock and [rsi+18h], r13
                lock and [rbp+18h], r13
                mov     [rsp+88h+arg_0], edi
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jnb     short loc_1402301EF
                nop     dword ptr [rax+rax+00h]

loc_1402301D0:                          ; CODE XREF: sub_14022FC80+564↓j
                                        ; sub_14022FC80+56D↓j
                lea     rcx, [rsp+88h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_1402301D0
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_1402301D0

loc_1402301EF:                          ; CODE XREF: sub_14022FC80+549↑j
                movzx   eax, byte ptr [rsi+22h]
                mov     rcx, rsi
                and     al, 0DFh
                mov     [rsi+22h], al
                call    sub_14027B630
                lock and [rsi+18h], r13
                mov     rax, [rsp+88h+arg_18]
                mov     [rax], r12
                jmp     short loc_140230255
; ---------------------------------------------------------------------------

loc_140230212:                          ; CODE XREF: sub_14022FC80+504↑j
                lock and [rbp+18h], r13
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140230251
                test    al, 1
                jz      short loc_140230251
                mov     rax, cr8
                sub     al, bl
                cmp     al, 0Dh
                ja      short loc_140230251
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                mov     eax, [rdx+14h]
                and     eax, 0FFFF0007h
                mov     [rdx+14h], eax
                jnz     short loc_140230251
                call    sub_1403F2EC4

loc_140230251:                          ; CODE XREF: sub_14022FC80+59F↑j
                                        ; sub_14022FC80+5A3↑j ...
                mov     cr8, rbx

loc_140230255:                          ; CODE XREF: sub_14022FC80+590↑j
                mov     rcx, [rsp+88h+var_58]
                mov     r9d, ebx
                mov     rbx, [rsp+88h+var_50]
                xor     r8d, r8d
                mov     rdx, rbx
                call    sub_14025B390
                test    rsi, rsi
                jz      short loc_1402302EE
                xor     edx, edx
                mov     rcx, r15
                call    sub_140299CD0
                mov     [rsp+88h+arg_8], edi
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jnb     short loc_1402302AF
                nop     dword ptr [rax+00h]

loc_140230290:                          ; CODE XREF: sub_14022FC80+624↓j
                                        ; sub_14022FC80+62D↓j
                lea     rcx, [rsp+88h+arg_8]
                call    sub_1402C8C70
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_140230290
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_140230290

loc_1402302AF:                          ; CODE XREF: sub_14022FC80+60A↑j
                mov     rcx, rsi
                call    sub_14027B630
                lock and [rsi+18h], r13
                mov     [rsp+88h+var_68], edi
                lock bts qword ptr [rbp+18h], 3Fh ; '?'
                jnb     short loc_1402302F6
                nop     dword ptr [rax+00000000h]

loc_1402302D0:                          ; CODE XREF: sub_14022FC80+661↓j
                                        ; sub_14022FC80+66A↓j
                lea     rcx, [rsp+88h+var_68]
                call    sub_1402C8C70
                mov     rax, [rbp+18h]
                test    rax, rax
                js      short loc_1402302D0
                lock bts qword ptr [rbp+18h], 3Fh ; '?'
                jb      short loc_1402302D0
                jmp     short loc_1402302F6
; ---------------------------------------------------------------------------

loc_1402302EE:                          ; CODE XREF: sub_14022FC80+5F0↑j
                mov     rcx, rbp
                call    sub_1402DAA00

loc_1402302F6:                          ; CODE XREF: sub_14022FC80+647↑j
                                        ; sub_14022FC80+66C↑j
                mov     rax, 8FFFFFFFFFFFFFFFh
                mov     edx, 2
                and     [rbp+28h], rax
                mov     rcx, rbx
                call    sub_140292A50
                lock and [rbp+18h], r13
                mov     [rsp+88h+var_64], edi
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jnb     short loc_14023033F

loc_140230323:                          ; CODE XREF: sub_14022FC80+6B4↓j
                                        ; sub_14022FC80+6BD↓j
                lea     rcx, [rsp+88h+var_64]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_140230323
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_140230323

loc_14023033F:                          ; CODE XREF: sub_14022FC80+6A1↑j
                movzx   eax, byte ptr [r14+22h]
                mov     rcx, r14
                movzx   ebx, word ptr [r14+20h]
                and     al, 0DFh
                mov     [r14+22h], al
                mov     [r14], rdi
                call    sub_1402989F0
                test    r12, r12
                jz      short loc_1402303D9
                and     dword ptr [r12+0C0h], 0FFFFFFDFh
                mov     rax, [r14+18h]
                shr     rax, 3Eh
                test    al, 1
                jz      short loc_1402303D9
                cmp     bx, 1
                jnz     short loc_1402303A6
                mov     eax, [r14+10h]
                lea     rcx, [r14+10h]
                bt      rax, 0Ah
                jb      short loc_140230397
                xor     edx, edx
                lea     r8d, [rdx+1]
                call    sub_140338C90
                mov     rdi, rax

loc_140230397:                          ; CODE XREF: sub_14022FC80+707↑j
                mov     rcx, [rsp+88h+var_58]
                mov     edx, 2
                call    sub_140292A50

loc_1402303A6:                          ; CODE XREF: sub_14022FC80+6F8↑j
                lock and [r14+18h], r13
                test    rsi, rsi
                jz      short loc_1402303BA
                mov     dl, 2
                mov     rcx, rsi
                call    sub_140297330

loc_1402303BA:                          ; CODE XREF: sub_14022FC80+72E↑j
                test    rdi, rdi
                jz      short loc_1402303D2
                mov     rcx, [rsp+88h+var_60]
                mov     r8d, 1
                mov     rdx, rdi
                call    sub_14020B2C0

loc_1402303D2:                          ; CODE XREF: sub_14022FC80+73D↑j
                xor     eax, eax
                jmp     loc_14022FF5C
; ---------------------------------------------------------------------------

loc_1402303D9:                          ; CODE XREF: sub_14022FC80+6DD↑j
                                        ; sub_14022FC80+6F2↑j
                mov     rax, r14
                jmp     loc_14022FF5C
sub_14022FC80   endp

; ---------------------------------------------------------------------------
algn_1402303E1:                         ; DATA XREF: .pdata:00000001400CB274↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402303F0   proc near               ; CODE XREF: sub_1402228C0+364↑p
                                        ; sub_14022CA60+946↑p ...
                mov     rax, [rcx+28h]
                mov     rcx, 2000000000000h
                test    rcx, rax
                jnz     short loc_140230407
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140230407:                          ; CODE XREF: sub_1402303F0+11↑j
                mov     eax, 1
                retn
sub_1402303F0   endp

; ---------------------------------------------------------------------------
                align 2
algn_14023040E:                         ; DATA XREF: .pdata:00000001400CB280↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=40h

sub_140230420   proc near               ; CODE XREF: sub_14063CB90+2A5↓p
                                        ; sub_14068D588+1A5↓p ...

var_120         = qword ptr -120h
var_118         = qword ptr -118h
var_110         = dword ptr -110h
var_108         = qword ptr -108h
var_100         = dword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = dword ptr -0F0h
var_EC          = dword ptr -0ECh
var_E8          = qword ptr -0E8h
var_E0          = qword ptr -0E0h
var_D8          = dword ptr -0D8h
var_D4          = dword ptr -0D4h
var_D0          = dword ptr -0D0h
var_C8          = qword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = dword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = xmmword ptr -50h
var_40          = xmmword ptr -40h
arg_0           = qword ptr  10h
arg_8           = byte ptr  18h
arg_10          = word ptr  20h
arg_18          = qword ptr  28h
arg_20          = dword ptr  30h
arg_28          = qword ptr  38h
arg_30          = byte ptr  40h
arg_38          = qword ptr  48h
arg_40          = qword ptr  50h
arg_48          = qword ptr  58h

                mov     [rsp-8+arg_18], rbx
                mov     [rsp-8+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-10h]
                sub     rsp, 110h
                mov     r11d, [rcx+30h]
                mov     rbx, r8
                mov     r10, [rbp+40h+arg_28]
                mov     rsi, rcx
                xor     edi, edi
                xorps   xmm0, xmm0
                mov     r8d, r11d
                mov     [rbp+40h+var_68], rdi
                shr     r8d, 7
                mov     ecx, r9d
                and     r8d, 1Fh
                mov     [rsp+140h+var_D8], edi
                mov     r15, rdx
                movups  [rbp+40h+var_50], xmm0
                movups  [rbp+40h+var_40], xmm0
                call    sub_1402320B0
                mov     [rsp+140h+var_110], eax
                mov     edx, eax
                cmp     eax, 18h
                jnz     short loc_140230487
                jmp     short loc_1402304E8
; ---------------------------------------------------------------------------

loc_140230487:                          ; CODE XREF: sub_140230420+63↑j
                cmp     r8d, 18h
                jnz     short loc_1402304AC
                bt      r11d, 14h
                jb      short loc_1402304A4
                mov     rax, [rsi+48h]
                movzx   r8d, word ptr [rax+20h]
                shr     r8d, 1
                and     r8d, 1Fh

loc_1402304A4:                          ; CODE XREF: sub_140230420+72↑j
                cmp     r8d, 18h
                cmovz   r8d, edi

loc_1402304AC:                          ; CODE XREF: sub_140230420+6B↑j
                and     r8d, 18h
                jz      short loc_1402304D1
                cmp     r8d, 10h
                jz      short loc_1402304E5
                cmp     r8d, 8
                jnz     short loc_1402304C6
                and     edx, 0FFFFFFEFh
                or      edx, r8d
                jmp     short loc_1402304E8
; ---------------------------------------------------------------------------

loc_1402304C6:                          ; CODE XREF: sub_140230420+9C↑j
                cmp     r8d, 18h
                jnz     short loc_1402304EC
                or      edx, r8d
                jmp     short loc_1402304E8
; ---------------------------------------------------------------------------

loc_1402304D1:                          ; CODE XREF: sub_140230420+90↑j
                mov     eax, edx
                and     eax, 18h
                cmp     eax, 18h
                jnz     short loc_1402304E0
                and     edx, 0FFFFFFE7h
                jmp     short loc_1402304E8
; ---------------------------------------------------------------------------

loc_1402304E0:                          ; CODE XREF: sub_140230420+B9↑j
                cmp     eax, 8
                jnz     short loc_1402304EC

loc_1402304E5:                          ; CODE XREF: sub_140230420+96↑j
                and     edx, 0FFFFFFF7h

loc_1402304E8:                          ; CODE XREF: sub_140230420+65↑j
                                        ; sub_140230420+A4↑j ...
                mov     [rsp+140h+var_110], edx

loc_1402304EC:                          ; CODE XREF: sub_140230420+AA↑j
                                        ; sub_140230420+C3↑j
                mov     rax, gs:188h
                mov     r8, 0FFFFFFFFFh
                mov     [rbp+40h+var_88], rax
                mov     r14, 0FFFFF68000000000h
                mov     r13, [rax+0B8h]
                mov     [rsp+140h+var_F8], r13
                cmp     [rsi+34h], edi
                jge     short loc_140230538
                movzx   ecx, byte ptr [rsi+21h]
                mov     eax, [rsi+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                and     rcx, r8
                mov     rax, r14
                lea     r8, [rax+rcx*8]
                jmp     short loc_14023053B
; ---------------------------------------------------------------------------

loc_140230538:                          ; CODE XREF: sub_140230420+FC↑j
                mov     r8, rdi

loc_14023053B:                          ; CODE XREF: sub_140230420+116↑j
                mov     rcx, cs:qword_140C4DDC0
                mov     eax, edx
                and     eax, 1Fh
                mov     [rbp+40h+var_98], r8
                shl     rax, 5
                mov     [rbp+40h+var_58], rax
                mov     rdi, rax
                test    rcx, rcx
                jz      short loc_14023056C
                mov     rax, rcx
                and     rax, rdi
                jnz     short loc_140230568
                or      rdi, rcx
                jmp     short loc_14023056C
; ---------------------------------------------------------------------------

loc_140230568:                          ; CODE XREF: sub_140230420+141↑j
                or      rdi, 10h

loc_14023056C:                          ; CODE XREF: sub_140230420+139↑j
                                        ; sub_140230420+146↑j
                mov     ecx, r11d
                bt      r11d, 14h
                jnb     short loc_140230587
                bt      ecx, 18h
                jb      short loc_140230587
                bt      ecx, 1Ah
                jnb     short loc_140230587
                bts     rdi, 1Ah

loc_140230587:                          ; CODE XREF: sub_140230420+154↑j
                                        ; sub_140230420+15A↑j ...
                mov     r9, r15
                mov     r11, 7FFFFFFFF8h
                shr     r9, 9
                and     r9, r11
                mov     rax, r14
                lea     r14, [rbx-1]
                add     r9, rax
                add     r14, r15
                mov     [rbp+40h+var_B8], r9
                or      r14, 0FFFh
                mov     rbx, 0FFFFF68000000000h
                mov     rdx, r14
                mov     r12, r9
                shr     rdx, 9
                and     rdx, r11
                mov     rax, rbx
                add     rdx, rax
                and     r10d, 1Ah
                lea     rax, [r13+680h]
                mov     [rbp+40h+var_78], rdx
                mov     [rsp+140h+var_E8], rax
                mov     r11, rdx
                sub     r11, r9
                mov     eax, ecx
                sar     r11, 3
                and     eax, 500000h
                inc     r11
                mov     [rbp+40h+var_80], r11
                cmp     eax, 500000h
                jnz     loc_14023073F
                shr     rcx, 12h
                lea     rax, cs:140000000h
                and     ecx, 3
                mov     r9d, 10h
                mov     r13, ds:rva qword_14002DE90[rax+rcx*8]
                mov     ecx, ds:rva dword_14002DE50[rax+rcx*4]
                cmp     r13, r9
                mov     eax, 1
                mov     [rsp+140h+var_108], r13
                cmovnz  r9d, eax
                mov     [rsp+140h+var_F0], ecx
                mov     [rbp+40h+var_90], r9
                cmp     ecx, eax
                ja      loc_140230730
                jnz     short loc_14023065D
                cmp     r10, 8
                jz      short loc_140230667
                mov     eax, 0C000000Dh
                jmp     loc_1402312EE
; ---------------------------------------------------------------------------

loc_14023065D:                          ; CODE XREF: sub_140230420+22B↑j
                cmp     r10, 10h
                jnz     loc_1402307D7

loc_140230667:                          ; CODE XREF: sub_140230420+231↑j
                mov     eax, 2
                mov     r9, 7FFFFFFFF8h
                sub     eax, ecx
                mov     ecx, eax
                nop     word ptr [rax+rax+00h]

loc_140230680:                          ; CODE XREF: sub_140230420+28B↓j
                shr     r12, 9
                and     r12, r9
                mov     rax, rbx
                shr     rdx, 9
                add     r12, rax
                and     rdx, r9
                mov     rax, rbx
                shr     r8, 9
                add     rdx, rax
                and     r8, r9
                mov     rax, rbx
                add     r8, rax
                sub     rcx, 1
                jnz     short loc_140230680
                mov     [rbp+40h+var_98], r8
                mov     [rbp+40h+var_78], rdx

loc_1402306B5:                          ; CODE XREF: sub_140230420+31A↓j
                                        ; sub_140230420+350↓j
                mov     rcx, [rsp+140h+var_E8]
                xor     ebx, ebx
                mov     [rsp+140h+var_D0], ebx
                call    sub_140231340
                mov     r8, [rbp+40h+arg_0]
                mov     rcx, r15
                and     rcx, 0FFFFFFFFFFFFF000h
                mov     [rsp+140h+var_118], rbx
                movzx   r9d, al
                mov     dword ptr [rsp+140h+var_120], ebx
                mov     rdx, r14
                movzx   esi, al
                call    sub_1402A5AD0
                mov     rcx, [rsp+140h+var_E8]
                movzx   edx, sil
                mov     rbx, rax
                call    sub_140226960
                mov     r9, [rbp+40h+var_80]
                sub     r9, rbx
                mov     [rbp+40h+var_C0], r9
                jz      loc_140230894
                cmp     r13, 1
                mov     rdx, r9
                mov     r13, r9
                jnz     short loc_140230787
                mov     rcx, [rsp+140h+var_F8]
                call    sub_14063D610
                test    eax, eax
                jns     loc_140230897
                jmp     loc_1402312EE
; ---------------------------------------------------------------------------

loc_140230730:                          ; CODE XREF: sub_140230420+225↑j
                cmp     r10, 2
                jnz     loc_1402307D7
                jmp     loc_1402306B5
; ---------------------------------------------------------------------------

loc_14023073F:                          ; CODE XREF: sub_140230420+1E1↑j
                test    r10, r10
                jnz     loc_1402307D7
                mov     rcx, [rsp+140h+var_F8]
                mov     ebx, 1
                mov     rdx, r11
                mov     [rsp+140h+var_108], rbx
                mov     r13d, ebx
                mov     [rbp+40h+var_90], rbx
                mov     [rsp+140h+var_F0], 3
                call    sub_14063D610
                test    eax, eax
                js      loc_1402306B5
                mov     r13, [rbp+40h+var_80]
                mov     [rbp+40h+var_C0], r13
                mov     [rsp+140h+var_D0], ebx
                jmp     loc_1402308A0
; ---------------------------------------------------------------------------

loc_140230787:                          ; CODE XREF: sub_140230420+2F7↑j
                mov     r9, [rsp+140h+var_F8]
                mov     rcx, r9
                call    sub_1408D8A14
                test    eax, eax
                jz      loc_1402309D1
                mov     rsi, [rbp+40h+arg_0]
                mov     edx, 10h
                mov     rcx, rsi
                call    sub_1402EBB3C
                test    rax, rax
                jnz     short loc_1402307B6
                xor     ebx, ebx
                jmp     short loc_1402307BA
; ---------------------------------------------------------------------------

loc_1402307B6:                          ; CODE XREF: sub_140230420+390↑j
                mov     rbx, [rax+18h]

loc_1402307BA:                          ; CODE XREF: sub_140230420+394↑j
                mov     rax, [rbp+40h+arg_38]
                cmp     rax, 1
                jz      short loc_1402307E1
                cmp     rax, rbx
                jz      short loc_1402307E1
                mov     rdx, r13
                mov     rcx, r9
                call    sub_1408D8DA0

loc_1402307D7:                          ; CODE XREF: sub_140230420+241↑j
                                        ; sub_140230420+314↑j ...
                mov     eax, 0C000000Dh
                jmp     loc_1402312EE
; ---------------------------------------------------------------------------

loc_1402307E1:                          ; CODE XREF: sub_140230420+3A5↑j
                                        ; sub_140230420+3AA↑j
                test    rbx, rbx
                jz      loc_140230873
                mov     rcx, rbx
                call    sub_1402073F0
                test    al, al
                jnz     short loc_14023080B
                mov     rdx, r13
                mov     rcx, r9
                call    sub_1408D8DA0
                mov     eax, 0C00004A0h
                jmp     loc_1402312EE
; ---------------------------------------------------------------------------

loc_14023080B:                          ; CODE XREF: sub_140230420+3D4↑j
                mov     rax, [rbx]
                movzx   ecx, word ptr [rax]
                mov     rax, [rbp+40h+arg_48]
                mov     [rax], cx

loc_14023081B:                          ; CODE XREF: sub_140230420+460↓j
                movzx   r8d, [rbp+40h+arg_30]
                lea     rax, [rbp+40h+var_50]
                mov     r9, rbx
                mov     [rsp+140h+var_120], rax
                mov     rdx, r13
                mov     rcx, rsi
                call    sub_14055E0FC
                mov     esi, eax
                test    rbx, rbx
                jz      short loc_140230849
                mov     rcx, rbx
                call    sub_1402073C8

loc_140230849:                          ; CODE XREF: sub_140230420+41F↑j
                test    esi, esi
                jns     short loc_140230897
                test    rbx, rbx
                jnz     short loc_14023085F
                mov     rcx, [rsp+140h+var_F8]
                mov     rdx, r13
                call    sub_14065C6A8

loc_14023085F:                          ; CODE XREF: sub_140230420+430↑j
                mov     rcx, [rsp+140h+var_F8]
                mov     rdx, r13
                call    sub_1408D8DA0
                mov     eax, esi
                jmp     loc_1402312EE
; ---------------------------------------------------------------------------

loc_140230873:                          ; CODE XREF: sub_140230420+3C4↑j
                mov     rdx, r13
                mov     rcx, r9
                call    sub_14063D610
                test    eax, eax
                jns     short loc_14023081B
                mov     rcx, [rsp+140h+var_F8]
                mov     rdx, r13
                call    sub_1408D8DA0
                jmp     loc_1402312EE
; ---------------------------------------------------------------------------

loc_140230894:                          ; CODE XREF: sub_140230420+2E7↑j
                mov     r13, r9

loc_140230897:                          ; CODE XREF: sub_140230420+305↑j
                                        ; sub_140230420+42B↑j
                mov     rsi, [rbp+40h+arg_0]
                mov     ebx, 1

loc_1402308A0:                          ; CODE XREF: sub_140230420+362↑j
                mov     eax, [rsi+30h]
                mov     [rsp+140h+var_D4], 0
                bt      eax, 14h
                jnb     short loc_14023092E
                test    al, 70h
                jnz     short loc_1402308BF
                cmp     dword ptr [rsi+34h], 0
                jge     loc_140230959

loc_1402308BF:                          ; CODE XREF: sub_140230420+493↑j
                                        ; sub_140230420+518↓j ...
                xor     eax, eax
                movzx   r13d, ax
                mov     [rsp+140h+var_C8], rax
                mov     [rsp+140h+var_EC], r13d
                mov     r15d, eax
                mov     [rbp+40h+var_70], rax
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_1402308E0:                          ; CODE XREF: sub_140230420+D48↓j
                                        ; sub_140230420+D68↓j
                cmp     [rsp+140h+var_F0], 0
                mov     r14, rax
                mov     esi, eax
                mov     [rsp+140h+var_100], eax
                jnz     short loc_140230919
                mov     rcx, [rbp+40h+arg_0]
                call    sub_140547D48
                mov     rcx, [rsp+140h+var_E8]
                mov     r8d, eax
                mov     [rsp+140h+var_100], 1
                call    sub_14054F9D8
                mov     [rbp+40h+arg_8], al
                cmp     al, 11h
                jnz     loc_1402309DB

loc_140230919:                          ; CODE XREF: sub_140230420+4CE↑j
                mov     rbx, [rsp+140h+var_E8]
                mov     rcx, rbx
                call    sub_140231340
                mov     [rbp+40h+arg_8], al
                jmp     loc_1402309E0
; ---------------------------------------------------------------------------

loc_14023092E:                          ; CODE XREF: sub_140230420+48F↑j
                and     eax, 0F80h
                cmp     eax, 0C00h
                jnz     short loc_1402308BF
                mov     rax, [rsi+48h]
                mov     rcx, [rax]
                cmp     qword ptr [rcx+40h], 0
                jnz     loc_1402308BF
                test    dword ptr [rcx+38h], 1000h
                jz      loc_1402308BF

loc_140230959:                          ; CODE XREF: sub_140230420+499↑j
                mov     rax, [rbp+40h+var_88]
                mov     [rsp+140h+var_D4], ebx
                dec     word ptr [rax+1E6h]
                mov     rbx, [rsp+140h+var_F8]
                xor     edx, edx
                add     rbx, 4D0h
                mov     rcx, rbx
                call    ExAcquirePushLockExclusiveEx
                mov     r8, r14
                mov     rdx, r15
                mov     rcx, rsi
                call    sub_14063D6E0
                test    eax, eax
                jns     loc_1402308BF
                mov     rax, 0FFFFFFFFFFFFFFFFh
                lock xadd [rbx], rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_1402309AE
                mov     rcx, rbx
                call    ExfTryToWakePushLock

loc_1402309AE:                          ; CODE XREF: sub_140230420+584↑j
                mov     rcx, rbx
                call    sub_140243660
                mov     rcx, [rbp+40h+var_88]
                call    sub_140245770
                test    r13, r13
                jz      short loc_1402309D1
                mov     rcx, [rsp+140h+var_F8]
                mov     rdx, r13
                call    sub_14065C6A8

loc_1402309D1:                          ; CODE XREF: sub_140230420+376↑j
                                        ; sub_140230420+5A2↑j
                mov     eax, 0C000012Dh
                jmp     loc_1402312EE
; ---------------------------------------------------------------------------

loc_1402309DB:                          ; CODE XREF: sub_140230420+4F3↑j
                                        ; sub_140230420+D0C↓j
                mov     rbx, [rsp+140h+var_E8]

loc_1402309E0:                          ; CODE XREF: sub_140230420+509↑j
                cmp     r12, [rbp+40h+var_78]
                ja      loc_14023118D
                test    esi, esi
                jz      short loc_1402309FB
                test    r12, 0FFFh
                jnz     loc_140230D45

loc_1402309FB:                          ; CODE XREF: sub_140230420+5CC↑j
                test    r13w, r13w
                jz      short loc_140230A17
                movzx   edx, r13w
                mov     rcx, r15
                call    sub_14029DD54
                xor     r13d, r13d
                mov     [rsp+140h+var_EC], r13d
                jmp     short loc_140230A1A
; ---------------------------------------------------------------------------

loc_140230A17:                          ; CODE XREF: sub_140230420+5DF↑j
                xor     r13d, r13d

loc_140230A1A:                          ; CODE XREF: sub_140230420+5F5↑j
                test    r14, r14
                jz      short loc_140230A2A
                mov     rdx, r14
                mov     rcx, rbx
                call    sub_140312B40

loc_140230A2A:                          ; CODE XREF: sub_140230420+5FD↑j
                mov     rsi, r12
                mov     rdx, 0FFFFF68000000000h
                shr     rsi, 9
                mov     rax, 7FFFFFFFF8h
                and     rsi, rax
                mov     rax, rdx
                add     rsi, rax
                mov     [rbp+40h+var_60], r13
                mov     rax, [rbp+40h+arg_0]
                mov     r15, r12
                mov     [rbp+40h+var_A0], rsi
                shl     r15, 19h
                mov     ebx, [rax+30h]
                mov     rax, gs:188h
                shr     ebx, 0Ch
                and     ebx, 3Fh
                mov     rax, [rax+0B8h]
                mov     [rsp+140h+var_E0], rax
                lea     r14, [rax+680h]
                mov     rax, rdx
                shl     rax, 19h
                sub     r15, rax
                sar     r15, 10h
                mov     rax, rdx
                cmp     r15, rax
                jb      short loc_140230AAE
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r15, rax
                jbe     short loc_140230AB4

loc_140230AAE:                          ; CODE XREF: sub_140230420+67A↑j
                mov     r13d, 1

loc_140230AB4:                          ; CODE XREF: sub_140230420+68C↑j
                                        ; sub_140230420+783↓j ...
                cmp     [rsp+140h+var_100], 0
                jz      short loc_140230AD9
                mov     rcx, r12
                call    sub_14029B5F0
                test    al, al
                jnz     loc_140230BB6
                movzx   edx, [rbp+40h+arg_8]
                mov     rcx, r14
                call    sub_140234180
                jmp     short loc_140230B54
; ---------------------------------------------------------------------------

loc_140230AD9:                          ; CODE XREF: sub_140230420+699↑j
                test    r13d, r13d
                jz      short loc_140230B29
                xor     r8d, r8d
                mov     rdx, r15
                mov     rcx, r14
                call    sub_1402258A0
                test    eax, eax
                jz      short loc_140230B29
                cmp     eax, 1
                jz      loc_140230BB6
                mov     r14, 0FFFFF68000000000h
                nop     dword ptr [rax+00h]
                nop     word ptr [rax+rax+00000000h]

loc_140230B10:                          ; CODE XREF: sub_140230420+707↓j
                shr     rsi, 9
                mov     rax, 7FFFFFFFF8h
                and     rsi, rax
                mov     rax, r14
                add     rsi, rax
                jmp     short loc_140230B10
; ---------------------------------------------------------------------------

loc_140230B29:                          ; CODE XREF: sub_140230420+6BC↑j
                                        ; sub_140230420+6CE↑j
                lea     r8, [rbp+40h+var_60]
                mov     rdx, r12
                mov     rcx, r14
                call    sub_1402A82C0
                cmp     rax, rsi
                jz      short loc_140230BB6
                mov     rdx, rax
                mov     rcx, r14
                call    sub_140312B40
                movzx   edx, [rbp+40h+arg_8]
                mov     rcx, r14
                call    sub_140226960

loc_140230B54:                          ; CODE XREF: sub_140230420+6B7↑j
                mov     rax, 100000000000002h
                mov     ecx, ebx
                shl     rcx, 39h
                xor     r9d, r9d
                or      rcx, rax
                xor     r8d, r8d
                mov     rdx, r12
                call    sub_140224260
                movsxd  rsi, eax
                test    eax, eax
                js      loc_14023130A
                cmp     [rsp+140h+var_100], 0
                mov     rcx, r14
                jz      short loc_140230BA8
                call    sub_1402325E0
                mov     rcx, rax
                mov     rsi, rax
                call    ExAcquireSpinLockExclusive
                xor     eax, eax
                mov     [rsi+4], eax
                mov     rsi, [rbp+40h+var_A0]
                jmp     loc_140230AB4
; ---------------------------------------------------------------------------

loc_140230BA8:                          ; CODE XREF: sub_140230420+768↑j
                call    sub_140231340
                mov     rsi, [rbp+40h+var_A0]
                jmp     loc_140230AB4
; ---------------------------------------------------------------------------

loc_140230BB6:                          ; CODE XREF: sub_140230420+6A5↑j
                                        ; sub_140230420+6D3↑j ...
                mov     r9, 0FFFFF6FB7DBED000h
                mov     rax, r9
                cmp     r12, rax
                jb      short loc_140230BDE
                mov     rax, 0FFFFF6FB7DBEDFFFh
                mov     rax, rax
                cmp     r12, rax
                jbe     loc_140230D31

loc_140230BDE:                          ; CODE XREF: sub_140230420+7A6↑j
                shr     r15, 12h
                and     r15d, 3FFFFFF8h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                mov     rdx, [r15+rax]
                lea     r8, [r15+rax]
                mov     rax, r9
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                jb      short loc_140230C77
                mov     rax, r10
                cmp     r8, rax
                ja      short loc_140230C77
                call    sub_140349680
                test    eax, eax
                jz      short loc_140230C77
                test    dl, 1
                jz      short loc_140230C77
                test    dl, 20h
                jz      short loc_140230C30
                test    dl, 42h
                jnz     short loc_140230C77

loc_140230C30:                          ; CODE XREF: sub_140230420+809↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140230C77
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140230C77
                or      rdx, 42h

loc_140230C77:                          ; CODE XREF: sub_140230420+7EE↑j
                                        ; sub_140230420+7F6↑j ...
                mov     [rbp+40h+var_A8], rdx
                mov     rax, r9
                lea     rcx, [rbp+40h+var_A8]
                cmp     rcx, rax
                jb      short loc_140230CF4
                mov     rax, r10
                lea     rcx, [rbp+40h+var_A8]
                cmp     rcx, rax
                ja      short loc_140230CF4
                call    sub_140349680
                test    eax, eax
                jz      short loc_140230CF4
                test    dl, 1
                jz      short loc_140230CF4
                test    dl, 20h
                jz      short loc_140230CAB
                test    dl, 42h
                jnz     short loc_140230CF4

loc_140230CAB:                          ; CODE XREF: sub_140230420+884↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140230CF4
                lea     rax, [rbp+40h+var_A8]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140230CF4
                or      rdx, 42h

loc_140230CF4:                          ; CODE XREF: sub_140230420+865↑j
                                        ; sub_140230420+871↑j ...
                mov     rax, 0FFFFFFFFFh
                shr     rdx, 0Ch
                and     rdx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     r15, [rdx+rdx*2]
                shl     r15, 4
                mov     rax, rax
                mov     r14, [rbp+40h+var_A0]
                add     r15, rax
                mov     r13d, [rsp+140h+var_EC]
                mov     esi, 1
                mov     [rbp+40h+var_70], r15
                jmp     short loc_140230D4F
; ---------------------------------------------------------------------------

loc_140230D31:                          ; CODE XREF: sub_140230420+7B8↑j
                mov     r15, [rbp+40h+var_70]
                mov     esi, 1
                mov     r14, [rbp+40h+var_A0]
                mov     r13d, [rsp+140h+var_EC]
                jmp     short loc_140230D4F
; ---------------------------------------------------------------------------

loc_140230D45:                          ; CODE XREF: sub_140230420+5D5↑j
                mov     r9, 0FFFFF6FB7DBED000h

loc_140230D4F:                          ; CODE XREF: sub_140230420+90F↑j
                                        ; sub_140230420+923↑j
                mov     rdx, [r12]
                mov     rax, r9
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     r12, rax
                jb      short loc_140230DCD
                mov     rax, r10
                cmp     r12, rax
                ja      short loc_140230DCD
                call    sub_140349680
                test    eax, eax
                jz      short loc_140230DCD
                test    dl, 1
                jz      short loc_140230DCD
                test    dl, 20h
                jz      short loc_140230D85
                test    dl, 42h
                jnz     short loc_140230DCD

loc_140230D85:                          ; CODE XREF: sub_140230420+95E↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140230DCD
                mov     rax, r12
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140230DCD
                or      rdx, 42h

loc_140230DCD:                          ; CODE XREF: sub_140230420+943↑j
                                        ; sub_140230420+94B↑j ...
                mov     [rsp+140h+var_E0], rdx
                test    rdx, rdx
                jnz     loc_140230E9A
                mov     rax, [rsp+140h+var_108]
                cmp     r12, [rbp+40h+var_98]
                ja      short loc_140230DEB
                add     [rsp+140h+var_C8], rax

loc_140230DEB:                          ; CODE XREF: sub_140230420+9C4↑j
                cmp     rax, 1
                jnz     loc_140231024
                mov     rax, r9
                cmp     r12, rax
                jb      short loc_140230E0F
                mov     rax, 0FFFFF6FB7DBEDFFFh
                mov     rax, rax
                cmp     r12, rax
                jbe     short loc_140230E19

loc_140230E0F:                          ; CODE XREF: sub_140230420+9DB↑j
                add     r13w, word ptr [rbp+40h+var_90]
                mov     [rsp+140h+var_EC], r13d

loc_140230E19:                          ; CODE XREF: sub_140230420+9ED↑j
                mov     rdx, rdi
                mov     rax, r9
                cmp     r12, rax
                jb      short loc_140230E91
                mov     rax, r10
                cmp     r12, rax
                ja      short loc_140230E91
                call    sub_140349680
                test    eax, eax
                jz      short loc_140230E62
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140230E51
                test    dil, 1
                jz      short loc_140230E51
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_140230E51:                          ; CODE XREF: sub_140230420+A1C↑j
                                        ; sub_140230420+A22↑j
                mov     rcx, r12
                mov     [r12], rdx
                call    sub_140349620
                jmp     loc_140231113
; ---------------------------------------------------------------------------

loc_140230E62:                          ; CODE XREF: sub_140230420+A13↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140230E91
                test    dil, 1
                jz      short loc_140230E91
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_140230E91:                          ; CODE XREF: sub_140230420+A02↑j
                                        ; sub_140230420+A0A↑j ...
                mov     [r12], rdx
                jmp     loc_140231113
; ---------------------------------------------------------------------------

loc_140230E9A:                          ; CODE XREF: sub_140230420+9B5↑j
                mov     rax, r9
                lea     rcx, [rsp+140h+var_E0]
                cmp     rcx, rax
                jb      short loc_140230F18
                mov     rax, r10
                lea     rcx, [rsp+140h+var_E0]
                cmp     rcx, rax
                ja      short loc_140230F18
                mov     r8, rdx
                call    sub_140349680
                test    eax, eax
                jz      short loc_140230F1B
                test    dl, 1
                jz      short loc_140230F1B
                test    dl, 20h
                jz      short loc_140230ECF
                test    dl, 42h
                jnz     short loc_140230F1B

loc_140230ECF:                          ; CODE XREF: sub_140230420+AA8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140230F18
                lea     rax, [rsp+140h+var_E0]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                test    al, 42h
                jz      short loc_140230F1B
                or      r8, 42h
                jmp     short loc_140230F1B
; ---------------------------------------------------------------------------

loc_140230F18:                          ; CODE XREF: sub_140230420+A85↑j
                                        ; sub_140230420+A92↑j ...
                mov     r8, rdx

loc_140230F1B:                          ; CODE XREF: sub_140230420+A9E↑j
                                        ; sub_140230420+AA3↑j ...
                mov     rax, r8
                and     eax, 3E0h
                cmp     rax, 200h
                jnz     loc_1402310B4
                test    r8b, 1
                jnz     loc_1402310B4
                bt      r8, 0Ah
                jnb     short loc_140230F50
                mov     rcx, r8
                call    sub_14031C870
                test    eax, eax
                jz      loc_1402310B4

loc_140230F50:                          ; CODE XREF: sub_140230420+B1E↑j
                cmp     [rsp+140h+var_108], 1
                jnz     loc_140231024
                mov     rax, [rbp+40h+arg_0]
                and     rdx, 0FFFFFFFFFFFFFC1Fh
                or      rdx, [rbp+40h+var_58]
                mov     [rsp+140h+var_E0], rdx
                mov     r8, rdx
                mov     eax, [rax+30h]
                bt      eax, 14h
                jnb     short loc_140230F92
                bt      eax, 18h
                jb      short loc_140230F92
                bt      eax, 1Ah
                jnb     short loc_140230F92
                bts     r8, 1Ah
                mov     [rsp+140h+var_E0], r8

loc_140230F92:                          ; CODE XREF: sub_140230420+B5A↑j
                                        ; sub_140230420+B60↑j ...
                mov     rax, r9
                cmp     r12, rax
                jb      short loc_140230FF7
                mov     rax, r10
                cmp     r12, rax
                ja      short loc_140230FF7
                call    sub_140349680
                test    eax, eax
                jz      short loc_140230FDB
                cmp     byte ptr cs:word_140C4DE88+1, 0
                mov     rdx, r8
                jnz     short loc_140230FCA
                test    r8b, 1
                jz      short loc_140230FCA
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_140230FCA:                          ; CODE XREF: sub_140230420+B95↑j
                                        ; sub_140230420+B9B↑j
                mov     rcx, r12
                mov     [r12], rdx
                call    sub_140349620
                jmp     loc_140231113
; ---------------------------------------------------------------------------

loc_140230FDB:                          ; CODE XREF: sub_140230420+B89↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jnz     short loc_140231000

loc_140230FF7:                          ; CODE XREF: sub_140230420+B78↑j
                                        ; sub_140230420+B80↑j
                mov     [r12], r8
                jmp     loc_140231113
; ---------------------------------------------------------------------------

loc_140231000:                          ; CODE XREF: sub_140230420+BD5↑j
                mov     rax, r8
                mov     rdx, 8000000000000000h
                or      rax, rdx
                movzx   ecx, r8b
                and     cl, 1
                cmovz   rax, r8
                mov     [r12], rax
                jmp     loc_140231113
; ---------------------------------------------------------------------------

loc_140231024:                          ; CODE XREF: sub_140230420+9CF↑j
                                        ; sub_140230420+B36↑j
                mov     edx, [rsp+140h+var_F0]
                lea     rbx, [rbp+40h+var_50]
                mov     rcx, [rbx+rdx*8]
                lea     rbx, [rbx+rdx*8]
                test    rcx, rcx
                jnz     short loc_140231045
                lea     rcx, [rbp+40h+var_50]
                call    sub_14055E418
                mov     rcx, [rbx]

loc_140231045:                          ; CODE XREF: sub_140230420+C17↑j
                mov     rax, [rcx]
                mov     [rbx], rax
                mov     r8, 0FFFFFA8000000000h
                mov     rax, r8
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rbx, rdx
                sar     rbx, 3
                mov     rax, rbx
                shr     rax, 3Fh
                add     rbx, rax
                lea     rcx, [rbx+rbx*2]
                shl     rcx, 4
                mov     rax, r8
                mov     r8, [rsp+140h+var_F8]
                add     rcx, rax
                mov     rdx, [rbp+40h+var_B8]
                call    sub_1403F763C
                mov     eax, [rsp+140h+var_110]
                mov     r8, rbx
                mov     r9d, [rsp+140h+var_F0]
                mov     rdx, [rbp+40h+var_B8]
                mov     rcx, [rbp+40h+arg_0]
                mov     dword ptr [rsp+140h+var_120], eax
                call    sub_14055E778
                jmp     short loc_140231113
; ---------------------------------------------------------------------------

loc_1402310B4:                          ; CODE XREF: sub_140230420+B09↑j
                                        ; sub_140230420+B13↑j ...
                mov     rcx, [rbp+40h+arg_40]
                mov     rax, [rsp+140h+var_108]
                add     [rsp+140h+var_C8], rax
                cmp     dword ptr [rcx], 0
                jnz     short loc_140231118
                mov     rcx, [rbp+40h+arg_0]
                lea     r9, [rsp+140h+var_D8]
                xor     eax, eax
                lea     r8, [rbp+40h+var_68]
                mov     [rbp+40h+arg_10], ax
                mov     rdx, r12
                lea     rax, [rbp+40h+arg_10]
                mov     [rsp+140h+var_120], rax
                call    sub_1402834D0
                mov     rbx, [rbp+40h+var_68]
                test    rbx, rbx
                jnz     short loc_140231131
                cmp     [rsp+140h+var_110], eax
                jnz     short loc_140231106
                mov     eax, [rbp+40h+arg_20]
                cmp     [rsp+140h+var_D8], eax
                jz      short loc_140231113

loc_140231106:                          ; CODE XREF: sub_140230420+CDB↑j
                mov     rax, [rbp+40h+arg_40]
                mov     dword ptr [rax], 1

loc_140231113:                          ; CODE XREF: sub_140230420+A3D↑j
                                        ; sub_140230420+A75↑j ...
                mov     rax, [rsp+140h+var_108]

loc_140231118:                          ; CODE XREF: sub_140230420+CA8↑j
                mov     rcx, [rbp+40h+var_90]
                lea     r12, [r12+rcx*8]
                mov     rcx, [rbp+40h+var_B8]
                lea     rcx, [rcx+rax*8]
                mov     [rbp+40h+var_B8], rcx
                jmp     loc_1402309DB
; ---------------------------------------------------------------------------

loc_140231131:                          ; CODE XREF: sub_140230420+CD5↑j
                test    r13w, r13w
                jz      short loc_14023114E
                movzx   edx, r13w
                mov     rcx, r15
                call    sub_14029DD54
                xor     eax, eax
                movzx   r13d, ax
                mov     [rsp+140h+var_EC], r13d

loc_14023114E:                          ; CODE XREF: sub_140230420+D15↑j
                cmp     [rsp+140h+var_100], 1
                mov     rcx, [rsp+140h+var_E8]
                jnz     short loc_14023116D
                movzx   edx, [rbp+40h+arg_8]
                call    sub_140234180
                movzx   eax, byte ptr [rbx]
                xor     eax, eax
                jmp     loc_1402308E0
; ---------------------------------------------------------------------------

loc_14023116D:                          ; CODE XREF: sub_140230420+D38↑j
                mov     rdx, r14
                call    sub_140312B40
                movzx   edx, [rbp+40h+arg_8]
                mov     rcx, [rsp+140h+var_E8]
                call    sub_140226960
                movzx   eax, byte ptr [rbx]
                xor     eax, eax
                jmp     loc_1402308E0
; ---------------------------------------------------------------------------

loc_14023118D:                          ; CODE XREF: sub_140230420+5C4↑j
                test    r13w, r13w
                jz      short loc_140231207
                xor     eax, eax
                mov     [rbp+40h+var_B0], eax
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jnb     short loc_1402311BC

loc_1402311A1:                          ; CODE XREF: sub_140230420+D91↓j
                                        ; sub_140230420+D9A↓j
                lea     rcx, [rbp+40h+var_B0]
                call    sub_1402C8C70
                mov     rax, [r15+18h]
                test    rax, rax
                js      short loc_1402311A1
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jb      short loc_1402311A1

loc_1402311BC:                          ; CODE XREF: sub_140230420+D7F↑j
                mov     rax, [r15+10h]
                movzx   ecx, r13w
                shl     rcx, 10h
                add     rcx, rax
                xor     rcx, rax
                and     ecx, 3FF0000h
                xor     rcx, rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                mov     [r15+10h], rcx
                lock and [r15+18h], rax
                cmp     r13w, 1
                ja      short loc_140231207
                mov     rcx, [r15+8]
                mov     rax, 8000000000000000h
                or      rcx, rax
                call    sub_14029B5F0

loc_140231207:                          ; CODE XREF: sub_140230420+D71↑j
                                        ; sub_140230420+DCF↑j
                cmp     [rsp+140h+var_100], 1
                jnz     short loc_14023121C
                movzx   edx, [rbp+40h+arg_8]
                mov     rcx, rbx
                call    sub_140234180
                jmp     short loc_140231238
; ---------------------------------------------------------------------------

loc_14023121C:                          ; CODE XREF: sub_140230420+DEC↑j
                test    r14, r14
                jz      short loc_14023122C
                mov     rdx, r14
                mov     rcx, rbx
                call    sub_140312B40

loc_14023122C:                          ; CODE XREF: sub_140230420+DFF↑j
                movzx   edx, [rbp+40h+arg_8]
                mov     rcx, rbx
                call    sub_140226960

loc_140231238:                          ; CODE XREF: sub_140230420+DFA↑j
                cmp     [rsp+140h+var_D4], 1
                mov     rdi, [rsp+140h+var_F8]
                jnz     short loc_140231290
                mov     rax, 0FFFFFFFFFFFFFFFFh
                lock xadd [rdi+4D0h], rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_140231266
                lea     rcx, [rdi+4D0h]
                call    ExfTryToWakePushLock

loc_140231266:                          ; CODE XREF: sub_140230420+E38↑j
                lea     rcx, [rdi+4D0h]
                call    sub_140243660
                mov     rax, [rbp+40h+var_88]
                add     word ptr [rax+1E6h], 1
                jnz     short loc_140231290
                add     rax, 98h
                cmp     [rax], rax
                jz      short loc_140231290
                call    KiCheckForKernelApcDelivery

loc_140231290:                          ; CODE XREF: sub_140230420+E22↑j
                                        ; sub_140230420+E5E↑j ...
                cmp     [rsp+140h+var_D0], 1
                jnz     short loc_1402312B5
                mov     rbx, [rsp+140h+var_C8]
                test    rbx, rbx
                jz      short loc_1402312AC
                mov     rdx, rbx
                mov     rcx, rdi
                call    sub_14065C6A8

loc_1402312AC:                          ; CODE XREF: sub_140230420+E7F↑j
                mov     r9, [rbp+40h+var_80]
                sub     r9, rbx
                jmp     short loc_1402312B9
; ---------------------------------------------------------------------------

loc_1402312B5:                          ; CODE XREF: sub_140230420+E75↑j
                mov     r9, [rbp+40h+var_C0]

loc_1402312B9:                          ; CODE XREF: sub_140230420+E93↑j
                mov     r8, [rbp+40h+arg_0]
                mov     ecx, [r8+34h]
                mov     edx, ecx
                movzx   eax, byte ptr [r8+22h]
                btr     edx, 1Fh
                shl     rax, 1Fh
                or      rdx, rax
                mov     eax, ecx
                add     rdx, r9
                xor     eax, edx
                shr     rdx, 1Fh
                btr     eax, 1Fh
                mov     [r8+22h], dl
                xor     eax, ecx
                mov     [r8+34h], eax
                xor     eax, eax

loc_1402312EE:                          ; CODE XREF: sub_140230420+238↑j
                                        ; sub_140230420+30B↑j ...
                mov     rbx, [rsp+140h+arg_18]
                add     rsp, 110h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14023130A:                          ; CODE XREF: sub_140230420+75A↑j
                mov     ecx, 1
                call    sub_140535798
                mov     r9, [rsp+140h+var_E0]
                mov     edx, 1
                mov     r8, rsi
                mov     [rsp+140h+var_120], r12
                lea     ecx, [rdx+79h]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_140230420   endp

algn_14023132F:                         ; DATA XREF: .pdata:00000001400CB28C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140231340   proc near               ; CODE XREF: sub_140209860+12F↑p
                                        ; sub_140213C50+77↑p ...

var_8           = qword ptr -8
arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 000000014042B0AC SIZE 000000EC BYTES

                sub     rsp, 28h
                movzx   eax, byte ptr [rcx+0B8h]
                and     al, 7
                cmp     al, 6
                jnb     loc_1402313EA

loc_140231355:                          ; DATA XREF: .rdata:0000000140053648↑o
                                        ; .rdata:000000014005365C↑o ...
                mov     [rsp+28h+arg_0], rbx
                mov     [rsp+28h+var_8], rdi
                cmp     al, 2
                jz      short loc_1402313E1
                lea     rbx, [rcx+0C0h]

loc_14023136A:                          ; CODE XREF: sub_140231340+A8↓j
                mov     rdi, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042B0F3

loc_140231385:                          ; CODE XREF: sub_140231340+1F9DB5↓j
                                        ; sub_140231340+1F9DBF↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14042B138

loc_140231392:                          ; DATA XREF: .rdata:000000014005365C↑o
                                        ; .rdata:0000000140053670↑o ...
                mov     [rsp+28h+arg_8], rsi
                mov     rsi, gs:20h
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14042B14A

loc_1402313B0:                          ; CODE XREF: sub_140231340+1F9E0E↓j
                                        ; sub_140231340+1F9E1D↓j ...
                prefetchw byte ptr [rbx]
                mov     eax, [rbx]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rbx], ecx
                jnz     short loc_14023140F

loc_1402313C2:                          ; CODE XREF: sub_140231340+EB↓j
                mov     rsi, [rsp+28h+arg_8]

loc_1402313C7:                          ; CODE XREF: sub_140231340+1F9E05↓j
                                        ; DATA XREF: .pdata:00000001400CB2B0↑o ...
                cmp     dword ptr [rbx+4], 0
                jnz     short loc_14023142D

loc_1402313CD:                          ; CODE XREF: sub_140231340+F2↓j
                mov     rbx, [rsp+28h+arg_0]
                movzx   eax, dil
                mov     rdi, [rsp+28h+var_8]
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
byte_1402313E0  db 0CCh                 ; DATA XREF: .pdata:00000001400CB2BC↑o
                                        ; .pdata:00000001400CB2C8↑o
; ---------------------------------------------------------------------------

loc_1402313E1:                          ; CODE XREF: sub_140231340+21↑j
                                        ; DATA XREF: .pdata:00000001400CB2C8↑o ...
                lea     rbx, unk_140C4F600
                jmp     short loc_14023136A
; ---------------------------------------------------------------------------

loc_1402313EA:                          ; CODE XREF: sub_140231340+F↑j
                                        ; DATA XREF: .pdata:00000001400CB2D4↑o ...
                mov     r10, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042B0AC

loc_140231405:                          ; CODE XREF: sub_140231340+1F9D6E↓j
                                        ; sub_140231340+1F9D78↓j ...
                movzx   eax, r10b
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14023140F:                          ; CODE XREF: sub_140231340+80↑j
                                        ; DATA XREF: .pdata:00000001400CB2E0↑o ...
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14042B171

loc_14023141F:                          ; CODE XREF: sub_140231340+1F9E35↓j
                                        ; sub_140231340+1F9E44↓j ...
                movzx   edx, dil
                mov     rcx, rbx
                call    sub_140329420
                jmp     short loc_1402313C2
; ---------------------------------------------------------------------------

loc_14023142D:                          ; CODE XREF: sub_140231340+8B↑j
                                        ; DATA XREF: .pdata:00000001400CB2EC↑o ...
                xor     ecx, ecx
                xchg    ecx, [rbx+4]
                jmp     short loc_1402313CD
sub_140231340   endp

; ---------------------------------------------------------------------------
algn_140231434:                         ; DATA XREF: .pdata:00000001400CB2F8↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140231440   proc near               ; CODE XREF: sub_1402D4688+B8↓p
                                        ; sub_1402D4688+150↓p ...

var_2A8         = qword ptr -2A8h
var_2A0         = qword ptr -2A0h
var_298         = qword ptr -298h
var_290         = qword ptr -290h
var_288         = byte ptr -288h
var_284         = dword ptr -284h
var_280         = qword ptr -280h
var_278         = qword ptr -278h
var_270         = qword ptr -270h
var_268         = dword ptr -268h
var_260         = qword ptr -260h
var_258         = dword ptr -258h
var_250         = qword ptr -250h
var_248         = qword ptr -248h
var_240         = qword ptr -240h
var_238         = dword ptr -238h
var_234         = dword ptr -234h
var_230         = qword ptr -230h
var_228         = dword ptr -228h
var_220         = qword ptr -220h
var_218         = qword ptr -218h
var_210         = qword ptr -210h
var_208         = qword ptr -208h
var_200         = qword ptr -200h
var_1F8         = qword ptr -1F8h
var_1F0         = qword ptr -1F0h
var_1E8         = dword ptr -1E8h
var_1E0         = qword ptr -1E0h
var_1D8         = qword ptr -1D8h
var_1D0         = qword ptr -1D0h
var_1C8         = qword ptr -1C8h
var_1C0         = qword ptr -1C0h
var_1B8         = qword ptr -1B8h
var_1B0         = qword ptr -1B0h
var_1A8         = qword ptr -1A8h
var_198         = byte ptr -198h
var_D8          = byte ptr -0D8h
var_48          = qword ptr -48h
arg_20          = qword ptr  28h
arg_28          = dword ptr  30h
arg_30          = qword ptr  38h

; FUNCTION CHUNK AT 000000014042B198 SIZE 00000928 BYTES

; __unwind { // __GSHandlerCheck
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 290h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+2C8h+var_48], rax
                mov     rsi, [rsp+2C8h+arg_20]
                mov     r12, r8
                mov     r14, [rsp+2C8h+arg_30]
                mov     r15, rdx
                mov     [rsp+2C8h+var_1A8], r8
                xor     r13d, r13d
                mov     [rsp+2C8h+var_1B8], rcx
                xor     edx, edx
                mov     r8d, 0B8h
                mov     [rsp+2C8h+var_230], rsi
                lea     rcx, [rsp+2C8h+var_198]
                mov     [rsp+2C8h+var_260], r14
                mov     [rsp+2C8h+var_238], r13d
                mov     [rsp+2C8h+var_288], r13b
                mov     [rsp+2C8h+var_1F0], r9
                call    memset
                mov     ebx, [rsp+2C8h+arg_28]
                mov     edi, r13d
                test    bl, 2
                jnz     short loc_1402314D8
                lea     edi, [r13+2]

loc_1402314D8:                          ; CODE XREF: sub_140231440+92↑j
                test    rsi, rsi
                jnz     loc_14042B198

loc_1402314E1:                          ; CODE XREF: sub_140231440+1F9D62↓j
                mov     rsi, [r12]
                mov     [rsp+2C8h+var_208], r13
                mov     [rsp+2C8h+var_220], r13
                lea     r13, [rsp+2C8h+var_198]
                mov     [rsp+2C8h+var_250], r13
                test    dword ptr [rsi+38h], 40000000h
                mov     [rsp+2C8h+var_1F8], rsi
                jnz     loc_14042B1A7

loc_140231517:                          ; CODE XREF: sub_140231440+1F9D71↓j
                test    bl, 4
                jnz     loc_14042B1B6

loc_140231520:                          ; CODE XREF: sub_140231440+1F9DB9↓j
                                        ; sub_140231440+1FA033↓j
                add     r15, 8
                mov     rcx, rsi
                mov     [rsp+2C8h+var_1C0], r15
                call    sub_14026F920
                mov     r8, gs:188h
                mov     rcx, r8
                mov     [rsp+2C8h+var_200], rax
                mov     [rsp+2C8h+var_1C8], r8
                call    sub_1402C4F40
                mov     [rsp+2C8h+var_234], eax
                cmp     eax, 2
                jl      loc_140231E3C

loc_140231565:                          ; CODE XREF: sub_140231440+A04↓j
                                        ; sub_140231440+A12↓j ...
                test    ebx, ebx
                js      loc_14042B478

loc_14023156D:                          ; CODE XREF: sub_140231440+1FA03B↓j
                xor     eax, eax
                mov     [rsp+2C8h+var_218], r12
                mov     [r14], eax
                mov     r15, r12
                mov     r12, [rsp+2C8h+var_1B8]
                mov     [r14+8], rax
                mov     [r13+0], rax
                mov     [r13+0Ah], ax
                mov     [r13+20h], rax
                mov     [r13+28h], rax
                dec     word ptr [r8+1E4h]
                mov     [rsp+2C8h+var_284], 10h
                mov     [rsp+2C8h+var_258], eax
                mov     [rsp+2C8h+var_268], 1
                mov     [rsp+2C8h+var_270], rax
                mov     [rsp+2C8h+var_278], r12
                lea     rax, [rsi+48h]
                mov     rcx, rax
                mov     [rsp+2C8h+var_210], rax
                call    ExAcquireSpinLockExclusive
                cmp     qword ptr [rsi+20h], 0
                movzx   ebx, al
                jz      loc_14042B480
                mov     rax, [rsi+78h]
                lea     rcx, ds:0[rax*8]
                mov     [rsp+2C8h+var_1E0], rcx
                test    rcx, rcx
                jnz     loc_140231F1C

loc_1402315FF:                          ; CODE XREF: sub_140231440+AEE↓j
                                        ; sub_140231440+1FA0FF↓j
                xor     ecx, ecx
                mov     [rsp+2C8h+var_248], rcx
                mov     edx, ecx
                mov     rcx, [rsp+2C8h+var_1F0]

loc_140231613:                          ; CODE XREF: sub_140231440+BB1↓j
                mov     esi, 1000h

loc_140231618:                          ; CODE XREF: sub_140231440+C04↓j
                cmp     r15, rcx
                jnz     loc_140231FA7
                mov     r14, [rsp+2C8h+var_1C0]

loc_140231629:                          ; CODE XREF: sub_140231440+B89↓j
                mov     [rsp+2C8h+var_240], r14
                test    r12, r12
                jz      loc_140231FF6

loc_14023163A:                          ; CODE XREF: sub_140231440+BBF↓j
                cmp     dword ptr [r15+68h], 0
                jz      loc_140232004
                cmp     qword ptr [r15+8], 0
                jz      loc_140232004
                xor     edx, edx
                mov     rcx, r15
                call    sub_140268340
                test    byte ptr [r15+22h], 8
                jnz     loc_14042B544

loc_140231665:                          ; CODE XREF: sub_140231440+1FA10D↓j
                mov     rcx, [rsp+2C8h+var_210]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042B552

loc_140231680:                          ; CODE XREF: sub_140231440+1FA114↓j
                                        ; sub_140231440+1FA120↓j ...
                movzx   eax, bl
                mov     cr8, rax
                xor     r8d, r8d
                mov     [rsp+2C8h+var_1D0], r12
                mov     eax, r8d
                mov     bl, 11h
                mov     [rsp+2C8h+var_280], rax
                mov     [rsp+2C8h+var_288], bl
                cmp     r12, r14
                jnb     loc_140231A87
                nop     dword ptr [rax+00000000h]

loc_1402316B0:                          ; CODE XREF: sub_140231440+586↓j
                mov     r14d, edi
                test    r12, 0FFFh
                jz      loc_1402319F7
                cmp     bl, 11h
                jz      loc_140231A00

loc_1402316C9:                          ; CODE XREF: sub_140231440+2BA↓j
                                        ; sub_140231440+318↓j ...
                mov     rbx, [r12]
                mov     rax, rbx
                test    bl, 1
                jnz     short loc_140231719
                and     eax, 0C00h
                cmp     rax, 800h
                jnz     loc_140231975
                test    rbx, rbx
                jz      short loc_1402316FC
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_1402316FC
                test    rax, rbx
                jz      short loc_1402316C9

loc_1402316FC:                          ; CODE XREF: sub_140231440+2A9↑j
                                        ; sub_140231440+2B5↑j
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_140231719
                test    bl, 10h
                jnz     short loc_140231719
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_140231719:                          ; CODE XREF: sub_140231440+293↑j
                                        ; sub_140231440+2C9↑j ...
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rdx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000028h
                shl     rdx, 4
                mov     [rsp+2C8h+var_1B0], rdx
                mov     rax, rax
                mov     rcx, [rdx+rax]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      loc_1402316C9
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                lea     rsi, [rdx+rax]
                mov     [rsp+2C8h+var_1E8], r8d
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      loc_140231F80

loc_140231784:                          ; CODE XREF: sub_140231440+B62↓j
                mov     rax, [r12]
                cmp     rax, rbx
                jnz     loc_14042B5BA
                test    rsi, rsi
                jz      loc_140231975
                mov     rbx, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r12, rax
                jnb     loc_1402319DC

loc_1402317B3:                          ; CODE XREF: sub_140231440+5AC↓j
                                        ; sub_140231440+1FA198↓j ...
                movzx   eax, byte ptr [rsi+22h]
                lea     r15, [r13+28h]
                test    al, 8
                jnz     loc_140231F56
                test    al, 10h
                jz      loc_1402319CB
                mov     r14d, [r15]
                test    al, 20h
                jnz     loc_14042B667
                mov     r12d, r8d
                test    r14d, r14d
                jz      loc_140231CE4

loc_1402317E2:                          ; CODE XREF: sub_140231440+8EA↓j
                mov     rax, cs:qword_140C4E4C8
                and     ebx, 1
                mov     rcx, [rsi+28h]
                mov     r13d, r8d
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     r10, [rax+rcx*8]
                mov     eax, [rsi+10h]
                mov     [rsp+2C8h+var_1D8], r10
                bt      rax, 0Ah
                jnb     short loc_140231819
                mov     r13d, 1

loc_140231819:                          ; CODE XREF: sub_140231440+3D1↑j
                mov     eax, 8
                mov     r14d, r12d
                and     r14d, 2
                mov     r9d, 4
                test    rbx, rbx
                mov     ecx, 0FFFFFFFFh
                cmovz   r14d, r12d
                test    r14d, r14d
                cmovz   r9d, eax
                mov     eax, r14d
                neg     eax
                mov     [rsp+2C8h+var_228], r9d
                lea     rax, unk_140C50C00
                sbb     r8, r8
                and     r8, rcx
                cmp     r10, rax
                jnz     loc_140231EC8
                mov     rdx, gs:20h
                mov     eax, [rdx+831Ch]
                cmp     eax, 1
                jb      loc_140231EC8

loc_140231879:                          ; CODE XREF: sub_140231440+1FA2B5↓j
                cmp     eax, ecx
                jz      loc_140231EC8
                lea     ecx, [rax-1]
                lock cmpxchg [rdx+831Ch], ecx
                jnz     loc_14042B6ED
                mov     r12d, 1

loc_140231898:                          ; CODE XREF: sub_140231440+AB0↓j
                mov     ecx, r13d
                and     ecx, 1
                test    r14d, r14d
                cmovz   ecx, r13d
                test    ecx, ecx
                jz      short loc_1402318C1
                mov     r8d, r9d
                mov     edx, 1
                mov     rcx, r10
                call    sub_140232160
                test    eax, eax
                jz      loc_14042B700

loc_1402318C1:                          ; CODE XREF: sub_140231440+467↑j
                test    rbx, rbx
                jnz     short loc_1402318DE
                xor     edx, edx
                mov     rcx, rsi
                call    sub_14022EF40
                mov     rax, 0C000000000000000h
                and     [rsi+18h], rax

loc_1402318DE:                          ; CODE XREF: sub_140231440+484↑j
                movzx   eax, byte ptr [rsi+22h]
                inc     word ptr [rsi+20h]
                or      al, 8
                mov     [rsi+22h], al
                movzx   eax, byte ptr [rsi+22h]
                and     al, 0EFh
                mov     [rsi+22h], al
                mov     eax, [rsi+10h]
                bt      rax, 0Ah
                jnb     loc_14042B7A5

loc_140231902:                          ; CODE XREF: sub_140231440+1FA360↓j
                                        ; sub_140231440+1FA376↓j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], rax
                mov     r13, [rsp+2C8h+var_250]
                test    r12d, r12d
                jz      loc_14042B7CF
                mov     eax, [r15]
                lea     rcx, ds:0[rax*8]
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    [rsp+2C8h+var_1B0]
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                mov     [rcx+r13+30h], rdx
                mov     edx, [r15]
                mov     r8d, [r13+2Ch]
                inc     edx
                mov     [r15], edx
                cmp     r12d, 3
                jz      loc_14042B7D9

loc_140231965:                          ; CODE XREF: sub_140231440+1FA3B0↓j
                cmp     edx, r8d
                jz      loc_140231D7B
                mov     r12, [rsp+2C8h+var_278]
                jmp     short loc_140231985
; ---------------------------------------------------------------------------

loc_140231975:                          ; CODE XREF: sub_140231440+2A0↑j
                                        ; sub_140231440+354↑j
                lea     r15, [r13+28h]

loc_140231979:                          ; CODE XREF: sub_140231440+59A↓j
                mov     edx, [r15]
                or      edi, 4
                test    edx, edx
                cmovz   edi, r14d

loc_140231985:                          ; CODE XREF: sub_140231440+533↑j
                add     r12, 8
                mov     [rsp+2C8h+var_278], r12
                test    dil, 4
                jnz     loc_140231BD0
                cmp     r12, [rsp+2C8h+var_240]
                jz      loc_140231BC8

loc_1402319A6:                          ; CODE XREF: sub_140231440+78A↓j
                movzx   ebx, [rsp+2C8h+var_288]

loc_1402319AB:                          ; CODE XREF: sub_140231440+630↓j
                                        ; sub_140231440+89F↓j ...
                mov     rax, [rsp+2C8h+var_280]
                mov     esi, 1000h

loc_1402319B5:                          ; CODE XREF: sub_140231440+AD7↓j
                cmp     r12, [rsp+2C8h+var_240]
                jnb     loc_140231A76
                xor     r8d, r8d
                jmp     loc_1402316B0
; ---------------------------------------------------------------------------

loc_1402319CB:                          ; CODE XREF: sub_140231440+385↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], rax
                jmp     short loc_140231979
; ---------------------------------------------------------------------------

loc_1402319DC:                          ; CODE XREF: sub_140231440+36D↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r12, rax
                ja      loc_1402317B3
                jmp     loc_14042B5CE
; ---------------------------------------------------------------------------

loc_1402319F7:                          ; CODE XREF: sub_140231440+27A↑j
                cmp     bl, 11h
                jnz     loc_140231F46

loc_140231A00:                          ; CODE XREF: sub_140231440+283↑j
                                        ; sub_140231440+B11↓j
                lea     rdx, [rsp+2C8h+var_288]
                mov     rcx, r12
                call    sub_140298DB0
                mov     [rsp+2C8h+var_280], rax
                test    rax, rax
                jz      loc_140231EF5
                xor     r8d, r8d
                jmp     loc_1402316C9
; ---------------------------------------------------------------------------

loc_140231A23:                          ; CODE XREF: sub_140231440+87C↓j
                mov     [rsp+2C8h+var_278], rsi
                mov     r12, rsi
                cmp     ecx, 0C0000054h
                jnz     short loc_140231A3D
                test    dil, 10h
                jnz     loc_14042B8A8

loc_140231A3D:                          ; CODE XREF: sub_140231440+5F1↑j
                mov     esi, [r15]
                mov     edx, esi
                call    sub_14033ADF4
                test    eax, eax
                jnz     loc_14042B8B1

loc_140231A4F:                          ; CODE XREF: sub_140231440+1FA489↓j
                                        ; sub_140231440+1FA495↓j
                xor     r14d, r14d
                mov     esi, r14d

loc_140231A55:                          ; CODE XREF: sub_140231440+1FA4C0↓j
                lea     rax, [rsp+2C8h+var_198]
                mov     [rsp+2C8h+var_268], esi
                cmp     r13, rax
                jnz     loc_140232079

loc_140231A6A:                          ; CODE XREF: sub_140231440+C5F↓j
                mov     [r13+28h], r14d
                test    esi, esi
                jnz     loc_1402319AB

loc_140231A76:                          ; CODE XREF: sub_140231440+57D↑j
                                        ; sub_140231440+1FA4EF↓j
                cmp     bl, 11h
                jnz     loc_140231E7F

loc_140231A7F:                          ; CODE XREF: sub_140231440+A51↓j
                mov     r15, [rsp+2C8h+var_218]

loc_140231A87:                          ; CODE XREF: sub_140231440+263↑j
                mov     r14, [rsp+2C8h+var_270]
                mov     rax, r12
                sub     rax, [rsp+2C8h+var_1D0]
                mov     rcx, [rsp+2C8h+var_210]
                sar     rax, 3
                shl     rax, 0Ch
                add     r14, rax
                mov     [rsp+2C8h+var_270], r14
                call    ExAcquireSpinLockExclusive
                cmp     qword ptr [r15+10h], 0
                movzx   ebx, al
                jz      loc_140231D2F

loc_140231AC2:                          ; CODE XREF: sub_140231440+90C↓j
                                        ; sub_140231440+91F↓j ...
                xor     edx, edx
                mov     rcx, r15
                call    sub_140267320
                mov     r12, [rsp+2C8h+var_248]
                add     r12, rax
                cmp     qword ptr [r15+60h], 0
                mov     [rsp+2C8h+var_248], r12
                jz      loc_14042B934

loc_140231AEA:                          ; CODE XREF: sub_140231440+1FA4F9↓j
                                        ; sub_140231440+1FA512↓j
                test    dil, 8
                jnz     short loc_140231B08
                cmp     [rsp+2C8h+var_268], 0
                jz      short loc_140231B08
                mov     rcx, [rsp+2C8h+var_1F0]
                cmp     r15, rcx
                jnz     loc_140231FCE

loc_140231B08:                          ; CODE XREF: sub_140231440+6AE↑j
                                        ; sub_140231440+6B5↑j ...
                mov     rcx, [rsp+2C8h+var_210]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042B9B2

loc_140231B23:                          ; CODE XREF: sub_140231440+1FA574↓j
                                        ; sub_140231440+1FA580↓j ...
                movzx   eax, bl
                mov     cr8, rax
                mov     rbx, [rsp+2C8h+var_208]
                mov     r15, [rsp+2C8h+var_230]
                test    rbx, rbx
                jnz     loc_14042BA19

loc_140231B43:                          ; CODE XREF: sub_140231440+1FA5DC↓j
                                        ; sub_140231440+1FA5FC↓j
                mov     rsi, [rsp+2C8h+var_1F8]
                mov     rdx, [rsp+2C8h+var_200]
                mov     rcx, rsi
                call    sub_1402D4998
                test    r12, r12
                jnz     loc_14042BA41

loc_140231B64:                          ; CODE XREF: sub_140231440+1FA623↓j
                mov     rax, [rsp+2C8h+var_1E0]
                test    rax, rax
                jnz     loc_140231F39

loc_140231B75:                          ; CODE XREF: sub_140231440+B01↓j
                mov     rcx, [rsp+2C8h+var_1C8]
                call    sub_14021E1F0
                test    dil, 1
                jnz     loc_14042BA68
                mov     rcx, [rsp+2C8h+var_260]
                test    dil, 8
                jnz     loc_14042BAB4
                mov     rax, rcx
                mov     eax, [rcx]

loc_140231BA0:                          ; CODE XREF: sub_140231440+1FA67B↓j
                mov     [rcx+8], r14

loc_140231BA4:                          ; CODE XREF: sub_140231440+1F9DB1↓j
                                        ; sub_140231440+1FA0F3↓j ...
                mov     rcx, [rsp+2C8h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 290h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 8

loc_140231BC8:                          ; CODE XREF: sub_140231440+560↑j
                test    edx, edx
                jz      loc_1402319A6

loc_140231BD0:                          ; CODE XREF: sub_140231440+552↑j
                                        ; sub_140231440+B2F↓j
                mov     rax, [rsp+2C8h+var_280]

loc_140231BD5:                          ; CODE XREF: sub_140231440+ACC↓j
                movzx   ebx, [rsp+2C8h+var_288]
                cmp     bl, 11h
                jz      short loc_140231BF0
                movzx   edx, bl
                mov     rcx, rax
                call    sub_140297330
                mov     bl, 11h
                mov     [rsp+2C8h+var_288], bl

loc_140231BF0:                          ; CODE XREF: sub_140231440+79D↑j
                                        ; sub_140231440+95D↓j ...
                mov     eax, [r15]
                mov     rcx, r13
                mov     esi, [rsp+2C8h+arg_28]
                and     edi, 0FFFFFFFBh
                mov     rdx, [rsp+2C8h+var_218]
                mov     r8d, esi
                shl     eax, 0Ch
                mov     [r15], eax
                call    sub_14026F668
                mov     rdx, [rsp+2C8h+var_220]
                mov     r8, rax
                test    rdx, rdx
                jnz     loc_14042B830
                mov     rax, [r13+30h]
                lea     rcx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000008h
                add     rcx, rcx
                mov     rax, rax
                mov     rsi, [rax+rcx*8]
                mov     rax, 8000000000000000h
                mov     r14, [rsp+2C8h+var_1F8]
                or      rsi, rax
                mov     rcx, r14
                call    sub_1402851C0
                mov     rdx, r13
                test    eax, eax
                jnz     loc_14042B898
                mov     rcx, [rsp+2C8h+var_260]
                mov     r9d, [rsp+2C8h+arg_28]
                mov     [rsp+2C8h+var_2A0], rcx
                mov     rcx, [rsp+2C8h+var_1E0]
                shr     r9d, 2
                mov     [rsp+2C8h+var_2A8], rcx
                and     r9b, 4
                mov     rcx, [rsp+2C8h+var_200]
                call    sub_140342468

loc_140231CA2:                          ; CODE XREF: sub_140231440+1FA463↓j
                mov     r8, [rsp+2C8h+var_260]
                mov     rdx, r14
                mov     rcx, r13
                call    sub_14026CC48
                mov     r14, [rsp+2C8h+var_260]
                mov     ecx, [r14]
                test    ecx, ecx
                js      loc_140231A23
                xor     eax, eax
                mov     [rsp+2C8h+var_258], eax
                lea     rax, [rsp+2C8h+var_198]
                cmp     r13, rax
                jnz     loc_140231EA4

loc_140231CD9:                          ; CODE XREF: sub_140231440+A83↓j
                xor     eax, eax
                mov     [r13+28h], eax
                jmp     loc_1402319AB
; ---------------------------------------------------------------------------

loc_140231CE4:                          ; CODE XREF: sub_140231440+39C↑j
                mov     rcx, [rsp+2C8h+var_210]
                mov     r12d, 2
                call    ExAcquireSpinLockExclusiveAtDpcLevel
                mov     rax, [rsp+2C8h+var_1F8]
                mov     rcx, [rsp+2C8h+var_210]
                inc     dword ptr [rax+4Ch]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, [rsp+2C8h+var_284]
                xor     r8d, r8d
                mov     [r13+0], r8
                mov     [r13+0Ah], r8w
                mov     [r13+20h], r8
                mov     [r15], r8d
                mov     [r13+2Ch], eax
                jmp     loc_1402317E2
; ---------------------------------------------------------------------------

loc_140231D2F:                          ; CODE XREF: sub_140231440+67C↑j
                mov     ecx, [r15+34h]
                mov     eax, [r15+2Ch]
                and     ecx, 3FFFFFFFh
                sub     eax, ecx
                mov     ecx, eax
                mov     rax, [r15+8]
                lea     rcx, [rax+rcx*8]
                cmp     r12, rcx
                jnz     loc_140231AC2
                mov     rcx, r15
                call    sub_140261CB0
                and     eax, 0FFFh
                jz      loc_140231AC2
                mov     ecx, 1000h
                sub     ecx, eax
                mov     eax, ecx
                sub     r14, rax
                mov     [rsp+2C8h+var_270], r14
                jmp     loc_140231AC2
; ---------------------------------------------------------------------------

loc_140231D7B:                          ; CODE XREF: sub_140231440+528↑j
                mov     esi, 1

loc_140231D80:                          ; CODE XREF: sub_140231440+1FA394↓j
                                        ; sub_140231440+1FA3BB↓j
                movzx   edx, [rsp+2C8h+var_288]
                mov     rcx, [rsp+2C8h+var_280]
                call    sub_140297330
                mov     r12, [rsp+2C8h+var_278]
                mov     bl, 11h
                mov     [rsp+2C8h+var_288], bl
                cmp     esi, 3
                jz      loc_140231BF0
                cmp     esi, 2
                jz      loc_140231E96
                mov     ecx, [rsp+2C8h+var_284]
                cmp     ecx, 1
                jz      loc_140231E96
                mov     rax, [rsp+2C8h+var_240]
                lea     r14, [r12+8]
                cmp     r14, rax
                jnb     loc_140231E96
                lea     edx, [rcx-1]
                sub     rax, r12
                sar     rax, 3
                mov     rcx, r13
                add     edx, eax
                call    sub_14034DA90
                mov     rsi, rax
                test    rax, rax
                jz      loc_14042B800
                mov     r15, [rsp+2C8h+var_220]
                lea     rax, [rsp+2C8h+var_198]
                cmp     r13, rax
                jz      short loc_140231E17
                test    r15, r15
                jnz     loc_14042B815

loc_140231E0D:                          ; CODE XREF: sub_140231440+1FA3E2↓j
                xor     edx, edx
                mov     rcx, r13
                call    ExFreePoolWithTag

loc_140231E17:                          ; CODE XREF: sub_140231440+9C2↑j
                                        ; sub_140231440+1FA3DC↓j
                mov     [rsp+2C8h+var_250], rsi
                mov     r13, rsi
                test    r15, r15
                jnz     loc_14042B827

loc_140231E28:                          ; CODE XREF: sub_140231440+1FA3EB↓j
                mov     eax, [rsi+2Ch]
                mov     r12, r14
                mov     [rsp+2C8h+var_284], eax
                mov     [rsp+2C8h+var_278], r14
                jmp     loc_1402319AB
; ---------------------------------------------------------------------------

loc_140231E3C:                          ; CODE XREF: sub_140231440+11F↑j
                test    dword ptr [r8+74h], 400h
                jnz     loc_140231565
                cmp     byte ptr [r8+232h], 1
                jz      loc_140231565
                mov     rcx, gs:188h
                cmp     qword ptr [rcx+4C0h], 2
                jz      loc_140231565
                mov     [rsp+2C8h+var_234], 2
                jmp     loc_140231565
; ---------------------------------------------------------------------------

loc_140231E7F:                          ; CODE XREF: sub_140231440+639↑j
                mov     rcx, [rsp+2C8h+var_280]
                movzx   edx, bl
                call    sub_140297330
                mov     [rsp+2C8h+var_288], 11h
                jmp     loc_140231A7F
; ---------------------------------------------------------------------------

loc_140231E96:                          ; CODE XREF: sub_140231440+966↑j
                                        ; sub_140231440+973↑j ...
                add     r12, 8
                mov     [rsp+2C8h+var_278], r12
                jmp     loc_140231BF0
; ---------------------------------------------------------------------------

loc_140231EA4:                          ; CODE XREF: sub_140231440+893↑j
                xor     edx, edx
                mov     [rsp+2C8h+var_284], 10h
                mov     rcx, r13
                call    ExFreePoolWithTag
                lea     r13, [rsp+2C8h+var_198]

loc_140231EBE:                          ; CODE XREF: sub_140231440+1FA453↓j
                mov     [rsp+2C8h+var_250], r13
                jmp     loc_140231CD9
; ---------------------------------------------------------------------------

loc_140231EC8:                          ; CODE XREF: sub_140231440+41B↑j
                                        ; sub_140231440+433↑j ...
                mov     edx, 1
                mov     rcx, r10
                call    sub_1403438BC
                mov     r12d, eax
                test    eax, eax
                jz      loc_14042B79B
                mov     r9d, [rsp+2C8h+var_228]
                mov     r10, [rsp+2C8h+var_1D8]
                jmp     loc_140231898
; ---------------------------------------------------------------------------

loc_140231EF5:                          ; CODE XREF: sub_140231440+5D5↑j
                and     r12, 0FFFFFFFFFFFFF000h
                lea     r15, [r13+28h]
                add     r12, rsi
                cmp     dword ptr [r15], 0
                mov     [rsp+2C8h+var_278], r12
                jnz     loc_140231BD5
                movzx   ebx, [rsp+2C8h+var_288]
                jmp     loc_1402319B5
; ---------------------------------------------------------------------------

loc_140231F1C:                          ; CODE XREF: sub_140231440+1B9↑j
                mov     eax, 1
                lock xadd [rcx+20h], rax
                inc     rax
                cmp     rax, 1
                jg      loc_1402315FF
                jmp     loc_14042B538
; ---------------------------------------------------------------------------

loc_140231F39:                          ; CODE XREF: sub_140231440+72F↑j
                mov     rcx, rax
                call    sub_140319B24
                jmp     loc_140231B75
; ---------------------------------------------------------------------------

loc_140231F46:                          ; CODE XREF: sub_140231440+5BA↑j
                movzx   edx, bl
                mov     rcx, rax
                call    sub_140297330
                jmp     loc_140231A00
; ---------------------------------------------------------------------------

loc_140231F56:                          ; CODE XREF: sub_140231440+37D↑j
                cmp     dword ptr [r15], 0
                jz      loc_140232049

loc_140231F60:                          ; CODE XREF: sub_140231440+1FA23F↓j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], rax
                jmp     loc_140231BD0
; ---------------------------------------------------------------------------
                align 20h

loc_140231F80:                          ; CODE XREF: sub_140231440+33E↑j
                                        ; sub_140231440+B54↓j ...
                lea     rcx, [rsp+2C8h+var_1E8]
                call    sub_1402C8C70
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_140231F80
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_140231F80
                xor     r8d, r8d
                jmp     loc_140231784
; ---------------------------------------------------------------------------

loc_140231FA7:                          ; CODE XREF: sub_140231440+1DB↑j
                mov     ecx, [r15+34h]
                mov     eax, [r15+2Ch]
                and     ecx, 3FFFFFFFh
                sub     eax, ecx
                mov     ecx, eax
                mov     rax, [r15+8]
                lea     r14, [rax+rcx*8]
                mov     rcx, [rsp+2C8h+var_1F0]
                jmp     loc_140231629
; ---------------------------------------------------------------------------

loc_140231FCE:                          ; CODE XREF: sub_140231440+6C2↑j
                mov     r15, [r15+10h]
                mov     [rsp+2C8h+var_218], r15
                test    r15, r15
                jz      loc_140231B08
                mov     r12, [r15+8]
                mov     rdx, [rsp+2C8h+var_270]
                mov     [rsp+2C8h+var_278], r12
                jmp     loc_140231613
; ---------------------------------------------------------------------------

loc_140231FF6:                          ; CODE XREF: sub_140231440+1F4↑j
                mov     r12, [r15+8]
                mov     [rsp+2C8h+var_278], r12
                jmp     loc_14023163A
; ---------------------------------------------------------------------------

loc_140232004:                          ; CODE XREF: sub_140231440+1FF↑j
                                        ; sub_140231440+20A↑j
                mov     rax, r14
                sub     rax, r12
                sar     rax, 3
                shl     rax, 0Ch
                add     rdx, rax
                mov     rax, [r15+10h]
                mov     [rsp+2C8h+var_270], rdx
                test    rax, rax
                jz      loc_14042B957
                cmp     rcx, r15
                jz      loc_14042B9A2
                mov     r12, [rax+8]
                mov     r15, rax
                mov     [rsp+2C8h+var_278], r12
                mov     [rsp+2C8h+var_218], rax
                jmp     loc_140231618
; ---------------------------------------------------------------------------

loc_140232049:                          ; CODE XREF: sub_140231440+B1A↑j
                test    r14b, 2
                jz      loc_14042B905
                movzx   r9d, [rsp+2C8h+var_288]
                mov     rcx, rsi
                mov     r8, [rsp+2C8h+var_280]
                mov     rdx, [rsp+2C8h+var_1F8]
                call    sub_1403244F0
                mov     bl, 11h
                mov     [rsp+2C8h+var_288], bl
                jmp     loc_1402319AB
; ---------------------------------------------------------------------------

loc_140232079:                          ; CODE XREF: sub_140231440+624↑j
                cmp     [rsp+2C8h+var_284], 1
                jz      short loc_140232088
                mov     [rsp+2C8h+var_284], 10h

loc_140232088:                          ; CODE XREF: sub_140231440+C3E↑j
                xor     edx, edx
                mov     rcx, r13
                call    ExFreePoolWithTag
                lea     r13, [rsp+2C8h+var_198]
                mov     [rsp+2C8h+var_250], r13
                jmp     loc_140231A6A
; } // starts at 140231440
sub_140231440   endp

; ---------------------------------------------------------------------------
algn_1402320A4:                         ; DATA XREF: .rdata:0000000140053758↑o
                                        ; .pdata:00000001400CB304↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402320B0   proc near               ; CODE XREF: sub_140230420+55↑p
                                        ; sub_1402851E0+132↓p ...
                cmp     ecx, 800h
                jnb     loc_14023214C
                mov     eax, ecx
                and     eax, 0Fh
                jz      short loc_1402320ED
                test    cl, 0F0h
                jnz     loc_14023214C
                lea     rdx, cs:140000000h
                movzx   edx, byte ptr [rax+rdx+17628h]

loc_1402320DB:                          ; CODE XREF: sub_1402320B0+56↓j
                movsx   eax, dl
                cmp     eax, 0FFFFFFFFh
                jz      short loc_14023214C
                test    ecx, 700h
                jnz     short loc_140232108

locret_1402320EB:                       ; CODE XREF: sub_1402320B0+7A↓j
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402320ED:                          ; CODE XREF: sub_1402320B0+11↑j
                mov     eax, ecx
                shr     eax, 4
                and     eax, 0Fh
                jz      short loc_14023214C
                lea     rdx, cs:140000000h
                movzx   edx, byte ptr [rax+rdx+17638h]
                jmp     short loc_1402320DB
; ---------------------------------------------------------------------------

loc_140232108:                          ; CODE XREF: sub_1402320B0+39↑j
                bt      ecx, 8
                jnb     short loc_14023211E
                cmp     eax, 18h
                jz      short loc_14023214C
                test    ecx, 600h
                jnz     short loc_14023214C
                or      eax, 10h

loc_14023211E:                          ; CODE XREF: sub_1402320B0+5C↑j
                bt      ecx, 9
                jb      short loc_14023213A
                and     ecx, 400h
                jz      short locret_1402320EB
                cmp     eax, 18h
                jz      short loc_14023214C
                test    al, 2
                jnz     short loc_14023214C
                or      eax, 18h
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14023213A:                          ; CODE XREF: sub_1402320B0+72↑j
                cmp     eax, 18h
                jz      short loc_14023214C
                and     ecx, 400h
                jnz     short loc_14023214C
                or      eax, 8
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14023214C:                          ; CODE XREF: sub_1402320B0+6↑j
                                        ; sub_1402320B0+16↑j ...
                mov     eax, 0FFFFFFFFh
                retn
sub_1402320B0   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_140232153:                         ; DATA XREF: .pdata:00000001400CB310↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140232160   proc near               ; CODE XREF: sub_140221EA0+261↑p
                                        ; sub_14022CA60+3FA↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h

; FUNCTION CHUNK AT 000000014042BAC0 SIZE 00000274 BYTES

                mov     [rsp+arg_8], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 20h
                mov     ebp, r8d
                mov     rdi, rdx
                mov     rsi, rcx

loc_14023217D:                          ; CODE XREF: sub_140232160+1F9AAC↓j
                lea     r13, unk_140C50C00
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]
                mov     rbx, gs:20h
                cmp     rsi, r13
                jnz     short loc_1402321E7
                prefetchw byte ptr [rbx+8318h]
                mov     eax, [rbx+8318h]
                mov     edx, eax
                cmp     rdi, rax
                ja      short loc_1402321E7

loc_1402321B2:                          ; CODE XREF: sub_140232160+1F9966↓j
                mov     ecx, edx
                mov     eax, edx
                sub     ecx, edi
                lock cmpxchg [rbx+8318h], ecx
                movsxd  rcx, eax
                cmp     rcx, rdx
                jnz     loc_14042BAC0

loc_1402321CC:                          ; CODE XREF: sub_140232160+18A↓j
                                        ; sub_140232160+1BF↓j ...
                mov     eax, 1

loc_1402321D1:                          ; CODE XREF: sub_140232160+1F9BCF↓j
                mov     rbx, [rsp+58h+arg_8]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402321E7:                          ; CODE XREF: sub_140232160+3C↑j
                                        ; sub_140232160+50↑j ...
                mov     r15d, ebp
                mov     [rsp+58h+arg_10], 0
                or      r15d, 2
                mov     eax, ebp
                and     al, 4
                cmovz   r15d, ebp
                test    r15b, 8
                jz      loc_1402323A1
                mov     rax, gs:188h
                or      r15d, 2
                mov     ecx, [rax+514h]
                test    cl, 2
                jz      loc_140232388
                mov     eax, gs:32ACh
                test    eax, 10001h
                jnz     loc_140232388
                or      r15d, 4
                xor     r10d, r10d

loc_14023223E:                          ; CODE XREF: sub_140232160+24E↓j
                                        ; sub_140232160+256↓j
                mov     [rsp+58h+arg_0], r10

loc_140232243:                          ; CODE XREF: sub_140232160+154↓j
                                        ; sub_140232160+236↓j ...
                mov     r12, [rsi+1D28h]
                lea     r14, [r12+rdi]
                cmp     r14, r12
                jbe     loc_14042BBD8
                lea     rax, [r10+r14]
                cmp     rax, r14
                jb      loc_14042BBD8
                mov     r13, [rsi+1DA8h]
                cmp     rax, r13
                ja      loc_14042BAF2
                cmp     [rsp+58h+arg_10], 0
                jnz     short loc_1402322A5
                mov     rax, 47AE147AE147AE15h
                mul     r13
                mov     rax, r13
                sub     rax, rdx
                shr     rax, 1
                add     rax, rdx
                shr     rax, 6
                imul    rax, 5Fh ; '_'
                cmp     r14, rax
                jnb     loc_14042BBB8

loc_1402322A5:                          ; CODE XREF: sub_140232160+119↑j
                                        ; sub_140232160+1F9A46↓j ...
                mov     rax, r12
                lock cmpxchg [rsi+1D28h], r14
                mov     r14, rax
                jnz     short loc_140232243
                mov     rax, [rsi+1860h]
                add     r14, rdi
                cmp     r14, rax
                jnb     loc_14042BC56

loc_1402322C9:                          ; CODE XREF: sub_140232160+1F9AFB↓j
                mov     rax, [rsi+1858h]
                cmp     r14, rax
                jnb     loc_14042BC60

loc_1402322D9:                          ; CODE XREF: sub_140232160+1F9B03↓j
                                        ; sub_140232160+1F9B18↓j
                cmp     r14, [rsi+1840h]
                ja      loc_1402323BB

loc_1402322E6:                          ; CODE XREF: sub_140232160+262↓j
                test    r15b, 2
                jnz     loc_1402321CC
                mov     rdi, [rsi+1DA8h]
                mov     rax, 0CCCCCCCCCCCCCCCDh
                mul     rdi
                shr     rdx, 3
                lea     rax, [rdx+rdx*8]
                cmp     r14, rax
                jnb     loc_14042BC7D

loc_140232315:                          ; CODE XREF: sub_140232160+1F9B2E↓j
                                        ; sub_140232160:loc_14042BC97↓j ...
                lea     rax, unk_140C50C00
                cmp     rsi, rax
                jnz     loc_1402321CC
                test    r15b, 1
                jnz     short loc_140232338
                cmp     r14, [rsi+1860h]
                jnb     loc_14042BCEF

loc_140232338:                          ; CODE XREF: sub_140232160+1C9↑j
                                        ; sub_140232160+1F9B96↓j ...
                mov     eax, [rbx+8318h]
                cmp     rax, 80h
                jnb     loc_1402321CC
                mov     r8, r14
                mov     r9d, 100h
                sub     r9, rax
                add     r14, r9
                cmp     r14, r8
                jbe     loc_1402321CC
                lea     rcx, [r10+r14]
                cmp     rcx, r8
                jbe     loc_1402321CC
                cmp     rcx, rdi
                ja      loc_1402321CC
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_14034CBCC
                jmp     loc_1402321CC
; ---------------------------------------------------------------------------

loc_140232388:                          ; CODE XREF: sub_140232160+BE↑j
                                        ; sub_140232160+D1↑j
                mov     r10d, 40h ; '@'
                mov     [rsp+58h+arg_0], r10
                cmp     rsi, r13
                jz      loc_140232243
                jmp     loc_14042BAD1
; ---------------------------------------------------------------------------

loc_1402323A1:                          ; CODE XREF: sub_140232160+A2↑j
                test    r15b, 7
                jnz     short loc_1402323B3
                mov     r10, [rsi+1870h]
                jmp     loc_14023223E
; ---------------------------------------------------------------------------

loc_1402323B3:                          ; CODE XREF: sub_140232160+245↑j
                xor     r10d, r10d
                jmp     loc_14023223E
; ---------------------------------------------------------------------------

loc_1402323BB:                          ; CODE XREF: sub_140232160+180↑j
                mov     [rsi+1840h], r14
                jmp     loc_1402322E6
sub_140232160   endp

; ---------------------------------------------------------------------------
algn_1402323C7:                         ; DATA XREF: .rdata:0000000140053888↑o
                                        ; .pdata:00000001400CB31C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402323D0   proc near               ; CODE XREF: sub_1405F604C+7A↓p
                                        ; sub_1405F61A8+94↓p ...
                movzx   edx, word ptr [rcx+72Eh]
                mov     rax, cs:qword_140C4E4C8
                mov     rax, [rax+rdx*8]
                retn
sub_1402323D0   endp

; ---------------------------------------------------------------------------
                align 4
algn_1402323E4:                         ; DATA XREF: .pdata:00000001400CB328↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402323F0   proc near               ; CODE XREF: sub_14063D610+53↓p
                                        ; sub_1408D63C8+36A↓p
                                        ; DATA XREF: ...

; FUNCTION CHUNK AT 000000014042BD34 SIZE 00000016 BYTES

                sub     rsp, 28h
                cmp     qword ptr [rcx+640h], 0
                jnz     short loc_140232437
                mov     r8, rdx
                lock xadd [rcx+648h], r8

loc_14023240A:                          ; CODE XREF: sub_1402323F0+6D↓j
                mov     rax, [rcx+650h]
                add     r8, rdx

loc_140232414:                          ; CODE XREF: sub_1402323F0+45↓j
                mov     rdx, rax
                cmp     r8, rax
                ja      short loc_140232427

loc_14023241C:                          ; CODE XREF: sub_1402323F0+43↓j
                mov     eax, 1

loc_140232421:                          ; CODE XREF: sub_1402323F0+1F9955↓j
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140232427:                          ; CODE XREF: sub_1402323F0+2A↑j
                lock cmpxchg [rcx+650h], r8
                cmp     rax, rdx
                jz      short loc_14023241C
                jmp     short loc_140232414
; ---------------------------------------------------------------------------

loc_140232437:                          ; CODE XREF: sub_1402323F0+C↑j
                mov     r8, [rcx+648h]

loc_14023243E:                          ; CODE XREF: sub_1402323F0+6F↓j
                mov     rax, r8
                add     r8, rdx
                cmp     r8, [rcx+640h]
                ja      loc_14042BD34
                lock cmpxchg [rcx+648h], r8
                mov     r8, rax
                jz      short loc_14023240A
                jmp     short loc_14023243E
sub_1402323F0   endp

; ---------------------------------------------------------------------------
algn_140232461:                         ; DATA XREF: .rdata:00000001400538A4↑o
                                        ; .pdata:00000001400CB334↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140232470   proc near               ; CODE XREF: PsChargeProcessNonPagedPoolQuota+1D↓p
                                        ; sub_140303E24+20↓p ...

var_58          = dword ptr -58h
var_38          = qword ptr -38h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                mov     [rsp+arg_18], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                movsxd  r15, r8d
                lea     r13, byte_140CFCB50
                mov     rbx, r15
                mov     rbp, r9
                shl     rbx, 7
                mov     rsi, rdx
                add     rbx, rcx
                movzx   r12d, byte ptr [r13+r15*8+0]
                prefetchw byte ptr [rbx]
                mov     rdi, [rbx]
                lock or [rsp+58h+var_58], 0

loc_1402324B7:                          ; CODE XREF: sub_140232470+71↓j
                mov     rax, [rbx+40h]

loc_1402324BB:                          ; CODE XREF: sub_140232470+155↓j
                mov     [rsp+58h+arg_0], rax

loc_1402324C0:                          ; CODE XREF: sub_140232470+144↓j
                lea     rdx, [rdi+rbp]
                cmp     rdx, rdi
                jb      loc_1402325CA
                cmp     rdx, rax
                ja      loc_140232578
                mov     rax, rdi
                lock cmpxchg [rbx], rdx
                mov     rdi, rax
                jnz     short loc_1402324B7
                prefetchw byte ptr [rbx+8]
                mov     rax, [rbx+8]
                cmp     rdx, rax
                ja      short loc_140232560

loc_1402324F0:                          ; CODE XREF: sub_140232470+FC↓j
                                        ; sub_140232470+103↓j
                test    rsi, rsi
                jnz     short loc_140232515

loc_1402324F5:                          ; CODE XREF: sub_140232470+A9↓j
                                        ; sub_140232470+D1↓j ...
                xor     eax, eax

loc_1402324F7:                          ; CODE XREF: sub_140232470+15F↓j
                mov     rbx, [rsp+58h+arg_8]
                mov     rbp, [rsp+58h+arg_10]
                mov     rsi, [rsp+58h+arg_18]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140232515:                          ; CODE XREF: sub_140232470+83↑j
                test    r12b, 4
                jz      short loc_1402324F5
                mov     rdx, rbp
                lock xadd [rsi+r15*8+470h], rdx
                add     rdx, rbp
                lea     r8, [rsi+r15*8]
                prefetchw byte ptr [r8+480h]
                mov     rax, [r8+480h]
                cmp     rdx, rax
                jbe     short loc_1402324F5

loc_140232543:                          ; CODE XREF: sub_140232470+E7↓j
                mov     rcx, rax
                lock cmpxchg [r8+480h], rdx
                cmp     rax, rcx
                jz      short loc_1402324F5
                cmp     rdx, rax
                ja      short loc_140232543
                jmp     short loc_1402324F5
; ---------------------------------------------------------------------------
                align 20h

loc_140232560:                          ; CODE XREF: sub_140232470+7E↑j
                                        ; sub_140232470+101↓j
                mov     rcx, rax
                lock cmpxchg [rbx+8], rdx
                cmp     rax, rcx
                jz      short loc_1402324F0
                cmp     rdx, rax
                ja      short loc_140232560
                jmp     loc_1402324F0
; ---------------------------------------------------------------------------

loc_140232578:                          ; CODE XREF: sub_140232470+60↑j
                test    r12b, 1
                jz      short loc_1402325CA
                cmp     qword ptr [rbx+50h], 0
                jz      short loc_1402325CA
                xor     ecx, ecx
                xchg    rcx, [rbx+48h]
                test    rcx, rcx
                jnz     short loc_1402325B9
                lea     rax, [rsp+58h+arg_0]
                mov     r9, rbp
                mov     r8, rdi
                mov     [rsp+58h+var_38], rax
                mov     rdx, rbx
                mov     ecx, r15d
                call    sub_140352228
                test    al, al
                jz      short loc_1402325CA
                mov     rax, [rsp+58h+arg_0]
                jmp     loc_1402324C0
; ---------------------------------------------------------------------------

loc_1402325B9:                          ; CODE XREF: sub_140232470+11E↑j
                mov     rax, rcx
                lock xadd [rbx+40h], rax
                add     rax, rcx
                jmp     loc_1402324BB
; ---------------------------------------------------------------------------

loc_1402325CA:                          ; CODE XREF: sub_140232470+57↑j
                                        ; sub_140232470+10C↑j ...
                mov     eax, [r13+r15*8+4]
                jmp     loc_1402324F7
sub_140232470   endp

; ---------------------------------------------------------------------------
algn_1402325D4:                         ; DATA XREF: .pdata:00000001400CB340↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402325E0   proc near               ; CODE XREF: sub_140201880+2A↑p
                                        ; sub_140208A24+54↑p ...
                movzx   eax, byte ptr [rcx+0B8h]
                and     al, 7
                cmp     al, 2
                jz      short loc_1402325F6
                lea     rax, [rcx+0C0h]
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402325F6:                          ; CODE XREF: sub_1402325E0+B↑j
                lea     rax, unk_140C4F600
                retn
sub_1402325E0   endp

; ---------------------------------------------------------------------------
                db 0CCh
byte_1402325FF  db 11h dup(0CCh)        ; DATA XREF: .pdata:00000001400CB34C↑o

; =============== S U B R O U T I N E =======================================


sub_140232610   proc near               ; CODE XREF: sub_140221A30+442↑p
                                        ; sub_14027ED80+5EF↓p ...

var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_0           = byte ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014042BD4A SIZE 0000004F BYTES

                mov     r11, rsp
                push    rbp
                push    r15
                sub     rsp, 58h
                mov     rax, 0FFFFFFFFFFFFFFFFh
                mov     rbp, rcx
                mov     edx, eax
                lock xadd [rcx+24h], edx
                dec     edx
                mov     r15d, 0FFFFFFFFh
                cmp     edx, r15d
                jz      loc_14042BD4A

loc_14023263C:                          ; DATA XREF: .rdata:00000001400538FC↑o
                                        ; .rdata:000000014005390C↑o ...
                mov     [r11+20h], rbx
                mov     [r11-18h], rsi
                mov     [r11-28h], r12
                mov     [r11-30h], r13
                lea     r13d, [rax+2]
                mov     [r11-38h], r14
                test    edx, edx
                jnz     short loc_140232664
                mov     ecx, [rcx+30h]
                test    cl, 4
                jnz     loc_14042BD51

loc_140232664:                          ; CODE XREF: sub_140232610+46↑j
                xor     r12d, r12d

loc_140232667:                          ; CODE XREF: sub_140232610+1F9744↓j
                mov     rsi, gs:188h
                and     byte ptr [rsi+518h], 7Fh
                lock xadd [rbp+28h], rax
                and     al, 6
                cmp     al, 2
                jz      loc_140232892

loc_140232687:                          ; CODE XREF: sub_140232610+28B↓j
                mov     [rsp+68h+arg_10], 0
                lea     rcx, [rbp+28h]
                mov     rbx, gs:188h
                call    sub_140245330
                cmp     eax, r13d
                jz      loc_14023285F

loc_1402326AD:                          ; CODE XREF: sub_140232610+25E↓j
                dec     word ptr [rbx+1E6h]
                mov     [rsp+68h+var_20], rdi
                inc     byte ptr [rbx+31Ah]
                movsx   ecx, byte ptr [rbx+318h]
                lea     r8, [rbp+28h]
                movsx   edx, byte ptr [rbx+366h]
                mov     r9, 7FFFFFFFFFFFFFFCh
                movzx   eax, byte ptr [rbx+31Ah]
                or      edx, ecx
                xor     edx, 3Fh
                mov     [rsp+68h+arg_8], 0
                and     r8, r9
                mov     [rsp+68h+arg_0], al
                bsr     ecx, edx
                mov     [rsp+68h+arg_8], ecx
                jz      loc_140232880

loc_140232703:                          ; CODE XREF: sub_140232610+26A↓j
                lea     rdi, [rcx+rcx*2]
                mov     eax, r13d
                shl     rdi, 5
                add     rdi, [rbx+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    [rdi+1Ah], r13b
                jz      loc_140232873
                mov     eax, [rdi+20h]
                test    r13b, al
                jnz     loc_140232873
                mov     rax, [rdi+20h]
                and     rax, r9
                cmp     rax, r8
                jnz     loc_140232873
                cmp     [rdi+28h], r15d
                jnz     loc_140232873
                and     byte ptr [rdi+1Ah], 0FEh
                mov     rax, [rdi+20h]
                test    rax, rax
                jz      loc_140232873
                test    rdi, rdi
                jz      loc_140232880
                movzx   eax, byte ptr [rdi+20h]
                or      al, 2
                mov     [rdi+20h], al
                mov     rax, [rdi+20h]
                shr     rax, 3Fh
                test    al, al
                jnz     loc_1402328A0

loc_14023277E:                          ; CODE XREF: sub_140232610+298↓j
                mov     eax, [rdi+58h]
                and     eax, 1FFFFh
                mov     [rsp+68h+arg_10], eax
                and     dword ptr [rdi+58h], 0FFFE0000h
                and     byte ptr [rdi+19h], 0FEh
                mov     qword ptr [rdi+20h], 0
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rdi, [rbx+320h]
                imul    rdi
                sar     rdx, 4
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                cmp     [rsp+68h+arg_0], r13b
                jnz     loc_14042BD59
                movzx   eax, byte ptr [rbx+318h]
                bts     eax, edx
                mov     [rbx+318h], al

loc_1402327DD:                          ; CODE XREF: sub_140232610+277↓j
                                        ; sub_140232610+1F9756↓j
                dec     byte ptr [rbx+31Ah]
                lea     r8, [rsp+68h+arg_10]
                lea     rdx, [rbp+28h]
                mov     rcx, rbx
                call    sub_1402456E0
                add     word ptr [rbx+1E6h], 1
                jnz     short loc_140232811
                add     rbx, 98h
                cmp     [rbx], rbx
                jnz     loc_1402328B7

loc_140232811:                          ; CODE XREF: sub_140232610+1EF↑j
                                        ; sub_140232610+2AC↓j
                add     word ptr [rsi+1E6h], 1
                jnz     short loc_14023282B
                lea     rax, [rsi+98h]
                cmp     [rax], rax
                jnz     loc_1402328AD

loc_14023282B:                          ; CODE XREF: sub_140232610+209↑j
                                        ; sub_140232610+2A2↓j
                cmp     r12d, 1
                jz      loc_14042BD89

loc_140232835:                          ; CODE XREF: sub_140232610+1F9784↓j
                mov     rdi, [rsp+68h+var_20]
                mov     r12, [rsp+68h+var_28]
                mov     r13, [rsp+68h+var_30]
                mov     rsi, [rsp+68h+var_18]
                mov     rbx, [rsp+68h+arg_18]
                mov     r14, [rsp+68h+var_38]
                add     rsp, 58h
                pop     r15
                pop     rbp
                retn
; ---------------------------------------------------------------------------
byte_14023285E  db 0CCh                 ; DATA XREF: .pdata:00000001400CB364↑o
                                        ; .pdata:00000001400CB370↑o
; ---------------------------------------------------------------------------

loc_14023285F:                          ; CODE XREF: sub_140232610+97↑j
                                        ; DATA XREF: .pdata:00000001400CB370↑o ...
                mov     rcx, [rbx+0B8h]
                call    sub_140245840
                mov     r15d, eax
                jmp     loc_1402326AD
; ---------------------------------------------------------------------------

loc_140232873:                          ; CODE XREF: sub_140232610+10F↑j
                                        ; sub_140232610+11B↑j ...
                bsr     ecx, edx
                mov     [rsp+68h+arg_8], ecx
                jnz     loc_140232703

loc_140232880:                          ; CODE XREF: sub_140232610+ED↑j
                                        ; sub_140232610+14F↑j
                mov     eax, [rbx+78h]
                bt      eax, 10h
                jb      loc_1402327DD
                jmp     loc_14042BD6B
; ---------------------------------------------------------------------------

loc_140232892:                          ; CODE XREF: sub_140232610+71↑j
                                        ; DATA XREF: .pdata:00000001400CB388↑o ...
                lea     rcx, [rbp+28h]
                call    ExfTryToWakePushLock
                jmp     loc_140232687
; ---------------------------------------------------------------------------

loc_1402328A0:                          ; CODE XREF: sub_140232610+168↑j
                                        ; DATA XREF: .pdata:00000001400CB394↑o ...
                mov     rcx, rdi
                call    sub_14031EC80
                jmp     loc_14023277E
; ---------------------------------------------------------------------------

loc_1402328AD:                          ; CODE XREF: sub_140232610+215↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_14023282B
; ---------------------------------------------------------------------------

loc_1402328B7:                          ; CODE XREF: sub_140232610+1FB↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_140232811
sub_140232610   endp

; ---------------------------------------------------------------------------
algn_1402328C1:                         ; DATA XREF: .pdata:00000001400CB3A0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402328D0   proc near               ; CODE XREF: sub_140306BD4+272↓p
                                        ; sub_140358D34+B7↓p ...
                mov     edx, [rcx+30h]
                mov     eax, edx
                and     eax, 100000h
                test    dl, 70h
                jnz     short loc_1402328FE
                test    eax, eax
                jz      short loc_1402328F7
                bt      edx, 16h
                jb      short loc_14023291B
                mov     eax, edx
                and     eax, 0C0000h
                cmp     eax, 80000h
                jnb     short loc_14023291B

loc_1402328F7:                          ; CODE XREF: sub_1402328D0+11↑j
                                        ; sub_1402328D0+49↓j ...
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402328FE:                          ; CODE XREF: sub_1402328D0+D↑j
                test    eax, eax
                jnz     short loc_140232910
                mov     eax, [rcx+40h]
                bt      eax, 18h
                jnb     short loc_140232910
                mov     edx, [rcx+30h]
                jmp     short loc_14023291B
; ---------------------------------------------------------------------------

loc_140232910:                          ; CODE XREF: sub_1402328D0+30↑j
                                        ; sub_1402328D0+39↑j
                mov     edx, [rcx+30h]
                mov     eax, edx
                and     al, 70h
                cmp     al, 20h ; ' '
                jz      short loc_1402328F7

loc_14023291B:                          ; CODE XREF: sub_1402328D0+17↑j
                                        ; sub_1402328D0+25↑j ...
                and     dl, 70h
                cmp     dl, 40h ; '@'
                jz      short loc_1402328F7
                xor     eax, eax
                retn
sub_1402328D0   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_140232927:                         ; DATA XREF: .pdata:00000001400CB3AC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140232930   proc near               ; CODE XREF: sub_1402214C0+436↑p
                                        ; sub_14027ED80+2B1↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014042BD9A SIZE 00000095 BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r12
                push    r14
                push    r15
                sub     rsp, 20h
                mov     dword ptr [r8], 0
                mov     r12, r8
                mov     rdi, gs:188h
                mov     r15d, edx
                mov     rsi, rcx
                mov     r14, [rdi+0B8h]
                dec     word ptr [rdi+1E6h]
                dec     word ptr [rdi+1E6h]
                lea     rcx, [r14+4C8h]
                xor     edx, edx
                call    ExAcquirePushLockSharedEx
                or      byte ptr [rdi+518h], 2
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     rbx, [rdx+7E0h]
                test    rbx, rbx
                jz      loc_140232AAF
                movzx   ecx, byte ptr [rbx+20h]
                mov     eax, [rbx+18h]
                shl     rcx, 20h
                or      rcx, rax
                shr     rsi, 0Ch
                cmp     rsi, rcx
                jb      loc_140232AA3
                movzx   ecx, byte ptr [rbx+21h]
                mov     eax, [rbx+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rsi, rcx
                ja      loc_140232AA3

loc_1402329DE:                          ; CODE XREF: sub_140232930+219↓j
                test    rbx, rbx
                jz      loc_140232AAF
                test    r15b, 1
                jnz     short loc_1402329FC
                mov     eax, [r14+464h]
                test    al, 20h
                jnz     loc_14042BD9A

loc_1402329FC:                          ; CODE XREF: sub_140232930+BB↑j
                lock inc dword ptr [rbx+24h]
                jz      loc_14042BDA4
                mov     rdx, r14

loc_140232A09:                          ; DATA XREF: .rdata:0000000140053A2C↑o
                                        ; .rdata:0000000140053A40↑o ...
                mov     [rsp+38h+arg_0], rbp
                mov     rcx, rdi
                call    sub_140243130
                dec     word ptr [rdi+1E6h]
                lea     rcx, [rbx+28h]
                and     r15d, 2
                jnz     loc_140232AE1
                xor     edx, edx
                call    ExAcquirePushLockExclusiveEx
                or      byte ptr [rdi+518h], 80h

loc_140232A39:                          ; CODE XREF: sub_140232930+1BF↓j
                add     word ptr [rdi+1E6h], 1
                jz      loc_140232B4E

loc_140232A47:                          ; CODE XREF: sub_140232930+228↓j
                                        ; sub_140232930+1F9481↓j
                mov     eax, [rbx+30h]
                test    al, 4
                jnz     loc_14042BDB6
                movzx   ecx, byte ptr [rbx+20h]
                mov     eax, [rbx+18h]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rsi, rcx
                jb      loc_14042BE0B
                movzx   ecx, byte ptr [rbx+21h]
                mov     eax, [rbx+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rsi, rcx
                ja      loc_14042BE0B
                mov     rax, rbx

loc_140232A83:                          ; CODE XREF: sub_140232930+1F94FA↓j
                mov     rbp, [rsp+38h+arg_0]

loc_140232A88:                          ; CODE XREF: sub_140232930+1AF↓j
                                        ; DATA XREF: .pdata:00000001400CB3C4↑o ...
                mov     rbx, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                mov     rdi, [rsp+38h+arg_18]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     r12
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140232AA3:                          ; CODE XREF: sub_140232930+91↑j
                                        ; sub_140232930+A8↑j
                mov     rbx, [rdx+7D8h]
                test    rbx, rbx
                jnz     short loc_140232B00

loc_140232AAF:                          ; CODE XREF: sub_140232930+76↑j
                                        ; sub_140232930+B1↑j ...
                mov     ecx, [r14+464h]
                mov     eax, 0C000010Ah
                test    cl, 20h
                mov     edx, 0C00000A0h
                cmovnz  edx, eax

loc_140232AC6:                          ; CODE XREF: sub_140232930+1F946F↓j
                mov     [r12], edx
                mov     rcx, rdi
                mov     rdx, r14
                call    sub_140243130
                mov     rcx, rdi
                call    sub_140245770
                xor     eax, eax
                jmp     short loc_140232A88
; ---------------------------------------------------------------------------

loc_140232AE1:                          ; CODE XREF: sub_140232930+F5↑j
                                        ; DATA XREF: .pdata:00000001400CB3D0↑o ...
                xor     edx, edx
                call    ExAcquirePushLockSharedEx
                or      byte ptr [rdi+519h], 40h
                jmp     loc_140232A39
; ---------------------------------------------------------------------------
                align 20h

loc_140232B00:                          ; CODE XREF: sub_140232930+17D↑j
                                        ; sub_140232930+202↓j
                                        ; DATA XREF: ...
                movzx   ecx, byte ptr [rbx+21h]
                mov     eax, [rbx+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rsi, rcx
                ja      short loc_140232B2B
                movzx   ecx, byte ptr [rbx+20h]
                mov     eax, [rbx+18h]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rsi, rcx
                jnb     short loc_140232B39
                mov     rbx, [rbx]
                jmp     short loc_140232B2F
; ---------------------------------------------------------------------------

loc_140232B2B:                          ; CODE XREF: sub_140232930+1E1↑j
                mov     rbx, [rbx+8]

loc_140232B2F:                          ; CODE XREF: sub_140232930+1F9↑j
                test    rbx, rbx
                jnz     short loc_140232B00
                jmp     loc_140232AAF
; ---------------------------------------------------------------------------

loc_140232B39:                          ; CODE XREF: sub_140232930+1F4↑j
                test    rbx, rbx
                jz      loc_140232AAF
                mov     [rdx+7E0h], rbx
                jmp     loc_1402329DE
; ---------------------------------------------------------------------------

loc_140232B4E:                          ; CODE XREF: sub_140232930+111↑j
                                        ; DATA XREF: .pdata:00000001400CB3E8↑o ...
                lea     rax, [rdi+98h]
                cmp     [rax], rax
                jz      loc_140232A47
                jmp     loc_14042BDAB
sub_140232930   endp

; ---------------------------------------------------------------------------
algn_140232B63:                         ; DATA XREF: .pdata:00000001400CB3F4↑o
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=80h

sub_140232B70   proc near               ; CODE XREF: sub_14063D6E0+AF↓p
                                        ; sub_14067D95C+87↓p ...

var_160         = dword ptr -160h
var_158         = qword ptr -158h
var_150         = dword ptr -150h
var_14C         = dword ptr -14Ch
var_148         = qword ptr -148h
var_140         = qword ptr -140h
var_138         = qword ptr -138h
var_130         = qword ptr -130h
var_128         = qword ptr -128h
var_120         = qword ptr -120h
var_118         = xmmword ptr -118h
var_108         = qword ptr -108h
var_100         = qword ptr -100h
var_F0          = word ptr -0F0h
var_EE          = byte ptr -0EEh
var_EA          = byte ptr -0EAh
var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 000000014042BE30 SIZE 00000225 BYTES

; __unwind { // __GSHandlerCheck
                mov     [rsp-8+arg_18], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-50h]
                sub     rsp, 150h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+80h+var_40], rax
                mov     rax, gs:188h
                xor     edi, edi
                mov     [rsp+180h+var_130], r8
                mov     r14, rdx
                mov     rsi, rcx
                mov     [rsp+180h+var_14C], edi
                mov     [rsp+180h+var_128], rdi
                mov     rax, [rax+0B8h]
                mov     [rsp+180h+var_120], rax
                mov     [r8], rdi
                mov     [rsp+180h+var_150], edi
                lea     r13, [rax+680h]
                movzx   eax, byte ptr [rax+738h]
                and     al, 7
                mov     [rsp+180h+var_138], r13
                cmp     al, 6
                jnb     loc_14042BE30
                cmp     al, 2
                jz      loc_14042BE95
                lea     rbx, [r13+0C0h]

loc_140232BF8:                          ; CODE XREF: sub_140232B70+1F932C↓j
                mov     r12, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042BEA1

loc_140232C13:                          ; CODE XREF: sub_140232B70+1F9333↓j
                                        ; sub_140232B70+1F933D↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14042BEE6
                mov     r15, gs:20h
                mov     rcx, [r15+84B8h]
                test    rcx, rcx
                jnz     loc_14042BEF8

loc_140232C39:                          ; CODE XREF: sub_140232B70+1F938D↓j
                                        ; sub_140232B70+1F939C↓j ...
                prefetchw byte ptr [rbx]
                mov     eax, [rbx]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rbx], ecx
                jnz     loc_140232FEF

loc_140232C4F:                          ; CODE XREF: sub_140232B70+49B↓j
                                        ; sub_140232B70+1F9383↓j
                cmp     [rbx+4], edi
                jnz     loc_14042BF48

loc_140232C58:                          ; CODE XREF: sub_140232B70+1F93DD↓j
                movzx   ecx, r12b
                mov     [rsp+180h+var_158], rcx

loc_140232C61:                          ; CODE XREF: sub_140232B70+1F92DA↓j
                                        ; sub_140232B70+1F92E2↓j ...
                mov     edx, edi
                shr     rsi, 9
                mov     r9, 7FFFFFFFF8h
                mov     [rsp+180h+var_160], edx
                and     rsi, r9
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                lea     rcx, [rsi+rax]
                shr     r14, 9
                mov     [rbp+80h+var_100], rcx
                and     r14, r9
                mov     rax, r8
                lea     r12, [r14+rax]

loc_140232C9B:                          ; CODE XREF: sub_140232B70+448↓j
                mov     [rsp+180h+var_148], rdi
                mov     rbx, rdi
                mov     [rsp+180h+var_140], rbx
                mov     r14, rdi
                mov     rsi, rcx
                cmp     rcx, r12
                ja      loc_140232E71
                mov     r14, r8
                shl     r14, 19h
                mov     r15, r12
                shl     r15, 19h
                sub     r15, r14
                mov     [rsp+180h+var_108], r14
                sar     r15, 10h

loc_140232CD1:                          ; CODE XREF: sub_140232B70+2ED↓j
                xorps   xmm0, xmm0
                lea     rcx, [rbp+80h+var_EE]
                xor     edx, edx
                mov     r8d, 0AEh
                movups  [rsp+180h+var_118], xmm0
                call    memset
                mov     rbx, rsi
                mov     rdx, 0FFFFF68000000000h
                shl     rbx, 19h
                mov     eax, 861h
                sub     rbx, r14
                mov     [rbp+80h+var_F0], ax
                sar     rbx, 10h
                mov     rcx, rbx
                mov     rax, rdx
                cmp     rbx, rax
                jb      short loc_140232D31
                mov     r13, 0FFFFF6FFFFFFFFFFh

loc_140232D20:                          ; CODE XREF: sub_140232B70+1F93F3↓j
                mov     rax, r13
                cmp     rcx, rax
                jbe     loc_14042BF52

loc_140232D2C:                          ; CODE XREF: sub_140232B70+1F93F9↓j
                mov     r13, [rsp+180h+var_138]

loc_140232D31:                          ; CODE XREF: sub_140232B70+1A4↑j
                mov     rax, 0FFFF800000000000h
                cmp     rcx, rax
                jb      short loc_140232D5A
                cmp     rcx, cs:qword_140C4F9B8
                jb      loc_14042BF6E
                cmp     rcx, cs:qword_140C4E1E8
                ja      loc_14042BF6E

loc_140232D5A:                          ; CODE XREF: sub_140232B70+1CE↑j
                mov     rax, gs:188h
                mov     r14, [rax+0B8h]
                add     r14, 680h

loc_140232D71:                          ; CODE XREF: sub_140232B70+1F940B↓j
                xor     r8d, r8d
                mov     rdx, rbx
                mov     rcx, r14
                call    sub_1402258A0
                test    eax, eax
                jz      loc_140232EE6
                dec     eax
                shr     rbx, 9
                mov     dword ptr [rsp+180h+var_118], eax
                mov     rax, 7FFFFFFFF8h
                and     rbx, rax
                mov     rcx, 0FFFFF68000000000h
                mov     rax, rcx
                add     rbx, rax
                mov     qword ptr [rsp+180h+var_118+8], rbx

loc_140232DB3:                          ; CODE XREF: sub_140232B70+3CA↓j
                test    rbx, rbx
                jz      loc_140232F3F
                mov     r14, rbx
                mov     rax, 7FFFFFFFF8h
                shr     r14, 9
                and     r14, rax
                mov     rax, rcx
                add     r14, rax
                cmp     rbx, rsi
                jnz     loc_14042BF80
                mov     rax, rsi
                mov     rbx, r12
                and     rax, 0FFFFFFFFFFFFF000h
                add     rax, 0FF8h
                cmp     rax, r12
                cmovbe  rbx, rax
                cmp     rsi, rbx
                ja      short loc_140232E4A
                mov     rdi, 0FFFFF6FB7DBED000h
                mov     r13, 0FFFFF6FB7DBED7F8h

loc_140232E11:                          ; CODE XREF: sub_140232B70+2D1↓j
                mov     rcx, [rsi]
                mov     rax, rdi
                cmp     rsi, rax
                jb      short loc_140232E28
                mov     rax, r13
                cmp     rsi, rax
                jbe     loc_14042BF94

loc_140232E28:                          ; CODE XREF: sub_140232B70+2AA↑j
                                        ; sub_140232B70+1F942E↓j ...
                test    rcx, rcx
                jz      loc_140232FBD

loc_140232E31:                          ; CODE XREF: sub_140232B70+45A↓j
                add     rsi, 8
                test    rsi, 0FFFh
                jz      short loc_140232E43
                cmp     rsi, rbx
                jbe     short loc_140232E11

loc_140232E43:                          ; CODE XREF: sub_140232B70+2CC↑j
                mov     r13, [rsp+180h+var_138]
                xor     edi, edi

loc_140232E4A:                          ; CODE XREF: sub_140232B70+28B↑j
                mov     rdx, r14
                mov     rcx, r13
                call    sub_140312B40

loc_140232E55:                          ; CODE XREF: sub_140232B70+3EC↓j
                mov     r14, [rsp+180h+var_108]
                cmp     rsi, r12
                jbe     loc_140232CD1
                mov     rbx, [rsp+180h+var_140]
                mov     r14, [rsp+180h+var_148]
                mov     edx, [rsp+180h+var_160]

loc_140232E71:                          ; CODE XREF: sub_140232B70+141↑j
                test    edx, edx
                jnz     short loc_140232E7E
                test    r14, r14
                jnz     loc_140232F61

loc_140232E7E:                          ; CODE XREF: sub_140232B70+303↑j
                test    rbx, rbx
                jnz     loc_14042C02D

loc_140232E87:                          ; CODE XREF: sub_140232B70+1F94D5↓j
                movzx   edx, byte ptr [rsp+180h+var_158]
                mov     rcx, r13
                call    sub_140226960
                mov     rcx, [rsp+180h+var_130]
                mov     rax, [rcx]
                cmp     r14, rax
                jnz     loc_140232FCF

loc_140232EA5:                          ; CODE XREF: sub_140232B70+468↓j
                mov     rax, [rsp+180h+var_128]
                cmp     rbx, rax
                jnz     loc_14042C04A

loc_140232EB3:                          ; CODE XREF: sub_140232B70+1F94E0↓j
                test    rdi, rdi
                jnz     loc_140232FDD

loc_140232EBC:                          ; CODE XREF: sub_140232B70+47A↓j
                xor     eax, eax

loc_140232EBE:                          ; CODE XREF: sub_140232B70+413↓j
                mov     rcx, [rbp+80h+var_40]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+180h+arg_18]
                add     rsp, 150h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140232EE6:                          ; CODE XREF: sub_140232B70+211↑j
                or      [rbp+80h+var_F0], 4
                lea     rax, [rsp+180h+var_118]
                mov     [rbp+80h+var_48], rax
                lea     rcx, [rbp+80h+var_F0]
                movzx   eax, [rbp+80h+var_EE]
                and     al, 0E7h
                mov     [rbp+80h+var_E0], rdi
                or      al, 4
                mov     [rbp+80h+var_D8], r14
                mov     [rbp+80h+var_EE], al
                lea     rax, sub_14034E280
                mov     [rbp+80h+var_50], rax
                mov     rax, [rsp+180h+var_158]
                mov     [rbp+80h+var_EA], al
                mov     [rbp+80h+var_D0], rbx
                mov     [rbp+80h+var_C8], r15
                call    sub_140220490
                mov     rbx, qword ptr [rsp+180h+var_118+8]
                mov     rcx, 0FFFFF68000000000h
                jmp     loc_140232DB3
; ---------------------------------------------------------------------------

loc_140232F3F:                          ; CODE XREF: sub_140232B70+246↑j
                mov     rbx, r12

loc_140232F42:                          ; CODE XREF: sub_140232B70+1F941F↓j
                movzx   r8d, byte ptr [rsp+180h+var_158]
                lea     r9, [rsp+180h+var_150]
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_1402A5938
                lea     rsi, [rbx+8]
                jmp     loc_140232E55
; ---------------------------------------------------------------------------

loc_140232F61:                          ; CODE XREF: sub_140232B70+308↑j
                movzx   edx, byte ptr [rsp+180h+var_158]
                mov     rcx, r13
                call    sub_140226960
                mov     rcx, [rsp+180h+var_120]
                lea     rdx, [r14+rbx]
                mov     [rsp+180h+var_128], rbx
                call    sub_14063D610
                test    eax, eax
                js      loc_140232EBE
                mov     rax, [rsp+180h+var_130]
                mov     rcx, r13
                mov     [rsp+180h+var_150], 1
                mov     [rax], r14
                call    sub_140231340
                mov     rcx, [rbp+80h+var_100]
                mov     edx, 1
                mov     [rsp+180h+var_160], edx
                mov     r8, 0FFFFF68000000000h
                jmp     loc_140232C9B
; ---------------------------------------------------------------------------

loc_140232FBD:                          ; CODE XREF: sub_140232B70+2BB↑j
                lea     r8, [rsp+180h+var_150]
                mov     rcx, rsi
                call    sub_1402A4F44
                jmp     loc_140232E31
; ---------------------------------------------------------------------------

loc_140232FCF:                          ; CODE XREF: sub_140232B70+32F↑j
                mov     rdi, rax
                mov     [rcx], r14
                sub     rdi, r14
                jmp     loc_140232EA5
; ---------------------------------------------------------------------------

loc_140232FDD:                          ; CODE XREF: sub_140232B70+346↑j
                mov     rcx, [rsp+180h+var_120]
                mov     rdx, rdi
                call    sub_14065C6A8
                jmp     loc_140232EBC
; ---------------------------------------------------------------------------

loc_140232FEF:                          ; CODE XREF: sub_140232B70+D9↑j
                mov     rcx, [r15+84B8h]
                test    rcx, rcx
                jnz     loc_14042BF20

loc_140232FFF:                          ; CODE XREF: sub_140232B70+1F93B5↓j
                                        ; sub_140232B70+1F93C4↓j ...
                movzx   edx, r12b
                mov     rcx, rbx
                call    sub_140329420
                jmp     loc_140232C4F
; } // starts at 140232B70
sub_140232B70   endp

; ---------------------------------------------------------------------------
algn_140233010:                         ; DATA XREF: .rdata:0000000140053B00↑o
                                        ; .pdata:00000001400CB400↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140233020   proc near               ; CODE XREF: sub_1402214C0+44A↑p
                                        ; sub_140281E60+64C↓p ...
                mov     eax, [rcx+30h]
                bt      eax, 14h
                jnb     short loc_140233037
                test    al, 70h
                jnz     short loc_140233033
                cmp     dword ptr [rcx+34h], 0
                jge     short loc_14023305A

loc_140233033:                          ; CODE XREF: sub_140233020+B↑j
                                        ; sub_140233020+21↓j ...
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140233037:                          ; CODE XREF: sub_140233020+7↑j
                and     eax, 0F80h
                cmp     eax, 0C00h
                jnz     short loc_140233033
                mov     rax, [rcx+48h]
                mov     rcx, [rax]
                cmp     qword ptr [rcx+40h], 0
                jnz     short loc_140233033
                test    dword ptr [rcx+38h], 1000h
                jz      short loc_140233033

loc_14023305A:                          ; CODE XREF: sub_140233020+11↑j
                mov     eax, 1
                retn
sub_140233020   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_140233061:                         ; DATA XREF: .pdata:00000001400CB40C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140233070   proc near               ; CODE XREF: sub_14063D6E0+F5↓p
                                        ; DATA XREF: .pdata:00000001400CB418↑o
                mov     eax, [rcx+30h]
                bt      eax, 14h
                jnb     short loc_140233099
                bt      eax, 16h
                jb      short loc_1402330A2
                and     eax, 0C0000h
                cmp     eax, 80000h
                jnb     short loc_1402330A2

loc_14023308B:                          ; CODE XREF: sub_140233070+30↓j
                mov     eax, [rcx+30h]
                and     eax, 70h
                cmp     al, 30h ; '0'
                jz      short loc_1402330A2
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140233099:                          ; CODE XREF: sub_140233070+7↑j
                mov     eax, [rcx+40h]
                bt      eax, 18h
                jnb     short loc_14023308B

loc_1402330A2:                          ; CODE XREF: sub_140233070+D↑j
                                        ; sub_140233070+19↑j ...
                mov     eax, 1
                retn
sub_140233070   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_1402330A9:                         ; DATA XREF: .pdata:00000001400CB418↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402330B0   proc near               ; CODE XREF: sub_14063D6E0+EA↓p
                                        ; sub_14065C850+B7↓p
                                        ; DATA XREF: ...

; FUNCTION CHUNK AT 000000014042C056 SIZE 00000017 BYTES

                sub     rsp, 28h
                mov     edx, [rcx+30h]
                bt      edx, 14h
                jnb     short loc_1402330E3
                bt      edx, 16h
                jb      short loc_1402330EF
                mov     eax, edx
                and     eax, 0C0000h
                cmp     eax, 80000h
                jnb     short loc_1402330EF

loc_1402330D1:                          ; CODE XREF: sub_1402330B0+3A↓j
                mov     eax, [rcx+30h]
                and     eax, 70h
                cmp     al, 30h ; '0'
                jz      short loc_14023310C

loc_1402330DB:                          ; CODE XREF: sub_1402330B0+55↓j
                xor     eax, eax

loc_1402330DD:                          ; CODE XREF: sub_1402330B0+61↓j
                                        ; sub_1402330B0+1F8FAB↓j ...
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402330E3:                          ; CODE XREF: sub_1402330B0+B↑j
                mov     eax, [rcx+40h]
                bt      eax, 18h
                jnb     short loc_1402330D1
                mov     edx, [rcx+30h]

loc_1402330EF:                          ; CODE XREF: sub_1402330B0+11↑j
                                        ; sub_1402330B0+1F↑j
                mov     eax, edx
                lea     rcx, dword_14002DE50
                shr     rax, 12h
                and     eax, 3
                mov     ecx, [rcx+rax*4]
                cmp     ecx, 1
                ja      short loc_1402330DB
                jmp     loc_14042C056
; ---------------------------------------------------------------------------

loc_14023310C:                          ; CODE XREF: sub_1402330B0+29↑j
                call    sub_1408D7788
                jmp     short loc_1402330DD
sub_1402330B0   endp

; ---------------------------------------------------------------------------
algn_140233113:                         ; DATA XREF: .rdata:0000000140053B1C↑o
                                        ; .pdata:00000001400CB424↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140233120   proc near               ; CODE XREF: sub_14022FC80+276↑p
                                        ; sub_14026CF00+2D5↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014042C06E SIZE 0000006B BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 20h
                mov     ebp, r8d
                lea     rbx, unk_140C50C00
                mov     edi, edx
                mov     rsi, rcx
                mov     r14d, 0FFFFFFFFh
                mov     r15d, 400h

loc_140233153:                          ; CODE XREF: sub_140233120+E3↓j
                mov     r9d, edi
                cmp     rsi, rbx
                jnz     loc_1402331E5
                mov     r8, gs:20h
                mov     edx, [r8+831Ch]
                cmp     r9, rdx
                ja      short loc_1402331E5

loc_140233174:                          ; CODE XREF: sub_140233120+1F8F51↓j
                cmp     edx, r14d
                jz      short loc_1402331E5
                mov     ecx, edx
                mov     eax, edx
                sub     ecx, edi
                lock cmpxchg [r8+831Ch], ecx
                mov     edx, eax
                jnz     loc_14042C06E

loc_140233190:                          ; CODE XREF: sub_140233120+DF↓j
                test    edi, edi
                jz      loc_14042C07C

loc_140233198:                          ; CODE XREF: sub_140233120+1F8F7C↓j
                test    bpl, 1
                jz      short loc_1402331E1
                mov     ebx, edi

loc_1402331A0:                          ; CODE XREF: sub_140233120+F0↓j
                mov     edx, ebx
                mov     r8d, 1
                mov     rcx, rsi
                call    sub_140232160
                cmp     eax, 1
                jnz     short loc_14023320E
                test    ebx, ebx
                jz      loc_14042C0A1

loc_1402331BD:                          ; CODE XREF: sub_140233120+1F8F85↓j
                                        ; sub_140233120+1F8F9F↓j
                cmp     ebx, edi
                jnz     loc_14042C0C4

loc_1402331C5:                          ; CODE XREF: sub_140233120+1F8FB4↓j
                mov     eax, ebx

loc_1402331C7:                          ; CODE XREF: sub_140233120+C3↓j
                                        ; sub_140233120+1F8F64↓j
                mov     rbx, [rsp+38h+arg_0]
                mov     rbp, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402331E1:                          ; CODE XREF: sub_140233120+7C↑j
                mov     eax, edi
                jmp     short loc_1402331C7
; ---------------------------------------------------------------------------

loc_1402331E5:                          ; CODE XREF: sub_140233120+39↑j
                                        ; sub_140233120+52↑j ...
                mov     r8d, 1
                mov     rdx, r9
                cmp     edi, r8d
                mov     rcx, rsi
                cmovnz  r8, r15
                call    sub_1403438BC
                test    eax, eax
                jnz     short loc_140233190
                shr     edi, 1
                jnz     loc_140233153
                jmp     loc_14042C07C
; ---------------------------------------------------------------------------

loc_14023320E:                          ; CODE XREF: sub_140233120+93↑j
                shr     ebx, 1
                jnz     short loc_1402331A0
                jmp     loc_14042C0A1
sub_140233120   endp

; ---------------------------------------------------------------------------
algn_140233217:                         ; DATA XREF: .rdata:0000000140053B48↑o
                                        ; .pdata:00000001400CB430↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140233220   proc near               ; CODE XREF: sub_1402F26A0:loc_1402F2799↓p
                                        ; NtSetInformationThread+289↓p ...

var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = dword ptr -88h
var_80          = qword ptr -80h
var_78          = dword ptr -78h
var_74          = dword ptr -74h
var_70          = dword ptr -70h
var_6C          = dword ptr -6Ch
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
var_38          = byte ptr -38h
var_8           = dword ptr -8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014042C0DA SIZE 000004AB BYTES

; __unwind { // __GSHandlerCheck
                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                pushfq
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 80h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+0B8h+var_40], rax
                cmp     cs:dword_140CFB010, 0
                mov     rdi, rcx
                mov     eax, 1
                jnz     loc_14042C0DA

loc_140233261:                          ; CODE XREF: sub_140233220+1F8ED0↓j
                lea     rcx, [rdi-30h]
                call    sub_140233550
                mov     rbx, gs:188h
                mov     rcx, rbx
                call    sub_140234C00
                mov     rbp, cr8
                mov     r14d, 2
                mov     cr8, r14
                mov     eax, cs:dword_140CFC660
                lea     r12, [r14-3]
                test    eax, eax
                jnz     loc_14042C0F5

loc_14023329B:                          ; CODE XREF: sub_140233220+1F8ED7↓j
                                        ; sub_140233220+1F8EE1↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                lea     rcx, dword_140C1DF40
                movzx   edx, bpl
                jnz     loc_14042C136
                call    sub_140234420

loc_1402332B8:                          ; CODE XREF: sub_140233220+1F8F1C↓j
                mov     [rbx+5C0h], rdi
                movsx   esi, byte ptr [rdi+0C3h]
                cmp     esi, 0Fh
                jg      loc_140233471

loc_1402332CF:                          ; CODE XREF: sub_140233220+256↓j
                xor     r13d, r13d
                mov     [rsp+0B8h+var_68], r13
                mov     r15, cr8
                mov     cr8, r14
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C141

loc_1402332ED:                          ; CODE XREF: sub_140233220+1F8F23↓j
                                        ; sub_140233220+1F8F2D↓j ...
                mov     r14, gs:20h
                mov     [rsp+0B8h+var_78], r13d
                mov     rcx, [r14+84B8h]
                test    rcx, rcx
                jnz     loc_14042C182

loc_14023330B:                          ; CODE XREF: sub_140233220+288↓j
                                        ; sub_140233220+1F8F67↓j ...
                lock bts qword ptr [rbx+40h], 0
                jb      loc_14023347B
                movsx   rcx, sil
                mov     [rbx+31Bh], sil
                movzx   eax, byte ptr [rcx+rbx+338h]
                cmp     al, 0FFh
                jz      loc_14042C1EE
                inc     al
                movsx   r8d, sil
                mov     [rcx+rbx+338h], al
                mov     eax, [rbx+358h]
                bts     eax, r8d
                mov     [rbx+358h], eax
                cmp     [rbx+0C3h], sil
                jl      loc_140233441

loc_14023335D:                          ; CODE XREF: sub_140233220+22E↓j
                mov     rcx, rbx
                call    sub_1403261B0
                mov     rsi, gs:20h
                lea     rdx, [rsp+0B8h+var_68]
                mov     rcx, rsi
                call    sub_14028DAE0
                cmp     r15b, 2
                jb      loc_14042C20A
                cmp     [rsi+10h], r13
                jnz     loc_140233453

loc_14023338F:                          ; CODE XREF: sub_140233220+23C↓j
                                        ; sub_140233220+24C↓j
                mov     r14d, 1

loc_140233395:                          ; CODE XREF: sub_140233220+1F9217↓j
                mov     r9, gs:20h
                cmp     cs:dword_140CFC580, 0
                jnz     loc_14042C43C

loc_1402333AB:                          ; CODE XREF: sub_140233220+1F928A↓j
                                        ; sub_140233220+1F9291↓j
                lea     rcx, dword_140C1DF40
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C4B6

loc_1402333C5:                          ; CODE XREF: sub_140233220+1F9298↓j
                                        ; sub_140233220+1F92A4↓j ...
                movzx   eax, bpl
                mov     cr8, rax
                mov     rax, [rdi+220h]
                mov     rcx, [rax+510h]
                test    rcx, rcx
                jz      short loc_1402333EC
                mov     rdx, [rcx+3F8h]
                test    rdx, rdx
                jnz     short loc_140233437

loc_1402333EC:                          ; CODE XREF: sub_140233220+1BE↑j
                                        ; sub_140233220+21F↓j
                mov     rbx, cs:qword_140C199B0
                lea     rdx, qword_14000A828
                mov     rcx, rbx
                call    EtwEventEnabled
                test    al, al
                jnz     loc_14042C519

loc_14023340A:                          ; CODE XREF: sub_140233220+1F9360↓j
                mov     rcx, [rsp+0B8h+var_40]
                xor     rcx, rsp
                call    __security_check_cookie
                lea     r11, [rsp+0B8h+var_38]
                mov     rbx, [r11+48h]
                mov     rbp, [r11+50h]
                mov     rsp, r11
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rcx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140233437:                          ; CODE XREF: sub_140233220+1CA↑j
                mov     rcx, rbx
                call    sub_1402CBD70
                jmp     short loc_1402333EC
; ---------------------------------------------------------------------------

loc_140233441:                          ; CODE XREF: sub_140233220+137↑j
                lea     rdx, [rsp+0B8h+var_68]
                mov     rcx, rbx
                call    sub_14025C570
                jmp     loc_14023335D
; ---------------------------------------------------------------------------

loc_140233453:                          ; CODE XREF: sub_140233220+169↑j
                movzx   eax, byte ptr [rsi+312Ah]
                test    al, al
                jnz     loc_14023338F
                mov     dl, 2
                mov     rcx, rsi
                call    sub_140308B50
                jmp     loc_14023338F
; ---------------------------------------------------------------------------

loc_140233471:                          ; CODE XREF: sub_140233220+A9↑j
                mov     esi, 0Fh
                jmp     loc_1402332CF
; ---------------------------------------------------------------------------

loc_14023347B:                          ; CODE XREF: sub_140233220+F2↑j
                mov     rcx, [r14+84B8h]
                test    rcx, rcx
                jnz     loc_14042C1AA

loc_14023348B:                          ; CODE XREF: sub_140233220+27C↓j
                                        ; sub_140233220+1F8F8F↓j ...
                lea     rcx, [rsp+0B8h+var_78]
                call    sub_1402C8C70
                mov     rax, [rbx+40h]
                test    rax, rax
                jnz     short loc_14023348B
                mov     rcx, [r14+84B8h]
                test    rcx, rcx
                jz      loc_14023330B
                jmp     loc_14042C1D2
; } // starts at 140233220
sub_140233220   endp

; ---------------------------------------------------------------------------
algn_1402334B3:                         ; DATA XREF: .rdata:0000000140053DEC↑o
                                        ; .pdata:00000001400CB43C↑o
                align 20h
; Exported entry 138. EtwEventEnabled

; =============== S U B R O U T I N E =======================================


                public EtwEventEnabled
EtwEventEnabled proc near               ; CODE XREF: sub_140233220+1DD↑p
                                        ; sub_14024F4C0+AC9↓p ...
                sub     rsp, 28h
                mov     r8, rcx
                test    rcx, rcx
                jz      short loc_1402334FD
                mov     rax, [rcx+20h]
                mov     r9, [rdx+8]
                cmp     dword ptr [rax+60h], 0
                jz      short loc_1402334F6
                movzx   ecx, byte ptr [rax+64h]
                cmp     [rdx+4], cl
                ja      short loc_140233536

loc_1402334E3:                          ; CODE XREF: EtwEventEnabled+7A↓j
                mov     ecx, [rax+68h]
                test    cl, 40h
                jz      short loc_1402334F0
                test    r9, r9
                jz      short loc_14023352E

loc_1402334F0:                          ; CODE XREF: EtwEventEnabled+29↑j
                test    [rax+70h], r9
                jnz     short loc_14023351F

loc_1402334F6:                          ; CODE XREF: EtwEventEnabled+18↑j
                                        ; EtwEventEnabled+6C↓j ...
                cmp     byte ptr [r8+65h], 0
                jnz     short loc_140233505

loc_1402334FD:                          ; CODE XREF: EtwEventEnabled+A↑j
                                        ; EtwEventEnabled+5B↓j
                xor     al, al
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140233505:                          ; CODE XREF: EtwEventEnabled+3B↑j
                mov     rcx, [r8+28h]
                mov     r8, r9
                movzx   edx, byte ptr [rdx+4]
                add     rcx, 60h ; '`'
                call    sub_140252AD0
                test    al, al
                jz      short loc_1402334FD
                jmp     short loc_14023352E
; ---------------------------------------------------------------------------

loc_14023351F:                          ; CODE XREF: EtwEventEnabled+34↑j
                mov     rcx, [rax+78h]
                mov     rax, rcx
                and     rax, r9
                cmp     rax, rcx
                jnz     short loc_1402334F6

loc_14023352E:                          ; CODE XREF: EtwEventEnabled+2E↑j
                                        ; EtwEventEnabled+5D↑j
                mov     al, 1
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140233536:                          ; CODE XREF: EtwEventEnabled+21↑j
                test    cl, cl
                jnz     short loc_1402334F6
                jmp     short loc_1402334E3
EtwEventEnabled endp

; ---------------------------------------------------------------------------
byte_14023353C  db 14h dup(0CCh)        ; DATA XREF: .pdata:00000001400CB448↑o

; =============== S U B R O U T I N E =======================================


sub_140233550   proc near               ; CODE XREF: sub_140233220+45↑p
                                        ; sub_14025BCB0+49D↓p ...

var_18          = qword ptr -18h

; FUNCTION CHUNK AT 000000014041CA16 SIZE 00000018 BYTES

                sub     rsp, 38h
                mov     eax, 1
                lock xadd [rcx], rax
                inc     rax
                cmp     rax, 1
                jle     loc_14041CA16
                add     rsp, 38h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140233550   endp

algn_140233571:                         ; DATA XREF: .rdata:0000000140053E18↑o
                                        ; .pdata:00000001400CB454↑o
                align 20h
; Exported entry 313. ExReleaseSpinLockExclusiveFromDpcLevel

; =============== S U B R O U T I N E =======================================


                public ExReleaseSpinLockExclusiveFromDpcLevel
ExReleaseSpinLockExclusiveFromDpcLevel proc near
                                        ; CODE XREF: sub_1402012D8+84↑p
                                        ; sub_14020260C+82↑p ...

; FUNCTION CHUNK AT 000000014041CA2E SIZE 00000034 BYTES

                sub     rsp, 28h
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14041CA2E
                mov     dword ptr [rcx], 0

loc_140233597:                          ; CODE XREF: ExReleaseSpinLockExclusiveFromDpcLevel+1E94B9↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14041CA3E

loc_1402335B0:                          ; CODE XREF: ExReleaseSpinLockExclusiveFromDpcLevel+1E94C2↓j
                                        ; ExReleaseSpinLockExclusiveFromDpcLevel+1E94D1↓j ...
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
ExReleaseSpinLockExclusiveFromDpcLevel endp

algn_1402335B6:                         ; DATA XREF: .rdata:0000000140053E34↑o
                                        ; .pdata:00000001400CB460↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_1402335C0   proc near               ; CODE XREF: sub_14026B8A4+9E↓p
                                        ; sub_14065C7F8:loc_14065C836↓p ...

var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = qword ptr -0D0h
var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = dword ptr -0A8h
var_A4          = dword ptr -0A4h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = xmmword ptr -78h
var_68          = xmmword ptr -68h
var_58          = xmmword ptr -58h
arg_0           = qword ptr  10h
arg_8           = qword ptr  18h
arg_10          = dword ptr  20h
arg_18          = dword ptr  28h

                mov     [rsp-8+arg_10], r8d
                mov     [rsp-8+arg_8], rdx
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-1Fh]
                sub     rsp, 0C8h
                mov     r15, rcx
                xor     r12d, r12d
                xorps   xmm0, xmm0
                mov     [rbp+57h+arg_18], r12d
                movups  [rbp+57h+var_78], xmm0
                mov     ebx, r12d
                mov     r13d, r12d
                movups  [rbp+57h+var_68], xmm0
                lea     edx, [r12+40h]
                movups  [rbp+57h+var_58], xmm0
                mov     rsi, gs:188h
                movzx   ecx, byte ptr [rcx+20h]
                mov     eax, [r15+18h]
                shl     rcx, 20h
                mov     rdi, [rsi+0B8h]
                or      rcx, rax
                mov     eax, [r15+1Ch]
                shl     rcx, 0Ch
                mov     [rbp+57h+var_B8], rcx
                movzx   ecx, byte ptr [r15+21h]
                lea     r14, [rdi+680h]
                shl     rcx, 20h
                or      rcx, rax
                mov     [rbp+57h+var_98], rsi
                mov     eax, [r15+30h]
                shl     rcx, 0Ch
                or      rcx, 0FFFh
                mov     [rbp+57h+var_C0], rdi
                mov     [rbp+57h+var_A0], r14
                mov     [rbp+57h+var_88], r12
                mov     [rbp+57h+var_90], r12
                mov     [rbp+57h+var_B0], rcx
                bt      eax, 14h
                jnb     short loc_140233683
                bt      eax, 16h
                jb      short loc_14023368F
                and     eax, 0C0000h
                cmp     eax, 80000h
                jnb     short loc_14023368F

loc_140233683:                          ; CODE XREF: sub_1402335C0+AF↑j
                mov     rcx, r15
                call    sub_1402342C0
                test    eax, eax
                jz      short loc_140233691

loc_14023368F:                          ; CODE XREF: sub_1402335C0+B5↑j
                                        ; sub_1402335C0+C1↑j
                mov     ebx, edx

loc_140233691:                          ; CODE XREF: sub_1402335C0+CD↑j
                mov     eax, [r15+30h]
                bt      eax, 14h
                jb      short loc_1402336B0
                mov     rcx, [r15+80h]
                test    rcx, rcx
                jz      short loc_1402336B0
                call    PsDereferenceSiloContext
                mov     eax, [r15+30h]

loc_1402336B0:                          ; CODE XREF: sub_1402335C0+D9↑j
                                        ; sub_1402335C0+E5↑j
                mov     ecx, eax
                bt      eax, 14h
                jnb     short loc_1402336D3
                bt      eax, 18h
                jb      short loc_1402336D3
                bt      eax, 19h
                jnb     short loc_1402336D3
                mov     rdx, r15
                mov     rcx, rdi
                call    sub_1409B2D20
                mov     ecx, [r15+30h]

loc_1402336D3:                          ; CODE XREF: sub_1402335C0+F6↑j
                                        ; sub_1402335C0+FC↑j ...
                and     ecx, 70h
                cmp     cl, 30h ; '0'
                jnz     short loc_1402336E7
                mov     rcx, r15
                call    sub_1408D7B2C
                mov     qword ptr [rbp+57h+var_58], rax

loc_1402336E7:                          ; CODE XREF: sub_1402335C0+119↑j
                mov     ecx, [r15+34h]
                movzx   eax, byte ptr [r15+22h]
                btr     ecx, 1Fh
                shl     rax, 1Fh
                or      rcx, rax
                mov     rax, 7FFFFFFFDh
                cmp     rcx, rax
                jnz     short loc_140233715
                cmp     qword ptr [r15+10h], 0FFFFFFFFFFFFFFFEh
                jnz     short loc_140233715
                bts     ebx, 7

loc_140233715:                          ; CODE XREF: sub_1402335C0+148↑j
                                        ; sub_1402335C0+14F↑j
                dec     word ptr [rsi+1E6h]
                lea     rcx, [rdi+4D0h]
                xor     edx, edx
                mov     [rbp+57h+var_80], rcx
                call    ExAcquirePushLockExclusiveEx
                movzx   eax, byte ptr [r14+0B8h]
                and     al, 7
                cmp     al, 2
                jnz     short loc_140233745
                lea     r14, unk_140C4F600
                jmp     short loc_14023374C
; ---------------------------------------------------------------------------

loc_140233745:                          ; CODE XREF: sub_1402335C0+17A↑j
                add     r14, 0C0h

loc_14023374C:                          ; CODE XREF: sub_1402335C0+183↑j
                mov     rsi, cr8
                mov     eax, 2
                mov     cr8, rax
                lea     rdi, [rax-3]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14023379B
                test    al, 1
                jz      short loc_14023379B
                cmp     sil, 0Fh
                ja      short loc_14023379B
                mov     rax, gs:20h
                mov     rdx, rdi
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_14023379B:                          ; CODE XREF: sub_1402335C0+1A5↑j
                                        ; sub_1402335C0+1A9↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                movzx   edx, sil
                mov     rcx, r14
                jz      short loc_1402337B2
                call    sub_1405B5E68
                jmp     short loc_1402337B7
; ---------------------------------------------------------------------------

loc_1402337B2:                          ; CODE XREF: sub_1402335C0+1E9↑j
                call    sub_140234420

loc_1402337B7:                          ; CODE XREF: sub_1402335C0+1F0↑j
                mov     edx, 2
                mov     [r14+4], r12d
                mov     rcx, r15
                lea     r8d, [rdx-1]
                call    sub_140268880
                mov     rcx, [rbp+57h+var_A0]
                movzx   edx, sil
                call    sub_140234180
                mov     rsi, [rbp+57h+var_80]
                mov     rax, rdi
                lock xadd [rsi], rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_1402337F3
                mov     rcx, rsi
                call    ExfTryToWakePushLock

loc_1402337F3:                          ; CODE XREF: sub_1402335C0+229↑j
                mov     rcx, rsi
                call    sub_140243660
                mov     rcx, [rbp+57h+var_98]
                add     word ptr [rcx+1E6h], 1
                jnz     short loc_14023381A
                lea     rax, [rcx+98h]
                cmp     [rax], rax
                jz      short loc_14023381A
                call    KiCheckForKernelApcDelivery

loc_14023381A:                          ; CODE XREF: sub_1402335C0+247↑j
                                        ; sub_1402335C0+253↑j
                mov     ecx, [r15+30h]
                bt      ecx, 14h
                jnb     short loc_14023387D
                mov     eax, ecx
                mov     edx, r12d
                and     eax, 70h
                cmp     al, 30h ; '0'
                jnz     short loc_140233843
                bt      ecx, 18h
                jb      short loc_14023383C
                bt      ecx, 19h
                jb      short loc_140233843

loc_14023383C:                          ; CODE XREF: sub_1402335C0+274↑j
                mov     edx, 10h
                jmp     short loc_14023385C
; ---------------------------------------------------------------------------

loc_140233843:                          ; CODE XREF: sub_1402335C0+26E↑j
                                        ; sub_1402335C0+27A↑j
                mov     eax, ecx
                and     al, 70h
                cmp     al, 10h
                jnz     short loc_14023385C
                bt      ecx, 1Bh
                mov     edx, 20h ; ' '
                mov     eax, 40h ; '@'
                cmovb   edx, eax

loc_14023385C:                          ; CODE XREF: sub_1402335C0+281↑j
                                        ; sub_1402335C0+289↑j
                mov     eax, ecx
                and     al, 70h
                cmp     al, 40h ; '@'
                jnz     short loc_14023386B
                mov     edx, 8
                jmp     short loc_140233892
; ---------------------------------------------------------------------------

loc_14023386B:                          ; CODE XREF: sub_1402335C0+2A2↑j
                bt      ecx, 18h
                jb      short loc_140233892
                bt      ecx, 1Ah
                jnb     short loc_140233892
                bts     edx, 0Ah
                jmp     short loc_140233892
; ---------------------------------------------------------------------------

loc_14023387D:                          ; CODE XREF: sub_1402335C0+262↑j
                mov     eax, [rbp+57h+arg_10]
                mov     edx, eax
                sar     edx, 1Fh
                and     edx, 1
                add     edx, 2
                test    al, 1
                jz      short loc_140233892
                or      edx, 4

loc_140233892:                          ; CODE XREF: sub_1402335C0+2A9↑j
                                        ; sub_1402335C0+2AF↑j ...
                bt      ecx, 14h
                jnb     short loc_1402338AC
                bt      ecx, 16h
                jb      short loc_1402338B8
                and     ecx, 0C0000h
                cmp     ecx, 80000h
                jnb     short loc_1402338B8

loc_1402338AC:                          ; CODE XREF: sub_1402335C0+2D6↑j
                mov     rcx, r15
                call    sub_1402342C0
                test    eax, eax
                jz      short loc_1402338BC

loc_1402338B8:                          ; CODE XREF: sub_1402335C0+2DC↑j
                                        ; sub_1402335C0+2EA↑j
                bts     edx, 0Bh

loc_1402338BC:                          ; CODE XREF: sub_1402335C0+2F6↑j
                mov     eax, [r15+30h]
                mov     esi, edx
                bts     esi, 0Ch
                and     eax, 1100000h
                cmp     eax, 1100000h
                mov     r14d, ebx
                cmovnz  esi, edx
                cmp     ebx, 80h
                jnb     loc_1402339A1
                mov     rax, gs:188h
                lea     rdx, [rbp+57h+var_78]
                mov     r9, [rbp+57h+var_B0]
                mov     r8, [rbp+57h+var_B8]
                mov     [rsp+100h+var_D0], rdx
                mov     dl, 11h
                mov     r14, [rax+0B8h]
                mov     eax, esi
                bts     eax, 7
                mov     dword ptr [rsp+100h+var_D8], eax
                mov     dword ptr [rsp+100h+var_E0], r12d
                lea     rcx, [r14+680h]
                call    sub_140289B60
                mov     rax, qword ptr [rbp+57h+var_68+8]
                test    rax, rax
                jz      short loc_140233935
                neg     rax
                lock xadd [r14+4F8h], rax

loc_140233935:                          ; CODE XREF: sub_1402335C0+367↑j
                bt      esi, 0Bh
                jnb     short loc_14023399E
                mov     r14, qword ptr [rbp+57h+var_58+8]
                test    r14, r14
                jz      short loc_14023399E
                mov     rcx, r15
                mov     qword ptr [rbp+57h+var_58+8], r12
                call    sub_14026B69C
                test    eax, eax
                jnz     short loc_14023399E
                mov     ecx, [r15+34h]
                mov     rdx, r14
                movzx   eax, byte ptr [r15+22h]
                mov     r8d, ecx
                shl     rax, 1Fh
                btr     r8d, 1Fh
                or      r8, rax
                sub     r8, r14
                mov     eax, r8d
                shr     r8, 1Fh
                xor     eax, ecx
                btr     eax, 1Fh
                xor     eax, ecx
                mov     rcx, [rbp+57h+var_C0]
                mov     [r15+34h], eax
                mov     [r15+22h], r8b
                call    sub_14026B7D0
                mov     rcx, [rbp+57h+var_C0]
                mov     rdx, r14
                call    sub_1408D8DA0

loc_14023399E:                          ; CODE XREF: sub_1402335C0+379↑j
                                        ; sub_1402335C0+382↑j ...
                mov     r14d, ebx

loc_1402339A1:                          ; CODE XREF: sub_1402335C0+31C↑j
                test    sil, 2
                jz      loc_140233AE4
                mov     rax, [r15+48h]
                mov     ecx, [r15+30h]
                mov     r13, [rax]
                mov     eax, ecx
                and     al, 70h
                cmp     al, 20h ; ' '
                jz      short loc_140233A3C
                cmp     [r13+40h], r12
                jz      loc_140233A49
                mov     eax, ecx
                and     eax, 0F80h
                cmp     eax, 200h
                jz      short loc_1402339E4
                and     ecx, 0F80h
                cmp     ecx, 300h
                jnz     short loc_1402339E9

loc_1402339E4:                          ; CODE XREF: sub_1402335C0+414↑j
                lock dec dword ptr [r13+5Ch]

loc_1402339E9:                          ; CODE XREF: sub_1402335C0+422↑j
                movzx   edx, byte ptr [r15+20h]
                lea     r9, [rbp+57h+var_88]
                mov     eax, [r15+18h]
                xor     r8d, r8d
                shl     rdx, 20h
                mov     rcx, r15
                or      rdx, rax
                call    sub_140283270
                mov     eax, [r15+40h]
                lea     r9, [rbp+57h+var_90]
                movzx   edx, byte ptr [r15+21h]
                mov     ebx, r14d
                or      ebx, 20h
                mov     rcx, r15
                and     eax, 1000000h
                mov     eax, [r15+1Ch]
                cmovz   ebx, r14d
                shl     rdx, 20h
                or      rdx, rax
                xor     r8d, r8d
                call    sub_140283270
                jmp     short loc_140233A49
; ---------------------------------------------------------------------------

loc_140233A3C:                          ; CODE XREF: sub_1402335C0+3FC↑j
                mov     eax, [r15+40h]
                bt      eax, 18h
                jnb     short loc_140233A49
                or      ebx, 18h

loc_140233A49:                          ; CODE XREF: sub_1402335C0+402↑j
                                        ; sub_1402335C0+47A↑j ...
                mov     esi, ebx
                test    bl, 8
                jnz     loc_140233AE4
                mov     eax, [r15+30h]
                and     eax, 70h
                cmp     al, 50h ; 'P'
                jz      short loc_140233AD2
                mov     rcx, [rbp+57h+var_A0]
                call    sub_1402A8F70
                mov     ecx, [r15+30h]
                mov     eax, ecx
                and     al, 70h
                cmp     al, 20h ; ' '
                jnz     short loc_140233A88
                mov     eax, [r13+38h]
                or      ebx, 2
                and     eax, 4000000h
                cmovz   ebx, esi
                or      ebx, 4
                jmp     short loc_140233AD2
; ---------------------------------------------------------------------------

loc_140233A88:                          ; CODE XREF: sub_1402335C0+4B2↑j
                bt      ecx, 14h
                jb      short loc_140233AD2
                cmp     [r13+40h], r12
                jnz     short loc_140233AD2
                movzx   edx, byte ptr [r15+20h]
                lea     r9, [rbp+57h+var_88]
                mov     eax, [r15+18h]
                xor     r8d, r8d
                shl     rdx, 20h
                mov     rcx, r15
                or      rdx, rax
                call    sub_140283270
                movzx   edx, byte ptr [r15+21h]
                lea     r9, [rbp+57h+var_90]
                mov     eax, [r15+1Ch]
                xor     r8d, r8d
                shl     rdx, 20h
                mov     rcx, r15
                or      rdx, rax
                call    sub_140283270

loc_140233AD2:                          ; CODE XREF: sub_1402335C0+49D↑j
                                        ; sub_1402335C0+4C6↑j ...
                mov     rax, [r15+78h]
                mov     ecx, ebx
                or      ebx, 1
                test    rax, rax
                cmovns  ebx, ecx
                or      ebx, 8

loc_140233AE4:                          ; CODE XREF: sub_1402335C0+3E5↑j
                                        ; sub_1402335C0+48E↑j
                mov     r12, gs:188h
                dec     word ptr [r12+1E6h]
                mov     rcx, [rbp+57h+var_C0]
                xor     edx, edx
                mov     [rbp+57h+var_A4], edx
                add     rcx, 4C8h
                mov     rsi, gs:188h
                mov     [rbp+57h+arg_0], rcx
                dec     word ptr [rsi+1E6h]
                inc     byte ptr [rsi+31Ah]
                cmp     byte ptr [rsi+31Ah], 1
                jz      short loc_140233B37
                lock bts dword ptr [rsi+78h], 10h
                mov     r14d, edx
                jmp     loc_140233BEA
; ---------------------------------------------------------------------------

loc_140233B37:                          ; CODE XREF: sub_1402335C0+567↑j
                movzx   eax, byte ptr [rsi+318h]
                mov     [rbp+57h+var_A8], edx
                test    al, al
                jnz     short loc_140233B5B
                cmp     [rsi+366h], dl
                jz      short loc_140233B95
                mov     eax, edx
                xchg    al, [rsi+366h]
                or      al, [rsi+318h]

loc_140233B5B:                          ; CODE XREF: sub_1402335C0+583↑j
                movzx   edx, al
                mov     eax, 1
                bsf     ecx, edx
                shl     al, cl
                not     al
                mov     [rbp+57h+var_A8], ecx
                and     al, dl
                lea     r14, [rcx+rcx*2]
                mov     [rsi+318h], al
                shl     r14, 5
                add     r14, [rsi+320h]

loc_140233B84:                          ; CODE XREF: sub_1402335C0+5EF↓j
                mov     rcx, [rbp+57h+arg_0]

loc_140233B88:                          ; CODE XREF: sub_1402335C0+5E2↓j
                test    r14, r14
                jnz     short loc_140233BB1
                lock bts dword ptr [rsi+78h], 10h
                jmp     short loc_140233BEA
; ---------------------------------------------------------------------------

loc_140233B95:                          ; CODE XREF: sub_1402335C0+58B↑j
                test    dword ptr cs:xmmword_140CFC480+4, 200h
                mov     r14, rdx
                jz      short loc_140233B88
                mov     rdx, rcx
                mov     rcx, rsi
                call    sub_1403F8778
                jmp     short loc_140233B84
; ---------------------------------------------------------------------------

loc_140233BB1:                          ; CODE XREF: sub_1402335C0+5CB↑j
                call    sub_140245330
                cmp     eax, 1
                jnz     short loc_140233BC9
                mov     rcx, [rsi+0B8h]
                call    sub_140245840
                jmp     short loc_140233BCE
; ---------------------------------------------------------------------------

loc_140233BC9:                          ; CODE XREF: sub_1402335C0+5F9↑j
                mov     eax, 0FFFFFFFFh

loc_140233BCE:                          ; CODE XREF: sub_1402335C0+607↑j
                mov     [r14+28h], eax
                mov     rcx, [rbp+57h+arg_0]
                mov     rdx, 7FFFFFFFFFFFFFFCh
                mov     rax, rcx
                and     rax, rdx
                mov     [r14+20h], rax

loc_140233BEA:                          ; CODE XREF: sub_1402335C0+572↑j
                                        ; sub_1402335C0+5D3↑j
                dec     byte ptr [rsi+31Ah]
                lea     r8, [rbp+57h+var_A4]
                mov     rdx, rcx
                mov     rcx, rsi
                call    sub_1402456E0
                add     word ptr [rsi+1E6h], 1
                jnz     short loc_140233C1A
                lea     rax, [rsi+98h]
                cmp     [rax], rax
                jz      short loc_140233C1A
                call    KiCheckForKernelApcDelivery

loc_140233C1A:                          ; CODE XREF: sub_1402335C0+647↑j
                                        ; sub_1402335C0+653↑j
                mov     rsi, [rbp+57h+arg_0]
                lock bts qword ptr [rsi], 0
                jb      short loc_140233C37
                test    r14, r14
                jz      short loc_140233C30
                or      byte ptr [r14+1Ah], 1

loc_140233C30:                          ; CODE XREF: sub_1402335C0+669↑j
                mov     eax, 1
                jmp     short loc_140233C49
; ---------------------------------------------------------------------------

loc_140233C37:                          ; CODE XREF: sub_1402335C0+664↑j
                test    r14, r14
                jz      short loc_140233C47
                mov     rdx, r14
                mov     rcx, rsi
                call    sub_14031D1B0

loc_140233C47:                          ; CODE XREF: sub_1402335C0+67A↑j
                xor     eax, eax

loc_140233C49:                          ; CODE XREF: sub_1402335C0+675↑j
                test    eax, eax
                jz      short loc_140233C58
                or      byte ptr [r12+518h], 1
                jmp     short loc_140233CA4
; ---------------------------------------------------------------------------

loc_140233C58:                          ; CODE XREF: sub_1402335C0+68B↑j
                mov     rdx, r15
                mov     rcx, r12
                call    sub_140266958
                dec     word ptr [r12+1E6h]
                xor     edx, edx
                mov     rcx, rsi
                call    ExAcquirePushLockExclusiveEx
                or      byte ptr [r12+518h], 1
                dec     word ptr [r12+1E6h]
                lea     rcx, [r15+28h]
                xor     edx, edx
                call    ExAcquirePushLockExclusiveEx
                or      byte ptr [r12+518h], 80h
                mov     rcx, r12
                call    sub_140245770

loc_140233CA4:                          ; CODE XREF: sub_1402335C0+696↑j
                cmp     ebx, 80h
                jnb     loc_140233F29
                mov     rax, [rbp+57h+var_98]
                dec     word ptr [rax+1E6h]
                mov     rcx, [rbp+57h+var_80]
                xor     edx, edx
                call    ExAcquirePushLockExclusiveEx
                mov     rcx, [rbp+57h+var_A0]
                lea     r14, unk_140C4F600
                movzx   eax, byte ptr [rcx+0B8h]
                and     al, 7
                cmp     al, 2
                jz      short loc_140233CE5
                lea     r14, [rcx+0C0h]

loc_140233CE5:                          ; CODE XREF: sub_1402335C0+71C↑j
                mov     rsi, cr8
                mov     [rbp+57h+arg_0], rsi
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140233D3A
                test    al, 1
                jz      short loc_140233D3A
                cmp     sil, 0Fh
                ja      short loc_140233D3A
                mov     rax, gs:20h
                mov     edx, 1
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                dec     edx
                not     edx
                and     edx, 4
                mov     r8d, [r9+14h]
                or      edx, r8d
                mov     [r9+14h], edx

loc_140233D3A:                          ; CODE XREF: sub_1402335C0+73E↑j
                                        ; sub_1402335C0+742↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                movzx   edx, sil
                mov     rcx, r14
                jz      short loc_140233D51
                call    sub_1405B5E68
                jmp     short loc_140233D56
; ---------------------------------------------------------------------------

loc_140233D51:                          ; CODE XREF: sub_1402335C0+788↑j
                call    sub_140234420

loc_140233D56:                          ; CODE XREF: sub_1402335C0+78F↑j
                mov     rdx, [rbp+57h+var_B0]
                lea     r9, [rbp+57h+arg_18]
                mov     rcx, [rbp+57h+var_B8]
                movzx   r8d, sil
                mov     dword ptr [r14+4], 0
                call    sub_1402EBB60
                mov     r14, [r15]
                mov     rax, r15
                test    r14, r14
                jz      short loc_140233D9E
                mov     rax, [r14+8]
                test    rax, rax
                jz      short loc_140233DBB
                nop     word ptr [rax+rax+00000000h]

loc_140233D90:                          ; CODE XREF: sub_1402335C0+7DA↓j
                mov     r14, rax
                mov     rax, [rax+8]
                test    rax, rax
                jnz     short loc_140233D90
                jmp     short loc_140233DBB
; ---------------------------------------------------------------------------

loc_140233D9E:                          ; CODE XREF: sub_1402335C0+7BC↑j
                mov     r14, [r15+10h]
                and     r14, 0FFFFFFFFFFFFFFFCh
                jz      short loc_140233DBB

loc_140233DA8:                          ; CODE XREF: sub_1402335C0+7F9↓j
                cmp     [r14+8], rax
                jz      short loc_140233DBB
                mov     rax, r14
                mov     r14, [r14+10h]
                and     r14, 0FFFFFFFFFFFFFFFCh
                jnz     short loc_140233DA8

loc_140233DBB:                          ; CODE XREF: sub_1402335C0+7C5↑j
                                        ; sub_1402335C0+7DC↑j ...
                mov     rsi, [r15+8]
                mov     rax, r15
                test    rsi, rsi
                jz      short loc_140233DDD
                mov     rax, [rsi]
                test    rax, rax
                jz      short loc_140233DF9
                nop

loc_140233DD0:                          ; CODE XREF: sub_1402335C0+819↓j
                mov     rsi, rax
                mov     rax, [rax]
                test    rax, rax
                jnz     short loc_140233DD0
                jmp     short loc_140233DF9
; ---------------------------------------------------------------------------

loc_140233DDD:                          ; CODE XREF: sub_1402335C0+805↑j
                mov     rsi, [r15+10h]
                and     rsi, 0FFFFFFFFFFFFFFFCh
                jz      short loc_140233DF9

loc_140233DE7:                          ; CODE XREF: sub_1402335C0+837↓j
                cmp     [rsi], rax
                jz      short loc_140233DF9
                mov     rax, rsi
                mov     rsi, [rsi+10h]
                and     rsi, 0FFFFFFFFFFFFFFFCh
                jnz     short loc_140233DE7

loc_140233DF9:                          ; CODE XREF: sub_1402335C0+80D↑j
                                        ; sub_1402335C0+81B↑j ...
                mov     r12, [rbp+57h+var_C0]
                mov     rdx, r15
                lea     rcx, [r12+7D8h]
                call    RtlAvlRemoveNode
                mov     rax, r12
                cmp     [rax+7E0h], r15
                jnz     short loc_140233E2B
                mov     rax, [r12+7D8h]
                mov     [r12+7E0h], rax
                jmp     short loc_140233E2E
; ---------------------------------------------------------------------------

loc_140233E2B:                          ; CODE XREF: sub_1402335C0+857↑j
                mov     r12, rax

loc_140233E2E:                          ; CODE XREF: sub_1402335C0+869↑j
                dec     qword ptr [r12+7E8h]
                mov     rcx, r15
                mov     qword ptr [r15+10h], 0FFFFFFFFFFFFFFFEh
                call    sub_14034027C
                test    eax, eax
                jz      short loc_140233E6E
                mov     eax, [r15+30h]
                lea     rcx, qword_14002DE90
                shr     rax, 12h
                and     eax, 3
                cmp     qword ptr [rcx+rax*8], 200h
                jb      short loc_140233E6E
                dec     dword ptr [r12+85Ch]

loc_140233E6E:                          ; CODE XREF: sub_1402335C0+888↑j
                                        ; sub_1402335C0+8A4↑j
                movzx   edx, byte ptr [rbp+57h+arg_0]
                lea     rcx, [r12+680h]
                call    sub_140234180
                cmp     [rbp+57h+arg_8], 0
                jnz     short loc_140233E99
                mov     rdx, [rbp+57h+var_B0]
                mov     r9, rsi
                mov     rcx, [rbp+57h+var_B8]
                mov     r8, r14
                call    sub_1402EB770

loc_140233E99:                          ; CODE XREF: sub_1402335C0+8C4↑j
                mov     rdx, [rbp+57h+var_B0]
                lea     rax, [rbp+57h+arg_18]
                mov     [rsp+100h+var_D0], rax
                mov     r9, r14
                mov     r14, [rbp+57h+var_B8]
                mov     r8, r12
                mov     [rsp+100h+var_D8], r15
                mov     rcx, r14
                mov     [rsp+100h+var_E0], rsi
                call    sub_14065C850
                mov     rax, rdi
                lock xadd [r12+4D0h], rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_140233EE2
                lea     rcx, [r12+4D0h]
                call    ExfTryToWakePushLock

loc_140233EE2:                          ; CODE XREF: sub_1402335C0+913↑j
                lea     rcx, [r12+4D0h]
                call    sub_140243660
                mov     rcx, [rbp+57h+var_98]
                add     word ptr [rcx+1E6h], 1
                jnz     short loc_140233F0E
                lea     rax, [rcx+98h]
                cmp     [rax], rax
                jz      short loc_140233F0E
                call    KiCheckForKernelApcDelivery

loc_140233F0E:                          ; CODE XREF: sub_1402335C0+93B↑j
                                        ; sub_1402335C0+947↑j
                mov     rsi, [rbp+57h+arg_8]
                test    rsi, rsi
                jz      short loc_140233F31
                mov     rcx, rsi
                call    sub_14055553C
                mov     rcx, rsi
                call    sub_1408DB174
                jmp     short loc_140233F31
; ---------------------------------------------------------------------------

loc_140233F29:                          ; CODE XREF: sub_1402335C0+6EA↑j
                mov     r12, [rbp+57h+var_C0]
                mov     r14, [rbp+57h+var_B8]

loc_140233F31:                          ; CODE XREF: sub_1402335C0+955↑j
                                        ; sub_1402335C0+967↑j
                mov     rax, qword ptr [rbp+57h+var_78+8]
                mov     [r15+8], rax
                mov     rax, qword ptr [rbp+57h+var_68]
                mov     [r15], rax
                test    bl, 40h
                jz      short loc_140233F86
                mov     eax, dword ptr cs:xmmword_140CFC480+4
                test    al, 1
                jz      short loc_140233F86
                mov     eax, [r15+1Ch]
                mov     r8d, 1Ah
                movzx   r9d, byte ptr [r15+21h]
                mov     rdx, r12
                movzx   ecx, byte ptr [r15+20h]
                shl     r9, 20h
                or      r9, rax
                shl     rcx, 20h
                mov     eax, [r15+18h]
                or      rcx, rax
                sub     r9, rcx
                mov     rcx, r14
                inc     r9
                call    sub_1405317EC

loc_140233F86:                          ; CODE XREF: sub_1402335C0+983↑j
                                        ; sub_1402335C0+98D↑j
                test    bl, 1
                jz      short loc_140233F96
                mov     rdx, r13
                mov     rcx, r15
                call    sub_140360B18

loc_140233F96:                          ; CODE XREF: sub_1402335C0+9C9↑j
                test    bl, 8
                jz      loc_140234067
                test    bl, 2
                jz      short loc_140233FB6
                mov     rcx, r12
                call    sub_140245840
                mov     edx, eax
                mov     rcx, r13
                call    sub_1406EB768

loc_140233FB6:                          ; CODE XREF: sub_1402335C0+9E2↑j
                test    bl, 4
                jz      short loc_140233FD4
                xor     edx, edx
                mov     rcx, r13
                call    sub_1402A8C1C
                test    eax, 0FFFFFFFDh
                jnz     short loc_140233FD4
                mov     rcx, r13
                call    sub_14052AAF4

loc_140233FD4:                          ; CODE XREF: sub_1402335C0+9F9↑j
                                        ; sub_1402335C0+A0A↑j
                xor     r8d, r8d
                mov     rdx, r12
                mov     rcx, r13
                call    sub_14065A620
                mov     rax, [r15+48h]
                lea     r12, [r15+60h]
                mov     rsi, [rax]
                mov     rax, gs:188h
                dec     word ptr [rax+1E6h]
                lea     r14, [rsi+68h]
                xor     edx, edx
                mov     rcx, r14
                call    ExAcquirePushLockExclusiveEx
                test    dword ptr [rsi+38h], 400h
                jnz     short loc_140234037
                mov     rcx, [r12]
                mov     rax, [r12+8]
                cmp     [rcx+8], r12
                jnz     loc_1402340BF
                cmp     [rax], r12
                jnz     loc_1402340BF
                mov     [rax], rcx
                mov     [rcx+8], rax

loc_140234037:                          ; CODE XREF: sub_1402335C0+A52↑j
                mov     rsi, gs:188h
                lock xadd [r14], rdi
                and     dil, 6
                cmp     dil, 2
                jnz     short loc_140234057
                mov     rcx, r14
                call    ExfTryToWakePushLock

loc_140234057:                          ; CODE XREF: sub_1402335C0+A8D↑j
                mov     rcx, r14
                call    sub_140243660
                mov     rcx, rsi
                call    sub_140245770

loc_140234067:                          ; CODE XREF: sub_1402335C0+9D9↑j
                xor     r12d, r12d
                mov     eax, r12d
                cmp     [rbp+57h+arg_8], rax
                jnz     short loc_14023407B
                cmp     ebx, 80h
                jb      short loc_140234080

loc_14023407B:                          ; CODE XREF: sub_1402335C0+AB1↑j
                mov     eax, 1

loc_140234080:                          ; CODE XREF: sub_1402335C0+AB9↑j
                mov     ecx, [rbp+57h+arg_10]
                mov     r9d, eax
                mov     r8, [rbp+57h+var_B0]
                or      r9d, 2
                mov     rdx, [rbp+57h+var_B8]
                and     ecx, 40000000h
                mov     rcx, r15
                cmovz   r9d, eax
                call    sub_14026A220
                test    r13, r13
                jz      loc_14023415A
                test    bl, 10h
                jz      short loc_1402340C6
                mov     rcx, r13
                call    sub_14033F130
                jmp     loc_14023415A
; ---------------------------------------------------------------------------

loc_1402340BF:                          ; CODE XREF: sub_1402335C0+A61↑j
                                        ; sub_1402335C0+A6A↑j
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
; ---------------------------------------------------------------------------

loc_1402340C6:                          ; CODE XREF: sub_1402335C0+AF0↑j
                mov     rdi, [rbp+57h+var_88]
                mov     rsi, [rbp+57h+var_90]
                test    rdi, rdi
                jz      short loc_1402340E3
                test    bl, 20h
                jz      short loc_1402340E3
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_1405405E0

loc_1402340E3:                          ; CODE XREF: sub_1402335C0+B11↑j
                                        ; sub_1402335C0+B16↑j
                mov     rbx, r12
                lea     rcx, [r13+48h]
                cmp     [r13+40h], rbx
                mov     r14d, r12d
                setnz   r14b
                call    ExAcquireSpinLockExclusive
                movzx   r15d, al
                test    rdi, rdi
                jz      short loc_140234117
                mov     r8d, 8
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_140267270
                mov     r12, rax

loc_140234117:                          ; CODE XREF: sub_1402335C0+B41↑j
                dec     qword ptr [r13+28h]
                dec     qword ptr [r13+30h]
                test    r12, r12
                jz      short loc_14023413B
                movzx   r8d, word ptr [r13+3Ch]
                mov     rcx, cs:qword_140C4E4C8
                and     r8d, 3FFh
                mov     rbx, [rcx+r8*8]

loc_14023413B:                          ; CODE XREF: sub_1402335C0+B62↑j
                movzx   edx, r15b
                mov     rcx, r13
                call    sub_140266E30
                test    r12, r12
                jz      short loc_14023415A
                mov     r8, r12
                mov     edx, r14d
                mov     rcx, rbx
                call    sub_1405552EC

loc_14023415A:                          ; CODE XREF: sub_1402335C0+AE7↑j
                                        ; sub_1402335C0+AFA↑j ...
                add     rsp, 0C8h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_1402335C0   endp

algn_14023416F:                         ; DATA XREF: .pdata:00000001400CB46C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140234180   proc near               ; CODE XREF: sub_140201880+92↑p
                                        ; sub_140208A24+93↑p ...

var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014042C586 SIZE 000000C2 BYTES

                push    rbp
                push    rdi
                sub     rsp, 28h
                mov     eax, [rcx+0B8h]
                mov     rdi, rcx

loc_140234190:                          ; DATA XREF: .rdata:0000000140053E78↑o
                                        ; .rdata:0000000140053E8C↑o ...
                mov     [rsp+38h+arg_0], rbx
                mov     [rsp+38h+arg_10], rsi
                xor     esi, esi
                mov     [rsp+38h+var_18], r14
                xor     r14d, r14d
                mov     [rsp+38h+arg_8], eax
                and     al, 7
                movzx   ebp, dl
                cmp     al, 2
                jz      loc_1402342A6
                lea     rbx, [rcx+0C0h]

loc_1402341BC:                          ; CODE XREF: sub_140234180+12D↓j
                test    al, al
                jnz     short loc_1402341EA
                cmp     [rcx+10h], rsi
                jz      short loc_1402341EA
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+690h]
                cmp     [rax+170h], si
                jnz     loc_140234299

loc_1402341EA:                          ; CODE XREF: sub_140234180+3E↑j
                                        ; sub_140234180+44↑j ...
                mov     rcx, gs:188h
                test    dword ptr [rcx+510h], 400000h
                jnz     loc_14042C586

loc_140234203:                          ; CODE XREF: sub_140234180+1F840B↓j
                mov     edx, 2
                mov     rcx, rdi
                call    sub_140226A50
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14042C590
                mov     dword ptr [rbx], 0

loc_140234223:                          ; CODE XREF: sub_140234180+1F841E↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042C5A3

loc_14023423C:                          ; CODE XREF: sub_140234180+1F8427↓j
                                        ; sub_140234180+1F8436↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C5C7

loc_14023424A:                          ; CODE XREF: sub_140234180+1F8449↓j
                                        ; sub_140234180+1F8455↓j ...
                mov     cr8, rbp
                test    r14, r14
                jnz     loc_14042C62E

loc_140234257:                          ; CODE XREF: sub_140234180+1F84C3↓j
                mov     r14, [rsp+38h+var_18]
                test    esi, esi
                mov     rsi, [rsp+38h+arg_10]
                mov     rbx, [rsp+38h+arg_0]
                jnz     short loc_14023427B

loc_14023426A:                          ; DATA XREF: .pdata:00000001400CB484↑o
                                        ; .pdata:00000001400CB490↑o
                movzx   eax, byte ptr [rsp+38h+arg_8+3]
                test    al, 8
                jnz     short loc_140234283
                test    al, 4
                jnz     short loc_140234283
                test    al, 10h
                jnz     short loc_140234283

loc_14023427B:                          ; CODE XREF: sub_140234180+E8↑j
                                        ; sub_140234180+117↓j
                add     rsp, 28h
                pop     rdi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140234283:                          ; CODE XREF: sub_140234180+F1↑j
                                        ; sub_140234180+F5↑j ...
                mov     rcx, rdi
                call    sub_140231340
                movzx   edx, bpl
                mov     rcx, rdi
                call    sub_140226960
                jmp     short loc_14023427B
; ---------------------------------------------------------------------------

loc_140234299:                          ; CODE XREF: sub_140234180+64↑j
                                        ; DATA XREF: .pdata:00000001400CB490↑o ...
                call    sub_14055A2C0
                mov     r14, rax
                jmp     loc_1402341EA
; ---------------------------------------------------------------------------

loc_1402342A6:                          ; CODE XREF: sub_140234180+2F↑j
                lea     rbx, unk_140C4F600
                jmp     loc_1402341BC
sub_140234180   endp

; ---------------------------------------------------------------------------
algn_1402342B2:                         ; DATA XREF: .pdata:00000001400CB49C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402342C0   proc near               ; CODE XREF: sub_1402335C0+C6↑p
                                        ; sub_1402335C0+2EF↑p ...
                mov     eax, [rcx+30h]
                and     al, 70h
                cmp     al, 20h ; ' '
                jz      short loc_1402342CD

loc_1402342C9:                          ; CODE XREF: sub_1402342C0+14↓j
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402342CD:                          ; CODE XREF: sub_1402342C0+7↑j
                mov     eax, [rcx+40h]
                bt      eax, 18h
                jnb     short loc_1402342C9
                mov     eax, 1
                retn
sub_1402342C0   endp

; ---------------------------------------------------------------------------
                db 0CCh
byte_1402342DD  db 13h dup(0CCh)        ; DATA XREF: .pdata:00000001400CB4A8↑o
; Exported entry 243. ExInitializeResourceLite

; =============== S U B R O U T I N E =======================================


                public ExInitializeResourceLite
ExInitializeResourceLite proc near      ; CODE XREF: sub_14026F7FC+83↓p
                                        ; sub_14030D258+3E3↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014042C648 SIZE 00000162 BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r14
                sub     rsp, 20h
                xor     edx, edx
                mov     rbx, rcx
                lea     r8d, [rdx+68h]
                call    memset
                mov     [rbx+8], rbx
                xor     r14d, r14d
                mov     [rbx], rbx
                xorps   xmm0, xmm0
                movups  xmmword ptr [rbx+20h], xmm0
                mov     [rbx+60h], r14
                test    cs:NtGlobalFlag, 2000h
                jnz     loc_14042C648
                mov     eax, r14d

loc_14023433B:                          ; CODE XREF: ExInitializeResourceLite+1F83AC↓j
                mov     [rbx+58h], rax
                mov     rdi, cr8
                mov     eax, 2
                mov     cr8, rax
                lea     rsi, [rax-3]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C6A1

loc_14023435E:                          ; CODE XREF: ExInitializeResourceLite+1F83B3↓j
                                        ; ExInitializeResourceLite+1F83BD↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                lea     rcx, dword_140D230C0
                movzx   edx, dil
                jnz     loc_14042C6E2
                call    sub_140234420

loc_14023437B:                          ; CODE XREF: ExInitializeResourceLite+1F83F8↓j
                mov     rax, cs:qword_140C16958
                lea     rcx, qword_140C16950
                cmp     [rax], rcx
                jnz     loc_14042C6ED
                mov     [rbx], rcx
                mov     [rbx+8], rax
                mov     [rax], rbx
                test    byte ptr cs:xmmword_140CFC480+6, 1
                mov     cs:qword_140C16958, rbx
                jnz     loc_14042C6F4
                mov     cs:dword_140D230C0, r14d

loc_1402343B7:                          ; CODE XREF: ExInitializeResourceLite+1F8416↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042C70B

loc_1402343D0:                          ; CODE XREF: ExInitializeResourceLite+1F841F↓j
                                        ; ExInitializeResourceLite+1F842E↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C72F

loc_1402343DE:                          ; CODE XREF: ExInitializeResourceLite+1F8441↓j
                                        ; ExInitializeResourceLite+1F844D↓j ...
                movzx   eax, dil
                mov     cr8, rax
                inc     dword ptr gs:8658h
                test    dword ptr cs:xmmword_140CFC480+4, 20000h
                jnz     loc_14042C791

loc_1402343FE:                          ; CODE XREF: ExInitializeResourceLite+1F84B5↓j
                mov     rbx, [rsp+28h+arg_8]
                xor     eax, eax
                mov     rsi, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                db 0CCh
ExInitializeResourceLite endp

algn_140234417:                         ; DATA XREF: .rdata:0000000140053EEC↑o
                                        ; .pdata:00000001400CB4B4↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140234420   proc near               ; CODE XREF: sub_140233220+93↑p
                                        ; sub_1402335C0:loc_1402337B2↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014041CA62 SIZE 0000004E BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 20h
                mov     rsi, gs:20h
                mov     rdi, rcx
                xor     ebx, ebx
                movzx   ebp, dl
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14041CA62

loc_140234455:                          ; CODE XREF: sub_140234420+1E8646↓j
                                        ; sub_140234420+1E8655↓j ...
                lock bts dword ptr [rdi], 1Fh
                jb      short loc_140234484

loc_14023445C:                          ; CODE XREF: sub_140234420+82↓j
                mov     edx, [rdi]
                mov     ecx, edx
                btr     ecx, 1Eh
                cmp     ecx, 80000000h
                jnz     short loc_1402344A4

loc_14023446C:                          ; CODE XREF: sub_140234420+A5↓j
                mov     rbp, [rsp+28h+arg_8]
                mov     eax, ebx
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_10]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140234484:                          ; CODE XREF: sub_140234420+3A↑j
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14041CA89

loc_140234494:                          ; CODE XREF: sub_140234420+1E866D↓j
                                        ; sub_140234420+1E867C↓j ...
                movzx   edx, bpl
                mov     rcx, rdi
                call    sub_14028EAE0
                mov     ebx, eax
                jmp     short loc_14023445C
; ---------------------------------------------------------------------------

loc_1402344A4:                          ; CODE XREF: sub_140234420+4A↑j
                                        ; sub_140234420+A3↓j
                bt      edx, 1Eh
                jnb     short loc_1402344C7

loc_1402344AA:                          ; CODE XREF: sub_140234420+B5↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jz      short loc_1402344D9

loc_1402344B4:                          ; CODE XREF: sub_140234420+C1↓j
                                        ; sub_140234420+CA↓j
                pause

loc_1402344B6:                          ; CODE XREF: sub_140234420+D3↓j
                mov     edx, [rdi]

loc_1402344B8:                          ; CODE XREF: sub_140234420+B7↓j
                mov     eax, edx
                btr     eax, 1Eh
                cmp     eax, 80000000h
                jnz     short loc_1402344A4
                jmp     short loc_14023446C
; ---------------------------------------------------------------------------

loc_1402344C7:                          ; CODE XREF: sub_140234420+88↑j
                mov     ecx, edx
                mov     eax, edx
                bts     ecx, 1Eh
                lock cmpxchg [rdi], ecx
                mov     edx, eax
                jz      short loc_1402344AA
                jmp     short loc_1402344B8
; ---------------------------------------------------------------------------

loc_1402344D9:                          ; CODE XREF: sub_140234420+92↑j
                mov     eax, cs:dword_140CFC41C
                test    al, 40h
                jz      short loc_1402344B4
                call    sub_140390EA0
                test    al, al
                jz      short loc_1402344B4
                mov     ecx, ebx
                call    sub_1403900C0
                jmp     short loc_1402344B6
sub_140234420   endp

; ---------------------------------------------------------------------------
algn_1402344F5:                         ; DATA XREF: .rdata:0000000140053F38↑o
                                        ; .pdata:00000001400CB4C0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140234500   proc near               ; CODE XREF: FsRtlUninitializeBaseMcb+1B↓p
                                        ; sub_14032D694+AE↓p ...
                sub     rsp, 28h
                inc     dword ptr [rcx+1Ch]
                movzx   eax, word ptr [rcx+10h]
                cmp     [rcx], ax
                jnb     short loc_14023451B
                call    ExpInterlockedPushEntrySList
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14023451B:                          ; CODE XREF: sub_140234500+E↑j
                inc     dword ptr [rcx+20h]
                mov     rax, [rcx+38h]
                mov     rcx, rdx
                call    sub_1404079D0
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140234500   endp

algn_140234530:                         ; DATA XREF: .pdata:00000001400CB4CC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140234540   proc near               ; CODE XREF: sub_1402F0A40+DE↓p
                                        ; sub_140393BA4+E1↓p ...

var_28          = qword ptr -28h
var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014042C7AA SIZE 00000151 BYTES

                push    rsi
                push    rdi
                sub     rsp, 38h
                mov     rsi, rcx
                test    dl, dl
                jz      loc_140234687

loc_140234552:                          ; DATA XREF: .rdata:0000000140053FFC↑o
                                        ; .rdata:0000000140054010↑o ...
                mov     [rsp+48h+arg_0], rbx
                mov     [rsp+48h+arg_8], rbp
                mov     [rsp+48h+var_18], r15
                mov     rbp, cr8
                mov     eax, 2
                mov     cr8, rax
                lea     r15, [rax-3]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C7AA

loc_140234580:                          ; CODE XREF: sub_140234540+1F826C↓j
                                        ; sub_140234540+1F8276↓j ...
                mov     rbx, gs:28h
                add     rbx, 0A0h
                mov     rdi, [rbx+8]
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042C7EB

loc_1402345AD:                          ; CODE XREF: sub_140234540+1F82AF↓j
                                        ; sub_140234540+1F82BE↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14042C80F
                mov     rdx, rbx
                xchg    rdx, [rdi]
                test    rdx, rdx
                jnz     loc_140234667

loc_1402345C9:                          ; CODE XREF: sub_140234540+12F↓j
                                        ; sub_140234540+1F82DB↓j
                mov     eax, [rsi+4]
                inc     eax
                mov     [rsi+4], eax
                mov     edi, [rsi+4]
                mov     rbx, gs:28h
                add     rbx, 0A0h
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14042C820

loc_1402345F1:                          ; DATA XREF: .rdata:0000000140054010↑o
                                        ; .rdata:0000000140054020↑o ...
                mov     [rsp+48h+arg_10], r14
                prefetchw byte ptr [rbx]
                mov     rax, [rbx]
                xor     r14d, r14d
                test    rax, rax
                jnz     short loc_14023467C
                mov     rcx, [rbx+8]
                mov     rax, rbx
                lock cmpxchg [rcx], r14
                jnz     short loc_140234674

loc_140234612:                          ; CODE XREF: sub_140234540+145↓j
                mov     r14, [rsp+48h+arg_10]

loc_140234617:                          ; CODE XREF: sub_140234540+1F82EE↓j
                                        ; DATA XREF: .pdata:00000001400CB4F0↑o ...
                mov     rcx, gs:20h
                mov     rbx, [rsp+48h+arg_0]
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042C833

loc_140234635:                          ; CODE XREF: sub_140234540+1F82F7↓j
                                        ; sub_140234540+1F8306↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C857

loc_140234643:                          ; CODE XREF: sub_140234540+1F8319↓j
                                        ; sub_140234540+1F8325↓j ...
                movzx   eax, bpl
                mov     cr8, rax
                mov     r15, [rsp+48h+var_18]
                mov     rbp, [rsp+48h+arg_8]

loc_140234655:                          ; CODE XREF: sub_140234540+14D↓j
                                        ; DATA XREF: .pdata:00000001400CB508↑o ...
                test    edi, edi
                jle     loc_14042C8BA
                mov     eax, edi
                add     rsp, 38h
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140234667:                          ; CODE XREF: sub_140234540+83↑j
                                        ; DATA XREF: .pdata:00000001400CB514↑o ...
                mov     rcx, rbx
                call    sub_14025FC20
                jmp     loc_1402345C9
; ---------------------------------------------------------------------------

loc_140234674:                          ; CODE XREF: sub_140234540+D0↑j
                                        ; DATA XREF: .pdata:00000001400CB520↑o ...
                mov     rcx, rbx
                call    sub_140313680

loc_14023467C:                          ; CODE XREF: sub_140234540+C2↑j
                mov     [rbx], r14
                lock xor qword ptr [rax+8], 1
                jmp     short loc_140234612
; ---------------------------------------------------------------------------

loc_140234687:                          ; CODE XREF: sub_140234540+C↑j
                                        ; DATA XREF: .pdata:00000001400CB52C↑o ...
                inc     dword ptr [rcx+4]
                mov     edi, [rcx+4]
                jmp     short loc_140234655
sub_140234540   endp

; ---------------------------------------------------------------------------
algn_14023468F:                         ; DATA XREF: .pdata:00000001400CB538↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402346A0   proc near               ; CODE XREF: sub_140641060+110↓p
                                        ; IoVerifyVolume+1A3↓p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014042C8FC SIZE 000000E7 BYTES

                push    rbx
                sub     rsp, 20h
                mov     rbx, rcx
                test    dl, dl
                jz      loc_14042C9D8

loc_1402346B1:                          ; DATA XREF: .rdata:0000000140054100↑o
                                        ; .rdata:0000000140054114↑o ...
                mov     [rsp+28h+arg_0], rbp
                mov     [rsp+28h+arg_10], rdi
                mov     [rsp+28h+arg_18], r14
                mov     rdi, cr8
                mov     eax, 2
                mov     cr8, rax
                lea     r14, [rax-3]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C8FC

loc_1402346DF:                          ; CODE XREF: sub_1402346A0+1F825E↓j
                                        ; sub_1402346A0+1F8268↓j ...
                mov     rcx, gs:28h
                add     rcx, 90h
                mov     rdx, [rcx+8]
                call    sub_14024B3F0
                mov     eax, [rbx+1Ch]
                dec     eax
                mov     [rbx+1Ch], eax
                mov     ebp, [rbx+1Ch]
                mov     rbx, gs:28h
                add     rbx, 90h
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14042C93D

loc_140234720:                          ; DATA XREF: .rdata:0000000140054114↑o
                                        ; .rdata:0000000140054124↑o ...
                mov     [rsp+28h+arg_8], rsi
                prefetchw byte ptr [rbx]
                mov     rax, [rbx]
                xor     esi, esi
                test    rax, rax
                jnz     short loc_140234794
                mov     rcx, [rbx+8]
                mov     rax, rbx
                lock cmpxchg [rcx], rsi
                jnz     short loc_14023478C

loc_140234740:                          ; CODE XREF: sub_1402346A0+FD↓j
                mov     rsi, [rsp+28h+arg_8]

loc_140234745:                          ; CODE XREF: sub_1402346A0+1F82AB↓j
                                        ; DATA XREF: .pdata:00000001400CB55C↑o ...
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042C950

loc_14023475E:                          ; CODE XREF: sub_1402346A0+1F82B4↓j
                                        ; sub_1402346A0+1F82C3↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C974

loc_14023476C:                          ; CODE XREF: sub_1402346A0+1F82D6↓j
                                        ; sub_1402346A0+1F82E2↓j ...
                movzx   ecx, dil
                mov     cr8, rcx
                mov     r14, [rsp+28h+arg_18]
                mov     eax, ebp
                mov     rbp, [rsp+28h+arg_0]
                mov     rdi, [rsp+28h+arg_10]

loc_140234785:                          ; CODE XREF: sub_1402346A0+1F833E↓j
                                        ; DATA XREF: .pdata:00000001400CB568↑o ...
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14023478C:                          ; CODE XREF: sub_1402346A0+9E↑j
                                        ; DATA XREF: .pdata:00000001400CB574↑o ...
                mov     rcx, rbx
                call    sub_140313680

loc_140234794:                          ; CODE XREF: sub_1402346A0+90↑j
                mov     [rbx], rsi
                lock xor qword ptr [rax+8], 1
                jmp     short loc_140234740
sub_1402346A0   endp

; ---------------------------------------------------------------------------
byte_14023479F  db 11h dup(0CCh)        ; DATA XREF: .pdata:00000001400CB580↑o
; Exported entry 827. IoFreeMdl

; =============== S U B R O U T I N E =======================================


                public IoFreeMdl
IoFreeMdl       proc near               ; CODE XREF: sub_14023D030+E3↓p
                                        ; sub_14023D030+483↓p ...

; FUNCTION CHUNK AT 000000014042C9E4 SIZE 00000015 BYTES

                push    rbx
                sub     rsp, 20h
                movzx   eax, word ptr [rcx+0Ah]
                mov     rbx, rcx
                test    al, 20h
                jnz     loc_140234851

loc_1402347C5:                          ; CODE XREF: IoFreeMdl+B1↓j
                test    al, 8
                jz      short loc_140234814
                movzx   ecx, word ptr [rbx+0Ch]
                mov     eax, cs:dword_140CFC404
                cmp     ecx, eax
                jnb     loc_14042C9E4
                lfence
                lea     rdx, qword_140CFDCC0
                mov     rdx, [rdx+rcx*8]

loc_1402347E9:                          ; CODE XREF: IoFreeMdl+1F8236↓j
                test    rdx, rdx
                jz      loc_14042C9EB

loc_1402347F2:                          ; CODE XREF: IoFreeMdl+1F8244↓j
                mov     rcx, [rdx+830h]
                inc     dword ptr [rcx+1Ch]
                movzx   eax, word ptr [rcx+10h]
                cmp     [rcx], ax
                jnb     short loc_140234825

loc_140234805:                          ; CODE XREF: IoFreeMdl+89↓j
                mov     rdx, rbx
                call    ExpInterlockedPushEntrySList
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140234814:                          ; CODE XREF: IoFreeMdl+17↑j
                xor     edx, edx
                mov     rcx, rbx
                call    ExFreePoolWithTag
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140234825:                          ; CODE XREF: IoFreeMdl+53↑j
                inc     dword ptr [rcx+20h]
                mov     rcx, [rdx+838h]
                inc     dword ptr [rcx+1Ch]
                movzx   eax, word ptr [rcx+10h]
                cmp     [rcx], ax
                jb      short loc_140234805
                inc     dword ptr [rcx+20h]
                mov     rax, [rcx+38h]
                mov     rcx, rbx
                call    sub_1404079D0
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140234851:                          ; CODE XREF: IoFreeMdl+F↑j
                mov     rcx, [rcx+18h]
                mov     rdx, rbx
                call    MmUnmapLockedPages
                movzx   eax, word ptr [rbx+0Ah]
                jmp     loc_1402347C5
IoFreeMdl       endp

; ---------------------------------------------------------------------------
algn_140234866:                         ; DATA XREF: .rdata:0000000140054338↑o
                                        ; .pdata:00000001400CB58C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140234870   proc near               ; CODE XREF: sub_14024CB10+203↓p
                                        ; sub_1403954FC+9↓p ...

var_38          = qword ptr -38h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014042C9FA SIZE 00000152 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                movzx   r12d, r8b
                movzx   r15d, dl
                mov     rsi, rcx
                xor     bpl, bpl
                mov     r14, cr8
                mov     eax, 2
                mov     cr8, rax
                lea     r13, [rax-3]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042C9FA

loc_1402348B9:                          ; CODE XREF: sub_140234870+1F818C↓j
                                        ; sub_140234870+1F8196↓j ...
                mov     rbx, gs:28h
                add     rbx, 0A0h
                mov     rdi, [rbx+8]
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042CA3B

loc_1402348E6:                          ; CODE XREF: sub_140234870+1F81CF↓j
                                        ; sub_140234870+1F81DE↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14042CA5F
                mov     rdx, rbx
                xchg    rdx, [rdi]
                test    rdx, rdx
                jnz     loc_1402349D7

loc_140234902:                          ; CODE XREF: sub_140234870+16F↓j
                                        ; sub_140234870+1F81FB↓j
                mov     eax, [rsi+4]
                sub     eax, 1
                mov     [rsi+4], eax
                js      loc_14042CA70
                test    eax, eax
                jz      loc_1402349AA

loc_140234919:                          ; CODE XREF: sub_140234870+14C↓j
                mov     rbx, gs:28h
                add     rbx, 0A0h
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14042CAB2
                prefetchw byte ptr [rbx]
                mov     rax, [rbx]
                xor     edi, edi
                test    rax, rax
                jnz     loc_1402349EC
                mov     rcx, [rbx+8]
                mov     rax, rbx
                lock cmpxchg [rcx], rdi
                jnz     loc_1402349E4

loc_140234959:                          ; CODE XREF: sub_140234870+185↓j
                                        ; sub_140234870+1F8250↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042CAC5

loc_140234972:                          ; CODE XREF: sub_140234870+1F8259↓j
                                        ; sub_140234870+1F8268↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042CAE9

loc_140234980:                          ; CODE XREF: sub_140234870+1F827B↓j
                                        ; sub_140234870+1F8287↓j ...
                movzx   eax, r14b
                mov     cr8, rax

loc_140234988:                          ; CODE XREF: sub_140234870+165↓j
                mov     rbx, [rsp+58h+arg_0]
                movzx   eax, bpl
                mov     rbp, [rsp+58h+arg_8]
                mov     rsi, [rsp+58h+arg_10]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402349AA:                          ; CODE XREF: sub_140234870+A3↑j
                test    r15b, r15b
                jnz     short loc_1402349C2
                mov     rax, [rsi+138h]
                mov     ecx, [rax+20h]
                test    cl, 7
                jz      loc_140234919

loc_1402349C2:                          ; CODE XREF: sub_140234870+13D↑j
                movzx   r8d, r14b
                movzx   edx, r12b
                mov     rcx, rsi
                call    sub_1402F0A40
                movzx   ebp, al
                jmp     short loc_140234988
; ---------------------------------------------------------------------------

loc_1402349D7:                          ; CODE XREF: sub_140234870+8C↑j
                mov     rcx, rbx
                call    sub_14025FC20
                jmp     loc_140234902
; ---------------------------------------------------------------------------

loc_1402349E4:                          ; CODE XREF: sub_140234870+E3↑j
                mov     rcx, rbx
                call    sub_140313680

loc_1402349EC:                          ; CODE XREF: sub_140234870+D1↑j
                mov     [rbx], rdi
                lock xor qword ptr [rax+8], 1
                jmp     loc_140234959
sub_140234870   endp

; ---------------------------------------------------------------------------
algn_1402349FA:                         ; DATA XREF: .rdata:00000001400543C4↑o
                                        ; .pdata:00000001400CB598↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140234A00   proc near               ; CODE XREF: NtSetInformationFile+611↓p
                                        ; sub_14063FB00+770↓p ...
                mov     rax, gs:188h
                inc     qword ptr [rax+390h]
                inc     dword ptr gs:2EE4h
                retn
sub_140234A00   endp

; ---------------------------------------------------------------------------
                align 2
algn_140234A1A:                         ; DATA XREF: .pdata:00000001400CB5A4↑o
                align 20h
; Exported entry 734. IoAllocateMdl

; =============== S U B R O U T I N E =======================================


                public IoAllocateMdl
IoAllocateMdl   proc near               ; CODE XREF: sub_1402F2C28+B5↓p
                                        ; sub_14030FA70+285↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = byte ptr  18h
arg_18          = qword ptr  20h
arg_20          = qword ptr  28h

; FUNCTION CHUNK AT 000000014042CB4C SIZE 00000029 BYTES

                mov     [rsp+arg_18], rbx
                mov     [rsp+arg_10], r8b
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r15
                sub     rsp, 20h
                mov     r13, [rsp+48h+arg_20]
                xor     eax, eax
                mov     esi, ecx
                mov     ebx, edx
                add     rbx, 0FFFh
                mov     r12d, edx
                mov     r9d, esi
                mov     rdi, rcx
                and     r9d, 0FFFh
                movzx   r15d, ax
                add     rbx, r9
                shr     rbx, 0Ch
                cmp     ebx, 11h
                ja      loc_140234B6A

loc_140234A6C:                          ; DATA XREF: .rdata:00000001400543F0↑o
                                        ; .rdata:0000000140054408↑o ...
                mov     [rsp+48h+arg_0], rbp
                lea     r15d, [rax+8]
                mov     [rsp+48h+arg_8], r14
                mov     r14, gs:20h
                mov     rbp, [r14+830h]
                mov     rcx, rbp
                inc     dword ptr [rbp+14h]
                call    ExpInterlockedPopEntrySList
                test    rax, rax
                jz      loc_140234B28

loc_140234A9E:                          ; CODE XREF: IoAllocateMdl+120↓j
                                        ; IoAllocateMdl+13F↓j
                mov     ecx, [r14+24h]
                mov     [rax], ecx

loc_140234AA4:                          ; CODE XREF: IoAllocateMdl+145↓j
                mov     r14, [rsp+48h+arg_8]
                mov     rbp, [rsp+48h+arg_0]
                test    rax, rax
                jz      loc_14042CB4C

loc_140234AB7:                          ; DATA XREF: .pdata:00000001400CB5BC↑o
                                        ; .pdata:00000001400CB5C8↑o
                movzx   ecx, word ptr [rax]

loc_140234ABA:                          ; CODE XREF: IoAllocateMdl+170↓j
                mov     [rax+0Ch], cx
                add     bx, 6
                shl     bx, 3
                and     rdi, 0FFFFFFFFFFFFF000h
                and     esi, 0FFFh
                mov     qword ptr [rax], 0
                mov     [rax+8], bx
                mov     [rax+20h], rdi
                mov     [rax+2Ch], esi
                mov     [rax+28h], r12d
                mov     [rax+0Ah], r15w
                test    r13, r13
                jnz     short loc_140234B06

loc_140234AF3:                          ; CODE XREF: IoAllocateMdl:loc_140234B95↓j
                                        ; IoAllocateMdl+1F8150↓j
                mov     rbx, [rsp+48h+arg_18]
                add     rsp, 20h
                pop     r15
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140234B06:                          ; CODE XREF: IoAllocateMdl+D1↑j
                cmp     [rsp+48h+arg_10], 0
                jnz     loc_14042CB56
                mov     rbx, [rsp+48h+arg_18]
                mov     [r13+8], rax
                add     rsp, 20h
                pop     r15
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                align 8

loc_140234B28:                          ; CODE XREF: IoAllocateMdl+78↑j
                                        ; DATA XREF: .pdata:00000001400CB5C8↑o ...
                inc     dword ptr [rbp+18h]
                mov     rbp, [r14+838h]
                mov     rcx, rbp
                inc     dword ptr [rbp+14h]
                call    ExpInterlockedPopEntrySList
                test    rax, rax
                jnz     loc_140234A9E
                mov     edx, [rbp+2Ch]
                mov     rax, [rbp+30h]
                mov     r8d, [rbp+28h]
                mov     ecx, [rbp+24h]
                inc     dword ptr [rbp+18h]
                call    sub_1404079D0
                test    rax, rax
                jnz     loc_140234A9E
                jmp     loc_140234AA4
; ---------------------------------------------------------------------------

loc_140234B6A:                          ; CODE XREF: IoAllocateMdl+46↑j
                                        ; DATA XREF: .pdata:00000001400CB5D4↑o ...
                lea     eax, ds:30h[rbx*8]

loc_140234B71:                          ; CODE XREF: IoAllocateMdl+1F8131↓j
                mov     edx, eax
                mov     ecx, 200h
                mov     r8d, 206C644Dh
                call    ExAllocatePoolWithTag
                test    rax, rax
                jz      short loc_140234B95
                mov     ecx, gs:1A4h
                jmp     loc_140234ABA
; ---------------------------------------------------------------------------

loc_140234B95:                          ; CODE XREF: IoAllocateMdl+166↑j
                jmp     loc_140234AF3
IoAllocateMdl   endp

; ---------------------------------------------------------------------------
algn_140234B9A:                         ; DATA XREF: .pdata:00000001400CB5E0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140234BA0   proc near               ; CODE XREF: sub_1406431F0+B6A↓p
                                        ; sub_140893B3C+389↓p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8
arg_20          = dword ptr  28h

; FUNCTION CHUNK AT 000000014042CB76 SIZE 0000001E BYTES

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 20h
                mov     rbx, rcx
                movzx   eax, dl
                test    r8d, r8d
                mov     r10d, 1
                mov     ecx, r10d
                mov     rdi, r9
                cmovz   ecx, r8d
                test    dl, dl
                mov     r8d, ecx
                mov     rcx, rbx
                cmovz   r10d, eax
                movzx   edx, r10b
                call    sub_140221A30
                mov     eax, cs:dword_140CFC4EC
                test    al, 1
                jnz     loc_14042CB76

loc_140234BE6:                          ; CODE XREF: sub_140234BA0+1F7FEF↓j
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140234BA0   endp

algn_140234BF2:                         ; DATA XREF: .rdata:0000000140054460↑o
                                        ; .pdata:00000001400CB5EC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140234C00   proc near               ; CODE XREF: sub_140233220+56↑p
                                        ; sub_1402F26A0+115↓p ...

var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014042CB94 SIZE 000001FB BYTES

                push    rbx
                push    rdi
                sub     rsp, 38h
                mov     rdi, [rcx+5C0h]
                mov     rbx, rcx
                test    rdi, rdi
                jnz     short loc_140234C23
                mov     eax, 0C0000001h

loc_140234C1B:                          ; CODE XREF: sub_140234C00+104↓j
                add     rsp, 38h
                pop     rdi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140234C23:                          ; CODE XREF: sub_140234C00+14↑j
                                        ; DATA XREF: .rdata:0000000140054488↑o ...
                mov     [rsp+48h+arg_8], rbp
                mov     rbp, 0FFFFFFFFFFFFFFFFh
                mov     [rsp+48h+arg_10], rsi

loc_140234C34:                          ; DATA XREF: .rdata:00000001400544A0↑o
                                        ; .rdata:00000001400544B4↑o ...
                mov     [rsp+48h+var_18], r12
                mov     [rsp+48h+var_28], r15
                xor     r15d, r15d
                test    dword ptr [rcx+78h], 200h
                lea     r12d, [rbp+3]
                jnz     loc_140234D09

loc_140234C52:                          ; CODE XREF: sub_140234C00+1A8↓j
                mov     rsi, cr8
                mov     cr8, r12
                mov     eax, cs:dword_140CFC660
                mov     r12, [rsp+48h+var_18]
                test    eax, eax
                jnz     loc_14042CCA6

loc_140234C6D:                          ; CODE XREF: sub_140234C00+1F80A8↓j
                                        ; sub_140234C00+1F80B2↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                lea     rcx, dword_140C1DF40
                movzx   edx, sil
                jnz     loc_14042CCE7
                call    sub_140234420

loc_140234C8A:                          ; CODE XREF: sub_140234C00+1F80ED↓j
                mov     rcx, rbx
                mov     [rbx+5C0h], r15
                call    sub_1402899F0
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14042CCF2
                mov     cs:dword_140C1DF40, r15d

loc_140234CAD:                          ; CODE XREF: sub_140234C00+1F8104↓j
                mov     rcx, gs:20h
                mov     r15, [rsp+48h+var_28]
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042CD09

loc_140234CCB:                          ; CODE XREF: sub_140234C00+1F810D↓j
                                        ; sub_140234C00+1F811C↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042CD2D

loc_140234CD9:                          ; CODE XREF: sub_140234C00+1F812F↓j
                                        ; sub_140234C00+1F813B↓j ...
                movzx   eax, sil
                mov     cr8, rax
                xor     edx, edx
                mov     rcx, rdi
                call    sub_140251C20
                mov     edx, 746E6F43h
                mov     rcx, rdi
                call    ObDereferenceObjectDeferDeleteWithTag
                mov     rsi, [rsp+48h+arg_10]
                xor     eax, eax
                mov     rbp, [rsp+48h+arg_8]
                jmp     loc_140234C1B
; ---------------------------------------------------------------------------

loc_140234D09:                          ; CODE XREF: sub_140234C00+4C↑j
                                        ; DATA XREF: .pdata:00000001400CB628↑o ...
                mov     [rsp+48h+var_20], r14
                mov     rcx, cr8
                mov     cr8, r12
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042CB94

loc_140234D24:                          ; CODE XREF: sub_140234C00+1F7F96↓j
                                        ; sub_140234C00+1F7F9F↓j ...
                mov     rsi, gs:20h
                cli
                xor     r8d, r8d
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_1402CDFD0
                sti
                mov     r14, gs:20h
                mov     [rsp+48h+arg_0], r15d
                mov     rcx, [r14+84B8h]
                test    rcx, rcx
                jnz     loc_14042CBD3

loc_140234D5B:                          ; CODE XREF: sub_140234C00+1DD↓j
                                        ; sub_140234C00+1F7FD8↓j ...
                lock bts qword ptr [rsi+30h], 0
                jb      short loc_140234DAD
                lock btr dword ptr [rbx], 12h
                mov     [rbx+68h], r15
                lock btr dword ptr [rbx+78h], 9
                lock and [rsi+30h], r15
                mov     rcx, gs:20h
                mov     r14, [rsp+48h+var_20]
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042CC3F

loc_140234D96:                          ; CODE XREF: sub_140234C00+1F8043↓j
                                        ; sub_140234C00+1F8052↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042CC63

loc_140234DA4:                          ; CODE XREF: sub_140234C00+1F8065↓j
                                        ; sub_140234C00+1F8074↓j ...
                mov     cr8, r15
                jmp     loc_140234C52
; ---------------------------------------------------------------------------

loc_140234DAD:                          ; CODE XREF: sub_140234C00+162↑j
                                        ; DATA XREF: .rdata:00000001400544D8↑o ...
                mov     rcx, [r14+84B8h]
                test    rcx, rcx
                jnz     loc_14042CBFB
                nop     dword ptr [rax]

loc_140234DC0:                          ; CODE XREF: sub_140234C00+1D1↓j
                                        ; sub_140234C00+1F8000↓j ...
                lea     rcx, [rsp+48h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rsi+30h]
                test    rax, rax
                jnz     short loc_140234DC0
                mov     rcx, [r14+84B8h]
                test    rcx, rcx
                jz      loc_140234D5B
                jmp     loc_14042CC23
sub_140234C00   endp

; ---------------------------------------------------------------------------
algn_140234DE8:                         ; DATA XREF: .pdata:00000001400CB64C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140234DF0   proc near               ; CODE XREF: sub_1403F1520+31↓p
                                        ; DATA XREF: .pdata:00000001400CB658↑o

; FUNCTION CHUNK AT 000000014042CD90 SIZE 00000011 BYTES

                mov     eax, ecx
                test    rdx, rdx
                jnz     loc_14042CD90
                mov     rcx, gs:188h
                add     [rcx+3A8h], rax

loc_140234E0B:                          ; CODE XREF: sub_140234DF0+1F7FAC↓j
                add     gs:2EF8h, rax
                retn
sub_140234DF0   endp

; ---------------------------------------------------------------------------
                align 2
algn_140234E16:                         ; DATA XREF: .pdata:00000001400CB658↑o
                align 20h
; Exported entry 1619. NtSetInformationFile

; =============== S U B R O U T I N E =======================================


                public NtSetInformationFile
NtSetInformationFile proc near          ; DATA XREF: .pdata:00000001400CB664↑o
                                        ; PAGE:000000014098AB38↓o

var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = byte ptr -0E8h
var_E7          = byte ptr -0E7h
var_E0          = qword ptr -0E0h
var_D8          = byte ptr -0D8h
var_D7          = byte ptr -0D7h
var_D6          = byte ptr -0D6h
var_D5          = byte ptr -0D5h
var_D4          = dword ptr -0D4h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_C0          = xmmword ptr -0C0h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = xmmword ptr -78h
var_68          = qword ptr -68h
var_60          = xmmword ptr -60h
var_50          = xmmword ptr -50h
var_40          = qword ptr -40h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h
arg_20          = dword ptr  28h

; __unwind { // __C_specific_handler
                mov     r11, rsp
                mov     [r11+20h], r9d
                mov     [r11+18h], r8
                mov     [r11+10h], rdx
                mov     [r11+8], rcx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 0E0h
                mov     r13d, r9d
                mov     r15, r8
                mov     r10, rdx
                mov     r12, rcx
                xor     edi, edi
                mov     [rsp+118h+var_E0], rdi
                xorps   xmm0, xmm0
                xor     eax, eax
                movups  [rsp+118h+var_C0], xmm0
                mov     [rsp+118h+var_B0], rax
                movups  xmmword ptr [r11-78h], xmm0
                mov     [r11-80h], rdi
                mov     [rsp+118h+var_E7], al
                mov     [rsp+118h+var_D8], al
                mov     [rsp+118h+var_D5], al
                mov     r9, gs:188h
                mov     [rsp+118h+var_A8], r9
                movzx   esi, byte ptr [r9+232h]
                mov     [rsp+118h+var_E8], sil
                test    sil, sil
                jz      loc_140234FE9
                movsxd  r14, [rsp+118h+arg_20]
                cmp     r14d, 4Ch ; 'L'
                jnb     loc_140234FDF
                lea     rdx, cs:140000000h
                movzx   eax, byte ptr [r14+rdx+986360h]
                test    al, al
                jz      loc_140234FDF
                cmp     r13d, eax
                jb      loc_140235165

loc_140234ED3:                          ; DATA XREF: .rdata:00000001400546A8↑o
;   __try { // __except at loc_140234FDA
                mov     r11, 7FFFFFFF0000h
                mov     rcx, r11
                cmp     r10, r11
                cmovb   rcx, r10
                mov     eax, [rcx]
                mov     [rcx], eax
                mov     rax, [r9+0B8h]
                mov     rcx, [rax+580h]
                test    rcx, rcx
                jz      short loc_140234F36
                movzx   eax, word ptr [rcx+8]
                mov     ecx, 14Ch
                cmp     ax, cx
                jz      short loc_140234F16
                mov     ecx, 1C4h
                cmp     ax, cx
                jnz     short loc_140234F36

loc_140234F16:                          ; CODE XREF: NtSetInformationFile+EA↑j
                test    r13d, r13d
                jz      short loc_140234F69
                mov     rax, rdi
                mov     ecx, 3
                cmp     r13d, 1
                cmovnz  rax, rcx
                test    r15, rax
                jnz     loc_140235B7B
                jmp     short loc_140234F50
; ---------------------------------------------------------------------------

loc_140234F36:                          ; CODE XREF: NtSetInformationFile+DC↑j
                                        ; NtSetInformationFile+F4↑j
                test    r13d, r13d
                jz      short loc_140234F69
                movzx   eax, byte ptr [r14+rdx+9862C0h]
                dec     rax
                test    r15, rax
                jnz     loc_140235B80

loc_140234F50:                          ; CODE XREF: NtSetInformationFile+114↑j
                lea     rcx, [r8+r13]
                cmp     rcx, r11
                ja      short loc_140234F5E
                cmp     rcx, r15
                jnb     short loc_140234F69

loc_140234F5E:                          ; CODE XREF: NtSetInformationFile+137↑j
                xor     eax, eax
                mov     ds:7FFFFFFF0000h, al
;   } // starts at 140234ED3

loc_140234F69:                          ; CODE XREF: NtSetInformationFile+F9↑j
                                        ; NtSetInformationFile+119↑j ...
                mov     edi, ds:rva dword_140987330[rdx+r14*4]
                cmp     r14d, 0Bh
                jz      short loc_140234F81
                cmp     r14d, 48h ; 'H'
                jnz     loc_14023505F

loc_140234F81:                          ; CODE XREF: NtSetInformationFile+155↑j
                movups  [rsp+118h+var_60], xmm0
                movups  [rsp+118h+var_50], xmm0
                mov     rdx, [r9+220h]
                lea     r8, [rsp+118h+var_60]
                mov     rcx, r9
                call    SeCaptureSubjectContextEx
                movzx   edx, sil
                lea     rcx, [rsp+118h+var_60]
                call    RtlIsSandboxedToken
                movzx   ebx, al
                lea     rcx, [rsp+118h+var_60]
                call    SeReleaseSubjectContext
                test    bl, bl
                jz      loc_14023505F
                bts     edi, 8
                jmp     loc_14023505F
; ---------------------------------------------------------------------------

loc_140234FDA:                          ; DATA XREF: .rdata:00000001400546A8↑o
                                        ; .rdata:0000000140054708↑o
;   __except(1) // owned by 140234ED3
;   __except(1) // owned by 140235B7B
                jmp     loc_140235B67
; ---------------------------------------------------------------------------

loc_140234FDF:                          ; CODE XREF: NtSetInformationFile+8C↑j
                                        ; NtSetInformationFile+A4↑j
                mov     eax, 0C0000003h
                jmp     loc_140235B67
; ---------------------------------------------------------------------------

loc_140234FE9:                          ; CODE XREF: NtSetInformationFile+7A↑j
                mov     r14d, [rsp+118h+arg_20]
                cmp     r14d, 38h ; '8'
                jnz     short loc_140235004
                mov     r14d, 0Ah
                mov     [rsp+118h+var_D8], 1
                jmp     short loc_14023504E
; ---------------------------------------------------------------------------

loc_140235004:                          ; CODE XREF: NtSetInformationFile+1D5↑j
                cmp     r14d, 42h ; 'B'
                jnz     short loc_140235017
                mov     r14d, 41h ; 'A'
                mov     [rsp+118h+var_D8], 1
                jmp     short loc_14023504E
; ---------------------------------------------------------------------------

loc_140235017:                          ; CODE XREF: NtSetInformationFile+1E8↑j
                cmp     r14d, 39h ; '9'
                jnz     short loc_14023502A
                mov     r14d, 0Bh
                mov     [rsp+118h+var_D8], 1
                jmp     short loc_14023504E
; ---------------------------------------------------------------------------

loc_14023502A:                          ; CODE XREF: NtSetInformationFile+1FB↑j
                cmp     r14d, 49h ; 'I'
                jnz     short loc_14023503D
                mov     r14d, 48h ; 'H'
                mov     [rsp+118h+var_D8], 1
                jmp     short loc_14023504E
; ---------------------------------------------------------------------------

loc_14023503D:                          ; CODE XREF: NtSetInformationFile+20E↑j
                cmp     r14d, 4Bh ; 'K'
                jnz     short loc_14023504E
                mov     r14d, 47h ; 'G'
                mov     [rsp+118h+var_D5], 1

loc_14023504E:                          ; CODE XREF: NtSetInformationFile+1E2↑j
                                        ; NtSetInformationFile+1F5↑j ...
                movsxd  rax, r14d
                lea     rdx, cs:140000000h
                mov     edi, ds:rva dword_140987330[rdx+rax*4]

loc_14023505F:                          ; CODE XREF: NtSetInformationFile+15B↑j
                                        ; NtSetInformationFile+1AB↑j ...
                xor     r9d, r9d
                mov     [rsp+118h+var_F8], r9
                lea     r9, [rsp+118h+var_E0]
                movzx   r8d, sil
                mov     edx, edi
                mov     rcx, r12
                call    sub_1402433F0
                mov     edi, eax
                test    eax, eax
                js      loc_140235B67
                mov     rbx, [rsp+118h+var_E0]
                test    dword ptr [rbx+50h], 800h
                jnz     short loc_1402350A1
                mov     rcx, rbx
                call    IoGetRelatedDeviceObject
                mov     rbx, [rsp+118h+var_E0]
                jmp     short loc_1402350AA
; ---------------------------------------------------------------------------

loc_1402350A1:                          ; CODE XREF: NtSetInformationFile+270↑j
                mov     rcx, [rbx+8]
                call    IoGetAttachedDevice

loc_1402350AA:                          ; CODE XREF: NtSetInformationFile+27F↑j
                mov     r12, rax
                mov     [rsp+118h+var_D0], rax
                mov     esi, [rbx+50h]
                test    sil, 2
                jz      loc_140235229
                shr     esi, 2
                and     sil, 1
                mov     rax, gs:188h
                dec     word ptr [rax+1E4h]
                lea     rcx, [rbx+80h]
                xor     r8d, r8d
                xor     edx, edx
                call    sub_140244C10
                mov     r9, rax
                mov     [rsp+118h+var_D7], 0
                mov     eax, 1
                xchg    eax, [rbx+74h]
                test    eax, eax
                jnz     short loc_140235113
                test    r9, r9
                jz      short loc_140235105
                or      byte ptr [r9+1Ah], 1

loc_140235105:                          ; CODE XREF: NtSetInformationFile+2DE↑j
                mov     rcx, rbx
                call    ObfReferenceObject
                xor     esi, esi
                mov     edi, esi
                jmp     short loc_140235132
; ---------------------------------------------------------------------------

loc_140235113:                          ; CODE XREF: NtSetInformationFile+2D9↑j
                lea     rax, [rsp+118h+var_D7]
                mov     [rsp+118h+var_F8], rax
                movzx   r8d, sil
                movzx   edx, [rsp+118h+var_E8]
                mov     rcx, rbx
                call    sub_1406A0C70
                mov     edi, eax
                xor     esi, esi

loc_140235132:                          ; CODE XREF: NtSetInformationFile+2F1↑j
                mov     [rsp+118h+var_D4], edi
                cmp     [rsp+118h+var_D7], 0
                jnz     loc_1402351F3
                cmp     r14d, 0Eh
                jnz     loc_14023521F
                cmp     r13d, 8
                jnb     short loc_14023516F
                mov     rcx, [rsp+118h+var_E0]
                call    sub_1402481D0
                mov     rcx, [rsp+118h+var_E0]
                call    PsDereferenceSiloContext

loc_140235165:                          ; CODE XREF: NtSetInformationFile+AD↑j
                mov     eax, 0C0000004h
                jmp     loc_140235B67
; ---------------------------------------------------------------------------

loc_14023516F:                          ; CODE XREF: NtSetInformationFile+32F↑j
                                        ; DATA XREF: .rdata:00000001400546B8↑o
;   __try { // __except at loc_140235202
                mov     rax, [r15]
                mov     [rsp+118h+var_40], rax
;   } // starts at 14023516F

loc_14023517A:                          ; DATA XREF: .rdata:00000001400546B8↑o
                mov     rdx, [rsp+118h+var_E0]
                mov     ecx, [rdx+50h]
                test    cl, 8
                jz      short loc_14023519B
                movzx   ecx, word ptr [r12+130h]
                test    cx, cx
                jz      short loc_14023519B
                dec     ecx
                test    eax, ecx
                jnz     short loc_1402351A6

loc_14023519B:                          ; CODE XREF: NtSetInformationFile+365↑j
                                        ; NtSetInformationFile+373↑j
                mov     rcx, rax
                shr     rcx, 20h
                test    ecx, ecx
                jns     short loc_1402351AD

loc_1402351A6:                          ; CODE XREF: NtSetInformationFile+379↑j
                mov     edi, 0C000000Dh
                jmp     short loc_1402351CD
; ---------------------------------------------------------------------------

loc_1402351AD:                          ; CODE XREF: NtSetInformationFile+384↑j
                mov     [rdx+68h], rax

loc_1402351B1:                          ; DATA XREF: .rdata:00000001400546C8↑o
;   __try { // __except at loc_1402351C1
                mov     rax, [rsp+118h+arg_8]
                mov     [rax], esi
                mov     [rax+8], rsi
                jmp     short loc_1402351CD
;   } // starts at 1402351B1
; ---------------------------------------------------------------------------

loc_1402351C1:                          ; DATA XREF: .rdata:00000001400546C8↑o
;   __except(1) // owned by 1402351B1
                mov     r13d, [rsp+118h+arg_18]
                mov     edi, [rsp+118h+var_D4]

loc_1402351CD:                          ; CODE XREF: NtSetInformationFile+38B↑j
                                        ; NtSetInformationFile+39F↑j
                mov     rcx, gs:188h
                mov     eax, r13d
                add     [rcx+3A8h], rax
                add     gs:2EF8h, rax
                mov     rcx, [rsp+118h+var_E0]
                call    sub_1402481D0

loc_1402351F3:                          ; CODE XREF: NtSetInformationFile+31B↑j
                mov     rcx, [rsp+118h+var_E0]
                call    PsDereferenceSiloContext
                jmp     loc_140235B65
; ---------------------------------------------------------------------------

loc_140235202:                          ; DATA XREF: .rdata:00000001400546B8↑o
;   __except(1) // owned by 14023516F
                mov     ebx, eax
                mov     rcx, [rsp+118h+var_E0]
                call    sub_1402481D0
                mov     rcx, [rsp+118h+var_E0]
                call    PsDereferenceSiloContext
                mov     eax, ebx
                jmp     loc_140235B67
; ---------------------------------------------------------------------------

loc_14023521F:                          ; CODE XREF: NtSetInformationFile+325↑j
                mov     r12b, 1
                mov     rbx, [rsp+118h+var_E0]
                jmp     short loc_140235252
; ---------------------------------------------------------------------------

loc_140235229:                          ; CODE XREF: NtSetInformationFile+299↑j
                mov     word ptr [rsp+118h+var_C0], 1
                mov     byte ptr [rsp+118h+var_C0+2], 6
                xor     esi, esi
                mov     dword ptr [rsp+118h+var_C0+4], esi
                lea     rax, [rsp+118h+var_C0+8]
                mov     [rsp+118h+var_B0], rax
                lea     rax, [rsp+118h+var_C0+8]
                mov     qword ptr [rsp+118h+var_C0+8], rax
                xor     r12b, r12b

loc_140235252:                          ; CODE XREF: NtSetInformationFile+407↑j
                mov     [rsp+118h+var_D6], r12b
                mov     rcx, rbx
                call    sub_1402360C0
                cmp     r14d, 24h ; '$'
                jnz     loc_1402352F3
                cmp     r13d, 10h
                jnb     short loc_140235276
                mov     ebx, 0C0000004h
                jmp     short loc_1402352D3
; ---------------------------------------------------------------------------

loc_140235276:                          ; CODE XREF: NtSetInformationFile+44D↑j
                mov     rcx, [rsp+118h+var_E0]
                test    r12b, r12b
                lea     rax, [rcx+98h]
                jnz     short loc_14023528C
                lea     rax, [rsp+118h+var_C0]

loc_14023528C:                          ; CODE XREF: NtSetInformationFile+465↑j
                movzx   r9d, [rsp+118h+var_E8]
                mov     byte ptr [rsp+118h+var_F0], r9b
                mov     [rsp+118h+var_F8], rax
                mov     r9d, r13d
                mov     r8, r15
                lea     rdx, [rsp+118h+var_78]
                call    sub_1406DF220
                mov     ebx, eax
                mov     [rsp+118h+var_D4], eax
                test    eax, eax
                js      short loc_1402352D3

loc_1402352B9:                          ; DATA XREF: .rdata:00000001400546D8↑o
;   __try { // __except at loc_1402352C9
                mov     rax, [rsp+118h+arg_8]
                mov     [rax+8], rsi
                mov     [rax], ebx
                jmp     short loc_1402352D3
;   } // starts at 1402352B9
; ---------------------------------------------------------------------------

loc_1402352C9:                          ; DATA XREF: .rdata:00000001400546D8↑o
;   __except(1) // owned by 1402352B9
                mov     ebx, [rsp+118h+var_D4]
                movzx   r12d, [rsp+118h+var_D6]

loc_1402352D3:                          ; CODE XREF: NtSetInformationFile+454↑j
                                        ; NtSetInformationFile+497↑j ...
                test    r12b, r12b
                jz      short loc_1402352E2
                mov     rcx, [rsp+118h+var_E0]
                call    sub_1402481D0

loc_1402352E2:                          ; CODE XREF: NtSetInformationFile+4B6↑j
                mov     rcx, [rsp+118h+var_E0]
                call    PsDereferenceSiloContext
                mov     eax, ebx
                jmp     loc_140235B67
; ---------------------------------------------------------------------------

loc_1402352F3:                          ; CODE XREF: NtSetInformationFile+443↑j
                mov     r9, [rsp+118h]
                movzx   r8d, r12b
                xor     r8b, 1
                mov     rax, [rsp+118h+var_D0]
                movzx   edx, byte ptr [rax+4Ch]
                mov     rcx, rax
                call    sub_140235D20
                mov     rsi, rax
                mov     [rsp+118h+var_A0], rax
                test    rax, rax
                jnz     short loc_140235337
                xor     edx, edx
                mov     rcx, [rsp+118h+var_E0]
                call    sub_1408925D4
                mov     eax, 0C000009Ah
                jmp     loc_140235B67
; ---------------------------------------------------------------------------

loc_140235337:                          ; CODE XREF: NtSetInformationFile+4FF↑j
                mov     rax, [rsp+118h+var_E0]
                mov     [rsi+0C0h], rax
                mov     rax, [rsp+118h+var_A8]
                mov     [rsi+98h], rax
                movzx   eax, [rsp+118h+var_E8]
                mov     [rsi+40h], al
                test    r12b, r12b
                jz      short loc_140235370
                or      byte ptr [rsi+47h], 2
                mov     rax, [rsp+118h+arg_8]
                xor     r9d, r9d
                mov     ecx, r9d
                jmp     short loc_140235396
; ---------------------------------------------------------------------------

loc_140235370:                          ; CODE XREF: NtSetInformationFile+53A↑j
                cmp     al, 1
                jnz     short loc_14023537F
                xor     ecx, ecx
                call    KeSetKernelStackSwapEnable
                mov     [rsp+118h+var_E7], al

loc_14023537F:                          ; CODE XREF: NtSetInformationFile+552↑j
                mov     dword ptr [rsi+10h], 4
                lea     rax, [rsp+118h+var_78]
                lea     rcx, [rsp+118h+var_C0]
                xor     r9d, r9d

loc_140235396:                          ; CODE XREF: NtSetInformationFile+54E↑j
                mov     r8, rsi
                mov     rdx, rsi
                mov     [rdx+50h], rcx
                mov     [rsi+48h], rax
                mov     [rsi+58h], r9
                mov     r15, [rsi+0B8h]
                mov     byte ptr [r15-48h], 6
                mov     rax, [rsp+118h+var_E0]
                mov     [r15-18h], rax
                mov     [rsi+18h], r9
                mov     [rsi+8], r9

loc_1402353C5:                          ; DATA XREF: .rdata:00000001400546E8↑o
;   __try { // __except at loc_140235B2F
                mov     rdx, r13
                call    sub_1402159F0
                mov     [rsp+118h+var_A8], rax
                mov     [rsi+18h], rax
                mov     r8, r13
                mov     rdx, [rsp+118h+arg_10]
                mov     rcx, rax
                call    memmove
                lea     ecx, [r14-13h]
                cmp     ecx, 1
                jbe     short loc_1402353F8
                cmp     r14d, 0Eh
                jnz     short loc_140235407

loc_1402353F8:                          ; CODE XREF: NtSetInformationFile+5D0↑j
                mov     rax, [rsp+118h+var_A8]
                cmp     dword ptr [rax+4], 0
                jl      loc_140235B86
;   } // starts at 1402353C5

loc_140235407:                          ; CODE XREF: NtSetInformationFile+5D6↑j
                                        ; DATA XREF: .rdata:00000001400546E8↑o
                or      dword ptr [rsi+10h], 830h
                mov     [r15-40h], r13d
                mov     [r15-38h], r14d
                cmp     [rsp+118h+var_D8], 0
                jnz     short loc_140235424
                cmp     [rsp+118h+var_D5], 0
                jz      short loc_140235429

loc_140235424:                          ; CODE XREF: NtSetInformationFile+5FB↑j
                or      byte ptr [r15-46h], 1

loc_140235429:                          ; CODE XREF: NtSetInformationFile+602↑j
                mov     rcx, rsi
                call    sub_140245C90
                call    sub_140234A00
                cmp     r14d, 10h
                jnz     loc_1402354F7
                mov     r9, [rsi+18h]
                mov     r8d, [r9]
                test    r8d, 0FFFFFFC9h
                jnz     loc_1402354E2
                mov     edx, r8d
                and     edx, 30h
                mov     rcx, [rsp+118h+var_E0]
                jz      short loc_140235468
                mov     eax, [rcx+50h]
                test    al, 2
                jz      short loc_1402354E2

loc_140235468:                          ; CODE XREF: NtSetInformationFile+63F↑j
                test    edx, edx
                jnz     short loc_140235473
                mov     eax, [rcx+50h]
                test    al, 2
                jnz     short loc_1402354E2

loc_140235473:                          ; CODE XREF: NtSetInformationFile+64A↑j
                cmp     edx, 30h ; '0'
                jz      short loc_1402354E2
                mov     eax, [rcx+50h]
                test    al, 8
                jnz     short loc_140235495
                test    r8b, 2
                jz      short loc_14023548A
                or      eax, 10h
                jmp     short loc_14023548D
; ---------------------------------------------------------------------------

loc_14023548A:                          ; CODE XREF: NtSetInformationFile+663↑j
                and     eax, 0FFFFFFEFh

loc_14023548D:                          ; CODE XREF: NtSetInformationFile+668↑j
                mov     [rcx+50h], eax
                mov     rcx, [rsp+118h+var_E0]

loc_140235495:                          ; CODE XREF: NtSetInformationFile+65D↑j
                mov     eax, [r9]
                test    al, 4
                jz      short loc_1402354A2
                or      dword ptr [rcx+50h], 20h
                jmp     short loc_1402354A6
; ---------------------------------------------------------------------------

loc_1402354A2:                          ; CODE XREF: NtSetInformationFile+67A↑j
                and     dword ptr [rcx+50h], 0FFFFFFDFh

loc_1402354A6:                          ; CODE XREF: NtSetInformationFile+680↑j
                mov     rdx, [rsp+118h+var_E0]
                mov     ecx, [rdx+50h]
                test    cl, 2
                jz      short loc_1402354D4
                mov     eax, [r9]
                test    al, 10h
                jz      short loc_1402354CE
                or      ecx, 4
                mov     [rdx+50h], ecx
                xor     edi, edi
                mov     [rsi+30h], edi
                mov     [rsi+38h], rdi
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_1402354CE:                          ; CODE XREF: NtSetInformationFile+698↑j
                and     ecx, 0FFFFFFFBh
                mov     [rdx+50h], ecx

loc_1402354D4:                          ; CODE XREF: NtSetInformationFile+691↑j
                xor     edi, edi
                mov     [rsi+30h], edi
                mov     [rsi+38h], rdi
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_1402354E2:                          ; CODE XREF: NtSetInformationFile+62E↑j
                                        ; NtSetInformationFile+646↑j ...
                mov     edi, 0C000000Dh

loc_1402354E7:                          ; CODE XREF: NtSetInformationFile+834↓j
                                        ; NtSetInformationFile+991↓j ...
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_1402354F7:                          ; CODE XREF: NtSetInformationFile+61A↑j
                lea     eax, [r14-0Ah]
                cmp     eax, 3Eh ; '>'
                ja      loc_1402355A3
                mov     rcx, 4080000000200003h
                bt      rcx, rax
                jnb     loc_1402355A3
                mov     r8, [rsi+18h]
                mov     ecx, [r8+10h]
                test    ecx, ecx
                jz      short loc_140235531
                test    cl, 1
                jnz     short loc_140235531
                lea     eax, [r13-14h]
                cmp     eax, ecx
                jnb     short loc_14023553E

loc_140235531:                          ; CODE XREF: NtSetInformationFile+702↑j
                                        ; NtSetInformationFile+707↑j
                mov     edi, 0C000000Dh
                mov     [rsi+30h], edi
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_14023553E:                          ; CODE XREF: NtSetInformationFile+70F↑j
                cmp     r14d, 1Fh
                jnz     short loc_14023554D
                mov     eax, [r8]
                mov     [r15-28h], eax
                jmp     short loc_140235569
; ---------------------------------------------------------------------------

loc_14023554D:                          ; CODE XREF: NtSetInformationFile+722↑j
                cmp     r14d, 41h ; 'A'
                jz      short loc_14023555F
                cmp     r14d, 48h ; 'H'
                jz      short loc_14023555F
                movzx   eax, byte ptr [r8]
                jmp     short loc_140235565
; ---------------------------------------------------------------------------

loc_14023555F:                          ; CODE XREF: NtSetInformationFile+731↑j
                                        ; NtSetInformationFile+737↑j
                movzx   eax, byte ptr [r8]
                and     al, 1

loc_140235565:                          ; CODE XREF: NtSetInformationFile+73D↑j
                mov     [r15-28h], al

loc_140235569:                          ; CODE XREF: NtSetInformationFile+72B↑j
                cmp     word ptr [r8+14h], 5Ch ; '\'
                jz      short loc_14023557C
                cmp     qword ptr [r8+8], 0
                jz      loc_140235987

loc_14023557C:                          ; CODE XREF: NtSetInformationFile+74F↑j
                mov     r9, [rsp+118h+var_E0]
                mov     rdx, rsi
                lea     rcx, [rsp+118h+var_80]
                call    sub_1407060B4
                mov     edi, eax
                test    eax, eax
                jns     loc_140235987
                mov     [rsi+30h], eax
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_1402355A3:                          ; CODE XREF: NtSetInformationFile+6DE↑j
                                        ; NtSetInformationFile+6F2↑j
                cmp     r14d, 28h ; '('
                jnz     short loc_1402355DA
                mov     rcx, [rsi+18h]
                lea     eax, [r13-4]
                cmp     eax, [rcx]
                jnb     short loc_1402355C2
                mov     edi, 0C000000Dh
                mov     [rsi+30h], edi
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_1402355C2:                          ; CODE XREF: NtSetInformationFile+793↑j
                cmp     word ptr [rcx+4], 5Ch ; '\'
                jnz     loc_140235987
                mov     edi, 0C000000Dh
                mov     [rsi+30h], edi
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_1402355DA:                          ; CODE XREF: NtSetInformationFile+787↑j
                cmp     r14d, 0Dh
                jz      loc_140235964
                cmp     r14d, 40h ; '@'
                jz      loc_140235964
                cmp     r14d, 1Eh
                jnz     loc_140235734
                mov     r14, [rsi+18h]
                mov     rax, [rsp+118h+var_E0]
                cmp     qword ptr [rax+0B0h], 0
                jnz     loc_1402354E2
                mov     eax, [rax+50h]
                test    al, 2
                jnz     loc_1402354E2
                mov     r8, cs:IoCompletionObjectType
                mov     rcx, [r14]
                mov     [rsp+118h+var_C8], 0
                mov     [rsp+118h+var_F0], 0
                lea     rax, [rsp+118h+var_C8]
                mov     [rsp+118h+var_F8], rax
                movzx   r9d, [rsp+118h+var_E8]
                mov     edx, 2
                call    ObReferenceObjectByHandle
                mov     edi, eax
                test    eax, eax
                js      loc_1402354E7
                mov     edx, 18h
                mov     ecx, 200h
                mov     r8d, 63436F49h
                call    ExAllocatePoolWithTag
                mov     rbx, rax
                test    rax, rax
                jnz     short loc_140235692
                mov     rcx, [rsp+118h+var_C8]
                call    PsDereferenceSiloContext
                mov     edi, 0C000009Ah
                mov     [rsi+30h], edi
                mov     [rsi+38h], rbx
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_140235692:                          ; CODE XREF: NtSetInformationFile+855↑j
                mov     rcx, [rsp+118h+var_E0]
                add     rcx, 0B8h
                call    KeAcquireSpinLockRaiseToDpc
                mov     rcx, [rsp+118h+var_E0]
                movzx   edx, al
                cmp     qword ptr [rcx+0B0h], 0
                jnz     short loc_1402356FF
                and     dword ptr [rcx+50h], 0FFFFFBFFh
                mov     rcx, [rsp+118h+var_C8]
                mov     [rbx], rcx
                mov     rcx, [r14+8]
                mov     [rbx+8], rcx
                mov     qword ptr [rbx+10h], 0
                mov     rcx, [rsp+118h+var_E0]
                mov     [rcx+0B0h], rbx
                xor     edi, edi
                mov     rcx, [rsp+118h+var_E0]
                add     rcx, 0B8h
                call    KeReleaseSpinLock
                mov     [rsi+30h], edi
                mov     [rsi+38h], rdi
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_1402356FF:                          ; CODE XREF: NtSetInformationFile+893↑j
                add     rcx, 0B8h
                call    KeReleaseSpinLock
                xor     edx, edx
                mov     rcx, rbx
                call    ExFreePoolWithTag
                mov     rcx, [rsp+118h+var_C8]
                call    PsDereferenceSiloContext
                mov     edi, 0C0000048h
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_140235734:                          ; CODE XREF: NtSetInformationFile+7D2↑j
                cmp     r14d, 3Dh ; '='
                jnz     loc_1402357E6
                mov     r14, [rsi+18h]
                xor     ebx, ebx
                mov     [rsp+118h+var_68], rbx
                mov     rcx, [rsp+118h+var_E0]
                cmp     [rcx+0B0h], rbx
                jz      loc_1402354E2
                mov     rax, [r14]
                test    rax, rax
                jz      short loc_1402357AF
                mov     r8, cs:IoCompletionObjectType
                mov     [rsp+118h+var_98], rbx
                mov     [rsp+118h+var_F0], rbx
                lea     rcx, [rsp+118h+var_98]
                mov     [rsp+118h+var_F8], rcx
                movzx   r9d, [rsp+118h+var_E8]
                lea     edx, [rbx+2]
                mov     rcx, rax
                call    ObReferenceObjectByHandle
                mov     edi, eax
                mov     rbx, [rsp+118h+var_98]
                mov     [rsp+118h+var_68], rbx
                mov     rcx, [rsp+118h+var_E0]

loc_1402357AF:                          ; CODE XREF: NtSetInformationFile+944↑j
                test    edi, edi
                js      loc_1402354E7
                mov     r8, [r14+8]
                mov     rdx, rbx
                call    sub_14038CE5C
                mov     edi, eax
                test    rbx, rbx
                jz      loc_1402354E7
                mov     rcx, rbx
                call    PsDereferenceSiloContext
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_1402357E6:                          ; CODE XREF: NtSetInformationFile+918↑j
                cmp     r14d, 29h ; ')'
                jnz     short loc_14023585B
                mov     r8, [rsi+18h]
                mov     rax, [rsp+118h+var_E0]
                mov     edx, [rax+50h]
                test    dl, 2
                jz      short loc_140235812
                mov     edi, 0C000000Dh
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_140235812:                          ; CODE XREF: NtSetInformationFile+9DB↑j
                xor     edi, edi
                mov     ecx, [r8]
                test    cl, 1
                jz      short loc_14023582B
                bts     edx, 19h
                mov     [rax+50h], edx
                mov     ecx, [r8]
                mov     rax, [rsp+118h+var_E0]

loc_14023582B:                          ; CODE XREF: NtSetInformationFile+9FA↑j
                test    cl, 2
                jz      short loc_14023583F
                or      dword ptr [rax+50h], 4000000h
                mov     ecx, [r8]
                mov     rax, [rsp+118h+var_E0]

loc_14023583F:                          ; CODE XREF: NtSetInformationFile+A0E↑j
                test    cl, 4
                jz      short loc_14023584B
                or      dword ptr [rax+50h], 8000000h

loc_14023584B:                          ; CODE XREF: NtSetInformationFile+A22↑j
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_14023585B:                          ; CODE XREF: NtSetInformationFile+9CA↑j
                cmp     r14d, 2Ah ; '*'
                jnz     short loc_1402358C9
                movzx   ebx, [rsp+118h+var_E8]
                movzx   edx, bl
                mov     rcx, cs:qword_140D2E718
                call    SeSinglePrivilegeCheck
                test    al, al
                jnz     short loc_14023588E
                mov     edi, 0C0000061h
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359AC
; ---------------------------------------------------------------------------

loc_14023588E:                          ; CODE XREF: NtSetInformationFile+A57↑j
                mov     rcx, [rsp+118h+var_E0]
                mov     eax, [rcx+50h]
                test    al, 2
                jz      short loc_1402358AF
                mov     edi, 0C000000Dh
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359AC
; ---------------------------------------------------------------------------

loc_1402358AF:                          ; CODE XREF: NtSetInformationFile+A78↑j
                mov     rdx, rsi
                call    sub_140893FA4
                mov     edi, eax
                mov     [rsi+30h], eax
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359AC
; ---------------------------------------------------------------------------

loc_1402358C9:                          ; CODE XREF: NtSetInformationFile+A3F↑j
                cmp     r14d, 2Bh ; '+'
                jnz     short loc_140235923
                mov     [rsp+118h+var_90], 0
                mov     rbx, [rsi+18h]
                cmp     dword ptr [rbx], 2
                ja      loc_1402354E2
                lea     rdx, [rsp+118h+var_90]
                mov     rcx, [rsp+118h+var_E0]
                call    sub_14021AEE0
                mov     edi, eax
                test    eax, eax
                js      loc_1402354E7
                mov     ecx, [rbx]
                inc     ecx
                mov     rax, [rsp+118h+var_90]
                mov     [rax+50h], ecx
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     loc_1402359A7
; ---------------------------------------------------------------------------

loc_140235923:                          ; CODE XREF: NtSetInformationFile+AAD↑j
                cmp     r14d, 45h ; 'E'
                jnz     short loc_140235987
                movzx   ebx, [rsp+118h+var_E8]
                test    bl, bl
                jz      short loc_140235944
                mov     edi, 0C0000022h
                mov     [rsi+30h], edi
                mov     qword ptr [rsi+38h], 0
                jmp     short loc_1402359AC
; ---------------------------------------------------------------------------

loc_140235944:                          ; CODE XREF: NtSetInformationFile+B10↑j
                mov     r8d, r13d
                mov     rdx, [rsi+18h]
                mov     rcx, [rsp+118h+var_E0]
                call    sub_140895A6C
                mov     edi, eax
                mov     [rsi+30h], eax
                mov     qword ptr [rsi+38h], 0
                jmp     short loc_1402359AC
; ---------------------------------------------------------------------------

loc_140235964:                          ; CODE XREF: NtSetInformationFile+7BE↑j
                                        ; NtSetInformationFile+7C8↑j
                mov     rax, [rsi+18h]
                cmp     r14d, 40h ; '@'
                jnz     short loc_140235974
                mov     eax, [rax]
                test    al, 1
                jmp     short loc_140235979
; ---------------------------------------------------------------------------

loc_140235974:                          ; CODE XREF: NtSetInformationFile+B4C↑j
                movzx   eax, byte ptr [rax]
                test    al, al

loc_140235979:                          ; CODE XREF: NtSetInformationFile+B52↑j
                jz      short loc_140235987
                mov     rax, [rsp+118h+arg_0]
                mov     [r15-28h], rax

loc_140235987:                          ; CODE XREF: NtSetInformationFile+756↑j
                                        ; NtSetInformationFile+775↑j ...
                mov     dword ptr [rsp+118h+var_F8], 2
                mov     r9, [rsp+118h+var_E0]
                movzx   r8d, r12b
                mov     rdx, rsi
                mov     rcx, [rsp+118h+var_D0]
                call    sub_14030FD90
                mov     edi, eax

loc_1402359A7:                          ; CODE XREF: NtSetInformationFile+6A9↑j
                                        ; NtSetInformationFile+6BD↑j ...
                movzx   ebx, [rsp+118h+var_E8]

loc_1402359AC:                          ; CODE XREF: NtSetInformationFile+A69↑j
                                        ; NtSetInformationFile+A8A↑j ...
                cmp     edi, 103h
                jnz     loc_140235A38
                movzx   r8d, bl
                test    r12b, r12b
                jz      short loc_1402359D5
                mov     rdx, [rsp+118h+var_E0]
                mov     rcx, rsi
                call    sub_140201AE0
                mov     edi, eax
                jmp     loc_140235AFF
; ---------------------------------------------------------------------------

loc_1402359D5:                          ; CODE XREF: NtSetInformationFile+B9F↑j
                mov     [rsp+118h+var_F8], 0
                xor     r9d, r9d
                xor     edx, edx
                lea     rcx, [rsp+118h+var_C0]
                call    KeWaitForSingleObject
                cmp     eax, 101h
                jz      short loc_1402359FB
                cmp     eax, 0C0h
                jnz     short loc_140235A08

loc_1402359FB:                          ; CODE XREF: NtSetInformationFile+BD2↑j
                mov     rdx, rsi
                lea     rcx, [rsp+118h+var_C0]
                call    sub_14089280C

loc_140235A08:                          ; CODE XREF: NtSetInformationFile+BD9↑j
                mov     edi, dword ptr [rsp+118h+var_78]

loc_140235A0F:                          ; DATA XREF: .rdata:00000001400546F8↑o
;   __try { // __except at loc_140235A2C
                movups  xmm0, [rsp+118h+var_78]
                mov     rax, [rsp+118h+arg_8]
                movups  xmmword ptr [rax], xmm0
                movzx   eax, [rsp+118h+var_E7]
                jmp     loc_140235B0E
;   } // starts at 140235A0F
; ---------------------------------------------------------------------------

loc_140235A2C:                          ; DATA XREF: .rdata:00000001400546F8↑o
;   __except(1) // owned by 140235A0F
                mov     edi, eax
                movzx   eax, [rsp+118h+var_E7]
                jmp     loc_140235B0E
; ---------------------------------------------------------------------------

loc_140235A38:                          ; CODE XREF: NtSetInformationFile+B92↑j
                mov     [rsp+118h+var_A0], 0
                mov     [rsp+118h+var_88], 0
                test    r12b, r12b
                jnz     short loc_140235A5A
                mov     qword ptr [rsi+50h], 0

loc_140235A5A:                          ; CODE XREF: NtSetInformationFile+C30↑j
                mov     rax, [rsp+118h+arg_8]
                mov     [rsi+48h], rax
                mov     rbx, cr8
                mov     eax, 1
                mov     cr8, rax
                lea     rcx, [rsi+78h]
                lea     rax, [rsp+118h+var_88]
                mov     [rsp+118h+var_F8], rax
                lea     r9, [rsp+118h+var_E0]
                lea     r8, [rsp+118h+var_88]
                lea     rdx, [rsp+118h+var_A0]
                call    sub_14023D030
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140235AF3
                test    al, 1
                jz      short loc_140235AF3
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140235AF3
                cmp     bl, 0Fh
                ja      short loc_140235AF3
                cmp     al, 2
                jb      short loc_140235AF3
                mov     r10, gs:20h
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, bl
                inc     ecx
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                not     eax
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_140235AF3
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140235AF3:                          ; CODE XREF: NtSetInformationFile+C83↑j
                                        ; NtSetInformationFile+C87↑j ...
                movzx   eax, bl
                mov     cr8, rax
                test    r12b, r12b
                jz      short loc_140235B09

loc_140235AFF:                          ; CODE XREF: NtSetInformationFile+BB0↑j
                mov     rcx, [rsp+118h+var_E0]
                call    sub_1402481D0

loc_140235B09:                          ; CODE XREF: NtSetInformationFile+CDD↑j
                movzx   eax, [rsp+118h+var_E7]

loc_140235B0E:                          ; CODE XREF: NtSetInformationFile+C07↑j
                                        ; NtSetInformationFile+C13↑j
                test    al, al
                jz      short loc_140235B19
                mov     cl, 1
                call    KeSetKernelStackSwapEnable

loc_140235B19:                          ; CODE XREF: NtSetInformationFile+CF0↑j
                mov     rcx, [rsp+118h+var_80]
                test    rcx, rcx
                jz      short loc_140235B65
                xor     edx, edx
                call    ObCloseHandle
                jmp     short loc_140235B65
; ---------------------------------------------------------------------------

loc_140235B2F:                          ; DATA XREF: .rdata:00000001400546E8↑o
                                        ; .rdata:0000000140054718↑o
;   __except(1) // owned by 1402353C5
;   __except(1) // owned by 140235B86
                mov     ebx, eax
                mov     rcx, [rsp+118h+var_E0]
                movzx   edx, byte ptr [rcx+50h]
                shr     edx, 1
                and     edx, 1
                mov     byte ptr [rsp+118h+var_F8], dl
                xor     r9d, r9d
                xor     r8d, r8d
                mov     rdx, [rsp+118h+var_A0]
                call    sub_1405CD328
                cmp     [rsp+118h+var_E7], 0
                jz      short loc_140235B61
                mov     cl, 1
                call    KeSetKernelStackSwapEnable

loc_140235B61:                          ; CODE XREF: NtSetInformationFile+D38↑j
                mov     eax, ebx
                jmp     short loc_140235B67
; ---------------------------------------------------------------------------

loc_140235B65:                          ; CODE XREF: NtSetInformationFile+3DD↑j
                                        ; NtSetInformationFile+D04↑j ...
                mov     eax, edi

loc_140235B67:                          ; CODE XREF: NtSetInformationFile:loc_140234FDA↑j
                                        ; NtSetInformationFile+1C4↑j ...
                add     rsp, 0E0h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140235B7B:                          ; CODE XREF: NtSetInformationFile+10E↑j
                                        ; DATA XREF: .rdata:0000000140054708↑o
;   __try { // __except at loc_140234FDA
                call    ExRaiseDatatypeMisalignment
; ---------------------------------------------------------------------------

loc_140235B80:                          ; CODE XREF: NtSetInformationFile+12A↑j
                call    ExRaiseDatatypeMisalignment
; ---------------------------------------------------------------------------
                align 2
;   } // starts at 140235B7B

loc_140235B86:                          ; CODE XREF: NtSetInformationFile+5E1↑j
                                        ; DATA XREF: .rdata:0000000140054708↑o ...
;   __try { // __except at loc_140235B2F
                mov     ecx, 0C000000Dh
                call    RtlRaiseStatus
NtSetInformationFile endp

; ---------------------------------------------------------------------------
                db 90h
;   } // starts at 140235B86
byte_140235B91  db 0CCh                 ; DATA XREF: .rdata:0000000140054718↑o
; } // starts at 140234E20
algn_140235B92:                         ; DATA XREF: .pdata:00000001400CB664↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140235BA0   proc near               ; CODE XREF: sub_140641060+A6↓p
                                        ; sub_140641DA0+FE↓p ...

arg_0           = qword ptr  8

; FUNCTION CHUNK AT 000000014042CDA2 SIZE 00000034 BYTES

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 20h
                mov     r9, [rsp+28h]
                xor     r8d, r8d
                movzx   ebx, dl
                mov     rdi, rcx
                call    sub_140235D20
                test    rax, rax
                jz      loc_14042CDA2

loc_140235BC6:                          ; CODE XREF: sub_140235BA0+1F7213↓j
                                        ; sub_140235BA0+1F7231↓j
                or      byte ptr [rax+47h], 20h
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140235BA0   endp

algn_140235BD6:                         ; DATA XREF: .rdata:000000014005473C↑o
                                        ; .pdata:00000001400CB670↑o
                align 20h
; Exported entry 1170. KeGetCurrentThread
; Exported entry 1812. PsGetCurrentThread

; =============== S U B R O U T I N E =======================================


                public PsGetCurrentThread
PsGetCurrentThread proc near            ; DATA XREF: .rdata:0000000140008DC0↑o
                                        ; .rdata:0000000140008DD0↑o ...
                mov     rax, gs:188h    ; KeGetCurrentThread
                retn
PsGetCurrentThread endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_140235BEB:                         ; DATA XREF: .pdata:00000001400CB67C↑o
                align 20h
; Exported entry 872. IoGetRelatedDeviceObject

; =============== S U B R O U T I N E =======================================


                public IoGetRelatedDeviceObject
IoGetRelatedDeviceObject proc near      ; CODE XREF: NtSetInformationFile+275↑p
                                        ; sub_1402A2250+69↓p ...
                mov     rax, [rcx+10h]
                test    rax, rax
                jz      short loc_140235C35
                mov     rax, [rax+8]
                test    rax, rax
                jz      short loc_140235C35

loc_140235C12:                          ; CODE XREF: IoGetRelatedDeviceObject+4F↓j
                                        ; IoGetRelatedDeviceObject+87↓j
                mov     rdx, [rax+18h]
                test    rdx, rdx
                jz      short locret_140235C33
                mov     r8, [rcx+0D0h]
                test    r8, r8
                jnz     short loc_140235C51

loc_140235C27:                          ; CODE XREF: IoGetRelatedDeviceObject+31↓j
                                        ; IoGetRelatedDeviceObject+58↓j ...
                mov     rax, rdx
                mov     rdx, [rdx+18h]
                test    rdx, rdx
                jnz     short loc_140235C27

locret_140235C33:                       ; CODE XREF: IoGetRelatedDeviceObject+19↑j
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140235C35:                          ; CODE XREF: IoGetRelatedDeviceObject+7↑j
                                        ; IoGetRelatedDeviceObject+10↑j
                test    dword ptr [rcx+50h], 800h
                jnz     short loc_140235C4B
                mov     rax, [rcx+8]
                mov     rax, [rax+38h]
                test    rax, rax
                jnz     short loc_140235C80

loc_140235C4B:                          ; CODE XREF: IoGetRelatedDeviceObject+3C↑j
                                        ; IoGetRelatedDeviceObject+89↓j
                mov     rax, [rcx+8]
                jmp     short loc_140235C12
; ---------------------------------------------------------------------------

loc_140235C51:                          ; CODE XREF: IoGetRelatedDeviceObject+25↑j
                cmp     r8, cs:off_140C04810
                jz      short loc_140235C27
                mov     rcx, [r8+10h]
                test    rcx, rcx
                jz      short loc_140235C27
                mov     r8, [rcx]
                test    r8, r8
                jz      short loc_140235C27

loc_140235C6B:                          ; CODE XREF: IoGetRelatedDeviceObject+7C↓j
                cmp     rax, r8
                jnz     short loc_140235C75
                mov     rax, r8
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140235C75:                          ; CODE XREF: IoGetRelatedDeviceObject+6E↑j
                mov     rax, [rax+18h]
                test    rax, rax
                jnz     short loc_140235C6B
                jmp     short loc_140235C27
; ---------------------------------------------------------------------------

loc_140235C80:                          ; CODE XREF: IoGetRelatedDeviceObject+49↑j
                mov     rax, [rax+8]
                test    rax, rax
                jnz     short loc_140235C12
                jmp     short loc_140235C4B
IoGetRelatedDeviceObject endp

; ---------------------------------------------------------------------------
algn_140235C8B:                         ; DATA XREF: .pdata:00000001400CB688↑o
                align 20h
; Exported entry 1068. IofCallDriver

; =============== S U B R O U T I N E =======================================


                public IofCallDriver
IofCallDriver   proc near               ; CODE XREF: sub_14024CA90:loc_14024CABF↓p
                                        ; sub_1402A2250+1D2↓p ...

var_18          = qword ptr -18h

; FUNCTION CHUNK AT 000000014042CDD6 SIZE 00000039 BYTES

                sub     rsp, 38h
                mov     eax, cs:dword_140CFC664
                mov     r9, rcx
                test    eax, eax
                jnz     loc_14042CDEF
                dec     byte ptr [rdx+43h]
                movzx   eax, byte ptr [rdx+43h]
                test    al, al
                jle     loc_14042CDD6
                mov     rax, [rdx+0B8h]
                sub     rax, 48h ; 'H'
                mov     [rdx+0B8h], rax
                movzx   r8d, byte ptr [rax]
                mov     [rax+28h], rcx
                cmp     r8b, 16h
                jz      short loc_140235CFB

loc_140235CE4:                          ; CODE XREF: IofCallDriver+63↓j
                mov     rcx, [rcx+8]
                mov     rax, [rcx+r8*8+70h]
                mov     rcx, r9
                call    sub_1404079D0

loc_140235CF5:                          ; CODE XREF: IofCallDriver+1F715A↓j
                                        ; IofCallDriver+1F716A↓j
                add     rsp, 38h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140235CFB:                          ; CODE XREF: IofCallDriver+42↑j
                movzx   eax, byte ptr [rax+1]
                sub     al, 2
                cmp     al, 1
                ja      short loc_140235CE4
                mov     rcx, rdx
                call    sub_140398614
                add     rsp, 38h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
IofCallDriver   endp

algn_140235D13:                         ; DATA XREF: .rdata:0000000140054B4C↑o
                                        ; .pdata:00000001400CB694↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140235D20   proc near               ; CODE XREF: NtSetInformationFile+4EF↑p
                                        ; sub_140235BA0+18↑p ...

; FUNCTION CHUNK AT 000000014042CE10 SIZE 0000001B BYTES

                sub     rsp, 28h
                mov     eax, cs:dword_140CFC624
                test    eax, eax
                jnz     loc_14042CE10
                call    sub_140235D50

loc_140235D37:                          ; CODE XREF: sub_140235D20+1F70FB↓j
                                        ; sub_140235D20+1F7106↓j
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140235D20   endp

byte_140235D3D  db 13h dup(0CCh)        ; DATA XREF: .rdata:0000000140054B68↑o
                                        ; .pdata:00000001400CB6A0↑o

; =============== S U B R O U T I N E =======================================


sub_140235D50   proc near               ; CODE XREF: sub_140235D20+12↑p
                                        ; IoAllocateIrp+1E↓p ...

var_48          = qword ptr -48h
arg_0           = qword ptr  8
arg_8           = byte ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014042CE2C SIZE 00000032 BYTES

                mov     [rsp+arg_10], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                xor     r13b, r13b
                movzx   r15d, r8b
                movzx   esi, dl
                test    rcx, rcx
                jz      short loc_140235D89
                cmp     rcx, 0FFFFFFFFFFFFFFFFh
                jz      short loc_140235D82
                test    dword ptr [rcx+30h], 8000000h
                jz      short loc_140235D89

loc_140235D82:                          ; CODE XREF: sub_140235D50+27↑j
                add     sil, 2
                mov     r13b, 1

loc_140235D89:                          ; CODE XREF: sub_140235D50+21↑j
                                        ; sub_140235D50+30↑j
                mov     rdi, gs:20h
                mov     eax, cs:dword_140C45910
                test    al, 3
                setnz   cl
                test    al, 4
                setnz   al
                test    al, cl
                jz      short loc_140235DE1
                cmp     sil, 14h
                jge     short loc_140235DE1
                movsx   rax, sil
                lea     rcx, [rdi+rax*4]
                inc     dword ptr [rcx+87C0h]
                inc     dword ptr [rdi+8810h]
                mov     ecx, [rcx+87C0h]
                mov     eax, [rdi+rax*4+8814h]
                sub     ecx, eax
                cmp     ecx, cs:dword_140C45B84
                mov     edx, [rdi+8810h]
                ja      loc_140235F8D

loc_140235DE1:                          ; CODE XREF: sub_140235D50+54↑j
                                        ; sub_140235D50+5A↑j ...
                movsx   ecx, byte ptr cs:dword_140C457B8
                xor     ebx, ebx
                movsx   r12, sil
                mov     edx, 0D0h
                movzx   eax, r12w
                mov     [rsp+68h+arg_8], bl
                shl     ax, 3
                mov     [rsp+68h+arg_0], r12
                lea     r14d, [rax+r12]
                movsx   eax, byte ptr cs:dword_140C457BC
                shl     r14w, 3
                add     r14w, dx
                movzx   ebp, r14w
                cmp     sil, cl
                jg      loc_140235EAC
                test    r15b, r15b
                jnz     loc_140235FF3

loc_140235E2E:                          ; CODE XREF: sub_140235D50+2A9↓j
                mov     [rsp+68h+arg_8], 4
                cmp     sil, 1
                jz      loc_140236018
                cmp     sil, al
                jle     loc_140235FD9
                movzx   eax, cx
                mov     ebx, 20h ; ' '
                shl     ax, 3
                mov     r12d, 820h
                lea     ebp, [rax+rcx]

loc_140235E5B:                          ; CODE XREF: sub_140235D50+29E↓j
                shl     bp, 3
                add     bp, dx

loc_140235E62:                          ; CODE XREF: sub_140235D50+2CE↓j
                mov     r12, [r12+rdi]
                mov     rcx, r12
                mov     [rsp+68h+var_48], rbx
                inc     dword ptr [r12+14h]
                call    ExpInterlockedPopEntrySList
                mov     rbx, rax
                test    rax, rax
                jz      loc_140236023

loc_140235E84:                          ; CODE XREF: sub_140235D50+2F8↓j
                                        ; sub_140235D50+303↓j
                mov     eax, cs:dword_140C45910
                test    al, 3
                jz      short loc_140235EA7
                test    rbx, rbx
                jz      short loc_140235EA7
                mov     rcx, [rbx+38h]
                movzx   eax, r14w
                cmp     rcx, rax
                jb      loc_140236058
                movzx   ebp, cx

loc_140235EA7:                          ; CODE XREF: sub_140235D50+13C↑j
                                        ; sub_140235D50+141↑j
                mov     r12, [rsp+68h+arg_0]

loc_140235EAC:                          ; CODE XREF: sub_140235D50+CF↑j
                                        ; sub_140235D50+2AF↓j
                xor     r14b, r14b
                test    rbx, rbx
                jz      loc_140236067
                test    r15b, r15b
                jnz     loc_140236004

loc_140235EC1:                          ; CODE XREF: sub_140235D50+2BD↓j
                                        ; sub_140235D50+1F70E6↓j
                xor     r15b, r15b

loc_140235EC4:                          ; CODE XREF: sub_140235D50+33F↓j
                movzx   r8d, bp
                xor     edx, edx
                mov     rcx, rbx
                call    memset
                or      r14b, [rsp+68h+arg_8]
                mov     eax, 6
                mov     [rbx+42h], sil
                inc     sil
                mov     [rbx], ax
                mov     [rbx+43h], sil
                mov     [rbx+2], bp
                mov     rax, gs:188h
                movzx   ecx, byte ptr [rax+24Ah]
                lea     rax, [rbx+20h]
                mov     [rbx+46h], cl
                lea     rcx, ds:1Ah[r12*8]
                mov     [rax+8], rax
                add     rcx, r12
                mov     [rax], rax
                lea     rcx, [rbx+rcx*8]
                mov     [rbx+0B8h], rcx
                movzx   eax, word ptr [rdi+24h]
                mov     [rbx+4], ax
                mov     [rbx+47h], r14b
                test    r15b, r15b
                jnz     loc_1402360A0

loc_140235F37:                          ; CODE XREF: sub_140235D50+358↓j
                test    r13b, r13b
                jz      short loc_140235F71
                add     byte ptr [rbx+43h], 0FEh
                lea     rax, [rcx-90h]
                add     byte ptr [rbx+42h], 0FEh
                mov     [rbx+0B8h], rax
                mov     [rbx+0C8h], rax
                mov     eax, cs:dword_140CF49EC
                test    al, 4
                jnz     loc_14042CE3B

loc_140235F67:                          ; CODE XREF: sub_140235D50+1F70F3↓j
                xor     al, al

loc_140235F69:                          ; CODE XREF: sub_140235D50+1F70FB↓j
                test    al, al
                jnz     loc_14042CE50

loc_140235F71:                          ; CODE XREF: sub_140235D50+1EA↑j
                                        ; sub_140235D50+1F7109↓j
                mov     rax, rbx

loc_140235F74:                          ; CODE XREF: sub_140235D50:loc_1402360AD↓j
                mov     rbx, [rsp+68h+arg_10]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140235F8D:                          ; CODE XREF: sub_140235D50+8B↑j
                sub     edx, [rdi+8864h]
                cmp     edx, cs:dword_140C45B80
                jbe     loc_140235DE1
                prefetchw byte ptr cs:dword_140C45910
                mov     eax, cs:dword_140C45910

loc_140235FAC:                          ; CODE XREF: sub_140235D50+269↓j
                mov     ecx, eax
                and     ecx, 0FFFFFFFBh
                lock cmpxchg cs:dword_140C45910, ecx
                jnz     short loc_140235FAC
                test    al, 4
                jz      loc_140235DE1
                xor     r8d, r8d
                lea     rcx, unk_140C45CA0
                xor     edx, edx
                call    KeInsertQueueDpc
                jmp     loc_140235DE1
; ---------------------------------------------------------------------------

loc_140235FD9:                          ; CODE XREF: sub_140235D50+F0↑j
                movzx   ebp, ax
                mov     ebx, 10h
                shl     ax, 3
                mov     r12d, 810h
                add     bp, ax
                jmp     loc_140235E5B
; ---------------------------------------------------------------------------

loc_140235FF3:                          ; CODE XREF: sub_140235D50+D8↑j
                cmp     [rdi+2D9Ch], ebx
                jg      loc_140235E2E
                jmp     loc_140235EAC
; ---------------------------------------------------------------------------

loc_140236004:                          ; CODE XREF: sub_140235D50+16B↑j
                mov     eax, cs:dword_140CEC0F8
                cmp     eax, 1
                jle     loc_140235EC1
                jmp     loc_14042CE2C
; ---------------------------------------------------------------------------

loc_140236018:                          ; CODE XREF: sub_140235D50+E7↑j
                mov     r12d, 800h
                jmp     loc_140235E62
; ---------------------------------------------------------------------------

loc_140236023:                          ; CODE XREF: sub_140235D50+12E↑j
                inc     dword ptr [r12+18h]
                mov     rax, [rsp+68h+var_48]
                mov     r12, [rax+rdi+808h]
                mov     rcx, r12
                inc     dword ptr [r12+14h]
                call    ExpInterlockedPopEntrySList
                mov     rbx, rax
                test    rax, rax
                jnz     loc_140235E84
                inc     dword ptr [r12+18h]
                jmp     loc_140235E84
; ---------------------------------------------------------------------------

loc_140236058:                          ; CODE XREF: sub_140235D50+14E↑j
                inc     dword ptr [r12+1Ch]
                xor     edx, edx
                mov     rcx, rbx
                call    ExFreePoolWithTag

loc_140236067:                          ; CODE XREF: sub_140235D50+162↑j
                movzx   edx, bp
                mov     r8d, 20707249h
                test    r15b, r15b
                jnz     short loc_140236094
                mov     ecx, 200h
                call    ExAllocatePoolWithTag

loc_14023607F:                          ; CODE XREF: sub_140235D50+34E↓j
                mov     rbx, rax
                test    rax, rax
                jz      short loc_1402360AD
                mov     r12, [rsp+68h+arg_0]
                xor     r14b, r14b
                jmp     loc_140235EC4
; ---------------------------------------------------------------------------

loc_140236094:                          ; CODE XREF: sub_140235D50+323↑j
                mov     ecx, 208h
                call    ExAllocatePoolWithQuotaTag
                jmp     short loc_14023607F
; ---------------------------------------------------------------------------

loc_1402360A0:                          ; CODE XREF: sub_140235D50+1E1↑j
                or      r14b, 1
                mov     [rbx+47h], r14b
                jmp     loc_140235F37
; ---------------------------------------------------------------------------

loc_1402360AD:                          ; CODE XREF: sub_140235D50+335↑j
                jmp     loc_140235F74
sub_140235D50   endp

; ---------------------------------------------------------------------------
algn_1402360B2:                         ; DATA XREF: .rdata:0000000140054B94↑o
                                        ; .pdata:00000001400CB6AC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402360C0   proc near               ; CODE XREF: NtSetInformationFile+43A↑p
                                        ; sub_1403F1EF0+22↓p ...

arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014042CE5E SIZE 000000A3 BYTES

                push    rbx
                sub     rsp, 20h
                test    dword ptr [rcx+50h], 4000000h
                mov     rbx, rcx
                jnz     short loc_140236147

loc_1402360D2:                          ; DATA XREF: .rdata:0000000140054BB8↑o
                                        ; .rdata:0000000140054BD0↑o ...
                mov     [rsp+28h+arg_8], rbp
                mov     [rsp+28h+arg_10], rsi
                mov     [rsp+28h+arg_18], rdi
                mov     rdi, cr8
                mov     eax, 2
                mov     cr8, rax
                lea     rsi, [rax-3]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042CE5E

loc_140236100:                          ; CODE XREF: sub_1402360C0+1F6DA0↓j
                                        ; sub_1402360C0+1F6DAA↓j ...
                xor     ebp, ebp
                mov     [rsp+28h+arg_0], ebp
                lock bts dword ptr [rbx+98h], 7
                jb      short loc_140236150

loc_140236111:                          ; CODE XREF: sub_1402360C0+AD↓j
                mov     [rbx+9Ch], ebp
                lock and dword ptr [rbx+98h], 0FFFFFF7Fh
                mov     eax, cs:dword_140CFC660
                mov     rbp, [rsp+28h+arg_8]
                test    eax, eax
                jnz     loc_14042CE9F

loc_140236135:                          ; CODE XREF: sub_1402360C0+1F6DE1↓j
                                        ; sub_1402360C0+1F6DED↓j ...
                movzx   eax, dil
                mov     cr8, rax
                mov     rdi, [rsp+28h+arg_18]
                mov     rsi, [rsp+28h+arg_10]

loc_140236147:                          ; CODE XREF: sub_1402360C0+10↑j
                                        ; DATA XREF: .pdata:00000001400CB6D0↑o ...
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_140236150:                          ; CODE XREF: sub_1402360C0+4F↑j
                                        ; sub_1402360C0+A2↓j ...
                lea     rcx, [rsp+28h+arg_0]
                call    sub_1402C8C70
                mov     eax, [rbx+98h]
                test    al, al
                js      short loc_140236150
                lock bts dword ptr [rbx+98h], 7
                jnb     short loc_140236111
                jmp     short loc_140236150
sub_1402360C0   endp

; ---------------------------------------------------------------------------
algn_140236171:                         ; DATA XREF: .pdata:00000001400CB6E8↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140236180   proc near               ; CODE XREF: sub_1403F21B0+A7↓p
                                        ; sub_1405CD8DC+DE↓p ...
                mov     rax, gs:188h
                mov     r9, rcx
                mov     rcx, [rcx]
                mov     r10, [rdx]
                mov     rax, [rax+0B8h]
                mov     rax, [rax+580h]
                test    rax, rax
                jnz     short loc_1402361A7

locret_1402361A5:                       ; CODE XREF: sub_140236180+3A↓j
                                        ; sub_140236180+57↓j
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402361A7:                          ; CODE XREF: sub_140236180+23↑j
                movzx   r11d, word ptr [rax+8]
                mov     eax, 14Ch
                cmp     r11w, ax
                jnz     short loc_1402361CE

loc_1402361B7:                          ; CODE XREF: sub_140236180+59↓j
                test    r8b, r8b
                jnz     short locret_1402361A5
                mov     ecx, [rcx]
                or      r10, 1
                mov     eax, [rcx]
                mov     [rcx], eax
                mov     [r9], rcx
                mov     [rdx], r10
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402361CE:                          ; CODE XREF: sub_140236180+35↑j
                mov     eax, 1C4h
                cmp     r11w, ax
                jnz     short locret_1402361A5
                jmp     short loc_1402361B7
sub_140236180   endp

; ---------------------------------------------------------------------------
byte_1402361DB  db 15h dup(0CCh)        ; DATA XREF: .pdata:00000001400CB6F4↑o

; =============== S U B R O U T I N E =======================================


sub_1402361F0   proc near               ; CODE XREF: sub_1406431F0+AEF↓p
                                        ; sub_1406431F0+BD9↓p ...

var_88          = dword ptr -88h
var_68          = qword ptr -68h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
arg_0           = qword ptr  8
arg_10          = byte ptr  18h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 000000014042CF02 SIZE 0000010C BYTES

                mov     [rsp+arg_0], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 50h
                cmp     cs:dword_140C1D15C, 0
                mov     ebx, ecx
                jnz     loc_14042CF02

loc_140236213:                          ; CODE XREF: sub_1402361F0+1F6D2A↓j
                mov     esi, 1
                mov     [rsp+88h+arg_18], esi
                mov     edi, esi
                test    bl, 8
                jnz     loc_14042CF4B

loc_14023622A:                          ; CODE XREF: sub_1402361F0+1F6D67↓j
                mov     rax, gs:188h
                mov     ecx, ebx
                add     ebx, 8
                mov     rbp, [rax+0B8h]
                cmp     rbp, cs:PsInitialSystemProcess
                jz      loc_1402363ED

loc_14023624C:                          ; CODE XREF: sub_1402361F0+1FF↓j
                mov     r8d, 20206F49h
                mov     ecx, ebx
                call    ExAllocatePoolWithTag
                mov     r14, rax
                test    rax, 0FFFh
                jz      loc_1402363F4
                mov     eax, cs:dword_140C19184
                test    eax, eax
                jnz     loc_14042CF5C

loc_140236276:                          ; CODE XREF: sub_1402361F0+1F6D84↓j
                test    bl, 8
                jz      loc_1402363D1
                movzx   ecx, word ptr [r14-0Eh]
                lea     r15, [r14-10h]
                mov     rdx, cs:qword_140CFC9E8
                xor     edi, edi
                mov     rax, rdx
                movzx   r12d, cl
                xor     rax, r15
                shr     cx, 8
                mov     [r15+8], rax
                test    cl, 4
                jz      short loc_1402362C8
                movzx   eax, word ptr [r15]
                mov     rdi, r15
                movzx   ecx, al
                shl     rcx, 4
                sub     rdi, rcx
                xor     rdx, rdi
                movzx   eax, word ptr [rdi+2]
                movzx   r12d, al
                mov     [rdi+8], rdx

loc_1402362C8:                          ; CODE XREF: sub_1402361F0+B6↑j
                shl     r12, 4
                cmp     rbp, cs:PsInitialSystemProcess
                jz      loc_14023638E
                mov     rax, [rbp+568h]
                lea     rdx, byte_140CFCB50
                and     ebx, esi
                mov     r10d, ebx
                mov     [rsp+88h+var_50], r10
                lea     rcx, ds:0[rbx*8]
                shl     rbx, 7
                movzx   r8d, byte ptr [rcx+rdx]
                add     rbx, rax
                mov     [rsp+88h+arg_10], r8b
                mov     [rsp+88h+var_48], rcx
                prefetchw byte ptr [rbx]
                mov     r13, [rbx]
                lock or [rsp+88h+var_88], 0

loc_14023631D:                          ; CODE XREF: sub_1402361F0+157↓j
                mov     rax, [rbx+40h]

loc_140236321:                          ; CODE XREF: sub_1402361F0+277↓j
                mov     [rsp+88h+var_58], rax

loc_140236326:                          ; CODE XREF: sub_1402361F0+2B2↓j
                lea     rdx, [r12+r13]
                cmp     rdx, r13
                jb      loc_14042CF87
                cmp     rdx, rax
                ja      loc_14023643C
                mov     rax, r13
                lock cmpxchg [rbx], rdx
                mov     r13, rax
                jnz     short loc_14023631D
                prefetchw byte ptr [rbx+8]
                mov     rax, [rbx+8]
                cmp     rdx, rax
                ja      loc_140236420

loc_14023635A:                          ; CODE XREF: sub_1402361F0+23C↓j
                                        ; sub_1402361F0+247↓j
                test    r8b, 4
                jz      short loc_14023638E
                mov     rdx, r12
                lea     rax, ds:0[r10*8]
                lock xadd [rax+rbp+470h], rdx
                add     rdx, r12
                prefetchw byte ptr [rbp+r10*8+480h]
                mov     rax, [rbp+r10*8+480h]
                cmp     rdx, rax
                ja      short loc_140236400

loc_14023638E:                          ; CODE XREF: sub_1402361F0+E3↑j
                                        ; sub_1402361F0+16E↑j ...
                mov     rcx, cs:qword_140CFC9E8
                mov     rax, rcx
                xor     rax, r15
                xor     rax, rbp
                mov     [r15+8], rax
                test    rdi, rdi
                jz      short loc_1402363B1
                xor     rcx, rdi
                xor     rcx, rbp
                mov     [rdi+8], rcx

loc_1402363B1:                          ; CODE XREF: sub_1402361F0+1B5↑j
                cmp     cs:dword_140CFB010, 0
                jnz     loc_14042CFC6

loc_1402363BE:                          ; CODE XREF: sub_1402361F0+1F6DED↓j
                lock xadd [rbp-30h], rsi
                inc     rsi
                cmp     rsi, 1
                jle     loc_14042CFE2

loc_1402363D1:                          ; CODE XREF: sub_1402361F0+89↑j
                                        ; sub_1402361F0+207↓j ...
                mov     rax, r14

loc_1402363D4:                          ; CODE XREF: sub_1402361F0+1F6D56↓j
                mov     rbx, [rsp+88h+arg_0]
                add     rsp, 50h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402363ED:                          ; CODE XREF: sub_1402361F0+56↑j
                mov     ebx, ecx
                jmp     loc_14023624C
; ---------------------------------------------------------------------------

loc_1402363F4:                          ; CODE XREF: sub_1402361F0+72↑j
                test    r14, r14
                jnz     short loc_1402363D1
                jmp     loc_14042CFFB
; ---------------------------------------------------------------------------
                align 20h

loc_140236400:                          ; CODE XREF: sub_1402361F0+19C↑j
                                        ; sub_1402361F0+1F6D8C↓j
                mov     rcx, rax
                lock cmpxchg [rbp+r10*8+480h], rdx
                cmp     rax, rcx
                jz      loc_14023638E
                jmp     loc_14042CF79
; ---------------------------------------------------------------------------
                align 20h

loc_140236420:                          ; CODE XREF: sub_1402361F0+164↑j
                                        ; sub_1402361F0+245↓j
                mov     rcx, rax
                lock cmpxchg [rbx+8], rdx
                cmp     rax, rcx
                jz      loc_14023635A
                cmp     rdx, rax
                ja      short loc_140236420
                jmp     loc_14023635A
; ---------------------------------------------------------------------------

loc_14023643C:                          ; CODE XREF: sub_1402361F0+146↑j
                test    sil, r8b
                jz      loc_14042CF87
                cmp     qword ptr [rbx+50h], 0
                jz      loc_14042CF87
                xor     ecx, ecx
                xchg    rcx, [rbx+48h]
                test    rcx, rcx
                jz      short loc_14023646C
                mov     rax, rcx
                lock xadd [rbx+40h], rax
                add     rax, rcx
                jmp     loc_140236321
; ---------------------------------------------------------------------------

loc_14023646C:                          ; CODE XREF: sub_1402361F0+269↑j
                lea     rax, [rsp+88h+var_58]
                mov     r9, r12
                mov     r8, r13
                mov     [rsp+88h+var_68], rax
                mov     rdx, rbx
                mov     ecx, r10d
                call    sub_140352228
                test    al, al
                jz      loc_14042CF87
                mov     rax, [rsp+88h+var_58]
                mov     r10, [rsp+88h+var_50]
                movzx   r8d, [rsp+88h+arg_10]
                jmp     loc_140236326
sub_1402361F0   endp

; ---------------------------------------------------------------------------
algn_1402364A7:                         ; DATA XREF: .rdata:0000000140054C60↑o
                                        ; .pdata:00000001400CB700↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402364B0   proc near               ; CODE XREF: sub_1402369F0+74B↓p
                                        ; sub_1402E76F0+111↓p ...

var_48          = qword ptr -48h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h
arg_20          = word ptr  28h
arg_28          = byte ptr  30h

; FUNCTION CHUNK AT 000000014042D00E SIZE 0000033B BYTES

                mov     [rsp+arg_10], r8
                mov     [rsp+arg_8], edx
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                xor     r14d, r14d
                mov     rax, rcx
                shr     rax, 0Ch
                mov     esi, r9d
                mov     eax, eax
                mov     r13d, r9d
                imul    r12, rax, 9E5Fh
                and     esi, 20h
                mov     [rsp+68h+var_48], r14
                mov     rdi, rcx

loc_1402364F1:                          ; CODE XREF: sub_1402364B0+1F6C74↓j
                                        ; sub_1402364B0+1F6CFD↓j
                mov     rcx, 0FFFFFFFFFFFFFFFFh
                lea     eax, [rcx+3]

loc_1402364FB:                          ; CODE XREF: sub_1402364B0+24E↓j
                mov     rbx, r12
                shr     rbx, 20h
                xor     rbx, r12
                mov     r15, cr8
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042D00E

loc_14023651B:                          ; CODE XREF: sub_1402364B0+1F6B60↓j
                                        ; sub_1402364B0+1F6B6A↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14042D052
                mov     rdi, gs:20h
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_14042D068

loc_140236541:                          ; CODE XREF: sub_1402364B0+1F6BBC↓j
                                        ; sub_1402364B0+1F6BCB↓j ...
                prefetchw byte ptr cs:dword_140C19198
                mov     eax, cs:dword_140C19198
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg cs:dword_140C19198, ecx
                jnz     loc_1402367A1

loc_140236563:                          ; CODE XREF: sub_1402364B0+311↓j
                mov     rdi, [rsp+68h+arg_0]

loc_140236568:                          ; CODE XREF: sub_1402364B0+1F6BB3↓j
                test    esi, esi
                jnz     loc_140236709
                mov     rdx, cs:qword_140C191B8
                lea     r9, dword_140D23100
                mov     r10, cs:qword_140C191B0

loc_140236585:                          ; CODE XREF: sub_1402364B0+275↓j
                test    rdx, rdx
                jz      loc_14023669F
                movsxd  rax, dword ptr [r9]
                cmp     rax, r10
                jz      loc_14023669F
                lea     rax, [r10-1]
                and     rax, rbx
                mov     eax, eax
                lea     rcx, [rax+rax*2]
                lea     rcx, [rdx+rcx*8]
                lea     rax, [r10+r10*2]
                mov     r8, rcx
                lea     r11, [rdx+rax*8]

loc_1402365B6:                          ; CODE XREF: sub_1402364B0+1E9↓j
                mov     rax, [rcx]
                test    al, 1
                jz      loc_140236685
                lock cmpxchg [rcx], rdi
                jnz     loc_140236685
                mov     eax, [rsp+68h+arg_8]
                movzx   r8d, [rsp+68h+arg_20]
                mov     [rcx+8], eax
                movzx   eax, [rsp+68h+arg_28]
                mov     [rcx+0Ch], al
                mov     eax, r13d
                and     eax, 0FFFh
                shl     r8d, 0Ch
                or      r8d, eax
                mov     eax, [rcx+0Ch]
                movzx   edx, al
                mov     rax, [rsp+68h+arg_10]
                shl     r8d, 8
                or      r8d, edx
                mov     [rcx+10h], rax
                mov     [rcx+0Ch], r8d
                lock inc dword ptr [r9]
                cmp     r14d, 10h
                jnb     loc_14023672A

loc_140236621:                          ; CODE XREF: sub_1402364B0+281↓j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14042D297
                lock and cs:dword_140C19198, 0BFFFFFFFh
                lock dec cs:dword_140C19198

loc_140236640:                          ; CODE XREF: sub_1402364B0+1F6DF9↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042D2AE

loc_140236659:                          ; CODE XREF: sub_1402364B0+1F6E02↓j
                                        ; sub_1402364B0+1F6E11↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042D2D2

loc_140236667:                          ; CODE XREF: sub_1402364B0+1F6D80↓j
                                        ; sub_1402364B0+1F6D88↓j ...
                movzx   eax, r15b
                mov     cr8, rax

loc_14023666F:                          ; CODE XREF: sub_1402364B0+2D3↓j
                                        ; sub_1402364B0+2E9↓j
                mov     eax, 1

loc_140236674:                          ; CODE XREF: sub_1402364B0+1F6E94↓j
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140236685:                          ; CODE XREF: sub_1402364B0+10B↑j
                                        ; sub_1402364B0+116↑j
                lea     rax, [rcx+18h]
                inc     r14d
                cmp     rax, r11
                mov     rcx, rdx
                cmovb   rcx, rax
                cmp     rcx, r8
                jnz     loc_1402365B6

loc_14023669F:                          ; CODE XREF: sub_1402364B0+D8↑j
                                        ; sub_1402364B0+E4↑j
                lea     rcx, dword_140C19198
                call    ExTryConvertSharedSpinLockExclusive
                test    eax, eax
                jz      loc_14042D0B6
                lea     r8, [rsp+68h+var_48]
                mov     ecx, r13d
                call    sub_140375608
                lea     rcx, dword_140C19198
                mov     ebx, eax
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jnz     loc_14042D129

loc_1402366DC:                          ; CODE XREF: sub_1402364B0+1F6C7C↓j
                                        ; sub_1402364B0+1F6C89↓j ...
                movzx   eax, r15b
                mov     cr8, rax
                test    ebx, ebx
                jz      loc_14042D33C
                mov     rbx, [rsp+68h+var_48]
                mov     rcx, 0FFFFFFFFFFFFFFFFh
                lea     eax, [rcx+3]
                test    rbx, rbx
                jz      loc_1402364FB
                jmp     loc_14042D196
; ---------------------------------------------------------------------------

loc_140236709:                          ; CODE XREF: sub_1402364B0+BA↑j
                mov     rax, cs:qword_140C4DC60
                mov     rdx, [rax+3E0h]
                lea     r9, [rax+360h]
                mov     r10, [rax+3E8h]
                jmp     loc_140236585
; ---------------------------------------------------------------------------

loc_14023672A:                          ; CODE XREF: sub_1402364B0+16B↑j
                shr     r10, 2
                cmp     [r9], r10d
                jbe     loc_140236621
                lea     rcx, dword_140C19198
                call    ExTryConvertSharedSpinLockExclusive
                cmp     eax, 1
                jnz     loc_14042D21C
                lea     r8, [rsp+68h+var_48]
                mov     ecx, r13d
                call    sub_140375608
                lea     rcx, dword_140C19198
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042D1B2

loc_140236773:                          ; CODE XREF: sub_1402364B0+1F6D04↓j
                                        ; sub_1402364B0+1F6D10↓j ...
                movzx   eax, r15b
                mov     cr8, rax
                mov     rbx, [rsp+68h+var_48]
                test    rbx, rbx
                jz      loc_14023666F

loc_140236789:                          ; CODE XREF: sub_1402364B0+2EF↓j
                mov     rcx, rbx
                xor     edx, edx
                mov     rbx, [rbx]
                call    ExFreePoolWithTag
                test    rbx, rbx
                jz      loc_14023666F
                jmp     short loc_140236789
; ---------------------------------------------------------------------------

loc_1402367A1:                          ; CODE XREF: sub_1402364B0+AD↑j
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_14042D08F

loc_1402367B1:                          ; CODE XREF: sub_1402364B0+1F6BE3↓j
                                        ; sub_1402364B0+1F6BF2↓j ...
                movzx   edx, r15b
                lea     rcx, dword_140C19198
                call    sub_140329420
                jmp     loc_140236563
sub_1402364B0   endp

; ---------------------------------------------------------------------------
algn_1402367C6:                         ; DATA XREF: .rdata:0000000140054C88↑o
                                        ; .pdata:00000001400CB70C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402367D0   proc near               ; CODE XREF: sub_14023A280+28F↓p
                                        ; sub_140316EF8+65↓p ...

arg_0           = qword ptr  8

                movzx   eax, word ptr [r8+2]
                lea     r9, [r8+100Fh]
                movzx   r10d, word ptr cs:xmmword_140C1DC20+2
                and     r9, 0FFFFFFFFFFFFF000h
                mov     [rsp+arg_0], rcx
                mov     r11, rdx
                mov     ecx, r8d
                mov     rdx, r9
                shr     ecx, 10h
                sub     rdx, r8
                xor     eax, ecx
                xor     eax, r10d
                mov     ecx, eax
                shl     rcx, 4
                cmp     rdx, rcx
                jnb     loc_1402368B5
                add     r9, 0FFFFFFFFFFFFFFE0h
                mov     ecx, r8d
                shr     ecx, 10h
                xorps   xmm0, xmm0
                mov     rdx, r9
                sub     rdx, r8
                sar     rdx, 4
                xor     cx, dx
                sub     eax, edx
                xor     cx, r10w
                mov     [r8+2], cx
                movups  xmmword ptr [r9], xmm0
                mov     r8d, eax
                movups  xmmword ptr [r9+10h], xmm0
                mov     [r9+2], ax
                mov     [r9+4], dx
                mov     rcx, [r9]
                xor     rcx, qword ptr cs:xmmword_140C1DC20
                xor     rcx, r9
                shl     r8, 4
                mov     [r9], rcx
                add     r8, r9
                movzx   ecx, word ptr [r11+20h]
                add     rcx, 3
                shl     rcx, 4
                add     rcx, r11
                cmp     r8, rcx
                jnb     short loc_1402368B0
                mov     rdx, qword ptr cs:xmmword_140C1DC20
                movzx   ecx, ax
                mov     [rsp+arg_0], 0
                mov     dword ptr [rsp+arg_0+4], ecx
                mov     rcx, [rsp+arg_0]
                shr     rcx, 20h
                shr     rdx, 20h
                xor     dx, cx
                mov     rcx, r8
                shr     rcx, 20h
                xor     dx, cx
                mov     [r8+4], dx

loc_1402368B0:                          ; CODE XREF: sub_1402367D0+A8↑j
                mov     rax, r9
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402368B5:                          ; CODE XREF: sub_1402367D0+3D↑j
                xor     eax, eax
                retn
sub_1402367D0   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_1402368B9:                         ; DATA XREF: .pdata:00000001400CB718↑o
                align 20h
; Exported entry 188. ExAllocatePoolWithTagPriority

; =============== S U B R O U T I N E =======================================


                public ExAllocatePoolWithTagPriority
ExAllocatePoolWithTagPriority proc near ; CODE XREF: sub_14036D5A0+B14CA↓p
                                        ; sub_1402159F0+21039F↓p ...

var_18          = dword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014042D34A SIZE 00000014 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 30h
                mov     ebx, r9d
                mov     ebp, r8d
                mov     rsi, rdx
                mov     edi, ecx
                cmp     r9d, 20h ; ' '
                jz      short loc_1402368FB
                test    dil, 2
                jnz     short loc_1402368FB
                mov     r8d, ebx
                call    sub_140238E40
                test    eax, eax
                jz      loc_14042D34A

loc_1402368FB:                          ; CODE XREF: ExAllocatePoolWithTagPriority+23↑j
                                        ; ExAllocatePoolWithTagPriority+29↑j ...
                xor     edx, edx
                test    bl, 8
                jnz     short loc_140236946

loc_140236902:                          ; CODE XREF: ExAllocatePoolWithTagPriority+8B↓j
                mov     rax, gs:20h
                mov     r8d, ebp
                mov     [rsp+38h+var_18], edx
                mov     rdx, rsi
                mov     rcx, [rax+0C0h]
                movzx   r9d, word ptr [rcx+92h]
                mov     ecx, edi
                bts     r9d, 1Fh
                call    sub_140236960

loc_140236930:                          ; CODE XREF: ExAllocatePoolWithTagPriority+1F6A99↓j
                mov     rbx, [rsp+38h+arg_0]
                mov     rbp, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                add     rsp, 30h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140236946:                          ; CODE XREF: ExAllocatePoolWithTagPriority+40↑j
                mov     edx, 1
                jmp     short loc_140236902
ExAllocatePoolWithTagPriority endp

; ---------------------------------------------------------------------------
algn_14023694D:                         ; DATA XREF: .rdata:0000000140054D6C↑o
                                        ; .pdata:00000001400CB724↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140236960   proc near               ; CODE XREF: ExAllocatePoolWithTagPriority+6B↑p
                                        ; sub_140268720+81↓p ...

var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h
arg_20          = dword ptr  28h

; FUNCTION CHUNK AT 000000014042D35E SIZE 00000087 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 30h
                mov     ebp, r8d
                mov     rsi, rdx
                mov     edi, ecx
                test    r9d, r9d
                jns     short loc_1402369E2
                movzx   r14d, cs:word_140CFB000

loc_14023698D:                          ; CODE XREF: sub_140236960+88↓j
                mov     r15d, [rsp+48h+arg_20]
                mov     ebx, r9d
                btr     ebx, 1Fh
                mov     [rsp+48h+arg_18], 0
                test    r9d, r9d
                cmovns  ebx, r9d
                mov     eax, ebx

loc_1402369AA:                          ; CODE XREF: sub_140236960+1F6A13↓j
                mov     r9d, eax
                mov     dword ptr [rsp+48h+var_28], r15d
                mov     r8d, ebp
                mov     rdx, rsi
                mov     ecx, edi
                call    sub_1402369F0
                test    rax, rax
                jz      loc_14042D35E

loc_1402369C8:                          ; CODE XREF: sub_140236960+1F6A80↓j
                mov     rbx, [rsp+48h+arg_0]
                mov     rbp, [rsp+48h+arg_8]
                mov     rsi, [rsp+48h+arg_10]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402369E2:                          ; CODE XREF: sub_140236960+23↑j
                mov     r14d, 1
                jmp     short loc_14023698D
sub_140236960   endp

; ---------------------------------------------------------------------------
algn_1402369EA:                         ; DATA XREF: .rdata:0000000140054D98↑o
                                        ; .pdata:00000001400CB730↑o
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=4Fh

sub_1402369F0   proc near               ; CODE XREF: sub_140236960+5A↑p
                                        ; ExAllocatePoolWithTag+5F↓p
                                        ; DATA XREF: ...

var_110         = qword ptr -110h
var_108         = qword ptr -108h
var_100         = word ptr -100h
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = dword ptr -0D0h
var_CC          = dword ptr -0CCh
var_C8          = qword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = xmmword ptr -0A8h
var_98          = qword ptr -98h
var_90          = xmmword ptr -90h
var_80          = qword ptr -80h
var_78          = xmmword ptr -78h
var_68          = qword ptr -68h
var_60          = xmmword ptr -60h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
arg_0           = dword ptr  10h
arg_8           = qword ptr  18h
arg_10          = dword ptr  20h
arg_20          = dword ptr  30h

; FUNCTION CHUNK AT 000000014042D3E6 SIZE 0000058E BYTES

                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r14
                push    r15
                lea     rbp, [rsp-1Fh]
                sub     rsp, 100h
                xor     r14d, r14d
                mov     ebx, r9d
                mov     r15d, ecx
                mov     [rsp+130h+var_F0], r14
                shr     r15d, 9
                mov     eax, ecx
                and     r15d, 2
                and     eax, 44h
                mov     esi, r8d
                mov     rdi, rdx
                mov     r8d, ecx
                cmp     al, 44h ; 'D'
                jz      loc_14042D3E6

loc_140236A33:                          ; CODE XREF: sub_1402369F0+1F69FA↓j
                mov     edx, cs:dword_140CFC550
                test    r8d, 201h
                mov     r12d, r8d
                mov     r10d, 1
                setz    cl
                bt      edx, 0Ah
                setb    al
                bts     r12d, 9
                and     cl, al
                cmovz   r12d, r8d
                test    dl, 8
                jnz     loc_14042D3EF

loc_140236A67:                          ; CODE XREF: sub_1402369F0+1F6A32↓j
                mov     r9d, [rbp+4Fh+arg_20]

loc_140236A6B:                          ; CODE XREF: sub_1402369F0+1F6A47↓j
                and     esi, 7FFFFFFFh
                mov     [rbp+4Fh+arg_10], esi
                jz      loc_14042D43C

loc_140236A7A:                          ; CODE XREF: sub_1402369F0+1F6A54↓j
                                        ; DATA XREF: .rdata:0000000140054DF0↑o ...
                mov     [rsp+130h+arg_8], r13
                cmp     rdi, 0FE0h
                ja      short loc_140236AA4
                mov     r8d, cs:dword_140CFC560
                test    r8d, r8d
                jnz     loc_14042D449

loc_140236A9B:                          ; CODE XREF: sub_1402369F0+1F6A5C↓j
                                        ; sub_1402369F0+1F6A77↓j ...
                test    r10b, r9b
                jnz     loc_14042D47A

loc_140236AA4:                          ; CODE XREF: sub_1402369F0+99↑j
                                        ; sub_1402369F0+1F6ACB↓j
                test    rdi, rdi
                jz      loc_14042D4C0

loc_140236AAD:                          ; CODE XREF: sub_1402369F0+1F6AD3↓j
                cmp     ebx, 80000000h
                jz      loc_14042D4EA
                movzx   eax, cs:word_140CFB000
                cmp     ebx, eax
                jnb     loc_14042D4C8
                cmp     ebx, 80000000h
                jz      loc_14042D4EA

loc_140236AD4:                          ; CODE XREF: sub_1402369F0+1F6B11↓j
                cmp     ebx, cs:dword_140C57F10
                jnb     loc_14042D506

loc_140236AE0:                          ; CODE XREF: sub_1402369F0+1F6B19↓j
                mov     eax, ebx
                imul    rcx, rax, 20C0h
                lea     rax, qword_140C57F40
                add     rcx, rax
                test    r12d, r12d
                js      loc_14023739D
                mov     eax, r12d
                and     eax, 21h
                cmp     al, 21h ; '!'
                jz      loc_140236EE9
                test    r12b, 1
                jz      loc_140236DEF
                mov     eax, 2

loc_140236B19:                          ; CODE XREF: sub_1402369F0+407↓j
                                        ; sub_1402369F0+410↓j
                mov     r13, [rcx+rax*8]

loc_140236B1D:                          ; CODE XREF: sub_1402369F0+51E↓j
                                        ; sub_1402369F0+9B1↓j
                cmp     rdi, 0FE0h
                ja      loc_140236FA7
                lea     rsi, [rdi+10h]
                test    r12b, 4
                jnz     loc_140236F13

loc_140236B38:                          ; CODE XREF: sub_1402369F0+533↓j
                                        ; sub_1402369F0+540↓j
                add     rsi, 0Fh
                lea     r8, cs:140000000h
                and     rsi, 0FFFFFFFFFFFFFFF0h
                cmp     rsi, 201h
                jnb     loc_140236E3C

loc_140236B54:                          ; CODE XREF: sub_1402369F0+453↓j
                                        ; sub_1402369F0+478↓j ...
                mov     rcx, [r13+30h]
                mov     ebx, [r13+14h]
                mov     rax, rcx
                or      ebx, r15d
                and     ebx, 93000F0Bh
                test    rcx, rcx
                jnz     loc_14042D71F
                mov     rax, cs:qword_140C1DC48
                test    rax, rax
                jnz     loc_14042D71F

loc_140236B81:                          ; CODE XREF: sub_1402369F0+1F6D32↓j
                mov     dword ptr [rsp+130h+var_E8], r14d
                mov     rax, r14
                mov     [rbp+4Fh+var_B8], rax
                bt      ebx, 18h
                jb      short loc_140236BA3
                mov     ecx, [r13+18h]
                mov     dword ptr [rsp+130h+var_E8], ecx
                test    ecx, ecx
                jnz     loc_14042D754

loc_140236BA3:                          ; CODE XREF: sub_1402369F0+1A1↑j
                                        ; sub_1402369F0+1F6DA9↓j
                lea     r15, [rax+rsi]
                bt      ebx, 1Ch
                jb      loc_14042D79E

loc_140236BB1:                          ; CODE XREF: sub_1402369F0+1F6DB2↓j
                test    ebx, 20000F08h
                jnz     loc_14042D7A7

loc_140236BBD:                          ; CODE XREF: sub_1402369F0+1F6DC3↓j
                test    r15, r15
                jz      loc_14042D7B8

loc_140236BC6:                          ; CODE XREF: sub_1402369F0+1F6DCB↓j
                cmp     r15, rsi
                jb      loc_140237533
                mov     rax, 7FFFFFFFFFFFFFFFh
                cmp     rsi, rax
                ja      loc_140237533
                movzx   eax, word ptr [r13+37Ch]
                mov     edx, ebx
                and     edx, 13000003h
                sub     eax, 10h
                mov     [rbp+4Fh+arg_0], edx
                cmp     r15, rax
                ja      loc_140237234
                lea     rdi, [r13+340h]
                mov     r9d, r15d
                cmp     esi, r15d
                jnz     loc_14042D7C0

loc_140236C14:                          ; CODE XREF: sub_1402369F0+1F6DD4↓j
                lea     eax, [r9+0Fh]
                shr     eax, 4
                movzx   eax, byte ptr [rax+r8+112F0h]
                add     rax, 10h
                lea     rax, [rdi+rax*8]
                mov     [rsp+130h+var_D8], rax
                mov     rax, [rax]
                test    al, 1
                jnz     loc_1402374B9

loc_140236C3C:                          ; CODE XREF: sub_1402369F0+ADC↓j
                test    cs:dword_140C1DC00, 400h
                mov     r8d, 80h
                mov     r10, [rsp+130h+var_D8]
                movzx   ecx, byte ptr [rdi+38h]
                mov     r10, [r10]
                jnz     loc_14042D7C9

loc_140236C5E:                          ; CODE XREF: sub_1402369F0+1F6DDF↓j
                lea     rax, [rcx-1]
                mov     [rbp+4Fh+var_48], r8
                and     eax, 7
                sub     rcx, rax
                lea     r11, [rcx+7]
                add     r11, r8
                cmp     byte ptr [r10+2], 1
                mov     [rbp+4Fh+var_40], r11
                jnz     loc_140236ECA
                xor     al, al

loc_140236C84:                          ; CODE XREF: sub_1402369F0+4F4↓j
                movzx   eax, al
                lea     r8, [r11+r10]
                mov     dword ptr [rsp+130h+var_110], edx
                mov     r9d, esi
                mov     rdx, r10
                mov     rcx, rdi
                mov     r8, [r8+rax*8]
                call    sub_140237620
                mov     edx, [rbp+4Fh+arg_0]
                mov     rdi, rax
                test    rax, rax
                jz      short loc_140236CB5
                test    dl, 2
                jnz     loc_14023721F

loc_140236CB5:                          ; CODE XREF: sub_1402369F0+2BA↑j
                                        ; sub_1402369F0+83F↓j ...
                cmp     rdi, 0FFFFFFFFFFFFFFFFh
                jz      loc_140237234

loc_140236CBF:                          ; CODE XREF: sub_1402369F0+88F↓j
                                        ; sub_1402369F0+899↓j ...
                test    rdi, rdi
                jz      loc_1402375CD
                test    ebx, 30000F08h
                jnz     loc_14042D827

loc_140236CD4:                          ; CODE XREF: sub_1402369F0+B46↓j
                                        ; sub_1402369F0+1F6E61↓j ...
                test    rdi, rdi
                jz      loc_1402375CD

loc_140236CDD:                          ; CODE XREF: sub_1402369F0+4C2↓j
                mov     r10d, [rbp+4Fh+arg_10]
                mov     rax, rsi
                shr     rax, 4
                xorps   xmm0, xmm0
                mov     [rdi+2], al
                movzx   eax, r12b
                and     al, 6Dh
                mov     [rdi+4], r10d
                or      al, 2
                mov     [rdi], r14b
                movzx   edx, al
                xor     eax, eax
                mov     [rbp+4Fh+var_80], rax
                mov     [rdi+3], dl
                mov     eax, cs:dword_140CFB0F8
                mov     [rbp+4Fh+arg_0], edx
                movups  [rbp+4Fh+var_90], xmm0
                cmp     r10d, eax
                jz      loc_14042D8B7

loc_140236D1F:                          ; CODE XREF: sub_1402369F0+1F6EC8↓j
                mov     eax, dword ptr cs:xmmword_140CFC480+4
                test    al, 41h
                jnz     loc_14042D8BD

loc_140236D2D:                          ; CODE XREF: sub_1402369F0+1F6EEA↓j
                and     edx, 20h
                mov     dword ptr [rsp+130h+var_E8], edx
                jnz     loc_140237205
                mov     eax, gs:1A4h
                mov     r8, cs:qword_140C16978
                mov     r11, cs:qword_140C16960
                mov     ecx, eax
                lea     rax, cs:140000000h
                mov     r13, rva qword_140C16980[rax+rcx*8]

loc_140236D61:                          ; CODE XREF: sub_1402369F0+82A↓j
                mov     eax, r10d
                imul    rcx, rax, 9E5Fh
                mov     [rsp+130h+var_E0], r11
                mov     rbx, rcx
                mov     [rsp+130h+var_D8], r8
                shr     rbx, 20h
                xor     ebx, ecx
                and     ebx, r8d
                mov     r9d, ebx
                mov     dword ptr [rsp+130h+var_F0], ebx

loc_140236D88:                          ; CODE XREF: sub_1402369F0+428↓j
                                        ; sub_1402369F0+A45↓j ...
                mov     ecx, ebx
                imul    r15, rcx, 38h ; '8'
                mov     eax, [r15+r13]
                lea     r14, [r15+r13]
                cmp     eax, r10d
                jnz     short loc_140236E05
                test    byte ptr [rbp+4Fh+arg_0], 1
                jz      loc_140236E2F
                mov     eax, 20h ; ' '
                mov     ecx, 28h ; '('

loc_140236DAF:                          ; CODE XREF: sub_1402369F0+447↓j
                lock inc qword ptr [r14+rcx]
                lock xadd [r14+rax], rsi

loc_140236DBA:                          ; CODE XREF: sub_1402369F0+43D↓j
                test    r12b, 4
                jnz     loc_140236F35

loc_140236DC4:                          ; CODE XREF: sub_1402369F0+55A↓j
                                        ; sub_1402369F0+5B2↓j
                lea     r14, [rdi+10h]

loc_140236DC8:                          ; CODE XREF: sub_1402369F0+810↓j
                                        ; sub_1402369F0+973↓j ...
                test    r14, r14
                jz      loc_14042D95F

loc_140236DD1:                          ; CODE XREF: sub_1402369F0+1F6F73↓j
                mov     r13, [rsp+130h+arg_8]
                mov     rax, r14

loc_140236DDC:                          ; CODE XREF: sub_1402369F0+1F6A26↓j
                                        ; DATA XREF: .pdata:00000001400CB748↑o ...
                add     rsp, 100h
                pop     r15
                pop     r14
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140236DEF:                          ; CODE XREF: sub_1402369F0+11E↑j
                                        ; DATA XREF: .pdata:00000001400CB754↑o ...
                mov     rax, r14
                bt      r12d, 9
                jnb     loc_140236B19
                mov     rax, r10
                jmp     loc_140236B19
; ---------------------------------------------------------------------------

loc_140236E05:                          ; CODE XREF: sub_1402369F0+3A9↑j
                test    eax, eax
                jz      loc_1402373B9

loc_140236E0D:                          ; CODE XREF: sub_1402369F0+9D8↓j
                lea     eax, [rbx+1]
                and     eax, r8d
                mov     ebx, eax
                cmp     eax, r9d
                jnz     loc_140236D88
                mov     r8d, [rbp+4Fh+arg_0]
                mov     rdx, rsi
                mov     ecx, r10d
                call    sub_140347CEC
                jmp     short loc_140236DBA
; ---------------------------------------------------------------------------

loc_140236E2F:                          ; CODE XREF: sub_1402369F0+3AF↑j
                mov     eax, 8
                lea     ecx, [rax+8]
                jmp     loc_140236DAF
; ---------------------------------------------------------------------------

loc_140236E3C:                          ; CODE XREF: sub_1402369F0+15E↑j
                cmp     rsi, 0F80h
                ja      loc_140236B54
                shr     esi, 4
                movzx   ecx, byte ptr [rsi+r8+112F0h]
                movzx   esi, ds:rva word_140011810[r8+rcx*2]
                lea     eax, [rcx-21h]
                mov     rcx, [r13+28h]
                test    rcx, rcx
                jz      loc_140236B54
                mov     ebx, eax
                inc     rbx
                shl     rbx, 6
                add     rbx, rcx
                inc     dword ptr [rbx+14h]
                cmp     [rbx], r14w
                jbe     loc_140237320
                mov     rcx, rbx
                call    ExpInterlockedPopEntrySList
                mov     rdi, rax
                test    rax, rax
                jz      loc_140237320

loc_140236E9B:                          ; CODE XREF: sub_1402369F0+936↓j
                test    rdi, rdi
                jz      loc_1402372F3

loc_140236EA4:                          ; CODE XREF: sub_1402369F0+92B↓j
                                        ; sub_1402369F0+A86↓j ...
                bt      r12d, 0Ah
                jb      loc_140237368

loc_140236EAF:                          ; CODE XREF: sub_1402369F0+98E↓j
                test    rdi, rdi
                jnz     loc_140236CDD

loc_140236EB8:                          ; CODE XREF: sub_1402369F0+97B↓j
                mov     r10d, 1
                lea     r8, cs:140000000h
                jmp     loc_140236B54
; ---------------------------------------------------------------------------

loc_140236ECA:                          ; CODE XREF: sub_1402369F0+28C↑j
                mov     rax, gs:188h
                lea     r9, [r8+r10]
                movzx   r8d, byte ptr [rax+625h]
                movzx   eax, byte ptr [r8+r9]
                jmp     loc_140236C84
; ---------------------------------------------------------------------------

loc_140236EE9:                          ; CODE XREF: sub_1402369F0+114↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+558h]
                mov     rcx, [rax+2A0h]
                mov     r13, [rcx+38E0h]
                jmp     loc_140236B1D
; ---------------------------------------------------------------------------

loc_140236F13:                          ; CODE XREF: sub_1402369F0+142↑j
                mov     eax, cs:dword_140CFC5C0
                add     rsi, rax
                cmp     rsi, 0FE0h
                jbe     loc_140236B38
                sub     rsi, rax
                and     r12d, 0FFFFFFFBh
                jmp     loc_140236B38
; ---------------------------------------------------------------------------

loc_140236F35:                          ; CODE XREF: sub_1402369F0+3CE↑j
                and     byte ptr [rdi+3], 0FBh
                mov     ecx, 0FFFFFFF0h
                mov     eax, cs:dword_140CFC5C0
                sub     ecx, edi
                dec     eax
                and     ecx, eax
                jz      loc_140236DC4
                mov     edx, ecx
                add     rdx, rdi
                mov     rcx, rdx
                sub     rcx, rdi
                sar     rcx, 4
                mov     [rdx], cl
                movzx   eax, byte ptr [rdi+2]
                sub     al, cl
                mov     ecx, 0FFh
                mov     [rdx+2], al
                movzx   eax, byte ptr [rdi+1]
                mov     [rdx+1], al
                movzx   eax, byte ptr [rdi+3]
                or      al, 4
                mov     [rdx+3], al
                mov     eax, [rdi+4]
                mov     [rdx+4], eax
                movzx   eax, word ptr [rdx]
                and     ax, cx
                cmp     ax, 1
                jbe     short loc_140236F9F
                mov     rax, rdx
                xor     rax, cs:qword_140CFC9E8
                mov     [rdi+10h], rax

loc_140236F9F:                          ; CODE XREF: sub_1402369F0+59F↑j
                mov     rdi, rdx
                jmp     loc_140236DC4
; ---------------------------------------------------------------------------

loc_140236FA7:                          ; CODE XREF: sub_1402369F0+134↑j
                lea     rbx, [rdi+0Fh]
                and     rbx, 0FFFFFFFFFFFFFFF0h
                mov     eax, ebx
                and     eax, 0FFFh
                cmp     rbx, 10000h
                jnb     loc_1402373A6
                cmp     eax, 0FC0h
                ja      loc_1402373A6

loc_140236FCE:                          ; CODE XREF: sub_1402369F0+9C4↓j
                cmp     rbx, rdi
                jb      loc_1402375CD
                lea     rdi, cs:140000000h
                test    ebx, 0FFFh
                jz      loc_1402372A4

loc_140236FEA:                          ; CODE XREF: sub_1402369F0+8BE↓j
                mov     rdx, [r13+30h]
                mov     rcx, r14
                mov     edi, [r13+14h]
                mov     rax, rdx
                or      edi, r15d
                mov     [rbp+4Fh+var_C8], rcx
                and     edi, 93000F0Bh
                test    rdx, rdx
                jnz     loc_14042D50E
                mov     rax, cs:qword_140C1DC48
                test    rax, rax
                jnz     loc_14042D50E

loc_14023701E:                          ; CODE XREF: sub_1402369F0+1F6B21↓j
                mov     dword ptr [rsp+130h+var_E8], r14d
                bt      edi, 18h
                jb      short loc_140237039
                mov     eax, [r13+18h]
                mov     dword ptr [rsp+130h+var_E8], eax
                test    eax, eax
                jnz     loc_14042D543

loc_140237039:                          ; CODE XREF: sub_1402369F0+637↑j
                                        ; sub_1402369F0+1F6B98↓j
                lea     r15, [rcx+rbx]
                bt      edi, 1Ch
                jb      loc_14042D58D

loc_140237047:                          ; CODE XREF: sub_1402369F0+1F6BA1↓j
                test    edi, 20000F08h
                jnz     loc_14042D596

loc_140237053:                          ; CODE XREF: sub_1402369F0+1F6BB2↓j
                test    r15, r15
                jz      loc_14042D5A7

loc_14023705C:                          ; CODE XREF: sub_1402369F0+1F6BBA↓j
                cmp     r15, rbx
                jb      loc_1402375B4
                mov     rax, 7FFFFFFFFFFFFFFFh
                cmp     rbx, rax
                ja      loc_1402375B4
                movzx   eax, word ptr [r13+37Ch]
                mov     edx, edi
                and     edx, 13000003h
                sub     eax, 10h
                mov     [rbp+4Fh+arg_0], edx
                mov     r8d, r15d
                cmp     r15, rax
                jbe     loc_1402375E0

loc_14023709A:                          ; CODE XREF: sub_1402369F0+C19↓j
                cmp     r15, 20000h
                ja      loc_1402374DE
                xor     eax, eax
                mov     [rsp+130h+var_D0], r14d
                mov     [rbp+4Fh+var_68], rax
                lea     rcx, [r13+280h]
                lea     rax, [rsp+130h+var_D0]
                xorps   xmm0, xmm0
                mov     [rsp+130h+var_108], rax
                mov     r9d, edx
                lea     rax, [rbp+4Fh+var_78]
                mov     edx, ebx
                mov     [rsp+130h+var_110], rax
                movups  [rbp+4Fh+var_78], xmm0
                call    sub_140239150
                mov     rcx, rax
                mov     [rsp+130h+var_F0], rax
                cmp     [rsp+130h+var_D0], r14d
                jz      short loc_140237107
                test    byte ptr [rbp+4Fh+arg_0], 1
                jnz     short loc_140237107
                mov     ecx, [r13+288h]
                lea     rdx, [rbp+4Fh+var_78]
                call    sub_1403175C0
                mov     rcx, [rsp+130h+var_F0]

loc_140237107:                          ; CODE XREF: sub_1402369F0+6FA↑j
                                        ; sub_1402369F0+700↑j ...
                test    rcx, rcx
                jz      short loc_140237118
                test    edi, 30000F08h
                jnz     loc_14042D5E1

loc_140237118:                          ; CODE XREF: sub_1402369F0+71A↑j
                                        ; sub_1402369F0+BCC↓j ...
                lea     rdi, cs:140000000h

loc_14023711F:                          ; CODE XREF: sub_1402369F0+8FE↓j
                test    rcx, rcx
                jz      loc_14042D95F
                mov     byte ptr [rsp+130h+var_108], r14b
                mov     r9d, r12d
                mov     r8, rbx
                mov     word ptr [rsp+130h+var_110], r14w
                mov     edx, esi
                call    sub_1402364B0
                test    eax, eax
                jz      loc_1402375CD
                xor     eax, eax
                xorps   xmm0, xmm0
                mov     [rbp+4Fh+var_98], rax
                mov     eax, cs:dword_140CFB0F8
                movups  [rbp+4Fh+var_A8], xmm0
                cmp     esi, eax
                jz      loc_14042D687

loc_140237163:                          ; CODE XREF: sub_1402369F0+1F6C98↓j
                mov     eax, dword ptr cs:xmmword_140CFC480+4
                test    al, 41h
                jnz     loc_14042D68D

loc_140237171:                          ; CODE XREF: sub_1402369F0+1F6CB8↓j
                mov     r15d, r12d
                and     r15d, 20h
                jnz     loc_140237383
                mov     eax, gs:1A4h
                mov     r13, cs:qword_140C16978
                mov     r10, cs:qword_140C16960
                mov     rdx, rva qword_140C16980[rdi+rax*8]

loc_14023719C:                          ; CODE XREF: sub_1402369F0+9A8↓j
                mov     eax, esi
                imul    rcx, rax, 9E5Fh
                mov     [rsp+130h+var_E8], r10
                mov     rdi, rcx
                mov     [rsp+130h+var_E0], rdx
                shr     rdi, 20h
                xor     edi, ecx
                and     edi, r13d
                mov     r9d, edi
                mov     [rbp+4Fh+arg_0], edi

loc_1402371C1:                          ; CODE XREF: sub_1402369F0+95B↓j
                                        ; sub_1402369F0+B3E↓j ...
                mov     r8d, edi
                imul    rcx, r8, 38h ; '8'
                mov     eax, [rcx+rdx]
                lea     r14, [rcx+rdx]
                mov     [rsp+130h+var_D8], rcx
                cmp     eax, esi
                jnz     loc_140237338
                test    r12b, 1
                jnz     loc_14023732B
                mov     eax, 8
                mov     ecx, 10h

loc_1402371F0:                          ; CODE XREF: sub_1402369F0+943↓j
                lock inc qword ptr [r14+rcx]
                lock xadd [r14+rax], rbx
                mov     r14, [rsp+130h+var_F0]
                jmp     loc_140236DC8
; ---------------------------------------------------------------------------

loc_140237205:                          ; CODE XREF: sub_1402369F0+344↑j
                mov     r13, cs:qword_140C19188
                mov     r8, cs:qword_140C16968
                mov     r11, cs:qword_140C19190
                jmp     loc_140236D61
; ---------------------------------------------------------------------------

loc_14023721F:                          ; CODE XREF: sub_1402369F0+2BF↑j
                mov     r8d, esi
                xor     edx, edx
                mov     rcx, rax
                call    memset
                mov     edx, [rbp+4Fh+arg_0]
                jmp     loc_140236CB5
; ---------------------------------------------------------------------------

loc_140237234:                          ; CODE XREF: sub_1402369F0+20B↑j
                                        ; sub_1402369F0+2C9↑j
                cmp     r15, 20000h
                ja      loc_14042D7D4
                xor     ecx, ecx
                mov     [rbp+4Fh+var_CC], r14d
                mov     [rbp+4Fh+var_50], rcx
                xorps   xmm0, xmm0
                lea     rcx, [rbp+4Fh+var_CC]
                mov     r9d, edx
                mov     [rsp+130h+var_108], rcx
                mov     r8d, r15d
                lea     rcx, [rbp+4Fh+var_60]
                mov     edx, esi
                mov     [rsp+130h+var_110], rcx
                lea     rcx, [r13+280h]
                movups  [rbp+4Fh+var_60], xmm0
                call    sub_140239150
                mov     rdi, rax
                cmp     [rbp+4Fh+var_CC], r14d
                jz      loc_140236CBF
                test    byte ptr [rbp+4Fh+arg_0], 1
                jnz     loc_140236CBF
                mov     ecx, [r13+288h]
                lea     rdx, [rbp+4Fh+var_60]
                call    sub_1403175C0
                jmp     loc_140236CBF
; ---------------------------------------------------------------------------

loc_1402372A4:                          ; CODE XREF: sub_1402369F0+5F4↑j
                mov     eax, [r13+1D0h]
                cmp     rbx, rax
                ja      loc_140236FEA
                mov     eax, [r13+110h]
                lea     rcx, [r13+100h]
                mov     edx, r12d
                shr     edx, 9
                and     edx, 2
                cmp     rbx, rax
                ja      loc_140237490

loc_1402372D4:                          ; CODE XREF: sub_1402369F0+AA7↓j
                mov     dword ptr [rsp+130h+var_110], edx
                mov     r9, rbx
                mov     rdx, rbx
                mov     r8, rbx
                call    sub_14029BC30
                mov     rcx, rax
                mov     [rsp+130h+var_F0], rax
                jmp     loc_14023711F
; ---------------------------------------------------------------------------

loc_1402372F3:                          ; CODE XREF: sub_1402369F0+4AE↑j
                movzx   edx, word ptr [rbx+10h]
                movzx   ecx, word ptr [rbx]
                mov     [rbp+4Fh+var_C0], r14
                mov     [rbp+4Fh+var_B0], r14
                mov     eax, edx
                mov     r8d, r14d
                sub     eax, ecx
                cmp     ecx, edx
                cmovb   r8d, eax
                shr     r8d, 1
                jnz     loc_14023743A
                mov     rdi, r14
                jmp     loc_140236EA4
; ---------------------------------------------------------------------------

loc_140237320:                          ; CODE XREF: sub_1402369F0+491↑j
                                        ; sub_1402369F0+4A5↑j
                inc     dword ptr [rbx+18h]
                mov     rdi, r14
                jmp     loc_140236E9B
; ---------------------------------------------------------------------------

loc_14023732B:                          ; CODE XREF: sub_1402369F0+7F0↑j
                mov     eax, 20h ; ' '
                lea     ecx, [rax+8]
                jmp     loc_1402371F0
; ---------------------------------------------------------------------------

loc_140237338:                          ; CODE XREF: sub_1402369F0+7E6↑j
                test    eax, eax
                jz      loc_140237516

loc_140237340:                          ; CODE XREF: sub_1402369F0+B5E↓j
                lea     eax, [rdi+1]
                and     eax, r13d
                mov     edi, eax
                cmp     eax, r9d
                jnz     loc_1402371C1
                mov     r8d, r12d
                mov     rdx, rbx
                mov     ecx, esi
                call    sub_140347CEC
                mov     r14, [rsp+130h+var_F0]
                jmp     loc_140236DC8
; ---------------------------------------------------------------------------

loc_140237368:                          ; CODE XREF: sub_1402369F0+4B9↑j
                test    rdi, rdi
                jz      loc_140236EB8
                mov     r8, rsi
                xor     edx, edx
                mov     rcx, rdi
                call    memset
                jmp     loc_140236EAF
; ---------------------------------------------------------------------------

loc_140237383:                          ; CODE XREF: sub_1402369F0+788↑j
                mov     rdx, cs:qword_140C19188
                mov     r13, cs:qword_140C16968
                mov     r10, cs:qword_140C19190
                jmp     loc_14023719C
; ---------------------------------------------------------------------------

loc_14023739D:                          ; CODE XREF: sub_1402369F0+106↑j
                mov     r13, [rcx+18h]
                jmp     loc_140236B1D
; ---------------------------------------------------------------------------

loc_1402373A6:                          ; CODE XREF: sub_1402369F0+5CD↑j
                                        ; sub_1402369F0+5D8↑j
                add     rbx, 0FFFh
                and     rbx, 0FFFFFFFFFFFFF000h
                jmp     loc_140236FCE
; ---------------------------------------------------------------------------

loc_1402373B9:                          ; CODE XREF: sub_1402369F0+417↑j
                test    edx, edx
                jz      loc_14023749C

loc_1402373C1:                          ; CODE XREF: sub_1402369F0+B21↓j
                lea     rax, [r11-1]
                cmp     rcx, rax
                jz      loc_140236E0D
                test    edx, edx
                jnz     loc_14023753B
                lea     rdx, [rbp+4Fh+var_90]
                lea     rcx, qword_140C191A0
                call    KeAcquireInStackQueuedSpinLock
                mov     rcx, cs:qword_140C191C8
                cmp     dword ptr [rcx+r15], 0
                jnz     short loc_1402373FE
                mov     eax, [rbp+4Fh+arg_10]
                mov     [rcx+r15], eax
                mov     [r14], eax

loc_1402373FE:                          ; CODE XREF: sub_1402369F0+A02↑j
                lea     rcx, [rbp+4Fh+var_90]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   r14d, byte ptr [rbp+4Fh+var_80]
                test    eax, eax
                jnz     loc_14042D8DF

loc_14023741A:                          ; CODE XREF: sub_1402369F0+1F6EF1↓j
                                        ; sub_1402369F0+1F6EFD↓j ...
                mov     cr8, r14
                mov     edx, dword ptr [rsp+130h+var_E8]
                mov     r10d, [rbp+4Fh+arg_10]
                mov     r8, [rsp+130h+var_D8]
                mov     r9d, dword ptr [rsp+130h+var_F0]
                mov     r11, [rsp+130h+var_E0]
                jmp     loc_140236D88
; ---------------------------------------------------------------------------

loc_14023743A:                          ; CODE XREF: sub_1402369F0+922↑j
                lea     rax, [rbp+4Fh+var_B0]
                inc     r8d
                mov     [rsp+130h+var_108], rax
                lea     rcx, [r13+280h]
                lea     rax, [rbp+4Fh+var_C0]
                xor     r9d, r9d
                mov     edx, esi
                mov     [rsp+130h+var_110], rax
                call    sub_1403174E4
                test    eax, eax
                jz      loc_14042D717
                mov     rdi, [rbp+4Fh+var_C0]
                mov     rdx, [rdi]
                mov     [rbp+4Fh+var_C0], rdx
                add     eax, 0FFFFFFFFh
                jz      loc_140236EA4
                mov     r8, [rbp+4Fh+var_B0]
                mov     r9d, eax
                mov     rcx, rbx
                call    InterlockedPushListSList
                jmp     loc_140236EA4
; ---------------------------------------------------------------------------

loc_140237490:                          ; CODE XREF: sub_1402369F0+8DE↑j
                lea     rcx, [r13+1C0h]
                jmp     loc_1402372D4
; ---------------------------------------------------------------------------

loc_14023749C:                          ; CODE XREF: sub_1402369F0+9CB↑j
                mov     rax, cs:qword_140C191C8
                mov     r11d, [r15+rax]
                test    r11d, r11d
                jz      short loc_14023750C
                mov     [r14], r11d
                mov     r11, [rsp+130h+var_E0]
                jmp     loc_140236D88
; ---------------------------------------------------------------------------

loc_1402374B9:                          ; CODE XREF: sub_1402369F0+246↑j
                mov     r8d, r10d
                mov     edx, r9d
                mov     rcx, rdi
                call    sub_1403165D8
                mov     edx, [rbp+4Fh+arg_0]
                test    eax, eax
                jnz     loc_140236C3C
                mov     rdi, 0FFFFFFFFFFFFFFFFh
                jmp     loc_140236CB5
; ---------------------------------------------------------------------------

loc_1402374DE:                          ; CODE XREF: sub_1402369F0+6B1↑j
                mov     eax, [r13+1D0h]
                cmp     r15, rax
                jbe     loc_14042D5AF
                mov     r9d, edx
                mov     r8, r15
                mov     rdx, rbx
                mov     rcx, r13
                call    sub_140315B54

loc_1402374FF:                          ; CODE XREF: sub_1402369F0+1F6BEC↓j
                mov     [rsp+130h+var_F0], rax
                mov     rcx, rax
                jmp     loc_140237107
; ---------------------------------------------------------------------------

loc_14023750C:                          ; CODE XREF: sub_1402369F0+ABA↑j
                mov     r11, [rsp+130h+var_E0]
                jmp     loc_1402373C1
; ---------------------------------------------------------------------------

loc_140237516:                          ; CODE XREF: sub_1402369F0+94A↑j
                test    r15d, r15d
                jnz     short loc_140237547
                mov     rax, cs:qword_140C191C8
                mov     r11d, [rcx+rax]
                test    r11d, r11d
                jz      short loc_140237547
                mov     [r14], r11d
                jmp     loc_1402371C1
; ---------------------------------------------------------------------------

loc_140237533:                          ; CODE XREF: sub_1402369F0+1D9↑j
                                        ; sub_1402369F0+1EC↑j
                mov     rdi, r14
                jmp     loc_140236CD4
; ---------------------------------------------------------------------------

loc_14023753B:                          ; CODE XREF: sub_1402369F0+9E0↑j
                xor     eax, eax
                lock cmpxchg [r14], r10d
                jmp     loc_140236D88
; ---------------------------------------------------------------------------

loc_140237547:                          ; CODE XREF: sub_1402369F0+B29↑j
                                        ; sub_1402369F0+B39↑j
                lea     rax, [r10-1]
                cmp     r8, rax
                jz      loc_140237340
                test    r15d, r15d
                jnz     short loc_1402375C1
                lea     rdx, [rbp+4Fh+var_A8]
                lea     rcx, qword_140C191A0
                call    KeAcquireInStackQueuedSpinLock
                mov     rax, cs:qword_140C191C8
                mov     rdx, [rsp+130h+var_D8]
                cmp     [rdx+rax], r15d
                jnz     short loc_140237581
                mov     [rdx+rax], esi
                mov     [r14], esi

loc_140237581:                          ; CODE XREF: sub_1402369F0+B89↑j
                lea     rcx, [rbp+4Fh+var_A8]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   r14d, byte ptr [rbp+4Fh+var_98]
                test    eax, eax
                jnz     loc_14042D6AD

loc_14023759D:                          ; CODE XREF: sub_1402369F0+1F6CBF↓j
                                        ; sub_1402369F0+1F6CCB↓j ...
                mov     cr8, r14
                mov     rdx, [rsp+130h+var_E0]
                mov     r9d, [rbp+4Fh+arg_0]
                mov     r10, [rsp+130h+var_E8]
                jmp     loc_1402371C1
; ---------------------------------------------------------------------------

loc_1402375B4:                          ; CODE XREF: sub_1402369F0+66F↑j
                                        ; sub_1402369F0+682↑j ...
                mov     rcx, r14
                mov     [rsp+130h+var_F0], rcx
                jmp     loc_140237118
; ---------------------------------------------------------------------------

loc_1402375C1:                          ; CODE XREF: sub_1402369F0+B67↑j
                xor     eax, eax
                lock cmpxchg [r14], esi
                jmp     loc_1402371C1
; ---------------------------------------------------------------------------

loc_1402375CD:                          ; CODE XREF: sub_1402369F0+2D2↑j
                                        ; sub_1402369F0+2E7↑j ...
                mov     rax, [rsp+130h+var_F0]
                test    rax, rax
                jnz     loc_14042D949
                jmp     loc_14042D95F
; ---------------------------------------------------------------------------

loc_1402375E0:                          ; CODE XREF: sub_1402369F0+6A4↑j
                mov     r9d, edx
                lea     rcx, [r13+340h]
                mov     edx, ebx
                call    sub_140316534
                mov     [rsp+130h+var_F0], rax
                mov     rcx, rax
                mov     r8d, r15d
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jnz     loc_140237107
                mov     edx, [rbp+4Fh+arg_0]
                jmp     loc_14023709A
sub_1402369F0   endp

; ---------------------------------------------------------------------------
algn_14023760E:                         ; DATA XREF: .pdata:00000001400CB760↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=40h

sub_140237620   proc near               ; CODE XREF: sub_1402369F0+2AC↑p
                                        ; sub_140392460+65↓p
                                        ; DATA XREF: ...

var_120         = qword ptr -120h
var_118         = dword ptr -118h
var_110         = qword ptr -110h
var_100         = byte ptr -100h
var_FF          = byte ptr -0FFh
var_FC          = dword ptr -0FCh
var_F8          = byte ptr -0F8h
var_F7          = byte ptr -0F7h
var_F4          = dword ptr -0F4h
var_F0          = dword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = dword ptr -0E0h
var_DC          = dword ptr -0DCh
var_D8          = dword ptr -0D8h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = dword ptr -0B8h
var_B4          = dword ptr -0B4h
var_B0          = dword ptr -0B0h
var_AC          = dword ptr -0ACh
var_A8          = dword ptr -0A8h
var_A4          = dword ptr -0A4h
var_A0          = dword ptr -0A0h
var_9C          = dword ptr -9Ch
var_98          = dword ptr -98h
var_94          = dword ptr -94h
var_90          = dword ptr -90h
var_8C          = dword ptr -8Ch
var_88          = dword ptr -88h
var_84          = dword ptr -84h
var_80          = dword ptr -80h
var_78          = dword ptr -78h
var_74          = dword ptr -74h
var_70          = dword ptr -70h
var_6C          = dword ptr -6Ch
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
arg_0           = qword ptr  10h
arg_8           = qword ptr  18h
arg_10          = qword ptr  20h
arg_18          = dword ptr  28h
arg_20          = dword ptr  30h

; FUNCTION CHUNK AT 000000014042D974 SIZE 000009F2 BYTES

                mov     [rsp-8+arg_18], r9d
                mov     [rsp-8+arg_10], r8
                mov     [rsp-8+arg_8], rdx
                mov     [rsp-8+arg_0], rcx
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-8]
                sub     rsp, 108h
                mov     esi, cs:dword_140C1DC00
                mov     r15, r8
                xor     r8d, r8d
                shr     esi, 2
                mov     r10, rcx
                mov     [rsp+140h+var_100], 0FFh
                mov     r13d, r8d
                mov     [rsp+140h+var_F4], r8d
                mov     [rsp+140h+var_D8], r8d
                lea     r14, [r15+10h]
                lea     rbx, [r8-1]
                mov     [rsp+140h+var_C8], r8
                and     esi, 1

loc_140237680:                          ; CODE XREF: sub_140237620+1F648B↓j
                mov     r12d, 0FFFFFFFFh

loc_140237686:                          ; CODE XREF: sub_140237620+D00↓j
                mov     edi, 1
                mov     eax, 1000h
                test    esi, esi
                jz      loc_14042D974

loc_140237698:                          ; CODE XREF: sub_140237620+636↓j
                prefetchw byte ptr [r15+38h]
                mov     rdi, [r15+38h]
                test    rdi, 0FFFh
                jz      loc_1402378E1

loc_1402376AE:                          ; CODE XREF: sub_140237620+F24↓j
                lea     rcx, [rdi-1]
                mov     rax, rdi
                lock cmpxchg [r15+38h], rcx
                jnz     loc_140238533
                and     rdi, 0FFFFFFFFFFFFF000h
                jz      loc_1402378E1
                test    r13d, r13d
                jnz     loc_1402383A2
                xor     r8d, r8d

loc_1402376DA:                          ; CODE XREF: sub_140237620+DC6↓j
                                        ; sub_140237620+105D↓j ...
                movzx   eax, word ptr [rdi+22h]
                lea     r13, cs:140000000h
                movzx   ecx, byte ptr [rdi+27h]
                mov     r12d, 3
                mov     r10d, [rbp+40h+arg_18]
                add     rcx, rax
                add     rcx, rcx
                lea     rax, [rdi+30h]
                mov     [rbp+40h+var_60], rax
                movzx   eax, byte ptr [r15+1]
                mov     [rbp+40h+var_68], rcx
                movzx   eax, byte ptr [rax+r13+1A3E0h]
                mov     dword ptr [rsp+140h+var_E8], eax
                mov     eax, edi
                shr     eax, 0Ch
                mov     [rsp+140h+var_FC], eax
                xor     eax, [rdi+28h]
                xor     eax, dword ptr cs:xmmword_140C1DC20+8
                movzx   ecx, ax
                mov     r9d, eax
                mov     edx, eax
                shr     r9d, 10h
                mov     r14d, eax
                shr     edx, 10h
                mov     esi, eax
                shr     r14d, 10h
                shr     esi, 10h
                mov     eax, 1
                cmp     r10d, ecx
                mov     [rsp+140h+var_E0], ecx
                cmovnb  r12d, eax
                mov     rax, [rbp+40h+arg_0]
                movzx   eax, byte ptr [rax+3Eh]
                test    al, 2
                jnz     loc_1402388FE
                call    sub_1403F80E4
                movzx   ecx, ax
                movzx   r8d, byte ptr [rcx+r13+0C1DB00h]
                mov     r13d, [rsp+140h+var_E0]
                cmp     [rbp+40h+arg_18], r13d
                cmovnb  esi, r14d

loc_140237782:                          ; CODE XREF: sub_140237620+12EC↓j
                movzx   edx, word ptr [rdi+24h]
                lea     rcx, [rbp+40h+var_68]
                mov     r9d, dword ptr [rsp+140h+var_E8]
                mov     [rsp+140h+var_120], r12
                call    sub_140238CD0
                mov     r11d, [rsp+140h+var_FC]
                mov     r14d, r13d
                imul    r14d, eax
                mov     dword ptr [rsp+140h+var_D0], eax
                mov     [rdi+24h], ax
                add     r14d, esi
                cmp     byte ptr [rdi+2Dh], 1
                jbe     loc_14023788E
                movzx   ecx, byte ptr [rdi+2Ch]
                xor     eax, eax
                movzx   esi, word ptr [rdi+2Eh]
                mov     r9d, eax
                mov     [rbp+40h+var_B0], eax
                mov     r8d, r14d
                movzx   eax, word ptr [rdi+28h]
                add     rsi, rdi
                shr     r8d, cl
                movzx   edx, r11w
                xor     edx, eax
                mov     [rsp+140h+var_F8], 0FFh
                movzx   eax, word ptr cs:xmmword_140C1DC20+8
                xor     edx, eax
                mov     [rsp+140h+var_FF], 0FFh
                mov     [rsp+140h+var_DC], edx
                lea     r12, [r8+r8]
                dec     edx
                add     edx, r14d
                shr     edx, cl
                sub     edx, r8d
                inc     edx
                add     rsi, r12
                prefetchw byte ptr [rsi]
                xor     ecx, ecx
                lea     rdx, [rsi+rdx*2]
                mov     dword ptr [rsp+140h+var_E8], ecx
                mov     eax, ecx
                mov     [rbp+40h+var_C0], rax
                mov     r10d, 0FFFFFFFFh
                mov     [rsp+140h+var_F0], r10d
                cmp     rsi, rdx
                jnb     short loc_14023788E
                mov     r13, rdx

loc_14023782D:                          ; CODE XREF: sub_140237620+23E↓j
                movzx   r11d, [rsp+140h+var_FF]

loc_140237833:                          ; CODE XREF: sub_140237620+6A5↓j
                movzx   eax, word ptr [rsi]

loc_140237836:                          ; CODE XREF: sub_140237620+227↓j
                test    ax, ax
                jle     loc_140237C98
                lea     ecx, [rax+1]
                lock cmpxchg [rsi], cx
                jnz     short loc_140237836
                mov     r8d, dword ptr [rsp+140h+var_E8]
                mov     r10d, [rsp+140h+var_F0]

loc_140237853:                          ; CODE XREF: sub_140237620+770↓j
                add     rsi, 2
                add     r12, 2
                cmp     rsi, r13
                jb      short loc_14023782D
                mov     r15, [rbp+40h+arg_10]
                mov     r13d, [rsp+140h+var_E0]
                test    r8d, r8d
                jnz     loc_140237D33
                mov     rdx, [rbp+40h+arg_0]

loc_140237876:                          ; CODE XREF: sub_140237620+736↓j
                                        ; sub_140237620+74A↓j
                cmp     r10d, 0FFFFFFFFh
                jnz     loc_140238040
                test    r9d, r9d
                jnz     loc_140237D95

loc_140237889:                          ; CODE XREF: sub_140237620+79F↓j
                                        ; sub_140237620+9F2↓j ...
                mov     r11d, [rsp+140h+var_FC]

loc_14023788E:                          ; CODE XREF: sub_140237620+194↑j
                                        ; sub_140237620+208↑j
                mov     r12d, 1

loc_140237894:                          ; CODE XREF: sub_140237620+A9D↓j
                mov     eax, [rbp+40h+arg_18]
                mov     esi, r14d
                add     rsi, rdi
                cmp     eax, r13d
                jb      loc_140238682

loc_1402378A6:                          ; CODE XREF: sub_140237620+1093↓j
                mov     r14, [rbp+40h+arg_0]

loc_1402378AA:                          ; CODE XREF: sub_140237620+1F67A9↓j
                                        ; sub_140237620+1F67CB↓j
                test    rsi, rsi
                jz      loc_14042DDFB

loc_1402378B3:                          ; CODE XREF: sub_140237620+1F67EE↓j
                mov     ecx, [rsp+140h+var_F4]
                test    ecx, ecx
                jnz     loc_14042DE13

loc_1402378BF:                          ; CODE XREF: sub_140237620+60A↓j
                                        ; sub_140237620+1F69A9↓j ...
                mov     rdi, [rsp+140h+var_C8]

loc_1402378C4:                          ; CODE XREF: sub_140237620+1F6D41↓j
                cmp     [rsp+140h+var_D8], 0
                jnz     loc_14023854F

loc_1402378CF:                          ; CODE XREF: sub_140237620+F3C↓j
                test    rdi, rdi
                jnz     loc_140238C67

loc_1402378D8:                          ; CODE XREF: sub_140237620+165B↓j
                mov     rax, rsi
                jmp     loc_140238CB3
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402378E1:                          ; CODE XREF: sub_140237620+88↑j
                                        ; sub_140237620+A8↑j ...
                cmp     r13d, 2
                jnz     loc_140237C35
                lea     edi, [r13-1]

loc_1402378EF:                          ; CODE XREF: sub_140237620+1F6375↓j
                mov     eax, 1000h
                xor     r8d, r8d

loc_1402378F7:                          ; CODE XREF: sub_140237620+1F6357↓j
                cmp     qword ptr [r15+8], 0
                jbe     loc_140238279
                test    esi, esi
                lea     r9, [r15+18h]
                movzx   edx, di
                mov     rdi, [r9]
                cmovnz  dx, ax
                cmp     rdi, r9
                jz      loc_14042D9C9

loc_14023791B:                          ; CODE XREF: sub_140237620+1F6399↓j
                movzx   eax, word ptr [rdi+20h]
                mov     [rsp+140h+var_D8], r8d

loc_140237924:                          ; CODE XREF: sub_140237620:loc_140238CA8↓j
                                        ; sub_140237620+1F638B↓j
                cmp     dx, ax
                jb      loc_14042D99A
                movzx   r14d, ax
                cmp     r13d, 1
                jz      loc_14042D9B0

loc_14023793B:                          ; CODE XREF: sub_140237620+1F637E↓j
                movzx   ecx, ax
                sub     cx, r14w
                lock cmpxchg [rdi+20h], cx
                movzx   r8d, cx
                movzx   r12d, r14w
                add     r8d, r12d
                movzx   ecx, ax
                cmp     ecx, r8d
                jnz     loc_140238CA8
                cmp     word ptr [rdi+20h], 0
                jnz     loc_1402379FA
                movzx   ecx, byte ptr [rdi+26h]
                mov     r10, rdi
                test    ecx, ecx
                jnz     loc_14042D9D1
                lea     r8, [r15+8]

loc_14023797D:                          ; CODE XREF: sub_140237620+1F63C7↓j
                                        ; sub_140237620+1F63D5↓j
                lea     rcx, [r15+28h]
                test    r9, r9
                jz      short loc_1402379AF
                mov     rdx, [rdi]
                mov     rax, [rdi+8]
                cmp     [rdx+8], rdi
                jnz     loc_14042E0A1
                cmp     [rax], rdi
                jnz     loc_14042E0A1
                mov     [rax], rdx
                mov     [rdx+8], rax
                test    r8, r8
                jz      short loc_1402379AF
                dec     qword ptr [r8]

loc_1402379AF:                          ; CODE XREF: sub_140237620+364↑j
                                        ; sub_140237620+38A↑j
                mov     byte ptr [rdi+26h], 1
                test    rcx, rcx
                jz      loc_14042D9FA
                mov     rax, [rcx+8]
                cmp     [rax], rcx
                jnz     loc_14042E0A1
                mov     [rdi], rcx
                xor     edx, edx
                mov     [rdi+8], rax
                mov     r10d, edx
                mov     [rax], rdi
                mov     [rcx+8], rdi

loc_1402379DC:                          ; CODE XREF: sub_140237620+1F63DC↓j
                test    byte ptr [r15], 1
                jnz     short loc_1402379ED
                cmp     qword ptr [r15+8], 8
                ja      loc_14042DA01

loc_1402379ED:                          ; CODE XREF: sub_140237620+3C0↑j
                                        ; sub_140237620+1F640A↓j
                test    r10, r10
                jnz     loc_14042DA2F

loc_1402379F6:                          ; CODE XREF: sub_140237620+1F63B9↓j
                                        ; sub_140237620+1F6414↓j ...
                mov     r10, [rbp+40h+arg_0]

loc_1402379FA:                          ; CODE XREF: sub_140237620+344↑j
                cmp     r14w, 1
                lea     r14, [r15+10h]
                jbe     short loc_140237A1D
                lea     rax, [r12-1]
                mov     rcx, rdi
                xor     rcx, rax
                and     ecx, 0FFFh
                xor     rcx, rdi
                mov     [r15+38h], rcx

loc_140237A1D:                          ; CODE XREF: sub_140237620+3E3↑j
                xor     r8d, r8d
                mov     r12d, 0FFFFFFFFh

loc_140237A26:                          ; CODE XREF: sub_140237620+1F63AC↓j
                movzx   eax, byte ptr [r10+39h]
                cmp     r13d, 2
                jnz     loc_14042DA43
                test    eax, eax
                jz      loc_140237C5B
                mov     rcx, r14
                call    ExReleaseSpinLockExclusiveFromDpcLevel

loc_140237A45:                          ; CODE XREF: sub_140237620+1F6460↓j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140237CCA

loc_140237A53:                          ; CODE XREF: sub_140237620+6AC↓j
                                        ; sub_140237620+6B8↓j
                movzx   r13d, [rsp+140h+var_100]

loc_140237A59:                          ; CODE XREF: sub_140237620+6C8↓j
                                        ; sub_140237620+6D0↓j ...
                movzx   eax, r13b
                mov     cr8, rax

loc_140237A61:                          ; CODE XREF: sub_140237620+970↓j
                                        ; sub_140237620+1F6452↓j
                test    rdi, rdi
                jz      loc_14042DA85
                movzx   eax, word ptr [rdi+22h]
                lea     r13, cs:140000000h
                movzx   ecx, byte ptr [rdi+27h]
                mov     r12d, 3
                mov     r9d, [rbp+40h+arg_18]
                add     rcx, rax
                add     rcx, rcx
                lea     rax, [rdi+30h]
                mov     [rbp+40h+var_50], rax
                movzx   eax, byte ptr [r15+1]
                mov     [rbp+40h+var_58], rcx
                mov     ecx, edi
                shr     ecx, 0Ch
                mov     [rsp+140h+var_DC], ecx
                movzx   eax, byte ptr [rax+r13+1A3E0h]
                mov     dword ptr [rsp+140h+var_D0], eax
                mov     eax, [rdi+28h]
                xor     eax, ecx
                xor     eax, dword ptr cs:xmmword_140C1DC20+8
                movzx   r15d, ax
                mov     edx, eax
                mov     ecx, eax
                shr     edx, 10h
                mov     r14d, eax
                shr     ecx, 10h
                mov     esi, eax
                shr     r14d, 10h
                shr     esi, 10h
                mov     eax, 1
                cmp     r9d, r15d
                mov     [rbp+40h+var_80], r15d
                cmovnb  r12d, eax
                mov     rax, [rbp+40h+arg_0]
                movzx   eax, byte ptr [rax+3Eh]
                test    al, 2
                jnz     loc_140238C80
                call    sub_1403F80E4
                cmp     [rbp+40h+arg_18], r15d
                movzx   ecx, ax
                cmovnb  esi, r14d
                movzx   r8d, byte ptr [rcx+r13+0C1DB00h]

loc_140237B0E:                          ; CODE XREF: sub_140237620+166D↓j
                movzx   edx, word ptr [rdi+24h]
                lea     rcx, [rbp+40h+var_58]
                mov     r9d, dword ptr [rsp+140h+var_D0]
                mov     [rsp+140h+var_120], r12
                call    sub_140238CD0
                mov     r14d, r15d
                mov     [rsp+140h+var_E0], eax
                imul    r14d, eax
                mov     [rdi+24h], ax
                add     r14d, esi
                cmp     byte ptr [rdi+2Dh], 1
                jbe     loc_140237C11
                movzx   eax, word ptr [rsp+140h+var_DC]
                xor     r11d, r11d
                movzx   ecx, byte ptr [rdi+2Ch]
                mov     r8d, r14d
                movzx   edx, word ptr [rdi+28h]
                mov     r9d, r11d
                movzx   esi, word ptr [rdi+2Eh]
                xor     edx, eax
                movzx   eax, word ptr cs:xmmword_140C1DC20+8
                add     rsi, rdi
                xor     edx, eax
                shr     r8d, cl
                mov     [rsp+140h+var_DC], edx
                dec     edx
                add     edx, r14d
                mov     [rbp+40h+var_94], r11d
                shr     edx, cl
                sub     edx, r8d
                mov     [rsp+140h+var_F7], 0FFh
                inc     edx
                mov     [rsp+140h+var_FF], 0FFh
                lea     r12, [r8+r8]
                add     rsi, r12
                prefetchw byte ptr [rsi]
                xor     eax, eax
                mov     [rsp+140h+var_E8], r11
                lea     rdx, [rsi+rdx*2]
                mov     [rsp+140h+var_F4], eax
                mov     r10d, 0FFFFFFFFh
                mov     [rsp+140h+var_FC], r10d
                cmp     rsi, rdx
                jnb     short loc_140237C11
                mov     r15, rdx

loc_140237BB6:                          ; CODE XREF: sub_140237620+5C6↓j
                                        ; sub_140237620+D3D↓j
                movzx   eax, word ptr [rsi]

loc_140237BB9:                          ; CODE XREF: sub_140237620+5AA↓j
                test    ax, ax
                jle     loc_140238332
                lea     ecx, [rax+1]
                lock cmpxchg [rsi], cx
                jnz     short loc_140237BB9
                mov     r8d, [rsp+140h+var_F4]
                mov     r10d, [rsp+140h+var_FC]
                mov     r11, [rsp+140h+var_E8]

loc_140237BDB:                          ; CODE XREF: sub_140237620+DF1↓j
                add     rsi, 2
                add     r12, 2
                cmp     rsi, r15
                jb      short loc_140237BB6
                mov     r15d, [rbp+40h+var_80]
                mov     r13d, [rsp+140h+var_E0]
                test    r8d, r8d
                jnz     loc_140238416
                mov     rdx, [rbp+40h+arg_0]

loc_140237BFE:                          ; CODE XREF: sub_140237620+E19↓j
                                        ; sub_140237620+E2D↓j
                cmp     r10d, 0FFFFFFFFh
                jnz     loc_14023858B
                test    r9d, r9d
                jnz     loc_140238500

loc_140237C11:                          ; CODE XREF: sub_140237620+51B↑j
                                        ; sub_140237620+591↑j ...
                mov     eax, [rbp+40h+arg_18]
                mov     esi, r14d
                add     rsi, rdi
                cmp     eax, r15d
                jb      loc_140238C92

loc_140237C23:                          ; CODE XREF: sub_140237620+1683↓j
                mov     r15, [rbp+40h+arg_0]

loc_140237C27:                          ; CODE XREF: sub_140237620+1F6CF9↓j
                                        ; sub_140237620+1F6D21↓j
                test    rsi, rsi
                jnz     loc_1402378BF
                jmp     loc_14042E346
; ---------------------------------------------------------------------------

loc_140237C35:                          ; CODE XREF: sub_140237620+2C5↑j
                movzx   edx, byte ptr [r10+39h]
                lea     rcx, [r15+10h]
                mov     r13d, 2
                mov     [rsp+140h+var_F4], r13d
                call    sub_1402A0630
                mov     r10, [rbp+40h+arg_0]
                mov     [rsp+140h+var_100], al
                jmp     loc_140237698
; ---------------------------------------------------------------------------

loc_140237C5B:                          ; CODE XREF: sub_140237620+417↑j
                mov     rax, rbx
                lock xadd [r14], rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_140237C71
                mov     rcx, r14
                call    ExfTryToWakePushLock

loc_140237C71:                          ; CODE XREF: sub_140237620+647↑j
                xor     ecx, ecx
                mov     [rbp+40h+var_B8], ecx
                mov     rcx, r14
                mov     r13, gs:188h
                call    sub_140245330
                cmp     eax, 1
                jz      loc_140237E0C
                mov     r9d, r12d
                jmp     loc_140237E1B
; ---------------------------------------------------------------------------

loc_140237C98:                          ; CODE XREF: sub_140237620+219↑j
                test    r9d, r9d
                jnz     loc_140237D6F
                mov     rax, [rbp+40h+arg_0]
                lea     rcx, [rdi+18h]
                mov     [rbp+40h+var_80], 1
                movzx   edx, byte ptr [rax+39h]
                call    sub_1402A0630
                mov     r9d, [rbp+40h+var_80]
                movzx   r11d, al
                mov     [rsp+140h+var_FF], al
                jmp     loc_140237833
; ---------------------------------------------------------------------------

loc_140237CCA:                          ; CODE XREF: sub_140237620+42D↑j
                test    al, 1
                jz      loc_140237A53
                mov     rax, cr8
                cmp     al, 0Fh
                ja      loc_140237A53
                movzx   r13d, [rsp+140h+var_100]
                cmp     r13b, 0Fh
                ja      loc_140237A59
                cmp     al, 2
                jb      loc_140237A59
                mov     r10, gs:20h
                lea     ecx, [r13+1]
                mov     rdx, rbx
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     loc_140237A59
                mov     rcx, r10
                call    sub_1403F2EC4
                jmp     loc_140237A59
; ---------------------------------------------------------------------------

loc_140237D33:                          ; CODE XREF: sub_140237620+24C↑j
                movzx   ecx, byte ptr [rdi+2Ch]
                shl     r8d, cl
                mov     ecx, cs:dword_140C1DC00
                mov     eax, r8d
                cdq
                and     edx, 0FFFh
                add     eax, edx
                mov     rdx, [rbp+40h+arg_0]
                sar     eax, 0Ch
                test    cl, 20h
                jz      loc_140237876
                movsx   rcx, word ptr [rdx+3Ah]
                cdqe
                lock xadd [rcx+rdx+18h], rax
                jmp     loc_140237876
; ---------------------------------------------------------------------------

loc_140237D6F:                          ; CODE XREF: sub_140237620+67B↑j
                mov     r8d, dword ptr [rsp+140h+var_E8]
                mov     r10d, [rsp+140h+var_F0]
                test    ax, ax
                jnz     loc_140238017
                dec     r8d
                mov     dword ptr [rsp+140h+var_E8], r8d

loc_140237D8A:                          ; CODE XREF: sub_140237620+A0D↓j
                                        ; sub_140237620+A1B↓j
                inc     ax
                mov     [rsi], ax
                jmp     loc_140237853
; ---------------------------------------------------------------------------

loc_140237D95:                          ; CODE XREF: sub_140237620+263↑j
                cmp     byte ptr [rdx+39h], 0
                jz      short loc_140237DC4
                lea     rcx, [rdi+18h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140237FA8

loc_140237DB2:                          ; CODE XREF: sub_140237620+98A↓j
                                        ; sub_140237620+996↓j
                movzx   esi, [rsp+140h+var_FF]

loc_140237DB7:                          ; CODE XREF: sub_140237620+9A5↓j
                                        ; sub_140237620+9AD↓j ...
                movzx   eax, sil
                mov     cr8, rax
                jmp     loc_140237889
; ---------------------------------------------------------------------------

loc_140237DC4:                          ; CODE XREF: sub_140237620+779↑j
                mov     rax, rbx
                lock xadd [rdi+18h], rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_140237DDC
                lea     rcx, [rdi+18h]
                call    ExfTryToWakePushLock

loc_140237DDC:                          ; CODE XREF: sub_140237620+7B1↑j
                xor     eax, eax
                lea     rcx, [rdi+18h]
                mov     [rbp+40h+var_A0], eax
                mov     rsi, gs:188h
                mov     [rsp+140h+var_D0], rsi
                call    sub_140245330
                cmp     eax, 1
                jz      loc_1402380CF
                mov     r9d, 0FFFFFFFFh
                jmp     loc_1402380DE
; ---------------------------------------------------------------------------

loc_140237E0C:                          ; CODE XREF: sub_140237620+66A↑j
                mov     rcx, [r13+0B8h]
                call    sub_140245840
                mov     r9d, eax

loc_140237E1B:                          ; CODE XREF: sub_140237620+673↑j
                dec     word ptr [r13+1E6h]
                inc     byte ptr [r13+31Ah]
                movsx   eax, byte ptr [r13+318h]
                mov     r8, r14
                movsx   edx, byte ptr [r13+366h]
                mov     r11, 7FFFFFFFFFFFFFFCh
                movzx   r12d, byte ptr [r13+31Ah]
                or      edx, eax
                xor     edx, 3Fh
                xor     r10d, r10d
                and     r8, r11
                bsr     ecx, edx
                mov     [rbp+40h+var_78], ecx
                jz      short loc_140237E8F

loc_140237E62:                          ; CODE XREF: sub_140237620+869↓j
                lea     r14, [rcx+rcx*2]
                mov     eax, 1
                shl     r14, 5
                add     r14, [r13+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    byte ptr [r14+1Ah], 1
                jnz     short loc_140237EB3

loc_140237E83:                          ; CODE XREF: sub_140237620+899↓j
                                        ; sub_140237620+8A5↓j ...
                bsr     ecx, edx
                mov     [rbp+40h+var_78], ecx
                jnz     short loc_140237E62

loc_140237E8B:                          ; CODE XREF: sub_140237620+8BE↓j
                lea     r14, [r15+10h]

loc_140237E8F:                          ; CODE XREF: sub_140237620+840↑j
                mov     eax, [r13+78h]
                bt      eax, 10h
                jb      loc_140237F61
                mov     r8, r14
                mov     [rsp+140h+var_120], r10
                mov     rdx, r13
                mov     ecx, 162h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140237EB3:                          ; CODE XREF: sub_140237620+861↑j
                mov     eax, [r14+20h]
                test    al, 1
                jnz     short loc_140237E83
                mov     rax, [r14+20h]
                and     rax, r11
                cmp     rax, r8
                jnz     short loc_140237E83
                cmp     [r14+28h], r9d
                jnz     short loc_140237E83
                and     byte ptr [r14+1Ah], 0FEh
                mov     rax, [r14+20h]
                test    rax, rax
                jz      short loc_140237E83
                test    r14, r14
                jz      short loc_140237E8B
                movzx   eax, byte ptr [r14+20h]
                or      al, 2
                mov     [r14+20h], al
                mov     rax, [r14+20h]
                shr     rax, 3Fh
                test    al, al
                jz      short loc_140237F02
                mov     rcx, r14
                call    sub_14031EC80
                xor     r10d, r10d

loc_140237F02:                          ; CODE XREF: sub_140237620+8D5↑j
                mov     [rbp+40h+var_B8], r10d
                mov     eax, [r14+58h]
                and     eax, 1FFFFh
                mov     [rbp+40h+var_B8], eax
                and     dword ptr [r14+58h], 0FFFE0000h
                and     byte ptr [r14+19h], 0FEh
                mov     [r14+20h], r10
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     r14, [r13+320h]
                imul    r14
                mov     eax, 1
                lea     r14, [r15+10h]
                sar     rdx, 4
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                shl     al, cl
                cmp     r12b, 1
                jnz     loc_1402380C2
                or      [r13+318h], al

loc_140237F61:                          ; CODE XREF: sub_140237620+877↑j
                                        ; sub_140237620+AAA↓j
                dec     byte ptr [r13+31Ah]
                lea     r8, [rbp+40h+var_B8]
                mov     rdx, r14
                mov     rcx, r13
                call    sub_1402456E0
                add     word ptr [r13+1E6h], 1
                jz      short loc_140237F95

loc_140237F82:                          ; CODE XREF: sub_140237620+97F↓j
                                        ; sub_140237620+986↓j
                mov     rcx, gs:188h
                call    sub_140245770
                jmp     loc_140237A61
; ---------------------------------------------------------------------------

loc_140237F95:                          ; CODE XREF: sub_140237620+960↑j
                lea     rax, [r13+98h]
                cmp     [rax], rax
                jz      short loc_140237F82
                call    KiCheckForKernelApcDelivery
                jmp     short loc_140237F82
; ---------------------------------------------------------------------------

loc_140237FA8:                          ; CODE XREF: sub_140237620+78C↑j
                test    al, 1
                jz      loc_140237DB2
                mov     rax, cr8
                cmp     al, 0Fh
                ja      loc_140237DB2
                movzx   esi, [rsp+140h+var_FF]
                cmp     sil, 0Fh
                ja      loc_140237DB7
                cmp     al, 2
                jb      loc_140237DB7
                mov     r10, gs:20h
                lea     ecx, [rsi+1]
                mov     rdx, rbx
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     loc_140237DB7
                mov     rcx, r10
                call    sub_1403F2EC4
                movzx   eax, sil
                mov     cr8, rax
                jmp     loc_140237889
; ---------------------------------------------------------------------------

loc_140238017:                          ; CODE XREF: sub_140237620+75C↑j
                inc     r8d
                mov     r15, r12
                sar     r15, 1
                mov     dword ptr [rsp+140h+var_E8], r8d
                mov     [rbp+40h+var_C0], r15
                cmp     r10d, 0FFFFFFFFh
                jnz     loc_140237D8A
                mov     r10d, r15d
                mov     [rsp+140h+var_F0], r15d
                jmp     loc_140237D8A
; ---------------------------------------------------------------------------

loc_140238040:                          ; CODE XREF: sub_140237620+25A↑j
                mov     rax, [rdx+18h]
                movzx   ecx, byte ptr [rdi+2Ch]
                xor     rax, qword ptr cs:xmmword_140C1DC20
                mov     rsi, [rbp+40h+var_C0]
                xor     rax, rdx
                sub     esi, r10d
                mov     [rsp+140h+var_F8], r11b
                shl     r10d, cl
                inc     esi
                mov     [rbp+40h+var_B0], esi
                shl     esi, cl
                mov     rcx, [rdx]
                mov     r8d, esi
                mov     edx, r10d
                add     rdx, rdi
                mov     [rsp+140h+var_F0], r10d
                call    sub_1404079D0
                mov     rdx, rdi
                test    eax, eax
                js      loc_14042DB3A
                mov     r8d, [rsp+140h+var_F0]
                lea     rax, [rsp+140h+var_F8]
                mov     rcx, [rbp+40h+arg_0]
                mov     r12d, 1
                mov     [rsp+140h+var_110], rax
                mov     r9d, esi
                lea     rax, [rbp+40h+var_B0]
                mov     [rsp+140h+var_118], r12d
                mov     [rsp+140h+var_120], rax
                call    sub_14033F17C
                mov     r11d, [rsp+140h+var_FC]
                jmp     loc_140237894
; ---------------------------------------------------------------------------

loc_1402380C2:                          ; CODE XREF: sub_140237620+934↑j
                lock or [r13+366h], al
                jmp     loc_140237F61
; ---------------------------------------------------------------------------

loc_1402380CF:                          ; CODE XREF: sub_140237620+7DB↑j
                mov     rcx, [rsi+0B8h]
                call    sub_140245840
                mov     r9d, eax

loc_1402380DE:                          ; CODE XREF: sub_140237620+7E7↑j
                dec     word ptr [rsi+1E6h]
                mov     r10, rsi
                inc     byte ptr [rsi+31Ah]
                movzx   eax, byte ptr [rsi+31Ah]
                lea     r8, [rdi+18h]
                mov     [rsp+140h+var_FF], al
                xor     r11d, r11d
                mov     rax, 7FFFFFFFFFFFFFFCh
                and     r8, rax
                movsx   eax, byte ptr [rsi+318h]
                movsx   edx, byte ptr [rsi+366h]
                or      edx, eax
                xor     edx, 3Fh
                bsr     ecx, edx
                mov     [rbp+40h+var_A4], ecx
                jz      short loc_140238159
                nop     word ptr [rax+rax+00000000h]

loc_140238131:                          ; CODE XREF: sub_140237620+B37↓j
                lea     rsi, [rcx+rcx*2]
                mov     eax, 1
                shl     rsi, 5
                add     rsi, [r10+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    byte ptr [rsi+1Ah], 1
                jnz     short loc_14023817E

loc_140238151:                          ; CODE XREF: sub_140237620+B63↓j
                                        ; sub_140237620+B79↓j ...
                bsr     ecx, edx
                mov     [rbp+40h+var_A4], ecx
                jnz     short loc_140238131

loc_140238159:                          ; CODE XREF: sub_140237620+B06↑j
                                        ; sub_140237620+B91↓j
                mov     eax, [r10+78h]
                bt      eax, 10h
                jb      loc_14023822D
                lea     r8, [rdi+18h]
                mov     [rsp+140h+var_120], r11
                mov     rdx, r10
                mov     ecx, 162h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14023817E:                          ; CODE XREF: sub_140237620+B2F↑j
                mov     eax, [rsi+20h]
                test    al, 1
                jnz     short loc_140238151
                mov     rax, [rsi+20h]
                mov     rcx, 7FFFFFFFFFFFFFFCh
                and     rax, rcx
                cmp     rax, r8
                jnz     short loc_140238151
                cmp     [rsi+28h], r9d
                jnz     short loc_140238151
                and     byte ptr [rsi+1Ah], 0FEh
                mov     rax, [rsi+20h]
                test    rax, rax
                jz      short loc_140238151
                test    rsi, rsi
                jz      short loc_140238159
                movzx   eax, byte ptr [rsi+20h]
                or      al, 2
                mov     [rsi+20h], al
                mov     rax, [rsi+20h]
                shr     rax, 3Fh
                test    al, al
                jz      short loc_1402381D8
                mov     rcx, rsi
                call    sub_14031EC80
                mov     r10, [rsp+140h+var_D0]
                xor     r11d, r11d

loc_1402381D8:                          ; CODE XREF: sub_140237620+BA6↑j
                mov     eax, [rsi+58h]
                and     eax, 1FFFFh
                mov     [rbp+40h+var_A0], eax
                and     dword ptr [rsi+58h], 0FFFE0000h
                and     byte ptr [rsi+19h], 0FEh
                mov     [rsi+20h], r11
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rsi, [r10+320h]
                imul    rsi
                mov     eax, 1
                sar     rdx, 4
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                shl     al, cl
                cmp     [rsp+140h+var_FF], 1
                jnz     loc_140238325
                or      [r10+318h], al

loc_14023822D:                          ; CODE XREF: sub_140237620+B41↑j
                                        ; sub_140237620+D0D↓j
                dec     byte ptr [r10+31Ah]
                lea     r8, [rbp+40h+var_A0]
                lea     rdx, [rdi+18h]
                mov     rcx, r10
                call    sub_1402456E0
                mov     rsi, [rsp+140h+var_D0]
                add     word ptr [rsi+1E6h], 1
                jz      short loc_140238266

loc_140238253:                          ; CODE XREF: sub_140237620+C50↓j
                                        ; sub_140237620+C57↓j
                mov     rcx, gs:188h
                call    sub_140245770
                jmp     loc_140237889
; ---------------------------------------------------------------------------

loc_140238266:                          ; CODE XREF: sub_140237620+C31↑j
                lea     rax, [rsi+98h]
                cmp     [rax], rax
                jz      short loc_140238253
                call    KiCheckForKernelApcDelivery
                jmp     short loc_140238253
; ---------------------------------------------------------------------------

loc_140238279:                          ; CODE XREF: sub_140237620+2DC↑j
                movzx   eax, byte ptr [r10+39h]
                cmp     r13d, 2
                jnz     loc_14042DAB0
                test    eax, eax
                jz      loc_140238362
                mov     rcx, r14
                call    ExReleaseSpinLockExclusiveFromDpcLevel

loc_140238298:                          ; CODE XREF: sub_140237620+1F64CD↓j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140238452

loc_1402382A6:                          ; CODE XREF: sub_140237620+E34↓j
                                        ; sub_140237620+E40↓j
                movzx   r13d, [rsp+140h+var_100]

loc_1402382AC:                          ; CODE XREF: sub_140237620+E50↓j
                                        ; sub_140237620+E58↓j ...
                movzx   eax, r13b
                mov     cr8, rax

loc_1402382B4:                          ; CODE XREF: sub_140237620+124A↓j
                                        ; sub_140237620+1F64BF↓j
                mov     r13, [rbp+40h+arg_0]
                mov     rcx, [rbp+40h+arg_8]
                movzx   edx, byte ptr [r13+39h]
                call    sub_140343B04
                mov     rdi, rax
                test    rax, rax
                jnz     short loc_1402382EA
                mov     r8d, [rbp+40h+arg_20]
                mov     rcx, r13
                mov     rdx, [rbp+40h+arg_8]
                call    sub_140317E1C
                mov     rdi, rax
                test    rax, rax
                jz      loc_14042E35E

loc_1402382EA:                          ; CODE XREF: sub_140237620+CAC↑j
                mov     rax, [rbp+40h+arg_0]
                mov     r13d, 2
                mov     rcx, r14
                mov     [rsp+140h+var_F4], r13d
                movzx   edx, byte ptr [rax+39h]
                call    sub_1402A0630
                mov     rdx, rdi
                mov     [rsp+140h+var_100], al
                mov     rcx, r15
                call    sub_1403440B4
                mov     r10, [rbp+40h+arg_0]
                xor     r8d, r8d
                mov     [rsp+140h+var_C8], rax
                jmp     loc_140237686
; ---------------------------------------------------------------------------

loc_140238325:                          ; CODE XREF: sub_140237620+C00↑j
                lock or [r10+366h], al
                jmp     loc_14023822D
; ---------------------------------------------------------------------------

loc_140238332:                          ; CODE XREF: sub_140237620+59C↑j
                test    r9d, r9d
                jnz     loc_1402383EB
                mov     rax, [rbp+40h+arg_0]
                lea     rcx, [rdi+18h]
                mov     dword ptr [rsp+140h+var_D0], 1
                movzx   edx, byte ptr [rax+39h]
                call    sub_1402A0630
                mov     r9d, dword ptr [rsp+140h+var_D0]
                mov     [rsp+140h+var_FF], al
                jmp     loc_140237BB6
; ---------------------------------------------------------------------------

loc_140238362:                          ; CODE XREF: sub_140237620+C6A↑j
                mov     rax, rbx
                lock xadd [r14], rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_14023837B
                mov     rcx, r14
                call    ExfTryToWakePushLock
                xor     r8d, r8d

loc_14023837B:                          ; CODE XREF: sub_140237620+D4E↑j
                mov     [rbp+40h+var_B4], r8d
                lea     rcx, [r15+10h]
                mov     r14, gs:188h
                call    sub_140245330
                cmp     eax, 1
                jz      loc_1402386FA
                mov     r8d, r12d
                jmp     loc_140238709
; ---------------------------------------------------------------------------

loc_1402383A2:                          ; CODE XREF: sub_140237620+B1↑j
                movzx   eax, byte ptr [r10+39h]
                cmp     r13d, 2
                jnz     loc_14042DAF2
                test    eax, eax
                jz      loc_1402384BB
                lea     rcx, [r15+10h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel

loc_1402383C2:                          ; CODE XREF: sub_140237620+1F6515↓j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140238609

loc_1402383D0:                          ; CODE XREF: sub_140237620+FEB↓j
                                        ; sub_140237620+FF7↓j
                movzx   r13d, [rsp+140h+var_100]

loc_1402383D6:                          ; CODE XREF: sub_140237620+1007↓j
                                        ; sub_140237620+100F↓j ...
                movzx   eax, r13b
                mov     cr8, rax

loc_1402383DE:                          ; CODE XREF: sub_140237620+1F6506↓j
                xor     r8d, r8d
                mov     [rsp+140h+var_F4], r8d
                jmp     loc_1402376DA
; ---------------------------------------------------------------------------

loc_1402383EB:                          ; CODE XREF: sub_140237620+D15↑j
                mov     r8d, [rsp+140h+var_F4]
                mov     r10d, [rsp+140h+var_FC]
                test    ax, ax
                jnz     loc_140238561
                mov     r11, [rsp+140h+var_E8]
                dec     r8d
                mov     [rsp+140h+var_F4], r8d

loc_14023840B:                          ; CODE XREF: sub_140237620+F58↓j
                                        ; sub_140237620+F66↓j
                inc     ax
                mov     [rsi], ax
                jmp     loc_140237BDB
; ---------------------------------------------------------------------------

loc_140238416:                          ; CODE XREF: sub_140237620+5D4↑j
                movzx   ecx, byte ptr [rdi+2Ch]
                shl     r8d, cl
                mov     ecx, cs:dword_140C1DC00
                mov     eax, r8d
                cdq
                and     edx, 0FFFh
                add     eax, edx
                mov     rdx, [rbp+40h+arg_0]
                sar     eax, 0Ch
                test    cl, 20h
                jz      loc_140237BFE
                movsx   rcx, word ptr [rdx+3Ah]
                cdqe
                lock xadd [rcx+rdx+18h], rax
                jmp     loc_140237BFE
; ---------------------------------------------------------------------------

loc_140238452:                          ; CODE XREF: sub_140237620+C80↑j
                test    al, 1
                jz      loc_1402382A6
                mov     rax, cr8
                cmp     al, 0Fh
                ja      loc_1402382A6
                movzx   r13d, [rsp+140h+var_100]
                cmp     r13b, 0Fh
                ja      loc_1402382AC
                cmp     al, 2
                jb      loc_1402382AC
                mov     r10, gs:20h
                lea     ecx, [r13+1]
                mov     rdx, rbx
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     loc_1402382AC
                mov     rcx, r10
                call    sub_1403F2EC4
                jmp     loc_1402382AC
; ---------------------------------------------------------------------------

loc_1402384BB:                          ; CODE XREF: sub_140237620+D93↑j
                mov     rax, rbx
                lock xadd [r15+10h], rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_1402384D3
                lea     rcx, [r15+10h]
                call    ExfTryToWakePushLock

loc_1402384D3:                          ; CODE XREF: sub_140237620+EA8↑j
                xor     r14d, r14d
                lea     rcx, [r15+10h]
                mov     [rbp+40h+var_6C], r14d
                mov     rsi, gs:188h
                call    sub_140245330
                cmp     eax, 1
                jz      loc_140238938
                mov     r8d, 0FFFFFFFFh
                jmp     loc_140238947
; ---------------------------------------------------------------------------

loc_140238500:                          ; CODE XREF: sub_140237620+5EB↑j
                cmp     byte ptr [rdx+39h], 0
                jz      loc_1402386B8
                lea     rcx, [rdi+18h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140238893

loc_140238521:                          ; CODE XREF: sub_140237620+1275↓j
                                        ; sub_140237620+1281↓j
                movzx   esi, [rsp+140h+var_FF]

loc_140238526:                          ; CODE XREF: sub_140237620+1290↓j
                                        ; sub_140237620+1298↓j ...
                movzx   eax, sil
                mov     cr8, rax
                jmp     loc_140237C11
; ---------------------------------------------------------------------------

loc_140238533:                          ; CODE XREF: sub_140237620+9B↑j
                mov     [rsp+140h+var_D8], 1
                mov     rdi, rax
                test    rax, 0FFFh
                jnz     loc_1402376AE
                jmp     loc_1402378E1
; ---------------------------------------------------------------------------

loc_14023854F:                          ; CODE XREF: sub_140237620+2A9↑j
                mov     rdx, [rbp+40h+arg_8]
                mov     rcx, [rbp+40h+arg_0]
                call    sub_140353018
                jmp     loc_1402378CF
; ---------------------------------------------------------------------------

loc_140238561:                          ; CODE XREF: sub_140237620+DD8↑j
                inc     r8d
                mov     r11, r12
                sar     r11, 1
                mov     [rsp+140h+var_F4], r8d
                mov     [rsp+140h+var_E8], r11
                cmp     r10d, 0FFFFFFFFh
                jnz     loc_14023840B
                mov     r10d, r11d
                mov     [rsp+140h+var_FC], r11d
                jmp     loc_14023840B
; ---------------------------------------------------------------------------

loc_14023858B:                          ; CODE XREF: sub_140237620+5E2↑j
                mov     rax, [rdx+18h]
                sub     r11d, r10d
                movzx   ecx, byte ptr [rdi+2Ch]
                xor     rax, qword ptr cs:xmmword_140C1DC20
                movzx   r12d, [rsp+140h+var_FF]
                xor     rax, rdx
                shl     r10d, cl
                lea     esi, [r11+1]
                mov     [rbp+40h+var_94], esi
                shl     esi, cl
                mov     rcx, [rdx]
                mov     r8d, esi
                mov     edx, r10d
                add     rdx, rdi
                mov     [rsp+140h+var_F7], r12b
                mov     [rsp+140h+var_FC], r10d
                call    sub_1404079D0
                mov     rdx, rdi
                test    eax, eax
                js      loc_14042E0A8
                mov     r8d, [rsp+140h+var_FC]
                lea     rax, [rsp+140h+var_F7]
                mov     rcx, [rbp+40h+arg_0]
                mov     r9d, esi
                mov     [rsp+140h+var_110], rax
                lea     rax, [rbp+40h+var_94]
                mov     [rsp+140h+var_118], 1
                mov     [rsp+140h+var_120], rax
                call    sub_14033F17C
                jmp     loc_140237C11
; ---------------------------------------------------------------------------

loc_140238609:                          ; CODE XREF: sub_140237620+DAA↑j
                test    al, 1
                jz      loc_1402383D0
                mov     rax, cr8
                cmp     al, 0Fh
                ja      loc_1402383D0
                movzx   r13d, [rsp+140h+var_100]
                cmp     r13b, 0Fh
                ja      loc_1402383D6
                cmp     al, 2
                jb      loc_1402383D6
                mov     r10, gs:20h
                lea     ecx, [r13+1]
                mov     rdx, rbx
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     loc_1402383D6
                mov     rcx, r10
                call    sub_1403F2EC4
                movzx   eax, r13b
                mov     cr8, rax
                xor     r8d, r8d
                mov     [rsp+140h+var_F4], r8d
                jmp     loc_1402376DA
; ---------------------------------------------------------------------------

loc_140238682:                          ; CODE XREF: sub_140237620+280↑j
                sub     r13d, eax
                movzx   ecx, r11w
                movzx   eax, word ptr [rdi+28h]
                xor     rcx, rax
                movzx   eax, word ptr cs:xmmword_140C1DC20+8
                xor     rcx, rax
                cmp     r13d, 1
                jz      loc_14042DDF0
                mov     eax, 3FFFh
                and     r13w, ax

loc_1402386AD:                          ; CODE XREF: sub_140237620+1F67D6↓j
                mov     [rcx+rsi-2], r13w
                jmp     loc_1402378A6
; ---------------------------------------------------------------------------

loc_1402386B8:                          ; CODE XREF: sub_140237620+EE4↑j
                lock xadd [rdi+18h], rbx
                and     bl, 6
                cmp     bl, 2
                jnz     short loc_1402386CF
                lea     rcx, [rdi+18h]
                call    ExfTryToWakePushLock

loc_1402386CF:                          ; CODE XREF: sub_140237620+10A4↑j
                xor     esi, esi
                lea     rcx, [rdi+18h]
                mov     [rbp+40h+var_84], esi
                mov     rbx, gs:188h
                call    sub_140245330
                cmp     eax, 1
                jz      loc_140238ADB
                mov     r9d, 0FFFFFFFFh
                jmp     loc_140238AEA
; ---------------------------------------------------------------------------

loc_1402386FA:                          ; CODE XREF: sub_140237620+D74↑j
                mov     rcx, [r14+0B8h]
                call    sub_140245840
                mov     r8d, eax

loc_140238709:                          ; CODE XREF: sub_140237620+D7D↑j
                dec     word ptr [r14+1E6h]
                inc     byte ptr [r14+31Ah]
                movsx   eax, byte ptr [r14+318h]
                lea     r9, [r15+10h]
                movsx   edx, byte ptr [r14+366h]
                mov     r11, 7FFFFFFFFFFFFFFCh
                movzx   r12d, byte ptr [r14+31Ah]
                or      edx, eax
                xor     edx, 3Fh
                xor     r10d, r10d
                and     r9, r11
                bsr     ecx, edx
                mov     [rbp+40h+var_74], ecx
                jz      loc_14023886F

loc_140238755:                          ; CODE XREF: sub_140237620+1163↓j
                mov     eax, edi
                lea     rdi, [rcx+rcx*2]
                shl     rdi, 5
                add     rdi, [r14+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    byte ptr [rdi+1Ah], 1
                jnz     short loc_140238785

loc_140238772:                          ; CODE XREF: sub_140237620+116A↓j
                                        ; sub_140237620+1176↓j ...
                bsr     ecx, edx
                mov     [rbp+40h+var_74], ecx
                jz      loc_14023886F
                mov     edi, 1
                jmp     short loc_140238755
; ---------------------------------------------------------------------------

loc_140238785:                          ; CODE XREF: sub_140237620+1150↑j
                mov     eax, [rdi+20h]
                test    al, 1
                jnz     short loc_140238772
                mov     rax, [rdi+20h]
                and     rax, r11
                cmp     rax, r9
                jnz     short loc_140238772
                cmp     [rdi+28h], r8d
                jnz     short loc_140238772
                and     byte ptr [rdi+1Ah], 0FEh
                mov     rax, [rdi+20h]
                test    rax, rax
                jz      short loc_140238772
                test    rdi, rdi
                jz      loc_14023886F
                movzx   eax, byte ptr [rdi+20h]
                or      al, 2
                mov     [rdi+20h], al
                mov     rax, [rdi+20h]
                shr     rax, 3Fh
                test    al, al
                jz      short loc_1402387D4
                mov     rcx, rdi
                call    sub_14031EC80
                xor     r10d, r10d

loc_1402387D4:                          ; CODE XREF: sub_140237620+11A7↑j
                mov     [rbp+40h+var_B4], r10d
                mov     eax, [rdi+58h]
                and     eax, 1FFFFh
                mov     [rbp+40h+var_B4], eax
                and     dword ptr [rdi+58h], 0FFFE0000h
                and     byte ptr [rdi+19h], 0FEh
                mov     [rdi+20h], r10
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rdi, [r14+320h]
                imul    rdi
                mov     eax, 1
                sar     rdx, 4
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                shl     al, cl
                cmp     r12b, 1
                jnz     loc_14023892B
                or      [r14+318h], al

loc_14023882C:                          ; CODE XREF: sub_140237620+1257↓j
                                        ; sub_140237620+1313↓j
                dec     byte ptr [r14+31Ah]
                lea     r8, [rbp+40h+var_B4]
                lea     rdx, [r15+10h]
                mov     rcx, r14
                call    sub_1402456E0
                add     word ptr [r14+1E6h], 1
                jz      loc_140238911

loc_140238852:                          ; CODE XREF: sub_140237620+12FB↓j
                                        ; sub_140237620+1306↓j
                mov     rcx, gs:188h
                call    sub_140245770
                lea     r14, [r15+10h]
                mov     r12d, 0FFFFFFFFh
                jmp     loc_1402382B4
; ---------------------------------------------------------------------------

loc_14023886F:                          ; CODE XREF: sub_140237620+112F↑j
                                        ; sub_140237620+1158↑j ...
                mov     eax, [r14+78h]
                bt      eax, 10h
                jb      short loc_14023882C
                mov     r9d, r8d
                mov     rdx, r14
                lea     r8, [r15+10h]
                mov     [rsp+140h+var_120], r10
                mov     ecx, 162h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140238893:                          ; CODE XREF: sub_140237620+EFB↑j
                test    al, 1
                jz      loc_140238521
                mov     rax, cr8
                cmp     al, 0Fh
                ja      loc_140238521
                movzx   esi, [rsp+140h+var_FF]
                cmp     sil, 0Fh
                ja      loc_140238526
                cmp     al, 2
                jb      loc_140238526
                mov     r9, gs:20h
                lea     ecx, [rsi+1]
                shl     rbx, cl
                movzx   eax, bx
                not     eax
                mov     r8, [r9+84B8h]
                mov     edx, [r8+14h]
                and     edx, eax
                mov     [r8+14h], edx
                jnz     loc_140238526
                mov     rcx, r9
                call    sub_1403F2EC4
                movzx   eax, sil
                mov     cr8, rax
                jmp     loc_140237C11
; ---------------------------------------------------------------------------

loc_1402388FE:                          ; CODE XREF: sub_140237620+13E↑j
                mov     r13d, [rsp+140h+var_E0]
                cmp     r10d, ecx
                mov     esi, edx
                cmovnb  esi, r9d
                jmp     loc_140237782
; ---------------------------------------------------------------------------

loc_140238911:                          ; CODE XREF: sub_140237620+122C↑j
                lea     rax, [r14+98h]
                cmp     [rax], rax
                jz      loc_140238852
                call    KiCheckForKernelApcDelivery
                jmp     loc_140238852
; ---------------------------------------------------------------------------

loc_14023892B:                          ; CODE XREF: sub_140237620+11FF↑j
                lock or [r14+366h], al
                jmp     loc_14023882C
; ---------------------------------------------------------------------------

loc_140238938:                          ; CODE XREF: sub_140237620+ECF↑j
                mov     rcx, [rsi+0B8h]
                call    sub_140245840
                mov     r8d, eax

loc_140238947:                          ; CODE XREF: sub_140237620+EDB↑j
                dec     word ptr [rsi+1E6h]
                inc     byte ptr [rsi+31Ah]
                movsx   eax, byte ptr [rsi+318h]
                lea     r9, [r15+10h]
                movsx   edx, byte ptr [rsi+366h]
                mov     r10, 7FFFFFFFFFFFFFFCh
                movzx   r13d, byte ptr [rsi+31Ah]
                or      edx, eax
                xor     edx, 3Fh
                and     r9, r10
                bsr     ecx, edx
                mov     [rbp+40h+var_70], ecx
                jz      short loc_1402389BD
                nop     word ptr [rax+rax+00000000h]

loc_140238991:                          ; CODE XREF: sub_140237620+1398↓j
                lea     r14, [rcx+rcx*2]
                mov     eax, 1
                shl     r14, 5
                add     r14, [rsi+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    byte ptr [r14+1Ah], 1
                jnz     short loc_1402389E4

loc_1402389B2:                          ; CODE XREF: sub_140237620+13CA↓j
                                        ; sub_140237620+13D6↓j ...
                bsr     ecx, edx
                mov     [rbp+40h+var_70], ecx
                jnz     short loc_140238991

loc_1402389BA:                          ; CODE XREF: sub_140237620+13EF↓j
                xor     r14d, r14d

loc_1402389BD:                          ; CODE XREF: sub_140237620+1366↑j
                mov     eax, [rsi+78h]
                bt      eax, 10h
                jb      loc_140238A84
                mov     r9d, r8d
                mov     rdx, rsi
                lea     r8, [r15+10h]
                mov     [rsp+140h+var_120], r14
                mov     ecx, 162h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_1402389E4:                          ; CODE XREF: sub_140237620+1390↑j
                mov     eax, [r14+20h]
                test    al, 1
                jnz     short loc_1402389B2
                mov     rax, [r14+20h]
                and     rax, r10
                cmp     rax, r9
                jnz     short loc_1402389B2
                cmp     [r14+28h], r8d
                jnz     short loc_1402389B2
                and     byte ptr [r14+1Ah], 0FEh
                mov     rax, [r14+20h]
                test    rax, rax
                jz      short loc_1402389B2
                test    r14, r14
                jz      short loc_1402389BA
                movzx   eax, byte ptr [r14+20h]
                or      al, 2
                mov     [r14+20h], al
                mov     rax, [r14+20h]
                shr     rax, 3Fh
                test    al, al
                jz      short loc_140238A30
                mov     rcx, r14
                call    sub_14031EC80

loc_140238A30:                          ; CODE XREF: sub_140237620+1406↑j
                mov     eax, [r14+58h]
                and     eax, 1FFFFh
                mov     [rbp+40h+var_6C], eax
                and     dword ptr [r14+58h], 0FFFE0000h
                and     byte ptr [r14+19h], 0FEh
                xor     ecx, ecx
                mov     rax, 2AAAAAAAAAAAAAABh
                mov     [r14+20h], rcx
                sub     r14, [rsi+320h]
                imul    r14
                mov     eax, 1
                sar     rdx, 4
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                shl     al, cl
                cmp     r13b, 1
                jnz     short loc_140238AD2
                or      [rsi+318h], al

loc_140238A84:                          ; CODE XREF: sub_140237620+13A4↑j
                                        ; sub_140237620+14B9↓j
                dec     byte ptr [rsi+31Ah]
                lea     r8, [rbp+40h+var_6C]
                lea     rdx, [r15+10h]
                mov     rcx, rsi
                call    sub_1402456E0
                add     word ptr [rsi+1E6h], 1
                jz      short loc_140238ABF

loc_140238AA4:                          ; CODE XREF: sub_140237620+14A9↓j
                                        ; sub_140237620+14B0↓j
                mov     rcx, gs:188h
                call    sub_140245770
                xor     r8d, r8d
                mov     [rsp+140h+var_F4], r8d
                jmp     loc_1402376DA
; ---------------------------------------------------------------------------

loc_140238ABF:                          ; CODE XREF: sub_140237620+1482↑j
                lea     rax, [rsi+98h]
                cmp     [rax], rax
                jz      short loc_140238AA4
                call    KiCheckForKernelApcDelivery
                jmp     short loc_140238AA4
; ---------------------------------------------------------------------------

loc_140238AD2:                          ; CODE XREF: sub_140237620+145C↑j
                lock or [rsi+366h], al
                jmp     short loc_140238A84
; ---------------------------------------------------------------------------

loc_140238ADB:                          ; CODE XREF: sub_140237620+10C9↑j
                mov     rcx, [rbx+0B8h]
                call    sub_140245840
                mov     r9d, eax

loc_140238AEA:                          ; CODE XREF: sub_140237620+10D5↑j
                dec     word ptr [rbx+1E6h]
                inc     byte ptr [rbx+31Ah]
                movsx   eax, byte ptr [rbx+318h]
                lea     r8, [rdi+18h]
                movsx   edx, byte ptr [rbx+366h]
                mov     r10, 7FFFFFFFFFFFFFFCh
                movzx   r13d, byte ptr [rbx+31Ah]
                or      edx, eax
                xor     edx, 3Fh
                and     r8, r10
                bsr     ecx, edx
                mov     [rbp+40h+var_88], ecx
                jz      short loc_140238B5B
                nop     word ptr [rax+rax+00h]

loc_140238B31:                          ; CODE XREF: sub_140237620+1537↓j
                lea     rsi, [rcx+rcx*2]
                mov     eax, 1
                shl     rsi, 5
                add     rsi, [rbx+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    byte ptr [rsi+1Ah], 1
                jnz     short loc_140238B7F

loc_140238B51:                          ; CODE XREF: sub_140237620+1564↓j
                                        ; sub_140237620+1570↓j ...
                bsr     ecx, edx
                mov     [rbp+40h+var_88], ecx
                jnz     short loc_140238B31

loc_140238B59:                          ; CODE XREF: sub_140237620+1588↓j
                xor     esi, esi

loc_140238B5B:                          ; CODE XREF: sub_140237620+1509↑j
                mov     eax, [rbx+78h]
                bt      eax, 10h
                jb      loc_140238C18
                lea     r8, [rdi+18h]
                mov     [rsp+140h+var_120], rsi
                mov     rdx, rbx
                mov     ecx, 162h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140238B7F:                          ; CODE XREF: sub_140237620+152F↑j
                mov     eax, [rsi+20h]
                test    al, 1
                jnz     short loc_140238B51
                mov     rax, [rsi+20h]
                and     rax, r10
                cmp     rax, r8
                jnz     short loc_140238B51
                cmp     [rsi+28h], r9d
                jnz     short loc_140238B51
                and     byte ptr [rsi+1Ah], 0FEh
                mov     rax, [rsi+20h]
                test    rax, rax
                jz      short loc_140238B51
                test    rsi, rsi
                jz      short loc_140238B59
                movzx   eax, byte ptr [rsi+20h]
                or      al, 2
                mov     [rsi+20h], al
                mov     rax, [rsi+20h]
                shr     rax, 3Fh
                test    al, al
                jz      short loc_140238BC7
                mov     rcx, rsi
                call    sub_14031EC80

loc_140238BC7:                          ; CODE XREF: sub_140237620+159D↑j
                mov     eax, [rsi+58h]
                and     eax, 1FFFFh
                mov     [rbp+40h+var_84], eax
                and     dword ptr [rsi+58h], 0FFFE0000h
                and     byte ptr [rsi+19h], 0FEh
                xor     eax, eax
                mov     [rsi+20h], rax
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rsi, [rbx+320h]
                imul    rsi
                mov     eax, 1
                sar     rdx, 4
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                shl     al, cl
                cmp     r13b, 1
                jnz     short loc_140238C5E
                or      [rbx+318h], al

loc_140238C18:                          ; CODE XREF: sub_140237620+1542↑j
                                        ; sub_140237620+1645↓j
                dec     byte ptr [rbx+31Ah]
                lea     r8, [rbp+40h+var_84]
                lea     rdx, [rdi+18h]
                mov     rcx, rbx
                call    sub_1402456E0
                add     word ptr [rbx+1E6h], 1
                jz      short loc_140238C4B

loc_140238C38:                          ; CODE XREF: sub_140237620+1635↓j
                                        ; sub_140237620+163C↓j
                mov     rcx, gs:188h
                call    sub_140245770
                jmp     loc_140237C11
; ---------------------------------------------------------------------------

loc_140238C4B:                          ; CODE XREF: sub_140237620+1616↑j
                lea     rax, [rbx+98h]
                cmp     [rax], rax
                jz      short loc_140238C38
                call    KiCheckForKernelApcDelivery
                jmp     short loc_140238C38
; ---------------------------------------------------------------------------

loc_140238C5E:                          ; CODE XREF: sub_140237620+15F0↑j
                lock or [rbx+366h], al
                jmp     short loc_140238C18
; ---------------------------------------------------------------------------

loc_140238C67:                          ; CODE XREF: sub_140237620+2B2↑j
                mov     r9d, [rbp+40h+arg_20]
                mov     r8, rdi
                mov     rdx, [rbp+40h+arg_8]
                mov     rcx, [rbp+40h+arg_0]
                call    sub_140343DB8
                jmp     loc_1402378D8
; ---------------------------------------------------------------------------

loc_140238C80:                          ; CODE XREF: sub_140237620+4CF↑j
                xor     eax, eax
                mov     esi, ecx
                cmp     r9d, r15d
                mov     r8d, eax
                cmovnb  esi, edx
                jmp     loc_140237B0E
; ---------------------------------------------------------------------------

loc_140238C92:                          ; CODE XREF: sub_140237620+5FD↑j
                sub     r15d, eax
                mov     rdx, rsi
                mov     r8d, r15d
                mov     rcx, rdi
                call    sub_1403927B4
                jmp     loc_140237C23
; ---------------------------------------------------------------------------

loc_140238CA8:                          ; CODE XREF: sub_140237620+339↑j
                jnb     loc_140237924
                jmp     loc_14042D9A3
; ---------------------------------------------------------------------------

loc_140238CB3:                          ; CODE XREF: sub_140237620+2BB↑j
                add     rsp, 108h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
sub_140237620   endp

; ---------------------------------------------------------------------------
algn_140238CC7:                         ; DATA XREF: .rdata:0000000140054E68↑o
                                        ; .pdata:00000001400CB76C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140238CD0   proc near               ; CODE XREF: sub_140237620+174↑p
                                        ; sub_140237620+500↑p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h
arg_20          = qword ptr  28h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_10], rbp
                mov     [rsp+arg_18], rsi
                push    rdi
                push    r14
                mov     rbx, [rcx+8]
                mov     edi, r9d
                mov     rbp, [rcx]
                mov     r10d, r8d
                lea     ecx, [rdx+rdx]
                mov     [rsp+10h+arg_8], 0
                shr     rcx, 6
                mov     r14, 5555555555555555h
                lea     rax, [rbp-1]
                shr     rax, 6
                lea     rdx, [rbx+rcx*8]
                lea     rsi, [rbx+rax*8]

loc_140238D18:                          ; CODE XREF: sub_140238CD0+160↓j
                cmp     rbp, 40h ; '@'
                jb      loc_140238E08

loc_140238D22:                          ; CODE XREF: sub_140238CD0+EA↓j
                mov     r9, [rdx]
                mov     rax, r9
                and     rax, r14
                cmp     rax, r14
                jz      short loc_140238DAC
                cmp     rdx, rsi
                jz      loc_140238DE7

loc_140238D39:                          ; CODE XREF: sub_140238CD0+11D↓j
                                        ; sub_140238CD0+128↓j ...
                imul    r10d, edi
                shr     r10d, 7
                and     r10d, 1FFFFFEh

loc_140238D48:                          ; CODE XREF: sub_140238CD0+14C↓j
                mov     r11, r9
                not     r11
                cmp     edi, 40h ; '@'
                jb      short loc_140238DBF
                mov     rax, r14

loc_140238D56:                          ; CODE XREF: sub_140238CD0+112↓j
                mov     r8, [rsp+10h+arg_20]
                and     r11, rax
                mov     ecx, r10d
                mov     rax, r9
                ror     r11, cl
                bsf     rcx, r11
                add     ecx, r10d
                and     ecx, 3Fh
                shl     r8, cl
                or      r8, r9
                mov     [rsp+10h+arg_8], ecx
                lock cmpxchg [rdx], r8
                mov     r9, rax
                jnz     loc_140238E16
                mov     rbp, [rsp+10h+arg_10]
                sub     rdx, rbx
                mov     rbx, [rsp+10h+arg_0]
                mov     rsi, [rsp+10h+arg_18]
                sar     rdx, 3
                shl     edx, 6
                lea     eax, [rcx+rdx]
                shr     eax, 1
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140238DAC:                          ; CODE XREF: sub_140238CD0+5E↑j
                mov     rax, rdx
                add     rdx, 8
                cmp     rax, rsi
                cmovz   rdx, rbx
                jmp     loc_140238D22
; ---------------------------------------------------------------------------

loc_140238DBF:                          ; CODE XREF: sub_140238CD0+81↑j
                mov     ecx, edi
                mov     rax, r11
                and     rax, r14
                bsf     r8, rax
                mov     eax, 1
                shl     rax, cl
                add     r10d, r8d
                dec     rax
                mov     ecx, r8d
                shl     rax, cl
                and     rax, r14
                jmp     loc_140238D56
; ---------------------------------------------------------------------------

loc_140238DE7:                          ; CODE XREF: sub_140238CD0+63↑j
                mov     rcx, rbp
                and     ecx, 3Fh
                jz      loc_140238D39
                mov     eax, edi
                cmp     rcx, rax
                jnb     loc_140238D39
                mov     edi, ebp
                and     edi, 3Fh
                jmp     loc_140238D39
; ---------------------------------------------------------------------------

loc_140238E08:                          ; CODE XREF: sub_140238CD0+4C↑j
                cmp     ebp, edi
                jnb     short loc_140238E0E
                mov     edi, ebp

loc_140238E0E:                          ; CODE XREF: sub_140238CD0+13A↑j
                mov     r9, [rdx]
                jmp     loc_140238D39
; ---------------------------------------------------------------------------

loc_140238E16:                          ; CODE XREF: sub_140238CD0+B3↑j
                and     rax, r14
                cmp     rax, r14
                jnz     loc_140238D48
                lea     rax, [rdx+8]
                mov     rdx, rbx
                cmp     rax, rsi
                cmovbe  rdx, rax
                jmp     loc_140238D18
sub_140238CD0   endp

; ---------------------------------------------------------------------------
algn_140238E35:                         ; DATA XREF: .pdata:00000001400CB778↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140238E40   proc near               ; CODE XREF: ExAllocatePoolWithTagPriority+2E↑p
                                        ; DATA XREF: .pdata:00000001400CB784↑o

var_38          = xmmword ptr -38h
var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 40h
                xor     eax, eax
                lea     rbx, unk_140C50C00
                mov     [rsp+58h+var_28], rax
                test    rdx, 0FFFh
                xorps   xmm0, xmm0
                mov     esi, 0
                movups  [rsp+58h+var_38], xmm0
                mov     rax, gs:188h
                mov     edi, esi
                setnz   dil
                mov     ebp, ecx
                mov     r15d, r8d
                mov     r11, rdx
                mov     r14d, ecx
                mov     r9, [rax+0B8h]
                mov     rax, rdx
                shr     rax, 0Ch
                add     rdi, rax
                mov     r9, [r9+558h]
                and     ebp, 1
                jnz     short loc_140238EC4
                mov     rax, cs:qword_140C4C748
                mov     r10, cs:qword_140C4C740
                sub     r10, rax
                jmp     short loc_140238F3C
; ---------------------------------------------------------------------------

loc_140238EC4:                          ; CODE XREF: sub_140238E40+6F↑j
                test    r14b, 20h
                jz      short loc_140238F2E
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+558h]
                mov     ecx, 10000h
                movsxd  r10, dword ptr [rdx+364h]
                mov     eax, [rdx+368h]
                mov     r8, [rdx+0B8h]
                sub     rcx, rax
                shl     r10, 15h
                mov     rax, r10
                shl     r8, 0Ch
                shl     rcx, 15h
                sub     r10, r8
                cmp     rax, r8
                mov     rax, cs:qword_140C4E4C8
                cmovbe  r10, rsi
                add     r10, rcx
                movzx   ecx, word ptr [r9+1AEh]
                mov     rbx, [rax+rcx*8]
                jmp     short loc_140238F40
; ---------------------------------------------------------------------------

loc_140238F2E:                          ; CODE XREF: sub_140238E40+88↑j
                mov     r10, cs:qword_140C4EDB8
                sub     r10, cs:qword_140C4EDA8

loc_140238F3C:                          ; CODE XREF: sub_140238E40+82↑j
                shl     r10, 0Ch

loc_140238F40:                          ; CODE XREF: sub_140238E40+EC↑j
                lea     rax, [r11+80000h]
                cmp     r15d, 10h
                jz      short loc_140238F54
                lea     rax, [r11+200000h]

loc_140238F54:                          ; CODE XREF: sub_140238E40+10B↑j
                cmp     rax, r10
                ja      short loc_140238F9A
                test    ebp, ebp
                jz      loc_140239045
                mov     r9, [rbx+1848h]
                mov     rax, rsi
                mov     r8, [rbx+1D28h]
                mov     rcx, r9
                sub     rcx, r8
                cmp     r8, r9
                cmovbe  rax, rcx
                cmp     rdi, rax
                jbe     loc_140239045
                xor     r9d, r9d
                mov     rdx, rdi
                mov     rcx, rbx
                lea     r8d, [r9+2]
                call    sub_140543B14

loc_140238F9A:                          ; CODE XREF: sub_140238E40+117↑j
                                        ; sub_140238E40+223↓j
                test    r14b, 20h
                jnz     loc_1402390DF
                test    ebp, ebp
                jnz     loc_14023906F
                lea     rcx, [rbx+1340h]
                lea     rdx, [rsp+58h+var_38]
                call    KeAcquireInStackQueuedSpinLock
                mov     rcx, [rbx+108h]
                cmp     [rcx+4], ebp
                jnz     short loc_140238FD3
                xor     r8d, r8d
                xor     edx, edx
                call    KePulseEvent

loc_140238FD3:                          ; CODE XREF: sub_140238E40+187↑j
                lea     rcx, [rsp+58h+var_38]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rsp+58h+var_28]
                test    eax, eax
                jz      short loc_14023903C
                test    al, 1
                jz      short loc_14023903C
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14023903C
                cmp     bl, 0Fh
                ja      short loc_14023903C
                cmp     al, 2
                jb      short loc_14023903C
                mov     r10, gs:20h
                mov     rax, 0FFFFFFFFFFFFFFFFh
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, byte ptr [rsp+58h+var_28]
                inc     ecx
                shl     rax, cl
                movzx   edx, ax
                not     edx
                and     r8d, edx
                mov     [r9+14h], r8d
                jnz     short loc_14023903C
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14023903C:                          ; CODE XREF: sub_140238E40+1AA↑j
                                        ; sub_140238E40+1AE↑j ...
                mov     cr8, rbx
                jmp     loc_1402390DA
; ---------------------------------------------------------------------------

loc_140239045:                          ; CODE XREF: sub_140238E40+11B↑j
                                        ; sub_140238E40+142↑j
                lea     rax, [r11+0A00000h]
                cmp     rax, r10
                jb      short loc_140239068
                cmp     qword ptr [rbx+1B10h], 40000h
                jb      short loc_140239068
                mov     esi, 1
                jmp     loc_140238F9A
; ---------------------------------------------------------------------------

loc_140239068:                          ; CODE XREF: sub_140238E40+20F↑j
                                        ; sub_140238E40+21C↑j
                mov     eax, 1
                jmp     short loc_1402390E1
; ---------------------------------------------------------------------------

loc_14023906F:                          ; CODE XREF: sub_140238E40+166↑j
                mov     rdi, gs:188h
                dec     word ptr [rdi+1E6h]
                xor     edx, edx
                lea     rcx, qword_140C4ED98
                call    ExAcquirePushLockExclusiveEx
                mov     rcx, [rbx+0F8h]
                cmp     dword ptr [rcx+4], 0
                jnz     short loc_1402390A4
                xor     r8d, r8d
                xor     edx, edx
                call    KePulseEvent

loc_1402390A4:                          ; CODE XREF: sub_140238E40+258↑j
                mov     rax, 0FFFFFFFFFFFFFFFFh
                lock xadd cs:qword_140C4ED98, rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_1402390C6
                lea     rcx, qword_140C4ED98
                call    ExfTryToWakePushLock

loc_1402390C6:                          ; CODE XREF: sub_140238E40+278↑j
                lea     rcx, qword_140C4ED98
                call    sub_140243660
                mov     rcx, rdi
                call    sub_140245770

loc_1402390DA:                          ; CODE XREF: sub_140238E40+200↑j
                call    sub_1402670D0

loc_1402390DF:                          ; CODE XREF: sub_140238E40+15E↑j
                mov     eax, esi

loc_1402390E1:                          ; CODE XREF: sub_140238E40+22D↑j
                mov     rbx, [rsp+58h+arg_0]
                mov     rbp, [rsp+58h+arg_8]
                mov     rsi, [rsp+58h+arg_10]
                add     rsp, 40h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140238E40   endp

byte_1402390FB  db 15h dup(0CCh)        ; DATA XREF: .pdata:00000001400CB784↑o

; =============== S U B R O U T I N E =======================================


sub_140239110   proc near               ; CODE XREF: sub_1406444C0+3E↓p
                                        ; DATA XREF: .pdata:00000001400CB790↑o
                cmp     rcx, cs:IoFileObjectType
                jz      short loc_14023911D

loc_140239119:                          ; CODE XREF: sub_140239110+2F↓j
                xor     al, al
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14023911D:                          ; CODE XREF: sub_140239110+7↑j
                cmp     cs:byte_140C1D360, 0
                jnz     short loc_140239141
                cmp     cs:byte_140C1D361, 0
                jnz     short loc_140239141
                cmp     cs:byte_140C1D378, 0
                jnz     short loc_140239141
                cmp     cs:byte_140C1D379, 0
                jz      short loc_140239119

loc_140239141:                          ; CODE XREF: sub_140239110+14↑j
                                        ; sub_140239110+1D↑j ...
                mov     al, 1
                retn
sub_140239110   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_140239145:                         ; DATA XREF: .pdata:00000001400CB790↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140239150   proc near               ; CODE XREF: sub_1402369F0+6E8↑p
                                        ; sub_1402369F0+883↑p ...

var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h
arg_20          = qword ptr  28h
arg_28          = qword ptr  30h

; FUNCTION CHUNK AT 000000014042E366 SIZE 0000004A BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_10], rbp
                mov     [rsp+arg_18], rsi
                mov     [rsp+arg_8], edx
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                mov     r12d, r9d
                mov     r13d, r8d
                mov     rbp, rcx
                cmp     edx, r8d
                jnz     loc_14042E366

loc_140239182:                          ; CODE XREF: sub_140239150+1F521A↓j
                mov     r14d, [rcx+0B0h]
                lea     r10d, [r13+0Fh]
                mov     rsi, [rsp+58h+arg_28]
                and     r14d, 1
                mov     r11, [rsp+58h+arg_20]
                inc     r14d
                shr     r10d, 4
                add     r14d, r10d
                mov     edi, r14d
                shl     edi, 10h
                cmp     dword ptr [rsi], 0
                jnz     short loc_1402391D5
                mov     dword ptr [rsi], 1
                test    r12b, 1
                jnz     short loc_1402391D5
                mov     edx, [rcx+8]
                mov     r8, r11
                call    sub_140317450
                mov     r11, [rsp+58h+arg_20]

loc_1402391D5:                          ; CODE XREF: sub_140239150+64↑j
                                        ; sub_140239150+70↑j
                lea     r15, [rbp+10h]

loc_1402391D9:                          ; CODE XREF: sub_140239150+3B3↓j
                mov     rax, [r15+8]
                mov     rbx, [r15]
                test    al, 1
                jz      short loc_1402391EC
                test    rbx, rbx
                jz      short loc_1402391EC
                xor     rbx, r15

loc_1402391EC:                          ; CODE XREF: sub_140239150+92↑j
                                        ; sub_140239150+97↑j
                movzx   ecx, al
                xor     edx, edx
                and     ecx, 1
                test    rbx, rbx
                jz      short loc_14023922A
                nop     dword ptr [rax+00000000h]

loc_140239200:                          ; CODE XREF: sub_140239150+D8↓j
                lea     rax, [rbx-8]
                xor     eax, [rax]
                xor     eax, dword ptr cs:xmmword_140C1DC20
                cmp     edi, eax
                jb      loc_1402393C8
                jbe     short loc_14023922D
                mov     rax, [rbx+8]
                test    ecx, ecx
                jnz     loc_1402393E1

loc_140239222:                          ; CODE XREF: sub_140239150+280↓j
                                        ; sub_140239150+289↓j ...
                mov     rbx, rax

loc_140239225:                          ; CODE XREF: sub_140239150+29D↓j
                test    rbx, rbx
                jnz     short loc_140239200

loc_14023922A:                          ; CODE XREF: sub_140239150+A7↑j
                mov     rbx, rdx

loc_14023922D:                          ; CODE XREF: sub_140239150+C4↑j
                test    rbx, rbx
                jz      loc_140239494
                mov     r9, [rbx-8]
                lea     rdi, [rbx-8]
                mov     r8, qword ptr cs:xmmword_140C1DC20
                mov     rcx, r9
                shr     rcx, 20h
                mov     rax, rdi
                shr     rax, 20h
                mov     rdx, r8
                xor     eax, ecx
                shr     rdx, 20h
                xor     eax, edx
                mov     r10, rdi
                test    eax, 0FF0000h
                jnz     loc_14042E36F
                mov     rax, rdi
                shr     rax, 20h
                xor     eax, ecx
                xor     eax, edx
                movzx   eax, ax
                test    eax, eax
                jz      loc_14023948D
                xor     r9, rdi
                xor     r9, r8
                shr     r9, 20h
                movzx   eax, r9w
                shl     rax, 4
                sub     r10, rax
                mov     rax, r10
                shr     rax, 20h
                mov     rcx, [r10]
                mov     r9, rcx
                shr     r9, 20h
                xor     r9d, eax
                xor     r9d, edx
                test    r9d, 0FF0000h
                jnz     loc_1402393F2
                test    r9w, r9w
                jz      loc_14023948D
                xor     rcx, r10
                xor     rcx, r8
                shr     rcx, 20h
                movzx   eax, cx
                shl     rax, 4
                sub     r10, rax
                mov     eax, [r10+8]
                xor     eax, r10d
                xor     eax, r8d
                movzx   ecx, al

loc_1402392E6:                          ; CODE XREF: sub_140239150+2AF↓j
                                        ; sub_140239150+33F↓j ...
                shl     ecx, 0Ch
                mov     eax, ecx
                sub     r10, rax
                mov     eax, 2BEDh
                and     r10, 0FFFFFFFFFFFFF000h
                movzx   ecx, word ptr [r10+22h]
                xor     cx, [r10+20h]
                xor     cx, ax
                mov     eax, 7FFFh
                test    ax, cx
                jnz     loc_14042E37E
                mov     eax, [rbp+0B0h]
                test    al, 1
                jz      short loc_14023932F
                lea     rax, [rdi+20h]
                test    rax, 0FFFh
                jnz     loc_140239404

loc_14023932F:                          ; CODE XREF: sub_140239150+1CD↑j
                                        ; sub_140239150+2B7↓j
                mov     [rsp+58h+var_30], r11
                mov     r9d, r14d
                mov     r8, rdi
                mov     dword ptr [rsp+58h+var_38], r12d
                mov     rdx, r10
                mov     rcx, rbp
                call    sub_140239520
                test    eax, eax
                jz      loc_140239508
                movzx   ecx, word ptr [rdi+2]
                lea     rsi, [rdi+10h]
                mov     eax, edi
                shr     eax, 10h
                xor     ecx, eax
                movzx   eax, word ptr cs:xmmword_140C1DC20+2
                xor     ecx, eax
                mov     eax, [rbp+0B0h]
                shl     ecx, 4
                sub     ecx, 10h
                test    al, 1
                jz      short loc_14023938D
                lea     rax, [rdi+20h]
                test    rax, 0FFFh
                jnz     short loc_14023938D
                lea     rsi, [rdi+20h]
                add     ecx, 0FFFFFFF0h

loc_14023938D:                          ; CODE XREF: sub_140239150+228↑j
                                        ; sub_140239150+234↑j
                mov     edi, [rsp+58h+arg_8]
                mov     eax, [rbx]
                cmp     edi, ecx
                jb      short loc_14023940C
                btr     eax, 8
                mov     [rbx], eax

loc_14023939D:                          ; CODE XREF: sub_140239150+302↓j
                test    r12b, 2
                jnz     loc_140239457

loc_1402393A7:                          ; CODE XREF: sub_140239150+338↓j
                mov     rax, rsi

loc_1402393AA:                          ; CODE XREF: sub_140239150+3BA↓j
                mov     rbx, [rsp+58h+arg_0]
                mov     rbp, [rsp+58h+arg_10]
                mov     rsi, [rsp+58h+arg_18]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 8

loc_1402393C8:                          ; CODE XREF: sub_140239150+BE↑j
                mov     rax, [rbx]
                mov     rdx, rbx
                test    ecx, ecx
                jz      loc_140239222
                test    rax, rax
                jz      loc_140239222
                jmp     short loc_1402393EA
; ---------------------------------------------------------------------------

loc_1402393E1:                          ; CODE XREF: sub_140239150+CC↑j
                test    rax, rax
                jz      loc_140239222

loc_1402393EA:                          ; CODE XREF: sub_140239150+28F↑j
                xor     rbx, rax
                jmp     loc_140239225
; ---------------------------------------------------------------------------

loc_1402393F2:                          ; CODE XREF: sub_140239150+165↑j
                mov     eax, [r10+8]
                xor     eax, r10d
                xor     eax, r8d
                movzx   ecx, al
                jmp     loc_1402392E6
; ---------------------------------------------------------------------------

loc_140239404:                          ; CODE XREF: sub_140239150+1D9↑j
                dec     r14d
                jmp     loc_14023932F
; ---------------------------------------------------------------------------

loc_14023940C:                          ; CODE XREF: sub_140239150+245↑j
                mov     r9d, ecx
                mov     r8d, ecx
                bts     eax, 8
                sub     r9d, edi
                mov     [rbx], eax
                mov     r10d, 1FFFh
                mov     byte ptr [rcx+rsi-1], 0
                movzx   eax, word ptr [rcx+rsi-2]
                mov     ecx, 8000h
                movzx   edx, ax
                or      dx, cx
                movzx   ecx, r9w
                xor     cx, ax
                and     cx, r10w
                xor     cx, ax
                cmp     r9d, 1
                cmovz   cx, dx
                mov     [r8+rsi-2], cx
                jmp     loc_14023939D
; ---------------------------------------------------------------------------

loc_140239457:                          ; CODE XREF: sub_140239150+251↑j
                test    r12b, 1
                jnz     short loc_14023946D
                mov     rdx, [rsp+58h+arg_20]
                mov     ecx, [rbp+8]
                call    sub_1403175C0

loc_14023946D:                          ; CODE XREF: sub_140239150+30B↑j
                mov     rax, [rsp+58h+arg_28]
                mov     r8, rdi
                xor     edx, edx
                mov     rcx, rsi
                mov     dword ptr [rax], 0
                call    memset
                jmp     loc_1402393A7
; ---------------------------------------------------------------------------

loc_14023948D:                          ; CODE XREF: sub_140239150+12C↑j
                                        ; sub_140239150+16F↑j
                xor     ecx, ecx
                jmp     loc_1402392E6
; ---------------------------------------------------------------------------

loc_140239494:                          ; CODE XREF: sub_140239150+E0↑j
                mov     ebx, r12d
                and     ebx, 1
                jnz     short loc_1402394A7
                mov     ecx, [rbp+8]
                mov     rdx, r11
                call    sub_1403175C0

loc_1402394A7:                          ; CODE XREF: sub_140239150+34A↑j
                mov     r8d, r12d
                mov     dword ptr [rsi], 0
                mov     edx, r13d
                mov     rcx, rbp
                call    sub_140348080
                mov     rsi, rax
                test    rax, rax
                jz      short loc_140239508
                mov     rax, [rsp+58h+arg_28]
                mov     dword ptr [rax], 1
                test    ebx, ebx
                jnz     short loc_1402394E8
                mov     r8, [rsp+58h+arg_20]
                mov     rcx, rbp
                mov     edx, [rbp+8]
                call    sub_140317450

loc_1402394E8:                          ; CODE XREF: sub_140239150+383↑j
                mov     rdx, rsi
                mov     rcx, rbp
                call    sub_140316EF8
                mov     r11, [rsp+58h+arg_20]
                mov     rsi, [rsp+58h+arg_28]
                jmp     loc_1402391D9
; ---------------------------------------------------------------------------

loc_140239508:                          ; CODE XREF: sub_140239150+1FC↑j
                                        ; sub_140239150+371↑j ...
                xor     eax, eax
                jmp     loc_1402393AA
sub_140239150   endp

; ---------------------------------------------------------------------------
algn_14023950F:                         ; DATA XREF: .rdata:0000000140054EB0↑o
                                        ; .pdata:00000001400CB79C↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_140239520   proc near               ; CODE XREF: sub_140239150+1F5↑p
                                        ; DATA XREF: .rdata:0000000140054EDC↑o ...

var_58          = qword ptr -58h
var_48          = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
var_10          = qword ptr -10h
arg_0           = qword ptr  48h
arg_8           = qword ptr  50h
arg_10          = dword ptr  58h
arg_18          = dword ptr  60h
arg_20          = dword ptr  68h
arg_28          = qword ptr  70h

; FUNCTION CHUNK AT 000000014042E3B0 SIZE 00000199 BYTES

                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                mov     rbp, rsp
                sub     rsp, 78h
                movzx   r15d, word ptr [r8+2]
                mov     eax, r8d
                shr     eax, 10h
                mov     r13, rdx
                xor     r15d, eax
                mov     esi, r9d
                movzx   eax, word ptr cs:xmmword_140C1DC20+2
                lea     rdx, [r8+8]
                mov     r14, rcx
                xor     r15d, eax
                add     rcx, 10h
                mov     rdi, r8
                call    RtlRbRemoveNode
                mov     r9, [rdi]
                xor     ebx, ebx
                xor     r9, qword ptr cs:xmmword_140C1DC20
                mov     r10d, edi
                xor     r9, rdi
                mov     r8d, r10d
                and     r8d, 0FFFh
                mov     edx, r9d
                shr     rdx, 10h
                add     r8, 0FFFh
                shl     rdx, 4
                mov     eax, r9d
                shr     eax, 10h
                add     rdx, rdi
                shl     eax, 4
                sub     edx, r13d
                mov     ecx, eax
                and     edx, 0FFFFF000h
                add     r8, rcx
                add     rax, 0FFFh
                shr     rax, 0Ch
                mov     ecx, edx
                shr     r8, 0Ch
                mov     r11d, edi
                sub     r8d, eax
                sub     r11d, r13d
                lea     eax, [r11+101Fh]
                and     eax, 0FFFFF000h
                sub     ecx, eax
                cmp     eax, edx
                movzx   eax, r9w
                cmovnb  ecx, ebx
                sub     r8d, eax
                shr     ecx, 0Ch
                lea     eax, [rcx+r8]
                sub     [r14+38h], rax
                sub     r15d, esi
                jz      short loc_140239632
                mov     eax, [r14+0B0h]
                test    al, 1
                jz      short loc_140239632
                mov     eax, esi
                shl     rax, 4
                add     rax, rdi
                lea     rcx, [rax+0FFFh]
                and     rcx, 0FFFFFFFFFFFFF000h
                sub     rcx, rax
                shr     rcx, 4
                mov     eax, ecx
                shl     eax, 4
                cmp     eax, 20h ; ' '
                jb      loc_14023A1DB
                test    eax, 0FFFFFFC0h
                jz      loc_140239B3F

loc_140239632:                          ; CODE XREF: sub_140239520+CE↑j
                                        ; sub_140239520+D9↑j ...
                mov     eax, r15d
                shl     eax, 4
                cmp     eax, 20h ; ' '
                jb      loc_140239ADB

loc_140239641:                          ; CODE XREF: sub_140239520+5BE↓j
                cmp     eax, 20h ; ' '
                mov     [rbp+arg_0], rbx
                mov     rax, qword ptr cs:xmmword_140C1DC20
                mov     r8d, r11d
                mov     ecx, ebx
                mov     dword ptr [rbp+arg_0+4], 10000h
                cmovnb  ecx, r15d
                mov     edx, esi
                shr     rax, 20h
                shr     eax, 10h
                mov     [rbp+arg_10], ecx
                mov     rcx, [rbp+arg_0]
                shr     rcx, 20h
                shr     ecx, 10h
                xor     cl, al
                shl     edx, 4
                shr     r8d, 0Ch
                mov     rax, rdi
                shr     rax, 20h
                xor     r10d, r8d
                shr     eax, 10h
                xor     cl, al
                lea     eax, [rdx+20h]
                mov     [rdi+6], cl
                mov     ecx, 3Fh ; '?'
                xor     r10d, dword ptr cs:xmmword_140C1DC20
                movzx   r9d, r10b
                mov     r10d, [rbp+arg_10]
                test    r10d, r10d
                mov     [rdi+8], r9d
                mov     r15d, r10d
                cmovz   eax, edx
                dec     r11d
                add     eax, r11d
                mov     r11, 0FFFFFFFFFFFFFFFFh
                shr     eax, 0Ch
                mov     rdx, r11
                sub     cl, al
                mov     r12, r11
                mov     rax, [r13+10h]
                shr     rdx, cl
                mov     ecx, r8d
                shl     r12, cl
                mov     r8, 0F0F0F0F0F0F0F0Fh
                and     r12, rdx
                mov     rcx, 5555555555555555h
                xor     rax, r12
                mov     rdx, 3333333333333333h
                and     r12, rax
                jnz     loc_140239B52

loc_140239707:                          ; CODE XREF: sub_140239520+808↓j
                mov     eax, edi
                shr     eax, 10h
                xor     ax, si
                xor     ax, word ptr cs:xmmword_140C1DC20+2
                mov     [rdi+2], ax
                test    r15d, r15d
                jz      loc_140239AF9
                mov     eax, esi
                shl     rax, 4
                add     rdi, rax
                mov     [rbp+arg_0], rbx
                test    esi, esi
                jz      loc_14042E4DA
                movzx   edx, si

loc_14023973B:                          ; CODE XREF: sub_140239520+1F4FDA↓j
                movzx   ecx, word ptr [rbp+arg_0]
                and     edx, 0FF01FFFFh
                bts     edx, 10h
                mov     eax, r15d
                shl     eax, 10h
                or      ecx, eax
                mov     dword ptr [rbp+arg_0+4], edx
                mov     rax, rdi
                mov     dword ptr [rbp+arg_0], ecx
                xor     rax, qword ptr cs:xmmword_140C1DC20
                xor     rax, [rbp+arg_0]
                mov     [rdi], rax
                mov     eax, edi
                sub     eax, r13d
                mov     edx, r15d
                shr     eax, 0Ch
                xor     eax, edi
                shl     rdx, 4
                xor     eax, dword ptr cs:xmmword_140C1DC20
                add     rdx, rdi
                movzx   eax, al
                mov     [rdi+8], eax
                movzx   eax, word ptr [r13+20h]
                add     rax, 3
                shl     rax, 4
                add     rax, r13
                cmp     rdx, rax
                jnb     short loc_1402397CC
                movzx   eax, r15w
                mov     [rbp+arg_0], rbx
                mov     dword ptr [rbp+arg_0+4], eax
                mov     rax, qword ptr cs:xmmword_140C1DC20
                mov     rcx, [rbp+arg_0]
                shr     rax, 20h
                shr     rcx, 20h
                xor     cx, ax
                mov     rax, rdx
                shr     rax, 20h
                xor     cx, ax
                mov     [rdx+4], cx

loc_1402397CC:                          ; CODE XREF: sub_140239520+27B↑j
                mov     r10d, ebx

loc_1402397CF:                          ; CODE XREF: sub_140239520+9C7↓j
                lea     r9, [r13+30h]
                mov     [rbp+arg_18], r10d
                nop     word ptr [rax+rax+00000000h]
                mov     rdx, qword ptr cs:xmmword_140C1DC20
                mov     rax, [rdi]
                xor     rax, rdi
                xor     rax, rdx
                shr     rdx, 20h
                mov     ecx, eax
                shr     edx, 10h
                shr     ecx, 10h
                shr     rax, 20h
                mov     r12d, ecx
                mov     dword ptr [rbp+arg_0], ecx
                mov     rcx, rbx
                movzx   r8d, ax
                mov     rax, rdi
                shr     rcx, 20h
                shr     ecx, 10h
                shr     rax, 20h
                shr     eax, 10h
                xor     cl, al
                xor     cl, dl
                mov     [rdi+6], cl
                test    r8d, r8d
                jz      short loc_14023985A
                mov     eax, r8d
                mov     rcx, rdi
                shl     rax, 4
                sub     rcx, rax
                mov     r15, rcx
                mov     [rbp+arg_8], rcx
                xor     r15, [rcx]
                xor     r15, qword ptr cs:xmmword_140C1DC20
                mov     rax, r15
                shr     rax, 20h
                test    eax, 0FF0000h
                jz      loc_14042E4FF

loc_14023985A:                          ; CODE XREF: sub_140239520+308↑j
                                        ; sub_140239520+1F5000↓j
                movzx   ecx, word ptr [r13+20h]
                mov     eax, ecx
                mov     r8d, r12d
                shl     rax, 4
                shl     r8, 4
                add     rax, r9
                add     r8, rdi
                cmp     r8, rax
                jnb     short loc_140239896
                mov     r15, [r8]
                xor     r15, r8
                xor     r15, qword ptr cs:xmmword_140C1DC20
                mov     rax, r15
                shr     rax, 20h
                test    eax, 0FF0000h
                jz      loc_140239F24

loc_140239896:                          ; CODE XREF: sub_140239520+355↑j
                                        ; sub_140239520+A23↓j
                mov     eax, [r14+0B0h]
                movzx   edx, cx
                test    al, 1
                jz      short loc_1402398DC
                mov     r8d, r12d
                shl     r8, 4
                movzx   eax, cx
                add     r8, rdi
                shl     rax, 4
                add     rax, r9
                cmp     r8, rax
                jnb     short loc_1402398DC
                mov     r15, [r8]
                xor     r15, r8
                xor     r15, qword ptr cs:xmmword_140C1DC20
                mov     rax, r15
                shr     rax, 20h
                test    eax, 0FF0000h
                jz      loc_14042E525

loc_1402398DC:                          ; CODE XREF: sub_140239520+382↑j
                                        ; sub_140239520+39B↑j ...
                cmp     dword ptr [rbp+arg_0], r12d
                jnz     loc_140239F48

loc_1402398E6:                          ; CODE XREF: sub_140239520+A57↓j
                                        ; sub_140239520+A92↓j
                movzx   eax, dx
                cmp     r12d, eax
                jz      loc_14023A25F
                cmp     r12d, r10d
                jbe     short loc_140239949
                movzx   edx, word ptr [rdi+2]
                mov     eax, edi
                shr     eax, 10h
                mov     r10d, edi
                xor     edx, eax
                sub     r10d, r13d
                movzx   eax, word ptr cs:xmmword_140C1DC20+2
                xor     edx, eax
                shl     edx, 4
                sub     edx, r13d
                lea     r8d, [r10+101Fh]
                add     edx, edi
                and     r8d, 0FFFFF000h
                and     edx, 0FFFFF000h
                cmp     r8d, edx
                jb      loc_140239EEC
                mov     r9d, ebx
                mov     r15, rbx

loc_14023993C:                          ; CODE XREF: sub_140239520+9FF↓j
                cmp     r9d, 1000h
                jnb     loc_140239DA6

loc_140239949:                          ; CODE XREF: sub_140239520+3D5↑j
                                        ; sub_140239520+889↓j ...
                mov     eax, [r14+0B0h]
                test    al, 1
                jz      short loc_140239999
                lea     rax, [rdi+20h]
                test    rax, 0FFFh
                jz      short loc_140239999
                movzx   edx, word ptr [rdi+2]
                lea     r8, [rdi+100Fh]
                movzx   r9d, word ptr cs:xmmword_140C1DC20+2
                mov     eax, edi
                shr     eax, 10h
                and     r8, 0FFFFFFFFFFFFF000h
                xor     edx, eax
                mov     rax, r8
                xor     edx, r9d
                sub     rax, rdi
                mov     ecx, edx
                shl     rcx, 4
                cmp     rax, rcx
                jb      loc_140239D2D

loc_140239999:                          ; CODE XREF: sub_140239520+432↑j
                                        ; sub_140239520+43E↑j ...
                movzx   edx, word ptr [rdi+2]
                mov     eax, edi
                shr     eax, 10h
                mov     r8d, edi
                xor     edx, eax
                movzx   eax, word ptr cs:xmmword_140C1DC20+2
                xor     edx, eax
                mov     eax, r8d
                and     eax, 0FFFh
                shl     edx, 4
                sub     r8d, r13d
                add     r8d, 101Fh
                and     r8d, 0FFFFF000h
                lea     r10, [rdx+0FFFh]
                add     r10, rax
                lea     r11, [rdx+0FFFh]
                mov     eax, edi
                shr     r10, 0Ch
                sub     eax, r13d
                shr     r11, 0Ch
                add     eax, edx
                and     eax, 0FFFFF000h
                cmp     r8d, eax
                jb      loc_14023A1E5
                mov     edx, ebx
                mov     r9, rbx

loc_1402399FF:                          ; CODE XREF: sub_140239520+CF6↓j
                shr     edx, 0Ch
                mov     rax, r9
                shr     rax, 1
                sub     dx, r11w
                mov     rcx, 5555555555555555h
                and     rax, rcx
                mov     rcx, 3333333333333333h
                sub     r9, rax
                mov     rax, r9
                and     r9, rcx
                shr     rax, 2
                and     rax, rcx
                add     rax, r9
                mov     rcx, rax
                shr     rcx, 4
                add     rcx, rax
                mov     rax, 0F0F0F0F0F0F0F0Fh
                and     rcx, rax
                mov     rax, 101010101010101h
                imul    rcx, rax
                shr     rcx, 38h
                sub     dx, cx
                mov     eax, ecx
                add     [r14+38h], rax
                add     dx, r10w
                xor     dx, di
                xor     dx, word ptr cs:xmmword_140C1DC20
                mov     [rdi], dx
                mov     edx, edi
                xor     edx, [rdi]
                mov     r8, qword ptr cs:xmmword_140C1DC20
                mov     rcx, [r14+18h]
                xor     edx, r8d
                test    cl, 1
                jnz     loc_140239B26
                mov     rbx, [r14+10h]

loc_140239A98:                          ; CODE XREF: sub_140239520+60D↓j
                                        ; sub_140239520+61A↓j
                movzx   r9d, cl
                xor     al, al
                and     r9d, 1
                test    rbx, rbx
                jz      short loc_140239AE5
                nop     word ptr [rax+rax+00000000h]

loc_140239AB0:                          ; CODE XREF: sub_140239520+5B9↓j
                mov     ecx, [rbx-8]
                lea     rax, [rbx-8]
                xor     ecx, eax
                xor     ecx, r8d
                cmp     edx, ecx
                jb      short loc_140239B0D
                mov     rax, [rbx+8]
                test    r9d, r9d
                jz      short loc_140239AD1
                test    rax, rax
                jz      short loc_140239AE3
                xor     rax, rbx

loc_140239AD1:                          ; CODE XREF: sub_140239520+5A7↑j
                test    rax, rax
                jz      short loc_140239AE3

loc_140239AD6:                          ; CODE XREF: sub_140239520+600↓j
                mov     rbx, rax
                jmp     short loc_140239AB0
; ---------------------------------------------------------------------------

loc_140239ADB:                          ; CODE XREF: sub_140239520+11B↑j
                add     esi, r15d
                jmp     loc_140239641
; ---------------------------------------------------------------------------

loc_140239AE3:                          ; CODE XREF: sub_140239520+5AC↑j
                                        ; sub_140239520+5B4↑j
                mov     al, 1

loc_140239AE5:                          ; CODE XREF: sub_140239520+585↑j
                                        ; sub_140239520+604↓j
                lea     r9, [rdi+8]
                movzx   r8d, al
                mov     rdx, rbx
                lea     rcx, [r14+10h]
                call    RtlRbInsertNodeEx

loc_140239AF9:                          ; CODE XREF: sub_140239520+1FD↑j
                                        ; sub_140239520+D4A↓j
                mov     eax, esi
                add     rsp, 78h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140239B0D:                          ; CODE XREF: sub_140239520+59E↑j
                mov     rax, [rbx]
                test    r9d, r9d
                jz      short loc_140239B1D
                test    rax, rax
                jz      short loc_140239B22
                xor     rax, rbx

loc_140239B1D:                          ; CODE XREF: sub_140239520+5F3↑j
                test    rax, rax
                jnz     short loc_140239AD6

loc_140239B22:                          ; CODE XREF: sub_140239520+5F8↑j
                xor     al, al
                jmp     short loc_140239AE5
; ---------------------------------------------------------------------------

loc_140239B26:                          ; CODE XREF: sub_140239520+56E↑j
                mov     rax, [r14+10h]
                test    rax, rax
                jz      loc_140239A98
                lea     rbx, [r14+10h]
                xor     rbx, rax
                jmp     loc_140239A98
; ---------------------------------------------------------------------------

loc_140239B3F:                          ; CODE XREF: sub_140239520+10C↑j
                cmp     eax, 20h ; ' '
                jz      loc_140239632
                inc     esi
                dec     r15d
                jmp     loc_140239632
; ---------------------------------------------------------------------------

loc_140239B52:                          ; CODE XREF: sub_140239520+1E1↑j
                mov     eax, [rbp+arg_20]
                bts     r9d, 9
                and     eax, 1
                mov     [rdi+8], r9d
                mov     [rbp+var_40], eax
                jnz     short loc_140239B98
                mov     rdx, [rbp+arg_28]
                mov     ecx, [r14+8]
                call    sub_1403175C0
                mov     rdx, 3333333333333333h
                mov     rcx, 5555555555555555h
                mov     r11, 0FFFFFFFFFFFFFFFFh
                mov     r8, 0F0F0F0F0F0F0F0Fh

loc_140239B98:                          ; CODE XREF: sub_140239520+644↑j
                mov     rax, r12
                mov     [rbp+var_20], rbx
                shr     rax, 1
                lea     r15, [r13+18h]
                and     rax, rcx
                mov     [rbp+var_10], rbx
                mov     rcx, r12
                mov     [rbp+var_18], r15
                sub     rcx, rax
                mov     rax, rcx
                and     rcx, rdx
                shr     rax, 2
                and     rax, rdx
                add     rax, rcx
                mov     rcx, rax
                shr     rcx, 4
                add     rcx, rax
                mov     rax, 101010101010101h
                and     rcx, r8
                imul    rcx, rax
                bsf     rdx, r12
                shr     rcx, 38h
                mov     [rbp+var_30], rcx
                bsr     rcx, r12
                mov     r12d, edx
                mov     [rbp+var_48], edx
                sub     ecx, edx
                shl     r12d, 0Ch
                inc     ecx
                add     r12, r13
                mov     eax, ecx
                mov     [rbp+var_44], ecx
                shl     eax, 0Ch
                mov     [rbp+arg_18], eax
                mov     eax, 1
                shl     rax, cl
                mov     ecx, edx
                dec     rax
                shl     rax, cl
                mov     [rbp+var_38], rax
                cmp     [r14+8], ebx
                jz      loc_14023A1A0
                mov     r15, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042E3B0

loc_140239C47:                          ; CODE XREF: sub_140239520+1F4E92↓j
                                        ; sub_140239520+1F4E9C↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                lea     rcx, [r13+18h]
                movzx   edx, r15b
                jnz     loc_14042E3F1
                call    sub_140234420

loc_140239C61:                          ; CODE XREF: sub_140239520+1F4ED7↓j
                movzx   eax, r15b
                lea     r15, [r13+18h]
                mov     [rbp+var_10], rax

loc_140239C6D:                          ; CODE XREF: sub_140239520+C9E↓j
                mov     rax, [r14+98h]
                mov     rdx, r12
                xor     rax, qword ptr cs:xmmword_140C1DC20
                mov     rcx, [r14+80h]
                xor     rax, r14
                mov     r8d, [rbp+arg_18]
                xor     rcx, r14
                call    sub_1404079D0
                mov     r12d, eax
                test    eax, eax
                js      short loc_140239CB0
                mov     rax, [rbp+var_38]
                or      [r13+10h], rax
                mov     rax, [rbp+var_30]
                lock xadd [r14+30h], rax
                mov     r12d, ebx

loc_140239CB0:                          ; CODE XREF: sub_140239520+779↑j
                cmp     [r14+8], ebx
                jz      loc_140239FEB
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14042E427
                mov     [r15], ebx

loc_140239CCA:                          ; CODE XREF: sub_140239520+1F4F14↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14042E439

loc_140239CE3:                          ; CODE XREF: sub_140239520+1F4F1D↓j
                                        ; sub_140239520+1F4F2C↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14042E45D

loc_140239CF1:                          ; CODE XREF: sub_140239520+1F4F3F↓j
                                        ; sub_140239520+1F4F4B↓j
                mov     r15, [rbp+var_10]

loc_140239CF5:                          ; CODE XREF: sub_140239520+1F4F59↓j
                                        ; sub_140239520+1F4F61↓j ...
                movzx   eax, r15b
                mov     cr8, rax

loc_140239CFD:                          ; CODE XREF: sub_140239520+C7B↓j
                mov     eax, [rbp+arg_10]
                mov     r15d, eax
                test    r12d, r12d
                js      loc_14042E4CF

loc_140239D0C:                          ; CODE XREF: sub_140239520+1F4FB5↓j
                cmp     [rbp+var_40], ebx
                jnz     short loc_140239D21
                mov     r8, [rbp+arg_28]
                mov     rcx, r14
                mov     edx, [r14+8]
                call    sub_140317450

loc_140239D21:                          ; CODE XREF: sub_140239520+7EF↑j
                and     dword ptr [rdi+8], 0FFFFFDFFh
                jmp     loc_140239707
; ---------------------------------------------------------------------------

loc_140239D2D:                          ; CODE XREF: sub_140239520+473↑j
                add     r8, 0FFFFFFFFFFFFFFE0h
                mov     eax, edi
                shr     eax, 10h
                xorps   xmm0, xmm0
                mov     rcx, r8
                sub     rcx, rdi
                sar     rcx, 4
                xor     ax, cx
                sub     edx, ecx
                xor     ax, r9w
                mov     r9d, edx
                mov     [rdi+2], ax
                mov     rax, r8
                movups  xmmword ptr [r8], xmm0
                shl     r9, 4
                movups  xmmword ptr [r8+10h], xmm0
                mov     [r8+2], dx
                add     r9, r8
                mov     [r8+4], cx
                xor     rax, [r8]
                xor     rax, qword ptr cs:xmmword_140C1DC20
                mov     [r8], rax
                movzx   eax, word ptr [r13+20h]
                add     rax, 3
                shl     rax, 4
                add     rax, r13
                cmp     r9, rax
                jb      loc_140239FB7

loc_140239D96:                          ; CODE XREF: sub_140239520+AC6↓j
                mov     rdx, r13
                mov     rcx, r14
                call    sub_1403170A0
                jmp     loc_140239999
; ---------------------------------------------------------------------------

loc_140239DA6:                          ; CODE XREF: sub_140239520+423↑j
                test    r15, r15
                jz      loc_140239949
                mov     rdx, 3333333333333333h
                mov     rcx, 5555555555555555h
                mov     rax, r15
                shr     rax, 1
                and     rax, rcx
                mov     rcx, r15
                sub     rcx, rax
                mov     rax, rcx
                and     rcx, rdx
                shr     rax, 2
                and     rax, rdx
                add     rax, rcx
                mov     rdx, rax
                shr     rdx, 4
                add     rdx, rax
                mov     rax, 0F0F0F0F0F0F0F0Fh
                and     rdx, rax
                mov     rax, 101010101010101h
                imul    rdx, rax
                shr     rdx, 38h
                mov     [rbp+arg_8], rdx
                cmp     [r13+22h], bx
                jl      loc_140239949
                mov     eax, [r14+0B0h]
                test    al, 2
                jnz     short loc_140239E49
                mov     rcx, [r14+30h]
                mov     eax, 8
                shr     rcx, 7
                cmp     rcx, 8
                cmovbe  rcx, rax
                mov     eax, edx
                add     rax, [r14+38h]
                cmp     rax, rcx
                jbe     loc_140239949

loc_140239E49:                          ; CODE XREF: sub_140239520+903↑j
                shr     r10d, 0Ch
                mov     rax, rdi
                shr     rax, 20h
                xor     r10d, edi
                shr     eax, 10h
                mov     [rbp+arg_0], rbx
                mov     dword ptr [rbp+arg_0+4], 10000h
                mov     rcx, [rbp+arg_0]
                shr     rcx, 20h
                shr     ecx, 10h
                xor     cl, al
                mov     rax, qword ptr cs:xmmword_140C1DC20
                shr     rax, 20h
                shr     eax, 10h
                xor     cl, al
                mov     [rdi+6], cl
                xor     r10d, dword ptr cs:xmmword_140C1DC20
                movzx   eax, r10b
                bts     eax, 9
                mov     [rdi+8], eax
                mov     eax, [rbp+arg_20]
                and     eax, 1
                mov     [rbp+arg_18], eax
                jnz     short loc_140239EB3
                mov     rdx, [rbp+arg_28]
                mov     ecx, [r14+8]
                call    sub_1403175C0
                mov     rdx, [rbp+arg_8]

loc_140239EB3:                          ; CODE XREF: sub_140239520+980↑j
                mov     r9d, edx
                mov     dword ptr [rsp+78h+var_58], ebx
                mov     rdx, r13
                mov     r8, r15
                mov     rcx, r14
                call    sub_140317840
                cmp     [rbp+arg_18], ebx
                jnz     short loc_140239EDD
                mov     r8, [rbp+arg_28]
                mov     rcx, r14
                mov     edx, [r14+8]
                call    sub_140317450

loc_140239EDD:                          ; CODE XREF: sub_140239520+9AB↑j
                and     dword ptr [rdi+8], 0FFFFFDFFh
                mov     r10d, r12d
                jmp     loc_1402397CF
; ---------------------------------------------------------------------------

loc_140239EEC:                          ; CODE XREF: sub_140239520+410↑j
                lea     eax, [rdx-1]
                mov     ecx, 3Fh ; '?'
                shr     rax, 0Ch
                mov     r9d, edx
                sub     cl, al
                sub     r9d, r8d
                mov     rax, 0FFFFFFFFFFFFFFFFh
                shr     r8d, 0Ch
                mov     r15, rax
                shr     r15, cl
                movzx   ecx, r8b
                shl     rax, cl
                and     r15, rax
                and     r15, [r13+10h]
                jmp     loc_14023993C
; ---------------------------------------------------------------------------

loc_140239F24:                          ; CODE XREF: sub_140239520+370↑j
                mov     rdx, r13
                mov     rcx, r14
                call    sub_14033E828
                movzx   ecx, word ptr [r13+20h]
                lea     r9, [r13+30h]
                mov     r10d, [rbp+arg_18]
                shr     r15d, 10h
                add     r12d, r15d
                jmp     loc_140239896
; ---------------------------------------------------------------------------

loc_140239F48:                          ; CODE XREF: sub_140239520+3C0↑j
                mov     eax, edi
                mov     r8d, r12d
                shr     eax, 10h
                xor     ax, r12w
                shl     r8, 4
                xor     ax, word ptr cs:xmmword_140C1DC20+2
                add     r8, rdi
                mov     [rdi+2], ax
                movzx   edx, word ptr [r13+20h]
                mov     eax, edx
                shl     rax, 4
                add     rax, r9
                cmp     r8, rax
                jnb     loc_1402398E6
                movzx   eax, r12w
                mov     [rbp+arg_0], rbx
                mov     dword ptr [rbp+arg_0+4], eax
                mov     rax, r8
                mov     rcx, [rbp+arg_0]
                shr     rax, 20h
                shr     rcx, 20h
                xor     cx, ax
                mov     rax, qword ptr cs:xmmword_140C1DC20
                shr     rax, 20h
                xor     cx, ax
                mov     [r8+4], cx
                movzx   edx, word ptr [r13+20h]
                jmp     loc_1402398E6
; ---------------------------------------------------------------------------

loc_140239FB7:                          ; CODE XREF: sub_140239520+870↑j
                movzx   eax, dx
                mov     [rbp+arg_0], rbx
                mov     dword ptr [rbp+arg_0+4], eax
                mov     rax, r9
                mov     rcx, [rbp+arg_0]
                shr     rax, 20h
                shr     rcx, 20h
                xor     cx, ax
                mov     rax, qword ptr cs:xmmword_140C1DC20
                shr     rax, 20h
                xor     cx, ax
                mov     [r9+4], cx
                jmp     loc_140239D96
; ---------------------------------------------------------------------------

loc_140239FEB:                          ; CODE XREF: sub_140239520+794↑j
                mov     rax, 0FFFFFFFFFFFFFFFFh
                lock xadd [r15], rax
                and     al, 6
                cmp     al, 2
                jz      loc_14023A23A

loc_14023A001:                          ; CODE XREF: sub_140239520+D22↓j
                mov     dword ptr [rbp+arg_8], ebx
                mov     rcx, r15
                mov     rax, gs:188h
                mov     [rbp+var_38], rax
                call    sub_140245330
                cmp     eax, 1
                jz      loc_14023A1C3
                mov     r11d, 0FFFFFFFFh

loc_14023A028:                          ; CODE XREF: sub_140239520+CB6↓j
                mov     r10, [rbp+var_38]
                dec     word ptr [r10+1E6h]
                inc     byte ptr [r10+31Ah]
                movsx   ecx, byte ptr [r10+318h]
                mov     r8, r15
                movzx   eax, byte ptr [r10+31Ah]
                movsx   edx, byte ptr [r10+366h]
                or      edx, ecx
                mov     byte ptr [rbp+arg_18], al
                mov     rax, 7FFFFFFFFFFFFFFCh
                xor     edx, 3Fh
                and     r8, rax
                mov     [rbp+var_30], rax
                bsr     ecx, edx
                mov     dword ptr [rbp+arg_0], ecx
                jz      loc_14023A227
                mov     r9d, 1

loc_14023A081:                          ; CODE XREF: sub_140239520+D01↓j
                mov     eax, r9d
                shl     eax, cl
                lea     rcx, [rcx+rcx*2]
                shl     rcx, 5
                not     eax
                add     rcx, [r10+320h]
                and     edx, eax
                mov     [rbp+var_28], rcx
                test    [rcx+1Ah], r9b
                jz      loc_14023A21B
                mov     eax, [rcx+20h]
                test    r9b, al
                jnz     loc_14023A21B
                mov     rax, [rcx+20h]
                and     rax, [rbp+var_30]
                cmp     rax, r8
                jnz     loc_14023A21B
                cmp     [rcx+28h], r11d
                jnz     loc_14023A21B
                and     byte ptr [rcx+1Ah], 0FEh
                mov     rax, [rcx+20h]
                test    rax, rax
                jz      loc_14023A21B
                test    rcx, rcx
                jz      loc_14023A227
                movzx   eax, byte ptr [rcx+20h]
                or      al, 2
                mov     [rcx+20h], al
                mov     rax, [rcx+20h]
                shr     rax, 3Fh
                test    al, al
                jnz     loc_14023A247

loc_14023A101:                          ; CODE XREF: sub_140239520+D3A↓j
                mov     eax, [rcx+58h]
                and     eax, 1FFFFh
                mov     dword ptr [rbp+arg_8], eax
                and     dword ptr [rcx+58h], 0FFFE0000h
                and     byte ptr [rcx+19h], 0FEh
                mov     [rcx+20h], rbx
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rcx, [r10+320h]
                imul    rcx
                sar     rdx, 4
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                cmp     byte ptr [rbp+arg_18], 1
                jnz     loc_14042E3FC
                movzx   eax, byte ptr [r10+318h]
                bts     eax, edx
                mov     [r10+318h], al

loc_14023A159:                          ; CODE XREF: sub_140239520+D0F↓j
                                        ; sub_140239520+1F4EE9↓j
                dec     byte ptr [r10+31Ah]
                lea     r8, [rbp+arg_8]
                mov     rdx, r15
                mov     rcx, r10
                call    sub_1402456E0
                mov     rcx, [rbp+var_38]
                add     word ptr [rcx+1E6h], 1
                jnz     short loc_14023A18D
                lea     rax, [rcx+98h]
                cmp     [rax], rax
                jnz     loc_14023A26F

loc_14023A18D:                          ; CODE XREF: sub_140239520+C5B↑j
                                        ; sub_140239520+D54↓j
                mov     rcx, gs:188h
                call    sub_140245770
                jmp     loc_140239CFD
; ---------------------------------------------------------------------------

loc_14023A1A0:                          ; CODE XREF: sub_140239520+706↑j
                mov     rax, gs:188h
                mov     [rbp+var_10], rbx
                dec     word ptr [rax+1E6h]
                xor     edx, edx
                mov     rcx, r15
                call    ExAcquirePushLockExclusiveEx
                jmp     loc_140239C6D
; ---------------------------------------------------------------------------

loc_14023A1C3:                          ; CODE XREF: sub_140239520+AFC↑j
                mov     rcx, [rbp+var_38]
                mov     rcx, [rcx+0B8h]
                call    sub_140245840
                mov     r11d, eax
                jmp     loc_14023A028
; ---------------------------------------------------------------------------

loc_14023A1DB:                          ; CODE XREF: sub_140239520+101↑j
                add     esi, ecx
                sub     r15d, ecx
                jmp     loc_140239632
; ---------------------------------------------------------------------------

loc_14023A1E5:                          ; CODE XREF: sub_140239520+4D4↑j
                mov     edx, eax
                mov     ecx, 3Fh ; '?'
                sub     edx, r8d
                shr     r8d, 0Ch
                dec     eax
                shr     rax, 0Ch
                sub     cl, al
                mov     rax, 0FFFFFFFFFFFFFFFFh
                mov     r9, rax
                shr     r9, cl
                movzx   ecx, r8b
                shl     rax, cl
                and     r9, rax
                and     r9, [r13+10h]
                jmp     loc_1402399FF
; ---------------------------------------------------------------------------

loc_14023A21B:                          ; CODE XREF: sub_140239520+B81↑j
                                        ; sub_140239520+B8D↑j ...
                bsr     ecx, edx
                mov     dword ptr [rbp+arg_0], ecx
                jnz     loc_14023A081

loc_14023A227:                          ; CODE XREF: sub_140239520+B55↑j
                                        ; sub_140239520+BC2↑j
                mov     eax, [r10+78h]
                bt      eax, 10h
                jb      loc_14023A159
                jmp     loc_14042E40E
; ---------------------------------------------------------------------------

loc_14023A23A:                          ; CODE XREF: sub_140239520+ADB↑j
                mov     rcx, r15
                call    ExfTryToWakePushLock
                jmp     loc_14023A001
; ---------------------------------------------------------------------------

loc_14023A247:                          ; CODE XREF: sub_140239520+BDB↑j
                call    sub_14031EC80
                mov     rcx, [rbp+var_28]
                mov     r9d, 1
                mov     r10, [rbp+var_38]
                jmp     loc_14023A101
; ---------------------------------------------------------------------------

loc_14023A25F:                          ; CODE XREF: sub_140239520+3CC↑j
                mov     rdx, r13
                mov     rcx, r14
                call    sub_140318520
                jmp     loc_140239AF9
; ---------------------------------------------------------------------------

loc_14023A26F:                          ; CODE XREF: sub_140239520+C67↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_14023A18D
sub_140239520   endp

; ---------------------------------------------------------------------------
algn_14023A279:                         ; DATA XREF: .rdata:0000000140054EDC↑o
                                        ; .pdata:00000001400CB7A8↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_14023A280   proc near               ; CODE XREF: sub_14023C050+4CF↓p
                                        ; sub_1402A0544+65↓p ...

var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
var_38          = xmmword ptr -38h
var_28          = qword ptr -28h
var_18          = qword ptr -18h
var_10          = qword ptr -10h
var_8           = qword ptr -8
arg_0           = dword ptr  30h
arg_8           = dword ptr  38h
arg_10          = qword ptr  40h
arg_18          = dword ptr  48h
arg_20          = qword ptr  50h

; FUNCTION CHUNK AT 000000014042E54A SIZE 000001A1 BYTES

                mov     [rsp-28h+arg_18], r9d
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r15
                mov     rbp, rsp
                sub     rsp, 70h
                mov     r10, r8
                mov     edi, r9d
                mov     r8, rdx
                mov     rsi, rcx
                mov     edx, [rcx+0B0h]
                lea     rbx, [r10-10h]
                test    dl, 1
                jz      short loc_14023A2BA
                test    r10, 0FFFh
                jnz     short loc_14023A2BA
                add     rbx, 0FFFFFFFFFFFFFFF0h

loc_14023A2BA:                          ; CODE XREF: sub_14023A280+2B↑j
                                        ; sub_14023A280+34↑j
                test    r8, r8
                jz      loc_14023A78F

loc_14023A2C3:                          ; CODE XREF: sub_14023A280+55C↓j
                movzx   ecx, word ptr [r8+22h]
                mov     r15d, 2BEDh
                xor     cx, [r8+20h]
                mov     eax, 7FFFh
                xor     cx, r15w
                test    ax, cx
                jnz     loc_14042E5CD
                mov     rax, [rbx]
                xor     rax, qword ptr cs:xmmword_140C1DC20
                xor     rax, rbx
                shr     rax, 20h
                test    eax, 0FF0000h
                jz      loc_14042E5FC
                movzx   ecx, word ptr [rbx+2]
                mov     eax, ebx
                shr     eax, 10h
                xor     ecx, eax
                movzx   eax, word ptr cs:xmmword_140C1DC20+2
                xor     ecx, eax
                mov     rax, [rbp+arg_20]
                shl     ecx, 4
                add     ecx, 0FFFFFFF0h
                mov     [rax], ecx
                xor     eax, eax
                test    dl, 4
                jz      short loc_14023A334
                cmp     ecx, 1000h
                jb      loc_14023A6A4

loc_14023A334:                          ; CODE XREF: sub_14023A280+A6↑j
                                        ; sub_14023A280+50A↓j
                                        ; DATA XREF: ...
                mov     [rsp+70h+var_8], r12
                xorps   xmm0, xmm0
                mov     [rsp+70h+var_10], r13
                mov     r12d, edi
                lea     r13, [rbx+10h]
                mov     [r13+0], rax
                xor     eax, eax
                and     r12d, 1
                mov     [rbp+var_28], rax
                mov     [rbp+arg_0], r12d
                movups  [rbp+var_38], xmm0
                jnz     short loc_14023A36F
                mov     edx, [rsi+8]
                lea     r8, [rbp+var_38]
                mov     rcx, rsi
                call    sub_140317450

loc_14023A36F:                          ; CODE XREF: sub_14023A280+DE↑j
                test    r13, r13
                jz      loc_14023A66B

loc_14023A378:                          ; DATA XREF: .rdata:0000000140054F18↑o
                                        ; .rdata:0000000140054F28↑o ...
                mov     [rsp+70h+var_18], r14

loc_14023A37D:                          ; CODE XREF: sub_14023A280+3E0↓j
                mov     rcx, [r13-10h]
                lea     r14, [r13-10h]
                mov     r8, qword ptr cs:xmmword_140C1DC20
                lea     rax, [r13+0]
                mov     r13, [r13+0]
                xor     rcx, r14
                xor     rcx, r8
                mov     rbx, r14
                shr     rcx, 20h
                mov     edx, ecx
                and     edx, 0FF0000h
                jz      loc_14042E62F
                mov     eax, [rax-8]
                xor     eax, r14d
                xor     eax, r8d
                movzx   ecx, al

loc_14023A3BB:                          ; CODE XREF: sub_14023A280+1F43DE↓j
                                        ; sub_14023A280+1F43FD↓j ...
                shl     ecx, 0Ch
                mov     eax, ecx
                sub     rbx, rax
                mov     eax, 7FFFh
                and     rbx, 0FFFFFFFFFFFFF000h
                movzx   ecx, word ptr [rbx+22h]
                xor     cx, [rbx+20h]
                xor     cx, r15w
                test    ax, cx
                jnz     loc_14042E689
                test    edx, edx
                jz      loc_14042E6BA
                mov     [rbp+arg_8], 0
                xor     r15d, r15d

loc_14023A3F6:                          ; CODE XREF: sub_14023A280+4F6↓j
                lea     r9, [rbp+arg_8]
                mov     r8, r14
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_14023A910
                mov     edi, [rbp+arg_8]
                mov     r14, rax
                movzx   eax, word ptr [rbx+20h]
                cmp     edi, eax
                jz      loc_14023A7E1
                cmp     edi, r15d
                jbe     loc_14023A4F3
                lea     r9, [rbp+var_40]
                mov     dword ptr [rbp+arg_10], 0
                lea     r8, [rbp+arg_10]
                mov     [rbp+var_40], 0
                mov     rdx, rbx
                mov     rcx, r14
                call    sub_14023A830
                cmp     dword ptr [rbp+arg_10], 0
                jz      loc_14023A4F3
                mov     r12, [rbp+var_40]
                test    r12, r12
                jz      loc_14023A4EF
                mov     rcx, 5555555555555555h
                mov     rdx, 3333333333333333h
                mov     rax, r12
                shr     rax, 1
                and     rax, rcx
                mov     rcx, r12
                sub     rcx, rax
                mov     rax, rcx
                and     rcx, rdx
                shr     rax, 2
                and     rax, rdx
                add     rax, rcx
                mov     r15, rax
                shr     r15, 4
                add     r15, rax
                mov     rax, 0F0F0F0F0F0F0F0Fh
                and     r15, rax
                mov     rax, 101010101010101h
                imul    r15, rax
                shr     r15, 38h
                cmp     word ptr [rbx+22h], 0
                jl      short loc_14023A4EF
                mov     eax, [rsi+0B0h]
                test    al, 2
                jnz     loc_14023A6D2
                mov     rcx, [rsi+30h]
                shr     rcx, 7
                cmp     rcx, 8
                jbe     loc_14023A77B

loc_14023A4DF:                          ; CODE XREF: sub_14023A280+500↓j
                mov     eax, r15d
                add     rax, [rsi+38h]
                cmp     rax, rcx
                ja      loc_14023A6D2

loc_14023A4EF:                          ; CODE XREF: sub_14023A280+1D6↑j
                                        ; sub_14023A280+23D↑j
                mov     r12d, [rbp+arg_0]

loc_14023A4F3:                          ; CODE XREF: sub_14023A280+19D↑j
                                        ; sub_14023A280+1C9↑j
                mov     eax, [rsi+0B0h]
                test    al, 1
                jz      short loc_14023A527
                lea     rax, [r14+20h]
                test    rax, 0FFFh
                jz      short loc_14023A527
                mov     r8, r14
                mov     rdx, rbx
                call    sub_1402367D0
                test    rax, rax
                jz      short loc_14023A527
                mov     r8, rax
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_1403170A0

loc_14023A527:                          ; CODE XREF: sub_14023A280+27B↑j
                                        ; sub_14023A280+287↑j ...
                lea     r9, [rbp+arg_10]
                mov     [rbp+arg_8], 0
                lea     r8, [rbp+arg_8]
                mov     [rbp+arg_10], 0
                mov     rdx, rbx
                mov     rcx, r14
                call    sub_14023A830
                mov     rdx, [rbp+arg_10]
                lea     r11, [rsi+10h]
                mov     rcx, rdx
                mov     r8d, eax
                shr     rcx, 1
                mov     rax, 5555555555555555h
                and     rcx, rax
                mov     rdi, 3333333333333333h
                sub     rdx, rcx
                mov     rax, 0F0F0F0F0F0F0F0Fh
                mov     rcx, rdx
                and     rdx, rdi
                shr     rcx, 2
                and     rcx, rdi
                add     rcx, rdx
                mov     rdx, rcx
                shr     rdx, 4
                add     rdx, rcx
                and     rdx, rax
                mov     rax, 101010101010101h
                imul    rdx, rax
                shr     rdx, 38h
                sub     r8w, dx
                mov     eax, edx
                add     [rsi+38h], rax
                add     r8w, word ptr [rbp+arg_8]
                xor     r8w, r14w
                xor     r8w, word ptr cs:xmmword_140C1DC20
                mov     [r14], r8w
                mov     r8d, [r14]
                mov     r9, qword ptr cs:xmmword_140C1DC20
                xor     r8d, r14d
                mov     rax, [r11+8]
                xor     r8d, r9d
                mov     rdx, [r11]
                test    al, 1
                jnz     loc_14023A697

loc_14023A5EB:                          ; CODE XREF: sub_14023A280+41F↓j
                                        ; sub_14023A280:loc_14023A6CD↓j
                movzx   r10d, al
                xor     al, al
                and     r10d, 1
                test    rdx, rdx
                jz      short loc_14023A647
                nop     word ptr [rax+rax+00h]

loc_14023A600:                          ; CODE XREF: sub_14023A280+3AA↓j
                mov     ecx, [rdx-8]
                lea     rax, [rdx-8]
                xor     ecx, eax
                xor     ecx, r9d
                cmp     r8d, ecx
                jb      short loc_14023A62C
                mov     rax, [rdx+8]
                test    r10d, r10d
                jz      short loc_14023A622
                test    rax, rax
                jz      short loc_14023A645
                xor     rax, rdx

loc_14023A622:                          ; CODE XREF: sub_14023A280+398↑j
                test    rax, rax
                jz      short loc_14023A645

loc_14023A627:                          ; CODE XREF: sub_14023A280+3BF↓j
                mov     rdx, rax
                jmp     short loc_14023A600
; ---------------------------------------------------------------------------

loc_14023A62C:                          ; CODE XREF: sub_14023A280+38F↑j
                mov     rax, [rdx]
                test    r10d, r10d
                jz      short loc_14023A63C
                test    rax, rax
                jz      short loc_14023A641
                xor     rax, rdx

loc_14023A63C:                          ; CODE XREF: sub_14023A280+3B2↑j
                test    rax, rax
                jnz     short loc_14023A627

loc_14023A641:                          ; CODE XREF: sub_14023A280+3B7↑j
                xor     al, al
                jmp     short loc_14023A647
; ---------------------------------------------------------------------------

loc_14023A645:                          ; CODE XREF: sub_14023A280+39D↑j
                                        ; sub_14023A280+3A5↑j
                mov     al, 1

loc_14023A647:                          ; CODE XREF: sub_14023A280+378↑j
                                        ; sub_14023A280+3C3↑j
                lea     r9, [r14+8]
                movzx   r8d, al
                mov     rcx, r11
                call    RtlRbInsertNodeEx

loc_14023A657:                          ; CODE XREF: sub_14023A280+58F↓j
                                        ; sub_14023A280+5A4↓j
                mov     r15d, 2BEDh

loc_14023A65D:                          ; CODE XREF: sub_14023A280+1F4435↓j
                                        ; sub_14023A280+1F4466↓j
                test    r13, r13
                jnz     loc_14023A37D
                mov     r14, [rsp+70h+var_18]

loc_14023A66B:                          ; CODE XREF: sub_14023A280+F2↑j
                                        ; DATA XREF: .pdata:00000001400CB7CC↑o ...
                mov     r13, [rsp+70h+var_10]
                test    r12d, r12d
                mov     r12, [rsp+70h+var_8]
                jnz     short loc_14023A686

loc_14023A67A:                          ; DATA XREF: .pdata:00000001400CB7D8↑o
                                        ; .pdata:00000001400CB7E4↑o
                mov     ecx, [rsi+8]
                lea     rdx, [rbp+var_38]
                call    sub_1403175C0

loc_14023A686:                          ; CODE XREF: sub_14023A280+3F8↑j
                mov     eax, 1

loc_14023A68B:                          ; CODE XREF: sub_14023A280+1F4377↓j
                                        ; sub_14023A280+1F43AA↓j
                add     rsp, 70h
                pop     r15
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14023A697:                          ; CODE XREF: sub_14023A280+365↑j
                                        ; DATA XREF: .pdata:00000001400CB7E4↑o ...
                test    rdx, rdx
                jz      short loc_14023A6CD
                xor     rdx, r11
                jmp     loc_14023A5EB
; ---------------------------------------------------------------------------

loc_14023A6A4:                          ; CODE XREF: sub_14023A280+AE↑j
                                        ; DATA XREF: .pdata:00000001400CB7F0↑o ...
                cmp     word ptr [rsi+40h], 20h ; ' '
                lea     rcx, [rsi+40h]
                jnb     loc_14023A785
                lea     rdx, [rbx+10h]
                call    ExpInterlockedPushEntrySList
                mov     eax, 1
                add     rsp, 70h
                pop     r15
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14023A6CD:                          ; CODE XREF: sub_14023A280+41A↑j
                                        ; DATA XREF: .pdata:00000001400CB7FC↑o ...
                jmp     loc_14023A5EB
; ---------------------------------------------------------------------------

loc_14023A6D2:                          ; CODE XREF: sub_14023A280+247↑j
                                        ; sub_14023A280+269↑j
                mov     [rbp+arg_10], 0
                mov     rax, r14
                shr     rax, 20h
                shr     eax, 10h
                mov     dword ptr [rbp+arg_10+4], 10000h
                mov     rcx, [rbp+arg_10]
                shr     rcx, 20h
                shr     ecx, 10h
                xor     cl, al
                mov     rax, qword ptr cs:xmmword_140C1DC20
                shr     rax, 20h
                shr     eax, 10h
                xor     cl, al
                mov     eax, r14d
                sub     eax, ebx
                mov     [r14+6], cl
                shr     eax, 0Ch
                xor     eax, r14d
                xor     eax, dword ptr cs:xmmword_140C1DC20
                movzx   eax, al
                bts     eax, 9
                cmp     [rbp+arg_0], 0
                mov     [r14+8], eax
                jnz     short loc_14023A73A
                mov     ecx, [rsi+8]
                lea     rdx, [rbp+var_38]
                call    sub_1403175C0

loc_14023A73A:                          ; CODE XREF: sub_14023A280+4AC↑j
                mov     r9d, r15d
                mov     dword ptr [rsp+70h+var_50], 0
                mov     r8, r12
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_140317840
                mov     r12d, [rbp+arg_0]
                test    r12d, r12d
                jnz     short loc_14023A76B
                mov     edx, [rsi+8]
                lea     r8, [rbp+var_38]
                mov     rcx, rsi
                call    sub_140317450

loc_14023A76B:                          ; CODE XREF: sub_14023A280+4DA↑j
                and     dword ptr [r14+8], 0FFFFFDFFh
                mov     r15d, edi
                jmp     loc_14023A3F6
; ---------------------------------------------------------------------------

loc_14023A77B:                          ; CODE XREF: sub_14023A280+259↑j
                mov     ecx, 8
                jmp     loc_14023A4DF
; ---------------------------------------------------------------------------

loc_14023A785:                          ; CODE XREF: sub_14023A280+42D↑j
                                        ; DATA XREF: .pdata:00000001400CB808↑o ...
                call    ExpInterlockedFlushSList
                jmp     loc_14023A334
; ---------------------------------------------------------------------------

loc_14023A78F:                          ; CODE XREF: sub_14023A280+3D↑j
                mov     r8, [rbx]
                mov     rax, rbx
                mov     r11, qword ptr cs:xmmword_140C1DC20
                mov     rcx, r8
                shr     rcx, 20h
                mov     r9, r11
                shr     rax, 20h
                xor     ecx, eax
                shr     r9, 20h
                xor     ecx, r9d
                test    ecx, 0FF0000h
                jz      loc_14042E54A
                mov     eax, [rbx+8]
                xor     eax, ebx
                xor     eax, r11d
                movzx   ecx, al

loc_14023A7CA:                          ; CODE XREF: sub_14023A280+1F4348↓j
                mov     r8, rbx

loc_14023A7CD:                          ; CODE XREF: sub_14023A280+1F4341↓j
                shl     ecx, 0Ch
                mov     eax, ecx
                sub     r8, rax
                and     r8, 0FFFFFFFFFFFFF000h
                jmp     loc_14023A2C3
; ---------------------------------------------------------------------------

loc_14023A7E1:                          ; CODE XREF: sub_14023A280+194↑j
                                        ; DATA XREF: .pdata:00000001400CB814↑o ...
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_140318520
                test    r12d, r12d
                jnz     short loc_14023A7FD
                mov     ecx, [rsi+8]
                lea     rdx, [rbp+var_38]
                call    sub_1403175C0

loc_14023A7FD:                          ; CODE XREF: sub_14023A280+56F↑j
                mov     r8d, [rbp+arg_18]
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_1403185CC
                test    r12d, r12d
                jnz     loc_14023A657
                mov     edx, [rsi+8]
                lea     r8, [rbp+var_38]
                mov     rcx, rsi
                call    sub_140317450
                jmp     loc_14023A657
sub_14023A280   endp

; ---------------------------------------------------------------------------
algn_14023A829:                         ; DATA XREF: .pdata:00000001400CB820↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14023A830   proc near               ; CODE XREF: sub_14023A280+1C0↑p
                                        ; sub_14023A280+2C4↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                mov     [rsp+arg_10], rdi
                movzx   r10d, word ptr [rcx+2]
                mov     rbx, r9
                movzx   eax, word ptr cs:xmmword_140C1DC20+2
                mov     rsi, rdx
                mov     r11d, ecx
                mov     rdi, r8
                shr     ecx, 10h
                mov     r9d, r11d
                xor     r10d, ecx
                and     r9d, 0FFFh
                xor     r10d, eax
                add     r9, 0FFFh
                shl     r10d, 4
                mov     edx, r10d
                add     r9, rdx
                sub     edx, esi
                shr     r9, 0Ch
                add     edx, r11d
                lea     rax, [r10+0FFFh]
                and     edx, 0FFFFF000h
                shr     rax, 0Ch
                mov     r10d, r11d
                sub     r10d, esi
                sub     r9d, eax
                add     r10d, 101Fh
                and     r10d, 0FFFFF000h
                cmp     r10d, edx
                jb      short loc_14023A8D2
                xor     eax, eax
                mov     r8d, eax

loc_14023A8B6:                          ; CODE XREF: sub_14023A830+D3↓j
                mov     rsi, [rsp+arg_8]
                shr     eax, 0Ch
                mov     [rdi], eax
                mov     eax, r9d
                mov     rdi, [rsp+arg_10]
                mov     [rbx], r8
                mov     rbx, [rsp+arg_0]
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14023A8D2:                          ; CODE XREF: sub_14023A830+7F↑j
                mov     eax, edx
                mov     ecx, 3Fh ; '?'
                sub     eax, r10d
                shr     r10d, 0Ch
                dec     edx
                shr     rdx, 0Ch
                sub     cl, dl
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                mov     r8, rdx
                shr     r8, cl
                movzx   ecx, r10b
                shl     rdx, cl
                and     r8, rdx
                and     r8, [rsi+10h]
                jmp     short loc_14023A8B6
sub_14023A830   endp

; ---------------------------------------------------------------------------
algn_14023A905:                         ; DATA XREF: .pdata:00000001400CB82C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14023A910   proc near               ; CODE XREF: sub_14023A280+183↑p
                                        ; sub_140316F9C+3F↓p
                                        ; DATA XREF: ...

var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_18          = qword ptr  20h

                mov     [rsp+arg_18], r9
                mov     [rsp+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                sub     rsp, 30h
                mov     rsi, r8

loc_14023A928:                          ; DATA XREF: .rdata:000000014005501C↑o
                                        ; .rdata:0000000140055030↑o ...
                mov     [rsp+58h+arg_8], rbx
                mov     rbx, [r8]
                xor     edi, edi
                mov     r8, qword ptr cs:xmmword_140C1DC20
                mov     r13, rdx
                xor     rbx, r8
                mov     [rsp+58h+var_30], r14
                shr     r8, 20h
                xor     rbx, rsi
                shr     r8d, 10h
                mov     rax, rbx
                shr     rax, 20h
                mov     ebp, ebx
                movzx   edx, ax
                mov     eax, edi
                shr     rax, 20h
                shr     eax, 10h
                xor     r8b, al
                shr     ebp, 10h
                mov     rax, rsi

loc_14023A96D:                          ; DATA XREF: .rdata:0000000140055030↑o
                                        ; .rdata:0000000140055040↑o ...
                mov     [rsp+58h+var_38], r15
                shr     rax, 20h
                shr     eax, 10h
                xor     r8b, al
                mov     [rsi+6], r8b
                test    edx, edx
                jz      loc_14023AA44
                mov     eax, edx
                mov     r15, rsi
                shl     rax, 4
                sub     r15, rax
                mov     r14, [r15]
                xor     r14, r15
                xor     r14, qword ptr cs:xmmword_140C1DC20
                mov     rax, r14
                shr     rax, 20h
                test    eax, 0FF0000h
                jnz     loc_14023AA44
                lea     rdx, [r15+8]
                add     rcx, 10h
                call    RtlRbRemoveNode
                mov     r10d, [r15]
                mov     ecx, r15d
                sub     ecx, r13d
                xor     r10d, r15d
                xor     r10d, dword ptr cs:xmmword_140C1DC20
                add     ecx, 101Fh
                and     ecx, 0FFFFF000h
                mov     eax, r10d
                shr     eax, 10h
                mov     r9d, r15d
                shl     eax, 4
                mov     rsi, r15
                mov     r8d, eax
                sub     eax, r13d
                add     eax, r15d
                and     eax, 0FFFFF000h
                mov     edx, eax
                sub     edx, ecx
                cmp     ecx, eax
                mov     rcx, [rsp+58h+arg_0]
                lea     rax, [r8+0FFFh]
                cmovnb  edx, edi
                and     r9d, 0FFFh
                add     rax, r9
                shr     edx, 0Ch
                shr     rax, 0Ch
                add     edx, eax
                shr     r14d, 10h
                lea     rax, [r8+0FFFh]
                shr     rax, 0Ch
                sub     edx, eax
                movzx   eax, r10w
                sub     edx, eax
                mov     eax, edx
                sub     [rcx+38h], rax
                add     ebp, r14d

loc_14023AA44:                          ; CODE XREF: sub_14023A910+72↑j
                                        ; sub_14023A910+9D↑j
                movzx   eax, word ptr [r13+20h]
                lea     r12, [r13+30h]
                shl     rax, 4
                mov     r15d, ebp
                add     rax, r12
                shl     r15, 4
                add     r15, rsi
                cmp     r15, rax
                jnb     loc_14023AB11
                mov     r14, r15
                xor     r14, [r15]
                xor     r14, qword ptr cs:xmmword_140C1DC20
                mov     rax, r14
                shr     rax, 20h
                test    eax, 0FF0000h
                jnz     loc_14023AB11
                lea     rdx, [r15+8]
                add     rcx, 10h
                call    RtlRbRemoveNode
                mov     r9d, r15d
                xor     r15d, [r15]
                xor     r15d, dword ptr cs:xmmword_140C1DC20
                mov     ecx, r9d
                sub     ecx, r13d
                mov     eax, r15d
                shr     eax, 10h
                add     ecx, 101Fh
                shl     eax, 4
                and     ecx, 0FFFFF000h
                mov     r8d, eax
                sub     eax, r13d
                add     eax, r9d
                and     eax, 0FFFFF000h
                mov     edx, eax
                sub     edx, ecx
                cmp     ecx, eax
                mov     rcx, [rsp+58h+arg_0]
                lea     rax, [r8+0FFFh]
                cmovnb  edx, edi
                and     r9d, 0FFFh
                add     rax, r9
                shr     edx, 0Ch
                shr     rax, 0Ch
                add     edx, eax
                shr     r14d, 10h
                lea     rax, [r8+0FFFh]
                shr     rax, 0Ch
                sub     edx, eax
                movzx   eax, r15w
                sub     edx, eax
                mov     eax, edx
                sub     [rcx+38h], rax
                add     ebp, r14d

loc_14023AB11:                          ; CODE XREF: sub_14023A910+151↑j
                                        ; sub_14023A910+170↑j
                mov     eax, [rcx+0B0h]
                mov     r15, [rsp+58h+var_38]
                test    al, 1
                jz      short loc_14023AB5A

loc_14023AB20:                          ; DATA XREF: .pdata:00000001400CB850↑o
                                        ; .pdata:00000001400CB85C↑o
                movzx   eax, word ptr [r13+20h]
                shl     rax, 4
                mov     r8d, ebp
                add     rax, r12
                shl     r8, 4
                add     r8, rsi
                cmp     r8, rax
                jnb     short loc_14023AB5A
                mov     r14, r8
                xor     r14, [r8]
                xor     r14, qword ptr cs:xmmword_140C1DC20
                mov     rax, r14
                shr     rax, 20h
                test    eax, 0FF0000h
                jz      loc_14023ABE0

loc_14023AB5A:                          ; CODE XREF: sub_14023A910+20E↑j
                                        ; sub_14023A910+229↑j ...
                mov     r14, [rsp+58h+var_30]
                shr     ebx, 10h
                cmp     ebx, ebp
                mov     rbx, [rsp+58h+arg_8]
                jz      short loc_14023ABC9

loc_14023AB6B:                          ; DATA XREF: .pdata:00000001400CB85C↑o
                                        ; .pdata:00000001400CB868↑o
                mov     eax, esi
                mov     edx, ebp
                shr     eax, 10h
                xor     ax, bp
                shl     rdx, 4
                xor     ax, word ptr cs:xmmword_140C1DC20+2
                add     rdx, rsi
                mov     [rsi+2], ax
                movzx   eax, word ptr [r13+20h]
                shl     rax, 4
                add     rax, r12
                cmp     rdx, rax
                jnb     short loc_14023ABC9
                movzx   eax, bp
                mov     rcx, rdx
                mov     [rsp+58h+arg_0], rdi
                mov     dword ptr [rsp+58h+arg_0+4], eax
                mov     rax, [rsp+58h+arg_0]
                shr     rax, 20h
                shr     rcx, 20h
                xor     cx, ax
                mov     rax, qword ptr cs:xmmword_140C1DC20
                shr     rax, 20h
                xor     cx, ax
                mov     [rdx+4], cx

loc_14023ABC9:                          ; CODE XREF: sub_14023A910+259↑j
                                        ; sub_14023A910+286↑j
                mov     rax, [rsp+58h+arg_18]
                mov     [rax], ebp
                mov     rax, rsi
                add     rsp, 30h
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 20h

loc_14023ABE0:                          ; CODE XREF: sub_14023A910+244↑j
                                        ; DATA XREF: .pdata:00000001400CB868↑o ...
                mov     rdx, r13
                call    sub_14033E828
                shr     r14d, 10h
                add     ebp, r14d
                jmp     loc_14023AB5A
sub_14023A910   endp

; ---------------------------------------------------------------------------
algn_14023ABF4:                         ; DATA XREF: .pdata:00000001400CB874↑o
                align 20h
; Exported entry 2355. RtlRbRemoveNode

; =============== S U B R O U T I N E =======================================


