RtlSetBitsEx    proc near               ; CODE XREF: RtlFindClearBitsAndSetEx+F6↓p
                                        ; sub_1402D6AAC+120↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                test    r8, r8
                jz      short locret_140269A7D
                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 20h
                mov     rsi, rdx
                lea     rbp, cs:140000000h
                and     edx, 7
                shr     rsi, 3
                add     rsi, [rcx+8]
                mov     rdi, r8
                lea     rax, [rdx+r8]
                cmp     rax, 8
                ja      short loc_140269A7F
                mov     al, [r8+rbp+1DAE0h]
                mov     ecx, edx
                shl     al, cl

loc_140269A67:                          ; CODE XREF: RtlSetBitsEx+A8↓j
                or      [rsi], al

loc_140269A69:                          ; CODE XREF: RtlSetBitsEx+9F↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                add     rsp, 20h
                pop     rdi

locret_140269A7D:                       ; CODE XREF: RtlSetBitsEx+3↑j
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140269A7F:                          ; CODE XREF: RtlSetBitsEx+39↑j
                test    edx, edx
                jz      short loc_140269A99
                mov     al, [rdx+rbp+1A870h]
                or      [rsi], al
                mov     eax, 8
                sub     eax, edx
                inc     rsi
                sub     rdi, rax

loc_140269A99:                          ; CODE XREF: RtlSetBitsEx+61↑j
                cmp     rdi, 8
                jbe     short loc_140269ABC
                mov     rbx, rdi
                mov     edx, 0FFh
                shr     rbx, 3
                mov     rcx, rsi
                mov     r8, rbx
                call    memset
                add     rsi, rbx
                and     edi, 7

loc_140269ABC:                          ; CODE XREF: RtlSetBitsEx+7D↑j
                test    rdi, rdi
                jz      short loc_140269A69
                mov     al, [rdi+rbp+1DAE0h]
                jmp     short loc_140269A67
RtlSetBitsEx    endp

; ---------------------------------------------------------------------------
algn_140269ACA:                         ; DATA XREF: .pdata:00000001400CDF38↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140269AD0   proc near               ; CODE XREF: sub_1402EBD64+175E23↓p
                                        ; sub_140659560+796↓p
                                        ; DATA XREF: ...
                mov     r8d, [rcx+34h]
                mov     eax, [rcx+2Ch]
                and     r8d, 3FFFFFFFh
                sub     eax, r8d
                mov     r8d, eax
                cmp     rdx, r8
                jnb     short loc_140269AF3

loc_140269AE9:                          ; CODE XREF: sub_140269AD0+26↓j
                mov     rax, [rcx+8]
                lea     rax, [rax+rdx*8]
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140269AF3:                          ; CODE XREF: sub_140269AD0+17↑j
                lea     edx, [rax-1]
                jmp     short loc_140269AE9
sub_140269AD0   endp

; ---------------------------------------------------------------------------
algn_140269AF8:                         ; DATA XREF: .pdata:00000001400CDF44↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140269B00   proc near               ; CODE XREF: sub_140267820+54↑p
                                        ; sub_140267820+98↑p ...

var_98          = byte ptr -98h
var_78          = word ptr -78h
var_74          = dword ptr -74h
var_8           = byte ptr -8
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014043F9CC SIZE 00000140 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r14
                sub     rsp, 0B0h
                mov     esi, r8d
                mov     rbx, rdx
                mov     rdi, rcx
                xor     edx, edx
                mov     r8d, 90h
                lea     rcx, [rsp+0B8h+var_98]
                call    memset
                mov     rax, 3FFFFFFFFFF000h
                cmp     rbx, rax
                jnb     loc_140269C3D
                cmp     esi, 1
                jnz     short loc_140269BC4
                mov     bpl, 11h

loc_140269B53:                          ; CODE XREF: sub_140269B00+D0↓j
                mov     rsi, [rdi+120h]
                shr     rbx, 0Ch
                movzx   edx, word ptr [rsi+20h]
                mov     eax, [rsi+24h]
                and     rdx, 0FFFFFFFFFFFFFFC0h
                mov     r8d, [rsi+28h]
                shl     rdx, 1Ah
                or      rdx, rax
                add     r8, rdx
                cmp     word ptr [rsi+22h], 10h
                lea     rcx, [r8-1]
                cmovb   r8, rcx
                mov     rcx, rbx
                shr     rcx, 20h
                cmp     rbx, rdx
                jb      short loc_140269BF3
                mov     rcx, rbx
                shr     rcx, 20h
                cmp     rbx, r8
                ja      short loc_140269BF3
                cmp     bpl, 11h
                jnz     short loc_140269BD2

loc_140269BA2:                          ; CODE XREF: sub_140269B00+F1↓j
                mov     rax, rsi

loc_140269BA5:                          ; CODE XREF: sub_140269B00+13F↓j
                                        ; sub_140269B00+1C3↓j
                lea     r11, [rsp+0B8h+var_8]
                mov     rbx, [r11+10h]
                mov     rbp, [r11+18h]
                mov     rsi, [r11+20h]
                mov     rdi, [r11+28h]
                mov     rsp, r11
                pop     r14
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140269BC4:                          ; CODE XREF: sub_140269B00+4E↑j
                lea     rcx, [rdi+48h]
                call    ExAcquireSpinLockShared
                movzx   ebp, al
                jmp     short loc_140269B53
; ---------------------------------------------------------------------------

loc_140269BD2:                          ; CODE XREF: sub_140269B00+A0↑j
                lea     rcx, [rdi+48h]
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14043F9CC

loc_140269BE9:                          ; CODE XREF: sub_140269B00+1D5ECE↓j
                                        ; sub_140269B00+1D5EDA↓j ...
                movzx   ecx, bpl
                mov     cr8, rcx
                jmp     short loc_140269BA2
; ---------------------------------------------------------------------------

loc_140269BF3:                          ; CODE XREF: sub_140269B00+8E↑j
                                        ; sub_140269B00+9A↑j
                movzx   eax, [rsp+0B8h+var_78]
                mov     r8, [rdi+110h]
                and     ax, 3Fh
                shl     cx, 6
                or      cx, ax
                mov     [rsp+0B8h+var_74], ebx
                mov     [rsp+0B8h+var_78], cx
                test    r8, r8
                jnz     short loc_140269C44

loc_140269C18:                          ; CODE XREF: sub_140269B00+1A1↓j
                                        ; sub_140269B00+1A9↓j
                cmp     bpl, 11h
                jz      short loc_140269C3D
                lea     rcx, [rdi+48h]
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14043FAA2

loc_140269C35:                          ; CODE XREF: sub_140269B00+1D5FA4↓j
                                        ; sub_140269B00+1D5FB0↓j ...
                movzx   eax, bpl
                mov     cr8, rax

loc_140269C3D:                          ; CODE XREF: sub_140269B00+45↑j
                                        ; sub_140269B00+11C↑j
                xor     eax, eax
                jmp     loc_140269BA5
; ---------------------------------------------------------------------------

loc_140269C44:                          ; CODE XREF: sub_140269B00+116↑j
                movzx   r10d, cx
                shl     r10, 1Ah
                xor     r10, rbx
                movzx   eax, cx
                mov     r10d, r10d
                shl     rax, 1Ah
                xor     r10, rax
                nop     dword ptr [rax+00h]

loc_140269C60:                          ; CODE XREF: sub_140269B00+19F↓j
                movzx   r9d, word ptr [r8-18h]
                mov     eax, [r8-14h]
                and     r9, 0FFFFFFFFFFFFFFC0h
                mov     edx, [r8-10h]
                shl     r9, 1Ah
                or      r9, rax
                add     rdx, r9
                cmp     word ptr [r8-16h], 10h
                lea     rcx, [rdx-1]
                cmovb   rdx, rcx
                cmp     r10, rdx
                ja      short loc_140269C98
                cmp     r10, r9
                jnb     short loc_140269CA6
                mov     r8, [r8]
                jmp     short loc_140269C9C
; ---------------------------------------------------------------------------

loc_140269C98:                          ; CODE XREF: sub_140269B00+18C↑j
                mov     r8, [r8+8]

loc_140269C9C:                          ; CODE XREF: sub_140269B00+196↑j
                test    r8, r8
                jnz     short loc_140269C60
                jmp     loc_140269C18
; ---------------------------------------------------------------------------

loc_140269CA6:                          ; CODE XREF: sub_140269B00+191↑j
                test    r8, r8
                jz      loc_140269C18
                lea     rbx, [r8-38h]
                mov     [rdi+120h], rbx
                cmp     bpl, 11h
                jnz     short loc_140269CC8

loc_140269CC0:                          ; CODE XREF: sub_140269B00+1E7↓j
                mov     rax, rbx
                jmp     loc_140269BA5
; ---------------------------------------------------------------------------

loc_140269CC8:                          ; CODE XREF: sub_140269B00+1BE↑j
                lea     rcx, [rdi+48h]
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14043FA37

loc_140269CDF:                          ; CODE XREF: sub_140269B00+1D5F39↓j
                                        ; sub_140269B00+1D5F45↓j ...
                movzx   ecx, bpl
                mov     cr8, rcx
                jmp     short loc_140269CC0
sub_140269B00   endp

; ---------------------------------------------------------------------------
algn_140269CE9:                         ; DATA XREF: .rdata:000000014005C588↑o
                                        ; .pdata:00000001400CDF50↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140269CF0   proc near               ; CODE XREF: sub_14026B9D8+1E↓p
                                        ; sub_14065A620+1F↓p ...
                mov     eax, [rcx+38h]
                test    al, 20h
                jnz     short loc_140269D26
                bt      eax, 0Ah
                jb      short loc_140269D2D
                cmp     rcx, cs:qword_140C4CAA8
                jz      short loc_140269D2D
                cmp     qword ptr [rcx+40h], 0
                jnz     short loc_140269D2D
                xor     edx, edx
                lea     rax, unk_140C4CA40

loc_140269D16:                          ; CODE XREF: sub_140269CF0+34↓j
                cmp     rcx, [rax]
                jz      short loc_140269D2D
                inc     edx
                add     rax, 40h ; '@'
                cmp     edx, 1
                jb      short loc_140269D16

loc_140269D26:                          ; CODE XREF: sub_140269CF0+5↑j
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140269D2D:                          ; CODE XREF: sub_140269CF0+B↑j
                                        ; sub_140269CF0+14↑j ...
                xor     eax, eax
                retn
sub_140269CF0   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_140269D31:                         ; DATA XREF: .pdata:00000001400CDF5C↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_140269D38   proc near               ; CODE XREF: sub_1402FAE8C+9D↓p
                                        ; sub_1402FB078+37C↓p ...
                cmp     qword ptr [rcx+40h], 0
                jnz     short loc_140269D52
                mov     rax, [rcx+78h]
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140269D52:                          ; CODE XREF: sub_140269D38+5↑j
                mov     rax, [rcx]
                mov     rax, [rax+10h]
                retn
sub_140269D38   endp

; ---------------------------------------------------------------------------
                db 0CCh
byte_140269D5B  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CDF68↑o

; =============== S U B R O U T I N E =======================================


sub_140269D64   proc near               ; CODE XREF: sub_1403658B4+275↓p
                                        ; sub_1403F6B04+57B↓p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014043FB0C SIZE 00000038 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 20h
                test    byte ptr [rdx+22h], 8
                mov     rdi, rcx
                jz      short loc_140269D99
                xor     eax, eax

loc_140269D83:                          ; CODE XREF: sub_140269D64+D0↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140269D99:                          ; CODE XREF: sub_140269D64+1B↑j
                mov     [rcx+18h], rdx
                lea     rbp, unk_140C4E3F0
                mov     rsi, gs:188h
                xor     ebx, ebx
                mov     [rcx+38h], rsi
                mov     al, [rdx+22h]
                mov     [rdx+10h], rdi
                or      al, 8
                mov     [rdx+22h], al
                cmp     [rdi+47h], bl
                mov     [rcx+20h], rbx
                mov     [rcx+45h], bx
                lea     rcx, unk_140C4E3E0
                cmovnz  rbp, rcx
                mov     rcx, rbp
                call    ExAcquireSpinLockExclusiveAtDpcLevel
                cmp     [rdi+47h], bl
                jnz     loc_14043FB0C
                mov     rdx, cs:qword_140C4E3F8
                test    rdx, rdx
                jz      short loc_140269E11

loc_140269DF2:                          ; CODE XREF: sub_140269D64+9F↓j
                cmp     rdi, rdx
                jb      short loc_140269E05
                mov     rax, [rdx+8]
                test    rax, rax
                jz      short loc_140269E0F

loc_140269E00:                          ; CODE XREF: sub_140269D64+A7↓j
                mov     rdx, rax
                jmp     short loc_140269DF2
; ---------------------------------------------------------------------------

loc_140269E05:                          ; CODE XREF: sub_140269D64+91↑j
                mov     rax, [rdx]
                test    rax, rax
                jnz     short loc_140269E00
                jmp     short loc_140269E11
; ---------------------------------------------------------------------------

loc_140269E0F:                          ; CODE XREF: sub_140269D64+9A↑j
                mov     bl, 1

loc_140269E11:                          ; CODE XREF: sub_140269D64+8C↑j
                                        ; sub_140269D64+A9↑j
                lea     rcx, qword_140C4E3F8

loc_140269E18:                          ; CODE XREF: sub_140269D64+1D5DC9↓j
                mov     r9, rdi
                mov     r8b, bl
                call    RtlAvlInsertNodeEx
                mov     rcx, rbp
                mov     byte ptr [rdi+44h], 1
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, 1
                jmp     loc_140269D83
sub_140269D64   endp

; ---------------------------------------------------------------------------
algn_140269E39:                         ; DATA XREF: .rdata:000000014005C768↑o
                                        ; .pdata:00000001400CDF74↑o
                align 20h
; Exported entry 175. ExAcquireSpinLockExclusiveAtDpcLevel

; =============== S U B R O U T I N E =======================================


                public ExAcquireSpinLockExclusiveAtDpcLevel
ExAcquireSpinLockExclusiveAtDpcLevel proc near
                                        ; CODE XREF: sub_140209860+413↑p
                                        ; sub_14020B2C0:loc_14020B465↑p ...

arg_0           = qword ptr  8
arg_8           = dword ptr  10h

; FUNCTION CHUNK AT 000000014041D5FC SIZE 0000005B BYTES

                push    rbx
                sub     rsp, 20h
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                mov     rbx, rcx
                jnz     loc_14041D5FC

loc_140269E56:                          ; DATA XREF: .rdata:000000014005C784↑o
                                        ; .rdata:000000014005C798↑o ...
                mov     [rsp+28h+arg_0], rdi
                mov     rdi, gs:20h
                mov     [rsp+28h+arg_8], 0
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_14041D609

loc_140269E7C:                          ; CODE XREF: ExAcquireSpinLockExclusiveAtDpcLevel+1B37CD↓j
                                        ; ExAcquireSpinLockExclusiveAtDpcLevel+1B37DC↓j ...
                lock bts dword ptr [rbx], 1Fh
                jb      short loc_140269E9F

loc_140269E83:                          ; CODE XREF: ExAcquireSpinLockExclusiveAtDpcLevel+7D↓j
                mov     edx, [rbx]
                mov     ecx, edx
                mov     rdi, [rsp+28h+arg_0]
                btr     ecx, 1Eh
                cmp     ecx, 80000000h
                jnz     short loc_140269EC0

loc_140269E98:                          ; CODE XREF: ExAcquireSpinLockExclusiveAtDpcLevel+AD↓j
                                        ; ExAcquireSpinLockExclusiveAtDpcLevel+1B37C4↓j
                                        ; DATA XREF: ...
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140269E9F:                          ; CODE XREF: ExAcquireSpinLockExclusiveAtDpcLevel+41↑j
                                        ; DATA XREF: .pdata:00000001400CDF98↑o ...
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_14041D630

loc_140269EAF:                          ; CODE XREF: ExAcquireSpinLockExclusiveAtDpcLevel+1B37F4↓j
                                        ; ExAcquireSpinLockExclusiveAtDpcLevel+1B3803↓j ...
                mov     dl, 0FFh
                mov     rcx, rbx
                call    sub_14028EAE0
                mov     [rsp+28h+arg_8], eax
                jmp     short loc_140269E83
; ---------------------------------------------------------------------------
                align 20h

loc_140269EC0:                          ; CODE XREF: ExAcquireSpinLockExclusiveAtDpcLevel+56↑j
                                        ; ExAcquireSpinLockExclusiveAtDpcLevel+AF↓j
                                        ; DATA XREF: ...
                bt      edx, 1Eh
                jb      short loc_140269ED6
                mov     ecx, edx
                mov     eax, edx
                bts     ecx, 1Eh
                lock cmpxchg [rbx], ecx
                mov     edx, eax
                jnz     short loc_140269EE2

loc_140269ED6:                          ; CODE XREF: ExAcquireSpinLockExclusiveAtDpcLevel+84↑j
                lea     rcx, [rsp+28h+arg_8]
                call    sub_1402C8C70
                mov     edx, [rbx]

loc_140269EE2:                          ; CODE XREF: ExAcquireSpinLockExclusiveAtDpcLevel+94↑j
                mov     eax, edx
                btr     eax, 1Eh
                cmp     eax, 80000000h
                jz      short loc_140269E98
                jmp     short loc_140269EC0
ExAcquireSpinLockExclusiveAtDpcLevel endp

; ---------------------------------------------------------------------------
algn_140269EF1:                         ; DATA XREF: .pdata:00000001400CDFB0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140269F00   proc near               ; CODE XREF: MmUnsecureVirtualMemory+3F↓p
                                        ; sub_14076C8BC+A6↓p
                                        ; DATA XREF: ...

var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014043FB44 SIZE 0000001F BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                mov     rax, gs:188h
                lea     r14, [rcx+38h]
                mov     r13, rcx
                mov     rsi, rdx
                xor     ebx, ebx
                xor     ebp, ebp
                mov     r15, [rax+0B8h]
                lea     rcx, [r15+680h]
                call    sub_1402325E0
                mov     rcx, rax
                mov     rdi, rax
                call    ExAcquireSpinLockExclusive
                mov     [rdi+4], ebx
                movzx   ecx, al
                mov     rdx, [r14]
                test    rdx, rdx
                jz      short loc_140269F8E

loc_140269F61:                          ; CODE XREF: sub_140269F00+8C↓j
                cmp     dword ptr [rdx+40h], 2
                jnz     short loc_140269F6E
                cmp     ebx, 1
                ja      short loc_140269F6E
                inc     ebx

loc_140269F6E:                          ; CODE XREF: sub_140269F00+65↑j
                                        ; sub_140269F00+6A↑j
                cmp     rdx, rsi
                jnz     short loc_140269F7E
                mov     rax, [rdx]
                mov     ebp, 1
                mov     [r14], rax

loc_140269F7E:                          ; CODE XREF: sub_140269F00+71↑j
                cmp     ebx, 1
                ja      short loc_140269FE8

loc_140269F83:                          ; CODE XREF: sub_140269F00+ED↓j
                mov     r14, rdx
                mov     rdx, [rdx]
                test    rdx, rdx
                jnz     short loc_140269F61

loc_140269F8E:                          ; CODE XREF: sub_140269F00+5F↑j
                                        ; sub_140269F00+EB↓j
                movzx   edx, cl
                lea     rcx, [r15+680h]
                call    sub_140234180
                test    ebp, ebp
                jz      loc_14043FB44
                mov     eax, [rsi+8]
                test    al, 10h
                jnz     short loc_140269FEF

loc_140269FAC:                          ; CODE XREF: sub_140269F00+FF↓j
                cmp     ebx, 1
                jnz     short loc_140269FBE
                xor     r8d, r8d
                mov     edx, ebx
                mov     rcx, r13
                call    sub_140268880

loc_140269FBE:                          ; CODE XREF: sub_140269F00+AF↑j
                xor     edx, edx
                mov     rcx, rsi
                call    ExFreePoolWithTag
                mov     rbx, [rsp+48h+arg_0]
                mov     rbp, [rsp+48h+arg_8]
                mov     rsi, [rsp+48h+arg_10]
                mov     rdi, [rsp+48h+arg_18]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                retn
; ---------------------------------------------------------------------------
                align 8

loc_140269FE8:                          ; CODE XREF: sub_140269F00+81↑j
                cmp     ebp, 1
                jz      short loc_140269F8E
                jmp     short loc_140269F83
; ---------------------------------------------------------------------------

loc_140269FEF:                          ; CODE XREF: sub_140269F00+AA↑j
                mov     r8, [rsi+10h]
                mov     rcx, r13
                mov     rdx, [rsi+8]
                call    sub_1406FFAB4
                jmp     short loc_140269FAC
sub_140269F00   endp

; ---------------------------------------------------------------------------
algn_14026A001:                         ; DATA XREF: .rdata:000000014005C820↑o
                                        ; .pdata:00000001400CDFBC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026A010   proc near               ; CODE XREF: MmUnsecureVirtualMemory+2C↓p
                                        ; sub_14071667C+C4↓p ...

var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014043FB64 SIZE 00000081 BYTES

                mov     [rsp+arg_10], rbp
                push    rdi
                push    r14
                push    r15
                sub     rsp, 30h
                mov     dword ptr [rdx], 0
                mov     r15, rdx
                mov     rdi, gs:188h
                mov     r14, rcx
                mov     rbp, [rdi+0B8h]
                dec     word ptr [rdi+1E6h]
                lea     rcx, [rbp+4C8h]
                xor     edx, edx
                call    ExAcquirePushLockSharedEx
                or      byte ptr [rdi+518h], 2
                mov     eax, [rbp+464h]
                test    al, 20h
                jnz     loc_14043FB64

loc_14026A064:                          ; DATA XREF: .rdata:000000014005C848↑o
                                        ; .rdata:000000014005C85C↑o ...
                mov     [rsp+48h+arg_0], rbx
                mov     [rsp+48h+arg_8], rsi
                mov     rsi, [r14+8]
                mov     rcx, rsi
                call    sub_14026A130
                mov     rbx, rax
                test    rax, rax
                jz      loc_14043FB7E
                lock inc dword ptr [rax+24h]
                jz      loc_14043FB9D
                dec     word ptr [rdi+1E6h]
                mov     rdx, rbp
                mov     rcx, rdi
                call    sub_140243130
                shr     rsi, 0Ch
                dec     word ptr [rdi+1E6h]
                lea     rcx, [rbx+28h]
                xor     edx, edx
                call    ExAcquirePushLockExclusiveEx
                or      byte ptr [rdi+518h], 80h
                mov     rcx, rdi
                call    sub_140245770
                mov     eax, [rbx+30h]
                test    al, 4
                jnz     loc_14043FBA4
                movzx   ecx, byte ptr [rbx+20h]
                mov     eax, [rbx+18h]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rsi, rcx
                jb      loc_14043FBCE
                movzx   ecx, byte ptr [rbx+21h]
                mov     eax, [rbx+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                cmp     rsi, rcx
                ja      loc_14043FBCE
                mov     rax, rbx

loc_14026A103:                          ; CODE XREF: sub_14026A010+1D5BD0↓j
                mov     rbx, [rsp+48h+arg_0]
                mov     rsi, [rsp+48h+arg_8]

loc_14026A10D:                          ; CODE XREF: sub_14026A010+1D5B69↓j
                                        ; DATA XREF: .pdata:00000001400CDFD4↑o ...
                mov     rbp, [rsp+48h+arg_10]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026A010   endp

byte_14026A11D  db 13h dup(0CCh)        ; DATA XREF: .pdata:00000001400CDFE0↑o

; =============== S U B R O U T I N E =======================================


sub_14026A130   proc near               ; CODE XREF: sub_140221EA0+681↑p
                                        ; sub_140224260+55D↑p ...
                mov     rax, gs:188h
                mov     r8, rcx
                mov     r9, [rax+0B8h]
                mov     rax, [r9+7E0h]
                test    rax, rax
                jz      short loc_14026A187
                movzx   edx, byte ptr [rax+20h]
                mov     ecx, [rax+18h]
                shl     rdx, 20h
                or      rdx, rcx
                shr     r8, 0Ch
                cmp     r8, rdx
                jb      short loc_14026A17B
                movzx   edx, byte ptr [rax+21h]
                mov     ecx, [rax+1Ch]
                shl     rdx, 20h
                or      rdx, rcx
                cmp     r8, rdx
                ja      short loc_14026A17B
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026A17B:                          ; CODE XREF: sub_14026A130+34↑j
                                        ; sub_14026A130+47↑j
                mov     rdx, [r9+7D8h]
                test    rdx, rdx
                jnz     short loc_14026A190

loc_14026A187:                          ; CODE XREF: sub_14026A130+1D↑j
                                        ; sub_14026A130+9B↓j
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_14026A190:                          ; CODE XREF: sub_14026A130+55↑j
                                        ; sub_14026A130+92↓j
                movzx   ecx, byte ptr [rdx+21h]
                mov     eax, [rdx+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                cmp     r8, rcx
                ja      short loc_14026A1BB
                movzx   ecx, byte ptr [rdx+20h]
                mov     eax, [rdx+18h]
                shl     rcx, 20h
                or      rcx, rax
                cmp     r8, rcx
                jnb     short loc_14026A1C8
                mov     rdx, [rdx]
                jmp     short loc_14026A1BF
; ---------------------------------------------------------------------------

loc_14026A1BB:                          ; CODE XREF: sub_14026A130+71↑j
                mov     rdx, [rdx+8]

loc_14026A1BF:                          ; CODE XREF: sub_14026A130+89↑j
                test    rdx, rdx
                jnz     short loc_14026A190
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                align 8

loc_14026A1C8:                          ; CODE XREF: sub_14026A130+84↑j
                test    rdx, rdx
                jz      short loc_14026A187
                mov     [r9+7E0h], rdx
                mov     rax, rdx
                retn
sub_14026A130   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14026A1D9:                         ; DATA XREF: .pdata:00000001400CDFEC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026A1E0   proc near               ; CODE XREF: sub_1406573B0+327↓p
                                        ; sub_140691104+238↓p ...

; FUNCTION CHUNK AT 000000014043FBE6 SIZE 00000013 BYTES

                sub     rsp, 28h
                mov     eax, [rcx+30h]
                lea     r9, qword_14002DE90
                shr     rax, 12h
                and     eax, 3
                cmp     qword ptr [r9+rax*8], 10h
                jz      loc_14043FBE6

loc_14026A200:                          ; CODE XREF: sub_14026A1E0+1D5A14↓j
                mov     r8d, 1
                call    sub_140269350
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026A1E0   endp

algn_14026A211:                         ; DATA XREF: .rdata:000000014005C8A0↑o
                                        ; .pdata:00000001400CDFF8↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026A220   proc near               ; CODE XREF: sub_1402335C0+ADF↑p
                                        ; sub_1402EB044+515↓p
                                        ; DATA XREF: ...

var_78          = qword ptr -78h
var_68          = dword ptr -68h
var_64          = dword ptr -64h
var_60          = dword ptr -60h
var_5C          = dword ptr -5Ch
var_58          = qword ptr -58h
var_50          = qword ptr -50h
arg_0           = byte ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 000000014043FBFA SIZE 00000196 BYTES

                mov     [rsp+arg_18], r9d
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 58h
                mov     r12, gs:188h
                xor     r15d, r15d
                mov     r10d, [rcx+30h]
                mov     r11, rdx
                mov     [rsp+98h+var_58], r12
                mov     rsi, rcx
                mov     edx, r15d
                mov     rbx, [r12+0B8h]
                test    r10b, 4
                jz      loc_14026A83E
                mov     ecx, 1
                mov     [rsp+98h+arg_8], ecx
                bt      r10d, 14h
                jb      short loc_14026A2A4
                mov     eax, [rsi+34h]
                movzx   ecx, byte ptr [rsi+22h]
                btr     eax, 1Fh
                shl     rcx, 1Fh
                or      rcx, rax
                mov     rax, 7FFFFFFFDh
                cmp     rcx, rax
                jnb     loc_14043FBFA
                mov     edx, 1
                mov     ecx, edx

loc_14026A2A4:                          ; CODE XREF: sub_14026A220+56↑j
                                        ; sub_14026A220+628↓j ...
                mov     rax, r8
                sub     rax, r11
                inc     rax
                cmp     r8, [rbx+5D8h]
                ja      short loc_14026A2C7
                test    r9b, 1
                jnz     short loc_14026A2C7
                sub     [rbx+498h], rax
                mov     r10d, [rsi+30h]

loc_14026A2C7:                          ; CODE XREF: sub_14026A220+94↑j
                                        ; sub_14026A220+9A↑j
                mov     r8, [rbx+690h]
                mov     [rsp+98h+var_50], r8
                bt      r10d, 14h
                jb      short loc_14026A2E7
                mov     eax, r10d
                and     al, 70h
                cmp     al, 20h ; ' '
                jz      loc_14026A7D7

loc_14026A2E7:                          ; CODE XREF: sub_14026A220+B8↑j
                                        ; sub_14026A220+5BC↓j ...
                cmp     ecx, 1
                jnz     short loc_14026A32E
                lock inc dword ptr [r8+118h]
                mov     ecx, [rsi+30h]
                lea     r9, qword_14002DE90
                mov     eax, ecx
                shr     rax, 12h
                and     eax, 3
                mov     rax, [r9+rax*8]
                cmp     rax, 10h
                jz      loc_14043FC06

loc_14026A315:                          ; CODE XREF: sub_14026A220+1D59F3↓j
                                        ; sub_14026A220+1D59FF↓j
                mov     r8d, edx
                mov     rcx, rsi
                mov     rdx, rbx
                call    sub_14065C600
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_14065B060

loc_14026A32E:                          ; CODE XREF: sub_14026A220+CA↑j
                and     byte ptr [r12+518h], 0FEh
                lea     r14, [rbx+4C8h]
                mov     rbp, 0FFFFFFFFFFFFFFFFh
                mov     rax, rbp
                lock xadd [r14], rax
                and     al, 6
                cmp     al, 2
                jz      loc_14026A857

loc_14026A357:                          ; CODE XREF: sub_14026A220+63F↓j
                mov     [rsp+98h+var_68], r15d
                mov     rcx, r14
                mov     rdi, gs:188h
                call    sub_140245330
                cmp     eax, 1
                jz      loc_14026A7AF
                mov     r9d, 0FFFFFFFFh

loc_14026A37C:                          ; CODE XREF: sub_14026A220+59E↓j
                dec     word ptr [rdi+1E6h]
                inc     byte ptr [rdi+31Ah]
                movsx   eax, byte ptr [rdi+318h]
                mov     r8, r14
                movsx   edx, byte ptr [rdi+366h]
                mov     r10, 7FFFFFFFFFFFFFFCh
                movzx   r13d, byte ptr [rdi+31Ah]
                or      edx, eax
                xor     edx, 3Fh
                and     r8, r10
                bsr     ecx, edx
                mov     [rsp+98h+arg_10], ecx
                jz      loc_14026A80D

loc_14026A3C4:                          ; CODE XREF: sub_14026A220+5E7↓j
                lea     rbx, [rcx+rcx*2]
                mov     eax, 1
                shl     rbx, 5
                add     rbx, [rdi+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    byte ptr [rbx+1Ah], 1
                jz      loc_14026A7FD
                mov     eax, [rbx+20h]
                test    al, 1
                jnz     loc_14026A7FD
                mov     rax, [rbx+20h]
                and     rax, r10
                cmp     rax, r8
                jnz     loc_14026A7FD
                cmp     [rbx+28h], r9d
                jnz     loc_14026A7FD
                and     byte ptr [rbx+1Ah], 0FEh
                mov     rax, [rbx+20h]
                test    rax, rax
                jz      loc_14026A7FD
                test    rbx, rbx
                jz      loc_14026A80D
                movzx   eax, byte ptr [rbx+20h]
                or      al, 2
                mov     [rbx+20h], al
                mov     rax, [rbx+20h]
                shr     rax, 3Fh
                test    al, al
                jnz     loc_14026A872

loc_14026A440:                          ; CODE XREF: sub_14026A220+65A↓j
                mov     eax, [rbx+58h]
                and     eax, 1FFFFh
                mov     [rsp+98h+var_68], eax
                and     dword ptr [rbx+58h], 0FFFE0000h
                and     byte ptr [rbx+19h], 0FEh
                mov     [rbx+20h], r15
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rbx, [rdi+320h]
                imul    rbx
                mov     eax, 1
                sar     rdx, 4
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                shl     al, cl
                cmp     r13b, 1
                jnz     loc_14043FC24
                or      [rdi+318h], al

loc_14026A494:                          ; CODE XREF: sub_14026A220+5F4↓j
                                        ; sub_14026A220+1D5A0B↓j
                dec     byte ptr [rdi+31Ah]
                lea     r8, [rsp+98h+var_68]
                mov     rdx, r14
                mov     rcx, rdi
                call    sub_1402456E0
                add     word ptr [rdi+1E6h], 1
                jnz     short loc_14026A4C4
                lea     rax, [rdi+98h]
                cmp     [rax], rax
                jnz     loc_14026A88C

loc_14026A4C4:                          ; CODE XREF: sub_14026A220+292↑j
                                        ; sub_14026A220+671↓j
                add     word ptr [r12+1E6h], 1
                jz      loc_14026A8A0

loc_14026A4D4:                          ; CODE XREF: sub_14026A220+68B↓j
                                        ; sub_14026A220+1D5A2C↓j
                cmp     [rsp+98h+arg_8], 1
                mov     r13, r15
                jnz     loc_14026A58D
                mov     rax, gs:188h
                lea     r12, [rsi+38h]
                mov     rbx, [rax+0B8h]
                movzx   eax, byte ptr [rbx+738h]
                and     al, 7
                cmp     al, 2
                jz      loc_14043FC51
                lea     rdi, [rbx+740h]

loc_14026A511:                          ; CODE XREF: sub_14026A220+1D5A38↓j
                mov     r14, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14043FC5D

loc_14026A52C:                          ; CODE XREF: sub_14026A220+1D5A3F↓j
                                        ; sub_14026A220+1D5A49↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                movzx   edx, r14b
                mov     rcx, rdi
                jnz     loc_14043FCA4
                call    sub_140234420

loc_14026A545:                          ; CODE XREF: sub_14026A220+1D5A8A↓j
                mov     [rdi+4], r15d
                mov     rcx, [r12]
                test    rcx, rcx
                jnz     loc_14043FCAF

loc_14026A556:                          ; CODE XREF: sub_14026A220+1D5AB0↓j
                movzx   edx, r14b
                lea     rcx, [rbx+680h]
                call    sub_140234180
                mov     r12, [rsp+98h+var_58]
                mov     [rsi+10h], rbp
                test    r13, r13
                jnz     loc_14043FCD5

loc_14026A578:                          ; CODE XREF: sub_14026A220+1D5ABE↓j
                mov     ecx, [rsi+30h]
                bt      ecx, 14h
                jb      short loc_14026A58D
                mov     eax, ecx
                and     al, 70h
                cmp     al, 20h ; ' '
                jz      loc_14026A7EE

loc_14026A58D:                          ; CODE XREF: sub_14026A220+2BF↑j
                                        ; sub_14026A220+35F↑j ...
                test    byte ptr [rsp+98h+arg_18], 2
                mov     rcx, rsi
                jnz     loc_14043FD18
                call    sub_14026A8BC
                mov     r14, gs:188h
                mov     rcx, rbp
                mov     [rsp+98h+var_5C], eax
                and     byte ptr [r14+518h], 7Fh
                lock xadd [rsi+28h], rcx
                and     cl, 6
                cmp     cl, 2
                jz      loc_14026A864

loc_14026A5CD:                          ; CODE XREF: sub_14026A220+64D↓j
                mov     [rsp+98h+var_60], r15d
                lea     rcx, [rsi+28h]
                mov     rdi, gs:188h
                call    sub_140245330
                cmp     eax, 1
                jz      loc_14026A7C3
                mov     r9d, 0FFFFFFFFh

loc_14026A5F3:                          ; CODE XREF: sub_14026A220+5B2↓j
                dec     word ptr [rdi+1E6h]
                inc     byte ptr [rdi+31Ah]
                movsx   ecx, byte ptr [rdi+318h]
                lea     r8, [rsi+28h]
                movsx   edx, byte ptr [rdi+366h]
                mov     r10, 7FFFFFFFFFFFFFFCh
                movzx   eax, byte ptr [rdi+31Ah]
                or      edx, ecx
                xor     edx, 3Fh
                mov     [rsp+98h+arg_0], al
                and     r8, r10
                bsr     ecx, edx
                mov     [rsp+98h+var_64], ecx
                jz      loc_14026A82C

loc_14026A63F:                          ; CODE XREF: sub_14026A220+606↓j
                lea     rbx, [rcx+rcx*2]
                mov     eax, 1
                shl     rbx, 5
                add     rbx, [rdi+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    byte ptr [rbx+1Ah], 1
                jz      loc_14026A81F
                mov     eax, [rbx+20h]
                test    al, 1
                jnz     loc_14026A81F
                mov     rax, [rbx+20h]
                and     rax, r10
                cmp     rax, r8
                jnz     loc_14026A81F
                cmp     [rbx+28h], r9d
                jnz     loc_14026A81F
                and     byte ptr [rbx+1Ah], 0FEh
                mov     rax, [rbx+20h]
                test    rax, rax
                jz      loc_14026A81F
                test    rbx, rbx
                jz      loc_14026A82C
                movzx   eax, byte ptr [rbx+20h]
                or      al, 2
                mov     [rbx+20h], al
                mov     rax, [rbx+20h]
                shr     rax, 3Fh
                test    al, al
                jnz     loc_14026A87F

loc_14026A6BB:                          ; CODE XREF: sub_14026A220+667↓j
                mov     ecx, [rbx+58h]
                and     ecx, 1FFFFh
                mov     [rsp+98h+var_60], ecx
                and     dword ptr [rbx+58h], 0FFFE0000h
                and     byte ptr [rbx+19h], 0FEh
                mov     [rbx+20h], r15
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rbx, [rdi+320h]
                imul    rbx
                sar     rdx, 4
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                cmp     [rsp+98h+arg_0], 1
                jnz     loc_14043FD23
                movzx   eax, byte ptr [rdi+318h]
                bts     eax, edx
                mov     [rdi+318h], al

loc_14026A717:                          ; CODE XREF: sub_14026A220+613↓j
                                        ; sub_14026A220+1D5B13↓j
                dec     byte ptr [rdi+31Ah]
                lea     r8, [rsp+98h+var_60]
                lea     rdx, [rsi+28h]
                mov     rcx, rdi
                call    sub_1402456E0
                add     word ptr [rdi+1E6h], 1
                jnz     short loc_14026A748
                lea     rax, [rdi+98h]
                cmp     [rax], rax
                jnz     loc_14026A896

loc_14026A748:                          ; CODE XREF: sub_14026A220+516↑j
                                        ; sub_14026A220+67B↓j
                add     word ptr [r14+1E6h], 1
                jnz     short loc_14026A763
                lea     rax, [r14+98h]
                cmp     [rax], rax
                jnz     loc_14026A84D

loc_14026A763:                          ; CODE XREF: sub_14026A220+531↑j
                                        ; sub_14026A220+632↓j
                cmp     [rsp+98h+var_5C], 1
                jnz     short loc_14026A774
                xor     edx, edx
                mov     rcx, rsi
                call    ExFreePoolWithTag

loc_14026A774:                          ; CODE XREF: sub_14026A220+548↑j
                                        ; sub_14026A220+1D5AFE↓j
                test    r13, r13
                jnz     loc_14043FD4F

loc_14026A77D:                          ; CODE XREF: sub_14026A220+1D5B54↓j
                cmp     [rsp+98h+arg_8], 1
                jnz     short loc_14026A79D
                mov     rcx, [rsp+98h+var_50]
                lock xadd [rcx+118h], ebp
                cmp     ebp, 1
                jz      loc_14043FD79

loc_14026A79D:                          ; CODE XREF: sub_14026A220+565↑j
                                        ; sub_14026A220+1D5B6B↓j
                add     rsp, 58h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026A7AF:                          ; CODE XREF: sub_14026A220+150↑j
                mov     rcx, [rdi+0B8h]
                call    sub_140245840
                mov     r9d, eax
                jmp     loc_14026A37C
; ---------------------------------------------------------------------------

loc_14026A7C3:                          ; CODE XREF: sub_14026A220+3C7↑j
                mov     rcx, [rdi+0B8h]
                call    sub_140245840
                mov     r9d, eax
                jmp     loc_14026A5F3
; ---------------------------------------------------------------------------

loc_14026A7D7:                          ; CODE XREF: sub_14026A220+C1↑j
                bt      r10d, 15h
                jnb     loc_14026A2E7
                dec     qword ptr [r8+180h]
                jmp     loc_14026A2E7
; ---------------------------------------------------------------------------

loc_14026A7EE:                          ; CODE XREF: sub_14026A220+367↑j
                bt      ecx, 16h
                jnb     loc_14026A58D
                jmp     loc_14043FCE3
; ---------------------------------------------------------------------------

loc_14026A7FD:                          ; CODE XREF: sub_14026A220+1C2↑j
                                        ; sub_14026A220+1CD↑j ...
                bsr     ecx, edx
                mov     [rsp+98h+arg_10], ecx
                jnz     loc_14026A3C4

loc_14026A80D:                          ; CODE XREF: sub_14026A220+19E↑j
                                        ; sub_14026A220+201↑j
                mov     eax, [rdi+78h]
                bt      eax, 10h
                jb      loc_14026A494
                jmp     loc_14043FC30
; ---------------------------------------------------------------------------

loc_14026A81F:                          ; CODE XREF: sub_14026A220+43D↑j
                                        ; sub_14026A220+448↑j ...
                bsr     ecx, edx
                mov     [rsp+98h+var_64], ecx
                jnz     loc_14026A63F

loc_14026A82C:                          ; CODE XREF: sub_14026A220+419↑j
                                        ; sub_14026A220+47C↑j
                mov     eax, [rdi+78h]
                bt      eax, 10h
                jb      loc_14026A717
                jmp     loc_14043FD38
; ---------------------------------------------------------------------------

loc_14026A83E:                          ; CODE XREF: sub_14026A220+3F↑j
                mov     ecx, r15d
                mov     [rsp+98h+arg_8], ecx
                jmp     loc_14026A2A4
; ---------------------------------------------------------------------------

loc_14026A84D:                          ; CODE XREF: sub_14026A220+53D↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_14026A763
; ---------------------------------------------------------------------------

loc_14026A857:                          ; CODE XREF: sub_14026A220+131↑j
                mov     rcx, r14
                call    ExfTryToWakePushLock
                jmp     loc_14026A357
; ---------------------------------------------------------------------------

loc_14026A864:                          ; CODE XREF: sub_14026A220+3A7↑j
                lea     rcx, [rsi+28h]
                call    ExfTryToWakePushLock
                jmp     loc_14026A5CD
; ---------------------------------------------------------------------------

loc_14026A872:                          ; CODE XREF: sub_14026A220+21A↑j
                mov     rcx, rbx
                call    sub_14031EC80
                jmp     loc_14026A440
; ---------------------------------------------------------------------------

loc_14026A87F:                          ; CODE XREF: sub_14026A220+495↑j
                mov     rcx, rbx
                call    sub_14031EC80
                jmp     loc_14026A6BB
; ---------------------------------------------------------------------------

loc_14026A88C:                          ; CODE XREF: sub_14026A220+29E↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_14026A4C4
; ---------------------------------------------------------------------------

loc_14026A896:                          ; CODE XREF: sub_14026A220+522↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_14026A748
; ---------------------------------------------------------------------------

loc_14026A8A0:                          ; CODE XREF: sub_14026A220+2AE↑j
                lea     rax, [r12+98h]
                cmp     [rax], rax
                jz      loc_14026A4D4
                jmp     loc_14043FC46
sub_14026A220   endp

; ---------------------------------------------------------------------------
byte_14026A8B6  db 6 dup(0CCh)          ; DATA XREF: .rdata:000000014005C8CC↑o
                                        ; .pdata:00000001400CE004↑o

; =============== S U B R O U T I N E =======================================


sub_14026A8BC   proc near               ; CODE XREF: sub_14026A220+37E↑p
                                        ; sub_14055BFD0+D↓p ...

; FUNCTION CHUNK AT 000000014043E5BC SIZE 00000007 BYTES

                or      eax, 0FFFFFFFFh
                lock xadd [rcx+24h], eax
                dec     eax
                cmp     eax, 0FFFFFFFFh
                jz      loc_14043E5BC
                test    eax, eax
                jnz     short loc_14026A8E1
                mov     eax, [rcx+30h]
                test    al, 4
                jz      short loc_14026A8E1
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026A8E1:                          ; CODE XREF: sub_14026A8BC+15↑j
                                        ; sub_14026A8BC+1C↑j
                xor     eax, eax
                retn
sub_14026A8BC   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14026A8E5:                         ; DATA XREF: .pdata:00000001400CE010↑o
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=150h

sub_14026A8F0   proc near               ; CODE XREF: sub_14053E400+8A↓p
                                        ; sub_14065AEC0+185↓p ...

var_230         = dword ptr -230h
var_22C         = dword ptr -22Ch
var_228         = qword ptr -228h
var_220         = qword ptr -220h
var_218         = qword ptr -218h
var_210         = qword ptr -210h
var_208         = dword ptr -208h
var_204         = dword ptr -204h
var_200         = qword ptr -200h
var_1F8         = qword ptr -1F8h
var_1F0         = qword ptr -1F0h
var_1E8         = dword ptr -1E8h
var_1E0         = qword ptr -1E0h
var_1D8         = qword ptr -1D8h
var_1D0         = xmmword ptr -1D0h
var_1C0         = qword ptr -1C0h
var_1B8         = qword ptr -1B8h
var_1B0         = word ptr -1B0h
var_1AE         = byte ptr -1AEh
var_1AA         = byte ptr -1AAh
var_1A0         = qword ptr -1A0h
var_198         = qword ptr -198h
var_190         = qword ptr -190h
var_188         = qword ptr -188h
var_110         = qword ptr -110h
var_108         = qword ptr -108h
var_100         = dword ptr -100h
var_FC          = word ptr -0FCh
var_FA          = word ptr -0FAh
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = byte ptr -0E0h
var_40          = qword ptr -40h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 000000014043FD90 SIZE 000008FA BYTES

; __unwind { // __GSHandlerCheck
                mov     [rsp-8+arg_18], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-120h]
                sub     rsp, 220h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+150h+var_40], rax
                mov     r14, r8
                mov     [rsp+250h+var_1F0], r8
                mov     r15, rdx
                mov     [rsp+250h+var_230], r9d
                mov     rbx, rcx
                xor     eax, eax
                xor     r13d, r13d
                mov     [rbp+150h+var_FA], ax
                xor     edx, edx
                mov     [rsp+250h+var_1D8], r13
                mov     r8d, 98h
                lea     rcx, [rbp+150h+var_E0]
                mov     edi, r9d
                call    memset
                mov     rcx, 7FFFFFFFF8h
                shr     rbx, 9
                and     rbx, rcx
                mov     [rsp+250h+var_228], r13
                mov     esi, r13d
                mov     [rsp+250h+var_22C], r13d
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                shr     r15, 9
                add     rbx, rax
                and     r15, rcx
                mov     rax, r8
                add     r15, rax
                mov     rax, gs:188h
                mov     [rsp+250h+var_210], r15
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+690h]
                lea     r12, [rcx+680h]
                mov     [rbp+150h+var_1C0], rax
                mov     eax, edi
                and     eax, 1
                mov     [rsp+250h+var_200], r12
                mov     [rsp+250h+var_204], eax
                jz      loc_14043FDA1
                mov     rcx, [r14+38h]
                test    rcx, rcx
                jz      short loc_14026A9DF

loc_14026A9D4:                          ; CODE XREF: sub_14026A8F0+1D54A6↓j
                mov     eax, [rcx+40h]
                test    al, 4
                jz      loc_14043FD90

loc_14026A9DF:                          ; CODE XREF: sub_14026A8F0+E2↑j
                                        ; sub_14026A8F0+1D54AC↓j
                add     rcx, 8
                mov     [rsp+250h+var_1E0], rcx

loc_14026A9E8:                          ; CODE XREF: sub_14026A8F0+1D54B6↓j
                mov     [rbp+150h+var_FC], r13w
                mov     [rbp+150h+var_F0], r13
                mov     [rbp+150h+var_E8], r13
                lea     r13, unk_140C4F600
                mov     [rbp+150h+var_F8], 14h
                mov     [rbp+150h+var_100], 1
                movzx   eax, byte ptr [r12+0B8h]
                and     al, 7
                cmp     al, 6
                jnb     loc_14043FDAB
                cmp     al, 2
                jz      loc_14043FE17
                lea     rdi, [r12+0C0h]

loc_14026AA2E:                          ; CODE XREF: sub_14026A8F0+1D552A↓j
                mov     r14, cr8
                mov     edx, 2
                mov     cr8, rdx
                mov     eax, cs:dword_140CFC660
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                test    eax, eax
                jnz     loc_14043FE1F

loc_14026AA50:                          ; CODE XREF: sub_14026A8F0+1D5531↓j
                                        ; sub_14026A8F0+1D553B↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14043FE67
                mov     rsi, gs:20h
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14043FE82

loc_14026AA76:                          ; CODE XREF: sub_14026A8F0+1D5596↓j
                                        ; sub_14026A8F0+1D55A5↓j ...
                prefetchw byte ptr [rdi]
                mov     eax, [rdi]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rdi], ecx
                jnz     loc_14026B312

loc_14026AA8C:                          ; CODE XREF: sub_14026A8F0+A48↓j
                mov     rsi, [rsp+250h+var_228]

loc_14026AA91:                          ; CODE XREF: sub_14026A8F0+1D558D↓j
                cmp     dword ptr [rdi+4], 0
                jnz     loc_14043FED9

loc_14026AA9B:                          ; CODE XREF: sub_14026A8F0+1D55EE↓j
                mov     [rsp+250h+var_220], r14

loc_14026AAA0:                          ; CODE XREF: sub_14026A8F0+1D54D9↓j
                                        ; sub_14026A8F0+1D54E1↓j ...
                cmp     rbx, r15
                ja      loc_14026AE6F
                mov     rdi, r8
                mov     eax, [rsp+250h+var_230]
                mov     r13, r15
                shl     r13, 19h
                shl     rdi, 19h
                sub     r13, rdi
                mov     [rsp+250h+var_1F8], rdi
                sar     r13, 10h
                and     eax, 2
                mov     [rbp+150h+var_1B8], r13
                mov     [rsp+250h+var_230], eax

loc_14026AAD2:                          ; CODE XREF: sub_14026A8F0+9AA↓j
                test    rsi, rsi
                jnz     loc_14026B29F

loc_14026AADB:                          ; CODE XREF: sub_14026A8F0+9E3↓j
                test    eax, eax
                jnz     loc_14043FEE3

loc_14026AAE3:                          ; CODE XREF: sub_14026A8F0+1D55FF↓j
                xorps   xmm0, xmm0
                lea     rcx, [rbp+150h+var_1AE]
                xor     edx, edx
                mov     r8d, 0AEh
                movups  [rbp+150h+var_1D0], xmm0
                call    memset
                mov     r14, rbx
                mov     rdx, 0FFFFF68000000000h
                shl     r14, 19h
                mov     eax, 8E1h
                sub     r14, rdi
                mov     [rbp+150h+var_1B0], ax
                sar     r14, 10h
                mov     rcx, r14
                mov     rax, rdx
                cmp     r14, rax
                jnb     loc_14043FEF4

loc_14026AB2B:                          ; CODE XREF: sub_14026A8F0+1D562E↓j
                mov     rax, 0FFFF800000000000h
                cmp     rcx, rax
                jnb     loc_14043FF23

loc_14026AB3E:                          ; CODE XREF: sub_14026A8F0+1D5643↓j
                mov     rax, gs:188h
                mov     rdi, [rax+0B8h]
                add     rdi, 680h

loc_14026AB55:                          ; CODE XREF: sub_14026A8F0+1D5656↓j
                xor     r8d, r8d
                mov     rdx, r14
                mov     rcx, rdi
                call    sub_1402258A0
                test    eax, eax
                jz      loc_14026B33D
                lea     ecx, [rax-1]
                shr     r14, 9
                mov     rax, 7FFFFFFFF8h
                mov     dword ptr [rbp+150h+var_1D0], ecx
                and     r14, rax
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                add     r14, rax
                mov     qword ptr [rbp+150h+var_1D0+8], r14

loc_14026AB96:                          ; CODE XREF: sub_14026A8F0+AA6↓j
                mov     rdi, r14
                test    r14, r14
                jz      loc_14026B39B
                mov     rsi, r14
                mov     r8, 7FFFFFFFF8h
                shr     rsi, 9
                and     rsi, r8
                mov     rax, rdx
                add     rsi, rax
                mov     [rsp+250h+var_228], rsi
                test    ecx, ecx
                jnz     loc_14043FF4B
                mov     r13, r14
                and     r13, 0FFFFFFFFFFFFF000h
                add     r13, 0FF8h
                cmp     r13, r15
                jbe     short loc_14026ABE2
                mov     r13, r15

loc_14026ABE2:                          ; CODE XREF: sub_14026A8F0+2ED↑j
                                        ; sub_14026A8F0+AAE↓j ...
                cmp     [rsp+250h+var_204], 0
                jz      loc_14026AD5F
                mov     [rsp+250h+var_22C], 1
                mov     rax, rdx
                mov     r10, [rsp+250h+var_1F8]
                cmp     rbx, rax
                jb      short loc_14026AC2C
                mov     r12, 0FFFFF6FFFFFFFFFFh

loc_14026AC0C:                          ; CODE XREF: sub_14026A8F0+335↓j
                mov     rax, r12
                cmp     rbx, rax
                ja      short loc_14026AC27
                shl     rbx, 19h
                sub     rbx, r10
                sar     rbx, 10h
                mov     rax, rdx
                cmp     rbx, rax
                jnb     short loc_14026AC0C

loc_14026AC27:                          ; CODE XREF: sub_14026A8F0+322↑j
                mov     r12, [rsp+250h+var_200]

loc_14026AC2C:                          ; CODE XREF: sub_14026A8F0+310↑j
                mov     r11, [rsp+250h+var_1F0]
                shr     rbx, 0Ch
                mov     rcx, r11
                mov     eax, [r11+18h]
                movzx   r8d, byte ptr [r11+20h]
                shl     r8, 20h
                or      r8, rax
                sub     rbx, r8
                call    sub_14026B3E0
                mov     r9, rax
                cmp     rax, 1
                jnz     loc_14026B3B4

loc_14026AC5D:                          ; CODE XREF: sub_14026A8F0+ACF↓j
                lea     rsi, [r13+8]
                mov     rcx, 0FFFFF68000000000h
                mov     rax, rcx
                cmp     rsi, rax
                jb      short loc_14026AC9D
                mov     r12, 0FFFFF6FFFFFFFFFFh

loc_14026AC7D:                          ; CODE XREF: sub_14026A8F0+3A6↓j
                mov     rax, r12
                cmp     rsi, rax
                ja      short loc_14026AC98
                shl     rsi, 19h
                sub     rsi, r10
                sar     rsi, 10h
                mov     rax, rcx
                cmp     rsi, rax
                jnb     short loc_14026AC7D

loc_14026AC98:                          ; CODE XREF: sub_14026A8F0+393↑j
                mov     r12, [rsp+250h+var_200]

loc_14026AC9D:                          ; CODE XREF: sub_14026A8F0+381↑j
                movzx   ecx, byte ptr [r11+21h]
                mov     eax, [r11+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                shl     rcx, 0Ch
                or      rcx, 0FFFh
                cmp     rsi, rcx
                ja      loc_14026B235
                shr     rsi, 0Ch
                sub     rsi, r8
                cmp     r9, 1
                jnz     loc_14026B3C4

loc_14026ACD2:                          ; CODE XREF: sub_14026A8F0+94D↓j
                                        ; sub_14026A8F0+ADF↓j
                sub     rsi, rbx
                mov     [rsp+250h+var_208], 0
                mov     rcx, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14043FFE1

loc_14026ACF8:                          ; CODE XREF: sub_14026A8F0+1D56F3↓j
                                        ; sub_14026A8F0+1D56FC↓j ...
                mov     eax, [r11+30h]
                mov     r15, r11

loc_14026ACFF:                          ; CODE XREF: sub_14026A8F0+425↓j
                                        ; sub_14026A8F0+1D5743↓j ...
                test    al, 1
                jnz     loc_140440024
                mov     ecx, eax
                and     ecx, 0FFFFFFFDh
                or      ecx, 1
                lock cmpxchg [r15+30h], ecx
                jnz     short loc_14026ACFF
                mov     r15, [rsp+250h+var_210]
                test    rsi, rsi
                jz      short loc_14026AD5F
                mov     rdx, [rsp+250h+var_1E0]
                mov     r15, rbx
                and     ebx, 7
                shr     r15, 3
                add     r15, [rdx+8]
                lea     rax, [rbx+rsi]
                cmp     rax, 8
                ja      loc_14026B1F0
                lea     rax, cs:140000000h
                mov     ecx, ebx
                movzx   eax, byte ptr [rsi+rax+1DAE0h]
                shl     al, cl
                not     al

loc_14026AD57:                          ; CODE XREF: sub_14026A8F0+940↓j
                and     [r15], al

loc_14026AD5A:                          ; CODE XREF: sub_14026A8F0+92B↓j
                mov     r15, [rsp+250h+var_210]

loc_14026AD5F:                          ; CODE XREF: sub_14026A8F0+2F7↑j
                                        ; sub_14026A8F0+42F↑j
                test    r14, r14
                jz      loc_14026AE68
                cmp     rdi, r13
                ja      short loc_14026ADB6
                mov     r15d, [rsp+250h+var_204]
                mov     r12d, [rsp+250h+var_230]
                mov     r9, 0FFFFF6FB7DBED000h

loc_14026AD81:                          ; CODE XREF: sub_14026A8F0+4BA↓j
                mov     rcx, [rdi]
                mov     rax, r9
                cmp     rdi, rax
                jnb     loc_140440057

loc_14026AD90:                          ; CODE XREF: sub_14026A8F0+1D5777↓j
                                        ; sub_14026A8F0+1D5787↓j ...
                mov     [rsp+250h+var_1D8], rcx
                test    cl, 1
                jz      short loc_14026ADA3
                test    cl, 42h
                jnz     loc_14026AF68

loc_14026ADA3:                          ; CODE XREF: sub_14026A8F0+4A8↑j
                                        ; sub_14026A8F0+83A↓j ...
                add     rdi, 8
                cmp     rdi, r13
                jbe     short loc_14026AD81
                mov     r12, [rsp+250h+var_200]
                mov     r15, [rsp+250h+var_210]

loc_14026ADB6:                          ; CODE XREF: sub_14026A8F0+47B↑j
                cmp     [rsp+250h+var_22C], 0
                jz      short loc_14026ADF2
                mov     r14, [rsp+250h+var_1F0]
                mov     eax, [r14+30h]

loc_14026ADC6:                          ; CODE XREF: sub_14026A8F0+4E1↓j
                mov     ecx, eax
                and     ecx, 0FFFFFFFCh
                lock cmpxchg [r14+30h], ecx
                jnz     short loc_14026ADC6
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140440519

loc_14026ADE1:                          ; CODE XREF: sub_14026A8F0+1D5C2B↓j
                                        ; sub_14026A8F0+1D5C39↓j ...
                mov     eax, 2
                mov     cr8, rax
                mov     [rsp+250h+var_22C], 0

loc_14026ADF2:                          ; CODE XREF: sub_14026A8F0+4CB↑j
                mov     rbx, rdi
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                cmp     rdi, rax
                jb      short loc_14026AE3B
                mov     r15, [rsp+250h+var_1F8]
                mov     r12, 0FFFFF6FFFFFFFFFFh

loc_14026AE16:                          ; CODE XREF: sub_14026A8F0+53F↓j
                mov     rax, r12
                cmp     rbx, rax
                ja      short loc_14026AE31
                shl     rbx, 19h
                sub     rbx, r15
                sar     rbx, 10h
                mov     rax, r8
                cmp     rbx, rax
                jnb     short loc_14026AE16

loc_14026AE31:                          ; CODE XREF: sub_14026A8F0+52C↑j
                mov     r12, [rsp+250h+var_200]
                mov     r15, [rsp+250h+var_210]

loc_14026AE3B:                          ; CODE XREF: sub_14026A8F0+515↑j
                shr     rbx, 9
                mov     rax, 7FFFFFFFF8h
                and     rbx, rax
                mov     rax, r8
                mov     rdi, [rsp+250h+var_1F8]
                add     rbx, rax
                mov     r13, [rbp+150h+var_1B8]
                mov     eax, [rsp+250h+var_230]
                cmp     rbx, r15
                jbe     loc_14026B290

loc_14026AE68:                          ; CODE XREF: sub_14026A8F0+472↑j
                lea     r13, unk_140C4F600

loc_14026AE6F:                          ; CODE XREF: sub_14026A8F0+1B3↑j
                lea     rcx, [rbp+150h+var_100]
                call    sub_14028EDB0
                cmp     [rsp+250h+var_22C], 0
                jnz     loc_14026B3A3

loc_14026AE83:                          ; CODE XREF: sub_14026A8F0+ABF↓j
                mov     rax, [rsp+250h+var_228]
                test    rax, rax
                jz      short loc_14026AE98
                mov     rdx, rax
                mov     rcx, r12
                call    sub_140312B40

loc_14026AE98:                          ; CODE XREF: sub_14026A8F0+59B↑j
                movzx   eax, byte ptr [r12+0B8h]
                and     al, 7
                cmp     al, 6
                jnb     loc_14044055B
                mov     ecx, [r12+0B8h]
                mov     eax, ecx
                shr     eax, 18h
                test    al, 8
                jnz     loc_1404405CC
                test    al, 4
                jnz     loc_1404405CC
                test    al, 10h
                jnz     loc_1404405CC
                mov     rbx, [rsp+250h+var_220]

loc_14026AED5:                          ; CODE XREF: sub_14026A8F0+1D5CF5↓j
                and     cl, 7
                cmp     cl, 2
                jz      short loc_14026AEE5
                lea     r13, [r12+0C0h]

loc_14026AEE5:                          ; CODE XREF: sub_14026A8F0+5EB↑j
                mov     edx, 1
                mov     rcx, r12
                call    sub_140226A50
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_1404405EA
                lock and dword ptr [r13+0], 0BFFFFFFFh
                lock dec dword ptr [r13+0]

loc_14026AF0D:                          ; CODE XREF: sub_14026A8F0+1D5D0A↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_1404405FF

loc_14026AF26:                          ; CODE XREF: sub_14026A8F0+1D5D13↓j
                                        ; sub_14026A8F0+1D5D22↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140440623

loc_14026AF34:                          ; CODE XREF: sub_14026A8F0+1D5C73↓j
                                        ; sub_14026A8F0+1D5C7B↓j ...
                movzx   eax, byte ptr [rsp+250h+var_220]
                mov     cr8, rax
                mov     rcx, [rbp+150h+var_40]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+250h+arg_18]
                add     rsp, 220h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 8

loc_14026AF68:                          ; CODE XREF: sub_14026A8F0+4AD↑j
                test    r15d, r15d
                jz      loc_140440106

loc_14026AF71:                          ; CODE XREF: sub_14026A8F0+1D583E↓j
                mov     rdx, [rdi]
                mov     rcx, rdx
                mov     rax, r9
                cmp     rdi, rax
                jnb     loc_140440133

loc_14026AF83:                          ; CODE XREF: sub_14026A8F0+1D5853↓j
                                        ; sub_14026A8F0+1D5863↓j ...
                and     rcx, 0FFFFFFFFFFFFFFBDh
                mov     r14, 0FFFFF68000000000h
                mov     rsi, rdi
                mov     [rsp+250h+var_218], rcx
                mov     rcx, [rsp+250h+var_1F8]
                xor     ebx, ebx
                shl     rsi, 19h
                sub     rsi, rcx
                sar     rsi, 10h
                mov     rax, r14
                cmp     rsi, rax
                jnb     loc_1404401E1

loc_14026AFB7:                          ; CODE XREF: sub_14026A8F0+1D5924↓j
                mov     rax, r9
                cmp     rdi, rax
                jnb     loc_140440252

loc_14026AFC3:                          ; CODE XREF: sub_14026A8F0+1D5972↓j
                                        ; sub_14026A8F0+1D5982↓j ...
                mov     rcx, [rsp+250h+var_218]
                mov     r8, 0F00000000000000h
                xor     rcx, rdx
                mov     rax, 7000000000000000h
                and     rcx, r8
                xor     rcx, [rsp+250h+var_218]
                mov     rbx, rcx
                xor     rbx, rdx
                and     rbx, rax
                xor     rbx, rcx
                mov     rcx, rdi
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140440301

loc_14026B003:                          ; CODE XREF: sub_14026A8F0+1D5A63↓j
                                        ; sub_14026A8F0+1D5A6C↓j ...
                mov     [rdi], rbx

loc_14026B006:                          ; CODE XREF: sub_14026A8F0+1D5A44↓j
                movzx   r11d, byte ptr [rbp+150h+var_FC]
                mov     ebx, 1
                cmp     [rbp+150h+var_100], ebx
                jnz     loc_140440374

loc_14026B019:                          ; CODE XREF: sub_14026A8F0+1D5A88↓j
                                        ; sub_14026A8F0+1D5A94↓j ...
                mov     r10d, dword ptr [rbp+150h+var_F8+4]
                test    r10d, r10d
                jz      loc_14026B161
                and     r11b, 4
                jnz     loc_14026B12F
                lea     eax, [r10-1]
                lea     r9, [rbp+150h+var_E8]
                lea     r9, [r9+rax*8]
                mov     rax, [r9]
                test    rax, 0C00h
                jnz     loc_14026B12F
                mov     r8, rax
                mov     rcx, rax
                and     r8d, 3FFh
                and     rcx, 0FFFFFFFFFFFFF000h
                lea     rdx, [r8+1]
                shl     rdx, 0Ch
                add     rdx, rcx
                cmp     rdx, rsi
                jnz     loc_14026B12F
                lea     rcx, [r8+1]
                cmp     rcx, r8
                jbe     loc_14026B12F
                cmp     rcx, 3FFh
                ja      loc_14026B12F
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rax, rcx
                inc     [rbp+150h+var_F0]
                mov     [r9], rax

loc_14026B0A4:                          ; CODE XREF: sub_14026A8F0+8D1↓j
                                        ; sub_14026A8F0+8DC↓j ...
                mov     rbx, [rsp+250h+var_218]
                lea     rcx, [rsp+250h+var_218]
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_1404403EF

loc_14026B0BB:                          ; CODE XREF: sub_14026A8F0+1D5B09↓j
                                        ; sub_14026A8F0+1D5B26↓j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rbx, [rbx+rbx*2]
                shl     rbx, 4
                mov     rax, rax
                xor     esi, esi
                add     rbx, rax
                mov     [rsp+250h+var_1E8], esi
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      loc_140440484

loc_14026B0F7:                          ; CODE XREF: sub_14026A8F0+1D5BB0↓j
                movzx   r8d, byte ptr [rbx+22h]
                xor     eax, eax
                test    r8b, 10h
                jz      loc_1404404A5

loc_14026B108:                          ; CODE XREF: sub_14026A8F0+1D5BEE↓j
                                        ; sub_14026A8F0+1D5C0D↓j
                mov     rcx, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rcx
                test    rax, rax
                jnz     loc_140440502

loc_14026B120:                          ; CODE XREF: sub_14026A8F0+1D5C24↓j
                mov     r9, 0FFFFF6FB7DBED000h
                jmp     loc_14026ADA3
; ---------------------------------------------------------------------------

loc_14026B12F:                          ; CODE XREF: sub_14026A8F0+73A↑j
                                        ; sub_14026A8F0+755↑j ...
                test    r11b, r11b
                jnz     short loc_14026B161
                lea     eax, [r10-1]
                lea     r8, [rbp+150h+var_E8]
                lea     r8, [r8+rax*8]
                mov     rax, [r8]
                test    rax, 0C00h
                jnz     short loc_14026B161
                mov     rdx, rax
                lea     rcx, [rsi+1000h]
                and     rdx, 0FFFFFFFFFFFFF000h
                cmp     rdx, rcx
                jz      short loc_14026B1D1

loc_14026B161:                          ; CODE XREF: sub_14026A8F0+730↑j
                                        ; sub_14026A8F0+842↑j ...
                cmp     r10d, dword ptr [rbp+150h+var_F8]
                jnb     short loc_14026B1C9

loc_14026B167:                          ; CODE XREF: sub_14026A8F0+8D7↓j
                lea     rax, [rbx-1]
                cmp     rax, 3FFh
                ja      loc_1404403D8
                mov     rdx, rbx

loc_14026B17A:                          ; CODE XREF: sub_14026A8F0+1D5AED↓j
                lea     rax, [rdx-1]
                mov     rcx, rsi
                and     rcx, 0FFFFFFFFFFFFF000h
                and     eax, 3FFh
                or      rax, rcx
                sub     rbx, rdx
                mov     rcx, rdx
                shl     rcx, 0Ch
                add     rsi, rcx
                mov     ecx, r10d
                mov     [rbp+rcx*8+150h+var_E8], rax
                mov     r10d, dword ptr [rbp+150h+var_F8+4]
                add     [rbp+150h+var_F0], rdx
                inc     r10d
                mov     dword ptr [rbp+150h+var_F8+4], r10d
                cmp     r10d, dword ptr [rbp+150h+var_F8]
                jz      loc_14026B242

loc_14026B1BE:                          ; CODE XREF: sub_14026A8F0+956↓j
                                        ; sub_14026A8F0+986↓j
                test    rbx, rbx
                jz      loc_14026B0A4
                jmp     short loc_14026B167
; ---------------------------------------------------------------------------

loc_14026B1C9:                          ; CODE XREF: sub_14026A8F0+875↑j
                mov     byte ptr [rbp+150h+var_FC+1], bl
                jmp     loc_14026B0A4
; ---------------------------------------------------------------------------

loc_14026B1D1:                          ; CODE XREF: sub_14026A8F0+86F↑j
                mov     rcx, rax
                and     ecx, 3FFh
                lea     rdx, [rcx+1]
                cmp     rdx, 3FFh
                ja      loc_14026B161
                jmp     loc_1404403AD
; ---------------------------------------------------------------------------

loc_14026B1F0:                          ; CODE XREF: sub_14026A8F0+44C↑j
                test    ebx, ebx
                jnz     loc_14026B2D8

loc_14026B1F8:                          ; CODE XREF: sub_14026A8F0+A07↓j
                cmp     rsi, 8
                jbe     short loc_14026B218
                mov     rbx, rsi
                xor     edx, edx
                shr     rbx, 3
                mov     rcx, r15
                mov     r8, rbx
                call    memset
                add     r15, rbx
                and     esi, 7

loc_14026B218:                          ; CODE XREF: sub_14026A8F0+90C↑j
                test    rsi, rsi
                jz      loc_14026AD5A
                lea     rax, cs:140000000h
                movzx   eax, byte ptr [rsi+rax+1A870h]
                jmp     loc_14026AD57
; ---------------------------------------------------------------------------

loc_14026B235:                          ; CODE XREF: sub_14026A8F0+3CB↑j
                mov     rax, [rsp+250h+var_1E0]
                mov     rsi, [rax]
                jmp     loc_14026ACD2
; ---------------------------------------------------------------------------

loc_14026B242:                          ; CODE XREF: sub_14026A8F0+8C8↑j
                test    byte ptr [rbp+150h+var_FC], 4
                jnz     loc_14026B1BE
                mov     edx, r10d
                lea     r9, sub_14033B080
                mov     r8d, 8
                lea     rcx, [rbp+150h+var_E8]
                call    qsort
                lea     rcx, [rbp+150h+var_100]
                call    sub_14033A660
                mov     r10d, dword ptr [rbp+150h+var_F8+4]
                cmp     r10d, dword ptr [rbp+150h+var_F8]
                jnz     loc_14026B1BE
                test    rbx, rbx
                jz      loc_14026B0A4
                jmp     loc_1404403E2
; ---------------------------------------------------------------------------
                align 10h

loc_14026B290:                          ; CODE XREF: sub_14026A8F0+572↑j
                mov     rsi, [rsp+250h+var_228]
                mov     r14, [rsp+250h+var_220]
                jmp     loc_14026AAD2
; ---------------------------------------------------------------------------

loc_14026B29F:                          ; CODE XREF: sub_14026A8F0+1E5↑j
                lea     rcx, [rbp+150h+var_100]
                call    sub_14028EDB0
                mov     rdx, rsi
                mov     rcx, r12
                call    sub_140312B40
                xor     ecx, ecx
                mov     [rsp+250h+var_228], rcx
                mov     rcx, r12
                call    sub_14029A5E0
                test    eax, eax
                jnz     short loc_14026B2FC
                call    KeShouldYieldProcessor
                test    eax, eax
                jnz     short loc_14026B2FC

loc_14026B2CF:                          ; CODE XREF: sub_14026A8F0+A20↓j
                mov     eax, [rsp+250h+var_230]
                jmp     loc_14026AADB
; ---------------------------------------------------------------------------

loc_14026B2D8:                          ; CODE XREF: sub_14026A8F0+902↑j
                mov     ecx, 8
                lea     rax, cs:140000000h
                movzx   eax, byte ptr [rbx+rax+1DAE0h]
                sub     ecx, ebx
                and     [r15], al
                inc     r15
                sub     rsi, rcx
                jmp     loc_14026B1F8
; ---------------------------------------------------------------------------

loc_14026B2FC:                          ; CODE XREF: sub_14026A8F0+9D4↑j
                                        ; sub_14026A8F0+9DD↑j
                movzx   edx, r14b
                mov     rcx, r12
                call    sub_140226960
                mov     rcx, r12
                call    sub_140231340
                jmp     short loc_14026B2CF
; ---------------------------------------------------------------------------

loc_14026B312:                          ; CODE XREF: sub_14026A8F0+196↑j
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14043FEB2

loc_14026B322:                          ; CODE XREF: sub_14026A8F0+1D55C6↓j
                                        ; sub_14026A8F0+1D55D5↓j ...
                movzx   edx, r14b
                mov     rcx, rdi
                call    sub_140329420
                mov     r8, 0FFFFF68000000000h
                jmp     loc_14026AA8C
; ---------------------------------------------------------------------------

loc_14026B33D:                          ; CODE XREF: sub_14026A8F0+275↑j
                or      [rbp+150h+var_1B0], 4
                lea     rax, [rbp+150h+var_1D0]
                mov     [rbp+150h+var_108], rax
                lea     rcx, [rbp+150h+var_1B0]
                movzx   eax, [rbp+150h+var_1AE]
                and     al, 0E7h
                mov     [rbp+150h+var_1A0], 0
                or      al, 4
                mov     [rbp+150h+var_198], rdi
                mov     [rbp+150h+var_1AE], al
                lea     rax, sub_14034E280
                mov     [rbp+150h+var_110], rax
                mov     rax, [rsp+250h+var_220]
                mov     [rbp+150h+var_1AA], al
                mov     [rbp+150h+var_190], r14
                mov     [rbp+150h+var_188], r13
                call    sub_140220490
                mov     ecx, dword ptr [rbp+150h+var_1D0]
                mov     r14, qword ptr [rbp+150h+var_1D0+8]
                mov     rdx, 0FFFFF68000000000h
                jmp     loc_14026AB96
; ---------------------------------------------------------------------------

loc_14026B39B:                          ; CODE XREF: sub_14026A8F0+2AC↑j
                mov     r13, r15
                jmp     loc_14026ABE2
; ---------------------------------------------------------------------------

loc_14026B3A3:                          ; CODE XREF: sub_14026A8F0+58D↑j
                mov     rcx, [rsp+250h+var_1F0]
                mov     dl, 2
                call    sub_140345A70
                jmp     loc_14026AE83
; ---------------------------------------------------------------------------

loc_14026B3B4:                          ; CODE XREF: sub_14026A8F0+367↑j
                mov     rax, rbx
                xor     edx, edx
                div     r9
                mov     rbx, rax
                jmp     loc_14026AC5D
; ---------------------------------------------------------------------------

loc_14026B3C4:                          ; CODE XREF: sub_14026A8F0+3DC↑j
                mov     rax, rsi
                xor     edx, edx
                div     r9
                mov     rsi, rax
                jmp     loc_14026ACD2
; } // starts at 14026A8F0
sub_14026A8F0   endp

; ---------------------------------------------------------------------------
algn_14026B3D4:                         ; DATA XREF: .rdata:000000014005C9E0↑o
                                        ; .pdata:00000001400CE01C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026B3E0   proc near               ; CODE XREF: sub_14026A8F0+35B↑p
                                        ; sub_14026BA68+67↓p ...
                mov     eax, [rcx+30h]
                lea     rdx, qword_14002DE90
                mov     ecx, eax
                shr     rcx, 12h
                and     ecx, 3
                mov     rdx, [rdx+rcx*8]
                cmp     rdx, 200h
                jnb     short loc_14026B40D
                bt      eax, 16h
                jb      short loc_14026B40D
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026B40D:                          ; CODE XREF: sub_14026B3E0+1E↑j
                                        ; sub_14026B3E0+24↑j
                mov     rax, rdx
                retn
sub_14026B3E0   endp

; ---------------------------------------------------------------------------
                align 2
algn_14026B412:                         ; DATA XREF: .pdata:00000001400CE028↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_14026B418   proc near               ; CODE XREF: sub_14065B200+17D↓p
                                        ; DATA XREF: .pdata:00000001400CE034↑o

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                mov     eax, [rdx+30h]
                and     al, 70h
                cmp     al, 10h
                jz      short loc_14026B441

loc_14026B430:                          ; CODE XREF: sub_14026B418+5F↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026B441:                          ; CODE XREF: sub_14026B418+16↑j
                mov     rdi, [rcx+690h]
                lea     rsi, [rcx+680h]
                mov     rcx, rsi
                call    sub_1402325E0
                mov     rcx, rax
                mov     rbx, rax
                call    ExAcquireSpinLockExclusive
                and     dword ptr [rbx+4], 0
                mov     dl, al
                dec     qword ptr [rdi+130h]
                mov     rcx, rsi
                call    sub_140234180
                jmp     short loc_14026B430
sub_14026B418   endp

; ---------------------------------------------------------------------------
algn_14026B479:                         ; DATA XREF: .pdata:00000001400CE034↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026B480   proc near               ; CODE XREF: sub_14065B200+34↓p
                                        ; sub_140722E24+B↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014044068A SIZE 00000053 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 20h
                mov     rax, gs:188h
                lea     r14, [rcx+38h]
                xor     ebp, ebp
                mov     r15d, edx
                mov     rbx, [rax+0B8h]
                movzx   eax, byte ptr [rbx+738h]
                and     al, 7
                cmp     al, 2
                jz      loc_14044068A
                lea     rsi, [rbx+740h]

loc_14026B4C9:                          ; CODE XREF: sub_14026B480+1D5211↓j
                mov     rdi, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140440696

loc_14026B4E4:                          ; CODE XREF: sub_14026B480+1D5218↓j
                                        ; sub_14026B480+1D5222↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                movzx   edx, dil
                mov     rcx, rsi
                jnz     short loc_14026B54D
                call    sub_140234420

loc_14026B4F9:                          ; CODE XREF: sub_14026B480+D2↓j
                mov     [rsi+4], ebp
                mov     rcx, [r14]
                test    rcx, rcx
                jnz     short loc_14026B531

loc_14026B504:                          ; CODE XREF: sub_14026B480+C9↓j
                movzx   edx, dil
                lea     rcx, [rbx+680h]
                call    sub_140234180
                mov     rbx, [rsp+38h+arg_0]
                mov     rax, rbp
                mov     rbp, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026B531:                          ; CODE XREF: sub_14026B480+82↑j
                                        ; sub_14026B480+CB↓j
                mov     rdx, [rcx]
                test    [rcx+40h], r15d
                jz      short loc_14026B554
                mov     [rcx], rbp
                mov     rbp, rcx
                mov     [r14], rdx

loc_14026B543:                          ; CODE XREF: sub_14026B480+D7↓j
                mov     rcx, rdx
                test    rdx, rdx
                jz      short loc_14026B504
                jmp     short loc_14026B531
; ---------------------------------------------------------------------------

loc_14026B54D:                          ; CODE XREF: sub_14026B480+72↑j
                call    sub_1405B5E68
                jmp     short loc_14026B4F9
; ---------------------------------------------------------------------------

loc_14026B554:                          ; CODE XREF: sub_14026B480+B8↑j
                mov     r14, rcx
                jmp     short loc_14026B543
sub_14026B480   endp

; ---------------------------------------------------------------------------
algn_14026B559:                         ; DATA XREF: .rdata:000000014005CB84↑o
                                        ; .pdata:00000001400CE040↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026B560   proc near               ; CODE XREF: sub_14065BC40+2D0↓p
                                        ; sub_14065BC40+2DB↓p ...
                shr     rcx, 9
                mov     rax, 7FFFFFFFF8h
                and     rcx, rax
                mov     rax, 0FFFFF68000000000h
                add     rax, rcx
                retn
sub_14026B560   endp

; ---------------------------------------------------------------------------
                align 20h
byte_14026B580  db 10h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE04C↑o

; =============== S U B R O U T I N E =======================================


sub_14026B590   proc near               ; CODE XREF: sub_140229EE0+354↑p
                                        ; sub_14022EF40+17D↑p ...

; FUNCTION CHUNK AT 00000001404406DE SIZE 0000001B BYTES

                mov     r9, rdx
                mov     rax, 0FFFFFFFFFh
                and     r9, rax
                mov     r10, rcx
                mov     r11, 0FFFFFFF000000000h
                cmp     r8d, 1
                jnz     short loc_14026B5C3
                mov     rax, [rcx+18h]
                and     rax, r11
                or      rax, r9
                mov     [rcx+18h], rax

locret_14026B5C1:                       ; CODE XREF: sub_14026B590+4F↓j
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026B5C3:                          ; CODE XREF: sub_14026B590+21↑j
                mov     rdx, [rcx+18h]
                mov     rcx, rdx
                mov     rax, rdx
                and     rcx, r11
                or      rcx, r9
                lock cmpxchg [r10+18h], rcx
                mov     r8, rax
                cmp     rdx, rax
                jz      short locret_14026B5C1
                jmp     loc_1404406DE
sub_14026B590   endp

; ---------------------------------------------------------------------------
byte_14026B5E6  db 6 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE058↑o

; =============== S U B R O U T I N E =======================================


sub_14026B5EC   proc near               ; CODE XREF: sub_14065BC40+5F5↓p
                                        ; sub_14065D6F0+3E5↓p ...
                mov     [rcx], rdx
                retn
sub_14026B5EC   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14026B5F1:                         ; DATA XREF: .pdata:00000001400CE064↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_14026B5F8   proc near               ; CODE XREF: sub_14026CF00+30F↓p
                                        ; sub_140297FF0+7F0↓p ...

; FUNCTION CHUNK AT 00000001404406FA SIZE 00000012 BYTES

                mov     r10, [rdx]
                mov     eax, [r10+38h]
                test    al, 20h
                jnz     short loc_14026B607

loc_14026B603:                          ; CODE XREF: sub_14026B5F8+13↓j
                                        ; sub_14026B5F8+1A↓j ...
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026B607:                          ; CODE XREF: sub_14026B5F8+9↑j
                bt      eax, 1Eh
                jb      short loc_14026B603
                bt      r8, 0Ah
                jnb     short loc_14026B603
                test    dword ptr [r10+5Ch], 0C0000h
                mov     ecx, [rcx+4]
                jnz     short loc_14026B635
                test    cl, 10h
                jz      short loc_14026B603
                test    r9, r9
                jz      short loc_14026B603
                mov     eax, 1
                mov     [r9], eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026B635:                          ; CODE XREF: sub_14026B5F8+27↑j
                test    cl, 8
                jz      short loc_14026B603
                test    byte ptr [rdx+22h], 2
                jnz     loc_1404406FA

loc_14026B644:                          ; CODE XREF: sub_14026B5F8+1D510F↓j
                test    r9, r9
                jnz     short loc_14026B650

loc_14026B649:                          ; CODE XREF: sub_14026B5F8+5C↓j
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_14026B650:                          ; CODE XREF: sub_14026B5F8+4F↑j
                and     dword ptr [r9], 0
                jmp     short loc_14026B649
sub_14026B5F8   endp

; ---------------------------------------------------------------------------
byte_14026B656  db 6 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE070↑o

; =============== S U B R O U T I N E =======================================


sub_14026B65C   proc near               ; CODE XREF: sub_14026CF00+17D↓p
                                        ; sub_14065BC40+282↓p ...
                mov     eax, [rcx+38h]
                test    al, 20h
                jnz     short loc_14026B667

loc_14026B663:                          ; CODE XREF: sub_14026B65C+17↓j
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026B667:                          ; CODE XREF: sub_14026B65C+5↑j
                mov     rax, [rcx+60h]
                test    qword ptr [rax+30h], 0FFFFFFFFFFFFFFF0h
                jz      short loc_14026B663
                mov     eax, 1
                retn
sub_14026B65C   endp

; ---------------------------------------------------------------------------
                align 4
byte_14026B67C  db 8 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE07C↑o

; =============== S U B R O U T I N E =======================================


sub_14026B684   proc near               ; CODE XREF: sub_14065B060+A1↓p
                                        ; sub_14065C460+10E↓p
                                        ; DATA XREF: ...
                sub     rcx, [rdx+10h]
                mov     [r8], rcx
                sub     rcx, [rdx+8]
                mov     [r8+8], rcx
                retn
sub_14026B684   endp

; ---------------------------------------------------------------------------
                db 0CCh
byte_14026B695  db 7 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE088↑o

; =============== S U B R O U T I N E =======================================


sub_14026B69C   proc near               ; CODE XREF: sub_1402335C0+38B↑p
                                        ; sub_14065C460+F8↓p ...

; FUNCTION CHUNK AT 000000014044070C SIZE 00000026 BYTES

                sub     rsp, 28h
                test    dword ptr [rcx+30h], 100000h
                jz      short loc_14026B6B6
                call    sub_14026B6C4
                test    eax, eax
                jnz     loc_14044070C

loc_14026B6B6:                          ; CODE XREF: sub_14026B69C+B↑j
                                        ; sub_14026B69C+1D507D↓j ...
                xor     eax, eax

loc_14026B6B8:                          ; CODE XREF: sub_14026B69C+1D5091↓j
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026B69C   endp

byte_14026B6BE  db 6 dup(0CCh)          ; DATA XREF: .rdata:000000014005CDC8↑o
                                        ; .pdata:00000001400CE094↑o

; =============== S U B R O U T I N E =======================================


sub_14026B6C4   proc near               ; CODE XREF: sub_14026B69C+D↑p
                                        ; sub_14029AEC0+67B↓p ...
                mov     eax, [rcx+30h]
                bt      eax, 14h
                jnb     short loc_14026B6E3
                bt      eax, 16h
                jb      short loc_14026B6EC
                and     eax, 0C0000h
                cmp     eax, 80000h
                jnb     short loc_14026B6EC

loc_14026B6DF:                          ; CODE XREF: sub_14026B6C4+26↓j
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026B6E3:                          ; CODE XREF: sub_14026B6C4+7↑j
                mov     eax, [rcx+40h]
                bt      eax, 18h
                jnb     short loc_14026B6DF

loc_14026B6EC:                          ; CODE XREF: sub_14026B6C4+D↑j
                                        ; sub_14026B6C4+19↑j
                mov     eax, 1
                retn
sub_14026B6C4   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14026B6F3:                         ; DATA XREF: .pdata:00000001400CE0A0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026B700   proc near               ; CODE XREF: sub_140207AA0+74↑p
                                        ; sub_140213C50+208↑p ...

var_28          = xmmword ptr -28h
var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 0000000140440732 SIZE 000000E6 BYTES

                test    rdx, rdx
                jz      locret_14026B78A
                mov     [rsp+arg_8], rbx
                push    rdi
                sub     rsp, 40h
                xor     eax, eax
                xorps   xmm0, xmm0
                mov     rdi, rdx
                mov     rbx, rcx
                movups  [rsp+48h+var_28], xmm0
                mov     [rsp+48h+var_18], rax
                cmp     [rcx+1878h], rax
                jnz     loc_140440732

loc_14026B735:                          ; CODE XREF: sub_14026B700:loc_1404407D2↓j
                lea     rax, unk_140C50C00
                cmp     rbx, rax
                jnz     short loc_14026B78C
                mov     rdx, gs:20h
                prefetchw byte ptr [rdx+8318h]
                mov     eax, [rdx+8318h]
                mov     r8d, eax
                add     rax, rdi
                cmp     rax, 100h
                ja      short loc_14026B78C

loc_14026B765:                          ; CODE XREF: sub_14026B700+1D50E4↓j
                lea     ecx, [r8+rdi]
                mov     eax, r8d
                lock cmpxchg [rdx+8318h], ecx
                movsxd  rcx, eax
                cmp     rcx, r8
                jnz     loc_1404407D7

loc_14026B780:                          ; CODE XREF: sub_14026B700+BB↓j
                                        ; sub_14026B700+1D50CC↓j ...
                mov     rbx, [rsp+48h+arg_8]
                add     rsp, 40h
                pop     rdi

locret_14026B78A:                       ; CODE XREF: sub_14026B700+3↑j
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14026B78C:                          ; CODE XREF: sub_14026B700+3F↑j
                                        ; sub_14026B700+63↑j ...
                mov     rcx, rdi
                neg     rcx
                lock xadd [rbx+1D28h], rcx
                mov     rdx, [rbx+1860h]
                cmp     rcx, rdx
                jnb     loc_1404407EF

loc_14026B7AB:                          ; CODE XREF: sub_14026B700+1D50FA↓j
                mov     rdx, [rbx+1858h]
                mov     rax, rcx
                sub     rax, rdi
                cmp     rcx, rdx
                jb      short loc_14026B780
                jmp     loc_1404407FF
sub_14026B700   endp

; ---------------------------------------------------------------------------
algn_14026B7C2:                         ; DATA XREF: .rdata:000000014005CDE8↑o
                                        ; .pdata:00000001400CE0AC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026B7D0   proc near               ; CODE XREF: sub_1402335C0+3CD↑p
                                        ; sub_1402851E0+1598↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                mov     eax, [rcx+460h]
                mov     rdi, rdx
                neg     rdi
                mov     rsi, rdx
                mov     rbx, rcx
                test    al, 10h
                jz      short loc_14026B807
                xor     r9d, r9d
                mov     r8, rcx
                mov     rdx, rdi
                lea     ecx, [r9+2]
                call    sub_1406DEE60

loc_14026B807:                          ; CODE XREF: sub_14026B7D0+23↑j
                lock xadd [rbx+648h], rdi
                mov     rdx, rsi
                mov     rcx, rbx
                call    sub_14065C5CC
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026B7D0   endp

algn_14026B82C:                         ; DATA XREF: .pdata:00000001400CE0B8↑o
                align 20h
; Exported entry 1932. PsReturnProcessNonPagedPoolQuota

; =============== S U B R O U T I N E =======================================


                public PsReturnProcessNonPagedPoolQuota
PsReturnProcessNonPagedPoolQuota proc near
                                        ; CODE XREF: sub_14026B8A4+1D503E↓p
                                        ; sub_14026B8A4+1D5078↓p ...
                sub     rsp, 28h
                cmp     rcx, cs:PsInitialSystemProcess
                mov     r9, rdx
                mov     rdx, rcx
                jz      short loc_14026B862
                mov     rcx, [rcx+568h]
                xor     r8d, r8d
                call    sub_14023BF10

loc_14026B862:                          ; CODE XREF: PsReturnProcessNonPagedPoolQuota+11↑j
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
PsReturnProcessNonPagedPoolQuota endp

algn_14026B868:                         ; DATA XREF: .pdata:00000001400CE0C4↑o
                align 10h
; Exported entry 1933. PsReturnProcessPagedPoolQuota

; =============== S U B R O U T I N E =======================================


                public PsReturnProcessPagedPoolQuota
PsReturnProcessPagedPoolQuota proc near ; CODE XREF: sub_14033E3F0+115↓p
                                        ; sub_14033E3F0+2E8↓p ...
                sub     rsp, 28h
                cmp     rcx, cs:PsInitialSystemProcess
                mov     r9, rdx
                mov     rdx, rcx
                jz      short loc_14026B895
                mov     rcx, [rcx+568h]
                mov     r8d, 1
                call    sub_14023BF10

loc_14026B895:                          ; CODE XREF: PsReturnProcessPagedPoolQuota+11↑j
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
PsReturnProcessPagedPoolQuota endp

byte_14026B89B  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE0D0↑o

; =============== S U B R O U T I N E =======================================


sub_14026B8A4   proc near               ; CODE XREF: sub_14065B470+4E7↓p
                                        ; sub_14071E2AC+82↓p ...

var_38          = qword ptr -38h
arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_20          = qword ptr  28h
arg_28          = dword ptr  30h
arg_30          = qword ptr  38h

; FUNCTION CHUNK AT 0000000140440818 SIZE 00000128 BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                push    rsi
                push    rdi
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                and     [rsp+58h+arg_0], 0
                mov     rsi, r9
                mov     eax, [rcx+30h]
                mov     r14, r8
                shl     rsi, 0Ch
                mov     rbx, r9
                or      rsi, 0FFFh
                shl     r14, 0Ch
                mov     rbp, r8
                mov     r15, rdx
                mov     rdi, rcx
                bt      eax, 14h
                jnb     short loc_14026B8F9
                bt      eax, 18h
                jb      short loc_14026B8F9
                bt      eax, 19h
                jb      loc_140440818

loc_14026B8F9:                          ; CODE XREF: sub_14026B8A4+43↑j
                                        ; sub_14026B8A4+49↑j ...
                lea     rax, [rsp+58h+arg_0]
                mov     r9, rbx
                mov     r8, rbp
                mov     [rsp+58h+var_38], rax
                mov     rdx, r15
                mov     rcx, rdi
                call    sub_14065C6E8
                test    eax, eax
                js      short loc_14026B95C
                mov     r15d, [rsp+58h+arg_0]
                xor     ebx, ebx
                mov     rbp, [rsp+58h+arg_20]
                test    r15d, r15d
                jnz     short loc_14026B974
                cmp     [rsp+58h+arg_28], ebx
                jnz     loc_140440865

loc_14026B939:                          ; CODE XREF: sub_14026B8A4+1D5007↓j
                xor     r8d, r8d
                mov     rdx, rbx
                mov     rcx, rdi
                call    sub_1402335C0

loc_14026B947:                          ; CODE XREF: sub_14026B8A4+117↓j
                mov     r9d, 8000h
                test    dword ptr cs:xmmword_140CFC480+4, r9d
                jnz     loc_140440928

loc_14026B95A:                          ; CODE XREF: sub_14026B8A4+1D5097↓j
                xor     eax, eax

loc_14026B95C:                          ; CODE XREF: sub_14026B8A4+72↑j
                                        ; sub_14026B8A4+123↓j ...
                mov     rbx, [rsp+58h+arg_8]
                mov     rbp, [rsp+58h+arg_10]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14026B974:                          ; CODE XREF: sub_14026B8A4+86↑j
                mov     eax, [rbp+464h]
                test    al, 20h
                jnz     short loc_14026B9C2
                mov     edx, 2
                mov     rcx, rdi
                call    sub_1402EBB3C
                test    rax, rax
                jnz     short loc_14026B9C9
                lea     r13d, [rdx+3Eh]
                cmp     [rsp+58h+arg_28], ebx
                jnz     loc_1404408B0

loc_14026B9A1:                          ; CODE XREF: sub_14026B8A4+1D5056↓j
                mov     r9d, r15d
                mov     [rsp+58h+var_38], rbx
                mov     r8, rsi
                mov     rdx, r14
                mov     rcx, rdi
                call    sub_1402EB044
                mov     edi, eax
                test    eax, eax
                jns     short loc_14026B947
                jmp     loc_1404408FF
; ---------------------------------------------------------------------------

loc_14026B9C2:                          ; CODE XREF: sub_14026B8A4+D8↑j
                mov     eax, 0C000010Ah
                jmp     short loc_14026B95C
; ---------------------------------------------------------------------------

loc_14026B9C9:                          ; CODE XREF: sub_14026B8A4+EA↑j
                mov     eax, 0C0000045h
                jmp     short loc_14026B95C
sub_14026B8A4   endp

; ---------------------------------------------------------------------------
byte_14026B9D0  db 8 dup(0CCh)          ; DATA XREF: .rdata:000000014005CE5C↑o
                                        ; .pdata:00000001400CE0DC↑o

; =============== S U B R O U T I N E =======================================


sub_14026B9D8   proc near               ; CODE XREF: sub_14026BB1C+61↓p
                                        ; sub_1406A11D0+9A↓p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 0000000140440940 SIZE 000000D5 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                mov     r8d, edx
                mov     rbx, rcx
                call    sub_1402685A8
                test    eax, eax
                jnz     short loc_14026B9FF
                call    sub_140269CF0
                test    eax, eax
                jnz     short loc_14026BA12

loc_14026B9FF:                          ; CODE XREF: sub_14026B9D8+1C↑j
                xor     eax, eax

loc_14026BA01:                          ; CODE XREF: sub_14026B9D8+81↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026BA12:                          ; CODE XREF: sub_14026B9D8+25↑j
                xor     esi, esi
                cmp     r8d, 1
                jz      short loc_14026BA5B
                add     rcx, 48h ; 'H'
                call    ExAcquireSpinLockExclusive
                mov     dil, al

loc_14026BA26:                          ; CODE XREF: sub_14026B9D8+86↓j
                mov     al, [rbx+3Eh]
                test    al, 2
                jnz     loc_140440940

loc_14026BA31:                          ; CODE XREF: sub_14026B9D8+1D4F90↓j
                                        ; sub_14026B9D8+1D4FC2↓j ...
                cmp     dil, 11h
                jz      short loc_14026BA56
                lea     rcx, [rbx+48h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404409AE

loc_14026BA4E:                          ; CODE XREF: sub_14026B9D8+1D4FD8↓j
                                        ; sub_14026B9D8+1D4FE4↓j ...
                movzx   ecx, dil
                mov     cr8, rcx

loc_14026BA56:                          ; CODE XREF: sub_14026B9D8+5D↑j
                mov     rax, rsi
                jmp     short loc_14026BA01
; ---------------------------------------------------------------------------

loc_14026BA5B:                          ; CODE XREF: sub_14026B9D8+40↑j
                mov     dil, 11h
                jmp     short loc_14026BA26
sub_14026B9D8   endp

; ---------------------------------------------------------------------------
byte_14026BA60  db 8 dup(0CCh)          ; DATA XREF: .rdata:000000014005CEA0↑o
                                        ; .pdata:00000001400CE0E8↑o

; =============== S U B R O U T I N E =======================================


sub_14026BA68   proc near               ; CODE XREF: sub_140279F60+2A6↓p
                                        ; sub_140286870+501↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                mov     eax, [rcx+464h]
                mov     rsi, r8
                mov     r10, rdx
                test    al, 20h
                jnz     short loc_14026BAB3
                test    r8, r8
                jnz     short loc_14026BA9C
                mov     rcx, rdx
                call    sub_14026A130
                mov     rsi, rax
                test    rax, rax
                jz      short loc_14026BAB3

loc_14026BA9C:                          ; CODE XREF: sub_14026BA68+22↑j
                mov     eax, [rsi+30h]
                mov     edx, 4
                test    dl, al
                jnz     short loc_14026BAB3
                mov     ecx, 300000h
                and     eax, ecx
                cmp     eax, ecx
                jz      short loc_14026BAC4

loc_14026BAB3:                          ; CODE XREF: sub_14026BA68+1D↑j
                                        ; sub_14026BA68+32↑j ...
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14026BAC4:                          ; CODE XREF: sub_14026BA68+49↑j
                mov     rcx, rsi
                call    sub_1402EBB3C
                mov     rdi, rax
                call    sub_14026B3E0
                mov     ecx, [rsi+18h]
                mov     r8, rax
                movzx   edx, byte ptr [rsi+20h]
                shl     rdx, 20h
                or      rdx, rcx
                shr     r10, 0Ch
                sub     r10, rdx
                mov     rcx, rsi
                mov     rax, r10
                xor     edx, edx
                div     r8
                mov     rbx, rax
                call    sub_14034282C
                mov     rcx, [rdi+10h]
                mov     dl, 2
                bts     [rcx], rbx
                mov     rcx, rsi
                call    sub_140345A70
                jmp     short loc_14026BAB3
sub_14026BA68   endp

; ---------------------------------------------------------------------------
byte_14026BB13  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE0F4↑o

; =============== S U B R O U T I N E =======================================


sub_14026BB1C   proc near               ; CODE XREF: sub_140266E30+1BA↑p
                                        ; sub_140266E30+210↑p ...

var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140440A16 SIZE 00000078 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 30h
                mov     eax, [rcx+38h]
                xor     esi, esi
                mov     rbx, rcx
                bt      eax, 8
                jb      loc_14026BC0D
                test    al, 20h
                jnz     short loc_14026BB4E
                call    sub_14026CE70
                mov     rsi, rax

loc_14026BB4E:                          ; CODE XREF: sub_14026BB1C+28↑j
                movzx   edx, word ptr [rbx+3Ch]
                mov     rcx, cs:qword_140C4E4C8
                and     edx, 3FFh
                mov     rdi, [rcx+rdx*8]
                lea     rbp, [rdi+540h]
                mov     rcx, rbp
                call    ExAcquireSpinLockExclusiveAtDpcLevel
                test    rsi, rsi
                jnz     short loc_14026BB85
                lea     edx, [rsi+1]
                mov     rcx, rbx
                call    sub_14026B9D8
                mov     rsi, rax

loc_14026BB85:                          ; CODE XREF: sub_14026BB1C+59↑j
                mov     edx, [rbx+38h]
                mov     r8d, 40000h
                bts     edx, 1Bh
                mov     [rbx+38h], edx
                mov     ecx, edx
                mov     eax, [rdi+4]
                test    al, 1
                jnz     loc_140440A16

loc_14026BBA2:                          ; CODE XREF: sub_14026BB1C+1D4EFD↓j
                                        ; sub_14026BB1C+1D4F09↓j
                lea     rax, [rbx+8]
                test    r8d, ecx
                jnz     loc_140440A2A
                lea     rcx, [rdi+6A8h]
                mov     rdx, [rcx+8]
                cmp     [rdx], rcx
                jnz     loc_140440A87
                mov     [rax], rcx
                mov     [rax+8], rdx
                mov     [rdx], rax
                mov     [rcx+8], rax

loc_14026BBD1:                          ; CODE XREF: sub_14026BB1C+1D4F39↓j
                                        ; sub_14026BB1C+1D4F66↓j
                mov     rcx, rbx
                call    sub_14026BC18
                add     [rdi+6A0h], rax
                mov     rcx, rbp
                mov     rbx, rax
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                lock xadd cs:qword_140C4C818, rbx
                mov     rax, rsi

loc_14026BBF7:                          ; CODE XREF: sub_14026BB1C+F3↓j
                mov     rbx, [rsp+38h+arg_0]
                mov     rbp, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                add     rsp, 30h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026BC0D:                          ; CODE XREF: sub_14026BB1C+20↑j
                xor     eax, eax
                jmp     short loc_14026BBF7
sub_14026BB1C   endp

; ---------------------------------------------------------------------------
algn_14026BC11:                         ; DATA XREF: .rdata:000000014005CEDC↑o
                                        ; .pdata:00000001400CE100↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_14026BC18   proc near               ; CODE XREF: sub_14026BB1C+B8↑p
                                        ; sub_14026CBB0+27↓p
                                        ; DATA XREF: ...
                mov     eax, [rcx+38h]
                test    al, 20h
                jnz     short loc_14026BC26
                mov     eax, 40h ; '@'
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026BC26:                          ; CODE XREF: sub_14026BC18+5↑j
                xor     edx, edx
                add     rcx, 80h
                jz      short loc_14026BC40

loc_14026BC31:                          ; CODE XREF: sub_14026BC18+26↓j
                mov     eax, [rcx+2Ch]
                mov     rcx, [rcx+10h]
                add     rdx, rax
                test    rcx, rcx
                jnz     short loc_14026BC31

loc_14026BC40:                          ; CODE XREF: sub_14026BC18+17↑j
                mov     rcx, rdx
                shl     rcx, 3
                cmp     rcx, 0FE0h
                ja      short loc_14026BC60
                lea     rax, [rcx+1Fh]

loc_14026BC54:                          ; CODE XREF: sub_14026BC18+66↓j
                and     rax, 0FFFFFFFFFFFFFFF0h

loc_14026BC58:                          ; CODE XREF: sub_14026BC18+75↓j
                add     rax, 0B0h
                retn
; ---------------------------------------------------------------------------
                align 20h

loc_14026BC60:                          ; CODE XREF: sub_14026BC18+36↑j
                mov     eax, edx
                shl     eax, 3
                and     eax, 0FFFh
                cmp     rcx, 10000h
                jnb     short loc_14026BC80
                cmp     eax, 0FC0h
                ja      short loc_14026BC80
                lea     rax, [rcx+0Fh]
                jmp     short loc_14026BC54
; ---------------------------------------------------------------------------

loc_14026BC80:                          ; CODE XREF: sub_14026BC18+59↑j
                                        ; sub_14026BC18+60↑j
                lea     rax, [rcx+0FFFh]
                and     rax, 0FFFFFFFFFFFFF000h
                jmp     short loc_14026BC58
sub_14026BC18   endp

; ---------------------------------------------------------------------------
byte_14026BC8F  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE10C↑o

; =============== S U B R O U T I N E =======================================


sub_14026BC98   proc near               ; CODE XREF: sub_14026712C+7D↑p
                                        ; sub_140267270+93↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140440A8E SIZE 00000021 BYTES

                mov     rax, rsp
                mov     [rax+8], rbx
                mov     [rax+10h], rbp
                mov     [rax+18h], rsi
                mov     [rax+20h], rdi
                push    r12
                push    r14
                push    r15
                sub     rsp, 20h
                mov     rax, [rcx]
                xor     esi, esi
                mov     r14d, [rcx+2Ch]
                mov     rdi, rcx
                mov     ebx, r14d
                shl     rbx, 3
                movzx   edx, word ptr [rax+3Ch]
                mov     rax, cs:qword_140C4E4C8
                and     edx, 3FFh
                mov     rbp, [rax+rdx*8]
                cmp     rbx, 0FE0h
                ja      loc_14026BDD4
                add     rbx, 1Fh

loc_14026BCEE:                          ; CODE XREF: sub_14026BC98+15B↓j
                and     rbx, 0FFFFFFFFFFFFFFF0h

loc_14026BCF2:                          ; CODE XREF: sub_14026BC98+16E↓j
                lea     r15, [rbp+540h]
                mov     rcx, r15
                call    ExAcquireSpinLockExclusiveAtDpcLevel
                or      word ptr [rdi+22h], 8
                add     [rbp+6A0h], rbx
                lock xadd cs:qword_140C4C818, rbx
                mov     rcx, [rdi]
                call    sub_1402851C0
                mov     rbx, rsi
                test    eax, eax
                jnz     short loc_14026BD35
                mov     r9d, 3FFFFFFFh
                test    [rdi+30h], r9d
                jnz     loc_140440A8E

loc_14026BD35:                          ; CODE XREF: sub_14026BC98+8B↑j
                                        ; sub_14026BC98+1D4E0B↓j
                lea     rax, [rdi+50h]
                mov     r12d, 1
                cmp     [rdi+68h], esi
                jz      short loc_14026BD9A
                lea     rcx, [rbp+6B8h]
                mov     rdx, [rcx+8]
                cmp     [rdx], rcx
                jnz     loc_140440AA8
                mov     [rax], rcx
                mov     [rax+8], rdx
                mov     [rdx], rax
                mov     [rcx+8], rax

loc_14026BD66:                          ; CODE XREF: sub_14026BC98+13A↓j
                mov     rcx, r15
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                cmp     esi, r12d
                jz      loc_14026BE0B

loc_14026BD77:                          ; CODE XREF: sub_14026BC98+184↓j
                mov     rbp, [rsp+38h+arg_8]
                mov     rax, rbx
                mov     rbx, [rsp+38h+arg_0]
                mov     rsi, [rsp+38h+arg_10]
                mov     rdi, [rsp+38h+arg_18]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     r12
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026BD9A:                          ; CODE XREF: sub_14026BC98+AA↑j
                lea     rcx, [rbp+6C8h]
                mov     rdx, [rcx+8]
                cmp     [rdx], rcx
                jnz     loc_140440AA8
                mov     [rax], rcx
                mov     [rax+8], rdx
                mov     [rdx], rax
                mov     [rcx+8], rax
                add     [rbp+590h], r14
                cmp     qword ptr [rbp+590h], 20000h
                cmovnb  esi, r12d
                jmp     short loc_14026BD66
; ---------------------------------------------------------------------------

loc_14026BDD4:                          ; CODE XREF: sub_14026BC98+4C↑j
                mov     eax, r14d
                shl     eax, 3
                and     eax, 0FFFh
                cmp     rbx, 10000h
                jnb     short loc_14026BDF8
                cmp     eax, 0FC0h
                ja      short loc_14026BDF8
                add     rbx, 0Fh
                jmp     loc_14026BCEE
; ---------------------------------------------------------------------------

loc_14026BDF8:                          ; CODE XREF: sub_14026BC98+14E↑j
                                        ; sub_14026BC98+155↑j
                add     rbx, 0FFFh
                and     rbx, 0FFFFFFFFFFFFF000h
                jmp     loc_14026BCF2
; ---------------------------------------------------------------------------

loc_14026BE0B:                          ; CODE XREF: sub_14026BC98+D9↑j
                lea     rcx, [rbp+560h]
                xor     r8d, r8d
                xor     edx, edx
                call    KeSetEvent
                jmp     loc_14026BD77
sub_14026BC98   endp

; ---------------------------------------------------------------------------
algn_14026BE21:                         ; DATA XREF: .rdata:000000014005CF0C↑o
                                        ; .pdata:00000001400CE118↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026BE30   proc near               ; CODE XREF: sub_14022ACA0+617↑p
                                        ; sub_1402E42D0+14F↓p
                                        ; DATA XREF: ...

var_128         = dword ptr -128h
var_124         = dword ptr -124h
var_120         = dword ptr -120h
var_118         = qword ptr -118h
var_110         = qword ptr -110h
var_108         = qword ptr -108h
var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_D8          = xmmword ptr -0D8h
var_C8          = xmmword ptr -0C8h
var_B8          = xmmword ptr -0B8h
var_A8          = xmmword ptr -0A8h
var_98          = xmmword ptr -98h
var_88          = xmmword ptr -88h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_18          = qword ptr  20h

; __unwind { // __GSHandlerCheck
                mov     r11, rsp
                push    rbp
                push    r12
                sub     rsp, 138h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+148h+var_48], rax
                mov     eax, [rcx+4]
                xorps   xmm0, xmm0
                mov     [rsp+148h+var_124], r8d
                mov     rbp, rcx
                movsxd  r12, edx
                movups  [rsp+148h+var_D8], xmm0
                movups  [rsp+148h+var_C8], xmm0
                movups  [rsp+148h+var_B8], xmm0
                movups  [rsp+148h+var_A8], xmm0
                movups  [rsp+148h+var_98], xmm0
                movups  [rsp+148h+var_88], xmm0
                movups  xmmword ptr [r11-78h], xmm0
                movups  xmmword ptr [r11-68h], xmm0
                movups  xmmword ptr [r11-58h], xmm0
                test    al, 20h
                jnz     loc_14026C3AF
                mov     rcx, [rcx+r12*8+1068h]
; } // starts at 14026BE30

loc_14026BEAC:                          ; DATA XREF: .rdata:000000014005CF58↑o
                                        ; .rdata:000000014005CF74↑o ...
; __unwind { // __GSHandlerCheck
                mov     [r11-20h], rdi
                mov     eax, r8d
                shl     rax, 4
                mov     [rsp+148h+var_100], rax
                mov     [rsp+148h+var_F8], rcx
                mov     [r11-28h], r13
                movzx   eax, word ptr [rax+rcx]
                mov     ecx, [rbp+189Ch]
                mov     edi, r8d
                cmp     rax, rcx
                jnb     loc_14026C39F
; } // starts at 14026BEAC

loc_14026BEDB:                          ; DATA XREF: .rdata:000000014005CF74↑o
                                        ; .rdata:000000014005CF88↑o ...
; __unwind { // __GSHandlerCheck
                mov     [r11+20h], rbx
                movsxd  rbx, ecx
                movzx   ecx, cs:byte_140C4DD0C
                sub     rbx, rax
                mov     [r11-18h], rsi
                mov     eax, edi
                shr     rax, cl
                movzx   ecx, cs:byte_140C4DD0D
                imul    r9, rax, 11C0h
                mov     eax, r8d
                mov     [r11-30h], r14
                add     r9, [rbp+10h]
                lea     rsi, [rbx+40h]
                shr     eax, cl
                movzx   ecx, ax
                movzx   eax, cs:byte_140CFC53C
                and     ecx, eax
                mov     [rsp+148h+var_E8], r9
                test    edx, edx
                mov     [rsp+148h+var_120], ecx
                mov     edx, ecx
                mov     rcx, r9
                jnz     short loc_14026BF68
                mov     r14, [rbp+880h]
                lea     rax, [rbp+8C0h]
                mov     r8d, 1002h
                mov     [rsp+148h+var_108], rax
                call    sub_14026C3D4
                cmp     rax, rsi
                jb      loc_14026C387
                cmp     byte ptr [rbp+12DDh], 1
                jz      loc_14026C387
                jmp     short loc_14026BF8F
; ---------------------------------------------------------------------------

loc_14026BF68:                          ; CODE XREF: sub_14026BE30+100↑j
                mov     r14, [rbp+888h]
                lea     rax, [rbp+900h]
                mov     r8d, 1000h
                mov     [rsp+148h+var_108], rax
                call    sub_14026C3D4
                cmp     rax, rsi
                jb      loc_14026C387

loc_14026BF8F:                          ; CODE XREF: sub_14026BE30+136↑j
                lea     rax, [rdi+rdi*4]
; } // starts at 14026BEDB

loc_14026BF93:                          ; DATA XREF: .rdata:000000014005CF88↑o
                                        ; .rdata:000000014005CF98↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+148h+var_38], r15
                mov     r15, [r14+rax*8]
                lea     rdi, [r14+rax*8]
                mov     rax, [rbp+1BC0h]
                cmp     rbx, r15
                mov     [rsp+148h+var_118], rdi
                cmovbe  r15, rbx
                sub     rax, r15
                cmp     rax, 420h
                jb      loc_14026C37F
                mov     eax, cs:dword_140CFC41C
                xor     r9d, r9d
                and     eax, 200000h
                mov     dword ptr [rsp+148h+var_D8+8], 10h
                mov     r8d, 420h
                mov     [rsp+148h+var_128], eax
                mov     rdx, r15
                mov     rcx, rbp
                xor     esi, esi
                call    sub_14026CAB0
                test    eax, eax
                jz      loc_14026C36F
                mov     rdi, [rdi+10h]
                mov     r9, 0FFFFFA8000000000h
                lea     rbx, [rdi+rdi*2]
                shl     rbx, 4
                mov     rax, r9
                add     rbx, rax
                mov     [rsp+148h+var_110], r15
                xor     r14d, r14d
                mov     [rsp+148h+var_F0], rbx
                mov     r10, 2AAAAAAAAAAAAAABh
                nop     dword ptr [rax]

loc_14026C030:                          ; CODE XREF: sub_14026BE30+45D↓j
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      loc_14026C295
                mov     r14, rbx
                test    r12d, r12d
                jnz     short loc_14026C0A3
                mov     eax, cs:dword_140CFC400
                test    al, al
                jns     short loc_14026C0A3
                mov     eax, cs:dword_140C4E64C
                inc     eax
                test    cs:dword_140CFB028, eax
                mov     cs:dword_140C4E64C, eax
                jnz     short loc_14026C0A3
                mov     rax, r9
                mov     rcx, rbx
                sub     rcx, rax
                mov     rax, r10
                imul    rcx
                mov     rcx, rdx
                lea     edx, [r12+1]
                sar     rcx, 3
                mov     rax, rcx
                shr     rax, 3Fh
                add     rcx, rax
                call    sub_14054ED98
                mov     r9, 0FFFFFA8000000000h
                mov     r10, 2AAAAAAAAAAAAAABh

loc_14026C0A3:                          ; CODE XREF: sub_14026BE30+213↑j
                                        ; sub_14026BE30+21D↑j ...
                cmp     cs:dword_140C4E54C, 1
                jnz     loc_14026C174
                mov     r8d, 1
                mov     rax, r9
                mov     rcx, rbx
                sub     rcx, rax
                mov     rax, r10
                imul    rcx
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                mov     rax, cs:qword_140C4E5A8
                mov     r9, rdx
                mov     rcx, rdx
                shr     rcx, 5
                and     r9d, 1Fh
                lea     rax, [rax+rcx*4]
                lea     rcx, [r9+1]
                cmp     rcx, 20h ; ' '
                ja      short loc_14026C100
                mov     ecx, r9d
                mov     edx, r8d
                shl     edx, cl
                jmp     short loc_14026C171
; ---------------------------------------------------------------------------

loc_14026C100:                          ; CODE XREF: sub_14026BE30+2C4↑j
                test    r9, r9
                jz      short loc_14026C165
                and     edx, 1Fh
                mov     r8d, 20h ; ' '
                sub     r8d, edx
                mov     edx, 1
                mov     ecx, r8d
                shl     edx, cl
                mov     rcx, r9
                dec     edx
                shl     edx, cl
                lock or [rax], edx
                mov     ecx, r8d
                add     rax, 4
                mov     r8d, 1
                sub     r8, rcx
                cmp     r8, 20h ; ' '
                jb      short loc_14026C160
                mov     rdx, r8
                shr     rdx, 5
                imul    rcx, rdx, -20h
                add     r8, rcx
                nop     dword ptr [rax+00000000h]

loc_14026C150:                          ; CODE XREF: sub_14026BE30+32E↓j
                mov     dword ptr [rax], 0FFFFFFFFh
                add     rax, 4
                sub     rdx, 1
                jnz     short loc_14026C150

loc_14026C160:                          ; CODE XREF: sub_14026BE30+309↑j
                test    r8, r8
                jz      short loc_14026C174

loc_14026C165:                          ; CODE XREF: sub_14026BE30+2D3↑j
                mov     rcx, r8
                mov     edx, 1
                shl     edx, cl
                dec     edx

loc_14026C171:                          ; CODE XREF: sub_14026BE30+2CE↑j
                lock or [rax], edx

loc_14026C174:                          ; CODE XREF: sub_14026BE30+27A↑j
                                        ; sub_14026BE30+333↑j
                movzx   eax, byte ptr [rbx+22h]
                and     al, 0FDh
                or      al, 5
                mov     [rbx+22h], al
                test    byte ptr [rbx+22h], 8
                jz      short loc_14026C192
                mov     edx, 1
                mov     rcx, rbx
                call    sub_14034A3CC

loc_14026C192:                          ; CODE XREF: sub_14026BE30+353↑j
                mov     rax, 0FFFFFFF000000000h
                and     [rbx+18h], rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rax
                cmp     [rsp+148h+var_128], 0
                jz      short loc_14026C1E3
                mov     rcx, rbx
                call    sub_1402D9B30
                test    eax, eax
                jz      short loc_14026C1E3
                mov     edx, dword ptr [rsp+148h+var_D8+4]
                cmp     edx, 10h
                jnb     short loc_14026C1E7
                shl     rdi, 0Ch
                mov     qword ptr [rsp+rdx*8+148h+var_C8], rdi
                mov     edx, dword ptr [rsp+148h+var_D8+4]
                inc     edx
                mov     dword ptr [rsp+148h+var_D8+4], edx
                jmp     short loc_14026C1E7
; ---------------------------------------------------------------------------

loc_14026C1E3:                          ; CODE XREF: sub_14026BE30+384↑j
                                        ; sub_14026BE30+390↑j
                mov     edx, dword ptr [rsp+148h+var_D8+4]

loc_14026C1E7:                          ; CODE XREF: sub_14026BE30+399↑j
                                        ; sub_14026BE30+3B1↑j
                mov     rdi, [rbx]
                mov     r8, 0FFFFFFFFFh
                and     rdi, r8
                mov     r9, 0FFFFFA8000000000h
                cmp     rdi, r8
                jz      short loc_14026C216
                lea     rbx, [rdi+rdi*2]
                shl     rbx, 4
                mov     rax, r9
                add     rbx, rax
                jmp     short loc_14026C218
; ---------------------------------------------------------------------------

loc_14026C216:                          ; CODE XREF: sub_14026BE30+3D4↑j
                xor     ebx, ebx

loc_14026C218:                          ; CODE XREF: sub_14026BE30+3E4↑j
                mov     rax, r12
                shl     rax, 0Ch
                xor     eax, [r14+10h]
                and     eax, 0F000h
                xor     rax, [r14+10h]
                jz      short loc_14026C24A
                mov     rcx, cs:qword_140C4DDC0
                test    rcx, rcx
                jz      short loc_14026C24A
                test    al, 10h
                jnz     short loc_14026C246
                not     rcx
                and     rax, rcx
                jmp     short loc_14026C24A
; ---------------------------------------------------------------------------

loc_14026C246:                          ; CODE XREF: sub_14026BE30+40C↑j
                and     rax, 0FFFFFFFFFFFFFFEFh

loc_14026C24A:                          ; CODE XREF: sub_14026BE30+3FC↑j
                                        ; sub_14026BE30+408↑j ...
                mov     ecx, eax
                mov     rax, 0FFFFFFFE00000000h
                or      rcx, rax
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14026C273
                test    rcx, rax
                jnz     short loc_14026C26F
                or      rcx, rax
                jmp     short loc_14026C273
; ---------------------------------------------------------------------------

loc_14026C26F:                          ; CODE XREF: sub_14026BE30+438↑j
                or      rcx, 10h

loc_14026C273:                          ; CODE XREF: sub_14026BE30+433↑j
                                        ; sub_14026BE30+43D↑j
                inc     rsi
                mov     [r14+10h], rcx
                sub     [rsp+148h+var_110], 1
                mov     r10, 2AAAAAAAAAAAAAABh
                mov     [r14], rbx
                jnz     loc_14026C030
                jmp     short loc_14026C299
; ---------------------------------------------------------------------------

loc_14026C295:                          ; CODE XREF: sub_14026BE30+207↑j
                mov     edx, dword ptr [rsp+148h+var_D8+4]

loc_14026C299:                          ; CODE XREF: sub_14026BE30+463↑j
                sub     r15, rsi
                test    rsi, rsi
                jz      loc_14026C36F
                test    edx, edx
                jz      short loc_14026C2BB
                lea     rcx, [rsp+148h+var_D8]
                mov     dword ptr [rsp+148h+var_D8], 1
                call    sub_14055FFC4

loc_14026C2BB:                          ; CODE XREF: sub_14026BE30+477↑j
                mov     rax, [rsp+148h+var_118]
                mov     [rax+10h], rdi
                mov     rax, 0FFFFFFFFFh
                cmp     rdi, rax
                jz      short loc_14026C2E3
                xor     r8d, r8d
                mov     rdx, rax
                mov     rcx, rbx
                call    sub_14026B590
                jmp     short loc_14026C309
; ---------------------------------------------------------------------------

loc_14026C2E3:                          ; CODE XREF: sub_14026BE30+4A1↑j
                mov     r8d, [rsp+148h+var_124]
                xor     r9d, r9d
                mov     edx, r12d
                mov     rcx, rbp
                call    sub_140350174
                mov     rax, [rsp+148h+var_118]
                mov     rcx, 0FFFFFFFFFh
                mov     [rax+18h], rcx

loc_14026C309:                          ; CODE XREF: sub_14026BE30+4B1↑j
                mov     rcx, [rsp+148h+var_F8]
                mov     r9d, esi
                add     rcx, [rsp+148h+var_100]
                mov     r8, r14
                mov     rdx, [rsp+148h+var_F0]
                call    InterlockedPushListSList
                mov     rax, [rsp+148h+var_118]
                mov     rcx, [rsp+148h+var_108]
                sub     [rax], rsi
                neg     rsi
                mov     rax, rsi
                lock xadd [rcx], rax
                mov     rcx, [rsp+148h+var_E8]
                mov     rax, rsi
                lock xadd [rcx+r12*8+1020h], rax
                cmp     cs:dword_140CFB004, 1
                jbe     short loc_14026C36F
                mov     eax, [rsp+148h+var_120]
                lea     r8, ds:0[rax*2]
                add     r8, r12
                lock xadd [rcx+r8*8+1078h], rsi

loc_14026C36F:                          ; CODE XREF: sub_14026BE30+1C4↑j
                                        ; sub_14026BE30+46F↑j ...
                test    r15, r15
                jz      short loc_14026C37F
                mov     rdx, r15
                mov     rcx, rbp
                call    sub_1403214D0

loc_14026C37F:                          ; CODE XREF: sub_14026BE30+18F↑j
                                        ; sub_14026BE30+542↑j
                mov     r15, [rsp+148h+var_38]
; } // starts at 14026BF93

loc_14026C387:                          ; CODE XREF: sub_14026BE30+123↑j
                                        ; sub_14026BE30+130↑j ...
; __unwind { // __GSHandlerCheck
                mov     rbx, [rsp+148h+arg_18]
                mov     rsi, [rsp+148h+var_18]
                mov     r14, [rsp+148h+var_30]
; } // starts at 14026C387

loc_14026C39F:                          ; CODE XREF: sub_14026BE30+A5↑j
                                        ; DATA XREF: .pdata:00000001400CE154↑o ...
; __unwind { // __GSHandlerCheck
                mov     rdi, [rsp+148h+var_20]
                mov     r13, [rsp+148h+var_28]
; } // starts at 14026C39F

loc_14026C3AF:                          ; CODE XREF: sub_14026BE30+6E↑j
                                        ; DATA XREF: .pdata:00000001400CE160↑o ...
; __unwind { // __GSHandlerCheck
                mov     rcx, [rsp+148h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 138h
                pop     r12
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 14026C3AF
sub_14026BE30   endp

byte_14026C3CB  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE16C↑o

; =============== S U B R O U T I N E =======================================


sub_14026C3D4   proc near               ; CODE XREF: sub_1402142FC+13E↑p
                                        ; sub_14026BE30+11B↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140440AB0 SIZE 00000014 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 20h
                mov     edi, r8d
                mov     r13d, edx
                not     edi
                lea     rsi, [rcx+1020h]
                shr     rdi, 1
                mov     r15d, r8d
                and     edi, 1
                xor     r9d, r9d
                xor     ebp, ebp
                xor     ebx, ebx
                and     r15d, 1000h
                mov     r14, rcx

loc_14026C419:                          ; CODE XREF: sub_14026C3D4+6F↓j
                cmp     cs:dword_140CFB004, 1
                ja      loc_140440AB0
                mov     rax, rsi

loc_14026C429:                          ; CODE XREF: sub_14026C3D4+1D46EB↓j
                mov     rax, [rax]
                add     r9, rax
                mov     r12, r9
                test    r15d, r15d
                jnz     short loc_14026C466

loc_14026C437:                          ; CODE XREF: sub_14026C3D4+A4↓j
                inc     ebp
                inc     rbx
                add     rsi, 8
                cmp     rbx, rdi
                jle     short loc_14026C419
                mov     rbx, [rsp+48h+arg_0]
                mov     rax, r9
                mov     rbp, [rsp+48h+arg_8]
                mov     rsi, [rsp+48h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026C466:                          ; CODE XREF: sub_14026C3D4+61↑j
                mov     r8d, ebp
                mov     edx, r13d
                mov     rcx, r14
                call    sub_14026C570
                lea     r9, [r12+rax]
                jmp     short loc_14026C437
sub_14026C3D4   endp

; ---------------------------------------------------------------------------
algn_14026C47A:                         ; DATA XREF: .rdata:000000014005CFEC↑o
                                        ; .pdata:00000001400CE178↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026C480   proc near               ; CODE XREF: sub_14022ACA0+3B9↑p
                                        ; DATA XREF: .rdata:000000014005D018↑o ...

var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140440AC4 SIZE 00000166 BYTES

                mov     [rsp+arg_18], rbx
                mov     [rsp+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 40h
                mov     r12d, cs:dword_140CFB004
                mov     r8d, edx
                mov     rdx, rcx
                xor     eax, eax
                movzx   ecx, cs:byte_140C4DD0C
                mov     ebx, r8d
                shr     ebx, cl
                xorps   xmm0, xmm0
                mov     [rsp+78h+var_48], rax
                mov     eax, ebx
                imul    r13, rax, 11C0h
                movups  [rsp+78h+var_58], xmm0
                mov     [rsp+78h+arg_10], ebx
                add     r13, [rdx+10h]
                xor     edx, edx
                mov     [rsp+78h+arg_8], edx
                cmp     r12d, 1
                ja      loc_140440AC4

loc_14026C4E8:                          ; CODE XREF: sub_14026C480+1D4664↓j
                mov     ebx, [rsp+78h+arg_8]
                lea     rdi, [r13+1020h]
                mov     rax, rdx
                mov     r15d, edx
                mov     r14, rdx

loc_14026C4FF:                          ; CODE XREF: sub_14026C480+B0↓j
                mov     rbp, rax
                cmp     r12d, 1
                ja      loc_140440AE9
                mov     rsi, [rdi]

loc_14026C50F:                          ; CODE XREF: sub_14026C480+1D4675↓j
                mov     r8d, r15d
                mov     edx, ebx
                mov     rcx, r13
                call    sub_14026C570
                add     rax, rbp
                inc     r15d
                add     rax, rsi
                inc     r14
                add     rdi, 8
                cmp     r14, 1
                jle     short loc_14026C4FF
                mov     ebx, [rsp+78h+arg_10]
                cmp     rax, 200h
                jb      loc_140440AFA

loc_14026C545:                          ; CODE XREF: sub_14026C480+1D469A↓j
                                        ; sub_14026C480+1D46A8↓j ...
                mov     rbx, [rsp+78h+arg_18]
                add     rsp, 40h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026C480   endp

byte_14026C55E  db 12h dup(0CCh)        ; DATA XREF: .rdata:000000014005D018↑o
                                        ; .pdata:00000001400CE184↑o

; =============== S U B R O U T I N E =======================================


sub_14026C570   proc near               ; CODE XREF: sub_1402142FC+169↑p
                                        ; sub_14026C3D4+9B↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r14
                push    r15
                xor     ebp, ebp
                movsxd  rbx, r8d
                mov     r15d, edx
                lea     rsi, qword_14001A848
                mov     rdi, rcx
                mov     r11d, ebp
                mov     r9, rcx
                mov     r10, rbx
                lea     r14d, [rbp+3]

loc_14026C5A7:                          ; CODE XREF: sub_14026C570+BF↓j
                mov     r8, [rsi]
                cmp     r15d, 4
                jnz     short loc_14026C5CE
                cmp     ebx, 2
                jnz     short loc_14026C5C1
                mov     rax, [r9+8]
                mov     r10, rbx
                add     rax, [r9]
                jmp     short loc_14026C612
; ---------------------------------------------------------------------------

loc_14026C5C1:                          ; CODE XREF: sub_14026C570+43↑j
                lea     rax, [r11+rbx]
                mov     r10, rbx
                mov     rax, [rdi+rax*8]
                jmp     short loc_14026C612
; ---------------------------------------------------------------------------

loc_14026C5CE:                          ; CODE XREF: sub_14026C570+3E↑j
                lea     rcx, [r15+r10*4]
                lea     rdx, [r11+rcx*4]
                lea     rax, [r11+rcx*4]
                mov     rax, [rdi+rax*8+140h]
                lea     rcx, [r11+rcx*4]
                add     rax, [rdi+rcx*8+40h]
                add     rax, [rdi+rdx*8+148h]
                add     rax, [rdi+rdx*8+138h]
                add     rax, [rdi+rdx*8+130h]
                add     rax, [rdi+rdx*8+48h]
                add     rax, [rdi+rdx*8+38h]
                add     rax, [rdi+rdx*8+30h]

loc_14026C612:                          ; CODE XREF: sub_14026C570+4F↑j
                                        ; sub_14026C570+5C↑j
                imul    r8, rax
                add     rsi, 8
                add     r9, 430h
                add     rbp, r8
                add     r11, 86h
                sub     r14, 1
                jnz     loc_14026C5A7
                mov     rbx, [rsp+10h+arg_0]
                mov     rax, rbp
                mov     rbp, [rsp+10h+arg_8]
                mov     rsi, [rsp+10h+arg_10]
                mov     rdi, [rsp+10h+arg_18]
                pop     r15
                pop     r14
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026C570   endp

algn_14026C652:                         ; DATA XREF: .pdata:00000001400CE190↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026C660   proc near               ; CODE XREF: sub_140321A78+34C↓p
                                        ; sub_1403F5468+111↓p ...

var_38          = qword ptr -38h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_18          = dword ptr  20h
arg_20          = byte ptr  28h

                mov     [rsp+arg_18], r9d
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r15
                sub     rsp, 28h
                mov     r10, [rdx+28h]
                xor     r9d, r9d
                mov     rax, cs:qword_140C4E4C8
                mov     rbx, rdx
                shr     r10, 27h
                mov     rsi, rcx
                mov     r15d, r8d
                and     r10d, 3FFh
                mov     r12d, r8d
                lea     r8, [r9-1]
                mov     rbp, [rax+r10*8]
                lea     rax, cs:140000000h
                mov     rdi, ds:rva qword_14001A848[rax+r15*8]
                mov     rcx, rbp
                mov     rdx, rdi
                call    sub_14026CAB0
                test    [rsp+58h+arg_20], 8
                jnz     short loc_14026C6E1
                test    eax, eax
                jnz     short loc_14026C6E1
                mov     rdx, rdi
                mov     rcx, rbp
                call    sub_1403214D0
                xor     eax, eax
                add     rsp, 28h
                pop     r15
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026C6E1:                          ; CODE XREF: sub_14026C660+60↑j
                                        ; sub_14026C660+64↑j
                mov     rax, [rbx]
                cmp     [rax+8], rbx
                jnz     loc_14026CA9C
                mov     rcx, [rbx+8]
                cmp     [rcx], rbx
                jnz     loc_14026CA9C
                mov     [rcx], rax
                mov     [rax+8], rcx
                movzx   r8d, byte ptr [rbx+22h]

loc_14026C707:                          ; DATA XREF: .rdata:000000014005D060↑o
                                        ; .rdata:000000014005D074↑o ...
                mov     [rsp+58h+arg_0], r13

loc_14026C70C:                          ; DATA XREF: .rdata:000000014005D074↑o
                                        ; .rdata:000000014005D088↑o ...
                mov     [rsp+58h+var_38], r14
                test    r8b, 8
                jz      short loc_14026C732
                mov     edx, 1
                mov     rcx, rbx
                call    sub_14034A3CC
                lea     rcx, [rbx+10h]
                call    sub_14027C660
                movzx   r8d, byte ptr [rbx+22h]

loc_14026C732:                          ; CODE XREF: sub_14026C660+B5↑j
                mov     rax, 0FFFFFA8000000000h
                mov     rcx, rbx
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rcx, rsi
                sub     rcx, [rbp+10h]
                mov     r11, rdx
                sar     r11, 3
                mov     rax, r11
                shr     rax, 3Fh
                add     r11, rax
                mov     rax, 73615A240E6C2B45h
                imul    rcx
                mov     ecx, 4
                mov     r13, rdx
                sar     r13, 0Bh
                imul    rdx, r12, 86h
                mov     rax, r13
                shr     rax, 3Fh
                add     r13, rax
                movzx   eax, r8b
                and     eax, 7
                mov     r14d, eax
                add     rax, rdx
                dec     qword ptr [rsi+rax*8]
                mov     eax, 2
                cmp     r11, 100000h
                cmovb   eax, ecx
                add     rax, r14
                imul    rcx, r12, 86h
                add     rcx, rax
                lea     rax, [r11+r11*2]
                add     rax, rax
                dec     qword ptr [rsi+rcx*8]
                mov     rcx, 0FFFFFA8000000028h
                mov     rcx, [rcx+rax*8]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rax, [rax+rcx*8]
                cmp     byte ptr [rax+12DEh], 0
                jz      short loc_14026C82D
                cmp     r15d, 2
                jnz     short loc_14026C80E
                mov     rax, [rax+13F0h]
                mov     rcx, r11
                shr     rcx, 9
                dec     byte ptr [rax+rcx]
                jmp     short loc_14026C82D
; ---------------------------------------------------------------------------

loc_14026C80E:                          ; CODE XREF: sub_14026C660+199↑j
                cmp     r15d, 1
                jnz     short loc_14026C82D
                mov     rax, [rax+1408h]
                mov     rcx, r11
                shr     rcx, 12h
                mov     r8d, 0FFFFh
                add     [rax+rcx*2], r8w

loc_14026C82D:                          ; CODE XREF: sub_14026C660+193↑j
                                        ; sub_14026C660+1AC↑j ...
                mov     eax, [rsp+58h+arg_18]
                lea     r15, cs:140000000h
                movzx   r8d, byte ptr [rbx+22h]
                cmp     r11, 100000h
                sbb     rcx, rcx
                shr     r8, 6
                and     ecx, 2
                add     rcx, r14
                lea     rcx, [rax+rcx*4]
                mov     rax, r11
                lea     r10, [rdx+rcx*4]
                mov     ecx, rva dword_140C4DE00[r15+r12*4]
                xor     edx, edx
                lea     r9, [r8+r10]
                div     ds:rva qword_14001A848[r15+r12*8]
                xor     edx, edx
                div     rcx
                mov     eax, edx
                mov     edx, 900h
                lea     rcx, [rax+rax*2]
                mov     rax, [rsi+r9*8+230h]
                dec     qword ptr [rax+rcx*8+10h]
                lea     rax, [r8+r10]
                mov     rcx, [rsi+rax*8+30h]
                mov     eax, 8C0h
                dec     rcx
                mov     [rsi+r9*8+30h], rcx
                mov     rcx, rdi
                neg     rcx
                test    r14d, r14d
                cmovnz  eax, edx
                lock xadd [rax+rbp], rcx
                cmp     cs:dword_140C4E54C, 1
                jnz     loc_14026C984
                mov     rax, cs:qword_140C4E5A8
                mov     r10, r11
                and     r10d, 1Fh
                mov     rcx, r11
                shr     rcx, 5
                mov     r9, rdi
                lea     rax, [rax+rcx*4]
                lea     rcx, [r10+rdi]
                cmp     rcx, 20h ; ' '
                ja      short loc_14026C90E
                cmp     rdi, 20h ; ' '
                jnz     short loc_14026C8FB
                mov     dword ptr [rax], 0FFFFFFFFh
                jmp     loc_14026C984
; ---------------------------------------------------------------------------

loc_14026C8FB:                          ; CODE XREF: sub_14026C660+28E↑j
                mov     rcx, rdi
                mov     edx, 1
                shl     edx, cl
                mov     rcx, r10
                dec     edx
                shl     edx, cl
                jmp     short loc_14026C981
; ---------------------------------------------------------------------------

loc_14026C90E:                          ; CODE XREF: sub_14026C660+288↑j
                test    r10, r10
                jz      short loc_14026C940
                mov     ecx, r11d
                mov     r8d, 20h ; ' '
                and     ecx, 1Fh
                mov     edx, 1
                sub     r8d, ecx
                mov     ecx, r8d
                shl     edx, cl
                mov     rcx, r10
                dec     edx
                shl     edx, cl
                lock or [rax], edx
                mov     ecx, r8d
                sub     r9, rcx
                add     rax, 4

loc_14026C940:                          ; CODE XREF: sub_14026C660+2B1↑j
                cmp     r9, 20h ; ' '
                jb      short loc_14026C970
                mov     r8, r9
                shr     r8, 5
                imul    rdx, r8, -20h
                add     r9, rdx
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_14026C960:                          ; CODE XREF: sub_14026C660+30E↓j
                mov     dword ptr [rax], 0FFFFFFFFh
                add     rax, 4
                sub     r8, 1
                jnz     short loc_14026C960

loc_14026C970:                          ; CODE XREF: sub_14026C660+2E4↑j
                test    r9, r9
                jz      short loc_14026C984
                mov     rcx, r9
                mov     edx, 1
                shl     edx, cl
                dec     edx

loc_14026C981:                          ; CODE XREF: sub_14026C660+2AC↑j
                lock or [rax], edx

loc_14026C984:                          ; CODE XREF: sub_14026C660+25E↑j
                                        ; sub_14026C660+296↑j ...
                test    r14d, r14d
                jnz     short loc_14026C9C5
                cmp     byte ptr [rbp+12DDh], 1
                jnz     short loc_14026C99A
                mov     r14d, 1
                jmp     short loc_14026C9C5
; ---------------------------------------------------------------------------

loc_14026C99A:                          ; CODE XREF: sub_14026C660+330↑j
                mov     eax, cs:dword_140CFC400
                test    al, al
                jns     short loc_14026C9C5
                mov     eax, cs:dword_140C4E64C
                inc     eax
                test    cs:dword_140CFB028, eax
                mov     cs:dword_140C4E64C, eax
                jnz     short loc_14026C9C5
                mov     rdx, rdi
                mov     rcx, r11
                call    sub_14054ED98

loc_14026C9C5:                          ; CODE XREF: sub_14026C660+327↑j
                                        ; sub_14026C660+338↑j ...
                mov     edx, 5
                mov     rcx, rbx
                call    sub_14027C630
                mov     rcx, cs:qword_14001D278
                cmp     r14d, 1
                mov     r14, [rsp+58h+var_38]
                mov     [rsp+58h+arg_8], rcx
                jnz     short loc_14026C9F8

loc_14026C9E9:                          ; DATA XREF: .pdata:00000001400CE1B4↑o
                                        ; .pdata:00000001400CE1C0↑o
                lea     rcx, [rsp+58h+arg_8]
                call    sub_14027C660
                mov     rcx, [rsp+58h+arg_8]

loc_14026C9F8:                          ; CODE XREF: sub_14026C660+387↑j
                mov     rdx, cs:qword_140C4DDC0
                mov     rax, [rbx+10h]
                test    rdx, rdx
                jz      short loc_14026CA12
                test    al, 10h
                jnz     short loc_14026CA12
                not     rdx
                and     rax, rdx

loc_14026CA12:                          ; CODE XREF: sub_14026C660+3A6↑j
                                        ; sub_14026C660+3AA↑j
                shr     rax, 20h
                mov     edx, 0FFFFFFFDh
                mov     [rbx+10h], rcx
                cmp     rax, rdx
                jnz     short loc_14026CA2D
                call    sub_1402C98B0
                mov     [rbx+10h], rax

loc_14026CA2D:                          ; CODE XREF: sub_14026C660+3C2↑j
                cmp     rdi, 10h
                jnz     short loc_14026CA84
                mov     rcx, [rsi+8]
                add     rcx, [rsi]
                shl     rcx, 9
                add     rcx, [rsi+438h]
                add     rcx, [rsi+430h]
                shl     rcx, 5
                add     rcx, [rsi+868h]
                add     rcx, [rsi+860h]
                shl     rcx, 4
                cmp     rcx, 200h
                ja      short loc_14026CA84
                mov     ecx, cs:dword_140CFC400
                test    cl, 30h
                jz      short loc_14026CA84
                xor     r8d, r8d
                mov     edx, r13d
                mov     rcx, rbp
                call    sub_14038D330

loc_14026CA84:                          ; CODE XREF: sub_14026C660+3D1↑j
                                        ; sub_14026C660+409↑j ...
                mov     r13, [rsp+58h+arg_0]
                mov     eax, 1
                add     rsp, 28h
                pop     r15
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
algn_14026CA9B:                         ; DATA XREF: .pdata:00000001400CE1C0↑o
                                        ; .pdata:00000001400CE1CC↑o
                align 4

loc_14026CA9C:                          ; CODE XREF: sub_14026C660+88↑j
                                        ; sub_14026C660+95↑j
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
sub_14026C660   endp

; ---------------------------------------------------------------------------
algn_14026CAA3:                         ; DATA XREF: .pdata:00000001400CE1CC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026CAB0   proc near               ; CODE XREF: sub_14026BE30+1BD↑p
                                        ; sub_14026C660+53↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140440C2A SIZE 0000007A BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                mov     [rsp+arg_18], rdi
                push    r14
                sub     rsp, 20h

loc_14026CAC5:                          ; DATA XREF: .rdata:000000014005D0C0↑o
                                        ; .rdata:000000014005D0D4↑o ...
                mov     [rsp+28h+arg_0], rsi
                mov     r14d, r9d
                mov     rbp, r8
                mov     rdi, rcx
                cmp     rdx, 1
                jz      short loc_14026CB57
                mov     rsi, rdx
                neg     rsi
                lock xadd [rcx+1BC0h], rsi
                mov     rax, [rcx+1438h]
                mov     rbx, rsi
                sub     rbx, rdx
                cmp     rbx, rax
                jbe     loc_140440C2A

loc_14026CAFE:                          ; CODE XREF: sub_14026CAB0+1D417D↓j
                mov     rax, [rcx+1430h]
                cmp     rbx, rax
                jbe     loc_140440C35

loc_14026CB0E:                          ; CODE XREF: sub_14026CAB0+D0↓j
                                        ; sub_14026CAB0+1D4188↓j ...
                cmp     rbx, 420h
                jbe     loc_140440C49

loc_14026CB1B:                          ; CODE XREF: sub_14026CAB0+1D41BC↓j
                                        ; sub_14026CAB0+1D41C9↓j ...
                mov     rsi, [rsp+28h+arg_0]
                cmp     rbp, 0FFFFFFFFFFFFFFFFh
                jnz     short loc_14026CB4B

loc_14026CB26:                          ; DATA XREF: .pdata:00000001400CE1E4↑o
                                        ; .pdata:00000001400CE1F0↑o
                mov     r8d, r14d
                mov     rdx, rbx
                mov     rcx, rdi
                call    sub_14026CB94

loc_14026CB34:                          ; CODE XREF: sub_14026CAB0+A5↓j
                                        ; sub_14026CAB0+DB↓j
                mov     rbx, [rsp+28h+arg_8]
                mov     rbp, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026CB4B:                          ; CODE XREF: sub_14026CAB0+74↑j
                cmp     rbx, rbp
                jb      short loc_14026CB89
                mov     eax, 1
                jmp     short loc_14026CB34
; ---------------------------------------------------------------------------

loc_14026CB57:                          ; CODE XREF: sub_14026CAB0+27↑j
                                        ; DATA XREF: .pdata:00000001400CE1F0↑o ...
                mov     rbx, 0FFFFFFFFFFFFFFFFh
                lock xadd [rcx+1BC0h], rbx
                dec     rbx
                cmp     rbx, [rcx+1430h]
                jz      short loc_14026CB82
                cmp     rbx, [rcx+1438h]
                jz      short loc_14026CB82

loc_14026CB7C:                          ; CODE XREF: sub_14026CAB0+D7↓j
                lea     rsi, [rbx+1]
                jmp     short loc_14026CB0E
; ---------------------------------------------------------------------------

loc_14026CB82:                          ; CODE XREF: sub_14026CAB0+C1↑j
                                        ; sub_14026CAB0+CA↑j
                call    sub_1403B69C4
                jmp     short loc_14026CB7C
; ---------------------------------------------------------------------------

loc_14026CB89:                          ; CODE XREF: sub_14026CAB0+9E↑j
                                        ; DATA XREF: .pdata:00000001400CE1FC↑o ...
                xor     eax, eax
                jmp     short loc_14026CB34
sub_14026CAB0   endp

; ---------------------------------------------------------------------------
byte_14026CB8D  db 7 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE208↑o

; =============== S U B R O U T I N E =======================================


sub_14026CB94   proc near               ; CODE XREF: sub_14026CAB0+7F↑p
                                        ; sub_14055C1B4:loc_14055C1CA↓p
                                        ; DATA XREF: ...

; FUNCTION CHUNK AT 0000000140440CA4 SIZE 00000062 BYTES

                cmp     rdx, 9Fh
                jb      loc_140440CA4

loc_14026CBA1:                          ; CODE XREF: sub_14026CB94+1D4115↓j
                                        ; sub_14026CB94+1D4132↓j ...
                mov     eax, 1
                retn
sub_14026CB94   endp

; ---------------------------------------------------------------------------
                align 8
algn_14026CBA8:                         ; DATA XREF: .pdata:00000001400CE214↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026CBB0   proc near               ; CODE XREF: sub_14026CD38+46↓p
                                        ; sub_140528DA8+C6↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 0000000140440D08 SIZE 00000025 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                movzx   edx, word ptr [rcx+3Ch]
                mov     rdi, rcx
                mov     rax, cs:qword_140C4E4C8
                and     edx, 3FFh
                mov     rbx, [rax+rdx*8]
                call    sub_14026BC18
                test    dword ptr [rdi+38h], 40000h
                mov     rsi, rax
                jnz     loc_140440D08

loc_14026CBEC:                          ; CODE XREF: sub_14026CBB0+1D415F↓j
                                        ; sub_14026CBB0+1D4178↓j
                lea     rax, [rdi+8]
                mov     rdx, [rax]
                cmp     [rdx+8], rax
                jnz     short loc_14026CC39
                mov     rcx, [rax+8]
                cmp     [rcx], rax
                jnz     short loc_14026CC39
                mov     [rcx], rdx
                mov     [rdx+8], rcx
                btr     dword ptr [rdi+38h], 1Bh
                mov     [rax+8], rax
                mov     [rax], rax
                sub     [rbx+6A0h], rsi
                neg     rsi
                lock xadd cs:qword_140C4C818, rsi
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026CC39:                          ; CODE XREF: sub_14026CBB0+47↑j
                                        ; sub_14026CBB0+50↑j
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
sub_14026CBB0   endp

; ---------------------------------------------------------------------------
byte_14026CC40  db 8 dup(0CCh)          ; DATA XREF: .rdata:000000014005D130↑o
                                        ; .pdata:00000001400CE220↑o

; =============== S U B R O U T I N E =======================================


sub_14026CC48   proc near               ; CODE XREF: sub_140231440+86D↑p
                                        ; DATA XREF: .rdata:000000014005D154↑o ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 0000000140440D2E SIZE 0000001F BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                movzx   eax, word ptr [rcx+0Ah]
                mov     rbx, rcx
                mov     ecx, 200h
                mov     rdi, r8
                mov     rsi, rdx
                test    cx, ax
                jnz     loc_140440D2E

loc_14026CC72:                          ; CODE XREF: sub_14026CC48+1D40F2↓j
                test    al, 1
                jz      short loc_14026CC82
                mov     rcx, [rbx+18h]
                mov     rdx, rbx
                call    MmUnmapLockedPages

loc_14026CC82:                          ; CODE XREF: sub_14026CC48+2C↑j
                mov     edx, [rbx+2Ch]
                lea     rcx, [rbx+30h]
                add     edx, [rbx+20h]
                mov     r8, rdi
                mov     eax, [rbx+28h]
                and     edx, 0FFFh
                add     rax, 0FFFh
                add     rdx, rax
                shr     rdx, 0Ch
                lea     rdx, [rcx+rdx*8]
                call    sub_140278450
                xor     edx, edx
                mov     rcx, rsi
                call    sub_14026CD98
                test    rax, rax
                jnz     loc_140440D3F

loc_14026CCC1:                          ; CODE XREF: sub_14026CC48+1D4100↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026CC48   endp

algn_14026CCD2:                         ; DATA XREF: .rdata:000000014005D154↑o
                                        ; .pdata:00000001400CE22C↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_14026CCD8   proc near               ; CODE XREF: sub_14021B194+D0↑p
                                        ; sub_1402D3754+64↓p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                mov     rdi, rdx
                mov     rbx, rcx
                mov     rcx, rdi
                mov     edx, 4
                call    sub_14026CE10
                inc     qword ptr [rdi+18h]
                mov     rcx, rdi
                mov     rsi, rax
                call    sub_14026CD38
                mov     ecx, [rbx]
                test    cl, 1
                jnz     short loc_14026CD28
                inc     qword ptr [rdi+30h]

loc_14026CD14:                          ; CODE XREF: sub_14026CCD8+55↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rax, rsi
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 8

loc_14026CD28:                          ; CODE XREF: sub_14026CCD8+36↑j
                bts     dword ptr [rdi+38h], 0Fh
                jmp     short loc_14026CD14
sub_14026CCD8   endp

; ---------------------------------------------------------------------------
byte_14026CD2F  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE238↑o

; =============== S U B R O U T I N E =======================================


sub_14026CD38   proc near               ; CODE XREF: sub_140267820+118↑p
                                        ; sub_14026CCD8+2C↑p ...

arg_0           = qword ptr  8

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 20h
                test    dword ptr [rcx+38h], 8000000h
                mov     rdi, rcx
                jnz     short loc_14026CD5A

loc_14026CD4E:                          ; CODE XREF: sub_14026CD38+57↓j
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026CD5A:                          ; CODE XREF: sub_14026CD38+14↑j
                movzx   edx, word ptr [rcx+3Ch]
                mov     rax, cs:qword_140C4E4C8
                and     edx, 3FFh
                mov     rbx, [rax+rdx*8]
                lea     rcx, [rbx+540h]
                call    ExAcquireSpinLockExclusiveAtDpcLevel
                mov     rcx, rdi
                call    sub_14026CBB0
                lea     rcx, [rbx+540h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                jmp     short loc_14026CD4E
sub_14026CD38   endp

; ---------------------------------------------------------------------------
algn_14026CD91:                         ; DATA XREF: .pdata:00000001400CE244↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_14026CD98   proc near               ; CODE XREF: sub_14026CC48+6B↑p
                                        ; sub_1402CB390+28D↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 0000000140440D4E SIZE 00000068 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                lea     rdi, [rcx+48h]
                mov     rsi, rcx
                cmp     edx, 1
                jz      short loc_14026CE06
                mov     rcx, rdi
                call    ExAcquireSpinLockExclusive
                mov     bl, al

loc_14026CDBD:                          ; CODE XREF: sub_14026CD98+70↓j
                dec     dword ptr [rsi+4Ch]
                mov     edx, 8
                mov     rcx, rsi
                call    sub_14026CE10
                mov     rsi, rax
                cmp     bl, 11h
                jz      short loc_14026CDF2
                mov     rcx, rdi
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jnz     loc_140440D4E

loc_14026CDEB:                          ; CODE XREF: sub_14026CD98+1D3FB9↓j
                                        ; sub_14026CD98+1D3FC6↓j ...
                movzx   eax, bl
                mov     cr8, rax

loc_14026CDF2:                          ; CODE XREF: sub_14026CD98+3B↑j
                mov     rbx, [rsp+28h+arg_0]
                mov     rax, rsi
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026CE06:                          ; CODE XREF: sub_14026CD98+19↑j
                mov     bl, 11h
                jmp     short loc_14026CDBD
sub_14026CD98   endp

; ---------------------------------------------------------------------------
algn_14026CE0A:                         ; DATA XREF: .rdata:000000014005D188↑o
                                        ; .pdata:00000001400CE250↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026CE10   proc near               ; CODE XREF: sub_140266E30+279↑p
                                        ; sub_140267820+10D↑p ...
                lea     r10, [rcx+50h]
                xor     r9d, r9d
                mov     rcx, [r10]
                test    rcx, rcx
                jnz     short loc_14026CE24

loc_14026CE1F:                          ; CODE XREF: sub_14026CE10+30↓j
                mov     rax, r9
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14026CE24:                          ; CODE XREF: sub_14026CE10+D↑j
                                        ; sub_14026CE10+32↓j
                mov     r8, [rcx]
                test    [rcx+8], edx
                jz      short loc_14026CE44
                test    dl, 4
                jnz     short loc_14026CE49
                mov     [rcx], r9
                mov     r9, rcx
                mov     [r10], r8

loc_14026CE3A:                          ; CODE XREF: sub_14026CE10+37↓j
                                        ; sub_14026CE10+40↓j
                mov     rcx, r8
                test    r8, r8
                jz      short loc_14026CE1F
                jmp     short loc_14026CE24
; ---------------------------------------------------------------------------

loc_14026CE44:                          ; CODE XREF: sub_14026CE10+1A↑j
                mov     r10, rcx
                jmp     short loc_14026CE3A
; ---------------------------------------------------------------------------

loc_14026CE49:                          ; CODE XREF: sub_14026CE10+1F↑j
                mov     dword ptr [rcx+0Ch], 1
                jmp     short loc_14026CE3A
sub_14026CE10   endp

; ---------------------------------------------------------------------------
algn_14026CE52:                         ; DATA XREF: .pdata:00000001400CE25C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026CE60   proc near               ; CODE XREF: sub_14063D6E0+275↓p
                                        ; NtSetInformationThread+3CC↓p ...
                mov     eax, 1
                retn
sub_14026CE60   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14026CE67:                         ; DATA XREF: .pdata:00000001400CE268↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026CE70   proc near               ; CODE XREF: sub_14026BB1C+2A↑p
                                        ; DATA XREF: .rdata:000000014005D1EC↑o ...

var_18          = qword ptr -18h
arg_0           = qword ptr  8

; FUNCTION CHUNK AT 0000000140440DB6 SIZE 00000042 BYTES

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 30h
                xor     edi, edi
                lea     rbx, [rcx+80h]

loc_14026CE83:                          ; CODE XREF: sub_14026CE70+23↓j
                movzx   ecx, word ptr [rbx+22h]
                test    cl, 8
                jz      short loc_14026CEA4

loc_14026CE8C:                          ; CODE XREF: sub_14026CE70+3E↓j
                                        ; sub_14026CE70+7A↓j ...
                mov     rbx, [rbx+10h]
                test    rbx, rbx
                jnz     short loc_14026CE83
                mov     rbx, [rsp+38h+arg_0]
                mov     rax, rdi
                add     rsp, 30h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14026CEA4:                          ; CODE XREF: sub_14026CE70+1A↑j
                test    cl, 1
                jnz     short loc_14026CEB5
                cmp     qword ptr [rbx+8], 0
                jz      short loc_14026CE8C
                jmp     loc_140440DD2
; ---------------------------------------------------------------------------

loc_14026CEB5:                          ; CODE XREF: sub_14026CE70+37↑j
                test    dword ptr [rbx+30h], 3FFFFFFFh
                jnz     loc_140440DB6
                mov     r8d, 4

loc_14026CEC8:                          ; CODE XREF: sub_14026CE70+1D3F5D↓j
                mov     edx, [rbx+2Ch]
                mov     eax, 0FFFEh
                and     cx, ax
                mov     qword ptr [rbx+60h], 1
                mov     [rbx+22h], cx
                mov     rcx, rbx
                call    sub_14026712C
                add     rdi, rax
                jmp     short loc_14026CE8C
sub_14026CE70   endp

; ---------------------------------------------------------------------------
algn_14026CEEC:                         ; DATA XREF: .rdata:000000014005D1EC↑o
                                        ; .pdata:00000001400CE274↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_14026CF00   proc near               ; CODE XREF: sub_14022CA60+1200↑p
                                        ; sub_14031B444+E4↓p
                                        ; DATA XREF: ...

var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = dword ptr -0D0h
var_CC          = dword ptr -0CCh
var_C8          = dword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = dword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = dword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = xmmword ptr -50h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  10h
arg_8           = qword ptr  18h
arg_10          = qword ptr  20h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 0000000140440DF8 SIZE 0000029F BYTES

                mov     [rsp-8+arg_18], r9
                mov     [rsp-8+arg_10], r8
                mov     [rsp-8+arg_8], rdx
                mov     [rsp-8+arg_0], rcx
                push    rbp
                push    rbx
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-2Fh]
                sub     rsp, 0F8h
                mov     rax, [rcx]
                xor     r15d, r15d
                mov     r14, [rcx+10h]
                mov     r13, rcx
                mov     [rbp+57h+var_A8], rax
                xorps   xmm0, xmm0
                mov     rax, [rcx+38h]
                mov     r12, rdx
                mov     rcx, rdx
                mov     [rbp+57h+var_68], rax
                mov     [rbp+57h+var_58], r15
                mov     [rbp+57h+var_60], r15
                mov     [rbp+57h+var_D0], r15d
                movups  [rbp+57h+var_50], xmm0
                mov     [rbp+57h+var_90], r14
                call    sub_1402805F0
                mov     rbx, rax
                mov     [rbp+57h+var_80], rax
                mov     rax, gs:188h
                mov     [rbp+57h+var_C0], r15
                mov     [rbp+57h+var_C8], 2
                test    byte ptr [rax+518h], 4
                jnz     loc_140440DF8

loc_14026CF8D:                          ; DATA XREF: .rdata:000000014005D218↑o
                                        ; .rdata:000000014005D22C↑o ...
                mov     [rsp+120h+var_30], rsi
                mov     rsi, r14
                mov     [rsp+120h+var_38], rdi
                and     rsi, 0FFFFFFFFFFFFFFFEh
                mov     rdi, r14
                and     edi, 1
                test    rdi, rdi
                jnz     loc_14026D491

loc_14026CFB3:                          ; CODE XREF: sub_14026CF00+59D↓j
                                        ; sub_14026CF00+5C1↓j ...
                bt      rbx, 0Ah
                jnb     loc_14026D506
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14026CFD5
                test    bl, 10h
                jnz     short loc_14026CFD5
                not     rax
                and     rbx, rax

loc_14026CFD5:                          ; CODE XREF: sub_14026CF00+C8↑j
                                        ; sub_14026CF00+CD↑j
                mov     [rbp+57h+var_70], r15

loc_14026CFD9:                          ; CODE XREF: sub_14026CF00+651↓j
                                        ; sub_14026CF00+65A↓j ...
                sar     rbx, 10h
                mov     r15, [rbx]
                mov     ecx, [r15+38h]
                test    cl, 10h
                jnz     loc_140440E44
                mov     rax, [rbx+8]
                xor     r8d, r8d
                test    byte ptr [rbx+22h], 2
                mov     [rbp+57h+var_B8], 0FFFFFFFFh
                mov     [rbp+57h+var_78], r8
                mov     [rbp+57h+var_98], rax
                jnz     loc_140440E59

loc_14026D00D:                          ; CODE XREF: sub_14026CF00+1D3F5D↓j
                mov     rdx, 0FFFF800000000000h
                cmp     [rbp+57h+var_A8], rdx
                jb      short loc_14026D026
                test    cl, 20h
                jnz     loc_14026D464

loc_14026D026:                          ; CODE XREF: sub_14026CF00+11B↑j
                                        ; sub_14026CF00+56F↓j ...
                mov     eax, [rbx+34h]
                mov     ecx, [rbx+2Ch]
                and     eax, 3FFFFFFFh
                imul    rax, -8
                add     rax, [rbp+57h+var_98]
                lea     rcx, [rax+rcx*8]
                cmp     r12, rcx
                jnb     loc_140440ED9
                movzx   ecx, word ptr [r15+3Ch]
                xor     r13d, r13d
                mov     rax, cs:qword_140C4E4C8
                and     ecx, 3FFh
                xor     esi, esi
                mov     [rbp+57h+var_CC], r13d
                mov     r14, [rax+rcx*8]
                mov     rcx, r15
                mov     [rbp+57h+var_B0], r14
                call    sub_1402851C0
                mov     rdi, [rbp+57h+var_80]
                test    eax, eax
                jnz     loc_140440EEE
                call    sub_14026B65C
                test    eax, eax
                jnz     loc_140440F1E

loc_14026D08A:                          ; CODE XREF: sub_14026CF00+1D4019↓j
                                        ; sub_14026CF00+1D4028↓j
                mov     rcx, [rbp+57h+arg_0]
                lea     r8, [rbp+57h+var_A0]
                mov     rdx, r15
                mov     [rbp+57h+var_A0], rsi
                call    sub_1402C6940
                mov     esi, eax
                mov     [rbp+57h+var_D0], 0
                lea     eax, [r13-1]
                cmp     eax, 1
                jbe     loc_140440F3F
                mov     r10, [rbp+57h+var_C0]
                test    r10, r10
                jnz     loc_14026D4C6
                bt      rdi, 0Ah
                jnb     short loc_14026D0E3
                mov     eax, [r15+38h]
                test    al, 20h
                jnz     short loc_14026D0E3
                mov     rax, [rbp+57h+var_68]
                movzx   eax, byte ptr [rax+0B8h]
                test    al, 7
                jz      loc_14026D3B2

loc_14026D0E3:                          ; CODE XREF: sub_14026CF00+1C6↑j
                                        ; sub_14026CF00+1CE↑j ...
                mov     edx, [rbp+57h+var_C8]
                lea     r9, [rbp+57h+arg_10]
                lea     r8, [rbp+57h+var_D0]
                mov     rcx, r12
                call    sub_14026D620
                mov     r14, rax
                test    rax, rax
                jz      loc_140440F4B
                mov     rcx, r12
                call    sub_1402805F0
                cmp     rax, rdi
                jnz     loc_140441060
                mov     r12, rdi
                shr     r12, 0Ah
                and     r12d, 1
                jz      loc_14026D56B

loc_14026D124:                          ; CODE XREF: sub_14026CF00+685↓j
                cmp     r13d, 3
                jz      loc_140440FF1
                mov     r10, [rbp+57h+var_C0]
                test    r10, r10
                jnz     loc_14026D4EC

loc_14026D13B:                          ; CODE XREF: sub_14026CF00+5F0↓j
                                        ; sub_14026CF00+601↓j
                test    r12, r12
                jz      loc_14026D590
                lea     rcx, [rbp+57h+var_80]
                call    sub_1402805F0
                mov     r10, [rbp+57h+var_C0]

loc_14026D151:                          ; CODE XREF: sub_14026CF00+693↓j
                movzx   ecx, word ptr [rbx+20h]
                shr     ecx, 1
                and     ecx, 1Fh
                shr     rax, 5
                and     eax, 1Fh
                mov     [rbp+57h+var_C8], ecx
                mov     edx, ecx
                mov     r8d, eax
                xor     ecx, ecx
                call    sub_140286800
                mov     rcx, [rbp+57h+var_68]
                lea     r8, [rbp+57h+var_50]
                mov     edx, esi
                mov     [rbp+57h+var_88], eax
                call    sub_1402C68C0
                mov     esi, [rbp+57h+var_CC]
                mov     r13, 0FFFFFFFFFFFFFFFFh
                lea     ecx, [rsi-1]
                cmp     ecx, 1
                jbe     short loc_14026D1C6
                mov     ecx, [r15+38h]
                and     ecx, 40020h
                cmp     ecx, 20h ; ' '
                jnz     loc_14026D2A7
                test    r12, r12
                jz      loc_14026D2A7
                cmp     cs:dword_140C4EB40, 0
                jnz     loc_14026D2A7
                test    r10, r10
                jnz     loc_14026D598

loc_14026D1C6:                          ; CODE XREF: sub_14026CF00+292↑j
                mov     r15, [rbp+57h+var_B0]

loc_14026D1CA:                          ; CODE XREF: sub_14026CF00+6A0↓j
                                        ; sub_14026CF00+6BD↓j
                mov     edx, 1
                mov     rcx, r15
                mov     r8d, edx
                call    sub_140233120
                test    eax, eax
                jz      loc_14026D60B
                mov     rax, qword ptr [rbp+57h+var_50]
                mov     ecx, 1
                lock xadd [rax], ecx
                mov     r11d, dword ptr [rbp+57h+var_50+8]
                mov     rdi, [rbp+57h+var_80]
                and     r11d, ecx
                or      r11d, dword ptr [rbp+57h+var_50+0Ch]
                test    r12, r12
                jz      short loc_14026D21C
                xor     r9d, r9d
                mov     r8, rdi
                mov     rdx, rbx
                mov     rcx, r15
                call    sub_14026B5F8
                test    eax, eax
                jnz     loc_14026D5E3

loc_14026D21C:                          ; CODE XREF: sub_14026CF00+301↑j
                xor     r8d, r8d
                mov     edx, r11d
                mov     rcx, r15
                call    sub_14022ACA0

loc_14026D22A:                          ; CODE XREF: sub_14026CF00+6F6↓j
                mov     r13, rax
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jz      loc_14026D5FB
                mov     r9, [rbp+57h+var_90]
                mov     rdx, rbx
                mov     rcx, r14
                cmp     esi, 1
                jz      loc_140440F55
                mov     r12, [rbp+57h+arg_8]
                mov     r8, r12
                cmp     esi, 2
                jz      loc_140440F86
                mov     rax, [rbp+57h+var_A8]
                mov     rsi, [rbp+57h+arg_10]
                mov     [rsp+120h+var_F8], rsi
                mov     [rsp+120h+var_100], r13
                mov     [r14+0E0h], rax
                call    sub_1402DB3B4
                cmp     eax, 1
                jz      loc_14026D3A4

loc_14026D281:                          ; CODE XREF: sub_14026CF00+713↓j
                mov     eax, [rbp+57h+var_CC]
                dec     eax
                cmp     eax, 1
                ja      short loc_14026D2B3

loc_14026D28B:                          ; CODE XREF: sub_14026CF00+457↓j
                mov     dl, 11h
                mov     rcx, rsi
                call    sub_140297330
                mov     rcx, r14
                call    sub_140299AD8
                mov     eax, 0C0000017h
                jmp     loc_14026D381
; ---------------------------------------------------------------------------

loc_14026D2A7:                          ; CODE XREF: sub_14026CF00+2A1↑j
                                        ; sub_14026CF00+2AA↑j ...
                mov     r15, [rbp+57h+var_B0]

loc_14026D2AB:                          ; CODE XREF: sub_14026CF00+6C3↓j
                mov     rsi, [rbp+57h+arg_10]
                mov     r12, [rbp+57h+arg_8]

loc_14026D2B3:                          ; CODE XREF: sub_14026CF00+389↑j
                mov     eax, [rbp+57h+var_D0]
                mov     rdx, r14
                mov     r9, [rbp+57h+var_98]
                mov     rcx, r15
                mov     [r14+0B8h], eax
                lea     rax, [rbp+57h+var_60]
                mov     [rsp+120h+var_E8], rax
                lea     rax, [rbp+57h+var_58]
                mov     [rsp+120h+var_F0], rax
                mov     [r14+0D0h], rbx
                mov     rbx, [rbp+57h+var_C0]
                mov     [r14+0E8h], r12
                mov     r8, rbx
                mov     r12d, [rbp+57h+var_B8]
                mov     [rsp+120h+var_F8], r13
                mov     dword ptr [rsp+120h+var_100], r12d
                mov     [r14+0A0h], rsi
                mov     [r14+0A8h], rdi
                call    sub_14026D6F0
                mov     r8, [rbp+57h+var_60]
                mov     edi, eax
                mov     rdx, [rbp+57h+var_58]
                lea     rax, [rbp+57h+var_50]
                mov     [rsp+120h+var_D8], rax
                mov     r9, r15
                mov     rax, [rbp+57h+arg_0]
                mov     rcx, r14
                mov     [rsp+120h+var_E0], rax
                mov     eax, [rbp+57h+var_88]
                mov     [rsp+120h+var_E8], rbx
                mov     dword ptr [rsp+120h+var_F0], eax
                mov     [rsp+120h+var_F8], r13
                mov     dword ptr [rsp+120h+var_100], edi
                call    sub_1402C79F0
                mov     ebx, eax
                cmp     eax, edi
                jnz     loc_14026D47A

loc_14026D355:                          ; CODE XREF: sub_14026CF00+58C↓j
                test    ebx, ebx
                jz      loc_14026D28B
                mov     r9, [rbp+57h+var_70]
                mov     r8d, ebx
                mov     rdx, [rbp+57h+var_90]
                mov     rcx, r14
                mov     dword ptr [rsp+120h+var_100], r12d
                call    sub_14026DA8C
                mov     rax, [rbp+57h+arg_18]
                mov     [rax], r14
                mov     eax, 0C0033333h

loc_14026D381:                          ; CODE XREF: sub_14026CF00+3A2↑j
                                        ; sub_14026CF00+4B0↓j ...
                mov     rsi, [rsp+120h+var_30]
                mov     rdi, [rsp+120h+var_38]

loc_14026D391:                          ; CODE XREF: sub_14026CF00+1D3F08↓j
                                        ; DATA XREF: .pdata:00000001400CE28C↑o ...
                add     rsp, 0F8h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14026D3A4:                          ; CODE XREF: sub_14026CF00+37B↑j
                                        ; sub_14026CF00+1D40A6↓j
                                        ; DATA XREF: ...
                mov     rax, [rbp+57h+arg_18]
                mov     [rax], r14
                mov     eax, 0C0033333h
                jmp     short loc_14026D381
; ---------------------------------------------------------------------------

loc_14026D3B2:                          ; CODE XREF: sub_14026CF00+1DD↑j
                mov     rax, [rbp+57h+var_A0]
                mov     r10, [rbp+57h+var_A8]
                test    rax, rax
                jnz     short loc_14026D3CB
                mov     rcx, r10
                call    sub_14026A130
                mov     [rbp+57h+var_A0], rax

loc_14026D3CB:                          ; CODE XREF: sub_14026CF00+4BD↑j
                mov     r14, [rax+78h]
                test    r14, r14
                js      loc_14026D0E3
                mov     rcx, r14
                and     ecx, 0FFFh
                cmp     rcx, 11h
                jb      loc_14026D0E3
                mov     rax, r14
                shr     rax, 0Ch
                dec     rax
                add     rcx, rax
                mov     rax, r10
                and     rax, 0FFFFFFFFFFFFF000h
                shl     rcx, 0Ch
                cmp     rax, rcx
                jnz     loc_14026D0E3
                lea     rcx, [r12+8]
                test    ecx, 0FFFh
                jz      loc_14026D0E3
                mov     eax, [rbx+34h]
                mov     r8d, [rbx+2Ch]
                and     eax, 3FFFFFFFh
                imul    rdx, rax, -8
                mov     rax, [rbp+57h+var_98]
                add     rax, rdx
                lea     rdx, [rax+r8*8]
                cmp     rcx, rdx
                jnb     loc_14026D0E3
                call    sub_1402805F0
                cmp     rax, rdi
                jnz     loc_14026D0E3
                and     r14d, 0FFFh
                dec     r14d
                mov     [rbp+57h+var_D0], r14d
                jmp     loc_14026D0E3
; ---------------------------------------------------------------------------

loc_14026D464:                          ; CODE XREF: sub_14026CF00+120↑j
                mov     rcx, rbx
                call    sub_1402A3500
                test    rax, rax
                jz      loc_14026D026
                jmp     loc_140440ECC
; ---------------------------------------------------------------------------

loc_14026D47A:                          ; CODE XREF: sub_14026CF00+44F↑j
                sub     edi, ebx
                mov     r8d, 1
                mov     edx, edi
                mov     rcx, r15
                call    sub_14031D584
                jmp     loc_14026D355
; ---------------------------------------------------------------------------

loc_14026D491:                          ; CODE XREF: sub_14026CF00+AD↑j
                cmp     byte ptr [rsi], 5
                jz      loc_140440E0D
                test    rdi, rdi
                jz      loc_14026CFB3
                cmp     byte ptr [rsi], 1
                jnz     loc_14026D5C8
                test    dword ptr [rsi+50h], 100h
                mov     [rbp+57h+var_C0], rsi
                jnz     loc_140440E32
                mov     [rbp+57h+var_C8], r15d
                jmp     loc_14026CFB3
; ---------------------------------------------------------------------------

loc_14026D4C6:                          ; CODE XREF: sub_14026CF00+1BB↑j
                mov     rax, [rbp+57h+var_A0]
                test    rax, rax
                jz      loc_140440F2D

loc_14026D4D3:                          ; CODE XREF: sub_14026CF00+1D403A↓j
                xor     r9d, r9d
                mov     r8, rax
                mov     rdx, r10
                mov     rcx, r14
                call    sub_14031D2C4
                mov     [rbp+57h+var_D0], eax
                jmp     loc_14026D0E3
; ---------------------------------------------------------------------------

loc_14026D4EC:                          ; CODE XREF: sub_14026CF00+235↑j
                cmp     byte ptr [r10], 1
                jnz     loc_14026D13B
                mov     rdx, r14
                mov     rcx, r10
                call    sub_14031D554
                jmp     loc_14026D13B
; ---------------------------------------------------------------------------

loc_14026D506:                          ; CODE XREF: sub_14026CF00+B8↑j
                mov     rcx, cs:qword_140C4DDC0
                test    rcx, rcx
                jz      short loc_14026D520
                test    bl, 10h
                jnz     short loc_14026D520
                mov     rax, rcx
                not     rax
                and     rbx, rax

loc_14026D520:                          ; CODE XREF: sub_14026CF00+610↑j
                                        ; sub_14026CF00+615↑j
                mov     rax, 0FFFFFFFFFh
                shr     rbx, 0Ch
                and     rbx, rax
                lea     rax, [rbx+rbx*2]
                shl     rax, 4
                mov     rdx, 0FFFFFA8000000000h
                add     rax, rdx
                mov     [rbp+57h+var_70], rax
                mov     rbx, [rax+10h]
                test    rcx, rcx
                jz      loc_14026CFD9
                test    bl, 10h
                jnz     loc_14026CFD9
                not     rcx
                and     rbx, rcx
                jmp     loc_14026CFD9
; ---------------------------------------------------------------------------

loc_14026D56B:                          ; CODE XREF: sub_14026CF00+21E↑j
                mov     rcx, [rbp+57h+var_70]
                test    byte ptr [rcx+22h], 20h
                jz      loc_140441060
                mov     rax, [rcx]
                mov     ecx, [rax+0A0h]
                test    cl, 20h
                jz      loc_14026D124
                jmp     loc_140441060
; ---------------------------------------------------------------------------

loc_14026D590:                          ; CODE XREF: sub_14026CF00+23E↑j
                mov     rax, rdi
                jmp     loc_14026D151
; ---------------------------------------------------------------------------

loc_14026D598:                          ; CODE XREF: sub_14026CF00+2C0↑j
                cmp     byte ptr [r10], 1
                mov     r15, [rbp+57h+var_B0]
                jnz     loc_14026D1CA
                mov     edx, [r10+50h]
                mov     rcx, r15
                shr     edx, 3
                and     edx, 7
                inc     edx
                call    sub_1402FFBAC
                test    rax, rax
                jnz     loc_14026D1CA
                jmp     loc_14026D2AB
; ---------------------------------------------------------------------------

loc_14026D5C8:                          ; CODE XREF: sub_14026CF00+5A6↑j
                test    rdi, rdi
                jz      loc_14026CFB3
                cmp     byte ptr [rsi], 2
                jnz     loc_14026CFB3
                mov     [rbp+57h+var_C0], rsi
                jmp     loc_14026CFB3
; ---------------------------------------------------------------------------

loc_14026D5E3:                          ; CODE XREF: sub_14026CF00+316↑j
                mov     edx, [rbp+57h+var_C8]
                xor     r8d, r8d
                mov     rcx, r15
                mov     dword ptr [rsp+120h+var_100], r9d
                call    sub_1402FF0CC
                jmp     loc_14026D22A
; ---------------------------------------------------------------------------

loc_14026D5FB:                          ; CODE XREF: sub_14026CF00+331↑j
                mov     edx, 1
                mov     rcx, r15
                mov     r8d, edx
                call    sub_14031D584

loc_14026D60B:                          ; CODE XREF: sub_14026CF00+2DC↑j
                mov     r12, [rbp+57h+arg_8]
                mov     rsi, [rbp+57h+arg_10]
                jmp     loc_14026D281
sub_14026CF00   endp

; ---------------------------------------------------------------------------
algn_14026D618:                         ; DATA XREF: .pdata:00000001400CE2A4↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026D620   proc near               ; CODE XREF: sub_14026CF00+1F1↑p
                                        ; sub_14031A2D8+2F4↓p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140441098 SIZE 0000004B BYTES

                mov     rax, rsp
                mov     [rax+8], rbx
                mov     [rax+10h], rbp
                mov     [rax+18h], rsi
                mov     [rax+20h], rdi
                push    r14
                sub     rsp, 20h
                mov     rsi, r9
                mov     r14, r8
                mov     rbp, rcx
                test    r9, r9
                jz      short loc_14026D695
                mov     rdi, [r9]

loc_14026D64A:                          ; CODE XREF: sub_14026D620+77↓j
                mov     eax, [r8]
                mov     ecx, 100h
                cmp     eax, ecx
                ja      loc_14026D6DF

loc_14026D65A:                          ; CODE XREF: sub_14026D620+C4↓j
                mov     ebx, edx
                or      ebx, 1
                cmp     eax, 10h
                cmovbe  ebx, edx
                mov     ecx, ebx
                test    rsi, rsi
                jz      short loc_14026D66F
                or      ecx, 4

loc_14026D66F:                          ; CODE XREF: sub_14026D620+4A↑j
                call    sub_1402C6ABC
                test    rax, rax
                jz      short loc_14026D699

loc_14026D679:                          ; CODE XREF: sub_14026D620+BD↓j
                                        ; sub_14026D620+1D3ABE↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026D695:                          ; CODE XREF: sub_14026D620+25↑j
                xor     edi, edi
                jmp     short loc_14026D64A
; ---------------------------------------------------------------------------

loc_14026D699:                          ; CODE XREF: sub_14026D620+57↑j
                test    rsi, rsi
                jz      loc_140441098
                mov     dl, 11h
                mov     rcx, rdi
                call    sub_140297330

loc_14026D6AC:                          ; CODE XREF: sub_14026D620+1D3A87↓j
                mov     ecx, ebx
                call    sub_1402C6ABC
                mov     rdi, rax
                test    rax, rax
                jz      loc_1404410AC

loc_14026D6BF:                          ; CODE XREF: sub_14026D620+1D3AAC↓j
                test    rsi, rsi
                jz      short loc_14026D6DA
                xor     edx, edx
                mov     rcx, rbp
                call    sub_140299CD0
                test    rax, rax
                jz      loc_1404410D4
                mov     [rsi], rax

loc_14026D6DA:                          ; CODE XREF: sub_14026D620+A2↑j
                                        ; sub_14026D620+1D3A8F↓j
                mov     rax, rdi
                jmp     short loc_14026D679
; ---------------------------------------------------------------------------

loc_14026D6DF:                          ; CODE XREF: sub_14026D620+34↑j
                mov     [r8], ecx
                mov     eax, ecx
                jmp     loc_14026D65A
sub_14026D620   endp

; ---------------------------------------------------------------------------
algn_14026D6E9:                         ; DATA XREF: .rdata:000000014005D298↑o
                                        ; .pdata:00000001400CE2B0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026D6F0   proc near               ; CODE XREF: sub_14026CF00+40A↑p
                                        ; DATA XREF: .rdata:000000014005D2C4↑o ...

var_58          = qword ptr -58h
var_50          = qword ptr -50h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h
arg_20          = dword ptr  28h
arg_28          = qword ptr  30h
arg_30          = qword ptr  38h
arg_38          = qword ptr  40h

; FUNCTION CHUNK AT 00000001404410E4 SIZE 0000000D BYTES

                mov     rax, rsp
                mov     [rax+20h], r9
                mov     [rax+18h], r8
                mov     [rax+10h], rdx
                mov     [rax+8], rcx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 38h
                mov     r15, [rdx+0D0h]
                xor     r14d, r14d
                mov     rbx, [rdx+0A8h]
                mov     r12d, 1
                mov     rsi, [rdx+0E8h]
                mov     rbp, rdx
                mov     rdi, gs:188h
                mov     r13d, r12d
                mov     rax, [r15]
                mov     [rsp+78h+var_50], rax
                bt      rbx, 0Ah
                jnb     short loc_14026D771
                cmp     [rdi+51Dh], r14b
                jnz     short loc_14026D771
                mov     eax, [rax+38h]
                lea     edx, [r12+7]
                mov     dword ptr [rsp+78h+var_58], eax
                test    dl, al
                jz      short loc_14026D7E3
                cmp     byte ptr [rdi+51Ch], 2
                jz      short loc_14026D7E3

loc_14026D771:                          ; CODE XREF: sub_14026D6F0+5D↑j
                                        ; sub_14026D6F0+66↑j ...
                mov     r15, rsi
                mov     rbp, rsi

loc_14026D777:                          ; CODE XREF: sub_14026D6F0+241↓j
                mov     rbx, [rsp+78h+arg_28]
                lea     edx, [r13-1]
                cmp     rbx, 0FFFFFFFFFFFFFFFFh
                cmovz   edx, r13d
                test    edx, edx
                jz      short loc_14026D7AF
                mov     rcx, [rsp+78h+arg_0]
                cmp     rbx, 0FFFFFFFFFFFFFFFFh
                mov     eax, 3
                cmovz   r12d, eax
                mov     r8d, r12d
                call    sub_140233120
                mov     r14d, eax

loc_14026D7AF:                          ; CODE XREF: sub_14026D6F0+9D↑j
                mov     rcx, [rsp+78h+arg_30]
                lea     eax, [r14+1]
                cmp     rbx, 0FFFFFFFFFFFFFFFFh
                cmovz   eax, r14d
                mov     [rcx], r15
                mov     rcx, [rsp+78h+arg_38]
                mov     [rcx], rbp
                add     rsp, 38h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026D7E3:                          ; CODE XREF: sub_14026D6F0+76↑j
                                        ; sub_14026D6F0+7F↑j
                cmp     qword ptr [rcx+1C00h], 0A0h
                jl      short loc_14026D771
                mov     eax, cs:dword_140C4EB40
                test    eax, eax
                jnz     loc_1404410E4
                mov     edx, 140h
                call    sub_140269070
                test    eax, eax
                jz      loc_14026D771
                mov     edx, [rbp+0B8h]
                cmp     edx, r12d
                jz      loc_14026D771
                mov     ecx, [r15+34h]
                mov     ebp, [r15+2Ch]
                and     ecx, 3FFFFFFFh
                mov     r8, [rsp+78h+arg_10]
                sub     rbp, rcx
                mov     rcx, [rsp+78h+arg_18]
                sub     rcx, 8
                lea     rbp, [rcx+rbp*8]
                mov     ecx, dword ptr [rsp+78h+var_58]
                test    r8, r8
                jnz     short loc_14026D868
                test    cl, 20h
                jz      loc_14026D96A
                lea     edx, [r8+4]
                test    [r15+20h], dl
                lea     eax, [rdx+4]
                cmovnz  edx, eax

loc_14026D868:                          ; CODE XREF: sub_14026D6F0+15F↑j
                                        ; sub_14026D6F0+27C↓j ...
                mov     eax, edx
                shl     rax, 3
                mov     [rsp+78h+var_58], rax
                add     rax, 0FFFFFFFFFFFFFFF8h
                add     rax, rsi
                cmp     rbp, rax
                cmova   rbp, rax
                test    r8, r8
                jnz     short loc_14026D890
                bt      ecx, 1Dh
                jb      loc_14026D985

loc_14026D890:                          ; CODE XREF: sub_14026D6F0+194↑j
                mov     r15, r14

loc_14026D893:                          ; CODE XREF: sub_14026D6F0+2C7↓j
                                        ; sub_14026D6F0+2D0↓j
                mov     rax, rsi
                and     rax, 0FFFFFFFFFFFFFFF8h
                or      rax, 0FF8h
                cmp     rbp, rax
                cmova   rbp, rax
                mov     rdi, rbp
                cmp     rbp, rsi
                jbe     short loc_14026D8CC

loc_14026D8AF:                          ; CODE XREF: sub_14026D6F0+1DA↓j
                mov     rcx, rdi
                call    sub_1402805F0
                cmp     rax, rbx
                jnz     loc_14026D94D
                add     r13d, r12d

loc_14026D8C3:                          ; CODE XREF: sub_14026D6F0+260↓j
                                        ; sub_14026D6F0+26A↓j
                sub     rdi, 8
                cmp     rdi, rsi
                ja      short loc_14026D8AF

loc_14026D8CC:                          ; CODE XREF: sub_14026D6F0+1BD↑j
                mov     rax, rbp
                mov     rcx, rsi
                sub     rax, [rsp+78h+var_58]
                add     rax, 8
                cmp     rax, [rsp+78h+arg_18]
                cmovb   rax, [rsp+78h+arg_18]
                and     rcx, 0FFFFFFFFFFFFF000h
                cmp     rax, rcx
                cmovnb  rcx, rax
                cmp     [rsp+78h+arg_10], r14
                jnz     short loc_14026D980
                mov     rax, [rsp+78h+arg_8]
                mov     eax, [rax+0C0h]
                test    al, 40h
                jnz     short loc_14026D980
                mov     rax, [rsp+78h+var_50]
                mov     rdi, rcx
                mov     eax, [rax+38h]
                bt      eax, 1Dh
                jb      loc_14026D9C5

loc_14026D92B:                          ; CODE XREF: sub_14026D6F0+293↓j
                                        ; sub_14026D6F0+2F1↓j ...
                mov     r15, rdi

loc_14026D92E:                          ; CODE XREF: sub_14026D6F0+25B↓j
                cmp     rdi, rsi
                jnb     loc_14026D777
                mov     rcx, rdi
                call    sub_1402805F0
                cmp     rax, rbx
                jnz     short loc_14026D95F
                add     r13d, r12d

loc_14026D947:                          ; CODE XREF: sub_14026D6F0+272↓j
                                        ; sub_14026D6F0+278↓j
                add     rdi, 8
                jmp     short loc_14026D92E
; ---------------------------------------------------------------------------

loc_14026D94D:                          ; CODE XREF: sub_14026D6F0+1CA↑j
                cmp     rdi, rbp
                jnz     loc_14026D8C3
                sub     rbp, 8
                jmp     loc_14026D8C3
; ---------------------------------------------------------------------------

loc_14026D95F:                          ; CODE XREF: sub_14026D6F0+252↑j
                cmp     rdi, r15
                jnz     short loc_14026D947
                add     r15, 8
                jmp     short loc_14026D947
; ---------------------------------------------------------------------------

loc_14026D96A:                          ; CODE XREF: sub_14026D6F0+164↑j
                test    edx, edx
                jnz     loc_14026D868
                mov     edx, [rdi+508h]
                add     edx, r12d
                jmp     loc_14026D868
; ---------------------------------------------------------------------------

loc_14026D980:                          ; CODE XREF: sub_14026D6F0+212↑j
                                        ; sub_14026D6F0+224↑j
                mov     rdi, rsi
                jmp     short loc_14026D92B
; ---------------------------------------------------------------------------

loc_14026D985:                          ; CODE XREF: sub_14026D6F0+19A↑j
                mov     r8d, [rsp+78h+arg_20]
                mov     rdx, rsi
                mov     rcx, r15
                call    sub_140270E80
                mov     edx, cs:dword_140C4EBD0
                mov     r15, rax
                lea     ecx, [rdx-1]
                and     ecx, eax
                sub     edx, ecx
                shr     edx, 0Ch
                mov     eax, edx
                dec     rax
                lea     rax, [rsi+rax*8]
                cmp     rbp, rax
                jbe     loc_14026D893
                mov     rbp, rax
                jmp     loc_14026D893
; ---------------------------------------------------------------------------

loc_14026D9C5:                          ; CODE XREF: sub_14026D6F0+235↑j
                mov     edx, cs:dword_140C4EBD0
                dec     edx
                shr     r15d, 0Ch
                shr     edx, 0Ch
                and     edx, r15d
                imul    rax, rdx, -8
                add     rax, rsi
                cmp     rcx, rax
                jnb     loc_14026D92B
                mov     eax, edx
                mov     rdi, rsi
                shl     rax, 3
                sub     rdi, rax
                jmp     loc_14026D92B
sub_14026D6F0   endp

; ---------------------------------------------------------------------------
algn_14026D9F8:                         ; DATA XREF: .rdata:000000014005D2C4↑o
                                        ; .pdata:00000001400CE2BC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026DA00   proc near               ; CODE XREF: sub_14026DA8C+33↓p
                                        ; sub_140274000+1686↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 00000001404410F2 SIZE 00000065 BYTES

                mov     rax, rsp
                mov     [rax+8], rbx
                mov     [rax+10h], rbp
                mov     [rax+18h], rsi
                mov     [rax+20h], rdi
                push    r14
                sub     rsp, 20h
                mov     eax, [rcx+38h]
                mov     rbx, rdx
                mov     ebp, r8d
                mov     rdi, rcx
                test    al, 20h
                jnz     short loc_14026DA7F
                cmp     qword ptr [rcx+40h], 0
                jz      short loc_14026DA7F

loc_14026DA30:                          ; CODE XREF: sub_14026DA00+81↓j
                add     rcx, 48h ; 'H'
                call    ExAcquireSpinLockExclusive
                add     [rdi+20h], rbp
                movzx   esi, al
                test    rbx, rbx
                jz      short loc_14026DA48
                add     [rbx+68h], ebp

loc_14026DA48:                          ; CODE XREF: sub_14026DA00+43↑j
                lea     rcx, [rdi+48h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jnz     loc_1404410F2

loc_14026DA5F:                          ; CODE XREF: sub_14026DA00+1D36F5↓j
                                        ; sub_14026DA00+1D3701↓j ...
                mov     cr8, rsi
                mov     rbx, [rsp+28h+arg_0]
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026DA7F:                          ; CODE XREF: sub_14026DA00+27↑j
                                        ; sub_14026DA00+2E↑j
                xor     ebx, ebx
                jmp     short loc_14026DA30
sub_14026DA00   endp

; ---------------------------------------------------------------------------
byte_14026DA83  db 9 dup(0CCh)          ; DATA XREF: .rdata:000000014005D2F0↑o
                                        ; .pdata:00000001400CE2C8↑o

; =============== S U B R O U T I N E =======================================


sub_14026DA8C   proc near               ; CODE XREF: sub_14026CF00+470↑p
                                        ; DATA XREF: .rdata:000000014005D31C↑o ...

arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h
arg_20          = dword ptr  28h

; FUNCTION CHUNK AT 0000000140441158 SIZE 0000001B BYTES

                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 28h
                mov     r14, [rcx+0D0h]
                mov     rsi, rdx
                mov     ebp, [rcx+0B8h]
                mov     rbx, rcx
                mov     rdx, r14
                mov     r12d, r8d
                mov     r15, r9
                mov     r13, [r14]
                mov     rcx, r13
                call    sub_14026DA00
                mov     rdi, [rbx+0A0h]
                xor     edx, edx
                mov     rcx, rdi
                call    sub_140299BD8
                xor     eax, eax
                mov     [rsp+68h+arg_10], eax

loc_14026DADE:                          ; CODE XREF: sub_14026DA8C+1D36E2↓j
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      loc_140441158
                mov     rdx, [rdi+18h]
                mov     rax, rdx
                lea     rcx, [rdx+r12]
                xor     rax, rcx
                mov     rcx, 3FFFFFFFFFFFFFFFh
                and     rax, rcx
                xor     rax, rdx
                mov     [rdi+18h], rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                mov     rax, [rbx+140h]
                lea     rcx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                add     rcx, rax
                mov     rax, 8000000000000000h
                mov     r12, [rcx+8]
                or      r12, rax
                mov     [rsp+68h+arg_8], r12
                test    r15, r15
                jnz     loc_14026DD6F

loc_14026DB5A:                          ; CODE XREF: sub_14026DA8C+2EE↓j
                mov     rcx, [rbx+0E8h]
                mov     [rsp+68h+arg_18], rcx
                call    sub_1402805F0
                mov     r8d, [rsp+68h+arg_20]
                mov     rdx, r12
                mov     rcx, r14
                mov     [rbx+0A8h], rax
                call    sub_140270E80
                mov     rcx, r14
                mov     r15, rax
                call    sub_140261C00
                mov     ecx, [rbx+0C0h]
                mov     r9d, 20000h
                mov     r8, rax
                test    r9d, ecx
                jnz     loc_14026DD2C
                xor     r10d, r10d
                mov     r14b, r10b

loc_14026DBB1:                          ; CODE XREF: sub_14026DA8C+2B0↓j
                mov     eax, [r13+38h]
                mov     edx, ecx
                test    al, 20h
                jnz     loc_14026DCEE

loc_14026DBBF:                          ; CODE XREF: sub_14026DA8C+269↓j
                                        ; sub_14026DA8C+28A↓j
                mov     rcx, rsi
                and     rsi, 0FFFFFFFFFFFFFFFEh
                and     ecx, 1
                test    rcx, rcx
                jnz     loc_14026DD41

loc_14026DBD2:                          ; CODE XREF: sub_14026DA8C+2B9↓j
                mov     r8d, edx
                test    rcx, rcx
                jnz     loc_14026DD7F

loc_14026DBDE:                          ; CODE XREF: sub_14026DA8C+2C5↓j
                                        ; sub_14026DA8C+2CD↓j ...
                mov     rcx, gs:188h
                call    sub_1402C4F40
                cmp     eax, 2
                jl      loc_14026DD1B

loc_14026DBF5:                          ; CODE XREF: sub_14026DA8C+29B↓j
                mov     eax, ebp
                add     rax, 0FFFh
                mov     [rbx+110h], r10
                shr     rax, 0Ch
                add     ax, 6
                mov     [rbx+11Ah], r10w
                shl     ax, 3
                mov     [rbx+118h], ax
                mov     [rbx+130h], r10
                mov     [rbx+13Ch], r10d
                mov     [rbx+138h], ebp
                mov     [rsp+68h+arg_0], r10d
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      loc_14026DD8A

loc_14026DC45:                          ; CODE XREF: sub_14026DA8C+31F↓j
                mov     al, [rdi+22h]
                mov     rcx, rdi
                and     al, 0DFh
                mov     [rdi+22h], al
                call    sub_14027B630
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                mov     rax, [rsp+68h+arg_18]
                sub     rax, r12
                sar     rax, 3
                mov     rax, [rbx+rax*8+140h]
                lea     rcx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                add     rcx, rax
                xor     r8d, r8d
                movzx   eax, word ptr [rbx+11Ah]
                or      ax, 42h
                mov     [rbx+11Ah], ax
                test    r14b, r14b
                jnz     short loc_14026DCBC
                mov     edx, 4000h
                or      ax, dx
                mov     [rbx+11Ah], ax

loc_14026DCBC:                          ; CODE XREF: sub_14026DA8C+21F↑j
                mov     [rbx+60h], r15
                mov     [rbx+0F0h], r12
                mov     [rbx+0F8h], rcx
                mov     [rbx+0C8h], r8
                mov     [rbx+0D0h], r13
                add     rsp, 28h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026DCEE:                          ; CODE XREF: sub_14026DA8C+12D↑j
                lea     rax, [r15+rbp]
                cmp     rax, r8
                jbe     loc_14026DBBF
                mov     ebp, r8d
                sub     ebp, r15d
                add     ebp, 1FFh
                and     ebp, 0FFFFFE00h
                or      edx, r9d
                mov     [rbx+0C0h], edx
                jmp     loc_14026DBBF
; ---------------------------------------------------------------------------

loc_14026DD1B:                          ; CODE XREF: sub_14026DA8C+163↑j
                bts     r8d, 7
                mov     [rbx+0C0h], r8d
                jmp     loc_14026DBF5
; ---------------------------------------------------------------------------

loc_14026DD2C:                          ; CODE XREF: sub_14026DA8C+119↑j
                btr     ecx, 11h
                mov     r14b, 1
                mov     [rbx+0C0h], ecx
                xor     r10d, r10d
                jmp     loc_14026DBB1
; ---------------------------------------------------------------------------

loc_14026DD41:                          ; CODE XREF: sub_14026DA8C+140↑j
                mov     al, [rsi]
                cmp     al, 1
                jnz     loc_14026DBD2

loc_14026DD4B:                          ; CODE XREF: sub_14026DA8C+2F7↓j
                mov     r8d, edx
                test    rsi, rsi
                jz      loc_14026DBDE
                cmp     al, 2
                jz      loc_14026DBDE
                or      r8d, 8
                mov     [rbx+0C0h], r8d
                jmp     loc_14026DBDE
; ---------------------------------------------------------------------------

loc_14026DD6F:                          ; CODE XREF: sub_14026DA8C+C8↑j
                mov     rdx, r15
                mov     rcx, rbx
                call    sub_140360F2C
                jmp     loc_14026DB5A
; ---------------------------------------------------------------------------

loc_14026DD7F:                          ; CODE XREF: sub_14026DA8C+14C↑j
                mov     al, [rsi]
                cmp     al, 2
                jz      short loc_14026DD4B
                jmp     loc_14026DBDE
; ---------------------------------------------------------------------------

loc_14026DD8A:                          ; CODE XREF: sub_14026DA8C+1B3↑j
                                        ; sub_14026DA8C+30F↓j ...
                lea     rcx, [rsp+68h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_14026DD8A
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_14026DD8A
                mov     r12, [rsp+68h+arg_8]
                jmp     loc_14026DC45
sub_14026DA8C   endp

; ---------------------------------------------------------------------------
byte_14026DDB0  db 8 dup(0CCh)          ; DATA XREF: .rdata:000000014005D31C↑o
                                        ; .pdata:00000001400CE2D4↑o

; =============== S U B R O U T I N E =======================================


sub_14026DDB8   proc near               ; CODE XREF: sub_14026E700+298↓p
                                        ; sub_140355814+13033D↓p ...

var_28          = qword ptr -28h
var_20          = dword ptr -20h
var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140441174 SIZE 00000033 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 40h
                mov     rdi, rcx
                mov     ecx, [rcx+0C0h]
                mov     ebp, ecx
                and     ebp, 8
                bt      ecx, 8
                jb      loc_14026DE90
                mov     eax, ecx
                shr     eax, 1
                and     eax, 4
                mov     esi, eax
                or      esi, 1
                and     ecx, 40000h
                cmovz   esi, eax
                test    ebp, ebp
                jnz     loc_14026DEC6
                mov     ebx, esi
                test    edx, edx
                jnz     short loc_14026DE1B
                mov     rcx, [rdi+0E0h]
                call    sub_140245330
                cmp     eax, 8
                jnz     short loc_14026DE1B
                or      ebx, 2

loc_14026DE1B:                          ; CODE XREF: sub_14026DDB8+4D↑j
                                        ; sub_14026DDB8+5E↑j ...
                test    ebp, ebp
                jnz     short loc_14026DE3D
                mov     rax, gs:188h
                mov     rdx, [rax+220h]
                mov     eax, [rdx+8E0h]

loc_14026DE35:                          ; CODE XREF: sub_14026DDB8+1D33C7↓j
                test    eax, eax
                jnz     loc_140441174

loc_14026DE3D:                          ; CODE XREF: sub_14026DDB8+65↑j
                                        ; sub_14026DDB8+1D33D0↓j
                and     [rsp+48h+var_18], 0
                lea     rbp, [rdi+20h]
                mov     rcx, [rdi+0C8h]
                lea     rsi, [rdi+50h]
                mov     r9, rbp
                mov     [rsp+48h+var_20], ebx
                lea     r8, [rdi+60h]
                mov     [rsp+48h+var_28], rsi
                lea     rdx, [rdi+110h]
                call    sub_1402A2250

loc_14026DE6E:                          ; CODE XREF: sub_14026DDB8+10C↓j
                mov     ebx, eax
                test    eax, eax
                js      loc_14044118D

loc_14026DE78:                          ; CODE XREF: sub_14026DDB8+1D33EA↓j
                mov     rbp, [rsp+48h+arg_8]
                mov     eax, ebx
                mov     rbx, [rsp+48h+arg_0]
                mov     rsi, [rsp+48h+arg_10]
                add     rsp, 40h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_14026DE90:                          ; CODE XREF: sub_14026DDB8+26↑j
                lea     rax, [rdi+110h]
                mov     rcx, rax
                or      rcx, 1
                test    ebp, ebp
                cmovz   rcx, rax
                mov     rdx, rcx
                test    r8b, 1
                jnz     short loc_14026DED0

loc_14026DEAD:                          ; CODE XREF: sub_14026DDB8+120↓j
                                        ; sub_14026DDB8+12A↓j ...
                lea     rsi, [rdi+50h]
                lea     rbp, [rdi+20h]
                mov     r9, rsi
                mov     r8, rbp
                lea     rcx, [rdi+60h]
                call    sub_14035EC9C
                jmp     short loc_14026DE6E
; ---------------------------------------------------------------------------

loc_14026DEC6:                          ; CODE XREF: sub_14026DDB8+43↑j
                or      esi, 2
                mov     ebx, esi
                jmp     loc_14026DE1B
; ---------------------------------------------------------------------------

loc_14026DED0:                          ; CODE XREF: sub_14026DDB8+F3↑j
                and     r8, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [r8], 1
                jnz     short loc_14026DEAD
                test    dword ptr [r8+50h], 800h
                jz      short loc_14026DEAD
                or      rdx, 2
                jmp     short loc_14026DEAD
sub_14026DDB8   endp

; ---------------------------------------------------------------------------
algn_14026DEEA:                         ; DATA XREF: .rdata:000000014005D344↑o
                                        ; .pdata:00000001400CE2E0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026DEF0   proc near               ; CODE XREF: sub_14026E700+3C0↓p
                                        ; sub_14029F1DC+7E↓p
                                        ; DATA XREF: ...

var_C8          = qword ptr -0C8h
var_C0          = dword ptr -0C0h
var_B8          = dword ptr -0B8h
var_B0          = dword ptr -0B0h
var_A8          = dword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_88          = dword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
arg_0           = qword ptr  8
arg_8           = byte ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h

                mov     rax, rsp
                mov     [rax+18h], r8
                mov     [rax+8], rcx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 0A8h
                mov     rdi, [rcx+38h]
                lea     r13, [rdx+110h]
                mov     byte ptr [rax+10h], 0
                xor     r15d, r15d
                mov     [rax+20h], r15d
                mov     r8, rcx
                mov     rax, [rdx+0E8h]
                mov     rbx, 0FFFFFFFFFFFFFFFFh
                mov     rcx, [rdx+0F8h]
                mov     r14, rdx
                mov     [rsp+0E8h+var_58], rax
                mov     r9, 2AAAAAAAAAAAAAABh
                mov     rax, [rdx+0E0h]
                mov     [rsp+0E8h+var_78], rax
                mov     rax, [rdx+100h]
                test    rax, rax
                mov     [rsp+0E8h+var_70], rbx
                mov     rbp, [rcx+28h]
                cmovnz  r13, rax
                mov     [rsp+0E8h+var_80], rdi
                mov     rax, 1000000000h
                mov     [rsp+0E8h+var_60], rcx
                mov     rdx, 0FFFFFA8000000000h
                lea     r12, [r13+30h]
                test    rax, rbp
                jnz     loc_14026E0AE
                mov     rax, [rcx+8]
                test    rax, rax
                js      loc_14026E0AE
                jz      loc_14026E0AE
                mov     rax, rdx
                sub     rcx, rax
                mov     rax, r9
                imul    rcx
                mov     rcx, rdx
                sar     rcx, 3
                mov     rax, rcx
                shr     rax, 3Fh
                add     rcx, rax
                mov     rax, 0FFFFFFFFFh
                mov     [rsp+0E8h+var_68], rcx
                cmp     rcx, rax
                jnb     loc_14026E0AE
                mov     rax, cs:qword_140C4E4C8
                mov     esi, [r8+50h]
                shl     esi, 0Bh
                shr     rbp, 27h
                not     esi
                and     ebp, 3FFh
                and     esi, 20000h
                bts     esi, 1Eh
                mov     rbp, [rax+rbp*8]
                mov     rax, gs:188h
                mov     rdi, [rax+4D0h]
                call    sub_14027DEC0
                mov     rcx, [rsp+0E8h+var_60]
                mov     r9d, esi
                mov     rdx, [rsp+0E8h+var_68]
                or      r9d, 8
                mov     r8, 0FFFFFFFFFh
                mov     eax, [rax+8]
                movzx   r10d, byte ptr [rcx+22h]
                lea     rcx, sub_1403B4010
                shr     r10d, 6
                cmp     rdi, rcx
                lea     rcx, [rsp+0E8h+var_70]
                mov     [rsp+0E8h+var_98], rcx
                mov     rcx, rbp
                mov     [rsp+0E8h+var_A0], r15
                cmovnz  r9d, esi
                mov     [rsp+0E8h+var_A8], r9d
                inc     rdx
                mov     [rsp+0E8h+var_B0], 80000000h
                xor     r9d, r9d
                mov     [rsp+0E8h+var_B8], eax
                mov     [rsp+0E8h+var_C0], r10d
                mov     [rsp+0E8h+var_C8], 1
                call    sub_1402D80F0
                mov     r8, [rsp+0E8h+arg_0]
                mov     rdi, [rsp+0E8h+var_80]

loc_14026E0AE:                          ; CODE XREF: sub_14026DEF0+AC↑j
                                        ; sub_14026DEF0+B9↑j ...
                mov     rdx, [r8+10h]
                test    dl, 1
                jz      short loc_14026E0D0
                and     rdx, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rdx], 2
                jnz     short loc_14026E0D0
                test    rdi, rdi
                jz      short loc_14026E0D0
                mov     r8, rdi
                mov     rcx, r14
                call    sub_1403620A4

loc_14026E0D0:                          ; CODE XREF: sub_14026DEF0+1C5↑j
                                        ; sub_14026DEF0+1CE↑j ...
                xor     r9d, r9d
                mov     [rsp+0E8h+var_C8], r15
                lea     rcx, [r14+20h]
                xor     r8d, r8d
                lea     edx, [r9+9]
                call    KeWaitForSingleObject
                cmp     [r14+108h], r15
                jnz     loc_14026E646
                test    rdi, rdi
                jz      short loc_14026E120
                movzx   eax, byte ptr [rdi+0BBh]
                and     al, 60h
                cmp     al, 60h ; '`'
                jnz     short loc_14026E120
                mov     rcx, rdi
                call    sub_1402325E0
                cmp     [rax+20h], r15
                jnz     short loc_14026E120
                lea     rcx, [r14+68h]
                xor     edx, edx
                call    sub_14021E230

loc_14026E120:                          ; CODE XREF: sub_14026DEF0+208↑j
                                        ; sub_14026DEF0+215↑j ...
                mov     ecx, 200h
                test    [r13+0Ah], cx
                jz      short loc_14026E140
                mov     rcx, r13
                call    sub_140530EC0
                mov     dword ptr [r14+50h], 0C000009Ah
                mov     [r14+58h], r15

loc_14026E140:                          ; CODE XREF: sub_14026DEF0+23A↑j
                mov     edx, [r14+0C0h]
                test    dl, 10h
                jz      short loc_14026E196
                mov     rbp, [r14+150h]
                test    rbp, rbp
                jz      short loc_14026E196
                lea     rcx, [rbp+0E8h]
                call    ExAcquireSpinLockExclusive
                lea     rdx, [r14+160h]
                movzx   edi, al
                lea     rcx, [rbp+0F0h]
                call    RtlAvlRemoveNode
                movzx   edx, dil
                lea     rcx, [rbp+0E8h]
                call    ExReleaseSpinLockExclusive
                mov     edx, [r14+0C0h]
                mov     rdi, [rsp+0E8h+var_80]

loc_14026E196:                          ; CODE XREF: sub_14026DEF0+25A↑j
                                        ; sub_14026DEF0+266↑j
                mov     eax, [r14+0B8h]
                mov     ebp, r15d
                mov     ecx, [r13+2Ch]
                add     rcx, [r13+20h]
                mov     dword ptr [rsp+0E8h+arg_0], eax
                and     ecx, 0FFFh
                mov     eax, [r13+28h]
                add     rax, 0FFFh
                add     rax, rcx
                shr     rax, 0Ch
                dec     rax
                lea     rax, [r12+rax*8]
                mov     [rsp+0E8h+var_68], rax
                bt      edx, 8
                jnb     short loc_14026E1EB
                lea     rdx, [rsp+0E8h+arg_18]
                mov     rcx, r14
                call    sub_14035EB80

loc_14026E1EB:                          ; CODE XREF: sub_14026DEF0+2E9↑j
                mov     eax, [r14+50h]
                cmp     [r14+0D0h], rbp
                jz      short loc_14026E228
                test    eax, eax
                js      short loc_14026E218
                mov     rcx, r14
                call    sub_1402990B0
                mov     ebp, eax
                cmp     eax, 0C0000434h
                jnz     short loc_14026E218
                or      dword ptr [r14+0C0h], 100000h

loc_14026E218:                          ; CODE XREF: sub_14026DEF0+30A↑j
                                        ; sub_14026DEF0+31B↑j
                mov     rcx, [r14+0D0h]
                xor     edx, edx
                call    sub_1402FAD30
                jmp     short loc_14026E243
; ---------------------------------------------------------------------------

loc_14026E228:                          ; CODE XREF: sub_14026DEF0+306↑j
                test    eax, eax
                js      short loc_14026E243
                test    dword ptr [r14+0C0h], 400000h
                jz      short loc_14026E243
                mov     rcx, r14
                call    sub_14055D91C
                mov     ebp, eax

loc_14026E243:                          ; CODE XREF: sub_14026DEF0+336↑j
                                        ; sub_14026DEF0+33A↑j ...
                mov     edx, [rsp+0E8h+arg_18]
                mov     esi, [r14+50h]
                and     edx, 1
                mov     [rsp+0E8h+var_88], edx
                jnz     short loc_14026E295
                inc     dword ptr gs:2EA4h
                mov     ecx, r15d
                mov     eax, dword ptr [rsp+0E8h+arg_0]
                test    eax, 0FFFh
                setnz   cl
                shr     eax, 0Ch
                add     ecx, eax
                add     gs:2EA0h, ecx
                test    rdi, rdi
                jz      short loc_14026E295
                mov     eax, [r14+0C0h]
                test    al, 8
                jnz     short loc_14026E295
                lock inc dword ptr [rdi+0A8h]

loc_14026E295:                          ; CODE XREF: sub_14026DEF0+365↑j
                                        ; sub_14026DEF0+391↑j ...
                mov     rax, [rsp+0E8h+arg_10]
                lea     edi, [rdx+rdx]
                mov     rcx, [rax]
                test    rcx, rcx
                jz      short loc_14026E2B7
                mov     edx, edi
                call    sub_14034D850
                mov     rax, [rsp+0E8h+arg_10]

loc_14026E2B7:                          ; CODE XREF: sub_14026DEF0+3B6↑j
                test    byte ptr [r13+0Ah], 1
                mov     [rax], edi
                jz      short loc_14026E2CC
                mov     rcx, [r13+18h]
                mov     rdx, r13
                call    MmUnmapLockedPages

loc_14026E2CC:                          ; CODE XREF: sub_14026DEF0+3CE↑j
                mov     dword ptr [rsp+0E8h+var_80], r15d
                mov     edi, 0C0000017h
                mov     dword ptr [r14+0BCh], 0FFFFFFFFh
                test    esi, esi
                js      loc_14026E438
                mov     r12, [r14+58h]
                mov     edx, dword ptr [rsp+0E8h+arg_0]
                cmp     r12, rdx
                jz      loc_14026E3E3
                test    r12, r12
                jnz     short loc_14026E314
                mov     eax, [r14+0C0h]
                test    al, 8
                jz      short loc_14026E314
                mov     esi, edi
                jmp     loc_14026E3E3
; ---------------------------------------------------------------------------

loc_14026E314:                          ; CODE XREF: sub_14026DEF0+410↑j
                                        ; sub_14026DEF0+41B↑j
                test    dword ptr [r14+0C0h], 200000h
                jz      short loc_14026E32C
                cmp     [rsp+0E8h+var_88], r15d
                jz      loc_14026E665

loc_14026E32C:                          ; CODE XREF: sub_14026DEF0+42F↑j
                sub     edx, [r13+28h]
                mov     ecx, [r13+2Ch]
                add     rcx, [r13+20h]
                and     ecx, 0FFFh
                mov     eax, edx
                sub     rcx, rax
                lea     rax, [r12+0FFFh]
                add     rax, rcx
                shr     rax, 0Ch
                lea     rcx, ds:28h[rax*8]
                mov     [rsp+0E8h+arg_0], rcx
                and     r12d, 0FFFh
                jz      short loc_14026E3C1
                mov     rcx, [rcx+r13]
                lea     rdx, [rsp+0E8h+arg_8]
                mov     r8d, 80000000h
                call    sub_1402D6810
                mov     rdi, rax
                mov     r8d, 1000h
                mov     eax, r12d
                sub     r8d, r12d
                add     rdi, rax
                xor     edx, edx
                mov     rcx, rdi
                call    memset
                movzx   edx, [rsp+0E8h+arg_8]
                mov     r8d, 80000000h
                mov     rcx, rdi
                call    sub_1402432B0
                mov     rcx, [rsp+0E8h+arg_0]
                mov     edi, 0C0000017h

loc_14026E3C1:                          ; CODE XREF: sub_14026DEF0+479↑j
                lea     rax, [r13+8]
                add     rax, rcx
                cmp     rax, [rsp+0E8h+var_68]
                ja      short loc_14026E3E3
                lea     rax, [rcx-30h]
                sar     rax, 3
                inc     eax
                mov     [r14+0BCh], eax

loc_14026E3E3:                          ; CODE XREF: sub_14026DEF0+407↑j
                                        ; sub_14026DEF0+41F↑j ...
                cmp     ebp, 0C000003Fh
                jnz     loc_14026E51F

loc_14026E3EF:                          ; CODE XREF: sub_14026DEF0+61C↓j
                mov     r12, [rsp+0E8h+var_78]
                mov     rax, 7FFFFFFEFFFFh
                cmp     r12, rax
                jbe     loc_14026E51F
                mov     rcx, r12
                call    sub_140245330
                cmp     eax, 8
                jz      loc_14026E51F
                mov     rcx, r12
                call    sub_14052D1F8
                test    eax, eax
                jnz     loc_14026E51F
                cmp     dword ptr [rsp+0E8h+var_80], r15d
                jz      loc_14026E683
                jmp     loc_14026E516
; ---------------------------------------------------------------------------

loc_14026E438:                          ; CODE XREF: sub_14026DEF0+3F3↑j
                cmp     esi, 0C0000011h
                jnz     loc_14026E4C4
                test    dword ptr [r14+0C0h], 200000h
                jnz     loc_14026E6CA
                mov     rdi, [rsp+0E8h+var_68]
                mov     esi, 1
                sub     rdi, r12
                mov     r13, 0FFFFFA8000000000h
                add     rdi, 8
                shr     rdi, 3
                cmp     r12, [rsp+0E8h+var_68]
                cmova   rdi, r15
                cmp     rsi, rdi
                ja      short loc_14026E4BF
                nop     dword ptr [rax+rax+00000000h]

loc_14026E490:                          ; CODE XREF: sub_14026DEF0+5CD↓j
                mov     rcx, [r12]
                lea     rdx, [rcx+rcx*2]
                add     rdx, rdx
                mov     rax, r13
                movzx   r8d, byte ptr [rax+rdx*8+22h]
                mov     edx, 3
                shr     r8d, 6
                call    sub_1402E5704
                inc     rsi
                lea     r12, [r12+8]
                cmp     rsi, rdi
                jbe     short loc_14026E490

loc_14026E4BF:                          ; CODE XREF: sub_14026DEF0+596↑j
                mov     esi, r15d
                jmp     short loc_14026E529
; ---------------------------------------------------------------------------

loc_14026E4C4:                          ; CODE XREF: sub_14026DEF0+54E↑j
                cmp     esi, 80000016h
                jz      short loc_14026E51F
                mov     edx, [r13+28h]
                mov     ecx, esi
                call    sub_14033ADF4
                mov     dword ptr [rsp+0E8h+var_80], eax
                test    eax, eax
                jz      short loc_14026E503
                cmp     cs:dword_140C4EB40, r15d
                jnz     short loc_14026E503
                cmp     [rsp+0E8h+var_88], r15d
                jz      short loc_14026E4F9
                test    byte ptr [rsp+0E8h+arg_18], 2
                jz      short loc_14026E503

loc_14026E4F9:                          ; CODE XREF: sub_14026DEF0+5FD↑j
                mov     cs:dword_140C4EB40, 20h ; ' '

loc_14026E503:                          ; CODE XREF: sub_14026DEF0+5ED↑j
                                        ; sub_14026DEF0+5F6↑j ...
                mov     eax, [r14+0C0h]
                test    al, 8
                jz      loc_14026E3EF
                mov     esi, edi
                jmp     short loc_14026E51F
; ---------------------------------------------------------------------------

loc_14026E516:                          ; CODE XREF: sub_14026DEF0+543↑j
                cmp     ebp, 0C000003Fh
                cmovnz  esi, edi

loc_14026E51F:                          ; CODE XREF: sub_14026DEF0+4F9↑j
                                        ; sub_14026DEF0+511↑j ...
                mov     r13, 0FFFFFA8000000000h

loc_14026E529:                          ; CODE XREF: sub_14026DEF0+5D2↑j
                mov     rcx, [rsp+0E8h+var_70]
                cmp     rcx, rbx
                jz      loc_14026E61E
                mov     rdx, r13
                mov     rbp, [rsp+0E8h+var_60]
                mov     rax, 2AAAAAAAAAAAAAABh
                mov     r8, rbp
                mov     r9d, 1
                sub     r8, rdx
                imul    r8
                xor     r8d, r8d
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                call    sub_14025B390
                mov     rax, [rsp+0E8h+var_70]
                lea     r15, [rax+rax*2]
                shl     r15, 4
                mov     rax, r13
                add     r15, rax
                mov     rax, cs:qword_14001D278
                lea     rcx, [r15+10h]
                mov     [rcx], rax
                call    sub_14027C660
                mov     r8, [r15+28h]
                shr     r8, 3Ch
                and     r8b, 7
                cmp     r8b, 3
                jnz     short loc_14026E61E
                mov     rcx, r15
                call    sub_1402DAA00
                mov     rcx, [rbp+8]
                movzx   edi, al
                mov     rax, 7FFFFFFFFFFFFFFFh
                mov     [r15+8], rcx
                lock and [r15+18h], rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14026E61A
                test    al, 1
                jz      short loc_14026E61A
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14026E61A
                cmp     dil, 0Fh
                ja      short loc_14026E61A
                cmp     al, 2
                jb      short loc_14026E61A
                mov     r9, gs:20h
                lea     ecx, [rdi+1]
                shl     rbx, cl
                movzx   eax, bx
                not     eax
                mov     r8, [r9+84B8h]
                mov     edx, [r8+14h]
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_14026E61A
                mov     rcx, r9
                call    sub_1403F2EC4

loc_14026E61A:                          ; CODE XREF: sub_14026DEF0+6E3↑j
                                        ; sub_14026DEF0+6E7↑j ...
                mov     cr8, rdi

loc_14026E61E:                          ; CODE XREF: sub_14026DEF0+641↑j
                                        ; sub_14026DEF0+6B7↑j
                mov     eax, [rsp+0E8h+arg_18]
                mov     [r14+70h], eax
                mov     [r14+68h], r15
                mov     [r14+50h], esi
                add     rsp, 0A8h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026E646:                          ; CODE XREF: sub_14026DEF0+1FF↑j
                mov     r9, [r14+108h]
                mov     r8, r14
                mov     edx, 61947h
                mov     [rsp+0E8h+var_C8], r15
                mov     ecx, 1Ah
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14026E665:                          ; CODE XREF: sub_14026DEF0+436↑j
                mov     rax, [rsp+0E8h+var_78]
                mov     edx, 4
                mov     r9, r14
                mov     [rsp+0E8h+var_C8], rax
                mov     r8, r12
                lea     ecx, [rdx+76h]
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14026E683:                          ; CODE XREF: sub_14026DEF0+53D↑j
                mov     rdi, [rsp+0E8h+var_58]
                mov     rcx, rdi
                call    sub_14029B5F0
                cmp     al, 1
                jnz     short loc_14026E6A2
                mov     rcx, rdi
                call    sub_1402805F0
                mov     rbx, rax

loc_14026E6A2:                          ; CODE XREF: sub_14026DEF0+7A5↑j
                mov     ecx, 1
                call    sub_140535798
                test    ebp, ebp
                mov     [rsp+0E8h+var_C8], r12
                mov     r9, rbx
                mov     rdx, rdi
                cmovns  ebp, esi
                mov     ecx, 7Ah ; 'z'
                movsxd  r8, ebp
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14026E6CA:                          ; CODE XREF: sub_14026DEF0+55F↑j
                mov     rax, [rsp+0E8h+var_78]
                mov     edx, 3
                mov     r9, r14
                mov     [rsp+0E8h+var_C8], rax
                mov     r8, 0FFFFFFFFC0000011h
                lea     ecx, [rdx+77h]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026DEF0   endp

algn_14026E6EC:                         ; DATA XREF: .pdata:00000001400CE2EC↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=70h

sub_14026E700   proc near               ; CODE XREF: sub_140224260+463↑p
                                        ; sub_14029AEC0+1AD648↓p
                                        ; DATA XREF: ...

var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = qword ptr -0D0h
var_C0          = byte ptr -0C0h
var_B0          = dword ptr -0B0h
var_70          = byte ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  10h
arg_8           = qword ptr  18h
arg_10          = qword ptr  20h

; __unwind { // __GSHandlerCheck
                push    rbp
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 90h
                lea     rbp, [rsp+40h]
                mov     [rbp+70h+arg_0], rbx
                mov     [rbp+70h+arg_8], rsi
                mov     [rbp+70h+arg_10], rdi
                mov     rax, cs:__security_cookie
                xor     rax, rbp
                mov     [rbp+70h+var_30], rax
                mov     rax, [rdx+0D0h]
                mov     r13, rcx
                mov     r12, [rdx+98h]
                xor     r14d, r14d
                mov     [rbp+70h+var_40], rcx
                mov     rdi, rdx
                mov     rcx, [rcx]
                mov     ebx, r14d
                mov     [rdx+0E0h], rcx
                mov     [rbp+70h+var_70], 0
                mov     [rbp+70h+var_58], r14
                mov     [rbp+70h+var_50], rax
                call    sub_140270F20
                mov     edx, eax
                mov     rcx, rdi
                call    sub_14026F714
                mov     rsi, rax
                lea     r8, [rbp+70h+var_70]
                lea     rax, [r13+38h]
                mov     dl, 1
                mov     rcx, rax
                mov     [rbp+70h+var_48], rax
                call    sub_14026EDF8
                mov     r15, [r13+10h]
                mov     [rbp+70h+var_68], rax
                test    rsi, rsi
                jz      short loc_14026E7B8
                mov     rcx, [rbp+70h+var_50]
                mov     [rdi+0C8h], rsi
                mov     ebx, [rcx+38h]
                shr     ebx, 5
                and     ebx, 1
                jmp     short loc_14026E7CA
; ---------------------------------------------------------------------------

loc_14026E7B8:                          ; CODE XREF: sub_14026E700+A0↑j
                mov     rax, [rdi+0C8h]
                mov     rcx, [rax+38h]
                mov     [rdi+0C8h], rcx

loc_14026E7CA:                          ; CODE XREF: sub_14026E700+B6↑j
                mov     rax, [r13+10h]
                test    al, 1
                jz      short loc_14026E7DB
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 1
                jz      short loc_14026E7E3

loc_14026E7DB:                          ; CODE XREF: sub_14026E700+D0↑j
                inc     byte ptr [r12+51Eh]

loc_14026E7E3:                          ; CODE XREF: sub_14026E700+D9↑j
                mov     rax, [r13+38h]
                test    byte ptr [rax+0B8h], 7
                jnz     short loc_14026E7FB
                dec     word ptr [r12+1E4h]
                jmp     short loc_14026E804
; ---------------------------------------------------------------------------

loc_14026E7FB:                          ; CODE XREF: sub_14026E700+EE↑j
                dec     word ptr [r12+1E6h]

loc_14026E804:                          ; CODE XREF: sub_14026E700+F9↑j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14026E865
                test    al, 1
                jz      short loc_14026E865
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14026E865
                movzx   esi, [rbp+70h+var_70]
                cmp     sil, 0Fh
                ja      short loc_14026E869
                cmp     al, 2
                jb      short loc_14026E869
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                movzx   esi, [rbp+70h+var_70]
                lea     ecx, [rsi+1]
                shl     rdx, cl
                movzx   eax, dx
                not     eax
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14026E869
                mov     rcx, r10
                call    sub_1403F2EC4
                jmp     short loc_14026E869
; ---------------------------------------------------------------------------

loc_14026E865:                          ; CODE XREF: sub_14026E700+10C↑j
                                        ; sub_14026E700+110↑j ...
                movzx   esi, [rbp+70h+var_70]

loc_14026E869:                          ; CODE XREF: sub_14026E700+122↑j
                                        ; sub_14026E700+126↑j ...
                movzx   eax, sil
                mov     cr8, rax
                mov     r8d, [rdi+138h]
                mov     ecx, r14d
                test    r8d, 0FFFh
                mov     r9, 0FFFFFA8000000000h
                mov     eax, r8d
                setnz   cl
                shr     eax, 0Ch
                add     ecx, eax
                test    dword ptr [rdi+0C0h], 20000h
                jz      short loc_14026E8D0
                mov     rcx, [rdi+rcx*8+138h]
                lea     rdx, [rcx+rcx*2]
                add     rdx, rdx
                mov     rax, r9
                movzx   r8d, byte ptr [rax+rdx*8+22h]
                mov     edx, 3
                shr     r8d, 6
                call    sub_1402E5704
                mov     r8d, [rdi+138h]

loc_14026E8D0:                          ; CODE XREF: sub_14026E700+1A1↑j
                mov     [rdi+0B8h], r8d
                mov     [rbp+70h+var_60], r14
                cmp     [rdi+24h], r14d
                jnz     loc_14026E99F
                mov     ecx, [rdi+0C0h]
                mov     eax, ecx
                and     eax, 200008h
                cmp     eax, 200008h
                jnz     short loc_14026E903
                bt      ecx, 8
                jnb     loc_14026E9A4

loc_14026E903:                          ; CODE XREF: sub_14026E700+1F7↑j
                test    dword ptr cs:xmmword_140CFC480, 2000h
                jnz     short loc_14026E919
                mov     eax, cs:dword_140CEC0D4
                test    al, 1
                jz      short loc_14026E957

loc_14026E919:                          ; CODE XREF: sub_14026E700+20D↑j
                bt      ecx, 8
                jb      short loc_14026E957
                test    cl, 8
                jnz     short loc_14026E957
                mov     eax, [rsp+0B0h+var_B0]
                sub     rsp, 50h
                lea     rcx, [rsp+100h+var_C0]
                mov     eax, [rcx]
                mov     rax, [rdi+0C8h]
                mov     rdx, [rdi+60h]
                mov     r9, [rdi+0E0h]
                mov     [rsp+100h+var_D8], r12
                mov     [rsp+100h+var_E0], rax
                mov     [rbp+70h+var_60], rcx
                call    sub_140340A54

loc_14026E957:                          ; CODE XREF: sub_14026E700+217↑j
                                        ; sub_14026E700+21D↑j ...
                mov     rcx, [r13+38h]
                lea     rsi, [r13+38h]
                movzx   eax, byte ptr [rcx+0BBh]
                and     al, 60h
                cmp     al, 60h ; '`'
                jnz     short loc_14026E989
                call    sub_1402325E0
                cmp     [rax+20h], r14
                jnz     short loc_14026E989
                mov     rcx, cs:PsInitialSystemProcess
                lea     r8, [rdi+68h]
                xor     edx, edx
                call    sub_1402D3C90

loc_14026E989:                          ; CODE XREF: sub_14026E700+26A↑j
                                        ; sub_14026E700+275↑j
                mov     r8, [r13+10h]
                or      ebx, 2
                mov     edx, ebx
                mov     rcx, rdi
                and     edx, 1
                call    sub_14026DDB8
                jmp     short loc_14026E9A8
; ---------------------------------------------------------------------------

loc_14026E99F:                          ; CODE XREF: sub_14026E700+1DF↑j
                mov     ebx, 2

loc_14026E9A4:                          ; CODE XREF: sub_14026E700+1FD↑j
                lea     rsi, [r13+38h]

loc_14026E9A8:                          ; CODE XREF: sub_14026E700+29D↑j
                mov     rcx, [r13+10h]
                test    cl, 1
                jz      loc_14026EA86
                and     rcx, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rcx], 1
                jnz     loc_14026EA86
                mov     rax, [rsi]
                movzx   edx, byte ptr [rax+0B8h]
                movzx   eax, dl
                and     al, 7
                cmp     al, 2
                jb      short loc_14026E9EB
                lea     eax, ds:0FFFFFFFFFFFFFFFEh[rdx*2]
                xor     eax, [rdi+0C0h]
                and     eax, 6
                xor     [rdi+0C0h], eax

loc_14026E9EB:                          ; CODE XREF: sub_14026E700+2D3↑j
                cmp     ebx, 2
                jb      short loc_14026EA0D
                mov     rax, [rcx+30h]
                add     rcx, 28h ; '('
                cmp     [rax], rcx
                jnz     short loc_14026EA1A
                mov     [rdi], rcx
                mov     [rdi+8], rax
                mov     [rax], rdi
                mov     [rcx+8], rdi
                jmp     short loc_14026EA39
; ---------------------------------------------------------------------------

loc_14026EA0D:                          ; CODE XREF: sub_14026E700+2EE↑j
                mov     rdx, [rcx+40h]
                lea     rax, [rcx+38h]
                cmp     [rdx], rax
                jz      short loc_14026EA21

loc_14026EA1A:                          ; CODE XREF: sub_14026E700+2FB↑j
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
; ---------------------------------------------------------------------------

loc_14026EA21:                          ; CODE XREF: sub_14026E700+318↑j
                mov     [rdi], rax
                mov     [rdi+8], rdx
                mov     [rdx], rdi
                mov     [rax+8], rdi
                mov     eax, [rdi+0B8h]
                add     [rcx+48h], rax

loc_14026EA39:                          ; CODE XREF: sub_14026E700+30B↑j
                mov     rax, cr8
                mov     r13d, 1
                mov     cr8, r13
                mov     rax, [rsi]
                mov     rcx, r12
                test    byte ptr [rax+0B8h], 7
                jnz     short loc_14026EA6E
                call    sub_14021E1F0
                mov     rdx, [rbp+70h+var_68]
                mov     rcx, rsi
                call    sub_1402A7FA0
                xor     eax, eax
                jmp     loc_14026EBBF
; ---------------------------------------------------------------------------

loc_14026EA6E:                          ; CODE XREF: sub_14026E700+354↑j
                call    sub_140245770
                mov     rdx, [rbp+70h+var_68]
                mov     rcx, rsi
                call    sub_1402A7FA0
                xor     eax, eax
                jmp     loc_14026EBBF
; ---------------------------------------------------------------------------

loc_14026EA86:                          ; CODE XREF: sub_14026E700+2AF↑j
                                        ; sub_14026E700+2BC↑j
                mov     r14, [rdi+0F8h]
                mov     rcx, 1000000000h
                mov     rsi, [rdi+0E8h]
                test    [r14+28h], rcx
                jnz     short loc_14026EAB6
                mov     rax, [r14+8]
                test    rax, rax
                js      short loc_14026EAB6
                mov     eax, 0
                cmovnz  r14, rax

loc_14026EAB6:                          ; CODE XREF: sub_14026E700+3A2↑j
                                        ; sub_14026E700+3AB↑j
                lea     r8, [rbp+70h+var_60]
                mov     rdx, rdi
                mov     rcx, r13
                call    sub_14026DEF0
                mov     rdx, [rbp+70h+var_68]
                lea     r9, [rbp+70h+var_58]
                mov     r8, rdi
                mov     rcx, r13
                call    sub_1402973D0
                mov     edi, eax
                mov     eax, dword ptr [rbp+70h+var_60]
                dec     byte ptr [r12+51Eh]
                mov     dword ptr [rbp+70h+var_68], eax
                test    edi, edi
                jnz     loc_14026EBBD
                test    r14, r14
                jnz     short loc_14026EB27
                lea     rcx, [rbp+70h+var_58]
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     r14, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     r14, 4
                mov     rax, rax
                add     r14, rax

loc_14026EB27:                          ; CODE XREF: sub_14026E700+3F3↑j
                mov     edx, [r13+8]
                mov     rcx, r14
                and     edx, 2
                mov     [rbp+70h+var_50], rdx
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14026EBEF
                mov     rsi, [r13+0]
                mov     rax, 7FFFFFFFF8h
                shr     rsi, 9
                and     rsi, rax
                mov     rax, 0FFFFF68000000000h
                mov     r8d, edx
                mov     [rsp+100h+var_E0], r15
                mov     rdx, [rbp+70h+var_58]
                xor     r9d, r9d
                mov     rcx, r13
                add     rsi, rax
                call    sub_14022B420
                mov     edi, eax
                test    eax, eax
                js      short loc_14026EBBD
                mov     rbx, [rbp+70h+var_48]

loc_14026EB85:                          ; CODE XREF: sub_14026E700+6D5↓j
                cmp     cs:dword_140C4E6A8, 0
                jz      short loc_14026EBB3
                cmp     dword ptr [rbp+70h+var_68], 2
                jz      short loc_14026EBB3
                mov     rcx, r12
                call    sub_1402DEE04
                cmp     eax, cs:dword_140C4E6AC
                jb      short loc_14026EBB3
                mov     rcx, [rbx]
                or      rsi, 1
                mov     rdx, rsi
                call    sub_14028CE50

loc_14026EBB3:                          ; CODE XREF: sub_14026E700+48C↑j
                                        ; sub_14026E700+492↑j ...
                test    edi, edi
                mov     eax, 114h
                cmovz   edi, eax

loc_14026EBBD:                          ; CODE XREF: sub_14026E700+3EA↑j
                                        ; sub_14026E700+47F↑j ...
                mov     eax, edi

loc_14026EBBF:                          ; CODE XREF: sub_14026E700+369↑j
                                        ; sub_14026E700+381↑j ...
                mov     rcx, [rbp+70h+var_30]
                xor     rcx, rbp
                call    __security_check_cookie
                mov     rbx, [rbp+70h+arg_0]
                mov     rsi, [rbp+70h+arg_8]
                mov     rdi, [rbp+70h+arg_10]
                lea     rsp, [rbp+50h]
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026EBEF:                          ; CODE XREF: sub_14026E700+43C↑j
                mov     rax, r15
                mov     r13, 8000000000000000h
                and     eax, 1
                mov     [rbp+70h+var_38], rax
                jz      loc_14026EC89
                mov     rax, r15
                and     rax, 0FFFFFFFFFFFFFFFEh
                cmp     byte ptr [rax], 4
                jnz     short loc_14026EC89
                mov     rcx, rsi
                call    sub_1402805F0
                mov     rbx, rax
                mov     rcx, rsi
                and     rbx, 0FFFFFFFFFFFFFC9Fh
                bts     rbx, 7
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14026EC86
                call    sub_140349680
                test    eax, eax
                jz      short loc_14026EC62
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14026EC52
                test    bl, 1
                jz      short loc_14026EC52
                or      rbx, r13

loc_14026EC52:                          ; CODE XREF: sub_14026E700+548↑j
                                        ; sub_14026E700+54D↑j
                mov     rdx, rbx
                mov     [rsi], rbx
                mov     rcx, rsi
                call    sub_140349620
                jmp     short loc_14026EC89
; ---------------------------------------------------------------------------

loc_14026EC62:                          ; CODE XREF: sub_14026E700+53F↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14026EC86
                test    bl, 1
                jz      short loc_14026EC86
                or      rbx, r13

loc_14026EC86:                          ; CODE XREF: sub_14026E700+536↑j
                                        ; sub_14026E700+57C↑j ...
                mov     [rsi], rbx

loc_14026EC89:                          ; CODE XREF: sub_14026E700+503↑j
                                        ; sub_14026E700+513↑j ...
                mov     rcx, rsi
                call    sub_1403451C0
                lea     rcx, [r14+10h]
                mov     rbx, rax
                call    sub_14034D228
                test    eax, eax
                jz      short loc_14026ECA5
                or      rbx, 40h

loc_14026ECA5:                          ; CODE XREF: sub_14026E700+59F↑j
                cmp     [rbp+70h+var_50], 0
                mov     r13d, 1
                jz      short loc_14026ECEF
                mov     rdx, [rbp+70h+var_40]
                mov     rcx, rbx
                mov     rdx, [rdx]
                call    sub_14033F9E4
                test    eax, eax
                jz      short loc_14026ECEF
                bt      rbx, 0Bh
                jnb     short loc_14026ECEF
                or      rbx, 42h
                test    byte ptr [r14+22h], 10h
                jnz     short loc_14026ECEF
                lea     rcx, [r14+10h]
                call    sub_1402DF6E4
                test    eax, eax
                jz      short loc_14026ECEF
                mov     edx, r13d
                mov     rcx, r14
                call    sub_1402A689C

loc_14026ECEF:                          ; CODE XREF: sub_14026E700+5B0↑j
                                        ; sub_14026E700+5C3↑j ...
                mov     rax, [rbp+70h+var_38]
                and     r15, 0FFFFFFFFFFFFFFFEh
                test    rax, rax
                jz      loc_14026ED9F
                cmp     byte ptr [r15], 4
                jnz     loc_14026ED8D
                mov     rcx, rsi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14026ED80
                call    sub_140349680
                test    eax, eax
                jz      short loc_14026ED52
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14026ED3A
                test    r13b, bl
                jz      short loc_14026ED3A
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14026ED3A:                          ; CODE XREF: sub_14026E700+626↑j
                                        ; sub_14026E700+62B↑j
                mov     rdx, rbx
                mov     [rsi], rbx
                mov     rcx, rsi
                call    sub_140349620
                mov     eax, 114h
                jmp     loc_14026EBBF
; ---------------------------------------------------------------------------

loc_14026ED52:                          ; CODE XREF: sub_14026E700+61D↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14026ED80
                test    r13b, bl
                jz      short loc_14026ED80
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14026ED80:                          ; CODE XREF: sub_14026E700+614↑j
                                        ; sub_14026E700+66C↑j ...
                mov     [rsi], rbx
                mov     eax, 114h
                jmp     loc_14026EBBF
; ---------------------------------------------------------------------------

loc_14026ED8D:                          ; CODE XREF: sub_14026E700+604↑j
                test    rax, rax
                jz      short loc_14026ED9F
                cmp     byte ptr [r15], 5
                jnz     short loc_14026ED9F
                mov     rcx, r15
                xor     edx, edx
                jmp     short loc_14026EDA3
; ---------------------------------------------------------------------------

loc_14026ED9F:                          ; CODE XREF: sub_14026E700+5FA↑j
                                        ; sub_14026E700+690↑j ...
                xor     edx, edx
                mov     ecx, edx

loc_14026EDA3:                          ; CODE XREF: sub_14026E700+69D↑j
                test    rax, rax
                jz      short loc_14026EDB0
                cmp     byte ptr [r15], 3
                cmovz   edx, r13d

loc_14026EDB0:                          ; CODE XREF: sub_14026E700+6A6↑j
                mov     [rsp+100h+var_D0], rcx
                xor     r9d, r9d
                mov     dword ptr [rsp+100h+var_D8], edx
                mov     r8, r14
                mov     [rsp+100h+var_E0], rbx
                mov     rdx, rsi
                mov     rbx, [rbp+70h+var_48]
                mov     rcx, [rbx]
                call    sub_140228E90
                test    eax, eax
                jnz     loc_14026EB85
                xor     edx, edx
                mov     rcx, r14
                call    sub_140209CE0
                mov     edi, 0C0000017h
                jmp     loc_14026EBBD
; } // starts at 14026E700
sub_14026E700   endp ; sp-analysis failed

; ---------------------------------------------------------------------------
byte_14026EDEF  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE2F8↑o

; =============== S U B R O U T I N E =======================================


sub_14026EDF8   proc near               ; CODE XREF: sub_140224940+9E2↑p
                                        ; sub_14026E700+90↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

                mov     rax, rsp
                mov     [rax+8], rbx
                mov     [rax+10h], rbp
                mov     [rax+18h], rsi
                mov     [rax+20h], rdi
                push    r14
                sub     rsp, 20h
                mov     rsi, [rcx]
                mov     r14, r8
                mov     rbp, [rcx+10h]
                mov     bl, dl
                mov     rdi, rcx
                call    sub_1402642A8
                mov     al, [rdi+0Ch]
                test    r14, r14
                jz      short loc_14026EE5F
                mov     [r14], al

loc_14026EE30:                          ; CODE XREF: sub_14026EDF8+69↓j
                test    byte ptr [rdi+0Dh], 1
                mov     dl, bl
                mov     rcx, rsi
                jnz     short loc_14026EE63
                call    sub_140226960

loc_14026EE40:                          ; CODE XREF: sub_14026EDF8+70↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rax, rbp
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026EE5F:                          ; CODE XREF: sub_14026EDF8+33↑j
                mov     bl, al
                jmp     short loc_14026EE30
; ---------------------------------------------------------------------------

loc_14026EE63:                          ; CODE XREF: sub_14026EDF8+41↑j
                call    sub_140234180
                jmp     short loc_14026EE40
sub_14026EDF8   endp

; ---------------------------------------------------------------------------
algn_14026EE6A:                         ; DATA XREF: .pdata:00000001400CE304↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026EE70   proc near               ; CODE XREF: sub_14022B420+735↑p
                                        ; sub_14026EFEC+A8↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 00000001404411A8 SIZE 000000EC BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 20h
                mov     r13, r8
                mov     ebx, edx
                mov     rdi, rcx
                mov     eax, edx
                lock xadd [rcx+158h], eax
                add     eax, edx
                cmp     eax, [rcx+154h]
                jg      loc_14026EF87
                mov     rsi, [rcx+60h]
                mov     eax, edx
                lock xadd [rsi+10h], eax
                add     eax, edx
                xor     ebp, ebp

loc_14026EEBB:                          ; CODE XREF: sub_14026EE70+112↓j
                test    eax, eax
                jle     loc_140441280
                cmp     eax, [rsi+14h]
                jg      short loc_14026EEFB
                sub     eax, ebx
                cdqe
                shl     rax, 4
                add     rax, 18h
                add     rax, rsi
                mov     [r13+0], rax

loc_14026EEDB:                          ; CODE XREF: sub_14026EE70+148↓j
                                        ; sub_14026EE70+1D241F↓j
                mov     rbx, [rsp+48h+arg_0]
                mov     eax, ebp
                mov     rbp, [rsp+48h+arg_8]
                mov     rsi, [rsp+48h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026EEFB:                          ; CODE XREF: sub_14026EE70+56↑j
                mov     eax, ebx
                neg     eax
                lock xadd [rsi+10h], eax
                call    sub_1402EFC84
                mov     r15, rax
                test    rax, rax
                jz      loc_140441279
                lea     r12, [rdi+80h]
                mov     rcx, r12
                call    KeAcquireSpinLockRaiseToDpc
                mov     rdx, [rdi+60h]
                movzx   r14d, al
                cmp     rdx, rsi
                jnz     loc_14026EFBD
                lea     rax, [rdi+68h]
                mov     rcx, [rax+8]
                cmp     [rcx], rax
                jnz     loc_140441272
                mov     [r15+8], rcx
                mov     [r15], rax
                mov     [rcx], r15
                mov     rcx, r12
                mov     [rax+8], r15
                inc     dword ptr [rdi+78h]
                mov     [rdi+60h], r15
                call    KeReleaseSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14044120D

loc_14026EF71:                          ; CODE XREF: sub_14026EE70+1D239F↓j
                                        ; sub_14026EE70+1D23AB↓j ...
                mov     cr8, r14

loc_14026EF75:                          ; CODE XREF: sub_14026EE70+171↓j
                mov     rsi, [rdi+60h]
                mov     eax, ebx
                lock xadd [rsi+10h], eax
                add     eax, ebx
                jmp     loc_14026EEBB
; ---------------------------------------------------------------------------

loc_14026EF87:                          ; CODE XREF: sub_14026EE70+36↑j
                neg     ebx
                lock xadd [rcx+158h], ebx
                mov     ecx, 3
                xor     eax, eax
                lock cmpxchg [rdi+190h], ecx
                jnz     short loc_14026EFB3
                lea     rcx, [rdi+170h]
                mov     edx, 1
                call    ExQueueWorkItem

loc_14026EFB3:                          ; CODE XREF: sub_14026EE70+130↑j
                mov     ebp, 0C0000189h
                jmp     loc_14026EEDB
; ---------------------------------------------------------------------------

loc_14026EFBD:                          ; CODE XREF: sub_14026EE70+BF↑j
                mov     rcx, r12
                call    KeReleaseSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404411A8

loc_14026EFD3:                          ; CODE XREF: sub_14026EE70+1D233A↓j
                                        ; sub_14026EE70+1D2346↓j ...
                mov     cr8, r14
                xor     edx, edx
                mov     rcx, r15
                call    ExFreePoolWithTag
                jmp     short loc_14026EF75
sub_14026EE70   endp

; ---------------------------------------------------------------------------
byte_14026EFE3  db 9 dup(0CCh)          ; DATA XREF: .rdata:000000014005D3D8↑o
                                        ; .pdata:00000001400CE310↑o

; =============== S U B R O U T I N E =======================================


sub_14026EFEC   proc near               ; CODE XREF: sub_14026FB10+1CF↓p
                                        ; PfFileInfoNotify+4E4↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_20          = dword ptr  28h

; FUNCTION CHUNK AT 0000000140441294 SIZE 00000012 BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                push    rsi
                push    rdi
                push    r14
                sub     rsp, 20h
                and     [rsp+38h+arg_0], 0
                mov     rsi, r9
                mov     rbp, r8
                mov     rbx, rcx
                call    sub_14026F190
                mov     r14d, 1
                test    [rbx+1E4h], r14b
                jnz     short loc_14026F035
                mov     rax, [rbx+160h]
                cmp     byte ptr [rax+73Ah], 2
                jz      loc_14026F0FD

loc_14026F035:                          ; CODE XREF: sub_14026EFEC+33↑j
                                        ; sub_14026EFEC+11A↓j
                mov     rax, 20000000000h
                cmp     rsi, rax
                jnb     loc_140441294
                mov     eax, [rsp+38h+arg_20]
                shr     rsi, 9
                test    r14b, al
                jnz     loc_14044129E
                and     al, 2
                neg     al
                sbb     edi, edi
                and     edi, 3

loc_14026F062:                          ; CODE XREF: sub_14026EFEC+1D22B5↓j
                mov     rcx, rbx
                call    sub_14026F114
                test    edi, edi
                jnz     short loc_14026F089
                mov     rax, [rbx+198h]
                mov     [rsp+38h+arg_0], rax
                mov     rcx, rax
                mov     rax, [rax]
                shr     rax, 3
                cmp     rax, rsi
                jz      short loc_14026F0F5

loc_14026F089:                          ; CODE XREF: sub_14026EFEC+80↑j
                                        ; sub_14026EFEC+10F↓j
                lea     r8, [rsp+38h+arg_0]
                mov     edx, r14d
                mov     rcx, rbx
                call    sub_14026EE70
                test    eax, eax
                js      short loc_14026F0E1
                mov     rdx, [rsp+38h+arg_0]
                mov     rax, rsi
                shl     rax, 3
                mov     ecx, [rdx]
                and     ecx, 7
                or      rcx, rax
                mov     eax, edi
                mov     [rdx], rcx
                mov     [rdx+8], rbp
                mov     rcx, [rdx]
                and     rcx, 0FFFFFFFFFFFFFFF8h
                or      rcx, rax
                mov     [rdx], rcx
                lock add [rbx+14Ch], r14d
                test    edi, edi
                jnz     short loc_14026F0DF
                mov     rax, [rsp+38h+arg_0]
                mov     [rbx+198h], rax

loc_14026F0DF:                          ; CODE XREF: sub_14026EFEC+E5↑j
                                        ; sub_14026EFEC+10D↓j
                xor     eax, eax

loc_14026F0E1:                          ; CODE XREF: sub_14026EFEC+AF↑j
                                        ; sub_14026EFEC+1D22AD↓j
                mov     rbx, [rsp+38h+arg_8]
                mov     rbp, [rsp+38h+arg_10]
                add     rsp, 20h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14026F0F5:                          ; CODE XREF: sub_14026EFEC+9B↑j
                cmp     [rcx+8], rbp
                jz      short loc_14026F0DF
                jmp     short loc_14026F089
; ---------------------------------------------------------------------------

loc_14026F0FD:                          ; CODE XREF: sub_14026EFEC+43↑j
                lock or [rbx+1E4h], r14w
                jmp     loc_14026F035
sub_14026EFEC   endp

; ---------------------------------------------------------------------------
byte_14026F10B  db 9 dup(0CCh)          ; DATA XREF: .rdata:000000014005D400↑o
                                        ; .pdata:00000001400CE31C↑o

; =============== S U B R O U T I N E =======================================


sub_14026F114   proc near               ; CODE XREF: sub_14026EFEC+79↑p
                                        ; DATA XREF: .pdata:00000001400CE328↑o

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

                mov     [rsp+arg_8], rbx
                push    rdi
                sub     rsp, 20h
                and     [rsp+28h+arg_0], 0
                mov     rbx, rcx
                mov     edi, cs:dword_140CEC0D0
                mov     eax, [rcx+194h]
                cmp     edi, eax
                jnz     short loc_14026F148
                mov     eax, 40190034h

loc_14026F13C:                          ; CODE XREF: sub_14026F114+45↓j
                                        ; sub_14026F114+73↓j
                mov     rbx, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 8

loc_14026F148:                          ; CODE XREF: sub_14026F114+21↑j
                lea     r8, [rsp+28h+arg_0]
                mov     edx, 1
                call    sub_14026EE70
                test    eax, eax
                js      short loc_14026F13C
                mov     rcx, [rsp+28h+arg_0]
                mov     rax, [rcx]
                and     rax, 0FFFFFFFFFFFFFFFAh
                or      rax, 2
                mov     [rcx], rax
                lea     rax, [rbx+1A0h]
                mov     [rcx+8], edi
                mov     [rbx+194h], edi
                mov     [rbx+198h], rax
                xor     eax, eax
                jmp     short loc_14026F13C
sub_14026F114   endp

; ---------------------------------------------------------------------------
algn_14026F189:                         ; DATA XREF: .pdata:00000001400CE328↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026F190   proc near               ; CODE XREF: sub_14022B420+6BD↑p
                                        ; sub_14026EFEC+21↑p
                                        ; DATA XREF: ...

var_38          = qword ptr -38h
arg_0           = qword ptr  8
arg_8           = byte ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 00000001404412A6 SIZE 0000017D BYTES

                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r15
                sub     rsp, 28h
                mov     rax, [rdx+8]
                xor     esi, esi
                mov     rbx, [rdx+18h]
                xor     r15b, r15b
                mov     rbp, rdx
                mov     rdi, rcx
                mov     r12d, esi
                mov     r8d, [rax+34h]
                test    r8b, 10h
                jnz     loc_1404412A6
                lea     rax, [rcx+1E8h]
                add     rcx, 208h
                cmp     rax, rcx
                jnb     short loc_14026F1E2

loc_14026F1D4:                          ; CODE XREF: sub_14026F190+50↓j
                cmp     [rax], rbx
                jz      short loc_14026F222
                add     rax, 8
                cmp     rax, rcx
                jb      short loc_14026F1D4

loc_14026F1E2:                          ; CODE XREF: sub_14026F190+42↑j
                lea     rax, [rdi+240h]

loc_14026F1E9:                          ; DATA XREF: .rdata:000000014005D43C↑o
                                        ; .rdata:000000014005D450↑o ...
                mov     [rsp+58h+arg_0], r13
                mov     rcx, rax
                mov     [rsp+58h+var_38], r14
                mov     [rsp+58h+arg_10], rax
                call    ExAcquireSpinLockShared
                lea     r13, [rdi+208h]
                mov     [rsp+58h+arg_8], al
                mov     rcx, [r13+8]
                mov     r14, [r13+0]
                test    cl, 1
                jz      short loc_14026F235
                test    r14, r14
                jnz     short loc_14026F232
                mov     r14, rsi
                jmp     short loc_14026F235
; ---------------------------------------------------------------------------

loc_14026F222:                          ; CODE XREF: sub_14026F190+47↑j
                                        ; DATA XREF: .pdata:00000001400CE340↑o ...
                mov     eax, esi

loc_14026F224:                          ; CODE XREF: sub_14026F190+104↓j
                                        ; sub_14026F190+1E9↓j ...
                add     rsp, 28h
                pop     r15
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026F232:                          ; CODE XREF: sub_14026F190+8B↑j
                                        ; DATA XREF: .pdata:00000001400CE34C↑o ...
                xor     r14, r13

loc_14026F235:                          ; CODE XREF: sub_14026F190+86↑j
                                        ; sub_14026F190+90↑j
                movzx   ecx, cl
                and     ecx, 1
                test    r14, r14
                jz      short loc_14026F248

loc_14026F240:                          ; CODE XREF: sub_14026F190+113↓j
                cmp     [r14+18h], rbx
                ja      short loc_14026F296
                jb      short loc_14026F2A7

loc_14026F248:                          ; CODE XREF: sub_14026F190+AE↑j
                                        ; sub_14026F190+115↓j
                lea     rcx, [rdi+240h]
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404412B0

loc_14026F262:                          ; CODE XREF: sub_14026F190+1D2122↓j
                                        ; sub_14026F190+1D212E↓j ...
                movzx   eax, [rsp+58h+arg_8]
                mov     cr8, rax
                test    r14, r14
                jz      short loc_14026F2C3
                inc     byte ptr [rdi+244h]
                movzx   eax, byte ptr [rdi+244h]
                and     eax, 3
                mov     [rdi+rax*8+1E8h], rbx

loc_14026F288:                          ; CODE XREF: sub_14026F190+34C↓j
                                        ; sub_14026F190+1D228E↓j
                mov     eax, esi

loc_14026F28A:                          ; CODE XREF: sub_14026F190+1D21A5↓j
                mov     r13, [rsp+58h+arg_0]
                mov     r14, [rsp+58h+var_38]
                jmp     short loc_14026F224
; ---------------------------------------------------------------------------

loc_14026F296:                          ; CODE XREF: sub_14026F190+B4↑j
                                        ; DATA XREF: .pdata:00000001400CE358↑o ...
                mov     rax, [r14]
                test    ecx, ecx
                jnz     short loc_14026F2B9

loc_14026F29D:                          ; CODE XREF: sub_14026F190+11D↓j
                                        ; sub_14026F190+122↓j ...
                mov     r14, rax

loc_14026F2A0:                          ; CODE XREF: sub_14026F190+127↓j
                                        ; sub_14026F190+131↓j
                test    r14, r14
                jnz     short loc_14026F240
                jmp     short loc_14026F248
; ---------------------------------------------------------------------------

loc_14026F2A7:                          ; CODE XREF: sub_14026F190+B6↑j
                mov     rax, [r14+8]
                test    ecx, ecx
                jz      short loc_14026F29D
                test    rax, rax
                jz      short loc_14026F29D
                xor     r14, rax
                jmp     short loc_14026F2A0
; ---------------------------------------------------------------------------

loc_14026F2B9:                          ; CODE XREF: sub_14026F190+10B↑j
                test    rax, rax
                jz      short loc_14026F29D
                xor     r14, rax
                jmp     short loc_14026F2A0
; ---------------------------------------------------------------------------

loc_14026F2C3:                          ; CODE XREF: sub_14026F190+DE↑j
                mov     edx, 30h ; '0'
                mov     ecx, 200h
                mov     r8d, 6E506343h
                call    ExAllocatePoolWithTag
                mov     r14, rax
                test    rax, rax
                jz      loc_14044131A
                xorps   xmm0, xmm0
                mov     edx, 746C6644h
                movups  xmmword ptr [rax], xmm0
                mov     rcx, rbp
                movups  xmmword ptr [rax+10h], xmm0
                movups  xmmword ptr [rax+20h], xmm0
                call    ObfReferenceObjectWithTag
                lea     rcx, [rdi+240h]
                mov     [r14+28h], rbp
                mov     [r14+18h], rbx
                call    ExAcquireSpinLockExclusive
                mov     rdx, [r13+8]
                mov     rcx, [r13+0]
                movzx   ebp, al
                test    dl, 1
                jnz     loc_14026F455

loc_14026F327:                          ; CODE XREF: sub_14026F190+2D1↓j
                                        ; sub_14026F190+367↓j
                movzx   edx, dl
                and     edx, 1
                test    rcx, rcx
                jz      short loc_14026F391

loc_14026F332:                          ; CODE XREF: sub_14026F190+1FF↓j
                cmp     [rcx+18h], rbx
                ja      short loc_14026F37E
                jb      loc_14026F427

loc_14026F33E:                          ; CODE XREF: sub_14026F190+1D21AF↓j
                mov     rcx, [rsp+58h+arg_10]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140441344

loc_14026F356:                          ; CODE XREF: sub_14026F190+1D21B6↓j
                                        ; sub_14026F190+1D21C2↓j ...
                mov     cr8, rbp
                mov     rcx, [r14+28h]
                call    PsDereferenceSiloContext
                xor     edx, edx
                mov     rcx, r14
                call    ExFreePoolWithTag
                mov     r13, [rsp+58h+arg_0]
                mov     eax, esi
                mov     r14, [rsp+58h+var_38]
                jmp     loc_14026F224
; ---------------------------------------------------------------------------

loc_14026F37E:                          ; CODE XREF: sub_14026F190+1A6↑j
                                        ; DATA XREF: .pdata:00000001400CE364↑o ...
                mov     rax, [rcx]
                test    edx, edx
                jnz     loc_14026F444

loc_14026F389:                          ; CODE XREF: sub_14026F190+29D↓j
                                        ; sub_14026F190+2A6↓j ...
                mov     rcx, rax

loc_14026F38C:                          ; CODE XREF: sub_14026F190+2AF↓j
                                        ; sub_14026F190+2C0↓j
                test    rcx, rcx
                jnz     short loc_14026F332

loc_14026F391:                          ; CODE XREF: sub_14026F190+1A0↑j
                cmp     [rdi+238h], rsi
                jnz     short loc_14026F3D4
                lea     rcx, [rdi+168h]
                call    sub_14024C840
                movzx   r15d, al
                test    al, al
                jz      loc_14044133A
                lea     rax, sub_1402A0670
                mov     [rdi+238h], rdi
                mov     [rdi+230h], rax
                mov     r12d, 1
                mov     [rdi+220h], rsi

loc_14026F3D4:                          ; CODE XREF: sub_14026F190+208↑j
                mov     rax, [rdi+218h]
                lea     rcx, [r14+20h]
                mov     [rcx], rax
                mov     [rdi+218h], rcx
                mov     rax, [r13+8]
                mov     rdx, [r13+0]
                test    al, 1
                jnz     loc_14026F4E7

loc_14026F3F9:                          ; CODE XREF: sub_14026F190+35F↓j
                                        ; sub_14026F190+36F↓j
                movzx   ecx, al
                xor     r8b, r8b
                and     ecx, 1
                test    rdx, rdx
                jz      short loc_14026F47F

loc_14026F407:                          ; CODE XREF: sub_14026F190+295↓j
                cmp     [rdx+18h], rbx
                ja      short loc_14026F466
                mov     rax, [rdx+8]
                test    ecx, ecx
                jz      short loc_14026F41D
                test    rax, rax
                jz      short loc_14026F47C
                xor     rax, rdx

loc_14026F41D:                          ; CODE XREF: sub_14026F190+283↑j
                test    rax, rax
                jz      short loc_14026F47C

loc_14026F422:                          ; CODE XREF: sub_14026F190+2E8↓j
                mov     rdx, rax
                jmp     short loc_14026F407
; ---------------------------------------------------------------------------

loc_14026F427:                          ; CODE XREF: sub_14026F190+1A8↑j
                mov     rax, [rcx+8]
                test    edx, edx
                jz      loc_14026F389
                test    rax, rax
                jz      loc_14026F389
                xor     rcx, rax
                jmp     loc_14026F38C
; ---------------------------------------------------------------------------

loc_14026F444:                          ; CODE XREF: sub_14026F190+1F3↑j
                test    rax, rax
                jz      loc_14026F389
                xor     rcx, rax
                jmp     loc_14026F38C
; ---------------------------------------------------------------------------

loc_14026F455:                          ; CODE XREF: sub_14026F190+191↑j
                test    rcx, rcx
                jnz     loc_14026F4F4
                mov     rcx, rsi
                jmp     loc_14026F327
; ---------------------------------------------------------------------------

loc_14026F466:                          ; CODE XREF: sub_14026F190+27B↑j
                mov     rax, [rdx]
                test    ecx, ecx
                jz      short loc_14026F475
                test    rax, rax
                jz      short loc_14026F47F
                xor     rax, rdx

loc_14026F475:                          ; CODE XREF: sub_14026F190+2DB↑j
                test    rax, rax
                jnz     short loc_14026F422
                jmp     short loc_14026F47F
; ---------------------------------------------------------------------------

loc_14026F47C:                          ; CODE XREF: sub_14026F190+288↑j
                                        ; sub_14026F190+290↑j
                mov     r8b, 1

loc_14026F47F:                          ; CODE XREF: sub_14026F190+275↑j
                                        ; sub_14026F190+2E0↑j ...
                mov     r9, r14
                mov     rcx, r13
                call    RtlRbInsertNodeEx
                lea     rcx, [rdi+240h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404413AA

loc_14026F4A4:                          ; CODE XREF: sub_14026F190+1D221C↓j
                                        ; sub_14026F190+1D2228↓j ...
                mov     cr8, rbp
                test    r12d, r12d
                jz      short loc_14026F4C1
                xor     r15b, r15b
                lea     rcx, [rdi+220h]
                mov     edx, 1
                call    ExQueueWorkItem

loc_14026F4C1:                          ; CODE XREF: sub_14026F190+31B↑j
                inc     byte ptr [rdi+244h]
                movzx   eax, byte ptr [rdi+244h]
                and     eax, 3
                mov     [rdi+rax*8+1E8h], rbx
                test    r15b, r15b
                jz      loc_14026F288
                jmp     loc_140441411
; ---------------------------------------------------------------------------

loc_14026F4E7:                          ; CODE XREF: sub_14026F190+263↑j
                test    rdx, rdx
                jz      short loc_14026F4FC
                xor     rdx, r13
                jmp     loc_14026F3F9
; ---------------------------------------------------------------------------

loc_14026F4F4:                          ; CODE XREF: sub_14026F190+2C8↑j
                xor     rcx, r13
                jmp     loc_14026F327
; ---------------------------------------------------------------------------

loc_14026F4FC:                          ; CODE XREF: sub_14026F190+35A↑j
                mov     rdx, rsi
                jmp     loc_14026F3F9
sub_14026F190   endp

; ---------------------------------------------------------------------------
algn_14026F504:                         ; DATA XREF: .pdata:00000001400CE370↑o
                align 10h
; Exported entry 176. ExAcquireSpinLockShared

; =============== S U B R O U T I N E =======================================


                public ExAcquireSpinLockShared
ExAcquireSpinLockShared proc near       ; CODE XREF: sub_140203354+27↑p
                                        ; sub_140219BBC+59↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 0000000140441424 SIZE 000000A5 BYTES

                mov     [rsp+arg_8], rbx
                push    rdi
                sub     rsp, 20h
                mov     rbx, rcx
                mov     rdi, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140441424

loc_14026F538:                          ; CODE XREF: ExAcquireSpinLockShared+1D1F16↓j
                                        ; ExAcquireSpinLockShared+1D1F20↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140441469

loc_14026F545:                          ; DATA XREF: .rdata:000000014005D4E0↑o
                                        ; .rdata:000000014005D4F4↑o ...
                mov     [rsp+28h+arg_0], rsi
                mov     rsi, gs:20h
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14044147B

loc_14026F563:                          ; CODE XREF: ExAcquireSpinLockShared+1D1F6F↓j
                                        ; ExAcquireSpinLockShared+1D1F7E↓j ...
                prefetchw byte ptr [rbx]
                mov     eax, [rbx]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rbx], ecx
                jnz     short loc_14026F58A

loc_14026F575:                          ; CODE XREF: ExAcquireSpinLockShared+96↓j
                mov     rsi, [rsp+28h+arg_0]

loc_14026F57A:                          ; CODE XREF: ExAcquireSpinLockShared+1D1F66↓j
                                        ; DATA XREF: .pdata:00000001400CE388↑o ...
                mov     rbx, [rsp+28h+arg_8]
                movzx   eax, dil
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026F58A:                          ; CODE XREF: ExAcquireSpinLockShared+63↑j
                                        ; DATA XREF: .pdata:00000001400CE394↑o ...
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_1404414A2

loc_14026F59A:                          ; CODE XREF: ExAcquireSpinLockShared+1D1F96↓j
                                        ; ExAcquireSpinLockShared+1D1FA5↓j ...
                movzx   edx, dil
                mov     rcx, rbx
                call    sub_140329420
                jmp     short loc_14026F575
ExAcquireSpinLockShared endp

; ---------------------------------------------------------------------------
algn_14026F5A8:                         ; DATA XREF: .pdata:00000001400CE3A0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026F5B0   proc near               ; CODE XREF: sub_14023C050+575↑p
                                        ; ExTryAcquireSpinLockSharedAtDpcLevel:loc_1405B5E20↓p ...
                prefetchw byte ptr [rcx]
                mov     eax, [rcx]
                btr     eax, 1Fh
                lea     edx, [rax+1]
                lock cmpxchg [rcx], edx
                jnz     short loc_14026F5C6
                mov     al, 1
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026F5C6:                          ; CODE XREF: sub_14026F5B0+10↑j
                xor     al, al
                retn
sub_14026F5B0   endp

; ---------------------------------------------------------------------------
                align 2
algn_14026F5CA:                         ; DATA XREF: .pdata:00000001400CE3AC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026F5D0   proc near               ; CODE XREF: sub_140224260+4FC↑p
                                        ; sub_140224940+6CE↑p ...

arg_0           = qword ptr  8

; FUNCTION CHUNK AT 00000001404414CA SIZE 00000019 BYTES

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 20h
                mov     rbx, rcx
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                mov     rdx, [rcx+10h]
                mov     r10, [rbx]
                shl     rdx, 19h
                shl     rax, 19h
                sub     rdx, rax
                sar     rdx, 10h
                shl     rdx, 19h
                sub     rdx, rax
                movzx   eax, word ptr [rcx+8]
                movzx   ecx, byte ptr [rcx+0Dh]
                shr     ecx, 3
                sar     rdx, 10h
                and     ecx, 2
                shl     rax, 0Ch
                add     rdx, rax
                mov     rax, r8
                xor     edi, edi
                cmp     rdx, rax
                jnb     short loc_14026F64E

loc_14026F62A:                          ; CODE XREF: sub_14026F5D0+8B↓j
                mov     r9d, ecx
                or      r9d, 5

loc_14026F631:                          ; CODE XREF: sub_14026F5D0+1D1F0E↓j
                movzx   r8d, word ptr [rbx+0Ah]
                mov     rcx, r10
                call    sub_140229590
                mov     [rbx+0Ah], di
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026F64E:                          ; CODE XREF: sub_14026F5D0+58↑j
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     rdx, rax
                ja      short loc_14026F62A
                jmp     loc_1404414CA
sub_14026F5D0   endp

; ---------------------------------------------------------------------------
algn_14026F662:                         ; DATA XREF: .rdata:000000014005D54C↑o
                                        ; .pdata:00000001400CE3B8↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_14026F668   proc near               ; CODE XREF: sub_140231440+7D1↑p
                                        ; DATA XREF: .rdata:000000014005D574↑o ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 00000001404414E4 SIZE 00000011 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 20h
                mov     rax, [rcx+30h]
                mov     edi, r8d
                mov     rbx, rdx
                mov     rsi, rcx
                lea     r9, [rax+rax*2]
                add     r9, r9
                mov     rdx, 0FFFFFA8000000008h
                mov     rdx, [rdx+r9*8]
                mov     rax, 8000000000000000h
                and     dword ptr [rcx+2Ch], 0
                or      rdx, rax
                mov     rcx, rbx
                or      r8d, 0FFFFFFFFh
                call    sub_140270E80
                mov     rcx, rbx
                mov     rbp, rax
                call    sub_140261C00
                movzx   ecx, word ptr [rsi+0Ah]
                or      cx, 2
                mov     [rsi+0Ah], cx
                movzx   edx, cx
                test    dil, 8
                jnz     loc_1404414E4

loc_14026F6DF:                          ; CODE XREF: sub_14026F668+1D1E88↓j
                mov     eax, [rsi+28h]
                mov     rbx, [rsp+28h+arg_0]
                shl     rax, 3
                shr     rax, 0Ch
                add     ax, 30h ; '0'
                mov     [rsi+8], ax
                mov     rax, rbp
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026F668   endp

byte_14026F70B  db 9 dup(0CCh)          ; DATA XREF: .rdata:000000014005D574↑o
                                        ; .pdata:00000001400CE3C4↑o

; =============== S U B R O U T I N E =======================================


sub_14026F714   proc near               ; CODE XREF: sub_14026E700+77↑p
                                        ; sub_14065F304+66↓p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 00000001404414F6 SIZE 0000003C BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 20h
                mov     rdi, [rcx+0D0h]
                mov     r15d, edx
                mov     rbx, rcx
                test    rdi, rdi
                jz      loc_14026F7EE
                mov     rcx, rdi
                call    sub_14026F920
                mov     ecx, [rdi+38h]
                mov     r14, rax
                test    cl, 20h
                jnz     short loc_14026F77A
                and     qword ptr [rbx+0D0h], 0

loc_14026F75D:                          ; CODE XREF: sub_14026F714+B1↓j
                                        ; sub_14026F714+CF↓j ...
                mov     rax, r14

loc_14026F760:                          ; CODE XREF: sub_14026F714+DC↓j
                mov     rbx, [rsp+38h+arg_0]
                mov     rbp, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026F77A:                          ; CODE XREF: sub_14026F714+3F↑j
                lock inc qword ptr [rdi+70h]
                mov     rax, [rbx+100h]
                mov     rsi, [rdi+60h]
                test    rax, rax
                jnz     short loc_14026F796
                lea     rax, [rbx+110h]

loc_14026F796:                          ; CODE XREF: sub_14026F714+79↑j
                mov     rax, [rax+30h]
                lea     rbp, [rax+rax*2]
                shl     rbp, 4
                mov     rax, 0FFFFFA8000000000h
                add     rbp, rax
                mov     edx, r15d
                mov     rcx, rbp
                call    sub_1402A3460
                mov     [rbx+0BCh], eax
                cmp     qword ptr [rsi+20h], 0
                jz      short loc_14026F75D
                mov     esi, [rbx+0C0h]
                mov     eax, esi
                bts     eax, 10h
                mov     [rbx+0C0h], eax
                test    cs:dword_140CFC400, 40000h
                jz      loc_14026F75D
                jmp     loc_1404414F6
; ---------------------------------------------------------------------------

loc_14026F7EE:                          ; CODE XREF: sub_14026F714+28↑j
                xor     eax, eax
                jmp     loc_14026F760
sub_14026F714   endp

; ---------------------------------------------------------------------------
byte_14026F7F5  db 7 dup(0CCh)          ; DATA XREF: .rdata:000000014005D5A0↑o
                                        ; .pdata:00000001400CE3D0↑o

; =============== S U B R O U T I N E =======================================


sub_14026F7FC   proc near               ; CODE XREF: sub_1402720A0+8FC↓p
                                        ; DATA XREF: .rdata:000000014005D5CC↑o ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140441532 SIZE 00000007 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 20h
                mov     rsi, r8
                mov     r15, rdx
                mov     rbx, rcx
                mov     edx, 0C0h
                mov     ecx, 200h
                mov     r8d, 63426343h
                mov     r14, r9
                call    ExAllocatePoolWithTag
                mov     rdi, rax
                test    rax, rax
                jz      loc_14026F917
                lea     rcx, [rax+2]
                xor     edx, edx
                mov     r8d, 0BEh
                call    memset
                mov     eax, 2FDh
                lea     rcx, [rdi+48h]
                mov     [rdi], ax
                mov     rax, [rsi]
                mov     [rdi+8], rax
                mov     eax, [r14]
                mov     [rdi+4], eax
                mov     rax, [rsi]
                add     rax, [r14]
                inc     dword ptr [rdi+40h]
                mov     [rdi+20h], rax
                mov     [rdi+0B0h], rbx
                call    ExInitializeResourceLite
                xor     edx, edx
                lea     rcx, [rbx+68h]
                call    ExAcquirePushLockExclusiveEx
                lea     rcx, [r15+10h]
                mov     rdx, [rcx+8]
                lea     rax, [rdi+10h]
                cmp     [rdx], rcx
                jnz     FatalListEntryError_10
                mov     [rax], rcx
                mov     [rax+8], rdx
                mov     [rdx], rax
                mov     [rcx+8], rax
                cmp     qword ptr [rbx+20h], 2000000h
                jle     short loc_14026F8D9
                test    dword ptr [rbx+98h], 200h
                jz      short loc_14026F8D9
                mov     rdx, [rsi]
                mov     r8d, 1
                mov     rcx, rbx
                call    sub_1402F8934

loc_14026F8D9:                          ; CODE XREF: sub_14026F7FC+BE↑j
                                        ; sub_14026F7FC+CA↑j
                xor     edx, edx
                lea     rcx, [rbx+68h]
                call    ExReleasePushLockEx
                mov     edx, [rbx+98h]
                test    dl, 2
                jnz     short loc_14026F90C

loc_14026F8EF:                          ; CODE XREF: sub_14026F7FC+119↓j
                mov     rax, rdi

loc_14026F8F2:                          ; CODE XREF: sub_14026F7FC:loc_14026F917↓j
                mov     rbx, [rsp+38h+arg_0]
                mov     rbp, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14026F90C:                          ; CODE XREF: sub_14026F7FC+F1↑j
                lea     rcx, [rdi+48h]
                call    ExDisableResourceBoostLite
                jmp     short loc_14026F8EF
; ---------------------------------------------------------------------------

loc_14026F917:                          ; CODE XREF: sub_14026F7FC+3F↑j
                jmp     short loc_14026F8F2
sub_14026F7FC   endp

; ---------------------------------------------------------------------------
algn_14026F919:                         ; DATA XREF: .rdata:000000014005D5CC↑o
                                        ; .pdata:00000001400CE3DC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14026F920   proc near               ; CODE XREF: sub_140231440+EF↑p
                                        ; sub_14026F714+31↑p ...

var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014044153A SIZE 000000D8 BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 30h
                mov     rsi, rcx
                lea     rdi, [rcx+40h]
                prefetchw byte ptr [rdi]
                mov     r8, [rdi]
                test    r8b, 0Fh
                jz      short loc_14026F954

loc_14026F942:                          ; CODE XREF: sub_14026F920+EE↓j
                lea     rdx, [r8-1]
                mov     rax, r8
                lock cmpxchg [rdi], rdx
                jnz     loc_14026FA09

loc_14026F954:                          ; CODE XREF: sub_14026F920+20↑j
                                        ; sub_14026F920+F4↓j
                mov     rbx, r8

loc_14026F957:                          ; DATA XREF: .rdata:000000014005D5F4↑o
                                        ; .rdata:000000014005D604↑o ...
                mov     [rsp+38h+arg_0], rbp
                and     rbx, 0FFFFFFFFFFFFFFF0h
                and     r8d, 0Fh
                cmp     r8d, 1
                jbe     short loc_14026F988

loc_14026F96A:                          ; CODE XREF: sub_14026F920+DE↓j
                                        ; sub_14026F920+121↓j ...
                test    rbx, rbx
                jz      short loc_14026F98D
                mov     rax, rbx

loc_14026F972:                          ; CODE XREF: sub_14026F920+A4↓j
                mov     rbp, [rsp+38h+arg_0]
                mov     rbx, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                add     rsp, 30h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
algn_14026F987:                         ; DATA XREF: .pdata:00000001400CE3F4↑o
                                        ; .pdata:00000001400CE400↑o
                align 8

loc_14026F988:                          ; CODE XREF: sub_14026F920+48↑j
                                        ; DATA XREF: .pdata:00000001400CE400↑o ...
                test    r8d, r8d
                jnz     short loc_14026F9C6

loc_14026F98D:                          ; CODE XREF: sub_14026F920+4D↑j
                lea     rbx, [rsi+48h]
                mov     rcx, rbx
                call    ExAcquireSpinLockShared
                mov     rcx, rdi
                movzx   esi, al
                call    sub_14021AEA8
                mov     rcx, rbx
                mov     rdi, rax
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404415AB

loc_14026F9BD:                          ; CODE XREF: sub_14026F920+1D1C8D↓j
                                        ; sub_14026F920+1D1C99↓j ...
                mov     cr8, rsi
                mov     rax, rdi
                jmp     short loc_14026F972
; ---------------------------------------------------------------------------

loc_14026F9C6:                          ; CODE XREF: sub_14026F920+6B↑j
                mov     edx, 0Fh
                mov     rcx, rbx
                call    sub_14032D980
                prefetchw byte ptr [rdi]
                mov     rax, [rdi]
                mov     rcx, rax
                and     ecx, 0Fh
                add     rcx, 0Fh
                cmp     rcx, 0Fh
                ja      short loc_14026FA19

loc_14026F9E9:                          ; CODE XREF: sub_14026F920+1D1C28↓j
                mov     rcx, rax
                and     rcx, 0FFFFFFFFFFFFFFF0h
                cmp     rbx, rcx
                jnz     short loc_14026FA19
                lea     rcx, [rax+0Fh]
                lock cmpxchg [rdi], rcx
                jz      loc_14026F96A
                jmp     loc_14044153A
; ---------------------------------------------------------------------------

loc_14026FA09:                          ; CODE XREF: sub_14026F920+2E↑j
                                        ; DATA XREF: .pdata:00000001400CE40C↑o ...
                mov     r8, rax
                test    al, 0Fh
                jnz     loc_14026F942
                jmp     loc_14026F954
; ---------------------------------------------------------------------------

loc_14026FA19:                          ; CODE XREF: sub_14026F920+C7↑j
                                        ; sub_14026F920+D3↑j ...
                mov     edx, 0Fh
                lea     rcx, [rbx-30h]
                mov     r8d, 746C6644h
                call    sub_1402C0620
                mov     rax, 0FFFFFFFFFFFFFFF1h
                lock xadd [rbx-30h], rax
                add     rax, 0FFFFFFFFFFFFFFF1h
                test    rax, rax
                jg      loc_14026F96A
                mov     rcx, [rbx-28h]
                test    rcx, rcx
                jnz     loc_140441553
                test    rax, rax
                js      loc_140441592
                lea     rcx, [rbx-30h]
                call    sub_14034EBC0
                jmp     loc_14026F96A
sub_14026F920   endp

; ---------------------------------------------------------------------------
byte_14026FA6B  db 9 dup(0CCh)          ; DATA XREF: .pdata:00000001400CE424↑o

; =============== S U B R O U T I N E =======================================


sub_14026FA74   proc near               ; CODE XREF: sub_14065D6F0+419↓p
                                        ; DATA XREF: .rdata:000000014005D678↑o ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140441612 SIZE 00000066 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 20h
                mov     r8, [rcx]
                mov     ebp, edx
                mov     rsi, rcx
                mov     eax, [r8+38h]
                test    al, 20h
                jz      short loc_14026FAED

loc_14026FA98:                          ; CODE XREF: sub_14026FA74+7E↓j
                mov     bl, 11h
                lea     rdi, [r8+48h]

loc_14026FA9E:                          ; CODE XREF: sub_14026FA74+8E↓j
                mov     rdx, [rsi+8]
                mov     r8d, ebp
                mov     rcx, rsi
                call    sub_140270E80
                mov     rsi, rax
                cmp     bl, 11h
                jnz     short loc_14026FACE

loc_14026FAB5:                          ; CODE XREF: sub_14026FA74+77↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rax, rsi
                mov     rsi, [rsp+28h+arg_10]
                mov     rbp, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14026FACE:                          ; CODE XREF: sub_14026FA74+3F↑j
                mov     rcx, rdi
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jnz     loc_140441612

loc_14026FAE4:                          ; CODE XREF: sub_14026FA74+1D1BA1↓j
                                        ; sub_14026FA74+1D1BAD↓j ...
                movzx   eax, bl
                mov     cr8, rax
                jmp     short loc_14026FAB5
; ---------------------------------------------------------------------------

loc_14026FAED:                          ; CODE XREF: sub_14026FA74+22↑j
                cmp     qword ptr [r8+40h], 0
                jz      short loc_14026FA98
                lea     rdi, [r8+48h]
                mov     rcx, rdi
                call    ExAcquireSpinLockShared
                mov     bl, al
                jmp     short loc_14026FA9E
sub_14026FA74   endp

; ---------------------------------------------------------------------------
algn_14026FB04:                         ; DATA XREF: .rdata:000000014005D678↑o
                                        ; .pdata:00000001400CE430↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14026FB10   proc near               ; CODE XREF: sub_14031C940+3B4↓p
                                        ; sub_14031C940+504↓p ...

var_A8          = qword ptr -0A8h
var_A0          = dword ptr -0A0h
var_98          = qword ptr -98h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h

                mov     [rsp+arg_18], r9d
                mov     [rsp+arg_10], r8
                mov     [rsp+arg_8], rdx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 88h
                mov     rax, [rcx]
                mov     r15d, r9d
                mov     [rsp+0C8h+var_60], rax
                mov     r12, r8
                mov     rax, [r8]
                mov     r13, rdx
                mov     rsi, rcx
                mov     r11, 0FFFFFA8000000000h
                mov     edi, 1
                lea     r10, [rax+rax*2]
                shl     r10, 4
                mov     rax, r11
                mov     rcx, cs:qword_140C4DDC0
                add     r10, rax
                mov     rax, 8000000000000000h
                mov     rdx, [r10+8]
                or      rdx, rax
                mov     rax, [r10+10h]
                mov     [rsp+0C8h+var_68], rdx
                test    rcx, rcx
                jz      short loc_14026FB96
                test    al, 10h
                jnz     short loc_14026FB96
                not     rcx
                and     rax, rcx

loc_14026FB96:                          ; CODE XREF: sub_14026FB10+7A↑j
                                        ; sub_14026FB10+7E↑j
                sar     rax, 10h
                xor     ebx, ebx
                cmp     cs:dword_140C4C40C, ebx
                mov     rax, [rax]
                mov     [rsp+0C8h+var_58], rax
                jz      short loc_14026FBC8
                mov     rcx, rax
                call    sub_14026F920
                mov     rdx, [rsp+0C8h+var_68]
                mov     rcx, rax
                mov     r11, 0FFFFFA8000000000h
                jmp     short loc_14026FBCB
; ---------------------------------------------------------------------------

loc_14026FBC8:                          ; CODE XREF: sub_14026FB10+9A↑j
                mov     rcx, rbx

loc_14026FBCB:                          ; CODE XREF: sub_14026FB10+B6↑j
                mov     [rsp+0C8h+var_88], rcx
                mov     ebp, ebx
                test    r15d, r15d
                jz      loc_14026FF30
                mov     [rsp+0C8h+var_78], r12
                mov     r8d, 1FFh
                mov     r10, 0FFFFF6FB7DBED7F8h
                jmp     short loc_14026FBF7
; ---------------------------------------------------------------------------

loc_14026FBF2:                          ; CODE XREF: sub_14026FB10+400↓j
                mov     rcx, [rsp+0C8h+var_88]

loc_14026FBF7:                          ; CODE XREF: sub_14026FB10+E0↑j
                mov     r9, [r12]
                mov     [rsp+0C8h+var_70], r9
                lea     r15, [r9+r9*2]
                shl     r15, 4
                mov     rax, r11
                add     r15, rax
                mov     rax, cs:qword_140C4DDC0
                mov     rbx, [r15+10h]
                mov     [rsp+0C8h+var_80], rbx
                mov     rdi, rbx
                test    rax, rax
                jz      short loc_14026FC34
                test    bl, 10h
                jnz     short loc_14026FC34
                mov     rdi, rax
                not     rdi
                and     rdi, rbx

loc_14026FC34:                          ; CODE XREF: sub_14026FB10+114↑j
                                        ; sub_14026FB10+119↑j
                mov     r14, [r15+8]
                mov     rax, 8000000000000000h
                or      r14, rax
                mov     rax, r14
                sub     rax, rdx
                sar     rax, 3
                lea     r13, [r13+rax*8+0]
                test    rcx, rcx
                jz      loc_14026FD26
                mov     rcx, r13
                mov     rax, 0FFFFF68000000000h
                shl     rcx, 19h
                mov     rax, rax
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                call    sub_140270F20
                sar     rdi, 10h
                mov     r8d, eax
                mov     rcx, rdi
                mov     rdx, r14
                call    sub_140270E80
                mov     r14, gs:188h
                mov     r12, rax
                mov     rcx, [r14+0B8h]
                call    sub_140270D30
                mov     rdi, rax
                test    rax, rax
                jz      short loc_14026FD0C
                mov     r8d, 1
                mov     rdx, rax
                mov     rcx, r14
                call    sub_1402EEB70
                mov     r14, [rsp+0C8h+var_88]
                test    eax, eax
                jz      short loc_14026FCE4
                mov     dword ptr [rsp+0C8h+var_A8], r8d
                mov     r9, r12
                mov     r8, [r14+18h]
                mov     rdx, r14
                mov     rcx, rdi
                call    sub_14026EFEC

loc_14026FCE4:                          ; CODE XREF: sub_14026FB10+1BB↑j
                lea     rcx, [rdi+168h]
                call    sub_14024C380
                mov     r9, [rsp+0C8h+var_70]
                mov     r8d, 1FFh
                mov     r12, [rsp+0C8h+var_78]
                mov     r10, 0FFFFF6FB7DBED7F8h
                jmp     short loc_14026FD2B
; ---------------------------------------------------------------------------

loc_14026FD0C:                          ; CODE XREF: sub_14026FB10+1A1↑j
                mov     r9, [rsp+0C8h+var_70]
                mov     r8d, 1FFh
                mov     r12, [rsp+0C8h+var_78]
                mov     r10, 0FFFFF6FB7DBED7F8h

loc_14026FD26:                          ; CODE XREF: sub_14026FB10+147↑j
                mov     r14, [rsp+0C8h+var_88]

loc_14026FD2B:                          ; CODE XREF: sub_14026FB10+1FA↑j
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                lea     rcx, [rsp+0C8h+var_80]
                cmp     rcx, rax
                jb      loc_14026FDCF
                mov     rax, r10
                lea     rcx, [rsp+0C8h+var_80]
                cmp     rcx, rax
                ja      short loc_14026FDCF
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14026FDCF
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14026FDCF
                test    bl, 1
                jz      short loc_14026FDCF
                test    bl, 20h
                jz      short loc_14026FD87
                test    bl, 42h
                jnz     short loc_14026FDCF

loc_14026FD87:                          ; CODE XREF: sub_14026FB10+270↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14026FDCF
                lea     rax, [rsp+0C8h+var_80]
                shr     rax, 3
                and     rax, r8
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14026FDCF
                or      rbx, 42h

loc_14026FDCF:                          ; CODE XREF: sub_14026FB10+230↑j
                                        ; sub_14026FB10+241↑j ...
                shr     rbx, 5
                mov     rdx, r9
                and     ebx, 1Fh
                mov     rcx, r13
                mov     r8d, ebx
                call    sub_140280E60
                movzx   edx, byte ptr [rsi+0Dh]
                mov     rbx, rax
                movzx   eax, dl
                and     rbx, 0FFFFFFFFFFFFFFDFh
                and     al, 5
                cmp     al, 4
                jnz     loc_14026FEA1
                test    dl, 2
                jnz     loc_14026FEA1
                movzx   eax, word ptr [rsi+0Ah]
                mov     r8d, 1FFh
                test    ax, ax
                jz      short loc_14026FE4E
                movzx   ecx, word ptr [rsi+8]
                add     ecx, eax
                mov     eax, r13d
                shr     eax, 3
                and     eax, r8d
                cmp     ecx, eax
                jnz     short loc_14026FE40
                mov     rcx, r15
                and     dl, 10h
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14026FE3C
                test    dl, dl
                jz      short loc_14026FE4E
                jmp     short loc_14026FE40
; ---------------------------------------------------------------------------

loc_14026FE3C:                          ; CODE XREF: sub_14026FB10+324↑j
                test    dl, dl
                jnz     short loc_14026FE4E

loc_14026FE40:                          ; CODE XREF: sub_14026FB10+315↑j
                                        ; sub_14026FB10+32A↑j
                mov     rcx, rsi
                call    sub_14026F5D0
                mov     r8d, 1FFh

loc_14026FE4E:                          ; CODE XREF: sub_14026FB10+302↑j
                                        ; sub_14026FB10+328↑j ...
                movzx   eax, word ptr [rsi+0Ah]
                mov     edi, 1
                test    ax, ax
                jnz     short loc_14026FE98
                mov     eax, r13d
                mov     [rsi+0Ah], di
                shr     eax, 3
                mov     rcx, r15
                and     ax, r8w
                movzx   r8d, byte ptr [rsi+0Dh]
                mov     [rsi+8], ax
                call    sub_1403F41D8
                mov     edx, eax
                movzx   eax, r8b
                or      al, 10h
                and     r8b, 0EFh
                test    edx, edx
                movzx   ecx, r8b
                movzx   eax, al
                cmovz   ecx, eax
                mov     [rsi+0Dh], cl
                jmp     short loc_14026FEA6
; ---------------------------------------------------------------------------

loc_14026FE98:                          ; CODE XREF: sub_14026FB10+34A↑j
                inc     ax
                mov     [rsi+0Ah], ax
                jmp     short loc_14026FEA6
; ---------------------------------------------------------------------------

loc_14026FEA1:                          ; CODE XREF: sub_14026FB10+2E6↑j
                                        ; sub_14026FB10+2EF↑j
                mov     edi, 1

loc_14026FEA6:                          ; CODE XREF: sub_14026FB10+386↑j
                                        ; sub_14026FB10+38F↑j
                mov     rcx, [rsp+0C8h+var_60]
                xor     r9d, r9d
                mov     [rsp+0C8h+var_98], 0
                mov     r8, r15
                mov     [rsp+0C8h+var_A0], 0Ch
                mov     rdx, r13
                mov     [rsp+0C8h+var_A8], rbx
                call    sub_140228E90
                mov     r15d, [rsp+0C8h+arg_18]
                mov     r13, [rsp+0C8h+arg_8]
                test    eax, eax
                jz      short loc_14026FF22
                mov     rdx, [rsp+0C8h+var_68]
                add     r12, 8
                inc     ebp
                mov     [rsp+0C8h+var_78], r12
                mov     r11, 0FFFFFA8000000000h
                mov     r8d, 1FFh
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     ebp, r15d
                jb      loc_14026FBF2
                mov     r12, [rsp+0C8h+arg_10]
                xor     ebx, ebx
                jmp     short loc_14026FF35
; ---------------------------------------------------------------------------

loc_14026FF22:                          ; CODE XREF: sub_14026FB10+3D1↑j
                mov     r12, [rsp+0C8h+arg_10]
                xor     ebx, ebx
                mov     edi, ebx
                jmp     short loc_14026FF35
; ---------------------------------------------------------------------------

loc_14026FF30:                          ; CODE XREF: sub_14026FB10+C5↑j
                mov     r14, [rsp+0C8h+var_88]

loc_14026FF35:                          ; CODE XREF: sub_14026FB10+410↑j
                                        ; sub_14026FB10+41E↑j
                test    ebp, ebp
                jnz     short loc_14026FF4C
                mov     [rsi+0Ah], bx
                mov     rsi, 0FFFFFA8000000000h
                jmp     loc_14027000C
; ---------------------------------------------------------------------------

loc_14026FF4C:                          ; CODE XREF: sub_14026FB10+427↑j
                cmp     word ptr [rsi+0Ah], 0
                jz      short loc_14026FF5B
                mov     rcx, rsi
                call    sub_14026F5D0

loc_14026FF5B:                          ; CODE XREF: sub_14026FB10+441↑j
                mov     rcx, r13
                call    sub_1402C78A0
                mov     rsi, 0FFFFFA8000000000h
                lea     rbx, [rax+rax*2]
                shl     rbx, 4
                mov     rax, rsi
                add     rbx, rax
                xor     eax, eax
                mov     [rsp+0C8h+arg_0], eax
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jnb     short loc_14026FFAF
                nop     dword ptr [rax]

loc_14026FF90:                          ; CODE XREF: sub_14026FB10+494↓j
                                        ; sub_14026FB10+49D↓j
                lea     rcx, [rsp+0C8h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_14026FF90
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_14026FF90

loc_14026FFAF:                          ; CODE XREF: sub_14026FB10+47B↑j
                mov     rax, [rbx+18h]
                mov     rdx, 3FFFFFFFFFFFFFFFh
                mov     ecx, ebp
                add     rcx, rax
                xor     rcx, rax
                and     rcx, rdx
                xor     rcx, rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                mov     [rbx+18h], rcx
                lock and [rbx+18h], rax
                shl     r13, 19h
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                shl     rax, 19h
                sub     r13, rax
                sar     r13, 10h
                mov     rcx, r13
                call    sub_14029BB60
                mov     edx, ebp
                mov     rcx, rax
                call    sub_14029DD54

loc_14027000C:                          ; CODE XREF: sub_14026FB10+437↑j
                cmp     ebp, r15d
                jz      short loc_140270033

loc_140270011:                          ; CODE XREF: sub_14026FB10+521↓j
                mov     eax, ebp
                mov     rcx, [r12+rax*8]
                lea     rcx, [rcx+rcx*2]
                shl     rcx, 4
                mov     rax, rsi
                add     rcx, rax
                xor     edx, edx
                call    sub_140209CE0
                inc     ebp
                cmp     ebp, r15d
                jnz     short loc_140270011

loc_140270033:                          ; CODE XREF: sub_14026FB10+4FF↑j
                test    r14, r14
                jz      short loc_140270045
                mov     rcx, [rsp+0C8h+var_58]
                mov     rdx, r14
                call    sub_1402D4998

loc_140270045:                          ; CODE XREF: sub_14026FB10+526↑j
                mov     eax, edi
                add     rsp, 88h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14026FB10   endp

byte_14027005C  db 14h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE43C↑o
; Exported entry 1693. PfFileInfoNotify

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

                public PfFileInfoNotify
PfFileInfoNotify proc near              ; DATA XREF: .rdata:000000014005D6C0↑o
                                        ; .pdata:00000001400CE448↑o

var_D0          = qword ptr -0D0h
var_C0          = dword ptr -0C0h
var_BC          = dword ptr -0BCh
var_B8          = dword ptr -0B8h
var_B4          = dword ptr -0B4h
var_B0          = dword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = dword ptr -98h
var_94          = dword ptr -94h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = dword ptr -70h
var_6C          = dword ptr -6Ch
var_68          = xmmword ptr -68h
var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
arg_0           = qword ptr  10h
arg_8           = qword ptr  18h
arg_10          = dword ptr  20h
arg_18          = dword ptr  28h

; FUNCTION CHUNK AT 0000000140441678 SIZE 000005D5 BYTES

                mov     [rsp-8+arg_0], rcx
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-1Fh]
                sub     rsp, 0B8h
                xor     r12d, r12d
                mov     rsi, rcx
                cmp     dword ptr [rcx], 0Fh
                mov     [rbp+57h+var_94], r12d
                mov     [rbp+57h+var_6C], r12d
                mov     [rbp+57h+var_A8], r12
                mov     [rbp+57h+var_A0], r12
                jnz     loc_140270874
                mov     eax, [rcx+8]
                test    al, 8
                jnz     loc_14027030C
                test    al, 4
                jnz     loc_1402704A2

loc_1402700BF:                          ; CODE XREF: PfFileInfoNotify+447↓j
                                        ; PfFileInfoNotify+51A↓j ...
                mov     eax, [rsi+8]
                test    al, 1
                jz      loc_14027032A
                mov     eax, cs:dword_140C4FC64
                cmp     cs:dword_140C4FC60, eax
                jnb     loc_14027067D
                mov     eax, [rsi+4]

loc_1402700DF:                          ; CODE XREF: PfFileInfoNotify+615↓j
                                        ; PfFileInfoNotify+61E↓j ...
                cmp     eax, 4
                jnz     loc_14027032F
                mov     rdx, [rsi+10h]
                mov     ebx, [rdx+8]
                mov     ecx, [rdx+10h]
                and     ebx, 0FFFh
                add     rcx, 0FFFh
                add     rbx, rcx
                shr     rbx, 0Ch
                cmp     cs:dword_140C4C40C, r12d
                jnz     loc_1402702D1

loc_140270113:                          ; CODE XREF: PfFileInfoNotify+292↓j
                mov     eax, cs:dword_140C4FC64
                cmp     cs:dword_140C4FC60, eax
                jnb     loc_14027071E
                mov     rax, [rsi+10h]
                mov     rcx, [rax+20h]
                movsxd  r10, dword ptr [rax+14h]
                mov     r9, [rax+8]
                mov     r11, [rax+18h]
                mov     edx, [rcx+510h]
                mov     r8, [rcx+220h]
                shr     edx, 0Ch
                and     edx, 7
                test    dword ptr [r8+464h], 100000h
                jnz     loc_140270739

loc_14027015D:                          ; CODE XREF: PfFileInfoNotify+6D5↓j
                cmp     edx, cs:dword_140C4E6AC
                jb      loc_140270307
                mov     rcx, [r8+440h]
                mov     rax, r10
                shl     rax, 3Fh
                mov     rdx, 1FFFFFFFFFFFFFFFh
                or      rax, rbx
                mov     dword ptr [rbp+57h+var_48+4], ecx
                mov     qword ptr [rbp+57h+var_58], rax
                mov     rbx, r12
                mov     rax, [r8+468h]
                mov     rdi, r12
                xor     rax, rcx
                shr     r9, 0Ch
                and     rax, rdx
                mov     qword ptr [rbp+57h+var_68], r11
                mov     qword ptr [rbp+57h+var_58+8], rax
                mov     rcx, 0FFFFF78000000320h
                mov     eax, cs:dword_140CEC0D0
                mov     dword ptr [rbp+57h+var_48], eax
                mov     rax, 0FFFFF78000000004h
                mov     qword ptr [rbp+57h+var_68+8], r9
                mov     rcx, [rcx]
                mov     r15d, ecx
                mov     eax, [rax]
                imul    r15, rax
                shr     rcx, 20h
                imul    rcx, rax
                shr     r15, 18h
                shl     rcx, 8
                add     r15, rcx
                lea     rcx, unk_140C4FBA0
                shr     r15, 0Ah
                add     r15d, cs:dword_140C5015C
                call    sub_14024C840
                test    al, al
                jz      loc_140441BEC

loc_140270209:                          ; CODE XREF: PfFileInfoNotify+1D1B76↓j
                lea     rcx, unk_140C4FBC0
                call    ExpInterlockedPopEntrySList
                mov     rcx, rax
                test    rax, rax
                jz      loc_1402704C0

loc_140270221:                          ; CODE XREF: PfFileInfoNotify+462↓j
                                        ; PfFileInfoNotify+49A↓j
                mov     rdx, [rcx+18h]
                mov     rax, [rcx+20h]
                sub     rax, rdx
                cmp     rax, 40h ; '@'
                jl      loc_140441BC6
                mov     rdi, rdx
                mov     rbx, rcx
                mov     r14d, r12d

loc_14027023F:                          ; CODE XREF: PfFileInfoNotify+1D1BD8↓j
                test    r14d, r14d
                js      loc_140441BF2
                mov     rax, [rdi]
                movups  xmm0, [rbp+57h+var_68]
                mov     [rdi+8], r15d
                and     rax, 0FFFFFFFFFFFEA013h
                movups  xmm1, [rbp+57h+var_58]
                or      rax, 2A013h
                mov     [rdi], rax
                movups  xmmword ptr [rdi+10h], xmm0
                movsd   xmm0, [rbp+57h+var_48]
                movups  xmmword ptr [rdi+20h], xmm1
                movsd   qword ptr [rdi+30h], xmm0
                add     qword ptr [rbx+18h], 40h ; '@'
                inc     dword ptr [rbx+28h]
                mov     rdi, [rbx+10h]
                mov     rcx, [rbx+20h]
                sub     rcx, [rbx+18h]
                movsxd  rax, dword ptr [rdi+50h]
                cmp     rcx, rax
                jl      loc_14027050F
                lea     rcx, [rdi+20h]
                mov     rdx, rbx
                call    ExpInterlockedPushEntrySList
                mov     rcx, rdi
                call    sub_14024C380

loc_1402702AD:                          ; CODE XREF: PfFileInfoNotify+4AB↓j
                mov     r14d, r12d

loc_1402702B0:                          ; CODE XREF: PfFileInfoNotify+29A↓j
                                        ; PfFileInfoNotify+ABF↓j ...
                test    r14d, r14d
                js      loc_140270724

loc_1402702B9:                          ; CODE XREF: PfFileInfoNotify+2BD↓j
                                        ; PfFileInfoNotify+42D↓j ...
                mov     eax, r14d
                add     rsp, 0B8h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402702D1:                          ; CODE XREF: PfFileInfoNotify+9D↑j
                mov     r14, [rdx+20h]
                mov     r12, rbx
                mov     rax, [rdx]
                mov     r15, [rdx+8]
                mov     r13, [rdx+18h]
                mov     rcx, [r14+220h]
                mov     [rbp+57h+arg_8], rax
                call    sub_140270D30
                mov     rdi, rax
                test    rax, rax
                jnz     loc_140270520

loc_1402702FF:                          ; CODE XREF: PfFileInfoNotify+50A↓j
                xor     r12d, r12d
                jmp     loc_140270113
; ---------------------------------------------------------------------------

loc_140270307:                          ; CODE XREF: PfFileInfoNotify+F3↑j
                mov     r14d, r12d
                jmp     short loc_1402702B0
; ---------------------------------------------------------------------------

loc_14027030C:                          ; CODE XREF: PfFileInfoNotify+41↑j
                mov     ecx, [rcx+4]
                cmp     ecx, 7
                jnz     loc_14027087F
                mov     edi, 1
                lock xadd cs:dword_140CEC0D0, edi
                inc     edi
                mov     [rsi+10h], edi

loc_14027032A:                          ; CODE XREF: PfFileInfoNotify+54↑j
                                        ; PfFileInfoNotify+2F2↓j ...
                mov     r14d, r12d
                jmp     short loc_1402702B9
; ---------------------------------------------------------------------------

loc_14027032F:                          ; CODE XREF: PfFileInfoNotify+72↑j
                cmp     eax, 0Dh        ; switch 14 cases
                ja      def_14027034B   ; jumptable 000000014027034B default case, cases 4-7,9-12
                lea     rdx, cs:140000000h
                cdqe
                mov     ecx, ds:(jpt_14027034B - 140000000h)[rdx+rax*4]
                add     rcx, rdx
                jmp     rcx             ; switch jump
; ---------------------------------------------------------------------------
                db 4 dup(0CCh)
; ---------------------------------------------------------------------------

loc_140270351:                          ; CODE XREF: PfFileInfoNotify+2DB↑j
                                        ; DATA XREF: PfFileInfoNotify:jpt_14027034B↓o
                mov     rdx, [rsi+10h]  ; jumptable 000000014027034B case 2
                mov     eax, [rdx+20h]
                mov     ecx, eax
                shr     ecx, 10h
                movzx   eax, ax
                cmp     ecx, eax
                jbe     short loc_14027032A
                mov     r8d, 1
                lea     rcx, unk_140C501D8
                call    sub_1405E96E0
                mov     eax, cs:dword_140C4FC64
                cmp     cs:dword_140C4FC60, eax
                jnb     loc_14027074A
                mov     rax, [rsi+10h]
                lea     r8, [rbp+57h+var_A0]
                mov     edx, [rax+20h]
                mov     rax, [rax+18h]
                mov     ebx, edx
                movzx   ecx, dx
                shr     ebx, 10h
                lea     r12, [rax+rcx*2]
                movzx   eax, dx
                sub     ebx, eax
                lea     rdx, [rbp+57h+var_A8]
                lea     rcx, unk_140C4FB20
                lea     r13d, [rbx+rbx]
                lea     r15d, [r13+35h]
                and     r15d, 0FFFFFFF8h
                mov     r9d, r15d
                call    sub_1402088C8
                mov     r14d, eax
                test    eax, eax
                js      loc_140441BAC
                mov     rdi, [rbp+57h+var_A0]
                mov     ecx, r15d
                and     ecx, 0FFFFFFFh
                mov     r8d, r13d
                shl     ecx, 3
                mov     eax, [rdi]
                and     eax, 80000000h
                or      ecx, eax
                mov     [rdi], ecx
                mov     rax, [rsi+10h]
                mov     ecx, [rax+28h]
                mov     [rdi+4], ecx
                mov     rax, [rsi+10h]
                mov     ecx, [rax+2Ch]
                mov     [rdi+8], ecx
                mov     rax, [rsi+10h]
                mov     rcx, [rax+8]
                mov     [rdi+18h], rcx
                mov     rax, [rsi+10h]
                mov     ecx, [rax+30h]
                mov     [rdi+20h], ecx
                mov     rax, [rsi+10h]
                mov     rcx, [rax+10h]
                mov     [rdi+10h], rcx
                mov     rax, [rsi+10h]
                mov     edx, [rax+24h]
                xor     edx, [rdi+28h]
                and     edx, 1
                xor     [rdi+28h], edx
                mov     rdx, r12
                mov     ecx, [rdi+28h]
                mov     rax, [rsi+10h]
                mov     r9d, [rax+24h]
                shr     r9d, 3
                xor     r9d, ecx
                and     r9d, 2
                xor     r9d, ecx
                mov     [rdi+28h], r9d
                mov     rax, [rsi+10h]
                mov     ecx, [rax+24h]
                add     ecx, ecx
                xor     ecx, r9d
                and     ecx, 4
                xor     ecx, r9d
                mov     [rdi+28h], ecx
                lea     rcx, [rdi+2Ch]
                mov     [rdi+2Ah], bx
                call    memmove
                movzx   eax, word ptr [rdi+2Ah]
                lea     rcx, [rdi+2Ch]
                xor     r12d, r12d
                mov     [rdi+rax*2+2Ch], r12w

loc_140270489:                          ; CODE XREF: PfFileInfoNotify+7DF↓j
                call    _wcsupr
                mov     rcx, [rbp+57h+var_A8]
                mov     r8d, r15d
                call    sub_1402089A4
                mov     r14d, r12d
                jmp     loc_1402702B9
; ---------------------------------------------------------------------------

loc_1402704A2:                          ; CODE XREF: PfFileInfoNotify+49↑j
                mov     eax, [rcx+4]
                cmp     eax, 2
                jnz     loc_14027057F
                mov     rcx, [rcx+10h]
                call    sub_140696C74
                jmp     loc_1402700BF
; ---------------------------------------------------------------------------
                align 20h

loc_1402704C0:                          ; CODE XREF: PfFileInfoNotify+1AB↑j
                                        ; PfFileInfoNotify+498↓j
                lea     rcx, unk_140C4FBB0
                call    ExpInterlockedPopEntrySList
                mov     rcx, rax
                test    rax, rax
                jnz     loc_140270221
                mov     rax, cs:qword_140C4FBF8
                lea     rcx, unk_140C4FBA0
                call    sub_1404079D0
                mov     r14d, eax
                test    eax, eax
                js      loc_140441C2E
                lea     rcx, unk_140C4FBC0
                call    ExpInterlockedPopEntrySList
                mov     rcx, rax
                test    rax, rax
                jz      short loc_1402704C0
                jmp     loc_140270221
; ---------------------------------------------------------------------------

loc_14027050F:                          ; CODE XREF: PfFileInfoNotify+223↑j
                mov     rax, [rdi+60h]
                mov     rcx, rbx
                call    sub_1404079D0
                jmp     loc_1402702AD
; ---------------------------------------------------------------------------

loc_140270520:                          ; CODE XREF: PfFileInfoNotify+289↑j
                xor     r8d, r8d
                mov     rdx, rdi
                mov     rcx, r14
                call    sub_1402EEB70
                test    eax, eax
                jz      short loc_14027056E
                and     r15, 0FFFFFFFFFFFFF000h
                test    rbx, rbx
                jz      short loc_14027056E
                mov     r14, [rbp+57h+arg_8]
                xor     esi, esi

loc_140270544:                          ; CODE XREF: PfFileInfoNotify+4F8↓j
                mov     r9, r15
                mov     dword ptr [rsp+0F0h+var_D0], esi
                mov     r8, r13
                mov     rdx, r14
                mov     rcx, rdi
                call    sub_14026EFEC
                test    eax, eax
                js      short loc_14027056A
                add     r15, 1000h
                sub     r12, 1
                jnz     short loc_140270544

loc_14027056A:                          ; CODE XREF: PfFileInfoNotify+4EB↑j
                mov     rsi, [rbp+57h+arg_0]

loc_14027056E:                          ; CODE XREF: PfFileInfoNotify+4C0↑j
                                        ; PfFileInfoNotify+4CC↑j
                lea     rcx, [rdi+168h]
                call    sub_14024C380
                jmp     loc_1402702FF
; ---------------------------------------------------------------------------

loc_14027057F:                          ; CODE XREF: PfFileInfoNotify+438↑j
                test    eax, eax
                jz      loc_14027075A
                cmp     eax, 3
                jnz     loc_1402700BF
                mov     rcx, [rcx+10h]
                call    sub_1406FC46C
                jmp     loc_1402700BF
; ---------------------------------------------------------------------------

loc_14027059E:                          ; CODE XREF: PfFileInfoNotify+2DB↑j
                                        ; DATA XREF: PfFileInfoNotify:jpt_14027034B↓o
                mov     rcx, [rsi+10h]  ; jumptable 000000014027034B case 13
                mov     rax, [rcx+8]
                test    rax, rax
                jz      loc_140441BBB
                mov     [rbp+57h+var_78], rax
                lea     r8, [rbp+57h+var_80]
                mov     eax, cs:dword_140CEC0D0
                mov     r9d, 18h
                mov     [rbp+57h+var_70], eax
                mov     rax, [rcx]
                mov     rcx, 0FFFFF78000000320h
                mov     [rbp+57h+var_80], rax
                mov     rax, 0FFFFF78000000004h
                mov     [rbp+57h+var_6C], r12d
                mov     rcx, [rcx]
                mov     eax, [rax]
                mov     edx, ecx
                shr     rcx, 20h
                imul    rcx, rax
                imul    rdx, rax
                shl     rcx, 8
                shr     rdx, 18h
                add     rdx, rcx
                lea     ecx, [r9+7]

loc_140270607:                          ; CODE XREF: PfFileInfoNotify+6A9↓j
                shr     rdx, 0Ah
                add     edx, cs:dword_140C5015C
                call    sub_1402087D8
                mov     r14d, r12d
                jmp     loc_1402702B9
; ---------------------------------------------------------------------------

loc_14027061E:                          ; CODE XREF: PfFileInfoNotify+2DB↑j
                                        ; DATA XREF: PfFileInfoNotify:jpt_14027034B↓o
                mov     rdx, [rsi+10h]  ; jumptable 000000014027034B case 3
                mov     eax, [rdx+20h]
                mov     ecx, eax
                shr     ecx, 10h
                movzx   eax, ax
                cmp     ecx, eax
                jbe     loc_14027032A
                xor     r8d, r8d
                lea     rcx, unk_140C501D8
                call    sub_1405E96E0
                mov     eax, cs:dword_140C4FC64
                cmp     cs:dword_140C4FC60, eax
                jnb     loc_140270752
                mov     rdx, [rsi+10h]
                xor     ecx, ecx
                mov     r9d, [rdx+24h]
                mov     r8d, [rdx+2Ch]
                mov     rdx, [rdx+10h]
                shr     r9d, 3
                and     r9d, 1
                call    sub_14020865C
                mov     r14d, r12d
                jmp     loc_1402702B9
; ---------------------------------------------------------------------------

loc_14027067D:                          ; CODE XREF: PfFileInfoNotify+66↑j
                mov     ecx, [rsi+4]
                mov     eax, ecx
                cmp     ecx, 4
                jz      loc_1402700DF
                cmp     ecx, 2
                jz      loc_1402700DF
                cmp     ecx, 3
                jz      loc_1402700DF
                mov     r14d, 0C000007Fh
                jmp     short loc_140270724
; ---------------------------------------------------------------------------

loc_1402706A5:                          ; CODE XREF: PfFileInfoNotify+2DB↑j
                                        ; DATA XREF: PfFileInfoNotify:jpt_14027034B↓o
                mov     rcx, [rsi+10h]  ; jumptable 000000014027034B case 8
                lea     r8, [rbp+57h+var_98]
                mov     r9d, 18h
                mov     [rbp+57h+var_94], r12d
                mov     eax, [rcx+4]
                mov     edx, [rcx]
                mov     [rbp+57h+var_98], eax
                and     edx, 3
                mov     rax, [rcx+8]
                add     rdx, rdx
                mov     [rbp+57h+var_90], rax
                mov     rax, [rcx+10h]
                mov     rcx, 0FFFFF78000000320h
                add     rax, 0FFFh
                and     rax, 0FFFFFFFFFFFFF000h
                or      rdx, rax
                mov     rax, 0FFFFF78000000004h
                mov     rcx, [rcx]
                mov     [rbp+57h+var_88], rdx
                mov     edx, ecx
                mov     eax, [rax]
                shr     rcx, 20h
                imul    rcx, rax
                imul    rdx, rax
                shl     rcx, 8
                shr     rdx, 18h
                add     rdx, rcx
                mov     ecx, r9d
                jmp     loc_140270607
; ---------------------------------------------------------------------------

loc_14027071E:                          ; CODE XREF: PfFileInfoNotify+AF↑j
                mov     r14d, 0C000007Fh

loc_140270724:                          ; CODE XREF: PfFileInfoNotify+243↑j
                                        ; PfFileInfoNotify+633↑j ...
                cmp     dword ptr [rsi+4], 3
                jg      loc_1402702B9
                inc     cs:dword_140C4FD64
                jmp     loc_1402702B9
; ---------------------------------------------------------------------------

loc_140270739:                          ; CODE XREF: PfFileInfoNotify+E7↑j
                mov     eax, 2
                cmp     edx, eax
                cmovb   eax, edx
                mov     edx, eax
                jmp     loc_14027015D
; ---------------------------------------------------------------------------

loc_14027074A:                          ; CODE XREF: PfFileInfoNotify+312↑j
                mov     r14d, 0C000007Fh
                jmp     short loc_140270724
; ---------------------------------------------------------------------------

loc_140270752:                          ; CODE XREF: PfFileInfoNotify+5E0↑j
                mov     r14d, 0C000007Fh
                jmp     short loc_140270724
; ---------------------------------------------------------------------------

loc_14027075A:                          ; CODE XREF: PfFileInfoNotify+511↑j
                mov     rcx, [rcx+10h]
                call    sub_1406961AC
                jmp     loc_1402700BF
; ---------------------------------------------------------------------------

loc_140270768:                          ; CODE XREF: PfFileInfoNotify+2DB↑j
                                        ; DATA XREF: PfFileInfoNotify:jpt_14027034B↓o
                mov     rax, [rsi+10h]  ; jumptable 000000014027034B case 0
                lea     r8, [rbp+57h+var_A0]
                lea     rdx, [rbp+57h+var_A8]
                lea     rcx, unk_140C4FB20
                movzx   r13d, word ptr [rax+1Eh]
                add     r13d, r13d
                lea     r15d, [r13+41h]
                and     r15d, 0FFFFFFF8h
                mov     r9d, r15d
                call    sub_1402088C8
                mov     r14d, eax
                test    eax, eax
                js      loc_140441BAC
                mov     rdi, [rbp+57h+var_A0]
                lea     eax, ds:0[r15*8]
                mov     r8d, r13d
                mov     ecx, [rdi]
                and     ecx, 80000002h
                or      ecx, eax
                or      ecx, 2
                mov     [rdi], ecx
                mov     rax, [rsi+10h]
                mov     ecx, [rax+34h]
                mov     [rdi+4], ecx
                mov     rax, [rsi+10h]
                mov     ecx, [rax+38h]
                mov     [rdi+8], ecx
                mov     rax, [rsi+10h]
                mov     rcx, [rax+8]
                mov     [rdi+18h], rcx
                mov     rax, [rsi+10h]
                mov     edx, [rax+30h]
                xor     edx, [rdi+24h]
                and     edx, 0Fh
                xor     [rdi+24h], edx
                mov     edx, [rdi+24h]
                mov     rax, [rsi+10h]
                mov     ecx, [rax+30h]
                xor     ecx, edx
                and     ecx, 0F0h
                xor     ecx, edx
                mov     [rdi+24h], ecx
                mov     rax, [rsi+10h]
                mov     rcx, [rax+10h]
                mov     [rdi+10h], rcx
                mov     rax, [rsi+10h]
                mov     ecx, [rax+18h]
                mov     [rdi+20h], ecx
                mov     rax, [rsi+10h]
                movzx   ecx, word ptr [rax+1Eh]
                add     cx, cx
                mov     [rdi+28h], cx
                mov     [rdi+2Ah], cx
                lea     rcx, [rdi+38h]
                mov     rdx, [rsi+10h]
                mov     rdx, [rdx+28h]
                call    memmove
                mov     rax, [rsi+10h]
                lea     rcx, [rdi+38h]
                movzx   edx, word ptr [rax+1Eh]
                mov     [rdi+rdx*2+38h], r12w
                jmp     loc_140270489
; ---------------------------------------------------------------------------

loc_140270854:                          ; CODE XREF: PfFileInfoNotify+2DB↑j
                                        ; DATA XREF: PfFileInfoNotify:jpt_14027034B↓o
                mov     rdx, [rsi+10h]  ; jumptable 000000014027034B case 1
                xor     r9d, r9d
                mov     r8d, [rdx+38h]
                lea     ecx, [r9+2]
                mov     rdx, [rdx+8]
                call    sub_14020865C
                mov     r14d, r12d
                jmp     loc_1402702B9
; ---------------------------------------------------------------------------

loc_140270874:                          ; CODE XREF: PfFileInfoNotify+36↑j
                mov     r14d, 0C000000Dh
                jmp     loc_140270724
; ---------------------------------------------------------------------------

loc_14027087F:                          ; CODE XREF: PfFileInfoNotify+2A2↑j
                sub     ecx, 0Ah
                jnz     loc_140270CB6
                mov     rax, gs:188h
                dec     word ptr [rax+1E4h]
                xor     edx, edx
                lea     rcx, qword_140C50288
                call    ExAcquirePushLockExclusiveEx
                cmp     cs:qword_140C50278, 0
                mov     rbx, 0FFFFFFFFFFFFFFFFh
                mov     r12d, 0FFFFFFFFh
                mov     r13, 7FFFFFFFFFFFFFFCh
                lea     edi, [rbx+2]
                jnz     loc_140441B6F
                mov     rax, gs:188h
                dec     word ptr [rax+1E4h]
                xor     edx, edx
                lea     rcx, qword_140C50290
                call    ExAcquirePushLockExclusiveEx
                and     cs:dword_140C502A8, 0FFFFFFFEh
                mov     rax, rbx
                lock xadd cs:qword_140C50290, rax
                and     al, 6
                cmp     al, 2
                jnz     short loc_140270911
                lea     rcx, qword_140C50290
                call    ExfTryToWakePushLock

loc_140270911:                          ; CODE XREF: PfFileInfoNotify+893↑j
                xor     r15d, r15d
                lea     rcx, qword_140C50290
                mov     [rbp+57h+var_B8], r15d
                mov     r14, gs:188h
                call    sub_140245330
                cmp     eax, edi
                jnz     loc_140270CDB
                mov     rcx, [r14+0B8h]
                call    sub_140245840
                mov     r8d, eax

loc_140270944:                          ; CODE XREF: PfFileInfoNotify+C6E↓j
                dec     word ptr [r14+1E6h]
                inc     byte ptr [r14+31Ah]
                movsx   ecx, byte ptr [r14+318h]
                lea     r9, qword_140C50290
                movsx   edx, byte ptr [r14+366h]
                and     r9, r13
                movzx   eax, byte ptr [r14+31Ah]
                or      edx, ecx
                xor     edx, 3Fh
                mov     byte ptr [rbp+57h+arg_0], al
                bsr     ecx, edx
                mov     [rbp+57h+var_BC], ecx
                jz      short loc_1402709C6

loc_140270985:                          ; CODE XREF: PfFileInfoNotify+951↓j
                lea     r15, [rcx+rcx*2]
                mov     eax, edi
                shl     r15, 5
                add     r15, [r14+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    [r15+1Ah], dil
                jz      short loc_1402709BB
                mov     eax, [r15+20h]
                test    dil, al
                jnz     short loc_1402709BB
                mov     rax, [r15+20h]
                and     rax, r13
                cmp     rax, r9
                jz      loc_140270B34

loc_1402709BB:                          ; CODE XREF: PfFileInfoNotify+930↑j
                                        ; PfFileInfoNotify+939↑j ...
                bsr     ecx, edx
                mov     [rbp+57h+var_BC], ecx
                jnz     short loc_140270985

loc_1402709C3:                          ; CODE XREF: PfFileInfoNotify+AE3↓j
                xor     r15d, r15d

loc_1402709C6:                          ; CODE XREF: PfFileInfoNotify+913↑j
                mov     eax, [r14+78h]
                bt      eax, 10h
                jnb     loc_140441B52

loc_1402709D4:                          ; CODE XREF: PfFileInfoNotify+B67↓j
                                        ; PfFileInfoNotify+1D1ADD↓j
                dec     byte ptr [r14+31Ah]
                lea     r8, [rbp+57h+var_B8]
                lea     rdx, qword_140C50290
                mov     rcx, r14
                call    sub_1402456E0
                add     [r14+1E6h], di
                jz      loc_140270BDC

loc_1402709FC:                          ; CODE XREF: PfFileInfoNotify+B76↓j
                                        ; PfFileInfoNotify+B81↓j
                call    KeLeaveCriticalRegion
                mov     rax, [rsi+10h]
                lea     rcx, sub_1408E1340
                mov     rax, [rax+20h]
                call    sub_1404079D0
                mov     rax, [rsi+10h]
                xor     r15d, r15d
                mov     cs:qword_140C50278, rax
                mov     r14d, r15d
                mov     eax, r15d
                xchg    rax, cs:qword_140C50280

loc_140270A30:                          ; CODE XREF: PfFileInfoNotify+1D1B08↓j
                lock xadd cs:qword_140C50288, rbx
                and     bl, 6
                cmp     bl, 2
                jnz     short loc_140270A4D
                lea     rcx, qword_140C50288
                call    ExfTryToWakePushLock

loc_140270A4D:                          ; CODE XREF: PfFileInfoNotify+9CF↑j
                mov     [rbp+57h+var_B0], r15d
                lea     rcx, qword_140C50288
                mov     rbx, gs:188h
                call    sub_140245330
                cmp     eax, edi
                jnz     short loc_140270A79
                mov     rcx, [rbx+0B8h]
                call    sub_140245840
                mov     r12d, eax

loc_140270A79:                          ; CODE XREF: PfFileInfoNotify+9F8↑j
                dec     word ptr [rbx+1E6h]
                inc     byte ptr [rbx+31Ah]
                movsx   ecx, byte ptr [rbx+318h]
                lea     r8, qword_140C50288
                movsx   edx, byte ptr [rbx+366h]
                and     r8, r13
                movzx   eax, byte ptr [rbx+31Ah]
                or      edx, ecx
                xor     edx, 3Fh
                mov     byte ptr [rbp+57h+arg_0], al
                bsr     ecx, edx
                mov     [rbp+57h+var_B4], ecx
                jz      short loc_140270AF6

loc_140270AB5:                          ; CODE XREF: PfFileInfoNotify+A81↓j
                lea     r15, [rcx+rcx*2]
                mov     eax, edi
                shl     r15, 5
                add     r15, [rbx+320h]
                shl     eax, cl
                not     eax
                and     edx, eax
                test    [r15+1Ah], dil
                jz      short loc_140270AEB
                mov     eax, [r15+20h]
                test    dil, al
                jnz     short loc_140270AEB
                mov     rax, [r15+20h]
                and     rax, r13
                cmp     rax, r8
                jz      loc_140270BF6

loc_140270AEB:                          ; CODE XREF: PfFileInfoNotify+A60↑j
                                        ; PfFileInfoNotify+A69↑j ...
                bsr     ecx, edx
                mov     [rbp+57h+var_B4], ecx
                jnz     short loc_140270AB5

loc_140270AF3:                          ; CODE XREF: PfFileInfoNotify+BA5↓j
                xor     r15d, r15d

loc_140270AF6:                          ; CODE XREF: PfFileInfoNotify+A43↑j
                mov     eax, [rbx+78h]
                bt      eax, 10h
                jnb     loc_140441B8F

loc_140270B03:                          ; CODE XREF: PfFileInfoNotify+C27↓j
                                        ; PfFileInfoNotify+1D1B1A↓j
                dec     byte ptr [rbx+31Ah]
                lea     r8, [rbp+57h+var_B0]
                lea     rdx, qword_140C50288
                mov     rcx, rbx
                call    sub_1402456E0
                add     word ptr [rbx+1E6h], 1
                jz      loc_140270C9C

loc_140270B2A:                          ; CODE XREF: PfFileInfoNotify+C36↓j
                                        ; PfFileInfoNotify+C41↓j
                call    KeLeaveCriticalRegion
                jmp     loc_1402702B0
; ---------------------------------------------------------------------------

loc_140270B34:                          ; CODE XREF: PfFileInfoNotify+945↑j
                cmp     [r15+28h], r8d
                jnz     loc_1402709BB
                and     byte ptr [r15+1Ah], 0FEh
                mov     rax, [r15+20h]
                test    rax, rax
                jz      loc_1402709BB
                test    r15, r15
                jz      loc_1402709C3
                movzx   eax, byte ptr [r15+20h]
                or      al, 2
                mov     [r15+20h], al
                mov     rax, [r15+20h]
                shr     rax, 3Fh
                test    al, al
                jz      short loc_140270B78
                mov     rcx, r15
                call    sub_14031EC80

loc_140270B78:                          ; CODE XREF: PfFileInfoNotify+AFE↑j
                mov     eax, [r15+58h]
                and     eax, 1FFFFh
                mov     [rbp+57h+var_B8], eax
                and     dword ptr [r15+58h], 0FFFE0000h
                and     byte ptr [r15+19h], 0FEh
                mov     qword ptr [r15+20h], 0
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     r15, [r14+320h]
                imul    r15
                sar     rdx, 4
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                cmp     byte ptr [rbp+57h+arg_0], dil
                jnz     loc_140441B3F
                movzx   eax, byte ptr [r14+318h]
                bts     eax, edx
                mov     [r14+318h], al
                jmp     loc_1402709D4
; ---------------------------------------------------------------------------

loc_140270BDC:                          ; CODE XREF: PfFileInfoNotify+986↑j
                lea     rax, [r14+98h]
                cmp     [rax], rax
                jz      loc_1402709FC
                call    KiCheckForKernelApcDelivery
                jmp     loc_1402709FC
; ---------------------------------------------------------------------------

loc_140270BF6:                          ; CODE XREF: PfFileInfoNotify+A75↑j
                cmp     [r15+28h], r12d
                jnz     loc_140270AEB
                and     byte ptr [r15+1Ah], 0FEh
                mov     rax, [r15+20h]
                test    rax, rax
                jz      loc_140270AEB
                test    r15, r15
                jz      loc_140270AF3
                movzx   eax, byte ptr [r15+20h]
                or      al, 2
                mov     [r15+20h], al
                mov     rax, [r15+20h]
                shr     rax, 3Fh
                test    al, al
                jz      short loc_140270C3A
                mov     rcx, r15
                call    sub_14031EC80

loc_140270C3A:                          ; CODE XREF: PfFileInfoNotify+BC0↑j
                mov     eax, [r15+58h]
                and     eax, 1FFFFh
                mov     [rbp+57h+var_B0], eax
                and     dword ptr [r15+58h], 0FFFE0000h
                and     byte ptr [r15+19h], 0FEh
                mov     qword ptr [r15+20h], 0
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     r15, [rbx+320h]
                imul    r15
                sar     rdx, 4
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                cmp     byte ptr [rbp+57h+arg_0], dil
                jnz     loc_140441B7D
                movzx   eax, byte ptr [rbx+318h]
                bts     eax, edx
                mov     [rbx+318h], al
                jmp     loc_140270B03
; ---------------------------------------------------------------------------

loc_140270C9C:                          ; CODE XREF: PfFileInfoNotify+AB4↑j
                lea     rax, [rbx+98h]
                cmp     [rax], rax
                jz      loc_140270B2A
                call    KiCheckForKernelApcDelivery
                jmp     loc_140270B2A
; ---------------------------------------------------------------------------

loc_140270CB6:                          ; CODE XREF: PfFileInfoNotify+812↑j
                sub     ecx, 1
                jz      loc_14044168E
                cmp     ecx, 1
                jnz     def_14027034B   ; jumptable 000000014027034B default case, cases 4-7,9-12
                mov     eax, cs:dword_140C503D0
                test    al, 2
                jz      loc_14027032A
                jmp     loc_140441683
; ---------------------------------------------------------------------------

loc_140270CDB:                          ; CODE XREF: PfFileInfoNotify+8BF↑j
                mov     r8d, r12d
                jmp     loc_140270944
; ---------------------------------------------------------------------------
                align 4
jpt_14027034B   dd offset loc_140270768 - 140000000h
                                        ; DATA XREF: PfFileInfoNotify+2D1↑r
                dd offset loc_140270854 - 140000000h ; jump table for switch statement
                dd offset loc_140270351 - 140000000h
                dd offset loc_14027061E - 140000000h
                dd offset def_14027034B - 140000000h
                dd offset def_14027034B - 140000000h
                dd offset def_14027034B - 140000000h
                dd offset def_14027034B - 140000000h
                dd offset loc_1402706A5 - 140000000h
                dd offset def_14027034B - 140000000h
                dd offset def_14027034B - 140000000h
                dd offset def_14027034B - 140000000h
                dd offset def_14027034B - 140000000h
                dd offset loc_14027059E - 140000000h
PfFileInfoNotify endp

byte_140270D1C  db 14h dup(0CCh)        ; DATA XREF: .rdata:000000014005D6C0↑o
                                        ; .pdata:00000001400CE448↑o

; =============== S U B R O U T I N E =======================================


sub_140270D30   proc near               ; CODE XREF: sub_14026FB10+196↑p
                                        ; PfFileInfoNotify+27E↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140441C4E SIZE 000000E8 BYTES

                mov     [rsp+arg_10], rbx
                push    rdi
                sub     rsp, 20h
                mov     rdi, rcx
                prefetchw byte ptr [rcx+600h]
                mov     r8, [rcx+600h]
                test    r8b, 0Fh
                jnz     loc_140270DF0

loc_140270D55:                          ; CODE XREF: sub_140270D30+D0↓j
                                        ; sub_140270D30+DD↓j
                mov     rbx, r8
                and     rbx, 0FFFFFFFFFFFFFFF0h
                jnz     short loc_140270D6D

loc_140270D5E:                          ; CODE XREF: sub_140270D30+45↓j
                mov     rax, rbx

loc_140270D61:                          ; CODE XREF: sub_140270D30+B7↓j
                mov     rbx, [rsp+28h+arg_10]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140270D6D:                          ; CODE XREF: sub_140270D30+2C↑j
                and     r8d, 0Fh
                cmp     r8d, 1
                ja      short loc_140270D5E

loc_140270D77:                          ; DATA XREF: .rdata:000000014005D6E4↑o
                                        ; .rdata:000000014005D6F4↑o ...
                mov     [rsp+28h+arg_8], rsi
                test    r8d, r8d
                jz      loc_140270E12
                mov     edx, 0Fh
                lea     rcx, [rbx+168h]
                call    ExAcquireRundownProtectionEx
                test    al, al
                jz      short loc_140270DDF
                prefetchw byte ptr [rdi+600h]
                mov     rax, [rdi+600h]
                mov     rcx, rax
                and     ecx, 0Fh
                add     rcx, 0Fh
                cmp     rcx, 0Fh
                ja      loc_140441CCC

loc_140270DBC:                          ; CODE XREF: sub_140270D30+1D0F96↓j
                mov     rcx, rax
                and     rcx, 0FFFFFFFFFFFFFFF0h
                cmp     rbx, rcx
                jnz     loc_140441CCC
                lea     rcx, [rax+0Fh]
                lock cmpxchg [rdi+600h], rcx
                jnz     loc_140441CB8

loc_140270DDF:                          ; CODE XREF: sub_140270D30+68↑j
                                        ; sub_140270D30+13B↓j ...
                mov     rax, rbx

loc_140270DE2:                          ; CODE XREF: sub_140270D30+143↓j
                mov     rsi, [rsp+28h+arg_8]
                jmp     loc_140270D61
; ---------------------------------------------------------------------------
                align 10h

loc_140270DF0:                          ; CODE XREF: sub_140270D30+1F↑j
                                        ; sub_140270D30+DB↓j
                                        ; DATA XREF: ...
                lea     rdx, [r8-1]
                mov     rax, r8
                lock cmpxchg [rcx+600h], rdx
                jz      loc_140270D55
                mov     r8, rax
                test    al, 0Fh
                jnz     short loc_140270DF0
                jmp     loc_140270D55
; ---------------------------------------------------------------------------

loc_140270E12:                          ; CODE XREF: sub_140270D30+4F↑j
                                        ; DATA XREF: .pdata:00000001400CE46C↑o ...
                mov     [rsp+28h+arg_0], rbp
                lea     rcx, qword_140C502D0
                mov     bpl, 1
                call    KeAcquireSpinLockRaiseToDpc
                mov     rbx, [rdi+600h]
                movzx   esi, al
                and     rbx, 0FFFFFFFFFFFFFFF0h
                jz      short loc_140270E45
                lea     rcx, [rbx+168h]
                call    sub_14024C840
                movzx   ebp, al

loc_140270E45:                          ; CODE XREF: sub_140270D30+104↑j
                lea     rcx, qword_140C502D0
                call    KeReleaseSpinLockFromDpcLevel
                mov     ecx, cs:dword_140CFC660
                test    ecx, ecx
                jnz     loc_140441C4E

loc_140270E5F:                          ; CODE XREF: sub_140270D30+1D0F21↓j
                                        ; sub_140270D30+1D0F2E↓j ...
                mov     cr8, rsi
                test    bpl, bpl
                mov     rbp, [rsp+28h+arg_0]
                jnz     loc_140270DDF

loc_140270E71:                          ; DATA XREF: .rdata:000000014005D708↑o
                                        ; .pdata:00000001400CE478↑o ...
                xor     eax, eax
                jmp     loc_140270DE2
sub_140270D30   endp

; ---------------------------------------------------------------------------
algn_140270E78:                         ; DATA XREF: .rdata:000000014005D708↑o
                                        ; .pdata:00000001400CE484↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140270E80   proc near               ; CODE XREF: sub_140243C30+68E↑p
                                        ; sub_14026D6F0+2A3↑p ...

arg_0           = qword ptr  8

; FUNCTION CHUNK AT 0000000140441D36 SIZE 00000027 BYTES

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 20h
                mov     r9, [rcx]
                mov     rdi, rcx
                mov     rcx, [rcx+8]
                mov     r10d, r8d
                mov     rbx, rdx
                mov     eax, [r9+38h]
                test    al, 20h
                jnz     short loc_140270ED7
                test    rcx, rcx
                jz      short loc_140270F14
                sub     rbx, rcx
                sar     rbx, 3
                shl     rbx, 0Ch

loc_140270EB2:                          ; CODE XREF: sub_140270E80+96↓j
                movzx   eax, word ptr [rdi+20h]
                mov     ecx, [rdi+24h]
                and     rax, 0FFFFFFFFFFFFFFC0h
                shl     rax, 1Ah
                or      rax, rcx
                shl     rax, 0Ch
                add     rax, rbx
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140270ED7:                          ; CODE XREF: sub_140270E80+20↑j
                cmp     rbx, rcx
                jb      loc_140441D36
                mov     eax, [rdi+2Ch]
                lea     rdx, [rcx+rax*8]
                cmp     rbx, rdx
                jnb     loc_140441D36
                sub     rbx, rcx

loc_140270EF3:                          ; CODE XREF: sub_140270E80+1D0ED8↓j
                mov     eax, [rdi+24h]
                shl     rbx, 9
                and     rbx, 0FFFFFFFFFFFFF000h
                shl     rax, 9
                add     rax, rbx
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140270F14:                          ; CODE XREF: sub_140270E80+25↑j
                xor     ebx, ebx
                jmp     short loc_140270EB2
sub_140270E80   endp

; ---------------------------------------------------------------------------
algn_140270F18:                         ; DATA XREF: .rdata:000000014005D76C↑o
                                        ; .pdata:00000001400CE490↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140270F20   proc near               ; CODE XREF: sub_14026E700+6D↑p
                                        ; sub_14026FB10+16C↑p ...
                sub     rsp, 28h
                mov     rax, 0FFFF800000000000h
                cmp     rcx, rax
                jnb     short loc_140270F4E

loc_140270F33:                          ; CODE XREF: sub_140270F20+36↓j
                mov     rcx, gs:188h
                mov     rcx, [rcx+0B8h]
                call    sub_140245840

loc_140270F48:                          ; CODE XREF: sub_140270F20+3B↓j
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140270F4E:                          ; CODE XREF: sub_140270F20+11↑j
                call    sub_140245330
                cmp     eax, 1
                jz      short loc_140270F33
                or      eax, 0FFFFFFFFh
                jmp     short loc_140270F48
sub_140270F20   endp

; ---------------------------------------------------------------------------
byte_140270F5D  db 13h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE49C↑o

; =============== S U B R O U T I N E =======================================


sub_140270F70   proc near               ; CODE XREF: sub_140246A60+1C7↑p
                                        ; sub_1402711C0+1C2↓p ...
                test    cl, 3
                jnz     short loc_140270F7E
                movzx   eax, byte ptr [rcx+408h]
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140270F7E:                          ; CODE XREF: sub_140270F70+3↑j
                xor     eax, eax
                retn
sub_140270F70   endp

; ---------------------------------------------------------------------------
                align 2
algn_140270F82:                         ; DATA XREF: .pdata:00000001400CE4A8↑o
                align 10h
; Exported entry 172. ExAcquireSharedStarveExclusive

; =============== S U B R O U T I N E =======================================


                public ExAcquireSharedStarveExclusive
ExAcquireSharedStarveExclusive proc near
                                        ; CODE XREF: sub_1402720A0+803↓p
                                        ; sub_1402720A0+936↓p ...

var_18          = qword ptr -18h

; FUNCTION CHUNK AT 0000000140441D5E SIZE 00000086 BYTES

                push    rbx
                sub     rsp, 30h
                movzx   r9d, word ptr [rcx+1Ah]
                mov     al, dl
                neg     al
                mov     r10, rcx
                mov     al, r9b
                mov     bl, dl
                sbb     r11b, r11b
                and     al, 41h
                add     r11b, 2
                xor     ecx, ecx
                cmp     al, 1
                jz      short loc_140271022
                and     r9w, 1
                jnz     short loc_140270FD8

loc_140270FBD:                          ; CODE XREF: ExAcquireSharedStarveExclusive+78↓j
                                        ; ExAcquireSharedStarveExclusive+82↓j ...
                mov     dl, bl
                mov     rcx, r10
                test    r9w, r9w
                jnz     loc_140441DD9
                call    sub_1402711C0

loc_140270FD1:                          ; CODE XREF: ExAcquireSharedStarveExclusive+1D0E4F↓j
                add     rsp, 30h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 8

loc_140270FD8:                          ; CODE XREF: ExAcquireSharedStarveExclusive+2B↑j
                mov     rdx, cr8
                mov     r8, gs:188h
                cmp     dl, r11b
                ja      loc_140441D5E
                cmp     dl, 2
                jnb     loc_140441D78

loc_140270FF7:                          ; CODE XREF: ExAcquireSharedStarveExclusive+1D0DF5↓j
                test    byte ptr [r8+0C0h], 2
                jnz     loc_140441DA5
                cmp     dl, 1
                jnb     short loc_140270FBD
                test    dword ptr [r8+74h], 400h
                jnz     short loc_140270FBD
                cmp     [r8+1E4h], ecx
                jnz     short loc_140270FBD
                jmp     loc_140441DBF
; ---------------------------------------------------------------------------

loc_140271022:                          ; CODE XREF: ExAcquireSharedStarveExclusive+24↑j
                xor     r9d, r9d
                mov     [rsp+38h+var_18], rcx
                mov     r8, r10
                mov     ecx, 1C6h
                lea     edx, [r9+0Fh]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
ExAcquireSharedStarveExclusive endp

byte_14027103C  db 14h dup(0CCh)        ; DATA XREF: .rdata:000000014005D7D0↑o
                                        ; .pdata:00000001400CE4B4↑o

; =============== S U B R O U T I N E =======================================


sub_140271050   proc near               ; CODE XREF: sub_1402720A0+265↓p
                                        ; sub_1402F862C+286↓p ...

var_68          = xmmword ptr -68h
var_58          = xmmword ptr -58h
var_48          = xmmword ptr -48h
var_38          = qword ptr -38h
var_30          = dword ptr -30h
var_10          = qword ptr -10h
var_8           = byte ptr -8
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140441DE4 SIZE 0000001F BYTES

; __unwind { // __GSHandlerCheck
                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                mov     [rsp+arg_18], rsi
                push    rdi
                sub     rsp, 60h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+68h+var_10], rax
                mov     rdi, rcx
                xorps   xmm0, xmm0
                xor     eax, eax
                xor     esi, esi
                movzx   ebp, r8b
                mov     [rsp+68h+var_38], rax
                movups  [rsp+68h+var_68], xmm0
                mov     rbx, [rdi+58h]
                xor     r9d, r9d
                mov     r10, [rdi+20h]
                mov     ecx, 19h
                movups  [rsp+68h+var_58], xmm0
                movups  [rsp+68h+var_48], xmm0

loc_1402710A4:                          ; CODE XREF: sub_140271050+68↓j
                mov     r8d, ecx
                mov     eax, 1
                add     ecx, 7
                inc     r9d
                shl     rax, cl
                cmp     r10, rax
                jg      short loc_1402710A4
; } // starts at 140271050

loc_1402710BA:                          ; DATA XREF: .rdata:000000014005D804↑o
                                        ; .rdata:000000014005D814↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+68h+arg_0], r14
                cmp     rdx, rax
                jge     loc_140271191
                mov     r14, 7FFFFFFFFFFFFFFFh

loc_1402710D2:                          ; CODE XREF: sub_140271050+BD↓j
                mov     r11, rdx
                mov     ecx, r8d
                sar     r11, cl
                dec     r9d
                mov     eax, r11d
                mov     r10, [rbx+rax*8]
                test    r10, r10
                jz      short loc_140271150

loc_1402710EA:                          ; CODE XREF: sub_140271050+128↓j
                                        ; sub_140271050+164↓j
                mov     qword ptr [rsp+rsi*8+68h+var_68], rbx
                mov     eax, 1
                shl     rax, cl
                add     r8d, 0FFFFFFF9h
                dec     rax
                mov     [rsp+rsi*4+68h+var_30], r11d
                and     rdx, rax
                inc     esi
                mov     rbx, r10
                test    r9d, r9d
                jnz     short loc_1402710D2
                mov     ecx, r8d
                mov     eax, 0FFFFFFFEh
                sar     rdx, cl
                and     rax, rdx
                sub     rax, 0FFFFFFFFFFFFFF80h
                lea     rax, [r10+rax*8]

loc_140271125:                          ; CODE XREF: sub_140271050+145↓j
                                        ; sub_140271050+1D0DAE↓j
                mov     r14, [rsp+68h+arg_0]
                mov     rcx, [rsp+68h+var_10]
                xor     rcx, rsp
                call    __security_check_cookie
                lea     r11, [rsp+68h+var_8]
                mov     rbx, [r11+18h]
                mov     rbp, [r11+20h]
                mov     rsi, [r11+28h]
                mov     rsp, r11
                pop     rdi
                retn
; } // starts at 1402710BA
; ---------------------------------------------------------------------------
; __unwind { // __GSHandlerCheck
algn_14027114D:                         ; DATA XREF: .pdata:00000001400CE4CC↑o
                                        ; .pdata:00000001400CE4D8↑o
                align 10h
; } // starts at 14027114D

loc_140271150:                          ; CODE XREF: sub_140271050+98↑j
                                        ; sub_140271050+1D0DA7↓j
                                        ; DATA XREF: ...
; __unwind { // __GSHandlerCheck
                test    bpl, bpl
                jnz     short loc_140271197
                test    r11d, r11d
                jz      short loc_140271189

loc_14027115A:                          ; CODE XREF: sub_140271050+117↓j
                test    r11d, r11d
                jz      short loc_140271169
                dec     r11d
                cmp     qword ptr [rbx+r11*8], 0
                jz      short loc_14027115A

loc_140271169:                          ; CODE XREF: sub_140271050+10D↑j
                mov     eax, r11d
                mov     r10, [rbx+rax*8]
                test    r10, r10
                jz      short loc_140271189
                mov     rdx, r14
                jmp     loc_1402710EA
; ---------------------------------------------------------------------------

loc_14027117D:                          ; CODE XREF: sub_140271050+154↓j
                                        ; sub_140271050+160↓j
                mov     eax, r11d
                mov     r10, [rbx+rax*8]
                test    r10, r10
                jnz     short loc_1402711B2

loc_140271189:                          ; CODE XREF: sub_140271050+108↑j
                                        ; sub_140271050+123↑j ...
                test    esi, esi
                jnz     loc_140441DE4

loc_140271191:                          ; CODE XREF: sub_140271050+72↑j
                lea     rax, [rdi+10h]
                jmp     short loc_140271125
; ---------------------------------------------------------------------------

loc_140271197:                          ; CODE XREF: sub_140271050+103↑j
                cmp     r11d, 7Fh
                jz      short loc_140271189
                nop     dword ptr [rax]

loc_1402711A0:                          ; CODE XREF: sub_140271050+15E↓j
                cmp     r11d, 7Fh
                jz      short loc_14027117D
                inc     r11d
                cmp     qword ptr [rbx+r11*8], 0
                jz      short loc_1402711A0
                jmp     short loc_14027117D
; ---------------------------------------------------------------------------

loc_1402711B2:                          ; CODE XREF: sub_140271050+137↑j
                xor     edx, edx
                jmp     loc_1402710EA
; } // starts at 140271150
sub_140271050   endp

; ---------------------------------------------------------------------------
algn_1402711B9:                         ; DATA XREF: .pdata:00000001400CE4E4↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_1402711C0   proc near               ; CODE XREF: ExAcquireSharedStarveExclusive+3C↑p
                                        ; sub_1402720A0+3D9↓p
                                        ; DATA XREF: ...

var_60          = dword ptr -60h
var_58          = dword ptr -58h
var_50          = xmmword ptr -50h
var_40          = qword ptr -40h
var_38          = xmmword ptr -38h
var_28          = xmmword ptr -28h
var_18          = xmmword ptr -18h
var_s0          = byte ptr  0
arg_0           = qword ptr  30h
arg_8           = qword ptr  38h
arg_10          = qword ptr  40h

; FUNCTION CHUNK AT 0000000140441E04 SIZE 00000382 BYTES

                mov     [rsp-28h+arg_0], rbx
                mov     [rsp-28h+arg_8], rsi
                mov     [rsp-28h+arg_10], rdi
                push    rbp
                push    r12
                push    r13
                push    r14
                push    r15
                mov     rbp, rsp
                sub     rsp, 80h
                xorps   xmm1, xmm1
                xor     eax, eax
                xorps   xmm0, xmm0
                mov     [rbp+var_40], rax
                movups  [rbp+var_50], xmm0
                movzx   r12d, dl
                mov     rbx, rcx
                movups  [rbp+var_38], xmm1
                movups  [rbp+var_28], xmm1
                movups  [rbp+var_18], xmm1
                mov     r15, gs:188h
                test    dword ptr cs:xmmword_140CFC480+4, 20000h
                jnz     loc_140441E04
                xor     r14b, r14b

loc_140271221:                          ; CODE XREF: sub_1402711C0+1D0C47↓j
                inc     dword ptr gs:86A4h
                lea     rdi, [rcx+60h]
                xor     esi, esi
                mov     qword ptr [rbp+var_50+8], rdi
                mov     qword ptr [rbp+var_50], rsi
                mov     r10, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                lea     r13, [rsi-1]
                test    eax, eax
                jnz     loc_140441E0C

loc_140271256:                          ; CODE XREF: sub_1402711C0+1D0C4E↓j
                                        ; sub_1402711C0+1D0C58↓j ...
                mov     byte ptr [rbp+var_40], r10b
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140441E4D

loc_140271273:                          ; CODE XREF: sub_1402711C0+1D0C91↓j
                                        ; sub_1402711C0+1D0CA0↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140441E71
                lea     rdx, [rbp+var_50]
                xchg    rdx, [rdi]
                test    rdx, rdx
                jnz     loc_140271511

loc_140271290:                          ; CODE XREF: sub_1402711C0+35A↓j
                                        ; sub_1402711C0+1D0CBE↓j
                mov     edi, 80h

loc_140271295:                          ; CODE XREF: sub_1402711C0+1EF↓j
                mov     r8d, 1
                nop     dword ptr [rax+rax+00h]
                mov     eax, [rbx+40h]
                test    eax, eax
                jnz     loc_140271369
                inc     eax
                mov     [rbx+18h], r8w
                mov     [rbx+40h], eax
                mov     eax, [rbx+38h]
                and     eax, 7
                mov     [rbx+30h], r15
                or      eax, 8
                mov     [rbx+38h], eax
                test    byte ptr cs:xmmword_140CFC480+6, r8b
                jnz     loc_1404420E1
                prefetchw byte ptr [rbp+var_50]
                mov     rax, qword ptr [rbp+var_50]
                test    rax, rax
                jnz     loc_14027155C
                mov     rcx, qword ptr [rbp+var_50+8]
                lea     rax, [rbp+var_50]
                lock cmpxchg [rcx], rsi
                lea     rcx, [rbp+var_50]
                cmp     rax, rcx
                jnz     loc_14027154D

loc_1402712FD:                          ; CODE XREF: sub_1402711C0+3A6↓j
                                        ; sub_1402711C0+1D0F34↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_1404420F9

loc_140271316:                          ; CODE XREF: sub_1402711C0+1D0F3D↓j
                                        ; sub_1402711C0+1D0F4C↓j ...
                mov     eax, cs:dword_140CFC660
                movzx   edi, byte ptr [rbp+var_40]
                test    eax, eax
                jnz     loc_140442122

loc_140271328:                          ; CODE XREF: sub_1402711C0+1D0F64↓j
                                        ; sub_1402711C0+1D0F70↓j ...
                mov     cr8, rdi
                inc     dword ptr gs:86ACh
                inc     dword ptr gs:8664h
                test    r14b, r14b
                jnz     loc_140441FEF

loc_140271345:                          ; CODE XREF: sub_1402711C0+238↓j
                                        ; sub_1402711C0+2B0↓j ...
                mov     al, 1

loc_140271347:                          ; CODE XREF: sub_1402711C0+388↓j
                lea     r11, [rsp+80h+var_s0]
                mov     rbx, [r11+30h]
                mov     rsi, [r11+38h]
                mov     rdi, [r11+40h]
                mov     rsp, r11
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140271369:                          ; CODE XREF: sub_1402711C0+E5↑j
                movzx   eax, word ptr [rbx+1Ah]
                and     ax, di
                jnz     loc_14027147B

loc_140271376:                          ; CODE XREF: sub_1402711C0+2BF↓j
                test    ax, ax
                jnz     loc_14027148A
                mov     rcx, r15
                call    sub_140270F70
                mov     ecx, esi
                mov     [rsp+80h+var_58], eax
                cmp     [rbx+4Ch], ecx
                mov     r9d, r8d
                lea     r8, [rbp+var_50]
                mov     rdx, r15
                setnz   cl
                mov     [rsp+80h+var_60], ecx
                mov     rcx, rbx
                call    sub_1402484D0

loc_1402713A9:                          ; CODE XREF: sub_1402711C0+2D6↓j
                mov     rdx, rax
                test    rax, rax
                jz      loc_140271295
                cmp     [rax], r15
                jnz     short loc_140271403
                mov     edi, [rax+8]
                lea     rcx, [rbp+var_50]
                add     edi, 8
                mov     [rax+8], edi
                shr     edi, 3
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   esi, byte ptr [rbp+var_40]
                test    eax, eax
                jnz     loc_140441F19

loc_1402713E1:                          ; CODE XREF: sub_1402711C0+1D0D5B↓j
                                        ; sub_1402711C0+1D0D67↓j ...
                mov     cr8, rsi
                inc     dword ptr gs:86B0h
                inc     dword ptr gs:8664h
                test    r14b, r14b
                jz      loc_140271345
                jmp     loc_140441F7C
; ---------------------------------------------------------------------------

loc_140271403:                          ; CODE XREF: sub_1402711C0+1F8↑j
                mov     rcx, rbx
                call    sub_1403554B0
                test    al, al
                jz      loc_14027149B
                mov     eax, [rdx+8]
                lea     rcx, [rbp+var_50]
                and     eax, 7
                mov     [rdx], r15
                or      eax, 8
                mov     [rdx+8], eax
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   edi, byte ptr [rbp+var_40]
                test    eax, eax
                jnz     loc_140441F86

loc_14027143D:                          ; CODE XREF: sub_1402711C0+1D0DC8↓j
                                        ; sub_1402711C0+1D0DD4↓j ...
                mov     cr8, rdi

loc_140271441:                          ; CODE XREF: sub_1402711C0+34C↓j
                test    r15b, 3
                jnz     short loc_14027144F
                movzx   esi, byte ptr [r15+408h]

loc_14027144F:                          ; CODE XREF: sub_1402711C0+285↑j
                mov     r8d, esi
                mov     rdx, r15
                mov     rcx, rbx
                call    sub_14030F57C
                inc     dword ptr gs:86ACh
                inc     dword ptr gs:8664h
                test    r14b, r14b
                jz      loc_140271345
                jmp     loc_140441FE9
; ---------------------------------------------------------------------------

loc_14027147B:                          ; CODE XREF: sub_1402711C0+1B0↑j
                cmp     [rbx+30h], r15
                jnz     loc_140271376
                jmp     loc_140441E83
; ---------------------------------------------------------------------------

loc_14027148A:                          ; CODE XREF: sub_1402711C0+1B9↑j
                lea     rdx, [rbp+var_50]
                mov     rcx, rbx
                call    sub_140349D5C
                jmp     loc_1402713A9
; ---------------------------------------------------------------------------

loc_14027149B:                          ; CODE XREF: sub_1402711C0+24D↑j
                test    r12b, r12b
                jz      short loc_14027151F
                mov     eax, [rdx+8]
                lea     r8, [rbp+var_38]
                and     eax, 7
                mov     [rdx], r15
                or      eax, 8
                mov     [rdx+8], eax
                mov     rdx, r15
                call    sub_140361ABC
                lea     rcx, [rbp+var_50]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   edi, byte ptr [rbp+var_40]
                test    eax, eax
                jnz     loc_140442068

loc_1402714D6:                          ; CODE XREF: sub_1402711C0+1D0EAA↓j
                                        ; sub_1402711C0+1D0EB6↓j ...
                mov     cr8, rdi
                inc     dword ptr gs:86B4h
                test    r14b, r14b
                jnz     loc_1404420CB

loc_1402714EB:                          ; CODE XREF: sub_1402711C0+1D0F1C↓j
                mov     rcx, rbx
                call    sub_140349198
                lea     r9, sub_140363710
                mov     r8d, 10244h
                lea     rdx, [rbp+var_38]
                mov     rcx, rbx
                call    sub_14023C8E0
                jmp     loc_140271441
; ---------------------------------------------------------------------------

loc_140271511:                          ; CODE XREF: sub_1402711C0+CA↑j
                lea     rcx, [rbp+var_50]
                call    sub_14025FC20
                jmp     loc_140271290
; ---------------------------------------------------------------------------

loc_14027151F:                          ; CODE XREF: sub_1402711C0+2DE↑j
                lea     rcx, [rbp+var_50]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rbp+var_40]
                test    eax, eax
                jnz     loc_140442006

loc_14027153A:                          ; CODE XREF: sub_1402711C0+1D0E48↓j
                                        ; sub_1402711C0+1D0E54↓j ...
                mov     cr8, rbx
                inc     dword ptr gs:86B8h
                xor     al, al
                jmp     loc_140271347
; ---------------------------------------------------------------------------

loc_14027154D:                          ; CODE XREF: sub_1402711C0+137↑j
                lea     rcx, [rbp+var_50]
                call    sub_140313680
                mov     r8d, 1

loc_14027155C:                          ; CODE XREF: sub_1402711C0+11D↑j
                mov     qword ptr [rbp+var_50], rsi
                lock xor qword ptr [rax+8], 1
                jmp     loc_1402712FD
sub_1402711C0   endp

; ---------------------------------------------------------------------------
algn_14027156B:                         ; DATA XREF: .rdata:000000014005D86C↑o
                                        ; .pdata:00000001400CE4F0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140271580   proc near               ; CODE XREF: sub_14022DE20+615↑p
                                        ; sub_140274000+1562↓p ...
                mov     rax, 0FFFF800000000000h
                cmp     rcx, rax
                jb      short loc_1402715CE
                mov     rax, rcx
                lea     rdx, unk_140C4F848
                shr     rax, 27h
                and     eax, 1FFh
                sub     eax, 100h
                cmp     byte ptr [rax+rdx], 1
                jz      short loc_1402715E6
                mov     rax, 0FFFFF68000000000h
                cmp     rcx, rax
                jnb     short loc_1402715D7

loc_1402715BC:                          ; CODE XREF: sub_140271580+64↓j
                cmp     rcx, cs:qword_140C4F9B8
                jnb     short loc_1402715EA

loc_1402715C5:                          ; CODE XREF: sub_140271580+71↓j
                movzx   eax, byte ptr cs:word_140C4DE88
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402715CE:                          ; CODE XREF: sub_140271580+D↑j
                                        ; sub_140271580+73↓j
                movzx   eax, byte ptr cs:word_140C4DE88+1
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402715D7:                          ; CODE XREF: sub_140271580+3A↑j
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     rcx, rax
                ja      short loc_1402715BC

loc_1402715E6:                          ; CODE XREF: sub_140271580+2B↑j
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402715EA:                          ; CODE XREF: sub_140271580+43↑j
                cmp     rcx, cs:qword_140C4E1E8
                ja      short loc_1402715C5
                jmp     short loc_1402715CE
sub_140271580   endp

; ---------------------------------------------------------------------------
algn_1402715F5:                         ; DATA XREF: .pdata:00000001400CE4FC↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=100h

sub_140271600   proc near               ; CODE XREF: sub_140274000+6A9↓p
                                        ; sub_140274000+1889↓p ...

var_1E0         = qword ptr -1E0h
var_1D8         = dword ptr -1D8h
var_1D0         = qword ptr -1D0h
var_1C0         = qword ptr -1C0h
var_1B8         = xmmword ptr -1B8h
var_1A8         = qword ptr -1A8h
var_1A0         = qword ptr -1A0h
var_198         = dword ptr -198h
var_190         = qword ptr -190h
var_188         = dword ptr -188h
var_180         = qword ptr -180h
var_178         = qword ptr -178h
var_170         = qword ptr -170h
var_168         = qword ptr -168h
var_160         = qword ptr -160h
var_150         = xmmword ptr -150h
var_140         = xmmword ptr -140h
var_130         = xmmword ptr -130h
var_120         = xmmword ptr -120h
var_110         = xmmword ptr -110h
var_100         = xmmword ptr -100h
var_F0          = xmmword ptr -0F0h
var_E0          = xmmword ptr -0E0h
var_D0          = qword ptr -0D0h
var_50          = qword ptr -50h

; __unwind { // __GSHandlerCheck
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-0C8h]
                sub     rsp, 1C8h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+100h+var_50], rax
                xorps   xmm1, xmm1
                mov     [rbp+100h+var_168], r9
                xor     esi, esi
                mov     [rsp+200h+var_198], r8d
                xorps   xmm0, xmm0
                mov     [rsp+200h+var_190], rsi
                xor     eax, eax
                mov     [rbp+100h+var_D0], rsi
                mov     r13, rdx
                mov     [rsp+200h+var_1A8], rax
                movups  [rsp+200h+var_1B8], xmm0
                mov     rdi, r9
                mov     [rsp+200h+var_1A0], rcx
                movups  [rbp+100h+var_150], xmm1
                mov     rdx, 0FFFFF68000000000h
                movups  [rbp+100h+var_140], xmm1
                movups  [rbp+100h+var_130], xmm1
                movups  [rbp+100h+var_120], xmm1
                movups  [rbp+100h+var_110], xmm1
                movups  [rbp+100h+var_100], xmm1
                movups  [rbp+100h+var_F0], xmm1
                movups  [rbp+100h+var_E0], xmm1
                mov     rax, rdx
                shl     rax, 19h
                mov     r15, rcx
                shl     r15, 19h
                mov     r12, rcx
                sub     r15, rax
                mov     [rbp+100h+var_160], rax
                mov     rax, 7FFFFFFFF8h
                shr     r12, 9
                and     r12, rax
                sar     r15, 10h
                mov     rax, rdx
                add     r12, rax
                movzx   eax, cs:byte_140C528F8
                and     al, 7
                cmp     al, 6
                jb      short loc_14027172C
                mov     rsi, cr8
                mov     [rbp+100h+var_170], rsi
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      loc_14027182C
                test    al, 1
                jz      loc_14027182C
                cmp     sil, 0Fh
                ja      loc_14027182C
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d
                jmp     loc_14027182C
; ---------------------------------------------------------------------------

loc_14027172C:                          ; CODE XREF: sub_140271600+C6↑j
                cmp     al, 2
                lea     rcx, unk_140C52900
                lea     rbx, unk_140C4F600
                cmovnz  rbx, rcx
                mov     r14, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027178F
                test    al, 1
                jz      short loc_14027178F
                cmp     r14b, 0Fh
                ja      short loc_14027178F
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r14b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_14027178F:                          ; CODE XREF: sub_140271600+155↑j
                                        ; sub_140271600+159↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_1402717A6
                movzx   edx, r14b
                mov     rcx, rbx
                call    sub_1405B5F24
                jmp     short loc_140271819
; ---------------------------------------------------------------------------

loc_1402717A6:                          ; CODE XREF: sub_140271600+196↑j
                mov     rsi, gs:20h
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jz      short loc_1402717D4
                cmp     byte ptr [rsi+20h], 1
                ja      short loc_1402717D4
                mov     eax, [rcx+18h]
                add     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_1402717D4
                mov     rcx, rsi
                call    sub_1403F2EC4

loc_1402717D4:                          ; CODE XREF: sub_140271600+1B9↑j
                                        ; sub_140271600+1BF↑j ...
                prefetchw byte ptr [rbx]
                mov     eax, [rbx]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rbx], ecx
                jz      short loc_140271817
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jz      short loc_14027180B
                cmp     byte ptr [rsi+20h], 1
                ja      short loc_14027180B
                mov     eax, [rcx+18h]
                sub     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_14027180B
                mov     rcx, rsi
                call    sub_1403F2EC4

loc_14027180B:                          ; CODE XREF: sub_140271600+1F0↑j
                                        ; sub_140271600+1F6↑j ...
                movzx   edx, r14b
                mov     rcx, rbx
                call    sub_140329420

loc_140271817:                          ; CODE XREF: sub_140271600+1E4↑j
                xor     esi, esi

loc_140271819:                          ; CODE XREF: sub_140271600+1A4↑j
                cmp     dword ptr [rbx+4], 0
                jz      short loc_140271824
                mov     eax, esi
                xchg    eax, [rbx+4]

loc_140271824:                          ; CODE XREF: sub_140271600+21D↑j
                movzx   esi, r14b
                mov     [rbp+100h+var_170], rsi

loc_14027182C:                          ; CODE XREF: sub_140271600+E1↑j
                                        ; sub_140271600+E9↑j ...
                xor     r8d, r8d
                lea     rcx, unk_140C52840
                mov     rdx, r12
                call    sub_140225CC0
                mov     rdx, r15
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rcx, 0FFFFF6FB40000000h
                add     rdx, rcx
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rbx, [rdx]
                mov     rax, rax
                mov     rcx, 0FFFFF6FB7DBED7F8h
                mov     r14d, 1FFh
                cmp     rdx, rax
                jb      short loc_1402718FC
                mov     rax, rcx
                cmp     rdx, rax
                ja      short loc_1402718FC
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_1402718FC
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_1402718FC
                test    bl, 1
                jz      short loc_1402718FC
                test    bl, 20h
                jz      short loc_1402718B9
                test    bl, 42h
                jnz     short loc_1402718FC

loc_1402718B9:                          ; CODE XREF: sub_140271600+2B2↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_1402718FC
                shr     rdx, 3
                and     rdx, r14
                mov     rax, [rax+rdx*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_1402718FC
                or      rbx, 42h

loc_1402718FC:                          ; CODE XREF: sub_140271600+27B↑j
                                        ; sub_140271600+283↑j ...
                lea     rcx, [rbp+100h+var_180]
                mov     [rbp+100h+var_180], rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_140271988
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140271988
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140271988
                test    bl, 1
                jz      short loc_140271988
                test    bl, 20h
                jz      short loc_140271941
                test    bl, 42h
                jnz     short loc_140271988

loc_140271941:                          ; CODE XREF: sub_140271600+33A↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140271988
                lea     rax, [rbp+100h+var_180]
                shr     rax, 3
                and     rax, r14
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140271988
                or      rbx, 42h

loc_140271988:                          ; CODE XREF: sub_140271600+30B↑j
                                        ; sub_140271600+317↑j ...
                mov     rax, 0FFFFFFFFFh
                shr     rbx, 0Ch
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rcx, [rbx+rbx*2]
                add     rcx, rcx
                mov     rax, rax
                mov     rdx, [rax+rcx*8+10h]
                test    rdx, rdx
                jz      short loc_1402719C7
                shr     r15, 12h
                and     r15d, 7
                lea     rax, [r15+r15*4]
                lea     rdx, [rdx+rax*8]

loc_1402719C7:                          ; CODE XREF: sub_140271600+3B5↑j
                mov     rdx, [rdx+18h]
                mov     r15d, [rsp+200h+var_198]
                movzx   eax, dl
                mov     byte ptr [rsp+200h+var_1B8+0Ch], sil
                mov     rcx, rdx
                movzx   esi, byte ptr [rsp+200h+var_1B8+0Dh]
                and     rcx, 0FFFFFFFFFFFFFFFEh
                and     al, 1
                mov     [rsp+200h+var_1A8], r12
                cmovz   rcx, rdx
                or      sil, 4
                mov     byte ptr [rsp+200h+var_1B8+0Dh], sil
                mov     rax, [rcx]
                movzx   ecx, word ptr [rax+3Ch]
                mov     rax, cs:qword_140C4E4C8
                and     ecx, 3FFh
                mov     r14, [rax+rcx*8]
                add     r14, 1C40h
                mov     [rbp+100h+var_178], r14
                mov     rbx, r14
                mov     qword ptr [rsp+200h+var_1B8], rbx
                test    r15d, r15d
                jz      loc_140271D63
                mov     r8, [rsp+200h+var_1A0]
                xor     edx, edx
                sub     r8, r13
                mov     ecx, r15d
                mov     r12d, edx
                mov     [rsp+200h+var_1A0], r8
                mov     [rsp+200h+var_1C0], rcx
                mov     rdi, rbx
                lea     r9d, [rdx+1]
                jmp     short loc_140271A52
; ---------------------------------------------------------------------------
                align 10h

loc_140271A50:                          ; CODE XREF: sub_140271600+746↓j
                xor     edx, edx

loc_140271A52:                          ; CODE XREF: sub_140271600+44D↑j
                mov     qword ptr [rbp+r12+100h+var_150], rdx
                mov     rdx, [r13+0]
                mov     rbx, rdx
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r13, rax
                jb      loc_140271B12
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r13, rax
                ja      loc_140271B12
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140271B08
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140271B03
                test    bl, 1
                jz      short loc_140271B03
                test    bl, 20h
                jz      short loc_140271ABE
                test    bl, 42h
                jnz     short loc_140271B03

loc_140271ABE:                          ; CODE XREF: sub_140271600+4B7↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140271B03
                or      rbx, 20h
                mov     ecx, 1FFh
                mov     rax, r13
                shr     rax, 3
                and     rax, rcx
                mov     rax, [r8+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rbx, rdx
                test    al, 42h
                jz      short loc_140271B03
                or      rbx, 42h

loc_140271B03:                          ; CODE XREF: sub_140271600+4AD↑j
                                        ; sub_140271600+4B2↑j ...
                movzx   esi, byte ptr [rsp+200h+var_1B8+0Dh]

loc_140271B08:                          ; CODE XREF: sub_140271600+494↑j
                mov     rcx, [rsp+200h+var_1C0]
                mov     r8, [rsp+200h+var_1A0]

loc_140271B12:                          ; CODE XREF: sub_140271600+46E↑j
                                        ; sub_140271600+484↑j
                mov     [rsp+200h+var_190], rbx
                test    rbx, rbx
                jz      loc_140271D30
                test    bl, 1
                jnz     short loc_140271B37
                or      rdx, 1
                mov     qword ptr [rbp+r12+100h+var_150], r9
                mov     [r13+0], rdx
                jmp     loc_140271D30
; ---------------------------------------------------------------------------

loc_140271B37:                          ; CODE XREF: sub_140271600+523↑j
                test    byte ptr [r8+r13], 1
                lea     r15, [r8+r13]
                jnz     loc_140271D26
                lea     rcx, [rsp+200h+var_190]
                mov     r14, rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_140271BD2
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140271BD2
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140271BCD
                test    bl, 20h
                jz      short loc_140271B86
                test    bl, 42h
                jnz     short loc_140271BCD

loc_140271B86:                          ; CODE XREF: sub_140271600+57F↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140271BCD
                or      r14, 20h
                lea     rax, [rsp+200h+var_190]
                shr     rax, 3
                mov     ecx, 1FFh
                and     rax, rcx
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   r14, rbx
                test    al, 42h
                jz      short loc_140271BCD
                or      r14, 42h

loc_140271BCD:                          ; CODE XREF: sub_140271600+57A↑j
                                        ; sub_140271600+584↑j ...
                movzx   esi, byte ptr [rsp+200h+var_1B8+0Dh]

loc_140271BD2:                          ; CODE XREF: sub_140271600+555↑j
                                        ; sub_140271600+561↑j
                shr     r14, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     r14, rax
                mov     rax, 0FFFFFA8000000000h
                lea     r14, [r14+r14*2]
                shl     r14, 4
                mov     rax, rax
                add     r14, rax
                mov     rax, [r14+10h]
                mov     [rbp+r12+100h+var_D0], rax
                test    sil, 4
                jz      loc_140271CCA
                test    sil, 1
                jnz     loc_140271CCA
                test    sil, 2
                jnz     loc_140271CCA
                movzx   edx, word ptr [rsp+200h+var_1B8+0Ah]
                mov     eax, r15d
                test    dx, dx
                jz      short loc_140271C84
                movzx   ecx, word ptr [rsp+200h+var_1B8+8]
                add     ecx, edx
                shr     eax, 3
                mov     edx, 1FFh
                and     eax, edx
                cmp     ecx, eax
                jnz     short loc_140271C5E
                mov     rcx, r14
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_140271C58
                test    sil, 10h
                jz      short loc_140271C6D
                jmp     short loc_140271C5E
; ---------------------------------------------------------------------------

loc_140271C58:                          ; CODE XREF: sub_140271600+64E↑j
                test    sil, 10h
                jnz     short loc_140271C6D

loc_140271C5E:                          ; CODE XREF: sub_140271600+642↑j
                                        ; sub_140271600+656↑j
                lea     rcx, [rsp+200h+var_1B8]
                call    sub_14026F5D0
                movzx   esi, byte ptr [rsp+200h+var_1B8+0Dh]

loc_140271C6D:                          ; CODE XREF: sub_140271600+654↑j
                                        ; sub_140271600+65C↑j
                cmp     word ptr [rsp+200h+var_1B8+0Ah], 0
                mov     eax, r15d
                jz      short loc_140271C84
                inc     word ptr [rsp+200h+var_1B8+0Ah]
                mov     eax, 4
                jmp     short loc_140271CCC
; ---------------------------------------------------------------------------

loc_140271C84:                          ; CODE XREF: sub_140271600+62D↑j
                                        ; sub_140271600+676↑j
                mov     ecx, 1
                shr     eax, 3
                mov     word ptr [rsp+200h+var_1B8+0Ah], cx
                mov     ecx, 1FFh
                and     ax, cx
                mov     rcx, r14
                mov     word ptr [rsp+200h+var_1B8+8], ax
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_140271CBA
                and     sil, 0EFh
                mov     eax, 4
                mov     byte ptr [rsp+200h+var_1B8+0Dh], sil
                jmp     short loc_140271CCC
; ---------------------------------------------------------------------------

loc_140271CBA:                          ; CODE XREF: sub_140271600+6A8↑j
                or      sil, 10h
                mov     eax, 4
                mov     byte ptr [rsp+200h+var_1B8+0Dh], sil
                jmp     short loc_140271CCC
; ---------------------------------------------------------------------------

loc_140271CCA:                          ; CODE XREF: sub_140271600+608↑j
                                        ; sub_140271600+612↑j ...
                xor     eax, eax

loc_140271CCC:                          ; CODE XREF: sub_140271600+682↑j
                                        ; sub_140271600+6B8↑j ...
                mov     [rsp+200h+var_1D0], 0
                xor     r9d, r9d
                mov     [rsp+200h+var_1D8], eax
                mov     r8, r14
                mov     rdx, r15
                mov     [rsp+200h+var_1E0], rbx
                mov     rcx, rdi
                call    sub_140228E90
                mov     r9d, 1
                test    eax, eax
                jz      short loc_140271D26
                mov     eax, dword ptr [rbp+r12+100h+var_D0]
                bt      rax, 0Ah
                jnb     short loc_140271D2B
                cmp     cs:dword_140C4C40C, 0
                jz      short loc_140271D2B
                mov     rax, [r14+8]
                mov     rcx, 8000000000000000h
                or      rax, rcx
                mov     qword ptr [rbp+r12+100h+var_150], rax
                jmp     short loc_140271D2B
; ---------------------------------------------------------------------------

loc_140271D26:                          ; CODE XREF: sub_140271600+540↑j
                                        ; sub_140271600+6F7↑j
                mov     qword ptr [rbp+r12+100h+var_150], r9

loc_140271D2B:                          ; CODE XREF: sub_140271600+703↑j
                                        ; sub_140271600+70C↑j ...
                mov     rcx, [rsp+200h+var_1C0]

loc_140271D30:                          ; CODE XREF: sub_140271600+51A↑j
                                        ; sub_140271600+532↑j
                mov     r8, [rsp+200h+var_1A0]
                add     r12, 8
                add     r13, 8
                sub     rcx, 1
                mov     [rsp+200h+var_1C0], rcx
                jnz     loc_140271A50
                mov     r12, [rsp+200h+var_1A8]
                mov     rbx, qword ptr [rsp+200h+var_1B8]
                mov     rdi, [rbp+100h+var_168]
                mov     r14, [rbp+100h+var_178]
                mov     r15d, [rsp+200h+var_198]

loc_140271D63:                          ; CODE XREF: sub_140271600+426↑j
                test    r12, r12
                jz      loc_140271E1B
                cmp     word ptr [rsp+200h+var_1B8+0Ah], 0
                jz      loc_140271DFE
                movzx   eax, word ptr [rsp+200h+var_1B8+8]
                mov     rdx, r12
                shl     rdx, 19h
                sub     rdx, [rbp+100h+var_160]
                sar     rdx, 10h
                shl     rdx, 19h
                sub     rdx, [rbp+100h+var_160]
                shl     rax, 0Ch
                movzx   ecx, sil
                shr     ecx, 4
                sar     rdx, 10h
                and     ecx, 1
                add     rdx, rax
                add     ecx, ecx
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rdx, rax
                jb      short loc_140271DE2
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     rdx, rax
                ja      short loc_140271DE2
                movzx   eax, byte ptr [rbx+0B8h]
                mov     r9d, ecx
                or      r9d, 4
                and     al, 7
                cmovnz  r9d, ecx
                jmp     short loc_140271DE9
; ---------------------------------------------------------------------------

loc_140271DE2:                          ; CODE XREF: sub_140271600+7BB↑j
                                        ; sub_140271600+7CA↑j
                mov     r9d, ecx
                or      r9d, 5

loc_140271DE9:                          ; CODE XREF: sub_140271600+7E0↑j
                movzx   r8d, word ptr [rsp+200h+var_1B8+0Ah]
                mov     rcx, rbx
                call    sub_140229590
                xor     eax, eax
                mov     word ptr [rsp+200h+var_1B8+0Ah], ax

loc_140271DFE:                          ; CODE XREF: sub_140271600+772↑j
                mov     rdx, r12
                mov     rcx, rbx
                call    sub_140312B40
                or      sil, 2
                xor     ebx, ebx
                mov     byte ptr [rsp+200h+var_1B8+0Dh], sil
                mov     [rsp+200h+var_1A8], rbx
                jmp     short loc_140271E1D
; ---------------------------------------------------------------------------

loc_140271E1B:                          ; CODE XREF: sub_140271600+766↑j
                xor     ebx, ebx

loc_140271E1D:                          ; CODE XREF: sub_140271600+819↑j
                movzx   edx, byte ptr [rbp+100h+var_170]
                mov     rcx, r14
                call    sub_140226960
                mov     eax, r15d
                mov     [rsp+200h+var_1C0], rax
                neg     rax
                lea     r14, ds:0[rax*8]
                add     r14, r13
                mov     [rsp+200h+var_1A0], r14
                test    r15d, r15d
                jz      loc_140272070
                mov     rax, [rsp+200h+var_1C0]
                mov     r13, rbx
                mov     r12, 7FFFFFFFFFFFFFFFh
                nop

loc_140271E60:                          ; CODE XREF: sub_140271600+A6A↓j
                mov     r15, qword ptr [rbp+r13+100h+var_150]
                cmp     r15, 1
                jnz     loc_140271F5F
                mov     rcx, r14
                call    sub_1402805F0
                lea     rcx, [rsp+200h+var_190]
                mov     [rsp+200h+var_190], rax
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rbx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                mov     rcx, rbx
                call    sub_1402DAA00
                mov     rcx, rbx
                movzx   esi, al
                call    sub_1402C5FA0
                lock and [rbx+18h], r12
                xor     ebx, ebx
                mov     [rsp+200h+var_188], ebx
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_140271EF2

loc_140271ED6:                          ; CODE XREF: sub_140271600+8E7↓j
                                        ; sub_140271600+8F0↓j
                lea     rcx, [rsp+200h+var_188]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140271ED6
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140271ED6

loc_140271EF2:                          ; CODE XREF: sub_140271600+8D4↑j
                mov     rcx, rdi
                call    sub_1402C5FA0
                lock and [rdi+18h], r12
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140271F56
                test    al, 1
                jz      short loc_140271F56
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140271F56
                cmp     sil, 0Fh
                ja      short loc_140271F56
                cmp     al, 2
                jb      short loc_140271F56
                mov     r10, gs:20h
                lea     ecx, [rsi+1]
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_140271F56
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140271F56:                          ; CODE XREF: sub_140271600+907↑j
                                        ; sub_140271600+90B↑j ...
                mov     cr8, rsi
                jmp     loc_14027204F
; ---------------------------------------------------------------------------

loc_140271F5F:                          ; CODE XREF: sub_140271600+869↑j
                test    r15, r15
                jz      loc_140272054
                mov     rax, cs:qword_140C4DDC0
                mov     rsi, [rbp+r13+100h+var_D0]
                test    rax, rax
                jz      short loc_140271F85
                test    sil, 10h
                jnz     short loc_140271F85
                not     rax
                and     rsi, rax

loc_140271F85:                          ; CODE XREF: sub_140271600+977↑j
                                        ; sub_140271600+97D↑j
                sar     rsi, 10h
                mov     rbx, [rsi]
                mov     rcx, rbx
                call    sub_14026F920
                mov     r8d, 0FFFFFFFFh
                mov     rdx, r15
                mov     rcx, rsi
                mov     r14, rax
                call    sub_140270E80
                cmp     qword ptr [r14+20h], 0
                mov     r12, rax
                jnz     short loc_140272007
                mov     r15, gs:188h
                mov     rcx, [r15+0B8h]
                call    sub_140270D30
                mov     rsi, rax
                test    rax, rax
                jz      short loc_140272007
                mov     r8d, 4
                mov     rdx, rax
                mov     rcx, r15
                call    sub_1402EEB70
                test    eax, eax
                jz      short loc_140271FFB
                mov     dword ptr [rsp+200h+var_1E0], r8d
                mov     r9, r12
                mov     r8, [r14+18h]
                mov     rdx, r14
                mov     rcx, rsi
                call    sub_14026EFEC

loc_140271FFB:                          ; CODE XREF: sub_140271600+9E2↑j
                lea     rcx, [rsi+168h]
                call    sub_14024C380

loc_140272007:                          ; CODE XREF: sub_140271600+9B0↑j
                                        ; sub_140271600+9CD↑j
                prefetchw byte ptr [rbx+40h]
                mov     rax, [rbx+40h]
                mov     rcx, rax
                xor     rcx, r14
                cmp     rcx, 0Fh
                jnb     short loc_140272038
                nop     dword ptr [rax+rax+00h]

loc_140272020:                          ; CODE XREF: sub_140271600+A36↓j
                lea     rcx, [rax+1]
                lock cmpxchg [rbx+40h], rcx
                jz      short loc_140272040
                mov     rcx, rax
                xor     rcx, r14
                cmp     rcx, 0Fh
                jb      short loc_140272020

loc_140272038:                          ; CODE XREF: sub_140271600+A19↑j
                mov     rcx, r14
                call    ObDereferenceObjectDeferDelete

loc_140272040:                          ; CODE XREF: sub_140271600+A2A↑j
                mov     r14, [rsp+200h+var_1A0]
                mov     r12, 7FFFFFFFFFFFFFFFh

loc_14027204F:                          ; CODE XREF: sub_140271600+95A↑j
                mov     rax, [rsp+200h+var_1C0]

loc_140272054:                          ; CODE XREF: sub_140271600+962↑j
                add     r14, 8
                add     r13, 8
                sub     rax, 1
                mov     [rsp+200h+var_1A0], r14
                mov     [rsp+200h+var_1C0], rax
                jnz     loc_140271E60

loc_140272070:                          ; CODE XREF: sub_140271600+847↑j
                mov     rcx, [rbp+100h+var_50]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 1C8h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140271600
sub_140271600   endp

algn_140272094:                         ; DATA XREF: .pdata:00000001400CE508↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402720A0   proc near               ; CODE XREF: sub_1402F2C28+7F↓p
                                        ; CcPinRead+D4↓p ...

var_E8          = qword ptr -0E8h
var_E0          = dword ptr -0E0h
var_D8          = byte ptr -0D8h
var_D7          = byte ptr -0D7h
var_D4          = dword ptr -0D4h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_C0          = dword ptr -0C0h
var_BC          = dword ptr -0BCh
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = dword ptr -0A8h
var_A4          = dword ptr -0A4h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = dword ptr -90h
var_8C          = dword ptr -8Ch
var_88          = dword ptr -88h
var_84          = dword ptr -84h
var_80          = dword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = dword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
arg_0           = byte ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = byte ptr  20h
arg_20          = byte ptr  28h
arg_28          = dword ptr  30h
arg_30          = qword ptr  38h
arg_38          = qword ptr  40h
arg_40          = qword ptr  48h

; FUNCTION CHUNK AT 0000000140418870 SIZE 000000CD BYTES
; FUNCTION CHUNK AT 0000000140442186 SIZE 000000AC BYTES

; __unwind { // __C_specific_handler
                mov     [rsp+arg_18], r9b
                mov     [rsp+arg_10], r8d
                mov     [rsp+arg_8], rdx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 0D0h
                mov     r14, rdx
                mov     r12d, [rsp+108h+arg_28]
                xor     esi, esi
                mov     [rsp+108h+var_A0], rsi
                mov     [rsp+108h+var_D0], rsi
                mov     [rsp+108h+var_BC], esi
                mov     [rsp+108h+var_D8], sil
                mov     [rsp+108h+var_C0], esi
                mov     [rsp+108h+var_C8], rsi
                mov     rax, [rcx+28h]
                mov     r13, [rax+8]
                mov     [rsp+108h+var_60], r13
                mov     ecx, r8d
                add     rcx, [rdx]
                cmp     rcx, [r13+20h]
                jg      loc_140442214
                mov     rax, [rsp+108h+arg_30]
                mov     [rax], rsi
                mov     rbx, [rsp+108h+arg_38]
                mov     [rbx], rsi
                test    r12b, 4
                jnz     loc_14044218E
                lea     r15d, [rsi+1]
                test    r12b, 40h
                jnz     loc_140442186
                mov     eax, esi

loc_14027213A:                          ; CODE XREF: sub_1402720A0+1D00E9↓j
                mov     [rsp+108h+var_E0], esi
                mov     dword ptr [rsp+108h+var_E8], eax
                lea     r9, [rsp+108h+var_C0]
                lea     r8, [rsp+108h+var_C8]
                mov     rdx, [rdx]
                mov     rcx, r13
                call    sub_140273980
                mov     [rbx], rax

loc_14027215A:                          ; CODE XREF: sub_1402720A0+1D0112↓j
                lea     rdi, [r13+118h]
                mov     [rsp+108h+var_8C], esi
                mov     rbx, gs:188h
                dec     word ptr [rbx+1E6h]
                inc     byte ptr [rbx+31Ah]
                cmp     byte ptr [rbx+31Ah], 1
                jnz     loc_1402730B3
                mov     [rsp+108h+var_90], esi
                movzx   eax, byte ptr [rbx+318h]
                test    al, al
                jz      loc_14027314C

loc_14027219B:                          ; CODE XREF: sub_1402720A0+10C3↓j
                movzx   edx, al
                bsf     ecx, edx
                mov     [rsp+108h+var_90], ecx
                mov     eax, r15d
                shl     al, cl
                not     al
                and     al, dl
                mov     [rbx+318h], al
                lea     rsi, [rcx+rcx*2]
                shl     rsi, 5
                add     rsi, [rbx+320h]

loc_1402721C3:                          ; CODE XREF: sub_1402720A0+10D2↓j
                                        ; sub_1402720A0+1D0123↓j
                test    rsi, rsi
                jz      loc_140273141
                mov     rax, 0FFFF800000000000h
                cmp     rdi, rax
                jb      short loc_140272201
                mov     rax, rdi
                shr     rax, 27h
                and     eax, 1FFh
                add     eax, 0FFFFFF00h
                lea     rdx, qword_140C4C740
                cmp     byte ptr [rax+rdx+3108h], 1
                jz      loc_1404421C8

loc_140272201:                          ; CODE XREF: sub_1402720A0+139↑j
                mov     eax, 0FFFFFFFFh

loc_140272206:                          ; CODE XREF: sub_1402720A0+1D0135↓j
                mov     [rsi+28h], eax
                mov     rax, rdi
                mov     rcx, 7FFFFFFFFFFFFFFCh
                and     rax, rcx
                mov     [rsi+20h], rax

loc_14027221D:                          ; CODE XREF: sub_1402720A0+10A7↓j
                dec     byte ptr [rbx+31Ah]
                lea     r8, [rsp+108h+var_8C]
                mov     rdx, rdi
                mov     rcx, rbx
                call    sub_1402456E0
                add     word ptr [rbx+1E6h], 1
                jnz     short loc_14027224D
                add     rbx, 98h
                cmp     [rbx], rbx
                jnz     loc_140273137

loc_14027224D:                          ; CODE XREF: sub_1402720A0+19B↑j
                                        ; sub_1402720A0+109C↓j
                mov     rbx, cr8
                mov     cr8, r15
                lock btr dword ptr [rdi], 0
                jnb     loc_140273101

loc_140272260:                          ; CODE XREF: sub_1402720A0+106C↓j
                test    rsi, rsi
                jz      short loc_140272269
                or      byte ptr [rsi+1Ah], 1

loc_140272269:                          ; CODE XREF: sub_1402720A0+1C3↑j
                mov     rax, gs:188h
                mov     [rdi+8], rax
                movzx   eax, bl
                mov     [rdi+30h], eax
                mov     [rsp+108h+var_D4], r15d

loc_140272281:                          ; DATA XREF: .rdata:000000014005D900↑o
;   __try { // __finally(loc_140418870)
                xor     r10d, r10d
                mov     [rsp+108h+var_B0], r10
                mov     [rsp+108h+var_B8], r10
                mov     r15, [r14]
                mov     rsi, r15
                shr     rsi, 20h
                mov     r9d, [rsp+108h+arg_10]
                lea     rbx, [r15+r9]
                mov     [rsp+108h+var_A0], rbx
                mov     [rsp+108h+var_78], r10
                mov     [rsp+108h+var_D7], r10b
                lea     rdi, [r15+80000h]
                mov     rcx, [r13+20h]
                mov     r8, rcx
                shr     r8, 20h
                mov     rdx, r15
                shr     rdx, 20h
                cmp     rcx, 200000h
                jle     loc_140272A83
                mov     edx, esi
                test    dword ptr [r13+98h], 200h
                jz      loc_140272A83
                cmp     rcx, 2000000h
                jle     loc_14027282E
                mov     r8b, 1
                mov     rdx, rdi
                mov     rcx, r13
                call    sub_140271050
                mov     rdi, rax
                mov     r9d, [rsp+108h+arg_10]
                xor     r10d, r10d

loc_140272318:                          ; CODE XREF: sub_1402720A0+7C5↓j
                                        ; sub_1402720A0+9E9↓j
                mov     rdi, [rdi]
                sub     rdi, 10h
                mov     [rsp+108h+var_78], rdi
                mov     edx, 2FDh
                test    esi, esi
                jnz     loc_1402728D0
                movzx   eax, word ptr [rdi]
                cmp     ax, dx
                jnz     loc_1402728D0
                cmp     [rdi+24h], esi
                jnz     loc_1402728D0
                mov     r8d, dword ptr [rsp+108h+var_A0]
                xchg    ax, ax

loc_140272350:                          ; CODE XREF: sub_1402720A0+2E7↓j
                cmp     ax, dx
                jnz     loc_1402728D9
                cmp     r15d, [rdi+20h]
                jnb     loc_1402728D9
                mov     ecx, [rdi+8]
                cmp     r15d, ecx
                jnb     short loc_140272389
                cmp     r8d, ecx
                jnb     loc_140272A8E

loc_140272374:                          ; CODE XREF: sub_1402720A0+9FA↓j
                mov     rdi, [rdi+10h]
                sub     rdi, 10h
                mov     [rsp+108h+var_78], rdi
                movzx   eax, word ptr [rdi]
                jmp     short loc_140272350
; ---------------------------------------------------------------------------

loc_140272389:                          ; CODE XREF: sub_1402720A0+2C9↑j
                mov     al, 1
                mov     [rsp+108h+var_D7], al

loc_14027238F:                          ; CODE XREF: sub_1402720A0+83E↓j
                                        ; sub_1402720A0+D07↓j
                mov     [rsp+108h+var_D0], rdi
                movzx   eax, al
                test    eax, eax
                jz      loc_1402728E3
                test    dword ptr [r13+98h], 200h
                jz      loc_140272EA2

loc_1402723B0:                          ; CODE XREF: sub_1402720A0+E0A↓j
                mov     edx, r12d
                and     edx, 1
                cmp     qword ptr [rdi+0B8h], 0
                jnz     loc_14027286A
                mov     eax, r15d
                sub     eax, [rdi+8]
                mov     r15, [rsp+108h+arg_38]
                sub     [r15], rax
                mov     rax, [rdi+8]
                mov     [rsp+108h+var_B0], rax
                mov     eax, [rdi+4]
                mov     [rsp+108h+var_B8], rax
                test    edx, edx
                jz      loc_140272B95
                inc     dword ptr [rdi+40h]
                lea     rbx, [r13+118h]
                mov     [rbx+8], r10
                movzx   esi, byte ptr [rbx+30h]
                xor     eax, eax
                mov     r15d, 1
                lock cmpxchg [rbx], r15d
                jnz     loc_140272B13

loc_140272413:                          ; CODE XREF: sub_1402720A0+A7D↓j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140272EAF

loc_140272421:                          ; CODE XREF: sub_1402720A0+E12↓j
                                        ; sub_1402720A0+E1E↓j ...
                mov     cr8, rsi
                mov     rcx, rbx
                call    sub_140243660
                xor     r10d, r10d
                mov     [rsp+108h+var_D4], r10d
                cmp     [rsp+108h+arg_18], r10b
                jnz     short loc_140272481
                add     rdi, 48h ; 'H'
                test    r12b, 2
                jnz     loc_140272F16
                movzx   ecx, word ptr [rdi+1Ah]
                movzx   eax, cl
                and     al, 41h
                cmp     al, r15b
                jz      loc_140272D68
                and     cx, r15w
                jnz     loc_140272B22

loc_140272469:                          ; CODE XREF: sub_1402720A0+AAB↓j
                                        ; sub_1402720A0+AB9↓j ...
                movzx   edx, r15b
                test    cx, cx
                mov     rcx, rdi
                jnz     loc_140272F5A
                call    sub_1402711C0

loc_14027247E:                          ; CODE XREF: sub_1402720A0+E82↓j
                                        ; sub_1402720A0+EBF↓j
                xor     r10d, r10d

loc_140272481:                          ; CODE XREF: sub_1402720A0+39D↑j
                test    r12b, 4
                jnz     loc_14027300D
                mov     rax, [rsp+108h+arg_38]
                mov     rsi, [rax]
                mov     [rsp+108h+var_98], rsi
                mov     rdi, gs:188h
                mov     [rsp+108h+var_50], rdi
                mov     [rsp+108h+var_88], r10d
                mov     [rsp+108h+var_58], r10d
                mov     [rsp+108h+var_A8], r10d
                mov     r8d, r10d
                mov     [rsp+108h+var_84], r10d
                mov     [rsp+108h+arg_0], r15b
                mov     rcx, rsi
                and     ecx, 0FFFh
                mov     edx, dword ptr [rsp+108h+var_B8]
                add     rdx, 0FFFh
                add     rdx, rcx
                shr     rdx, 0Ch
                mov     [rsp+108h+var_A8], edx
                and     rsi, 0FFFFFFFFFFFFF000h
                mov     [rsp+108h+var_98], rsi
                mov     ecx, [rdi+508h]
                movzx   eax, byte ptr [rdi+51Ch]
                lea     r15d, [rax+rcx*4]

loc_140272510:                          ; CODE XREF: sub_1402720A0+76B↓j
                mov     ecx, 0Fh
                test    edx, edx
                jnz     loc_1402727AA

loc_14027251D:                          ; CODE XREF: sub_1402720A0+ED8↓j
                movzx   eax, r15b
                and     al, 3
                mov     [rdi+51Ch], al
                shr     r15d, 2
                mov     [rdi+508h], r15d
                test    r8d, r8d
                js      loc_140272F7D
                mov     [rsp+108h+var_68], r10
                mov     [rsp+108h+var_A4], r10d
                mov     [rsp+108h+var_A4], r10d
                mov     rdi, gs:188h
                dec     word ptr [rdi+1E6h]
                inc     byte ptr [rdi+31Ah]
                cmp     byte ptr [rdi+31Ah], 1
                jnz     loc_140272810
                mov     [rsp+108h+var_68], r10
                mov     [rsp+108h+var_70], r10
                mov     [rsp+108h+var_80], r10d
                movzx   eax, byte ptr [rdi+318h]
                test    al, al
                jz      loc_140272CE5

loc_140272599:                          ; CODE XREF: sub_1402720A0+C64↓j
                movzx   edx, al
                bsf     ecx, edx
                mov     [rsp+108h+var_80], ecx
                mov     r15d, 1
                mov     eax, r15d
                shl     al, cl
                not     al
                and     al, dl
                mov     [rdi+318h], al
                lea     rsi, [rcx+rcx*2]
                shl     rsi, 5
                add     rsi, [rdi+320h]
                mov     [rsp+108h+var_70], rsi

loc_1402725D2:                          ; CODE XREF: sub_1402720A0+CC3↓j
                mov     [rsp+108h+var_68], rsi
                test    rsi, rsi
                jz      loc_140272CDA
                mov     rax, 0FFFF800000000000h
                cmp     rbx, rax
                jb      short loc_14027261A
                mov     rcx, rbx
                shr     rcx, 27h
                and     ecx, 1FFh
                add     ecx, 0FFFFFF00h
                lea     rax, qword_140C4C740
                cmp     byte ptr [rcx+rax+3108h], 1
                jz      loc_140272F96

loc_14027261A:                          ; CODE XREF: sub_1402720A0+550↑j
                mov     eax, 0FFFFFFFFh

loc_14027261F:                          ; CODE XREF: sub_1402720A0+F02↓j
                mov     [rsi+28h], eax
                mov     rax, rbx
                mov     rcx, 7FFFFFFFFFFFFFFCh
                and     rax, rcx
                mov     [rsi+20h], rax

loc_140272636:                          ; CODE XREF: sub_1402720A0+C40↓j
                dec     byte ptr [rdi+31Ah]
                lea     r8, [rsp+108h+var_A4]
                mov     rdx, rbx
                mov     rcx, rdi
                call    sub_1402456E0
                movzx   eax, word ptr [rdi+1E6h]
                add     ax, 1
                mov     [rdi+1E6h], ax
                jnz     short loc_140272670
                lea     rax, [rdi+98h]
                cmp     [rax], rax
                jnz     loc_140272B09

loc_140272670:                          ; CODE XREF: sub_1402720A0+5BE↑j
                                        ; sub_1402720A0+A6E↓j
                mov     rdi, cr8
                mov     cr8, r15
                lock btr dword ptr [rbx], 0
                jnb     loc_140272AF9

loc_140272683:                          ; CODE XREF: sub_1402720A0+A64↓j
                test    rsi, rsi
                jz      short loc_14027268C
                or      byte ptr [rsi+1Ah], 1

loc_14027268C:                          ; CODE XREF: sub_1402720A0+5E6↑j
                mov     rax, gs:188h
                mov     [rsp+108h+var_48], rax
                mov     [rbx+8], rax
                movzx   eax, dil
                mov     [rbx+30h], eax
                mov     rsi, [rsp+108h+var_D0]
                cmp     qword ptr [rsi+0B8h], 0
                jnz     short loc_1402726DB
                mov     rax, [rsp+108h+arg_38]
                mov     rax, [rax]
                mov     [rsi+0B8h], rax
                mov     rax, [rsp+108h+var_C8]
                mov     [rsi+38h], rax
                mov     [rsp+108h+var_C8], 0

loc_1402726DB:                          ; CODE XREF: sub_1402720A0+615↑j
                mov     qword ptr [rbx+8], 0
                movzx   edi, byte ptr [rbx+30h]
                xor     eax, eax
                lock cmpxchg [rbx], r15d
                jnz     loc_140272B86

loc_1402726F4:                          ; CODE XREF: sub_1402720A0+AF0↓j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140272FA7

loc_140272702:                          ; CODE XREF: sub_1402720A0+F09↓j
                                        ; sub_1402720A0+F15↓j ...
                mov     cr8, rdi
                mov     rcx, rbx
                call    sub_140243660
                mov     rdi, [rsp+108h+var_D0]
                mov     eax, [r14]
                sub     eax, [rdi+8]
                add     rax, [rsi+0B8h]
                mov     r15, [rsp+108h+arg_38]
                mov     [r15], rax

loc_14027272B:                          ; CODE XREF: sub_1402720A0+F7A↓j
                xor     r10d, r10d

loc_14027272E:                          ; CODE XREF: sub_1402720A0+823↓j
                                        ; sub_1402720A0+9DE↓j ...
                mov     [rsp+108h+var_D8], 1

loc_140272733:                          ; CODE XREF: sub_1402720A0+A54↓j
                                        ; sub_1402720A0+D1C↓j ...
                mov     rsi, 0FFFFFFFFFFFFFFFFh
                mov     eax, r12d
                and     eax, 6
                cmp     al, 6
                jnz     loc_140273056
                test    rdi, rdi
                jz      loc_140273056
                cmp     qword ptr [rdi+0B8h], 0
                jz      loc_140273056
                mov     rax, [rdi+38h]
                mov     rbx, [rax+8]
                mov     ecx, esi
                lock xadd [rax+10h], ecx
                dec     ecx
                test    cx, cx
                jnz     short loc_140272795
                mov     rcx, [rbx+0B8h]
                test    rcx, rcx
                jz      short loc_14027278E
                xor     r8d, r8d
                xor     edx, edx
                call    KeSetEvent
                xor     r10d, r10d

loc_14027278E:                          ; CODE XREF: sub_1402720A0+6DF↑j
                lock dec dword ptr [rbx+220h]

loc_140272795:                          ; CODE XREF: sub_1402720A0+6D3↑j
                mov     [rdi+0B8h], r10
                mov     [rdi+38h], r10
                mov     rdi, [rsp+108h+var_D0]
                jmp     loc_140273056
; ---------------------------------------------------------------------------

loc_1402727AA:                          ; CODE XREF: sub_1402720A0+477↑j
                mov     byte ptr [rdi+51Ch], 1
                lea     eax, [rdx-1]
                cmp     eax, [rdi+508h]
                ja      loc_140272F64

loc_1402727C0:                          ; CODE XREF: sub_1402720A0+ED0↓j
                mov     [rsp+108h+var_88], r10d
                shl     edx, 0Ch
                mov     eax, edx
                mov     [rsp+108h+var_98], rax
                lea     r9, [rsp+108h+arg_0]
                mov     r8d, r10d
                mov     rcx, rsi
                call    sub_140274000
                mov     r8d, eax
                mov     [rsp+108h+var_84], eax
                test    eax, eax
                js      loc_140272F75
                add     rsi, [rsp+108h+var_98]
                mov     [rsp+108h+var_98], rsi
                xor     r10d, r10d
                mov     edx, r10d
                mov     [rsp+108h+var_A8], edx
                jmp     loc_140272510
; ---------------------------------------------------------------------------

loc_140272810:                          ; CODE XREF: sub_1402720A0+4CC↑j
                mov     rax, cr8
                movzx   r9d, al
                mov     [rsp+108h+var_E8], r10
                mov     r8, rbx
                mov     rdx, rdi
                mov     ecx, 192h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14027282E:                          ; CODE XREF: sub_1402720A0+256↑j
                cmp     rdi, rcx
                jge     loc_140272A85
                test    r8d, r8d
                jnz     loc_140272DC1
                cmp     ecx, 100000h
                jbe     loc_140272DCB
                mov     ecx, ecx
                shr     rcx, 12h
                shl     rcx, 3

loc_140272856:                          ; CODE XREF: sub_1402720A0+D26↓j
                                        ; sub_1402720A0+D30↓j
                add     rcx, [r13+58h]
                sar     rdi, 13h
                shl     rdi, 4
                add     rdi, rcx
                jmp     loc_140272318
; ---------------------------------------------------------------------------

loc_14027286A:                          ; CODE XREF: sub_1402720A0+31E↑j
                test    edx, edx
                jz      loc_140272D09
                inc     dword ptr [rdi+40h]
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                xor     r10d, r10d
                mov     [rsp+108h+var_D4], r10d
                cmp     [rsp+108h+arg_18], r10b
                jnz     short loc_1402728AB
                lea     rcx, [rdi+48h]
                mov     dl, 1
                test    r12b, 2
                jnz     loc_14027302C
                call    ExAcquireSharedStarveExclusive
                xor     r10d, r10d

loc_1402728AB:                          ; CODE XREF: sub_1402720A0+7F1↑j
                                        ; sub_1402720A0+C9D↓j ...
                mov     eax, [r14]
                sub     eax, [rdi+8]
                add     rax, [rdi+0B8h]
                mov     r15, [rsp+108h+arg_38]
                mov     [r15], rax
                jmp     loc_14027272E
; ---------------------------------------------------------------------------
                align 10h

loc_1402728D0:                          ; CODE XREF: sub_1402720A0+28E↑j
                                        ; sub_1402720A0+29A↑j ...
                cmp     [rdi], dx
                jz      loc_140272D8E

loc_1402728D9:                          ; CODE XREF: sub_1402720A0+2B3↑j
                                        ; sub_1402720A0+2BD↑j ...
                movzx   eax, [rsp+108h+var_D7]
                jmp     loc_14027238F
; ---------------------------------------------------------------------------

loc_1402728E3:                          ; CODE XREF: sub_1402720A0+2F9↑j
                test    r12b, 8
                jnz     loc_140272ADF
                mov     rcx, r15
                mov     [rsp+108h+var_B0], rcx
                sub     rbx, r15
                mov     [rsp+108h+var_B8], rbx
                mov     edx, r15d
                and     edx, 0FFFh
                add     ebx, edx
                mov     dword ptr [rsp+108h+var_B8], ebx
                mov     r8d, [rsp+108h+var_C0]
                add     r8d, edx
                mov     [rsp+108h+var_C0], r8d
                cmp     [rsp+108h+arg_18], 0
                jnz     short loc_140272932
                mov     eax, [r13+98h]
                test    al, 4
                jz      loc_140272A9F

loc_140272932:                          ; CODE XREF: sub_1402720A0+881↑j
                mov     eax, ecx
                cmp     [rsp+108h+arg_20], 0
                jnz     loc_140272A9F
                mov     r15d, [rsp+108h+var_BC]

loc_140272947:                          ; CODE XREF: sub_1402720A0+A2B↓j
                                        ; sub_1402720A0+A3A↓j
                mov     ecx, eax
                test    dword ptr [r13+98h], 200h
                jz      loc_140272C30

loc_14027295A:                          ; CODE XREF: sub_1402720A0+B98↓j
                add     ebx, 0FFFh
                and     ebx, 0FFFFF000h
                mov     dword ptr [rsp+108h+var_B8], ebx
                and     ecx, 0FFFh
                mov     rax, [rsp+108h+arg_38]
                sub     [rax], rcx
                and     dword ptr [rsp+108h+var_B0], 0FFFFF000h
                cmp     ebx, r8d
                ja      loc_140272D82

loc_14027298C:                          ; CODE XREF: sub_1402720A0+CE9↓j
                lea     r9, [rsp+108h+var_B8]
                lea     r8, [rsp+108h+var_B0]
                mov     rdx, rdi
                mov     rcx, r13
                call    sub_14026F7FC
                mov     rdi, rax
                mov     [rsp+108h+var_D0], rax
                test    r12b, 1
                jz      loc_140272C3D
                test    rax, rax
                jz      loc_140272DF6
                cmp     [rsp+108h+arg_18], 0
                jnz     short loc_1402729E3
                lea     rcx, [rax+48h]
                xor     edx, edx
                test    r12b, 2
                jnz     loc_140272E14
                call    ExAcquireSharedStarveExclusive
                test    al, al
                jz      loc_140272E3E

loc_1402729E3:                          ; CODE XREF: sub_1402720A0+924↑j
                                        ; sub_1402720A0+D7B↓j
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                xor     r10d, r10d
                mov     [rsp+108h+var_D4], r10d
                test    r12b, 4
                jnz     short loc_140272A76
                mov     rax, [rsp+108h+arg_38]
                mov     r9, [rax]
                mov     r8b, 1
                mov     edx, r15d
                mov     ecx, ebx
                call    sub_140273E50
                lea     rcx, [r13+118h]
                call    ExAcquireFastMutex
                cmp     qword ptr [rdi+0B8h], 0
                jnz     short loc_140272A4F
                mov     rax, [rsp+108h+arg_38]
                mov     rax, [rax]
                mov     [rdi+0B8h], rax
                mov     rax, [rsp+108h+var_C8]
                mov     [rdi+38h], rax
                mov     [rsp+108h+var_C8], 0

loc_140272A4F:                          ; CODE XREF: sub_1402720A0+989↑j
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                mov     eax, [r14]
                sub     eax, [rdi+8]
                add     rax, [rdi+0B8h]
                mov     rcx, [rsp+108h+arg_38]
                mov     [rcx], rax
                xor     r10d, r10d

loc_140272A76:                          ; CODE XREF: sub_1402720A0+95B↑j
                mov     r15, [rsp+108h+arg_38]
                jmp     loc_14027272E
; ---------------------------------------------------------------------------

loc_140272A83:                          ; CODE XREF: sub_1402720A0+236↑j
                                        ; sub_1402720A0+249↑j
                mov     esi, edx

loc_140272A85:                          ; CODE XREF: sub_1402720A0+791↑j
                lea     rdi, [r13+10h]
                jmp     loc_140272318
; ---------------------------------------------------------------------------

loc_140272A8E:                          ; CODE XREF: sub_1402720A0+2CE↑j
                mov     r8d, ecx
                mov     dword ptr [rsp+108h+var_A0], ecx
                mov     rbx, [rsp+108h+var_A0]
                jmp     loc_140272374
; ---------------------------------------------------------------------------

loc_140272A9F:                          ; CODE XREF: sub_1402720A0+88C↑j
                                        ; sub_1402720A0+89C↑j
                mov     eax, ecx
                mov     r15d, 2
                mov     [rsp+108h+var_BC], r15d
                test    edx, edx
                jnz     short loc_140272AC5
                mov     ecx, 3
                cmp     r9d, 1000h
                cmovnb  r15d, ecx
                mov     [rsp+108h+var_BC], r15d

loc_140272AC5:                          ; CODE XREF: sub_1402720A0+A0E↑j
                test    ebx, 0FFFh
                jnz     loc_140272947
                or      r15d, 4
                mov     [rsp+108h+var_BC], r15d
                jmp     loc_140272947
; ---------------------------------------------------------------------------

loc_140272ADF:                          ; CODE XREF: sub_1402720A0+847↑j
                mov     rdi, r10
                mov     [rsp+108h+var_D0], r10
                mov     [rsp+108h+var_D8], 0
                mov     r15, [rsp+108h+arg_38]
                jmp     loc_140272733
; ---------------------------------------------------------------------------

loc_140272AF9:                          ; CODE XREF: sub_1402720A0+5DD↑j
                mov     rdx, rsi
                mov     rcx, rbx
                call    sub_1402F5E40
                jmp     loc_140272683
; ---------------------------------------------------------------------------

loc_140272B09:                          ; CODE XREF: sub_1402720A0+5CA↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_140272670
; ---------------------------------------------------------------------------

loc_140272B13:                          ; CODE XREF: sub_1402720A0+36D↑j
                mov     edx, eax
                mov     rcx, rbx
                call    sub_1402F424C
                jmp     loc_140272413
; ---------------------------------------------------------------------------

loc_140272B22:                          ; CODE XREF: sub_1402720A0+3C3↑j
                mov     rdx, cr8
                mov     r8, gs:188h
                cmp     dl, r15b
                ja      loc_140272F27
                movzx   eax, byte ptr [r8+0C0h]
                test    al, 2
                jnz     loc_140272F40
                cmp     dl, r15b
                jnb     loc_140272469
                test    dword ptr [r8+74h], 400h
                jnz     loc_140272469
                cmp     [r8+1E4h], r10d
                jnz     loc_140272469
                mov     [rsp+108h+var_E8], r10
                xor     r9d, r9d
                xor     r8d, r8d
                lea     edx, [r9+7]
                mov     ecx, 1C6h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140272B86:                          ; CODE XREF: sub_1402720A0+64E↑j
                mov     edx, eax
                mov     rcx, rbx
                call    sub_1402F424C
                jmp     loc_1402726F4
; ---------------------------------------------------------------------------

loc_140272B95:                          ; CODE XREF: sub_1402720A0+348↑j
                cmp     [rsp+108h+arg_18], 0
                jnz     short loc_140272BB2
                lea     rcx, [rdi+48h]
                xor     edx, edx
                call    ExAcquireSharedStarveExclusive
                test    al, al
                jz      loc_140272DAC

loc_140272BB2:                          ; CODE XREF: sub_1402720A0+AFD↑j
                inc     dword ptr [rdi+40h]
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                xor     esi, esi
                mov     [rsp+108h+var_D4], esi
                mov     r9, [r15]
                xor     r8d, r8d
                xor     edx, edx
                mov     ecx, [rdi+4]
                call    sub_140273E50
                test    al, al
                jz      loc_14027301F
                lea     rcx, [r13+118h]
                call    ExAcquireFastMutex
                cmp     [rdi+0B8h], rsi
                jnz     short loc_140272C0C
                mov     rax, [r15]
                mov     [rdi+0B8h], rax
                mov     rax, [rsp+108h+var_C8]
                mov     [rdi+38h], rax
                mov     [rsp+108h+var_C8], rsi

loc_140272C0C:                          ; CODE XREF: sub_1402720A0+B52↑j
                                        ; sub_1402720A0+C13↓j ...
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                mov     eax, [r14]
                sub     eax, [rdi+8]
                add     rax, [rdi+0B8h]
                xor     r10d, r10d
                mov     [r15], rax
                jmp     loc_14027272E
; ---------------------------------------------------------------------------

loc_140272C30:                          ; CODE XREF: sub_1402720A0+8B4↑j
                mov     [rsp+108h+arg_18], 1
                jmp     loc_14027295A
; ---------------------------------------------------------------------------

loc_140272C3D:                          ; CODE XREF: sub_1402720A0+90D↑j
                test    rax, rax
                jz      loc_140272E5B
                cmp     [rsp+108h+arg_18], 0
                jnz     short loc_140272C63
                lea     rcx, [rax+48h]
                xor     edx, edx
                call    ExAcquireSharedStarveExclusive
                test    al, al
                jz      loc_140272E70

loc_140272C63:                          ; CODE XREF: sub_1402720A0+BAE↑j
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                mov     [rsp+108h+var_D4], 0
                mov     rax, [rsp+108h+arg_38]
                mov     r9, [rax]
                xor     r8d, r8d
                mov     edx, r15d
                mov     ecx, ebx
                call    sub_140273E50
                test    al, al
                jz      loc_140272E8D
                lea     rcx, [r13+118h]
                call    ExAcquireFastMutex
                mov     r15, [rsp+108h+arg_38]
                cmp     qword ptr [rdi+0B8h], 0
                jnz     loc_140272C0C
                mov     rax, [r15]
                mov     [rdi+0B8h], rax
                mov     rax, [rsp+108h+var_C8]
                mov     [rdi+38h], rax
                mov     [rsp+108h+var_C8], 0
                jmp     loc_140272C0C
; ---------------------------------------------------------------------------

loc_140272CDA:                          ; CODE XREF: sub_1402720A0+53D↑j
                lock bts dword ptr [rdi+78h], 10h
                jmp     loc_140272636
; ---------------------------------------------------------------------------

loc_140272CE5:                          ; CODE XREF: sub_1402720A0+4F3↑j
                cmp     byte ptr [rdi+366h], 0
                jz      short loc_140272D42
                mov     eax, r10d
                xchg    al, [rdi+366h]
                or      [rdi+318h], al
                movzx   eax, byte ptr [rdi+318h]
                jmp     loc_140272599
; ---------------------------------------------------------------------------

loc_140272D09:                          ; CODE XREF: sub_1402720A0+7CC↑j
                cmp     [rsp+108h+arg_18], 0
                jnz     short loc_140272D26
                lea     rcx, [rdi+48h]
                xor     edx, edx
                call    ExAcquireSharedStarveExclusive
                test    al, al
                jz      loc_140273039

loc_140272D26:                          ; CODE XREF: sub_1402720A0+C71↑j
                inc     dword ptr [rdi+40h]
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                xor     r10d, r10d
                mov     [rsp+108h+var_D4], r10d
                jmp     loc_1402728AB
; ---------------------------------------------------------------------------

loc_140272D42:                          ; CODE XREF: sub_1402720A0+C4C↑j
                mov     rsi, r10
                mov     [rsp+108h+var_70], r10
                test    dword ptr cs:xmmword_140CFC480+4, 200h
                jnz     loc_140272F86

loc_140272D5D:                          ; CODE XREF: sub_1402720A0+EF1↓j
                mov     r15d, 1
                jmp     loc_1402725D2
; ---------------------------------------------------------------------------

loc_140272D68:                          ; CODE XREF: sub_1402720A0+3B9↑j
                mov     [rsp+108h+var_E8], r10
                xor     r9d, r9d
                mov     r8, rdi
                lea     edx, [r9+0Fh]
                mov     ecx, 1C6h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140272D82:                          ; CODE XREF: sub_1402720A0+8E6↑j
                mov     ebx, r8d
                mov     dword ptr [rsp+108h+var_B8], ebx
                jmp     loc_14027298C
; ---------------------------------------------------------------------------

loc_140272D8E:                          ; CODE XREF: sub_1402720A0+833↑j
                cmp     r15, [rdi+20h]
                jge     loc_1402728D9
                mov     rax, [rdi+8]
                cmp     r15, rax
                jl      short loc_140272DD5
                mov     al, 1
                mov     [rsp+108h+var_D7], al
                jmp     loc_14027238F
; ---------------------------------------------------------------------------

loc_140272DAC:                          ; CODE XREF: sub_1402720A0+B0C↑j
                xor     r10d, r10d
                mov     edi, r10d
                mov     [rsp+108h+var_D0], r10
                mov     [rsp+108h+var_D8], dil
                jmp     loc_140272733
; ---------------------------------------------------------------------------

loc_140272DC1:                          ; CODE XREF: sub_1402720A0+79A↑j
                mov     ecx, 0FFFFFFFFh
                jmp     loc_140272856
; ---------------------------------------------------------------------------

loc_140272DCB:                          ; CODE XREF: sub_1402720A0+7A6↑j
                mov     ecx, 20h ; ' '
                jmp     loc_140272856
; ---------------------------------------------------------------------------

loc_140272DD5:                          ; CODE XREF: sub_1402720A0+CFF↑j
                cmp     rbx, rax
                cmovge  rbx, rax
                mov     [rsp+108h+var_A0], rbx
                mov     rdi, [rdi+10h]
                sub     rdi, 10h
                mov     [rsp+108h+var_78], rdi
                jmp     loc_1402728D0
; ---------------------------------------------------------------------------

loc_140272DF6:                          ; CODE XREF: sub_1402720A0+916↑j
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                mov     [rsp+108h+var_D4], 0
                mov     ecx, 0C000009Ah
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------

loc_140272E14:                          ; CODE XREF: sub_1402720A0+930↑j
                call    ExAcquireResourceExclusiveLite
                test    al, al
                jnz     loc_1402729E3
                mov     [rsp+108h+var_E8], 0
                xor     r9d, r9d
                mov     r8, rdi
                mov     edx, 201F6h
                lea     ecx, [r9+34h]
                call    KeBugCheckEx

loc_140272E3E:                          ; CODE XREF: sub_1402720A0+93D↑j
                mov     [rsp+108h+var_E8], 0
                xor     r9d, r9d
                mov     r8, rdi
                mov     edx, 201FDh
                lea     ecx, [r9+34h]
                call    KeBugCheckEx

loc_140272E5B:                          ; CODE XREF: sub_1402720A0+BA0↑j
                mov     [rsp+108h+var_D8], 0
                mov     r15, [rsp+108h+arg_38]
                xor     r10d, r10d
                jmp     loc_140272733
; ---------------------------------------------------------------------------

loc_140272E70:                          ; CODE XREF: sub_1402720A0+BBD↑j
                mov     [rsp+108h+var_E8], 0
                xor     r9d, r9d
                mov     r8, rdi
                mov     edx, 2025Dh
                lea     ecx, [r9+34h]
                call    KeBugCheckEx

loc_140272E8D:                          ; CODE XREF: sub_1402720A0+BF1↑j
                mov     [rsp+108h+var_D8], 0
                mov     r15, [rsp+108h+arg_38]
                xor     r10d, r10d
                jmp     loc_140272733
; ---------------------------------------------------------------------------

loc_140272EA2:                          ; CODE XREF: sub_1402720A0+30A↑j
                mov     [rsp+108h+arg_18], 1
                jmp     loc_1402723B0
; ---------------------------------------------------------------------------

loc_140272EAF:                          ; CODE XREF: sub_1402720A0+37B↑j
                test    r15b, al
                jz      loc_140272421
                mov     rax, cr8
                cmp     al, 0Fh
                ja      loc_140272421
                cmp     sil, 0Fh
                ja      loc_140272421
                cmp     al, 2
                jb      loc_140272421
                mov     r10, gs:20h
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                lea     ecx, [rsi+1]
                mov     rax, 0FFFFFFFFFFFFFFFFh
                shl     rax, cl
                movzx   edx, ax
                not     edx
                and     r8d, edx
                mov     [r9+14h], r8d
                jnz     loc_140272421
                mov     rcx, r10
                call    sub_1403F2EC4
                jmp     loc_140272421
; ---------------------------------------------------------------------------

loc_140272F16:                          ; CODE XREF: sub_1402720A0+3A7↑j
                movzx   edx, r15b
                mov     rcx, rdi
                call    ExAcquireResourceExclusiveLite
                jmp     loc_14027247E
; ---------------------------------------------------------------------------

loc_140272F27:                          ; CODE XREF: sub_1402720A0+A92↑j
                movzx   r8d, dl
                mov     [rsp+108h+var_E8], r10
                mov     r9, r15
                xor     edx, edx
                mov     ecx, 1C6h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140272F40:                          ; CODE XREF: sub_1402720A0+AA2↑j
                mov     [rsp+108h+var_E8], r10
                xor     r9d, r9d
                xor     r8d, r8d
                lea     edx, [r9+6]
                mov     ecx, 1C6h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140272F5A:                          ; CODE XREF: sub_1402720A0+3D3↑j
                call    sub_1405B4BEC
                jmp     loc_14027247E
; ---------------------------------------------------------------------------

loc_140272F64:                          ; CODE XREF: sub_1402720A0+71A↑j
                cmp     eax, 0Fh
                cmova   eax, ecx
                mov     [rdi+508h], eax
                jmp     loc_1402727C0
; ---------------------------------------------------------------------------

loc_140272F75:                          ; CODE XREF: sub_1402720A0+751↑j
                xor     r10d, r10d
                jmp     loc_14027251D
; ---------------------------------------------------------------------------

loc_140272F7D:                          ; CODE XREF: sub_1402720A0+497↑j
                mov     ecx, r8d
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------
                align 2

loc_140272F86:                          ; CODE XREF: sub_1402720A0+CB7↑j
                mov     rdx, rbx
                mov     rcx, rdi
                call    sub_1403F8778
                jmp     loc_140272D5D
; ---------------------------------------------------------------------------

loc_140272F96:                          ; CODE XREF: sub_1402720A0+574↑j
                mov     rcx, [rdi+0B8h]
                call    sub_140245840
                jmp     loc_14027261F
; ---------------------------------------------------------------------------

loc_140272FA7:                          ; CODE XREF: sub_1402720A0+65C↑j
                test    al, 1
                jz      loc_140272702
                mov     rax, cr8
                cmp     al, 0Fh
                ja      loc_140272702
                cmp     dil, 0Fh
                ja      loc_140272702
                cmp     al, 2
                jb      loc_140272702
                mov     r10, gs:20h
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                lea     ecx, [rdi+1]
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                not     eax
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     loc_140272702
                mov     rcx, r10
                call    sub_1403F2EC4
                jmp     loc_140272702
; ---------------------------------------------------------------------------

loc_14027300D:                          ; CODE XREF: sub_1402720A0+3E5↑j
                mov     rdi, [rsp+108h+var_D0]
                mov     r15, [rsp+108h+arg_38]
                jmp     loc_14027272B
; ---------------------------------------------------------------------------

loc_14027301F:                          ; CODE XREF: sub_1402720A0+B39↑j
                mov     [rsp+108h+var_D8], sil
                xor     r10d, r10d
                jmp     loc_140272733
; ---------------------------------------------------------------------------

loc_14027302C:                          ; CODE XREF: sub_1402720A0+7FD↑j
                call    ExAcquireResourceExclusiveLite
                xor     r10d, r10d
                jmp     loc_1402728AB
; ---------------------------------------------------------------------------

loc_140273039:                          ; CODE XREF: sub_1402720A0+C80↑j
                xor     r10d, r10d
                mov     edi, r10d
                mov     [rsp+108h+var_D0], r10
                mov     [rsp+108h+var_D8], dil
                mov     r15, [rsp+108h+arg_38]
                jmp     loc_140272733
;   } // starts at 140272281
; ---------------------------------------------------------------------------

loc_140273056:                          ; CODE XREF: sub_1402720A0+6A2↑j
                                        ; sub_1402720A0+6AB↑j ...
                cmp     [rsp+108h+var_D4], 0
                jnz     loc_140273111

loc_140273061:                          ; CODE XREF: sub_1402720A0+107D↓j
                mov     rax, [rsp+108h+var_C8]
                test    rax, rax
                jnz     short loc_1402730D1

loc_14027306B:                          ; CODE XREF: sub_1402720A0+1046↓j
                test    r12b, 4
                jnz     loc_1404421EA

loc_140273075:                          ; CODE XREF: sub_1402720A0+1D0156↓j
                cmp     [rsp+108h+var_D8], 0
                jz      loc_140273122
                mov     rax, [rsp+108h+arg_30]
                mov     [rax], rdi
                mov     rcx, [rdi+20h]
                mov     rax, [rsp+108h+arg_40]
                mov     [rax], rcx

loc_14027309A:                          ; CODE XREF: sub_1402720A0+108C↓j
                                        ; sub_1402720A0+1D016F↓j
                movzx   eax, [rsp+108h+var_D8]
                add     rsp, 0D0h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402730B3:                          ; CODE XREF: sub_1402720A0+E2↑j
                mov     rax, cr8
                movzx   r9d, al
                mov     [rsp+108h+var_E8], rsi
                mov     r8, rdi
                mov     rdx, rbx
                mov     ecx, 192h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_1402730D1:                          ; CODE XREF: sub_1402720A0+FC9↑j
                mov     rbx, [rax+8]
                lock xadd [rax+10h], esi
                dec     esi
                test    si, si
                jz      short loc_1402730E8

loc_1402730E1:                          ; CODE XREF: sub_1402720A0+105F↓j
                mov     rdi, [rsp+108h+var_D0]
                jmp     short loc_14027306B
; ---------------------------------------------------------------------------

loc_1402730E8:                          ; CODE XREF: sub_1402720A0+103F↑j
                mov     rcx, [rbx+0B8h]
                test    rcx, rcx
                jnz     loc_1404421DA

loc_1402730F8:                          ; CODE XREF: sub_1402720A0+1D0145↓j
                lock dec dword ptr [rbx+220h]
                jmp     short loc_1402730E1
; ---------------------------------------------------------------------------

loc_140273101:                          ; CODE XREF: sub_1402720A0+1BA↑j
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_1402F5E40
                jmp     loc_140272260
; ---------------------------------------------------------------------------

loc_140273111:                          ; CODE XREF: sub_1402720A0+FBB↑j
                lea     rcx, [r13+118h]
                call    KeReleaseGuardedMutex
                jmp     loc_140273061
; ---------------------------------------------------------------------------

loc_140273122:                          ; CODE XREF: sub_1402720A0+FDA↑j
                mov     qword ptr [r15], 0
                test    rdi, rdi
                jz      loc_14027309A
                jmp     loc_1404421FB
; ---------------------------------------------------------------------------

loc_140273137:                          ; CODE XREF: sub_1402720A0+1A7↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_14027224D
; ---------------------------------------------------------------------------

loc_140273141:                          ; CODE XREF: sub_1402720A0+126↑j
                lock bts dword ptr [rbx+78h], 10h
                jmp     loc_14027221D
; ---------------------------------------------------------------------------

loc_14027314C:                          ; CODE XREF: sub_1402720A0+F5↑j
                cmp     [rbx+366h], sil
                jz      short loc_140273168
                mov     eax, esi
                xchg    al, [rbx+366h]
                or      al, [rbx+318h]
                jmp     loc_14027219B
; ---------------------------------------------------------------------------

loc_140273168:                          ; CODE XREF: sub_1402720A0+10B3↑j
                test    dword ptr cs:xmmword_140CFC480+4, 200h
                jz      loc_1402721C3
                jmp     loc_1404421B7
; } // starts at 1402720A0
sub_1402720A0   endp ; sp-analysis failed

; ---------------------------------------------------------------------------
byte_14027317D  db 13h dup(0CCh)        ; DATA XREF: .rdata:000000014005D914↑o
                                        ; .pdata:00000001400CE514↑o
; Exported entry  37. CcCopyReadEx

; =============== S U B R O U T I N E =======================================


                public CcCopyReadEx
CcCopyReadEx    proc near               ; CODE XREF: CcCopyRead+1E↓p
                                        ; CcFastCopyRead+31↓p ...

var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = dword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
arg_0           = byte ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_20          = qword ptr  28h
arg_28          = qword ptr  30h
arg_30          = qword ptr  38h

; FUNCTION CHUNK AT 0000000140418950 SIZE 0000001F BYTES
; FUNCTION CHUNK AT 0000000140442232 SIZE 00000034 BYTES

; __unwind { // __C_specific_handler
                mov     [rsp+arg_10], r8d
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 70h
                mov     r14, rdx
                mov     rbx, rcx
                xor     r15d, r15d
                mov     [rsp+0A8h+arg_8], r15d
                mov     rcx, gs:188h
                mov     r11d, [rcx+510h]
                shr     r11d, 9
                and     r11d, 7
                mov     rax, [rcx+220h]
                test    dword ptr [rax+464h], 100000h
                jnz     loc_140273447

loc_1402731E4:                          ; CODE XREF: CcCopyReadEx+2BA↓j
                cmp     r11d, 2
                jb      loc_140273403

loc_1402731EE:                          ; CODE XREF: CcCopyReadEx+27F↓j
                                        ; CcCopyReadEx+28C↓j ...
                mov     [rsp+0A8h+var_68], r15
                mov     rax, [rbx+28h]
                mov     r13, [rax+8]
                mov     rdx, [rbx+30h]
                mov     [rsp+0A8h+var_60], rdx
                mov     edi, 1
                movzx   eax, r9b
                test    r11d, r11d
                cmovnz  edi, eax
                mov     esi, r8d
                mov     rcx, [r14]
                add     rcx, rsi
                cmp     rcx, [r13+8]
                jg      loc_140442248
                mov     r15, [rsp+0A8h+arg_20]
                test    r15, r15
                jz      loc_14044223D
                mov     r12, [rsp+0A8h+arg_30]
                test    dword ptr [rdx], 20000h
                jnz     loc_140273427

loc_14027324B:                          ; CODE XREF: CcCopyReadEx+2B2↓j
                                        ; DATA XREF: .rdata:000000014005D950↑o
;   __try { // __finally(loc_140418950)
                mov     eax, 2ED4h
                mov     ecx, 2ED0h
                test    dil, dil
                cmovz   eax, ecx
                inc     dword ptr gs:[rax]
                mov     rax, gs:188h
                mov     [rsp+0A8h+var_58], rax
                mov     dword ptr [rax+54Ch], 0
                test    r12, r12
                jz      short loc_140273292
                mov     rax, gs:188h
                mov     [rsp+0A8h+var_50], rax
                cmp     r12, rax
                jnz     loc_1402733C1

loc_140273292:                          ; CODE XREF: CcCopyReadEx+E9↑j
                                        ; CcCopyReadEx+24B↓j
                mov     ecx, [rdx]
                shr     ecx, 12h
                and     ecx, 7
                mov     rax, [rsp+0A8h+var_68]
                mov     [rsp+0A8h+var_70], rax
                mov     [rsp+0A8h+var_78], ecx
                lea     rax, [rsp+0A8h+arg_8]
                mov     [rsp+0A8h+var_80], rax
                mov     [rsp+0A8h+var_88], r15
                movzx   r9d, dil
                mov     rdx, [r14]
                mov     rcx, rbx
                call    sub_14065D330
                mov     [rsp+0A8h+arg_0], al
                test    al, al
                jz      loc_14027338B
                mov     rax, gs:188h
                mov     [rsp+0A8h+var_48], rax
                mov     eax, [rax+54Ch]
                add     gs:8144h, eax
                test    dword ptr [r13+98h], 40000000h
                jnz     short loc_140273349
                cmp     [rsp+0A8h+arg_8], 0
                jnz     loc_140273395

loc_14027330F:                          ; CODE XREF: CcCopyReadEx+210↓j
                                        ; CcCopyReadEx+22C↓j
                mov     rax, [rbx+28h]
                mov     r10, [rax+8]
                mov     rax, [rbx+30h]
                mov     rcx, [rax+20h]
                xchg    rcx, [rax+10h]
                mov     rcx, [rax+28h]
                xchg    rcx, [rax+18h]
                mov     rdx, [r14]
                xchg    rdx, [rax+20h]
                mov     rdx, [r14]
                add     rdx, rsi
                xchg    rdx, [rax+28h]
                test    dword ptr [r10+98h], 200000h
                jnz     short loc_140273360

loc_140273349:                          ; CODE XREF: CcCopyReadEx+16F↑j
                                        ; CcCopyReadEx+1E7↓j ...
                mov     rax, [rsp+0A8h+arg_28]
                mov     dword ptr [rax], 0
                mov     [rax+8], rsi
                jmp     loc_1402733E0
; ---------------------------------------------------------------------------

loc_140273360:                          ; CODE XREF: CcCopyReadEx+1B7↑j
                mov     r9d, [rax+18h]
                shr     r9d, 0Ch
                mov     r8d, [rax+20h]
                shr     r8d, 0Ch
                sub     r8d, r9d
                cmp     r8d, 1
                jbe     short loc_140273349
                xor     r8d, r8d
                mov     edx, 200000h
                mov     rcx, r10
                call    sub_1402E5674
                jmp     short loc_140273349
; ---------------------------------------------------------------------------

loc_14027338B:                          ; CODE XREF: CcCopyReadEx+142↑j
                inc     dword ptr gs:2ED8h
                jmp     short loc_1402733E0
; ---------------------------------------------------------------------------

loc_140273395:                          ; CODE XREF: CcCopyReadEx+179↑j
                mov     rax, [rsp+0A8h+var_60]
                mov     eax, [rax]
                bt      eax, 11h
                jb      loc_14027330F
                mov     r9, r12
                mov     r8d, [rsp+0A8h+arg_10]
                mov     rdx, r14
                mov     rcx, rbx
                call    CcScheduleReadAheadEx
                jmp     loc_14027330F
; ---------------------------------------------------------------------------

loc_1402733C1:                          ; CODE XREF: CcCopyReadEx+FC↑j
                lea     rdx, [rsp+0A8h+var_68]
                mov     rcx, r12
                call    sub_1402FBC28
                mov     rdx, [rsp+0A8h+var_60]
                mov     r8d, [rsp+0A8h+arg_10]
                jmp     loc_140273292
;   } // starts at 14027324B
; ---------------------------------------------------------------------------

loc_1402733E0:                          ; CODE XREF: CcCopyReadEx+1CB↑j
                                        ; CcCopyReadEx+203↑j
                                        ; DATA XREF: ...
                mov     rcx, [rsp+0A8h+var_68]
                test    rcx, rcx
                jnz     short loc_14027344F

loc_1402733EA:                          ; CODE XREF: CcCopyReadEx+2C4↓j
                movzx   eax, [rsp+0A8h+arg_0]
                add     rsp, 70h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140273403:                          ; CODE XREF: CcCopyReadEx+58↑j
                mov     rax, gs:188h
                cmp     rcx, rax
                jnz     loc_1402731EE
                cmp     [rcx+550h], r15d
                jz      loc_1402731EE
                jmp     loc_140442232
; ---------------------------------------------------------------------------

loc_140273427:                          ; CODE XREF: CcCopyReadEx+B5↑j
                mov     r9, r12
                mov     rdx, r14
                mov     rcx, rbx
                call    CcScheduleReadAheadEx
                mov     rdx, [rsp+0A8h+var_60]
                mov     r8d, [rsp+0A8h+arg_10]
                jmp     loc_14027324B
; ---------------------------------------------------------------------------

loc_140273447:                          ; CODE XREF: CcCopyReadEx+4E↑j
                mov     r11d, r15d
                jmp     loc_1402731E4
; ---------------------------------------------------------------------------

loc_14027344F:                          ; CODE XREF: CcCopyReadEx+258↑j
                call    sub_140319B24
                jmp     short loc_1402733EA
; } // starts at 140273190
CcCopyReadEx    endp ; sp-analysis failed

; ---------------------------------------------------------------------------
algn_140273456:                         ; DATA XREF: .rdata:000000014005D964↑o
                                        ; .pdata:00000001400CE520↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140273460   proc near               ; CODE XREF: CcPinMappedData+105↓p
                                        ; sub_14065D330+132↓p ...

; FUNCTION CHUNK AT 0000000140442266 SIZE 00000010 BYTES

                push    rbx
                sub     rsp, 20h
                mov     rbx, [rcx+8]
                mov     eax, 0FFFFFFFFh
                lock xadd [rcx+10h], eax
                dec     eax
                test    ax, ax
                jnz     short loc_140273492
                mov     rcx, [rbx+0B8h]
                test    rcx, rcx
                jnz     loc_140442266

loc_14027348B:                          ; CODE XREF: sub_140273460+1CEE11↓j
                lock dec dword ptr [rbx+220h]

loc_140273492:                          ; CODE XREF: sub_140273460+19↑j
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140273460   endp

algn_140273499:                         ; DATA XREF: .rdata:000000014005DA20↑o
                                        ; .pdata:00000001400CE52C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402734A0   proc near               ; CODE XREF: sub_14065D330+DB↓p
                                        ; CcMdlRead+114↓p
                                        ; DATA XREF: ...

var_38          = dword ptr -38h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_20          = qword ptr  28h
arg_28          = qword ptr  30h
arg_30          = dword ptr  38h
arg_38          = qword ptr  40h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 40h
                mov     r10, [rdx]
                mov     r14, rcx
                mov     eax, r8d
                mov     rbx, r10
                and     rbx, 0FFFFFFFFFFFFF000h
                mov     ecx, 40000h
                mov     rdi, rbx
                mov     rdx, rbx
                lea     rbp, [r10+0FFFh]
                and     edi, 3FFFFh
                add     rbp, rax
                movzx   r15d, r9b
                mov     rax, [rsp+58h+arg_28]
                and     rbp, 0FFFFFFFFFFFFF000h
                sub     rbp, rbx
                add     rdi, [rax]
                mov     eax, edi
                and     eax, 3FFFFh
                sub     ecx, eax
                cmp     ecx, ebp
                cmovnb  ecx, ebp
                mov     esi, ecx
                mov     r8d, ecx
                mov     rcx, r14
                call    sub_14065D4F0
                test    eax, eax
                jnz     short loc_14027354B

loc_14027351E:                          ; CODE XREF: sub_1402734A0+113↓j
                xor     r9d, r9d
                xor     r8d, r8d
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_140274000
                mov     al, 1

loc_140273531:                          ; CODE XREF: sub_1402734A0+B2↓j
                mov     rbx, [rsp+58h+arg_0]
                mov     rbp, [rsp+58h+arg_8]
                mov     rsi, [rsp+58h+arg_10]
                add     rsp, 40h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027354B:                          ; CODE XREF: sub_1402734A0+7C↑j
                test    r15b, r15b
                jnz     short loc_140273554
                xor     al, al
                jmp     short loc_140273531
; ---------------------------------------------------------------------------

loc_140273554:                          ; CODE XREF: sub_1402734A0+AE↑j
                lea     rax, [rsp+58h+arg_28]
                mov     [rsp+58h+arg_28], 0
                mov     [rsp+58h+var_20], rax
                mov     r9, rbp
                mov     rax, [rsp+58h+arg_38]
                mov     rdx, rbx
                mov     [rsp+58h+var_28], rax
                mov     rcx, r14
                mov     eax, [rsp+58h+arg_30]
                mov     [rsp+58h+var_38], eax
                call    sub_14065EB8C
                mov     rcx, [rsp+58h+arg_28]
                test    rcx, rcx
                jz      short loc_1402735A5
                call    sub_1402A0DD8

loc_1402735A5:                          ; CODE XREF: sub_1402734A0+FE↑j
                mov     rax, [rsp+58h+arg_20]
                mov     dword ptr [rax], 1
                jmp     loc_14027351E
sub_1402734A0   endp

; ---------------------------------------------------------------------------
algn_1402735B8:                         ; DATA XREF: .pdata:00000001400CE538↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402735C0   proc near               ; CODE XREF: sub_140262F40+9E↑p
                                        ; sub_14029E340+EA↓p ...

var_B8          = byte ptr -0B8h
var_98          = word ptr -98h
var_94          = dword ptr -94h
var_28          = byte ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140442276 SIZE 000002DE BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                push    rsi
                push    rdi
                push    r12
                push    r14
                push    r15
                sub     rsp, 0B0h
                mov     rdi, rcx
                xor     esi, esi
                mov     rcx, rdx
                mov     r15, r8
                shr     rcx, 0Ch
                mov     rbp, rdx
                mov     [r8], rcx
                mov     eax, [rdi+38h]
                lea     r12, [rsi-1]
                test    al, 20h
                jnz     loc_140273835
                cmp     [rdi+40h], rsi
                jz      loc_140273835
                bt      eax, 0Ah
                jb      loc_140273835
                lea     rcx, [rdi+48h]
                call    ExAcquireSpinLockShared
                mov     rcx, [rdi+110h]
                mov     r8d, esi
                movzx   r12d, al
                test    rcx, rcx
                jz      short loc_140273639

loc_14027362D:                          ; CODE XREF: sub_1402735C0+77↓j
                mov     r8, rcx
                mov     rcx, [rcx+8]
                test    rcx, rcx
                jnz     short loc_14027362D

loc_140273639:                          ; CODE XREF: sub_1402735C0+6B↑j
                mov     eax, [r8-14h]
                movzx   edx, word ptr [r8-18h]
                mov     r14d, [r8-0Ch]
                and     rdx, 0FFFFFFFFFFFFFFC0h
                shl     rdx, 1Ah
                or      rdx, rax
                mov     eax, [r8-4]
                and     eax, 3FFFFFFFh
                sub     r14, rax
                add     r14, rdx
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_140442276
                lock and dword ptr [rdi+48h], 0BFFFFFFFh
                lock dec dword ptr [rdi+48h]

loc_140273679:                          ; CODE XREF: sub_1402735C0+1CECC8↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14044228D

loc_140273692:                          ; CODE XREF: sub_1402735C0+1CECD1↓j
                                        ; sub_1402735C0+1CECE0↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404422B1

loc_1402736A0:                          ; CODE XREF: sub_1402735C0+1CECF3↓j
                                        ; sub_1402735C0+1CECFF↓j ...
                mov     cr8, r12
                mov     rcx, [r15]
                mov     r12, 0FFFFFFFFFFFFFFFFh

loc_1402736AE:                          ; CODE XREF: sub_1402735C0+28E↓j
                cmp     rcx, r14
                jnb     loc_1402738E1
                cmp     [rdi+40h], rsi
                jz      loc_140273853
                mov     eax, [rdi+38h]
                test    al, 20h
                jnz     loc_140273895
                xor     edx, edx
                lea     rcx, [rsp+0D8h+var_B8]
                mov     r8d, 90h
                call    memset
                mov     rax, 3FFFFFFFFFF000h
                cmp     rbp, rax
                jnb     loc_140273800

loc_1402736F1:                          ; DATA XREF: .rdata:000000014005DA94↑o
                                        ; .rdata:000000014005DAA8↑o ...
                mov     [rsp+0D8h+arg_0], r13
                mov     r14, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14044231A

loc_140273714:                          ; CODE XREF: sub_1402735C0+1CED5C↓j
                                        ; sub_1402735C0+1CED66↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_14044235B
                mov     r13, gs:20h
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_14044236E

loc_14027373A:                          ; CODE XREF: sub_1402735C0+1CEDB3↓j
                                        ; sub_1402735C0+1CEDC2↓j ...
                prefetchw byte ptr [rdi+48h]
                mov     eax, [rdi+48h]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rdi+48h], ecx
                jnz     loc_1402738BF

loc_140273753:                          ; CODE XREF: sub_1402735C0+31C↓j
                                        ; sub_1402735C0+1CEDA9↓j
                mov     r13, [rdi+120h]
                shr     rbp, 0Ch
                movzx   edx, word ptr [r13+20h]
                mov     eax, [r13+24h]
                and     rdx, 0FFFFFFFFFFFFFFC0h
                mov     r8d, [r13+28h]
                shl     rdx, 1Ah
                or      rdx, rax
                add     r8, rdx
                cmp     word ptr [r13+22h], 10h
                lea     rcx, [r8-1]
                cmovb   r8, rcx
                mov     rcx, rbp
                shr     rcx, 20h
                cmp     rbp, rdx
                jb      loc_140273867
                mov     rcx, rbp
                shr     rcx, 20h
                cmp     rbp, r8
                ja      loc_140273867
                cmp     r14b, 11h
                jz      short loc_1402737F5
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_1404423BE
                lock and dword ptr [rdi+48h], 0BFFFFFFFh
                lock dec dword ptr [rdi+48h]

loc_1402737C6:                          ; CODE XREF: sub_1402735C0+1CEE10↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_1404423D5

loc_1402737DF:                          ; CODE XREF: sub_1402735C0+1CEE19↓j
                                        ; sub_1402735C0+1CEE28↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404423F9

loc_1402737ED:                          ; CODE XREF: sub_1402735C0+1CEE3B↓j
                                        ; sub_1402735C0+1CEE47↓j ...
                movzx   eax, r14b
                mov     cr8, rax

loc_1402737F5:                          ; CODE XREF: sub_1402735C0+1EB↑j
                mov     rsi, r13

loc_1402737F8:                          ; CODE XREF: sub_1402735C0+38E↓j
                                        ; sub_1402735C0+3B3↓j ...
                mov     r13, [rsp+0D8h+arg_0]

loc_140273800:                          ; CODE XREF: sub_1402735C0+12B↑j
                                        ; DATA XREF: .pdata:00000001400CE550↑o ...
                movzx   ecx, word ptr [rsi+20h]
                mov     eax, [rsi+24h]
                and     rcx, 0FFFFFFFFFFFFFFC0h
                shl     rcx, 1Ah
                or      rcx, rax
                sub     [r15], rcx

loc_140273815:                          ; CODE XREF: sub_1402735C0+2A5↓j
                                        ; sub_1402735C0+2E2↓j ...
                mov     rax, rsi

loc_140273818:                          ; CODE XREF: sub_1402735C0+323↓j
                lea     r11, [rsp+0D8h+var_28]
                mov     rbx, [r11+38h]
                mov     rbp, [r11+40h]
                mov     rsp, r11
                pop     r15
                pop     r14
                pop     r12
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140273835:                          ; CODE XREF: sub_1402735C0+37↑j
                                        ; sub_1402735C0+41↑j ...
                mov     rax, [rdi]
                movzx   r14d, word ptr [rax+0Ch]
                mov     eax, [rax+8]
                and     r14d, 3FFh
                shl     r14, 20h
                or      r14, rax
                jmp     loc_1402736AE
; ---------------------------------------------------------------------------

loc_140273853:                          ; CODE XREF: sub_1402735C0+FB↑j
                lea     rcx, [rdi+80h]
                mov     rdx, r15
                call    sub_140266D6C
                mov     rsi, rax
                jmp     short loc_140273815
; ---------------------------------------------------------------------------

loc_140273867:                          ; CODE XREF: sub_1402735C0+1D1↑j
                                        ; sub_1402735C0+1E1↑j
                                        ; DATA XREF: ...
                movzx   eax, [rsp+0D8h+var_98]
                mov     r8, [rdi+110h]
                and     ax, 3Fh
                shl     cx, 6
                or      cx, ax
                mov     [rsp+0D8h+var_94], ebp
                mov     [rsp+0D8h+var_98], cx
                test    r8, r8
                jnz     loc_14044245C
                jmp     loc_1404424D0
; ---------------------------------------------------------------------------

loc_140273895:                          ; CODE XREF: sub_1402735C0+106↑j
                                        ; DATA XREF: .pdata:00000001400CE568↑o ...
                lea     rsi, [rdi+80h]
                mov     edx, [rsi+2Ch]
                cmp     rcx, rdx
                jb      loc_140273815

loc_1402738A8:                          ; CODE XREF: sub_1402735C0+2F8↓j
                sub     rcx, rdx
                mov     [r15], rcx
                mov     rsi, [rsi+10h]
                mov     edx, [rsi+2Ch]
                cmp     rcx, rdx
                jnb     short loc_1402738A8
                jmp     loc_140273815
; ---------------------------------------------------------------------------

loc_1402738BF:                          ; CODE XREF: sub_1402735C0+18D↑j
                                        ; DATA XREF: .pdata:00000001400CE574↑o ...
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_140442396

loc_1402738CF:                          ; CODE XREF: sub_1402735C0+1CEDDB↓j
                                        ; sub_1402735C0+1CEDEA↓j ...
                movzx   edx, r14b
                lea     rcx, [rdi+48h]
                call    sub_140329420
                jmp     loc_140273753
; ---------------------------------------------------------------------------

loc_1402738E1:                          ; CODE XREF: sub_1402735C0+F1↑j
                                        ; DATA XREF: .pdata:00000001400CE580↑o ...
                xor     eax, eax
                jmp     loc_140273818
; ---------------------------------------------------------------------------
                align 10h

loc_1402738F0:                          ; CODE XREF: sub_1402735C0+36F↓j
                                        ; sub_1402735C0+1CEEB4↓j
                                        ; DATA XREF: ...
                movzx   r9d, word ptr [r8-18h]
                mov     eax, [r8-14h]
                and     r9, 0FFFFFFFFFFFFFFC0h
                mov     edx, [r8-10h]
                shl     r9, 1Ah
                or      r9, rax
                add     rdx, r9
                cmp     word ptr [r8-16h], 10h
                lea     rcx, [rdx-1]
                cmovb   rdx, rcx
                cmp     r10, rdx
                ja      short loc_140273928
                cmp     r10, r9
                jnb     short loc_140273936
                mov     r8, [r8]
                jmp     short loc_14027392C
; ---------------------------------------------------------------------------

loc_140273928:                          ; CODE XREF: sub_1402735C0+35C↑j
                mov     r8, [r8+8]

loc_14027392C:                          ; CODE XREF: sub_1402735C0+366↑j
                test    r8, r8
                jnz     short loc_1402738F0
                jmp     loc_1404424D0
; ---------------------------------------------------------------------------

loc_140273936:                          ; CODE XREF: sub_1402735C0+361↑j
                test    r8, r8
                jz      loc_1404424D0
                lea     rsi, [r8-38h]
                mov     [rdi+120h], rsi
                cmp     r14b, 11h
                jz      loc_1402737F8
                lea     rcx, [rdi+48h]
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140442479

loc_14027396B:                          ; CODE XREF: sub_1402735C0+1CEEBB↓j
                                        ; sub_1402735C0+1CEEC7↓j ...
                movzx   eax, r14b
                mov     cr8, rax
                jmp     loc_1402737F8
sub_1402735C0   endp

; ---------------------------------------------------------------------------
algn_140273978:                         ; DATA XREF: .pdata:00000001400CE598↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140273980   proc near               ; CODE XREF: sub_1402720A0+B2↑p
                                        ; sub_1402841E0+2F3↓p ...

var_78          = qword ptr -78h
var_70          = byte ptr -70h
var_68          = dword ptr -68h
var_64          = dword ptr -64h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
arg_0           = dword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h
arg_20          = dword ptr  28h
arg_28          = dword ptr  30h

; FUNCTION CHUNK AT 0000000140442554 SIZE 000001FD BYTES

                mov     [rsp+arg_18], r9
                mov     [rsp+arg_10], r8
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 58h
                mov     r15, [rcx+210h]
                xor     r8d, r8d
                mov     r13d, edx
                mov     [rsp+98h+var_64], r8d
                and     r13d, 3FFFFh
                mov     rbx, rdx
                mov     eax, r13d
                mov     rdi, rdx
                sub     rbx, rax
                mov     r14, rcx
                mov     [rsp+98h+var_60], rbx
                cmp     [rcx+0A8h], r8
                jz      loc_140273ACE
                mov     rax, [rcx+60h]
                and     rax, 0FFFFFFFFFFFFFFF0h
                mov     rsi, [rax+28h]
                mov     rbp, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                lea     r12, [r8-1]
                test    eax, eax
                jnz     loc_140442554

loc_1402739FF:                          ; CODE XREF: sub_140273980+1CEBD6↓j
                                        ; sub_140273980+1CEBE0↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140442598
                mov     rbx, gs:20h
                mov     [rsp+98h+arg_0], r8d
                mov     rcx, [rbx+84B8h]
                test    rcx, rcx
                jnz     loc_1404425AD

loc_140273A2D:                          ; CODE XREF: sub_140273980+1CEC31↓j
                                        ; sub_140273980+1CEC40↓j ...
                lock bts cs:dword_140C4C800, 1Fh
                jb      loc_140273D20

loc_140273A3C:                          ; CODE XREF: sub_140273980+3CA↓j
                mov     edx, cs:dword_140C4C800
                mov     ecx, edx
                btr     ecx, 1Eh
                cmp     ecx, 80000000h
                jnz     loc_1404425FD

loc_140273A54:                          ; CODE XREF: sub_140273980+1CECBA↓j
                mov     rax, [rsi]
                test    rax, rax
                jz      loc_140273DD8
                movzx   edx, word ptr [rax+3Ch]
                mov     rax, cs:qword_140C4E4C8
                and     edx, 3FFh
                mov     rbx, [rax+rdx*8]

loc_140273A75:                          ; CODE XREF: sub_140273980+45F↓j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14044263F
                mov     cs:dword_140C4C800, r8d

loc_140273A89:                          ; CODE XREF: sub_140273980+1CECD6↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14044265B

loc_140273AA2:                          ; CODE XREF: sub_140273980+1CECDF↓j
                                        ; sub_140273980+1CECEE↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140442681

loc_140273AB0:                          ; CODE XREF: sub_140273980+1CED03↓j
                                        ; sub_140273980+1CED0F↓j ...
                movzx   eax, bpl
                mov     cr8, rax
                mov     rax, [rbx+0B0h]
                cmp     r15, [rax+8]
                jnz     loc_1404426E2
                mov     rbx, [rsp+98h+var_60]

loc_140273ACE:                          ; CODE XREF: sub_140273980+4E↑j
                mov     eax, [r14+98h]
                mov     r12d, r8d
                and     eax, 200h
                mov     ebp, 1
                setnz   r12b
                mov     [rsp+98h+arg_8], r12d
                test    eax, eax
                jz      loc_140273C5F

loc_140273AF6:                          ; CODE XREF: sub_140273980+2E7↓j
                cmp     cs:dword_140C4867C, 80h
                mov     esi, ebp
                mov     [rsp+98h+var_68], ebp
                jb      loc_140273DE4

loc_140273B0C:                          ; CODE XREF: sub_140273980+2FF↓j
                                        ; sub_140273980+46F↓j ...
                cmp     rdi, [r14+20h]
                jg      loc_140442733
                xor     edx, edx
                lea     rcx, [r14+68h]
                call    ExAcquirePushLockSharedEx
                cmp     [rsp+98h+arg_28], 0
                jnz     short loc_140273B5C
                mov     ecx, [r14+98h]
                mov     eax, ecx
                and     eax, 800200h
                cmp     eax, 200h
                jz      short loc_140273B5C
                bt      ecx, 1Eh
                jb      short loc_140273B5C
                test    rbx, 0FFFFFh
                jnz     short loc_140273B5C
                cmp     rbx, 100000h
                jge     loc_140273C8A

loc_140273B5C:                          ; CODE XREF: sub_140273980+1A9↑j
                                        ; sub_140273980+1BE↑j ...
                mov     [rsp+98h+var_64], ebp

loc_140273B60:                          ; CODE XREF: sub_140273980+317↓j
                mov     r8, [r14+20h]
                mov     r10, [r14+58h]
                cmp     r8, 2000000h
                jg      loc_140273BFC
                mov     esi, edi
                shr     rsi, 12h
                mov     rsi, [r10+rsi*8]

loc_140273B7F:                          ; CODE XREF: sub_140273980+2AD↓j
                                        ; sub_140273980+2DA↓j
                test    rsi, rsi
                jz      loc_140273C9C
                mov     rax, [rsi+8]
                lock xadd [rsi+10h], ebp
                inc     ebp
                test    bp, bp
                jz      loc_140442711
                cmp     bp, 1
                jnz     short loc_140273BA9
                lock inc dword ptr [rax+220h]

loc_140273BA9:                          ; CODE XREF: sub_140273980+220↑j
                xor     edx, edx
                lea     rcx, [r14+68h]
                call    ExReleasePushLockEx
                mov     rbx, [rsp+98h+var_60]

loc_140273BB9:                          ; CODE XREF: sub_140273980+34E↓j
                                        ; sub_140273980+35B↓j ...
                cmp     [rsp+98h+var_64], 0
                mov     edi, 40000h
                jz      loc_140273D4F

loc_140273BC9:                          ; CODE XREF: sub_140273980+40A↓j
                                        ; sub_140273980+453↓j
                mov     rax, [rsp+98h+arg_10]
                sub     edi, r13d
                mov     ecx, r13d
                mov     [rax], rsi
                mov     rax, [rsp+98h+arg_18]
                mov     [rax], edi
                mov     rax, [rsi]
                add     rax, rcx
                add     rsp, 58h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140273BFC:                          ; CODE XREF: sub_140273980+1EF↑j
                mov     r11, rdi
                xor     edx, edx
                mov     ecx, 19h

loc_140273C06:                          ; CODE XREF: sub_140273980+297↓j
                mov     r9d, ecx
                mov     rax, rbp
                add     ecx, 7
                inc     edx
                shl     rax, cl
                cmp     r8, rax
                jg      short loc_140273C06
                mov     rsi, rdi
                mov     ecx, r9d
                sar     rsi, cl
                mov     rsi, [r10+rsi*8]
                test    rsi, rsi
                jz      short loc_140273C9C

loc_140273C2B:                          ; CODE XREF: sub_140273980+2D8↓j
                test    edx, edx
                jz      loc_140273B7F
                mov     ecx, r9d
                mov     rax, rbp
                shl     rax, cl
                add     r9d, 0FFFFFFF9h
                dec     rax
                mov     ecx, r9d
                and     r11, rax
                dec     edx
                mov     rax, r11
                sar     rax, cl
                mov     rsi, [rsi+rax*8]
                test    rsi, rsi
                jnz     short loc_140273C2B
                jmp     loc_140273B7F
; ---------------------------------------------------------------------------

loc_140273C5F:                          ; CODE XREF: sub_140273980+170↑j
                cmp     [rsp+98h+arg_20], 0
                jnz     loc_140273AF6
                cmp     cs:dword_140C4867C, 80h
                mov     esi, r8d
                mov     [rsp+98h+var_68], r8d
                jnb     loc_140273B0C
                jmp     loc_140273DF5
; ---------------------------------------------------------------------------

loc_140273C8A:                          ; CODE XREF: sub_140273980+1D6↑j
                cmp     rbx, [r14+150h]
                jz      loc_140273B5C
                jmp     loc_140273B60
; ---------------------------------------------------------------------------

loc_140273C9C:                          ; CODE XREF: sub_140273980+202↑j
                                        ; sub_140273980+2A9↑j
                xor     edx, edx
                lea     rcx, [r14+68h]
                call    ExReleasePushLockEx
                mov     r9d, [rsp+98h+var_68]
                mov     r8d, r12d
                mov     rdx, rdi
                mov     rcx, r14
                call    sub_140262B20
                mov     rsi, rax
                mov     eax, [r14+98h]
                and     eax, 8000200h
                cmp     eax, 200h
                jnz     loc_140273BB9
                test    rbx, 0FFFFFh
                jnz     loc_140273BB9
                cmp     rbx, 100000h
                jl      loc_140273BB9
                sub     rbx, 100000h
                mov     [rsp+98h+var_70], 0
                movzx   r9d, bpl
                mov     [rsp+98h+var_60], rbx
                mov     r8d, 100000h
                mov     byte ptr [rsp+98h+var_78], 0
                lea     rdx, [rsp+98h+var_60]
                mov     rcx, r14
                call    sub_140264FD0
                jmp     loc_140273BB9
; ---------------------------------------------------------------------------

loc_140273D20:                          ; CODE XREF: sub_140273980+B6↑j
                mov     rcx, [rbx+84B8h]
                test    rcx, rcx
                jnz     loc_1404425D6

loc_140273D30:                          ; CODE XREF: sub_140273980+1CEC5A↓j
                                        ; sub_140273980+1CEC69↓j ...
                movzx   edx, bpl
                lea     rcx, dword_140C4C800
                call    sub_14028EAE0
                mov     [rsp+98h+arg_0], eax
                xor     r8d, r8d
                jmp     loc_140273A3C
; ---------------------------------------------------------------------------

loc_140273D4F:                          ; CODE XREF: sub_140273980+243↑j
                test    dword ptr [r14+98h], 800000h
                mov     r9b, 1
                mov     [rsp+98h+var_70], 0
                mov     rcx, r14
                mov     byte ptr [rsp+98h+var_78], 0
                jnz     short loc_140273DA2
                mov     r8d, cs:dword_140C0F3CC
                cmp     rbx, r8
                jl      short loc_140273D8F
                sub     rbx, r8
                lea     rdx, [rsp+98h+var_60]
                mov     [rsp+98h+var_60], rbx

loc_140273D85:                          ; CODE XREF: sub_140273980+420↓j
                call    sub_140264FD0
                jmp     loc_140273BC9
; ---------------------------------------------------------------------------

loc_140273D8F:                          ; CODE XREF: sub_140273980+3F6↑j
                mov     [rsp+98h+var_58], 0
                lea     rdx, [rsp+98h+var_58]

loc_140273D9D:                          ; CODE XREF: sub_140273980+435↓j
                mov     r8d, ebx
                jmp     short loc_140273D85
; ---------------------------------------------------------------------------

loc_140273DA2:                          ; CODE XREF: sub_140273980+3EA↑j
                cmp     rbx, 840000h
                jge     short loc_140273DB7
                mov     [rsp+98h+var_50], rdi
                lea     rdx, [rsp+98h+var_50]
                jmp     short loc_140273D9D
; ---------------------------------------------------------------------------

loc_140273DB7:                          ; CODE XREF: sub_140273980+429↑j
                sub     rbx, 800000h
                lea     rdx, [rsp+98h+var_60]
                mov     r8d, 800000h
                mov     [rsp+98h+var_60], rbx
                call    sub_140264FD0
                jmp     loc_140273BC9
; ---------------------------------------------------------------------------

loc_140273DD8:                          ; CODE XREF: sub_140273980+DA↑j
                lea     rbx, unk_140C50C00
                jmp     loc_140273A75
; ---------------------------------------------------------------------------

loc_140273DE4:                          ; CODE XREF: sub_140273980+186↑j
                cmp     dword ptr [r15+398h], 80h
                jnb     loc_140273B0C

loc_140273DF5:                          ; CODE XREF: sub_140273980+305↑j
                call    sub_14037B154
                mov     r12, rax
                test    rax, rax
                jz      short loc_140273E30
                cmp     esi, ebp
                jz      loc_140442700

loc_140273E0A:                          ; CODE XREF: sub_140273980+1CED8C↓j
                mov     ecx, 4
                call    KeAcquireQueuedSpinLock
                mov     rdx, r12
                mov     rcx, r15
                movzx   esi, al
                call    sub_140379EF4
                movzx   edx, sil
                mov     ecx, 4
                call    KeReleaseQueuedSpinLock

loc_140273E30:                          ; CODE XREF: sub_140273980+480↑j
                mov     r12d, [rsp+98h+arg_8]
                xor     r8d, r8d
                jmp     loc_140273B0C
sub_140273980   endp

; ---------------------------------------------------------------------------
byte_140273E40  db 10h dup(0CCh)        ; DATA XREF: .rdata:000000014005DB9C↑o
                                        ; .pdata:00000001400CE5A4↑o

; =============== S U B R O U T I N E =======================================


sub_140273E50   proc near               ; CODE XREF: sub_1402720A0+970↑p
                                        ; sub_1402720A0+B32↑p ...

var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
var_10          = qword ptr -10h
arg_0           = byte ptr  8
arg_8           = qword ptr  10h
arg_10          = byte ptr  18h
arg_18          = dword ptr  20h

                mov     rax, rsp
                mov     [rax+18h], r8b
                push    rbp
                sub     rsp, 50h

loc_140273E5C:                          ; DATA XREF: .rdata:000000014005DBD0↑o
                                        ; .rdata:000000014005DBE4↑o ...
                mov     [rax+10h], rbx
                xor     bpl, bpl
                mov     [rax-10h], rsi
                mov     r11d, 1
                mov     rsi, gs:188h
                mov     [rax-18h], rdi
                mov     [rax-20h], r12
                mov     [rax-28h], r13
                mov     r13d, edx
                mov     [rax-30h], r14
                mov     edx, 2
                mov     ebx, ecx
                mov     r14, r9
                xor     r9d, r9d
                mov     [rax+8], r11b
                mov     rcx, r14
                mov     [rax-38h], r15
                movzx   eax, byte ptr [rsi+51Ch]
                test    r8b, r8b
                mov     r10d, r9d
                cmovnz  edx, r9d
                and     ecx, 0FFFh
                add     rbx, 0FFFh
                mov     [rsp+58h+arg_18], edx
                add     rbx, rcx
                and     r14, 0FFFFFFFFFFFFF000h
                mov     ecx, [rsi+508h]
                shr     rbx, 0Ch
                lea     edi, [rax+rcx*4]
                test    ebx, ebx
                jz      loc_140273F63
                lea     r8d, [r11+0Eh]

loc_140273EE6:                          ; CODE XREF: sub_140273E50+111↓j
                lea     ecx, [rbx-1]
                mov     byte ptr [rsi+51Ch], 1
                cmp     ecx, [rsi+508h]
                ja      loc_140273FD5

loc_140273EFC:                          ; CODE XREF: sub_140273E50+194↓j
                test    r13d, r11d
                mov     r8d, r9d
                setnz   r8b
                test    r13d, r13d
                jnz     loc_140273FC2
                mov     r15d, ebx

loc_140273F12:                          ; CODE XREF: sub_140273E50+180↓j
                mov     eax, r15d
                lea     r9, [rsp+58h+arg_0]
                shl     eax, 0Ch
                or      r8d, edx
                mov     edx, eax
                mov     rcx, r14
                mov     r12d, eax
                call    sub_140274000
                mov     r10d, eax
                cmp     [rsp+58h+arg_0], bpl
                jz      short loc_140273FB5

loc_140273F37:                          ; CODE XREF: sub_140273E50+16A↓j
                test    eax, eax
                js      short loc_140273F66
                mov     edx, [rsp+58h+arg_18]
                mov     eax, 2
                add     r14, r12
                sub     ebx, r15d
                cmp     ebx, 1
                mov     r11d, 4
                cmovnz  r11d, eax
                lea     r9d, [rax-2]
                lea     r8d, [rax+0Dh]
                test    ebx, ebx
                jnz     short loc_140273EE6

loc_140273F63:                          ; CODE XREF: sub_140273E50+8C↑j
                mov     bpl, 1

loc_140273F66:                          ; CODE XREF: sub_140273E50+E9↑j
                                        ; sub_140273E50+170↓j
                mov     r15, [rsp+58h+var_38]
                movzx   eax, dil
                mov     r14, [rsp+58h+var_30]
                and     al, 3
                mov     r13, [rsp+58h+var_28]
                mov     r12, [rsp+58h+var_20]
                mov     rbx, [rsp+58h+arg_8]
                shr     edi, 2
                cmp     [rsp+58h+arg_10], 0
                mov     [rsi+508h], edi
                mov     rdi, [rsp+58h+var_18]
                mov     [rsi+51Ch], al
                mov     rsi, [rsp+58h+var_10]
                jz      short loc_140273FAA

loc_140273FA5:                          ; DATA XREF: .pdata:00000001400CE5BC↑o
                                        ; .pdata:00000001400CE5C8↑o
                test    r10d, r10d
                js      short loc_140273FE9

loc_140273FAA:                          ; CODE XREF: sub_140273E50+153↑j
                movzx   eax, bpl
                add     rsp, 50h
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140273FB5:                          ; CODE XREF: sub_140273E50+E5↑j
                                        ; DATA XREF: .pdata:00000001400CE5C8↑o ...
                cmp     [rsp+58h+arg_10], bpl
                jnz     loc_140273F37
                jmp     short loc_140273F66
; ---------------------------------------------------------------------------

loc_140273FC2:                          ; CODE XREF: sub_140273E50+B9↑j
                cmp     r11d, 2
                mov     r15d, 1
                cmovz   r15d, ecx
                jmp     loc_140273F12
; ---------------------------------------------------------------------------

loc_140273FD5:                          ; CODE XREF: sub_140273E50+A6↑j
                cmp     ecx, 0Fh
                mov     eax, ecx
                cmova   eax, r8d
                mov     [rsi+508h], eax
                jmp     loc_140273EFC
; ---------------------------------------------------------------------------

loc_140273FE9:                          ; CODE XREF: sub_140273E50+158↑j
                                        ; DATA XREF: .pdata:00000001400CE5D4↑o ...
                mov     ecx, r10d
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------
                db 0CCh
sub_140273E50   endp

algn_140273FF2:                         ; DATA XREF: .pdata:00000001400CE5E0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140274000   proc near               ; CODE XREF: sub_1402720A0+740↑p
                                        ; sub_1402734A0+8A↑p ...

var_1A8         = qword ptr -1A8h
var_1A0         = qword ptr -1A0h
var_198         = byte ptr -198h
var_197         = byte ptr -197h
var_194         = dword ptr -194h
var_190         = byte ptr -190h
var_18C         = dword ptr -18Ch
var_188         = qword ptr -188h
var_180         = qword ptr -180h
var_178         = dword ptr -178h
var_170         = qword ptr -170h
var_168         = qword ptr -168h
var_160         = qword ptr -160h
var_158         = qword ptr -158h
var_150         = qword ptr -150h
var_148         = dword ptr -148h
var_144         = dword ptr -144h
var_140         = dword ptr -140h
var_13C         = dword ptr -13Ch
var_138         = qword ptr -138h
var_130         = qword ptr -130h
var_128         = qword ptr -128h
var_120         = qword ptr -120h
var_118         = qword ptr -118h
var_110         = qword ptr -110h
var_108         = qword ptr -108h
var_100         = qword ptr -100h
var_F8          = xmmword ptr -0F8h
var_E8          = qword ptr -0E8h
var_E0          = xmmword ptr -0E0h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_48          = qword ptr -48h

; __unwind { // __GSHandlerCheck
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 190h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+1C8h+var_48], rax
                xor     eax, eax
                mov     [rsp+1C8h+var_E8], r9
                mov     rdi, rcx
                mov     [rsp+1C8h+var_18C], r8d
                xorps   xmm0, xmm0
                mov     [rsp+1C8h+var_138], rax
                mov     r15, rdi
                mov     [rsp+1C8h+var_188], rax
                shr     r15, 9
                xor     ecx, ecx
                mov     r9, 7FFFFFFFF8h
                mov     [rsp+1C8h+var_160], rax
                and     r15, r9
                mov     [rsp+1C8h+var_190], 1
                movups  [rsp+1C8h+var_F8], xmm0
                mov     [rsp+1C8h+var_178], eax
                mov     r12d, eax
                movups  [rsp+1C8h+var_E0], xmm0
                mov     [rsp+1C8h+var_D0], rcx
                mov     r14d, eax
                mov     [rsp+1C8h+var_194], eax
                mov     r13d, eax
                mov     [rsp+1C8h+var_198], 11h
                mov     [rsp+1C8h+var_128], rax
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                lea     rcx, [rdx-1]
                add     r15, rax
                add     rcx, rdi
                mov     [rsp+1C8h+var_180], r15
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                mov     rdx, r15
                add     rcx, rax
                shr     rdx, 9
                and     rdx, r9
                mov     [rsp+1C8h+var_130], rcx
                mov     rax, r8
                add     rdx, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rbx, [rdx]
                mov     rax, rax
                mov     rcx, 0FFFFF6FB7DBED7F8h
                cmp     rdx, rax
                jb      loc_140274183
                mov     rax, rcx
                cmp     rdx, rax
                ja      short loc_140274183
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140274183
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140274183
                test    bl, 1
                jz      short loc_140274183
                test    bl, 20h
                jz      short loc_14027413D
                test    bl, 42h
                jnz     short loc_140274183

loc_14027413D:                          ; CODE XREF: sub_140274000+136↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140274183
                shr     rdx, 3
                and     edx, 1FFh
                mov     rax, [rax+rdx*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140274183
                or      rbx, 42h

loc_140274183:                          ; CODE XREF: sub_140274000+FB↑j
                                        ; sub_140274000+107↑j ...
                lea     rcx, [rsp+1C8h+var_120]
                mov     [rsp+1C8h+var_120], rbx
                call    sub_1402433C0
                test    eax, eax
                jz      loc_140274221
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140274221
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140274221
                test    bl, 1
                jz      short loc_140274221
                test    bl, 20h
                jz      short loc_1402741D4
                test    bl, 42h
                jnz     short loc_140274221

loc_1402741D4:                          ; CODE XREF: sub_140274000+1CD↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140274221
                lea     rax, [rsp+1C8h+var_120]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140274221
                or      rbx, 42h

loc_140274221:                          ; CODE XREF: sub_140274000+19A↑j
                                        ; sub_140274000+1AA↑j ...
                mov     rax, 0FFFFFFFFFh
                shr     rbx, 0Ch
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rsi, [rbx+rbx*2]
                shl     rsi, 4
                mov     rax, rax
                add     rsi, rax
                mov     rdx, rdi
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     [rsp+1C8h+var_158], rsi
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                add     rdx, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rbx, [rdx]
                mov     rax, rax
                cmp     rdx, rax
                jb      loc_140274311
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdx, rax
                ja      short loc_140274311
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140274311
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140274311
                test    bl, 1
                jz      short loc_140274311
                test    bl, 20h
                jz      short loc_1402742CB
                test    bl, 42h
                jnz     short loc_140274311

loc_1402742CB:                          ; CODE XREF: sub_140274000+2C4↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140274311
                shr     rdx, 3
                and     edx, 1FFh
                mov     rax, [rax+rdx*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140274311
                or      rbx, 42h

loc_140274311:                          ; CODE XREF: sub_140274000+27F↑j
                                        ; sub_140274000+295↑j ...
                lea     rcx, [rsp+1C8h+var_118]
                mov     [rsp+1C8h+var_118], rbx
                call    sub_1402433C0
                test    eax, eax
                jz      loc_1402743AF
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_1402743AF
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_1402743AF
                test    bl, 1
                jz      short loc_1402743AF
                test    bl, 20h
                jz      short loc_140274362
                test    bl, 42h
                jnz     short loc_1402743AF

loc_140274362:                          ; CODE XREF: sub_140274000+35B↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_1402743AF
                lea     rax, [rsp+1C8h+var_118]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_1402743AF
                or      rbx, 42h

loc_1402743AF:                          ; CODE XREF: sub_140274000+328↑j
                                        ; sub_140274000+338↑j ...
                shr     rbx, 0Ch
                mov     r10, 0FFFFFFFFFh
                and     rbx, r10
                lea     rax, [rbx+rbx*2]
                add     rax, rax
                mov     rdx, 0FFFFFA8000000010h
                mov     rdx, [rdx+rax*8]
                test    rdx, rdx
                jz      short loc_1402743E9
                shr     rdi, 12h
                and     edi, 7
                lea     rax, [rdi+rdi*4]
                lea     rdx, [rdx+rax*8]

loc_1402743E9:                          ; CODE XREF: sub_140274000+3D8↑j
                mov     rdx, [rdx+18h]
                mov     ebx, 1
                movzx   eax, dl
                mov     rcx, rdx
                and     rcx, 0FFFFFFFFFFFFFFFEh
                and     al, 1
                mov     rax, cs:qword_140C4E4C8
                cmovz   rcx, rdx
                mov     rcx, [rcx]
                mov     [rsp+1C8h+var_100], rcx
                movzx   ecx, word ptr [rcx+3Ch]
                and     ecx, 3FFh
                xor     edi, edi
                mov     rax, [rax+rcx*8]
                mov     [rsp+1C8h+var_108], rax

loc_14027442C:                          ; CODE XREF: sub_140274000+11BB↓j
                                        ; sub_140274000+1B71↓j
                mov     r11, 0FFFFFA8000000028h
                cmp     r15, [rsp+1C8h+var_130]
                ja      loc_140275B76
                mov     rcx, [r15]
                mov     r12d, edi
                mov     rdx, rcx
                mov     r9, 0FFFFF6FB7DBED000h
                mov     rax, r9
                mov     r8, 0FFFFF6FB7DBED7F8h
                cmp     r15, rax
                jb      loc_140274506
                mov     rax, r8
                cmp     r15, rax
                ja      loc_140274506
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_1402744F2
                mov     rax, gs:188h
                mov     r8, [rax+0B8h]
                cmp     byte ptr [r8+390h], 1
                jz      short loc_1402744F2
                test    dl, 1
                jz      short loc_1402744F2
                test    dl, 20h
                jz      short loc_1402744AE
                test    dl, 42h
                jnz     short loc_1402744F2

loc_1402744AE:                          ; CODE XREF: sub_140274000+4A7↑j
                mov     rax, gs:188h
                mov     r8, [rax+0B8h]
                mov     r9, [r8+788h]
                test    r9, r9
                jz      short loc_1402744F2
                or      rdx, 20h
                mov     rax, r15
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r9+rax*8]
                movzx   r8d, al
                and     r8b, 20h
                cmovz   rdx, rcx
                test    al, 42h
                jz      short loc_1402744F2
                or      rdx, 42h

loc_1402744F2:                          ; CODE XREF: sub_140274000+483↑j
                                        ; sub_140274000+49D↑j ...
                mov     r8, 0FFFFF6FB7DBED7F8h
                mov     r9, 0FFFFF6FB7DBED000h

loc_140274506:                          ; CODE XREF: sub_140274000+467↑j
                                        ; sub_140274000+473↑j
                test    dl, 1
                jz      short loc_14027453A
                test    byte ptr [rsp+1C8h+var_18C], 4
                jz      loc_14027581D
                movzx   edx, [rsp+1C8h+var_198]
                cmp     dl, 11h
                jz      short loc_14027452D
                mov     rcx, r13
                call    sub_140297330
                mov     [rsp+1C8h+var_198], 11h

loc_14027452D:                          ; CODE XREF: sub_140274000+51E↑j
                mov     rcx, r15
                call    sub_1402A4E64
                jmp     loc_14027581D
; ---------------------------------------------------------------------------

loc_14027453A:                          ; CODE XREF: sub_140274000+509↑j
                mov     rax, r9
                cmp     r15, rax
                jb      loc_1402745CA
                mov     rax, r8
                cmp     r15, rax
                ja      short loc_1402745CA
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_1402745CA
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_1402745CA
                test    cl, 1
                jz      short loc_1402745CA
                test    cl, 20h
                jz      short loc_140274582
                test    cl, 42h
                jnz     short loc_1402745CA

loc_140274582:                          ; CODE XREF: sub_140274000+57B↑j
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     r8, [rdx+788h]
                test    r8, r8
                jz      short loc_1402745CA
                mov     rax, r15
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rcx
                or      r8, 20h
                movzx   edx, al
                and     dl, 20h
                cmovz   r8, rcx
                mov     rcx, r8
                test    al, 42h
                jz      short loc_1402745CA
                or      rcx, 42h

loc_1402745CA:                          ; CODE XREF: sub_140274000+540↑j
                                        ; sub_140274000+54C↑j ...
                mov     [rsp+1C8h+var_188], rcx
                test    cl, 1
                jz      short loc_140274603
                test    byte ptr [rsp+1C8h+var_18C], 4
                jz      loc_14027581D
                movzx   edx, [rsp+1C8h+var_198]
                cmp     dl, 11h
                jz      short loc_1402745F6
                mov     rcx, r13
                call    sub_140297330
                mov     [rsp+1C8h+var_198], 11h

loc_1402745F6:                          ; CODE XREF: sub_140274000+5E7↑j
                mov     rcx, r15
                call    sub_1402A4E64
                jmp     loc_14027581D
; ---------------------------------------------------------------------------

loc_140274603:                          ; CODE XREF: sub_140274000+5D2↑j
                mov     rax, cs:qword_140C4DDC0
                mov     r12, rcx
                shr     r12, 3
                mov     rbx, r14
                and     r12d, 1
                mov     r14, rcx
                mov     [rsp+1C8h+var_110], r12
                test    rax, rax
                jz      short loc_140274636
                test    cl, 10h
                jnz     short loc_140274636
                mov     r14, rax
                not     r14
                and     r14, rcx

loc_140274636:                          ; CODE XREF: sub_140274000+626↑j
                                        ; sub_140274000+62B↑j
                movzx   edx, [rsp+1C8h+var_198]
                and     rbx, 0FFFFFFFFFFFFF000h
                sar     r14, 10h
                mov     [rsp+1C8h+var_168], r14
                cmp     dl, 11h
                jz      short loc_140274679
                mov     rax, r14
                and     rax, 0FFFFFFFFFFFFF000h
                cmp     rax, rbx
                jz      loc_140274E8E
                mov     rcx, r13
                call    sub_140297330
                mov     r9, 0FFFFF6FB7DBED000h
                mov     [rsp+1C8h+var_198], 11h

loc_140274679:                          ; CODE XREF: sub_140274000+64E↑j
                mov     rax, r14
                and     rax, 0FFFFFFFFFFFFF000h
                cmp     rax, rbx
                jz      short loc_1402746BC
                mov     edx, [rsp+1C8h+var_194]
                test    edx, edx
                jz      short loc_1402746BC
                mov     eax, edx
                mov     r8d, edx
                shl     rax, 3
                lea     rdx, [rsp+1C8h+var_C8]
                mov     rcx, r15
                mov     r9, rsi
                sub     rcx, rax
                call    sub_140271600
                mov     r9, 0FFFFF6FB7DBED000h
                mov     [rsp+1C8h+var_194], edi

loc_1402746BC:                          ; CODE XREF: sub_140274000+685↑j
                                        ; sub_140274000+68D↑j
                mov     rbx, [r14]
                mov     rax, r9
                cmp     r14, rax
                jb      loc_140274759
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r14, rax
                ja      short loc_140274759
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140274759
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140274759
                test    bl, 1
                jz      short loc_140274759
                test    bl, 20h
                jz      short loc_140274711
                test    bl, 42h
                jnz     short loc_140274759

loc_140274711:                          ; CODE XREF: sub_140274000+70A↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140274759
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140274759
                or      rbx, 42h

loc_140274759:                          ; CODE XREF: sub_140274000+6C5↑j
                                        ; sub_140274000+6DB↑j ...
                mov     [rsp+1C8h+var_160], rbx
                test    bl, 1
                jnz     loc_140274936
                bt      rbx, 0Ah
                jb      short loc_140274779
                bt      rbx, 0Bh
                jb      loc_140274936

loc_140274779:                          ; CODE XREF: sub_140274000+76C↑j
                mov     r13, rdi

loc_14027477C:                          ; CODE XREF: sub_140274000+F24↓j
                                        ; sub_140274000+F2F↓j ...
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_140274793
                test    bl, 10h
                jnz     short loc_140274793
                not     rax
                and     rbx, rax

loc_140274793:                          ; CODE XREF: sub_140274000+786↑j
                                        ; sub_140274000+78B↑j
                mov     rcx, [rsp+1C8h+var_100]
                sar     rbx, 10h
                call    sub_1402851C0
                test    eax, eax
                jnz     loc_140275759
                test    byte ptr [rsp+1C8h+var_18C], 1
                jz      loc_140275759
                mov     edx, [rcx+38h]
                lea     r8, [rsp+1C8h+var_F8]
                shr     edx, 14h
                xor     ecx, ecx
                and     edx, 3Fh
                call    sub_1402C68C0
                mov     r8, qword ptr [rsp+1C8h+var_F8]
                mov     eax, 1
                lock xadd [r8], eax
                and     eax, dword ptr [rsp+1C8h+var_F8+8]
                mov     r8d, 2
                mov     edx, dword ptr [rsp+1C8h+var_F8+0Ch]
                mov     rcx, [rsp+1C8h+var_108]
                or      edx, eax
                call    sub_14022ACA0
                mov     r15, rax
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jz      loc_140275754
                lea     rsi, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rsi, 4
                mov     rax, rax
                add     rsi, rax
                lea     rcx, [rsp+1C8h+var_160]
                mov     [rsp+1C8h+var_150], rsi
                call    sub_1402805F0
                shr     rax, 5
                and     eax, 1Fh
                mov     ecx, eax
                call    sub_1402C4570
                mov     edx, eax
                mov     rcx, rsi
                mov     r14d, eax
                call    sub_1402966A0
                movzx   edi, [rsp+1C8h+var_198]
                test    eax, eax
                jz      short loc_14027488E
                cmp     dil, 11h
                jz      short loc_140274876
                movzx   edx, dil
                mov     rcx, r13
                call    sub_140297330
                mov     dil, 11h
                mov     [rsp+1C8h+var_198], dil

loc_140274876:                          ; CODE XREF: sub_140274000+860↑j
                mov     r8d, r14d
                mov     edx, 1
                mov     rcx, r15
                call    sub_1402E5704
                and     qword ptr [rsi+10h], 0FFFFFFFFFFFFFC1Fh

loc_14027488E:                          ; CODE XREF: sub_140274000+85A↑j
                mov     r14, [rsp+1C8h+var_168]
                cmp     dil, 11h
                jnz     loc_140275675
                lea     rdx, [rsp+1C8h+var_198]
                mov     rcx, r14
                call    sub_140299CD0
                mov     r13, rax
                test    rax, rax
                jnz     short loc_1402748EB
                mov     esi, 2
                nop     word ptr [rax+rax+00000000h]

loc_1402748C0:                          ; CODE XREF: sub_140274000+8E4↓j
                xor     r9d, r9d
                xor     r8d, r8d
                mov     rdx, r14
                mov     rcx, rsi
                call    sub_140224260
                lea     rdx, [rsp+1C8h+var_198]
                mov     rcx, r14
                call    sub_140299CD0
                mov     r13, rax
                test    rax, rax
                jz      short loc_1402748C0
                mov     rsi, [rsp+1C8h+var_150]

loc_1402748EB:                          ; CODE XREF: sub_140274000+8B0↑j
                mov     rcx, r14
                call    sub_1402805F0
                mov     [rsp+1C8h+var_160], rax
                test    al, 1
                jnz     short loc_140274912
                bt      rax, 0Bh
                jnb     loc_140275675
                bt      rax, 0Ah
                jb      loc_140275675

loc_140274912:                          ; CODE XREF: sub_140274000+8FA↑j
                movzx   edx, [rsp+1C8h+var_198]
                mov     rcx, r13
                call    sub_140297330
                mov     rcx, rsi
                call    sub_140300264
                mov     r15, [rsp+1C8h+var_180]
                mov     [rsp+1C8h+var_198], 11h
                jmp     loc_14027519F
; ---------------------------------------------------------------------------

loc_140274936:                          ; CODE XREF: sub_140274000+761↑j
                                        ; sub_140274000+773↑j
                mov     rax, 7FFFFFFFF8h
                mov     r12, r14
                shr     r12, 9
                and     r12, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     r12, rax
                nop     word ptr [rax+rax+00h]

loc_140274960:                          ; CODE XREF: sub_140274000+C1A↓j
                mov     rsi, [r12]
                mov     [rsp+1C8h+var_170], rsi
                and     esi, 1
                nop     dword ptr [rax+00h]

loc_140274970:                          ; CODE XREF: sub_140274000+A44↓j
                test    rsi, rsi
                jz      loc_140274C06
                mov     rbx, [rsp+1C8h+var_170]
                bt      rbx, 9
                jb      loc_140274C06
                lea     rcx, [rsp+1C8h+var_170]
                call    sub_1402433C0
                mov     r14d, eax
                test    eax, eax
                jz      short loc_140274A0E
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140274A0E
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140274A0E
                test    bl, 20h
                jz      short loc_1402749C9
                test    bl, 42h
                jnz     short loc_140274A0E

loc_1402749C9:                          ; CODE XREF: sub_140274000+9C2↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     short loc_1402749EC
                mov     rbx, [rsp+1C8h+var_170]
                jmp     short loc_140274A0E
; ---------------------------------------------------------------------------

loc_1402749EC:                          ; CODE XREF: sub_140274000+9E3↑j
                lea     rax, [rsp+1C8h+var_170]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                test    al, 20h
                jz      short loc_140274A06
                or      rbx, 20h

loc_140274A06:                          ; CODE XREF: sub_140274000+A00↑j
                test    al, 42h
                jz      short loc_140274A0E
                or      rbx, 42h

loc_140274A0E:                          ; CODE XREF: sub_140274000+998↑j
                                        ; sub_140274000+9A4↑j ...
                shr     rbx, 0Ch
                mov     r10, 0FFFFFFFFFh
                and     rbx, r10
                mov     rax, 0FFFFFA8000000028h
                lea     rdx, [rbx+rbx*2]
                add     rdx, rdx
                mov     rax, rax
                mov     rcx, [rax+rdx*8]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      loc_140274970
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                lea     r13, [rax+rdx*8]
                mov     r15, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140274AA9
                test    al, 1
                jz      short loc_140274AA9
                cmp     r15b, 0Fh
                ja      short loc_140274AA9
                mov     rax, gs:20h
                movzx   ecx, r15b
                inc     ecx
                mov     r8, [rax+84B8h]
                mov     rax, 0FFFFFFFFFFFFFFFFh
                shl     rax, cl
                and     eax, 4
                mov     edx, [r8+14h]
                or      edx, eax
                mov     [r8+14h], edx

loc_140274AA9:                          ; CODE XREF: sub_140274000+A70↑j
                                        ; sub_140274000+A74↑j ...
                xor     edi, edi
                mov     [rsp+1C8h+var_148], edi
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jnb     short loc_140274AE9
                nop     dword ptr [rax+rax+00h]

loc_140274AC0:                          ; CODE XREF: sub_140274000+AD4↓j
                                        ; sub_140274000+ADD↓j
                lea     rcx, [rsp+1C8h+var_148]
                call    sub_1402C8C70
                mov     rax, [r13+18h]
                test    rax, rax
                js      short loc_140274AC0
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jb      short loc_140274AC0
                mov     r10, 0FFFFFFFFFh

loc_140274AE9:                          ; CODE XREF: sub_140274000+AB9↑j
                mov     rax, [r12]
                mov     [rsp+1C8h+var_170], rax
                test    al, 1
                jz      loc_140274B8F
                bt      rax, 9
                jb      loc_140274B8F
                test    r14d, r14d
                jz      short loc_140274B7F
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140274B7F
                mov     rcx, gs:188h
                mov     rdx, [rcx+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_140274B7F
                test    al, 20h
                jz      short loc_140274B37
                test    al, 42h
                jnz     short loc_140274B7F

loc_140274B37:                          ; CODE XREF: sub_140274000+B31↑j
                mov     rcx, gs:188h
                mov     rdx, [rcx+0B8h]
                mov     r8, [rdx+788h]
                test    r8, r8
                jnz     short loc_140274B5A
                mov     rax, [rsp+1C8h+var_170]
                jmp     short loc_140274B7F
; ---------------------------------------------------------------------------

loc_140274B5A:                          ; CODE XREF: sub_140274000+B51↑j
                lea     rcx, [rsp+1C8h+var_170]
                shr     rcx, 3
                and     ecx, 1FFh
                mov     rcx, [r8+rcx*8]
                test    cl, 20h
                jz      short loc_140274B76
                or      rax, 20h

loc_140274B76:                          ; CODE XREF: sub_140274000+B70↑j
                test    cl, 42h
                jz      short loc_140274B7F
                or      rax, 42h

loc_140274B7F:                          ; CODE XREF: sub_140274000+B08↑j
                                        ; sub_140274000+B14↑j ...
                shr     rax, 0Ch
                and     rax, r10
                cmp     rbx, rax
                jz      loc_140274C1F

loc_140274B8F:                          ; CODE XREF: sub_140274000+AF4↑j
                                        ; sub_140274000+AFF↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax
                cmp     r15b, 11h
                jz      short loc_140274C06
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140274BFE
                test    al, 1
                jz      short loc_140274BFE
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140274BFE
                cmp     r15b, 0Fh
                ja      short loc_140274BFE
                cmp     al, 2
                jb      short loc_140274BFE
                mov     r10, gs:20h
                mov     rax, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r15b
                inc     ecx
                shl     rax, cl
                mov     r9, [r10+84B8h]
                movzx   edx, ax
                not     edx
                mov     r8d, [r9+14h]
                and     r8d, edx
                mov     [r9+14h], r8d
                jnz     short loc_140274BFE
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140274BFE:                          ; CODE XREF: sub_140274000+BAC↑j
                                        ; sub_140274000+BB0↑j ...
                movzx   eax, r15b
                mov     cr8, rax

loc_140274C06:                          ; CODE XREF: sub_140274000+973↑j
                                        ; sub_140274000+983↑j ...
                mov     rdx, [rsp+1C8h+var_168]
                xor     r9d, r9d
                xor     r8d, r8d
                lea     ecx, [r9+2]
                call    sub_140224260
                jmp     loc_140274960
; ---------------------------------------------------------------------------

loc_140274C1F:                          ; CODE XREF: sub_140274000+B89↑j
                mov     rcx, r13
                call    sub_140275EA0
                test    eax, eax
                jz      loc_140274CF8
                mov     rcx, r13
                xor     r10b, r10b
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_140274C52
                mov     eax, [r13+10h]
                bt      rax, 0Ah
                jnb     short loc_140274C52
                mov     bl, 1
                mov     esi, 1
                jmp     short loc_140274C65
; ---------------------------------------------------------------------------

loc_140274C52:                          ; CODE XREF: sub_140274000+C3C↑j
                                        ; sub_140274000+C47↑j
                call    sub_140279D40
                test    eax, eax
                movzx   ebx, r10b
                mov     esi, 1
                cmovnz  ebx, esi

loc_140274C65:                          ; CODE XREF: sub_140274000+C50↑j
                mov     rcx, [r13+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rdi, [rax+rcx*8]
                test    bl, bl
                jz      short loc_140274C97
                mov     r8d, 4
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_140232160
                test    eax, eax
                jz      short loc_140274CFD

loc_140274C97:                          ; CODE XREF: sub_140274000+C80↑j
                lea     rax, unk_140C50C00
                cmp     rdi, rax
                jnz     short loc_140274CD2
                mov     rdx, gs:20h
                mov     eax, [rdx+831Ch]
                cmp     eax, 1
                jb      short loc_140274CD2

loc_140274CB7:                          ; CODE XREF: sub_140274000+CD0↓j
                mov     ecx, 0FFFFFFFFh
                cmp     eax, ecx
                jz      short loc_140274CD2
                lea     ecx, [rax-1]
                lock cmpxchg [rdx+831Ch], ecx
                jz      short loc_140274CF8
                cmp     eax, 1
                jnb     short loc_140274CB7

loc_140274CD2:                          ; CODE XREF: sub_140274000+CA1↑j
                                        ; sub_140274000+CB5↑j ...
                mov     r8d, 0FFFFFFFFh
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_1403438BC
                test    eax, eax
                jnz     short loc_140274CF8
                test    bl, bl
                jz      short loc_140274CFD
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_14026B700
                jmp     short loc_140274CFD
; ---------------------------------------------------------------------------

loc_140274CF8:                          ; CODE XREF: sub_140274000+C29↑j
                                        ; sub_140274000+CCB↑j ...
                inc     word ptr [r13+20h]

loc_140274CFD:                          ; CODE XREF: sub_140274000+C95↑j
                                        ; sub_140274000+CE9↑j ...
                cmp     r15b, 11h
                jz      loc_140274E4D
                mov     r14, [r13+8]
                mov     rax, 8000000000000000h
                or      r14, rax
                mov     [rsp+1C8h+var_198], r15b
                movzx   eax, byte ptr [r13+22h]
                mov     [rsp+1C8h+var_197], 0
                mov     [rsp+1C8h+var_150], r14
                test    al, 20h
                jz      loc_140274E15
                xor     r12d, r12d
                movzx   esi, r15b
                movzx   edi, r15b
                lea     r14, [r12-1]
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_140274D50:                          ; CODE XREF: sub_140274000+E0A↓j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140274DB2
                test    al, 1
                jz      short loc_140274DB2
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140274DB2
                cmp     r15b, 0Fh
                ja      short loc_140274DB2
                cmp     al, 2
                jb      short loc_140274DB2
                mov     r10, gs:20h
                lea     ecx, [rsi+1]
                mov     rax, r14
                shl     rax, cl
                movzx   edx, ax
                mov     r9, [r10+84B8h]
                not     edx
                mov     r8d, [r9+14h]
                and     r8d, edx
                mov     [r9+14h], r8d
                jnz     short loc_140274DB2
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140274DB2:                          ; CODE XREF: sub_140274000+D67↑j
                                        ; sub_140274000+D6B↑j ...
                mov     cr8, rdi
                movzx   eax, byte ptr [r13+22h]
                mov     ebx, r12d
                mov     [rsp+1C8h+var_197], al
                test    al, 20h
                jz      short loc_140274DFB

loc_140274DC6:                          ; CODE XREF: sub_140274000+DF9↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jnz     short loc_140274DEC
                mov     eax, cs:dword_140CFC41C
                test    al, 40h
                jz      short loc_140274DEC
                call    sub_140390EA0
                test    al, al
                jz      short loc_140274DEC
                mov     ecx, ebx
                call    sub_1403900C0
                jmp     short loc_140274DEE
; ---------------------------------------------------------------------------

loc_140274DEC:                          ; CODE XREF: sub_140274000+DCE↑j
                                        ; sub_140274000+DD8↑j ...
                pause

loc_140274DEE:                          ; CODE XREF: sub_140274000+DEA↑j
                movzx   eax, byte ptr [r13+22h]
                mov     [rsp+1C8h+var_197], al
                test    al, 20h
                jnz     short loc_140274DC6

loc_140274DFB:                          ; CODE XREF: sub_140274000+DC4↑j
                mov     rcx, r13
                call    sub_1402DAA00
                movzx   eax, byte ptr [r13+22h]
                test    al, 20h
                jnz     loc_140274D50
                mov     r14, [rsp+1C8h+var_150]

loc_140274E15:                          ; CODE XREF: sub_140274000+D2E↑j
                or      al, 20h
                mov     [r13+22h], al
                mov     rax, [r13+18h]
                shr     rax, 3Eh
                test    al, 1
                jnz     short loc_140274E3C
                test    byte ptr [r14], 20h
                jnz     short loc_140274E3C
                xor     r8d, r8d
                mov     rcx, r14
                lea     edx, [r8+1]
                call    sub_1402C67E0

loc_140274E3C:                          ; CODE XREF: sub_140274000+E25↑j
                                        ; sub_140274000+E2B↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax
                jmp     short loc_140274E57
; ---------------------------------------------------------------------------

loc_140274E4D:                          ; CODE XREF: sub_140274000+D01↑j
                mov     dl, 11h
                mov     rcx, r13
                call    sub_140299EF0

loc_140274E57:                          ; CODE XREF: sub_140274000+E4B↑j
                mov     rsi, [rsp+1C8h+var_158]
                xor     edi, edi
                mov     r14, [rsp+1C8h+var_168]
                mov     r10, 0FFFFFFFFFh
                mov     r12, [rsp+1C8h+var_110]
                mov     r15, [rsp+1C8h+var_180]
                mov     r11, 0FFFFFA8000000028h
                mov     r9, 0FFFFF6FB7DBED000h

loc_140274E8E:                          ; CODE XREF: sub_140274000+65C↑j
                test    byte ptr [r15], 1
                jnz     loc_140275818
                mov     rbx, [r14]
                mov     rax, r9
                cmp     r14, rax
                jb      short loc_140274F15
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r14, rax
                ja      short loc_140274F15
                call    sub_140349680
                test    eax, eax
                jz      short loc_140274F15
                test    bl, 1
                jz      short loc_140274F15
                test    bl, 20h
                jz      short loc_140274ECD
                test    bl, 42h
                jnz     short loc_140274F15

loc_140274ECD:                          ; CODE XREF: sub_140274000+EC6↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140274F15
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140274F15
                or      rbx, 42h

loc_140274F15:                          ; CODE XREF: sub_140274000+EA1↑j
                                        ; sub_140274000+EB3↑j ...
                mov     [rsp+1C8h+var_160], rbx
                test    bl, 1
                jnz     short loc_140274F35
                bt      rbx, 0Ah
                jb      loc_14027477C
                bt      rbx, 0Bh
                jnb     loc_14027477C

loc_140274F35:                          ; CODE XREF: sub_140274000+F1D↑j
                                        ; sub_140274000+F6C↓j ...
                mov     rbx, [r14]
                test    bl, 1
                jz      short loc_140274F42
                mov     rax, rbx
                jmp     short loc_140274F8B
; ---------------------------------------------------------------------------

loc_140274F42:                          ; CODE XREF: sub_140274000+F3B↑j
                bt      rbx, 0Ah
                jb      loc_14027502C
                bt      rbx, 0Bh
                jnb     loc_14027502C
                test    rbx, rbx
                jz      short loc_140274F6E
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_140274F6E
                test    rax, rbx
                jz      short loc_140274F35

loc_140274F6E:                          ; CODE XREF: sub_140274000+F5B↑j
                                        ; sub_140274000+F67↑j
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_140274F8B
                test    bl, 10h
                jnz     short loc_140274F8B
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_140274F8B:                          ; CODE XREF: sub_140274000+F40↑j
                                        ; sub_140274000+F7B↑j ...
                shr     rax, 0Ch
                and     rax, r10
                lea     rdx, [rax+rax*2]
                add     rdx, rdx
                mov     rax, r11
                mov     rcx, [rax+rdx*8]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      short loc_140274F35
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                lea     rdi, [rax+rdx*8]
                mov     [rsp+1C8h+var_144], 0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_140275013
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_140274FE0:                          ; CODE XREF: sub_140274000+FF4↓j
                                        ; sub_140274000+FFD↓j
                lea     rcx, [rsp+1C8h+var_144]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140274FE0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140274FE0
                mov     r10, 0FFFFFFFFFh
                mov     r11, 0FFFFFA8000000028h

loc_140275013:                          ; CODE XREF: sub_140274000+FD2↑j
                cmp     [r14], rbx
                jz      short loc_14027502E
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                jmp     loc_140274F35
; ---------------------------------------------------------------------------

loc_14027502C:                          ; CODE XREF: sub_140274000+F47↑j
                                        ; sub_140274000+F52↑j
                xor     edi, edi

loc_14027502E:                          ; CODE XREF: sub_140274000+1016↑j
                mov     rbx, [r14]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r14, rax
                jb      short loc_1402750B5
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r14, rax
                ja      short loc_1402750B5
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402750B5
                test    bl, 1
                jz      short loc_1402750B5
                test    bl, 20h
                jz      short loc_14027506D
                test    bl, 42h
                jnz     short loc_1402750B5

loc_14027506D:                          ; CODE XREF: sub_140274000+1066↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_1402750B5
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_1402750B5
                or      rbx, 42h

loc_1402750B5:                          ; CODE XREF: sub_140274000+1041↑j
                                        ; sub_140274000+1053↑j ...
                mov     [rsp+1C8h+var_160], rbx
                test    rdi, rdi
                jz      loc_14027477C
                test    bl, 1
                jz      short loc_14027510B
                test    byte ptr [rdi+23h], 40h
                mov     [rsp+1C8h+var_188], rbx
                jz      short loc_1402750E7

loc_1402750D3:                          ; CODE XREF: sub_140274000+110F↓j
                                        ; sub_140274000+1115↓j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                jmp     loc_140275816
; ---------------------------------------------------------------------------

loc_1402750E7:                          ; CODE XREF: sub_140274000+10D1↑j
                mov     rax, [rdi+18h]
                mov     rdx, 3FFFFFFFFFFFFFFFh
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     rcx, rdx
                xor     rcx, rax
                mov     [rdi+18h], rcx
                jmp     loc_14027565F
; ---------------------------------------------------------------------------

loc_14027510B:                          ; CODE XREF: sub_140274000+10C6↑j
                test    byte ptr [rdi+22h], 20h
                jnz     short loc_1402750D3
                test    byte ptr [rdi+23h], 40h
                jnz     short loc_1402750D3
                mov     rdx, [rdi+10h]
                lea     r12, [rdi+10h]
                mov     rsi, [rsp+1C8h+var_130]
                mov     rcx, rdx
                sub     rsi, r15
                shr     rcx, 3
                sar     rsi, 3
                mov     rax, rdx
                shr     rax, 0Bh
                inc     rsi
                bt      rdx, 0Ah
                cmovnb  rax, rcx
                test    al, 1
                jz      short loc_1402751C0
                mov     r8, rsi
                xor     edx, edx
                mov     rcx, rdi
                call    sub_14055FC70
                mov     rbx, rax
                test    rax, rax
                jz      short loc_1402751C0
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                movzx   edx, [rsp+1C8h+var_198]
                mov     rcx, r13
                call    sub_140297330
                mov     [rsp+1C8h+var_198], 11h
                cmp     rbx, 0FFFFFFFFFFFFFFFFh
                jnz     short loc_14027518F
                call    sub_140560260
                jmp     short loc_14027519F
; ---------------------------------------------------------------------------

loc_14027518F:                          ; CODE XREF: sub_140274000+1186↑j
                mov     rcx, rbx
                call    sub_14055FFFC
                mov     rcx, rbx
                call    sub_14055F7F4

loc_14027519F:                          ; CODE XREF: sub_140274000+931↑j
                                        ; sub_140274000+118D↑j ...
                mov     rsi, [rsp+1C8h+var_158]
                xor     edi, edi
                mov     r12d, [rsp+1C8h+var_194]
                mov     r14d, edi
                mov     r10, 0FFFFFFFFFh
                lea     ebx, [rdi+1]
                jmp     loc_14027442C
; ---------------------------------------------------------------------------

loc_1402751C0:                          ; CODE XREF: sub_140274000+114A↑j
                                        ; sub_140274000+115F↑j
                movzx   eax, byte ptr [rdi+22h]
                and     al, 7
                cmp     al, 2
                jnz     loc_14027532F
                cmp     rsi, 1
                jbe     loc_14027532F
                mov     rcx, rdi
                call    sub_1402D9900
                test    eax, eax
                jz      short loc_1402751FE
                cmp     word ptr [rdi+20h], 0
                jnz     short loc_1402751FE
                mov     rcx, 8000000000000000h
                test    [rdi], rcx
                jnz     loc_14027532F

loc_1402751FE:                          ; CODE XREF: sub_140274000+11E2↑j
                                        ; sub_140274000+11E9↑j
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, [r12]
                test    rcx, rcx
                jz      short loc_140275218
                test    al, 10h
                jnz     short loc_140275218
                not     rcx
                and     rax, rcx

loc_140275218:                          ; CODE XREF: sub_140274000+120C↑j
                                        ; sub_140274000+1210↑j
                sar     rax, 10h
                mov     r15d, 10h
                mov     ecx, [rax+2Ch]
                mov     rax, [rax+8]
                lea     rdx, [rax+rcx*8]
                mov     ecx, r14d
                sub     rdx, r14
                mov     eax, 1000h
                sar     rdx, 3
                cmp     rdx, rsi
                cmovb   rsi, rdx
                and     ecx, 0FFFh
                sub     eax, ecx
                mov     ecx, eax
                shr     rcx, 3
                cmp     rsi, rcx
                cmovbe  rcx, rsi
                sub     r15d, [rsp+1C8h+var_194]
                cmp     rcx, r15
                cmovbe  r15, rcx
                cmp     r15, 1
                jbe     loc_14027532F
                xor     ebx, ebx
                mov     rcx, rdi
                mov     [rsp+1C8h+var_138], rbx
                call    sub_14022FC60
                mov     r14d, eax
                mov     rax, [rsp+1C8h+var_108]
                mov     qword ptr [rsp+1C8h+var_E0], rbx
                lea     rcx, [r14+4Dh]
                lea     rcx, [r14+rcx*4]
                lea     rdx, [rax+rcx*8]
                lea     rcx, [rsp+1C8h+var_E0]
                mov     qword ptr [rsp+1C8h+var_E0+8], rdx
                call    sub_14024B3F0
                lea     edx, [rbx+1]
                mov     rcx, rdi
                call    sub_14022EF40
                mov     esi, eax
                cmp     eax, 1
                jnz     short loc_140275302
                mov     rdx, [rsp+1C8h+var_168]
                lea     rcx, [rsp+1C8h+var_138]
                mov     r9, [rsp+1C8h+var_180]
                lea     rax, [r15-1]
                mov     [rsp+1C8h+var_1A0], rcx
                add     rdx, 8
                mov     r8d, r14d
                mov     [rsp+1C8h+var_1A8], rax
                call    sub_1402D95F0
                mov     rbx, [rsp+1C8h+var_138]
                mov     [rsp+1C8h+var_128], rax

loc_140275302:                          ; CODE XREF: sub_140274000+12C4↑j
                lea     rcx, [rsp+1C8h+var_E0]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                test    rbx, rbx
                jz      short loc_14027533B
                xor     edx, edx
                mov     rcx, rbx
                call    sub_140388B84
                mov     r9, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], r9
                jmp     short loc_140275345
; ---------------------------------------------------------------------------

loc_14027532F:                          ; CODE XREF: sub_140274000+11C8↑j
                                        ; sub_140274000+11D2↑j ...
                xor     edx, edx
                mov     rcx, rdi
                call    sub_14022EF40
                mov     esi, eax

loc_14027533B:                          ; CODE XREF: sub_140274000+1312↑j
                mov     r9, 7FFFFFFFFFFFFFFFh

loc_140275345:                          ; CODE XREF: sub_140274000+132D↑j
                test    esi, esi
                jnz     short loc_14027536C
                xor     edx, edx
                mov     rcx, rdi
                call    sub_140388B84
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                mov     r15, [rsp+1C8h+var_180]
                jmp     loc_14027519F
; ---------------------------------------------------------------------------

loc_14027536C:                          ; CODE XREF: sub_140274000+1347↑j
                movzx   eax, byte ptr [rdi+22h]
                mov     rsi, 8000000000000000h
                mov     r14, [rdi+8]
                and     al, 0FEh
                inc     word ptr [rdi+20h]
                or      al, 6
                mov     [rdi+22h], al
                or      r14, rsi
                mov     r8, [r12]
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rax, r10
                cmp     r12, rax
                jb      short loc_140275416
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r12, rax
                ja      short loc_140275416
                call    sub_140349680
                test    eax, eax
                jz      short loc_140275416
                test    r8b, 1
                jz      short loc_140275416
                test    r8b, 20h
                jz      short loc_1402753CF
                test    r8b, 42h
                jnz     short loc_140275416

loc_1402753CF:                          ; CODE XREF: sub_140274000+13C7↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140275416
                shr     r12, 3
                mov     rdx, r8
                and     r12d, 1FFh
                or      rdx, 20h
                mov     rax, [rax+r12*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_140275416
                or      r8, 42h

loc_140275416:                          ; CODE XREF: sub_140274000+13A0↑j
                                        ; sub_140274000+13B2↑j ...
                movzx   eax, byte ptr [rdi+22h]
                shr     r8, 5
                and     r8d, 7
                shr     eax, 6
                cmp     eax, 1
                jz      short loc_14027543D
                test    eax, eax
                jnz     short loc_140275434
                or      r8d, 8
                jmp     short loc_14027543D
; ---------------------------------------------------------------------------

loc_140275434:                          ; CODE XREF: sub_140274000+142C↑j
                cmp     eax, 2
                jnz     short loc_14027543D
                or      r8d, 18h

loc_14027543D:                          ; CODE XREF: sub_140274000+1428↑j
                                        ; sub_140274000+1432↑j ...
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                mov     rcx, rdi
                mov     r12, 0FFFFF68000000000h
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                lea     rax, qword_140017520
                mov     rbx, [rax+r8*8]
                mov     rax, 0FFFF000000000E7Fh
                and     rbx, rax
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax
                shl     rdx, 0Ch
                or      rbx, rdx
                or      rbx, 21h
                mov     rax, r12
                mov     r15, [rsp+1C8h+var_180]
                cmp     r15, rax
                jb      loc_14027557E
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r15, rax
                ja      loc_14027557E
                mov     rsi, r15
                shl     rsi, 19h
                mov     rax, r12
                shl     rax, 19h
                sub     rsi, rax
                mov     rax, 0FFFFF6FB40000000h
                sar     rsi, 10h
                mov     rax, rax
                cmp     r15, rax
                jb      short loc_140275543
                mov     rax, 0FFFFF6FB7FFFFFFFh
                mov     rax, rax
                cmp     r15, rax
                ja      short loc_140275543
                mov     rax, 0FFFFF6FB7DBEDF68h
                mov     rax, rax
                cmp     r15, rax
                jnz     short loc_140275526
                mov     rax, 8000000000000000h
                or      rbx, rax
                jmp     short loc_140275529
; ---------------------------------------------------------------------------

loc_140275526:                          ; CODE XREF: sub_140274000+1515↑j
                and     rbx, r9

loc_140275529:                          ; CODE XREF: sub_140274000+1524↑j
                mov     rcx, r15
                call    sub_14033FA34
                mov     r10, 0FFFFF6FB7DBED000h
                test    eax, eax
                jz      short loc_140275543
                or      rbx, 4

loc_140275543:                          ; CODE XREF: sub_140274000+14F1↑j
                                        ; sub_140274000+1503↑j ...
                mov     rax, r12
                mov     rcx, 3FFFFFFF78h
                add     rax, rcx
                cmp     r15, rax
                ja      short loc_14027555C
                or      rbx, 4

loc_14027555C:                          ; CODE XREF: sub_140274000+1556↑j
                mov     rcx, rsi
                mov     r8, rbx
                call    sub_140271580
                bts     rbx, 8
                mov     rsi, 8000000000000000h
                test    eax, eax
                cmovz   rbx, r8
                jmp     short loc_140275583
; ---------------------------------------------------------------------------

loc_14027557E:                          ; CODE XREF: sub_140274000+14B0↑j
                                        ; sub_140274000+14C6↑j
                bts     rbx, 8

loc_140275583:                          ; CODE XREF: sub_140274000+157C↑j
                movzx   edx, byte ptr cs:word_140C4DE88
                mov     rax, 0A000000000000h
                and     edx, 1
                or      rdx, rax
                mov     rax, 0FAFFFFFFFFFFFEFFh
                and     rbx, rax
                shl     rdx, 8
                or      rdx, rbx
                mov     rax, r10
                mov     r11, 0FFFFF6FB7DBED7F8h
                cmp     r14, rax
                jb      short loc_140275613
                mov     rax, r11
                cmp     r14, rax
                ja      short loc_140275613
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402755F4
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_1402755DD
                or      rdx, rsi

loc_1402755DD:                          ; CODE XREF: sub_140274000+15D8↑j
                mov     rcx, r14
                mov     [r14], rdx
                call    sub_140349620
                mov     r10, 0FFFFF6FB7DBED000h
                jmp     short loc_140275616
; ---------------------------------------------------------------------------

loc_1402755F4:                          ; CODE XREF: sub_140274000+15CF↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140275613
                or      rdx, rsi

loc_140275613:                          ; CODE XREF: sub_140274000+15BE↑j
                                        ; sub_140274000+15C6↑j ...
                mov     [r14], rdx

loc_140275616:                          ; CODE XREF: sub_140274000+15F2↑j
                mov     rax, [rdi+18h]
                mov     rcx, 0C000000000000001h
                mov     r14, [rsp+1C8h+var_168]
                and     rax, rcx
                or      rax, 1
                mov     [rdi+18h], rax
                mov     rax, [r14]
                mov     rcx, r10
                cmp     r14, rcx
                jb      short loc_140275652
                mov     rcx, r11
                cmp     r14, rcx
                ja      short loc_140275652
                mov     rdx, rax
                mov     rcx, r14
                call    sub_1402A8730

loc_140275652:                          ; CODE XREF: sub_140274000+163D↑j
                                        ; sub_140274000+1645↑j
                mov     r12, [rsp+1C8h+var_110]
                mov     [rsp+1C8h+var_188], rax

loc_14027565F:                          ; CODE XREF: sub_140274000+1106↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                xor     edi, edi
                jmp     loc_1402759DF
; ---------------------------------------------------------------------------

loc_140275675:                          ; CODE XREF: sub_140274000+897↑j
                                        ; sub_140274000+901↑j ...
                mov     rcx, [rsp+1C8h+var_100]
                mov     r8d, 1
                mov     rdx, rbx
                call    sub_14026DA00
                lea     rcx, [rsp+1C8h+var_160]
                call    sub_1402805F0
                mov     rbx, rax
                mov     r9d, 12h
                shr     rbx, 5
                mov     rdx, r14
                and     ebx, 1Fh
                mov     rcx, rsi
                mov     r8d, ebx
                call    sub_1402C4130
                mov     rdx, r15
                bts     ebx, 1Dh
                mov     r15, [rsp+1C8h+var_180]
                mov     r8d, ebx
                mov     rcx, r15
                call    sub_140280E60
                mov     rcx, r14
                mov     [rsp+1C8h+var_188], rax
                mov     rdi, rax
                mov     rbx, rax
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027574A
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027571B
                cmp     byte ptr cs:word_140C4DE88+1, 0
                mov     rdx, rbx
                jnz     short loc_140275709
                test    dil, 1
                jz      short loc_140275709
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_140275709:                          ; CODE XREF: sub_140274000+16F4↑j
                                        ; sub_140274000+16FA↑j
                mov     rcx, r14
                mov     [r14], rdx
                call    sub_140349620
                xor     edi, edi
                jmp     loc_1402759DF
; ---------------------------------------------------------------------------

loc_14027571B:                          ; CODE XREF: sub_140274000+16E8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027574A
                test    dil, 1
                jz      short loc_14027574A
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14027574A:                          ; CODE XREF: sub_140274000+16DF↑j
                                        ; sub_140274000+1735↑j ...
                mov     [r14], rbx
                xor     edi, edi
                jmp     loc_1402759DF
; ---------------------------------------------------------------------------

loc_140275754:                          ; CODE XREF: sub_140274000+80B↑j
                mov     r15, [rsp+1C8h+var_180]

loc_140275759:                          ; CODE XREF: sub_140274000+7A6↑j
                                        ; sub_140274000+7B1↑j
                test    byte ptr [rsp+1C8h+var_18C], 2
                jnz     loc_140275811
                movzx   edx, [rsp+1C8h+var_198]
                cmp     dl, 11h
                jz      short loc_14027577B
                mov     rcx, r13
                call    sub_140297330
                mov     [rsp+1C8h+var_198], 11h

loc_14027577B:                          ; CODE XREF: sub_140274000+176C↑j
                mov     rbx, gs:188h
                movzx   eax, byte ptr [rbx+51Ch]
                mov     ecx, [rbx+508h]
                mov     byte ptr [rbx+51Ch], 1
                lea     edi, [rax+rcx*4]
                mov     rax, [rsp+1C8h+var_130]
                sub     rax, r15
                sar     rax, 3
                cmp     eax, ecx
                jbe     short loc_1402757BF
                cmp     eax, 0Fh
                mov     ecx, 0Fh
                cmova   eax, ecx
                mov     [rbx+508h], eax

loc_1402757BF:                          ; CODE XREF: sub_140274000+17AC↑j
                mov     rdx, r15
                mov     rax, 0FFFFF68000000000h
                shl     rdx, 19h
                mov     rax, rax
                shl     rax, 19h
                xor     r9d, r9d
                sub     rdx, rax
                xor     r8d, r8d
                sar     rdx, 10h
                xor     ecx, ecx
                call    sub_140224260
                test    eax, eax
                jns     short loc_1402757FC
                mov     ecx, [rsp+1C8h+var_178]
                test    ecx, ecx
                cmovns  ecx, eax
                mov     [rsp+1C8h+var_178], ecx

loc_1402757FC:                          ; CODE XREF: sub_140274000+17ED↑j
                movzx   eax, dil
                and     al, 3
                shr     edi, 2
                mov     [rbx+508h], edi
                mov     [rbx+51Ch], al

loc_140275811:                          ; CODE XREF: sub_140274000+175E↑j
                mov     [rsp+1C8h+var_190], 0

loc_140275816:                          ; CODE XREF: sub_140274000+10E2↑j
                xor     edi, edi

loc_140275818:                          ; CODE XREF: sub_140274000+E92↑j
                mov     ebx, 1

loc_14027581D:                          ; CODE XREF: sub_140274000+510↑j
                                        ; sub_140274000+535↑j ...
                mov     rax, rdi

loc_140275820:                          ; CODE XREF: sub_140274000+1B5D↓j
                add     r15, 8
                mov     [rsp+1C8h+var_188], rax
                cmp     r12d, 2
                jb      short loc_140275838
                and     rax, 0FFFFFFFFFFFFFFFEh
                mov     [rsp+1C8h+var_188], rax

loc_140275838:                          ; CODE XREF: sub_140274000+182D↑j
                mov     r12d, [rsp+1C8h+var_194]
                test    r12d, r12d
                jnz     short loc_140275847
                test    rax, rax
                jz      short loc_140275895

loc_140275847:                          ; CODE XREF: sub_140274000+1840↑j
                mov     [rsp+r12*8+1C8h+var_C8], rax
                inc     r12d
                mov     [rsp+1C8h+var_194], r12d
                cmp     r12d, 10h
                jnz     short loc_140275895
                movzx   edx, [rsp+1C8h+var_198]
                cmp     dl, 11h
                jz      short loc_140275874
                mov     rcx, r13
                call    sub_140297330
                mov     [rsp+1C8h+var_198], 11h

loc_140275874:                          ; CODE XREF: sub_140274000+1865↑j
                lea     rcx, [r15-80h]
                mov     r9, rsi
                mov     r8d, 10h
                lea     rdx, [rsp+1C8h+var_C8]
                call    sub_140271600
                mov     r12d, edi
                mov     [rsp+1C8h+var_194], edi

loc_140275895:                          ; CODE XREF: sub_140274000+1845↑j
                                        ; sub_140274000+185B↑j
                mov     rax, [rsp+1C8h+var_128]
                test    rax, rax
                jz      loc_140275B62
                mov     rdx, [r14+8]
                add     r14, 8
                dec     rax
                mov     r9, 0FFFFF6FB7DBED000h
                mov     [rsp+1C8h+var_128], rax
                mov     rax, r9
                mov     rcx, 0FFFFF6FB7DBED7F8h
                cmp     r14, rax
                jb      short loc_140275947
                mov     rax, rcx
                cmp     r14, rax
                ja      short loc_140275947
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027593D
                test    dl, 1
                jz      short loc_14027593D
                test    dl, 20h
                jz      short loc_1402758F5
                test    dl, 42h
                jnz     short loc_14027593D

loc_1402758F5:                          ; CODE XREF: sub_140274000+18EE↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14027593D
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14027593D
                or      rdx, 42h

loc_14027593D:                          ; CODE XREF: sub_140274000+18E4↑j
                                        ; sub_140274000+18E9↑j ...
                mov     rcx, 0FFFFF6FB7DBED7F8h

loc_140275947:                          ; CODE XREF: sub_140274000+18D3↑j
                                        ; sub_140274000+18DB↑j
                mov     [rsp+1C8h+var_188], rdx
                mov     rdx, [r15]
                mov     rax, r9
                cmp     r15, rax
                jb      short loc_1402759BF
                mov     rax, rcx
                cmp     r15, rax
                ja      short loc_1402759BF
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402759BF
                test    dl, 1
                jz      short loc_1402759BF
                test    dl, 20h
                jz      short loc_140275977
                test    dl, 42h
                jnz     short loc_1402759BF

loc_140275977:                          ; CODE XREF: sub_140274000+1970↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_1402759BF
                mov     rax, r15
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_1402759BF
                or      rdx, 42h

loc_1402759BF:                          ; CODE XREF: sub_140274000+1955↑j
                                        ; sub_140274000+195D↑j ...
                mov     [rsp+1C8h+var_120], rdx
                mov     r12d, edi
                test    dl, 1
                jz      short loc_1402759D7
                mov     r12d, 2
                jmp     short loc_1402759DF
; ---------------------------------------------------------------------------

loc_1402759D7:                          ; CODE XREF: sub_140274000+19CD↑j
                test    dl, 8
                jz      short loc_1402759DF
                mov     r12d, ebx

loc_1402759DF:                          ; CODE XREF: sub_140274000+1670↑j
                                        ; sub_140274000+1716↑j ...
                mov     rbx, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140275A2C
                test    al, 1
                jz      short loc_140275A2C
                cmp     bl, 0Fh
                ja      short loc_140275A2C
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, bl
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_140275A2C:                          ; CODE XREF: sub_140274000+19F4↑j
                                        ; sub_140274000+19F8↑j ...
                mov     rsi, [rsp+1C8h+var_158]
                mov     [rsp+1C8h+var_140], edi
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jnb     short loc_140275A60

loc_140275A41:                          ; CODE XREF: sub_140274000+1A55↓j
                                        ; sub_140274000+1A5E↓j
                lea     rcx, [rsp+1C8h+var_140]
                call    sub_1402C8C70
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_140275A41
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_140275A41

loc_140275A60:                          ; CODE XREF: sub_140274000+1A3F↑j
                mov     rdx, [rsi+18h]
                mov     rcx, rdx
                lea     rax, [rdx+1]
                xor     rcx, rax
                mov     rax, 3FFFFFFFFFFFFFFFh
                and     rcx, rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                xor     rcx, rdx
                mov     [rsi+18h], rcx
                lock and [rsi+18h], rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140275AE9
                test    al, 1
                jz      short loc_140275AE9
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140275AE9
                cmp     bl, 0Fh
                ja      short loc_140275AE9
                cmp     al, 2
                jb      short loc_140275AE9
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, bl
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_140275AE9
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140275AE9:                          ; CODE XREF: sub_140274000+1A99↑j
                                        ; sub_140274000+1A9D↑j ...
                movzx   eax, bl
                mov     cr8, rax
                test    r12b, 1
                jz      short loc_140275B24
                lea     rcx, [rsp+1C8h+var_188]
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rdx, 0FFFFFFFFFh
                and     rdx, rax
                mov     r8d, 20000001h
                mov     rcx, r15
                call    sub_140280E60
                mov     rcx, rax
                jmp     short loc_140275B40
; ---------------------------------------------------------------------------

loc_140275B24:                          ; CODE XREF: sub_140274000+1AF4↑j
                test    byte ptr [rsp+1C8h+var_18C], 4
                mov     rcx, [rsp+1C8h+var_188]
                jz      short loc_140275B40
                test    cl, 42h
                jnz     short loc_140275B40
                bt      rcx, 0Bh
                jnb     short loc_140275B40
                or      rcx, 42h

loc_140275B40:                          ; CODE XREF: sub_140274000+1B22↑j
                                        ; sub_140274000+1B2E↑j ...
                movzx   eax, byte ptr cs:word_140C4DE88
                and     rcx, 0FFFFFFFFFFFFFEFBh
                and     eax, 1
                mov     ebx, 1
                shl     rax, 8
                or      rax, rcx
                jmp     loc_140275820
; ---------------------------------------------------------------------------

loc_140275B62:                          ; CODE XREF: sub_140274000+18A0↑j
                mov     [rsp+1C8h+var_180], r15
                mov     r10, 0FFFFFFFFFh
                jmp     loc_14027442C
; ---------------------------------------------------------------------------

loc_140275B76:                          ; CODE XREF: sub_140274000+43E↑j
                cmp     [rsp+1C8h+var_198], 11h
                jz      loc_140275E25
                mov     [rsp+1C8h+var_13C], edi
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jnb     short loc_140275BB0

loc_140275B91:                          ; CODE XREF: sub_140274000+1BA5↓j
                                        ; sub_140274000+1BAE↓j
                lea     rcx, [rsp+1C8h+var_13C]
                call    sub_1402C8C70
                mov     rax, [r13+18h]
                test    rax, rax
                js      short loc_140275B91
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jb      short loc_140275B91

loc_140275BB0:                          ; CODE XREF: sub_140274000+1B8F↑j
                movzx   eax, byte ptr [r13+22h]
                and     al, 0DFh
                mov     [r13+22h], al
                movzx   ebx, word ptr [r13+20h]
                test    bx, bx
                jz      loc_140275E86
                sub     bx, 1
                mov     [r13+20h], bx
                jnz     short loc_140275BE4
                mov     rcx, r13
                call    sub_1402303F0
                test    eax, eax
                jnz     loc_140275D73

loc_140275BE4:                          ; CODE XREF: sub_140274000+1BD2↑j
                mov     rcx, r13
                call    sub_140275EA0
                test    eax, eax
                jz      loc_140275DA9
                mov     r9, 0FFFFF68000000000h
                mov     rax, r9
                mov     rdx, [r13+8]
                mov     r8, 3FFFFFFF78h
                add     r8, rax
                mov     rax, 8000000000000000h
                or      rdx, rax
                cmp     rdx, r8
                ja      short loc_140275C2C
                mov     rax, r9
                cmp     rdx, rax
                jnb     short loc_140275C40

loc_140275C2C:                          ; CODE XREF: sub_140274000+1C22↑j
                movzx   eax, byte ptr [r13+23h]
                test    al, 20h
                jz      short loc_140275C40
                and     al, 0DFh
                mov     [r13+23h], al
                jmp     loc_140275D6E
; ---------------------------------------------------------------------------

loc_140275C40:                          ; CODE XREF: sub_140274000+1C2A↑j
                                        ; sub_140274000+1C33↑j
                mov     rcx, r13
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_140275C62
                mov     eax, [r13+10h]
                bt      rax, 0Ah
                jnb     short loc_140275C62
                mov     r14d, 1
                mov     r12d, r14d
                jmp     short loc_140275CA8
; ---------------------------------------------------------------------------

loc_140275C62:                          ; CODE XREF: sub_140274000+1C4A↑j
                                        ; sub_140274000+1C55↑j
                cmp     rdx, r8
                ja      short loc_140275C81
                mov     rax, r9
                cmp     rdx, rax
                jb      short loc_140275C81
                test    byte ptr [r13+23h], 20h
                jz      short loc_140275C81
                mov     r14d, 1
                mov     r12d, r14d
                jmp     short loc_140275CA8
; ---------------------------------------------------------------------------

loc_140275C81:                          ; CODE XREF: sub_140274000+1C65↑j
                                        ; sub_140274000+1C6D↑j ...
                mov     r14d, 1
                test    bx, bx
                jnz     short loc_140275CA5
                mov     rax, [r13+18h]
                shr     rax, 3Eh
                test    r14b, al
                cmovnz  edi, r14d
                mov     [rsp+1C8h+var_150], rdi
                mov     r12d, edi
                jmp     short loc_140275CA8
; ---------------------------------------------------------------------------

loc_140275CA5:                          ; CODE XREF: sub_140274000+1C8A↑j
                xor     r12d, r12d

loc_140275CA8:                          ; CODE XREF: sub_140274000+1C60↑j
                                        ; sub_140274000+1C7F↑j ...
                mov     rcx, [r13+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rdi, [rax+rcx*8]
                cmp     r12d, 1
                jnz     short loc_140275CD2
                mov     rdx, r14
                mov     rcx, rdi
                call    sub_14026B700

loc_140275CD2:                          ; CODE XREF: sub_140274000+1CC5↑j
                lea     rax, unk_140C50C00
                cmp     rdi, rax
                jnz     loc_140275D60
                mov     r8, gs:20h
                mov     r9d, 0FFFFFFFFh
                movsxd  rdx, dword ptr [r8+831Ch]
                cmp     edx, r9d
                jz      short loc_140275D60
                lea     rax, [rdx+1]
                cmp     rax, 100h
                ja      short loc_140275D34
                nop     dword ptr [rax+00000000h]

loc_140275D10:                          ; CODE XREF: sub_140274000+1D32↓j
                lea     ecx, [rdx+1]
                mov     eax, edx
                lock cmpxchg [r8+831Ch], ecx
                movsxd  rdx, eax
                jz      short loc_140275D69
                cmp     edx, r9d
                jz      short loc_140275D34
                lea     rax, [rdx+1]
                cmp     rax, 100h
                jbe     short loc_140275D10

loc_140275D34:                          ; CODE XREF: sub_140274000+1D07↑j
                                        ; sub_140274000+1D26↑j
                mov     ecx, 0C0h
                cmp     edx, ecx
                jle     short loc_140275D5B
                cmp     edx, r9d
                jz      short loc_140275D5B
                mov     eax, edx
                lock cmpxchg [r8+831Ch], ecx
                jnz     short loc_140275D5B
                lea     eax, [rdx-0C0h]
                movsxd  r14, eax
                inc     r14

loc_140275D5B:                          ; CODE XREF: sub_140274000+1D3B↑j
                                        ; sub_140274000+1D40↑j ...
                test    r14, r14
                jz      short loc_140275D69

loc_140275D60:                          ; CODE XREF: sub_140274000+1CDC↑j
                                        ; sub_140274000+1CFB↑j
                lock xadd [rdi+1C00h], r14

loc_140275D69:                          ; CODE XREF: sub_140274000+1D21↑j
                                        ; sub_140274000+1D5E↑j
                mov     r12d, [rsp+1C8h+var_194]

loc_140275D6E:                          ; CODE XREF: sub_140274000+1C3B↑j
                test    bx, bx
                jnz     short loc_140275DA9

loc_140275D73:                          ; CODE XREF: sub_140274000+1BDE↑j
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                mov     rcx, r13
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rcx, r13
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                call    sub_140278860

loc_140275DA9:                          ; CODE XREF: sub_140274000+1BEE↑j
                                        ; sub_140274000+1D71↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140275E19
                test    al, 1
                jz      short loc_140275E19
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140275E19
                movzx   ebx, [rsp+1C8h+var_198]
                cmp     bl, 0Fh
                ja      short loc_140275E1E
                cmp     al, 2
                jb      short loc_140275E1E
                mov     r9, gs:20h
                mov     rax, 0FFFFFFFFFFFFFFFFh
                mov     r8, [r9+84B8h]
                mov     edx, [r8+14h]
                movzx   ebx, [rsp+1C8h+var_198]
                lea     ecx, [rbx+1]
                shl     rax, cl
                movzx   eax, ax
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_140275E1E
                mov     rcx, r9
                call    sub_1403F2EC4
                jmp     short loc_140275E1E
; ---------------------------------------------------------------------------

loc_140275E19:                          ; CODE XREF: sub_140274000+1DC0↑j
                                        ; sub_140274000+1DC4↑j ...
                movzx   ebx, [rsp+1C8h+var_198]

loc_140275E1E:                          ; CODE XREF: sub_140274000+1DD6↑j
                                        ; sub_140274000+1DDA↑j ...
                movzx   eax, bl
                mov     cr8, rax

loc_140275E25:                          ; CODE XREF: sub_140274000+1B7B↑j
                test    r12d, r12d
                jz      short loc_140275E4A
                mov     edx, r12d
                mov     r9, rsi
                shl     rdx, 3
                mov     r8d, r12d
                sub     r15, rdx
                lea     rdx, [rsp+1C8h+var_C8]
                mov     rcx, r15
                call    sub_140271600

loc_140275E4A:                          ; CODE XREF: sub_140274000+1E28↑j
                mov     rax, [rsp+1C8h+var_E8]
                test    rax, rax
                jz      short loc_140275E5E
                movzx   ecx, [rsp+1C8h+var_190]
                mov     [rax], cl

loc_140275E5E:                          ; CODE XREF: sub_140274000+1E55↑j
                mov     eax, [rsp+1C8h+var_178]
                mov     rcx, [rsp+1C8h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 190h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140275E86:                          ; CODE XREF: sub_140274000+1BC3↑j
                mov     rcx, r13
                call    sub_1403F41EC
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140274000
sub_140274000   endp

algn_140275E8F:                         ; DATA XREF: .pdata:00000001400CE5EC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140275EA0   proc near               ; CODE XREF: sub_14022FC80+515↑p
                                        ; sub_140274000+C22↑p ...
                mov     rax, [rcx+28h]
                mov     rdx, 1000000000h
                test    rdx, rax
                jnz     short loc_140275F1B
                mov     rdx, 2000000000000h
                test    rdx, rax
                jnz     short loc_140275F1B
                mov     rax, [rcx+18h]
                mov     rdx, 3FFFFFFFFFFFFFFFh
                movzx   r8d, word ptr [rcx+20h]
                and     rax, rdx
                xor     edx, edx
                test    r8w, r8w
                jz      short loc_140275EF2
                cmp     r8w, 1
                jnz     short loc_140275EFB
                test    rax, rax
                jnz     short loc_140275EF2
                test    byte ptr [rcx+22h], 8
                jz      short loc_140275F17

loc_140275EF2:                          ; CODE XREF: sub_140275EA0+3E↑j
                                        ; sub_140275EA0+4A↑j
                mov     edx, 1
                mov     eax, edx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140275EFB:                          ; CODE XREF: sub_140275EA0+45↑j
                cmp     r8w, 2
                jnz     short loc_140275F17
                test    rax, rax
                jz      short loc_140275F17
                test    byte ptr [rcx+22h], 8
                mov     ecx, edx
                mov     edx, 1
                cmovnz  ecx, edx
                mov     edx, ecx

loc_140275F17:                          ; CODE XREF: sub_140275EA0+50↑j
                                        ; sub_140275EA0+60↑j ...
                mov     eax, edx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140275F1B:                          ; CODE XREF: sub_140275EA0+11↑j
                                        ; sub_140275EA0+20↑j
                xor     eax, eax
                retn
sub_140275EA0   endp

; ---------------------------------------------------------------------------
                db 0CCh
byte_140275F1F  db 11h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE5F8↑o

; =============== S U B R O U T I N E =======================================


sub_140275F30   proc near               ; CODE XREF: sub_14065D330+11F↓p
                                        ; DATA XREF: .rdata:000000014005DC88↑o ...

var_58          = qword ptr -58h
var_48          = dword ptr -48h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_28          = byte ptr -28h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 0000000140418980 SIZE 0000001A BYTES
; FUNCTION CHUNK AT 0000000140442752 SIZE 00000076 BYTES

; __unwind { // __C_specific_handler
                mov     rax, rsp
                mov     [rax+8], rbx
                mov     [rax+10h], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 50h
                movzx   r15d, r9b
                mov     ebx, r8d
                mov     r14, rdx
                mov     r12, rcx
                xor     edi, edi
                mov     [rax-48h], edi
                mov     r13d, edi
                mov     [rax-38h], rdi
                mov     ecx, edi
                mov     [rsp+78h+var_40], rcx
                mov     [rax+20h], edi
                test    r9b, r9b
                jnz     loc_140442752

loc_140275F74:                          ; CODE XREF: sub_140275F30+9F↓j
                                        ; sub_140275F30+1CC84F↓j ...
                test    ebx, ebx
                jz      short loc_140275FE6
                cmp     ebx, 40000h
                jnb     loc_14027600C
                mov     esi, ebx

loc_140275F86:                          ; CODE XREF: sub_140275F30+E1↓j
                test    r15b, r15b
                jnz     loc_140442791

loc_140275F8F:                          ; DATA XREF: .rdata:000000014005DC74↑o
;   __try { // __except at loc_140275F9F
                mov     r8d, esi
                mov     rdx, r14
                mov     rcx, r12
                call    memmove
                jmp     short loc_140275FB7
;   } // starts at 140275F8F
; ---------------------------------------------------------------------------

loc_140275F9F:                          ; DATA XREF: .rdata:000000014005DC74↑o
;   __except(loc_140418980) // owned by 140275F8F
                mov     ebx, [rsp+78h+var_48]
                cmp     ebx, 0C0000005h
                jnz     short loc_140275FD1
                mov     edi, 0C00000E8h

loc_140275FB0:                          ; CODE XREF: sub_140275F30+B4↓j
                mov     r13, [rsp+78h+var_38]
                jmp     short loc_140275FE6
; ---------------------------------------------------------------------------

loc_140275FB7:                          ; CODE XREF: sub_140275F30+6D↑j
                                        ; sub_140275F30+1CC870↓j
                sub     ebx, esi
                mov     eax, esi
                add     r12, rax
                mov     rcx, [rsp+78h+var_40]
                test    r15b, r15b
                jnz     loc_1404427A5
                add     r14, rax
                jmp     short loc_140275F74
; ---------------------------------------------------------------------------

loc_140275FD1:                          ; CODE XREF: sub_140275F30+79↑j
                mov     ecx, ebx
                call    FsRtlIsNtstatusExpected
                mov     ecx, 0C00000E9h
                test    al, al
                cmovz   ebx, ecx
                mov     edi, ebx
                jmp     short loc_140275FB0
; ---------------------------------------------------------------------------

loc_140275FE6:                          ; CODE XREF: sub_140275F30+46↑j
                                        ; sub_140275F30+85↑j ...
                test    r13, r13
                jnz     loc_1404427B2

loc_140275FEF:                          ; CODE XREF: sub_140275F30+1CC893↓j
                mov     eax, edi
                lea     r11, [rsp+78h+var_28]
                mov     rbx, [r11+30h]
                mov     rsi, [r11+38h]
                mov     rsp, r11
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14027600C:                          ; CODE XREF: sub_140275F30+4E↑j
                mov     esi, 40000h
                jmp     loc_140275F86
; } // starts at 140275F30
sub_140275F30   endp

; ---------------------------------------------------------------------------
algn_140276016:                         ; DATA XREF: .rdata:000000014005DC88↑o
                                        ; .pdata:00000001400CE604↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=0A0h

sub_140276020   proc near               ; CODE XREF: sub_1406E4C50+56↓p
                                        ; MmResetDriverPaging+A0↓p ...

var_180         = qword ptr -180h
var_170         = byte ptr -170h
var_16F         = byte ptr -16Fh
var_16C         = dword ptr -16Ch
var_168         = qword ptr -168h
var_160         = qword ptr -160h
var_158         = dword ptr -158h
var_154         = dword ptr -154h
var_150         = qword ptr -150h
var_148         = dword ptr -148h
var_144         = dword ptr -144h
var_140         = qword ptr -140h
var_138         = qword ptr -138h
var_130         = qword ptr -130h
var_128         = qword ptr -128h
var_120         = qword ptr -120h
var_118         = qword ptr -118h
var_110         = qword ptr -110h
var_100         = dword ptr -100h
var_FC          = word ptr -0FCh
var_FA          = word ptr -0FAh
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = xmmword ptr -0E0h
var_D0          = xmmword ptr -0D0h
var_C0          = xmmword ptr -0C0h
var_B0          = xmmword ptr -0B0h
var_A0          = xmmword ptr -0A0h
var_90          = xmmword ptr -90h
var_80          = xmmword ptr -80h
var_70          = xmmword ptr -70h
var_60          = xmmword ptr -60h
var_50          = qword ptr -50h
var_40          = qword ptr -40h
arg_10          = qword ptr  20h

; __unwind { // __GSHandlerCheck
                mov     [rsp-8+arg_10], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-70h]
                sub     rsp, 170h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+0A0h+var_40], rax
                xorps   xmm0, xmm0
                mov     [rsp+1A0h+var_16C], r9d
                xor     eax, eax
                mov     [rsp+1A0h+var_130], r8
                mov     [rbp+0A0h+var_FA], ax
                mov     rdi, r8
                mov     [rbp+0A0h+var_50], rax
                mov     r12, rdx
                mov     rax, 0FFFFF68000000000h
                mov     r15, rcx
                mov     [rbp+0A0h+var_110], rdx
                mov     [rsp+1A0h+var_128], rcx
                movups  [rbp+0A0h+var_E0], xmm0
                movups  [rbp+0A0h+var_D0], xmm0
                movups  [rbp+0A0h+var_C0], xmm0
                movups  [rbp+0A0h+var_B0], xmm0
                movups  [rbp+0A0h+var_A0], xmm0
                movups  [rbp+0A0h+var_90], xmm0
                movups  [rbp+0A0h+var_80], xmm0
                movups  [rbp+0A0h+var_70], xmm0
                movups  [rbp+0A0h+var_60], xmm0
                mov     rax, rax
                shl     rax, 19h
                mov     rbx, rdx
                shl     rbx, 19h
                sub     rbx, rax
                mov     [rbp+0A0h+var_118], rax
                sar     rbx, 10h
                mov     rcx, rbx
                call    sub_140260090
                test    eax, eax
                jnz     loc_140276A8E
                mov     sil, 1
                xor     r13d, r13d
                mov     rcx, rbx
                mov     [rsp+1A0h+var_170], sil
                mov     [rsp+1A0h+var_154], r13d
                call    sub_140245330
                cmp     eax, 1
                jnz     short loc_14027611F
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+558h]
                mov     [rsp+1A0h+var_138], rdx
                call    sub_1402642FC
                mov     r13d, 2
                mov     [rsp+1A0h+var_150], rax
                mov     [rsp+1A0h+var_154], r13d
                mov     r14, rax
                xor     ebx, ebx
                jmp     short loc_140276149
; ---------------------------------------------------------------------------

loc_14027611F:                          ; CODE XREF: sub_140276020+C5↑j
                xor     ebx, ebx
                mov     [rsp+1A0h+var_138], rbx
                cmp     eax, 6
                jnz     short loc_14027613D
                lea     ecx, [rbx+2]
                call    sub_1402A46FC
                mov     r14, rax
                mov     [rsp+1A0h+var_150], rax
                jmp     short loc_140276149
; ---------------------------------------------------------------------------

loc_14027613D:                          ; CODE XREF: sub_140276020+109↑j
                lea     r14, unk_140C4EFC0
                mov     [rsp+1A0h+var_150], r14

loc_140276149:                          ; CODE XREF: sub_140276020+FD↑j
                                        ; sub_140276020+11B↑j
                xor     cl, cl
                mov     edx, 1
                mov     [rsp+1A0h+var_158], ecx
                test    r15, r15
                jz      short loc_140276179
                cmp     r13d, 2
                jnz     short loc_140276179
                test    dword ptr [r15+68h], 8000000h
                jnz     short loc_140276179
                test    byte ptr cs:dword_140CFB174, dl
                movzx   ecx, cl
                cmovnz  ecx, edx
                mov     [rsp+1A0h+var_158], ecx

loc_140276179:                          ; CODE XREF: sub_140276020+137↑j
                                        ; sub_140276020+13D↑j ...
                mov     rdx, rdi
                mov     rcx, r12
                call    sub_1406EB650
                mov     rcx, r14
                mov     [rsp+1A0h+var_168], 0FFFFFFFFFFFFFFFFh
                mov     [rbp+0A0h+var_F8], 14h
                mov     r15, rbx
                mov     [rbp+0A0h+var_100], r13d
                mov     [rbp+0A0h+var_FC], 0
                mov     [rbp+0A0h+var_F0], rbx
                mov     [rbp+0A0h+var_E8], rbx
                mov     [rsp+1A0h+var_160], rbx
                call    sub_140231340
                movzx   edi, al
                mov     [rsp+1A0h+var_16F], al

loc_1402761BE:                          ; CODE XREF: sub_140276020+9FD↓j
                mov     r8, 0FFFFFA8000000000h
                mov     r10, 1000000000h
                mov     r11, 0FFFFF6FB7DBED7F8h
                mov     r9, 0FFFFFFFFFh
                mov     rcx, 0FFFFF6FB7DBED000h
                mov     rbx, 7FFFFFFFF8h
                test    r15, r15
                jz      short loc_14027621C
                test    r12, 0FFFh
                jnz     short loc_14027627B
                lea     rcx, [rbp+0A0h+var_100]
                call    sub_14028EDB0
                mov     rdx, r15
                mov     rcx, r14
                call    sub_140312B40

loc_14027621C:                          ; CODE XREF: sub_140276020+1DD↑j
                mov     r15, r12
                mov     rax, 0FFFFF68000000000h
                shr     r15, 9
                and     r15, rbx
                mov     rax, rax
                add     r15, rax
                xor     r8d, r8d
                mov     rdx, r15
                mov     [rsp+1A0h+var_160], r15
                mov     rcx, r14
                call    sub_140225CC0
                mov     r11, 0FFFFF6FB7DBED7F8h
                mov     r9, 0FFFFFFFFFh
                mov     rcx, 0FFFFF6FB7DBED000h
                mov     r10, 1000000000h
                mov     r8, 0FFFFFA8000000000h

loc_14027627B:                          ; CODE XREF: sub_140276020+1E6↑j
                mov     rbx, [r12]
                mov     rax, rcx
                cmp     r12, rax
                jb      short loc_1402762F9
                mov     rax, r11
                cmp     r12, rax
                ja      short loc_1402762F9
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402762EF
                test    bl, 1
                jz      short loc_1402762EF
                test    bl, 20h
                jz      short loc_1402762A7
                test    bl, 42h
                jnz     short loc_1402762EF

loc_1402762A7:                          ; CODE XREF: sub_140276020+280↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_1402762EF
                mov     rax, r12
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_1402762EF
                or      rbx, 42h

loc_1402762EF:                          ; CODE XREF: sub_140276020+276↑j
                                        ; sub_140276020+27B↑j ...
                mov     rcx, 0FFFFF6FB7DBED000h

loc_1402762F9:                          ; CODE XREF: sub_140276020+265↑j
                                        ; sub_140276020+26D↑j
                mov     r13, r12
                mov     [rsp+1A0h+var_140], rbx
                shl     r13, 19h
                sub     r13, [rbp+0A0h+var_118]
                sar     r13, 10h
                test    bl, 1
                jnz     short loc_14027635F
                lea     rcx, [rbp+0A0h+var_100]
                call    sub_14028EDB0
                mov     rdx, r15
                mov     rcx, r14
                call    sub_140312B40
                movzx   edx, dil
                mov     rcx, r14
                call    sub_140226960
                xor     r9d, r9d
                xor     r8d, r8d
                mov     rdx, r13
                xor     ecx, ecx
                call    sub_140224260
                test    eax, eax
                js      loc_140276AB8
                xor     r15d, r15d
                mov     rcx, r14
                mov     [rsp+1A0h+var_160], r15
                call    sub_140231340
                jmp     loc_140276A0D
; ---------------------------------------------------------------------------

loc_14027635F:                          ; CODE XREF: sub_140276020+2F0↑j
                mov     rax, rcx
                lea     rcx, [rsp+1A0h+var_140]
                cmp     rcx, rax
                jb      short loc_1402763D5
                mov     rax, r11
                lea     rcx, [rsp+1A0h+var_140]
                cmp     rcx, rax
                ja      short loc_1402763D5
                mov     rsi, rbx
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402763D8
                test    bl, 20h
                jz      short loc_14027638F
                test    bl, 42h
                jnz     short loc_1402763D8

loc_14027638F:                          ; CODE XREF: sub_140276020+368↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_1402763D8
                or      rsi, 20h
                lea     rax, [rsp+1A0h+var_140]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rsi, rbx
                test    al, 42h
                jz      short loc_1402763D8
                or      rsi, 42h
                jmp     short loc_1402763D8
; ---------------------------------------------------------------------------

loc_1402763D5:                          ; CODE XREF: sub_140276020+34A↑j
                                        ; sub_140276020+357↑j
                mov     rsi, rbx

loc_1402763D8:                          ; CODE XREF: sub_140276020+363↑j
                                        ; sub_140276020+36D↑j ...
                shr     rsi, 0Ch
                and     rsi, r9
                lea     rdi, [rsi+rsi*2]
                shl     rdi, 4
                mov     rax, r8
                add     rdi, rax
                mov     rdx, [rdi+28h]
                test    r10, rdx
                jnz     short loc_140276461
                mov     rax, [rdi+8]
                test    rax, rax
                js      short loc_140276461
                jz      short loc_140276461
                lea     rcx, [rbp+0A0h+var_100]
                call    sub_14028EDB0
                xor     r9d, r9d
                mov     rdx, r12
                mov     rcx, r13
                lea     r8, [r9-1]
                call    sub_1402C50E0
                mov     ebx, eax
                test    eax, eax
                jns     loc_140276A03
                mov     rdx, r15
                mov     rcx, r14
                call    sub_140312B40
                movzx   edi, [rsp+1A0h+var_16F]
                mov     rcx, r14
                movzx   edx, dil
                call    sub_140226960
                mov     edx, ebx
                mov     rcx, r14
                call    sub_14055C0F8
                xor     r15d, r15d
                mov     rcx, r14
                mov     [rsp+1A0h+var_160], r15
                call    sub_140231340
                jmp     loc_140276A08
; ---------------------------------------------------------------------------

loc_140276461:                          ; CODE XREF: sub_140276020+3D4↑j
                                        ; sub_140276020+3DD↑j ...
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_1402764D6
                cmp     [rsp+1A0h+var_138], 0
                jz      short loc_14027647C
                cmp     byte ptr [rsp+1A0h+var_158], 1
                jnz     short loc_1402764D6

loc_14027647C:                          ; CODE XREF: sub_140276020+453↑j
                mov     r10d, [rsp+1A0h+var_16C]
                test    r10b, 1
                jz      short loc_1402764DB
                lea     rcx, [rbp+0A0h+var_100]
                call    sub_14028EDB0
                mov     rdx, r15
                mov     rcx, r14
                call    sub_140312B40
                movzx   edi, [rsp+1A0h+var_16F]
                mov     rcx, r14
                movzx   edx, dil
                call    sub_140226960
                xor     r9d, r9d

loc_1402764AF:                          ; CODE XREF: sub_140276020+4F4↓j
                mov     r8, [rsp+1A0h+var_130]
                mov     rdx, r12
                mov     rcx, [rsp+1A0h+var_128]
                call    sub_1402FE404
                xor     r15d, r15d
                mov     rcx, r14
                mov     [rsp+1A0h+var_160], r15
                call    sub_140231340
                jmp     loc_140276A08
; ---------------------------------------------------------------------------

loc_1402764D6:                          ; CODE XREF: sub_140276020+44B↑j
                                        ; sub_140276020+45A↑j
                mov     r10d, [rsp+1A0h+var_16C]

loc_1402764DB:                          ; CODE XREF: sub_140276020+465↑j
                bt      rbx, 0Bh
                jb      short loc_140276516
                bt      rbx, 9
                jnb     short loc_140276516
                lea     rcx, [rbp+0A0h+var_100]
                call    sub_14028EDB0
                mov     rdx, r15
                mov     rcx, r14
                call    sub_140312B40
                movzx   edi, [rsp+1A0h+var_16F]
                mov     rcx, r14
                movzx   edx, dil
                call    sub_140226960
                mov     r9d, 1
                jmp     short loc_1402764AF
; ---------------------------------------------------------------------------

loc_140276516:                          ; CODE XREF: sub_140276020+4C0↑j
                                        ; sub_140276020+4C7↑j
                mov     rax, cs:qword_140C4E4C8
                mov     r8, r13
                shr     rdx, 27h
                xor     ebx, ebx
                and     edx, 3FFh
                shr     r8, 9
                mov     r9, [rax+rdx*8]
                mov     rax, 7FFFFFFFF8h
                and     r8, rax
                mov     [rbp+0A0h+var_120], r9
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     r8, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rdx, [r8]
                mov     rax, rax
                cmp     r8, rax
                jb      short loc_1402765D1
                mov     rax, r11
                cmp     r8, rax
                ja      short loc_1402765D1
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402765D1
                test    dl, 1
                jz      short loc_1402765D1
                test    dl, 20h
                jz      short loc_14027658A
                test    dl, 42h
                jnz     short loc_1402765D1

loc_14027658A:                          ; CODE XREF: sub_140276020+563↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_1402765D1
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_1402765D1
                or      rdx, 42h

loc_1402765D1:                          ; CODE XREF: sub_140276020+548↑j
                                        ; sub_140276020+550↑j ...
                mov     rax, [rsp+1A0h+var_168]
                mov     r15, rdx
                shr     r15, 3Ch
                and     r15b, 7
                shr     rdx, 38h
                shl     r15b, 4
                and     dl, 0Fh
                or      r15b, dl
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jz      short loc_14027663B
                lea     rcx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                add     rcx, rax
                mov     rax, cs:qword_140C4E4C8
                mov     rdx, [rcx+28h]
                shr     rdx, 27h
                and     edx, 3FFh
                cmp     r9, [rax+rdx*8]
                jz      short loc_140276653
                call    sub_140300264
                mov     r10d, [rsp+1A0h+var_16C]
                mov     [rsp+1A0h+var_168], 0FFFFFFFFFFFFFFFFh

loc_14027663B:                          ; CODE XREF: sub_140276020+5D3↑j
                test    r10b, 2
                jz      loc_14027675D
                movzx   eax, r15b
                and     al, 0Fh
                cmp     al, 9
                jnz     loc_140276768

loc_140276653:                          ; CODE XREF: sub_140276020+606↑j
                                        ; sub_140276020+742↓j ...
                mov     [rsp+1A0h+var_148], ebx
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_140276681

loc_140276660:                          ; CODE XREF: sub_140276020+651↓j
                                        ; sub_140276020+65A↓j
                lea     rcx, [rsp+1A0h+var_148]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140276660
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140276660
                mov     r10d, [rsp+1A0h+var_16C]

loc_140276681:                          ; CODE XREF: sub_140276020+63E↑j
                mov     r9, [rsp+1A0h+var_168]
                cmp     r9, 0FFFFFFFFFFFFFFFFh
                jz      loc_140276881
                test    r10b, 2
                jz      loc_140276881
                mov     rdx, r13
                call    sub_1402DECC0
                movzx   ecx, al
                movzx   r15d, al
                and     cl, 0Fh
                cmp     cl, 9
                jz      loc_140276881
                mov     rcx, rdi
                call    sub_1402303F0
                test    eax, eax
                jnz     loc_140276881
                mov     rcx, rdi
                call    sub_1402D9900
                test    eax, eax
                jnz     loc_140276881
                mov     rax, r9
                and     esi, 1FFh
                and     eax, 1FFh
                cmp     rsi, rax
                jnb     loc_140276881
                lea     r14, [r9+r9*2]
                mov     rax, 0FFFFFA8000000000h
                shl     r14, 4
                mov     rax, rax
                add     r14, rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                mov     r8, [rdi+8]
                mov     rax, 8000000000000000h
                mov     rcx, rdi
                or      r8, rax
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_1402767F0
                mov     eax, [rdi+10h]
                bt      rax, 0Ah
                jnb     loc_1402767F0
                xor     edx, edx
                mov     rcx, r8
                call    sub_140299CD0
                mov     rsi, rax
                test    rax, rax
                jz      loc_14027683A
                jmp     loc_1402767F5
; ---------------------------------------------------------------------------

loc_14027675D:                          ; CODE XREF: sub_140276020+61F↑j
                cmp     word ptr [rdi+20h], 1
                jnz     loc_140276653

loc_140276768:                          ; CODE XREF: sub_140276020+62D↑j
                mov     rcx, cs:qword_140C4CB70
                mov     rax, rsi
                and     ecx, 1FFh
                and     eax, 1FFh
                cmp     rax, rcx
                jnb     loc_140276653
                mov     rcx, rdi
                call    sub_1402D9900
                test    eax, eax
                jnz     loc_140276653
                lea     rcx, [rbp+0A0h+var_100]
                call    sub_14028EDB0
                mov     rdx, [rsp+1A0h+var_160]
                mov     rcx, r14
                call    sub_140312B40
                movzx   edx, [rsp+1A0h+var_16F]
                mov     rcx, r14
                call    sub_140226960
                mov     rcx, [rbp+0A0h+var_120]
                xor     r8d, r8d
                xor     edx, edx
                call    sub_1406A709C
                xor     r15d, r15d
                mov     [rsp+1A0h+var_168], rax
                mov     rcx, r14
                mov     [rsp+1A0h+var_160], r15
                mov     rbx, rax
                call    sub_140231340
                movzx   esi, [rsp+1A0h+var_170]
                movzx   edi, al
                mov     [rsp+1A0h+var_16F], al
                jmp     loc_140276A12
; ---------------------------------------------------------------------------

loc_1402767F0:                          ; CODE XREF: sub_140276020+70E↑j
                                        ; sub_140276020+71C↑j
                mov     esi, 1

loc_1402767F5:                          ; CODE XREF: sub_140276020+738↑j
                xor     r9d, r9d
                mov     dword ptr [rsp+1A0h+var_180], 2
                mov     r8, r13
                mov     rdx, r14
                mov     rcx, rdi
                call    sub_1402E4A44
                cmp     eax, 1
                jnz     short loc_14027683A
                mov     rax, cs:qword_14001D278
                lea     rcx, [rdi+10h]
                mov     [rcx], rax
                call    sub_14027C660
                mov     rcx, rdi
                call    sub_140300264
                mov     rdi, r14
                mov     [rsp+1A0h+var_168], 0FFFFFFFFFFFFFFFFh

loc_14027683A:                          ; CODE XREF: sub_140276020+732↑j
                                        ; sub_140276020+7F1↑j
                cmp     rsi, 1
                jbe     short loc_14027684A
                mov     dl, 11h
                mov     rcx, rsi
                call    sub_140297330

loc_14027684A:                          ; CODE XREF: sub_140276020+81E↑j
                mov     [rsp+1A0h+var_144], ebx
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_14027687C
                nop     word ptr [rax+rax+00000000h]

loc_140276860:                          ; CODE XREF: sub_140276020+851↓j
                                        ; sub_140276020+85A↓j
                lea     rcx, [rsp+1A0h+var_144]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140276860
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140276860

loc_14027687C:                          ; CODE XREF: sub_140276020+835↑j
                mov     r14, [rsp+1A0h+var_150]

loc_140276881:                          ; CODE XREF: sub_140276020+66A↑j
                                        ; sub_140276020+674↑j ...
                mov     r9d, [rsp+1A0h+var_16C]
                test    r9b, 2
                jz      short loc_1402768A6
                and     r15b, 0Fh
                cmp     r15b, 9
                jz      short loc_1402768D6
                mov     r8, rdi
                mov     rdx, r12
                mov     rcx, r14
                call    sub_140354D98
                jmp     short loc_1402768D6
; ---------------------------------------------------------------------------

loc_1402768A6:                          ; CODE XREF: sub_140276020+86A↑j
                cmp     [rsp+1A0h+var_154], 2
                mov     rcx, rdi
                jnz     short loc_1402768C5
                xor     edx, edx
                call    sub_140299FD8
                test    eax, eax
                jnz     short loc_1402768D6
                xor     sil, sil
                mov     [rsp+1A0h+var_170], sil
                jmp     short loc_1402768DB
; ---------------------------------------------------------------------------

loc_1402768C5:                          ; CODE XREF: sub_140276020+88E↑j
                call    sub_140275EA0
                test    eax, eax
                jz      short loc_1402768D2
                or      byte ptr [rdi+23h], 20h

loc_1402768D2:                          ; CODE XREF: sub_140276020+8AC↑j
                inc     word ptr [rdi+20h]

loc_1402768D6:                          ; CODE XREF: sub_140276020+874↑j
                                        ; sub_140276020+884↑j ...
                movzx   esi, [rsp+1A0h+var_170]

loc_1402768DB:                          ; CODE XREF: sub_140276020+8A3↑j
                mov     eax, [rdi+10h]
                lea     rcx, [rdi+10h]
                bt      rax, 0Ah
                jb      short loc_14027690D
                movzx   eax, byte ptr [rdi+22h]
                test    al, 10h
                jnz     short loc_14027690D
                test    al, 8
                jnz     short loc_140276908
                xor     r8d, r8d
                lea     edx, [r8+1]
                call    sub_140338C90
                mov     rbx, rax
                movzx   eax, byte ptr [rdi+22h]

loc_140276908:                          ; CODE XREF: sub_140276020+8D3↑j
                or      al, 10h
                mov     [rdi+22h], al

loc_14027690D:                          ; CODE XREF: sub_140276020+8C7↑j
                                        ; sub_140276020+8CF↑j
                mov     rdx, [r12]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r12, rax
                jb      short loc_140276995
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r12, rax
                ja      short loc_140276995
                call    sub_140349680
                test    eax, eax
                jz      short loc_140276995
                test    dl, 1
                jz      short loc_140276995
                test    dl, 20h
                jz      short loc_14027694D
                test    dl, 42h
                jnz     short loc_140276995

loc_14027694D:                          ; CODE XREF: sub_140276020+926↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140276995
                mov     rax, r12
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140276995
                or      rdx, 42h

loc_140276995:                          ; CODE XREF: sub_140276020+901↑j
                                        ; sub_140276020+913↑j ...
                bt      rdx, 0Bh
                jnb     short loc_1402769CA
                test    dl, 42h
                jnz     short loc_1402769CA
                xor     r8d, r8d
                mov     rcx, r12
                lea     edx, [r8+2]
                call    sub_1402C67E0
                mov     r15d, 1
                lea     rcx, [rbp+0A0h+var_100]
                mov     r8d, r15d
                xor     r9d, r9d
                mov     rdx, r13
                call    sub_1402882E0
                jmp     short loc_1402769D0
; ---------------------------------------------------------------------------

loc_1402769CA:                          ; CODE XREF: sub_140276020+97A↑j
                                        ; sub_140276020+97F↑j
                mov     r15d, 1

loc_1402769D0:                          ; CODE XREF: sub_140276020+9A8↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                test    rbx, rbx
                jz      short loc_1402769F3
                mov     rcx, [rbp+0A0h+var_120]
                mov     r8d, r15d
                mov     rdx, rbx
                call    sub_14020B2C0

loc_1402769F3:                          ; CODE XREF: sub_140276020+9C2↑j
                mov     r15, [rsp+1A0h+var_160]
                add     r12, 8
                movzx   edi, [rsp+1A0h+var_16F]
                jmp     short loc_140276A0D
; ---------------------------------------------------------------------------

loc_140276A03:                          ; CODE XREF: sub_140276020+400↑j
                movzx   edi, [rsp+1A0h+var_16F]

loc_140276A08:                          ; CODE XREF: sub_140276020+43C↑j
                                        ; sub_140276020+4B1↑j
                movzx   esi, [rsp+1A0h+var_170]

loc_140276A0D:                          ; CODE XREF: sub_140276020+33A↑j
                                        ; sub_140276020+9E1↑j
                mov     rbx, [rsp+1A0h+var_168]

loc_140276A12:                          ; CODE XREF: sub_140276020+7CB↑j
                cmp     r12, [rsp+1A0h+var_130]
                ja      short loc_140276A23
                cmp     sil, 1
                jz      loc_1402761BE

loc_140276A23:                          ; CODE XREF: sub_140276020+9F7↑j
                cmp     dil, 11h
                jz      short loc_140276A4E
                lea     rcx, [rbp+0A0h+var_100]
                call    sub_14028EDB0
                test    r15, r15
                jz      short loc_140276A42
                mov     rdx, r15
                mov     rcx, r14
                call    sub_140312B40

loc_140276A42:                          ; CODE XREF: sub_140276020+A15↑j
                movzx   edx, dil
                mov     rcx, r14
                call    sub_140226960

loc_140276A4E:                          ; CODE XREF: sub_140276020+A07↑j
                cmp     rbx, 0FFFFFFFFFFFFFFFFh
                jz      short loc_140276A71
                lea     rcx, [rbx+rbx*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                add     rcx, rax
                call    sub_140300264

loc_140276A71:                          ; CODE XREF: sub_140276020+A32↑j
                test    sil, sil
                jnz     short loc_140276A8E
                mov     rcx, [rbp+0A0h+var_110]
                lea     rdx, [r12-10h]
                xor     r8d, r8d
                call    sub_1403A1040
                mov     eax, 0C000009Ah
                jmp     short loc_140276A90
; ---------------------------------------------------------------------------

loc_140276A8E:                          ; CODE XREF: sub_140276020+A4↑j
                                        ; sub_140276020+A54↑j
                xor     eax, eax

loc_140276A90:                          ; CODE XREF: sub_140276020+A6C↑j
                mov     rcx, [rbp+0A0h+var_40]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+1A0h+arg_10]
                add     rsp, 170h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 8

loc_140276AB8:                          ; CODE XREF: sub_140276020+324↑j
                cdqe
                mov     r9, rbx
                mov     r8, r13
                mov     [rsp+1A0h+var_180], rax
                mov     edx, 3000h
                mov     ecx, 1Ah
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140276020
sub_140276020   endp

algn_140276AD5:                         ; DATA XREF: .pdata:00000001400CE610↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140276AE0   proc near               ; CODE XREF: sub_140283C30+28A↓p
                                        ; DATA XREF: .pdata:00000001400CE61C↑o

var_158         = dword ptr -158h
var_148         = byte ptr -148h
var_147         = byte ptr -147h
var_144         = dword ptr -144h
var_140         = dword ptr -140h
var_13C         = dword ptr -13Ch
var_138         = qword ptr -138h
var_130         = qword ptr -130h
var_128         = dword ptr -128h
var_124         = dword ptr -124h
var_120         = dword ptr -120h
var_11C         = dword ptr -11Ch
var_118         = qword ptr -118h
var_110         = qword ptr -110h
var_108         = qword ptr -108h
var_100         = dword ptr -100h
var_FC          = dword ptr -0FCh
var_F8          = dword ptr -0F8h
var_F4          = dword ptr -0F4h
var_F0          = dword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = qword ptr -0D0h
var_C8          = qword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = xmmword ptr -78h
var_68          = xmmword ptr -68h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
arg_20          = byte ptr  28h
arg_28          = qword ptr  30h
arg_30          = qword ptr  38h

; FUNCTION CHUNK AT 00000001404189A0 SIZE 00000024 BYTES

; __unwind { // __GSHandlerCheck_SEH
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 140h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+178h+var_40], rax
                mov     r12, r9
                mov     r13d, r8d
                mov     [rsp+178h+var_A8], rdx
                mov     [rsp+178h+var_110], rcx
                mov     rsi, [rsp+178h+arg_28]
                mov     [rsp+178h+var_C8], rsi
                mov     [rsp+178h+var_B8], rcx
                mov     [rsp+178h+var_B0], rsi
                mov     rax, [rsp+178h+arg_30]
                mov     [rsp+178h+var_C0], rax
                xor     r10d, r10d
                mov     [rsp+178h+var_13C], r10d
                mov     [rsp+178h+var_148], r10b
                xorps   xmm0, xmm0
                movups  [rsp+178h+var_78], xmm0
                movups  [rsp+178h+var_68], xmm0
                mov     [rax], r10d
                mov     r8, [rsi]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     rsi, rax
                jb      loc_140276C15
                mov     rcx, 0FFFFF6FB7DBED7F8h
                mov     rax, rcx
                cmp     rsi, rax
                ja      short loc_140276C15
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140276C15
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_140276C15
                test    r8b, 1
                jz      short loc_140276C15
                test    r8b, 20h
                jz      short loc_140276BCD
                test    r8b, 42h
                jnz     short loc_140276C15

loc_140276BCD:                          ; CODE XREF: sub_140276AE0+E5↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140276C15
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                mov     rdx, r8
                or      rdx, 20h
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_140276C15
                or      r8, 42h

loc_140276C15:                          ; CODE XREF: sub_140276AE0+9E↑j
                                        ; sub_140276AE0+B4↑j ...
                mov     [rsp+178h+var_D0], r8
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_140276C3B
                test    r8b, 10h
                jnz     short loc_140276C37
                not     rax
                and     r8, rax
                jmp     short loc_140276C3B
; ---------------------------------------------------------------------------

loc_140276C37:                          ; CODE XREF: sub_140276AE0+14D↑j
                and     r8, 0FFFFFFFFFFFFFFEFh

loc_140276C3B:                          ; CODE XREF: sub_140276AE0+147↑j
                                        ; sub_140276AE0+155↑j
                sar     r8, 10h
                mov     [rsp+178h+var_D8], r8
                mov     [rsp+178h+var_88], r8
                mov     rdx, [r8]
                mov     [rsp+178h+var_E0], rdx
                mov     [rsp+178h+var_90], rdx
                movzx   ecx, word ptr [rdx+3Ch]
                and     ecx, 3FFh
                mov     rax, cs:qword_140C4E4C8
                mov     rbx, [rax+rcx*8]
                mov     eax, [rdx+38h]
                shr     eax, 14h
                and     eax, 3Fh
                jz      short loc_140276C9B
                mov     r8, gs:20h
                lea     r9d, [rax-1]
                movzx   ecx, cs:byte_140C4DD0C
                shl     r9d, cl
                jmp     short loc_140276CC0
; ---------------------------------------------------------------------------

loc_140276C9B:                          ; CODE XREF: sub_140276AE0+1A0↑j
                mov     rax, gs:188h
                mov     ecx, [rax+24Ch]
                lea     rdi, cs:140000000h
                mov     r8, ds:rva qword_140CFDCC0[rdi+rcx*8]
                mov     r9d, [r8+7F18h]

loc_140276CC0:                          ; CODE XREF: sub_140276AE0+1B9↑j
                movzx   ecx, cs:byte_140C4DD0D
                mov     r14d, 1
                mov     eax, r14d
                shl     eax, cl
                dec     eax
                mov     edx, r14d
                lock xadd [r8+7F10h], edx
                and     edx, eax
                mov     r8d, r10d
                mov     r15d, 2
                cmp     r12, 1000h
                cmovnz  r8d, r15d
                or      edx, r9d
                mov     rcx, rbx
                call    sub_14022ACA0
                mov     [rsp+178h+var_108], rax
                mov     [rsp+178h+var_80], rax
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jnz     short loc_140276D24
                mov     rcx, rbx
                call    sub_14055C3FC
                mov     eax, r14d
                jmp     loc_140278401
; ---------------------------------------------------------------------------

loc_140276D24:                          ; CODE XREF: sub_140276AE0+232↑j
                lea     rcx, [rax+rax*2]
                add     rcx, rcx
                mov     rdi, 0FFFFFA8000000000h
                mov     rax, rdi
                lea     rdi, [rax+rcx*8]
                mov     [rsp+178h+var_138], rdi
                mov     [rsp+178h+var_A0], rdi
                mov     rsi, [rsi]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                mov     r8, [rsp+178h+var_C8]
                cmp     r8, rax
                jb      loc_140276DFA
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r8, rax
                ja      short loc_140276DFA
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140276DFA
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     [rcx+390h], r14b
                jz      short loc_140276DFA
                test    r14b, sil
                jz      short loc_140276DFA
                test    sil, 20h
                jz      short loc_140276DB2
                test    sil, 42h
                jnz     short loc_140276DFA

loc_140276DB2:                          ; CODE XREF: sub_140276AE0+2CA↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140276DFA
                mov     rax, r8
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                mov     rdx, rsi
                or      rdx, 20h
                and     cl, 20h
                cmovz   rdx, rsi
                mov     rsi, rdx
                test    al, 42h
                jz      short loc_140276DFA
                or      rsi, 42h

loc_140276DFA:                          ; CODE XREF: sub_140276AE0+284↑j
                                        ; sub_140276AE0+29A↑j ...
                shr     rsi, 5
                and     esi, 1Fh
                mov     [rsp+178h+var_100], esi
                mov     ecx, esi
                mov     [rsp+178h+var_11C], ecx
                jnz     short loc_140276E14
                mov     ebx, 3
                jmp     short loc_140276E41
; ---------------------------------------------------------------------------

loc_140276E14:                          ; CODE XREF: sub_140276AE0+32B↑j
                cmp     esi, 1Fh
                jnz     short loc_140276E1E
                mov     ebx, r14d
                jmp     short loc_140276E41
; ---------------------------------------------------------------------------

loc_140276E1E:                          ; CODE XREF: sub_140276AE0+337↑j
                mov     eax, esi
                shr     eax, 3
                cmp     eax, 3
                jnz     short loc_140276E33
                test    sil, 7
                jz      short loc_140276E33
                mov     ebx, r15d
                jmp     short loc_140276E41
; ---------------------------------------------------------------------------

loc_140276E33:                          ; CODE XREF: sub_140276AE0+346↑j
                                        ; sub_140276AE0+34C↑j
                mov     ebx, r14d
                cmp     eax, r14d
                mov     eax, 0
                cmovz   ebx, eax

loc_140276E41:                          ; CODE XREF: sub_140276AE0+332↑j
                                        ; sub_140276AE0+33C↑j ...
                xor     ecx, ecx
                mov     r15d, ecx
                mov     edx, ecx
                mov     [rsp+178h+var_144], ecx
                mov     [rsp+178h+var_140], ecx
                cmp     r12, 1000h
                jz      short loc_140276E69
                mov     edx, ebx
                mov     rcx, rdi
                call    sub_1402966A0
                test    eax, eax
                cmovnz  r15d, r14d

loc_140276E69:                          ; CODE XREF: sub_140276AE0+377↑j
                movzx   eax, byte ptr [rdi+22h]
                shr     eax, 6
                cmp     eax, ebx
                jz      short loc_140276E81
                xor     r8d, r8d
                mov     edx, ebx
                mov     rcx, rdi
                call    sub_14031F848

loc_140276E81:                          ; CODE XREF: sub_140276AE0+392↑j
                mov     rdx, [rdi+18h]
                mov     r8, 0F0FFFFFFFFFFFFFFh
                nop

loc_140276E90:                          ; CODE XREF: sub_140276AE0+1948↓j
                mov     rcx, rdx
                and     rcx, r8
                mov     rax, rdx
                lock cmpxchg [rdi+18h], rcx
                cmp     rdx, rax
                jnz     loc_140278425
                mov     edx, r14d
                lea     rcx, qword_140C4EDC0
                call    sub_1402583E0
                mov     r14, rax
                mov     [rsp+178h+var_98], rax
                test    rax, rax
                jnz     loc_140276FF3
                test    [rsp+178h+arg_20], 1
                jnz     short loc_140276EE6
                mov     rcx, rdi
                call    sub_140300264
                lea     eax, [r14+4]
                jmp     loc_140278401
; ---------------------------------------------------------------------------

loc_140276EE6:                          ; CODE XREF: sub_140276AE0+3F3↑j
                test    r15d, r15d
                jz      short loc_140276EFD
                mov     r8d, ebx
                mov     edx, 1
                mov     rcx, [rsp+178h+var_108]
                call    sub_1402E5704

loc_140276EFD:                          ; CODE XREF: sub_140276AE0+409↑j
                mov     [rsp+178h+var_144], 1
                mov     r12, 0FFFFFA8000000028h
                mov     r13, 4000000000000h
                mov     r15, 0FFFFF68000000000h

loc_140276F23:                          ; CODE XREF: sub_140276AE0+8BE↓j
                mov     eax, dword ptr cs:xmmword_140CFC480+4
                and     eax, 1
                mov     [rsp+178h+var_140], eax
                mov     r14, [rsp+178h+var_110]
                shr     r14, 9
                mov     rax, 7FFFFFFFF8h
                and     r14, rax
                mov     rax, r15
                add     r14, rax
                mov     [rsp+178h+var_118], r14
                mov     r14, [r14]
                mov     [rsp+178h+var_130], r14
                and     r14d, 1
                nop     dword ptr [rax]

loc_140276F60:                          ; CODE XREF: sub_140276AE0+927↓j
                test    r14, r14
                jz      loc_1402783F2
                mov     rbx, [rsp+178h+var_130]
                bt      rbx, 9
                jb      loc_1402783F2
                lea     rcx, [rsp+178h+var_130]
                call    sub_1402433C0
                mov     r15d, eax
                test    eax, eax
                jz      loc_1402773DF
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_1402773DF
                mov     rcx, gs:188h
                mov     rdx, [rcx+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      loc_1402773DF
                test    bl, 20h
                jz      short loc_140276FC9
                test    bl, 42h
                jnz     loc_1402773DF

loc_140276FC9:                          ; CODE XREF: sub_140276AE0+4DE↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     loc_1402773BD
                mov     rbx, [rsp+178h+var_130]
                jmp     loc_1402773DF
; ---------------------------------------------------------------------------

loc_140276FF3:                          ; CODE XREF: sub_140276AE0+3E5↑j
                mov     edx, 4
                mov     r11, 0FFFFFFFFFh
                mov     r10, [rsp+178h+var_108]
                cmp     r10, r11
                ja      short loc_14027705A
                lea     r8, [r10+r10*2]
                add     r8, r8
                mov     r9, 0FFFFFA8000000028h
                mov     rax, r9
                mov     r9, 4000000000000h
                test    [rax+r8*8], r9
                jz      short loc_14027705A
                mov     rax, 0FFFFFA8000000022h
                movzx   eax, byte ptr [rax+r8*8]
                shr     eax, 6
                test    eax, eax
                jz      short loc_140277055
                cmp     eax, 3
                jz      short loc_140277055
                cmp     eax, 2
                jnz     short loc_14027705A
                lea     edx, [rax+1Ah]
                jmp     short loc_14027705A
; ---------------------------------------------------------------------------

loc_140277055:                          ; CODE XREF: sub_140276AE0+564↑j
                                        ; sub_140276AE0+569↑j
                mov     edx, 0Ch

loc_14027705A:                          ; CODE XREF: sub_140276AE0+52A↑j
                                        ; sub_140276AE0+54E↑j ...
                or      edx, 0A0000000h
                and     edx, 1Fh
                lea     r8, cs:140000000h
                mov     rbx, ds:rva qword_140017520[r8+rdx*8]
                mov     rax, 0FFFF000000000E7Fh
                and     rbx, rax
                mov     rax, r10
                and     rax, r11
                shl     rax, 0Ch
                or      rbx, rax
                or      rbx, 21h
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                cmp     r14, rax
                jb      loc_1402771C9
                mov     r9, 0FFFFF6FFFFFFFFFFh
                mov     rax, r9
                cmp     r14, rax
                ja      loc_1402771C9
                mov     rdi, r14
                shl     rdi, 19h
                mov     rax, rdx
                shl     rax, 19h
                sub     rdi, rax
                sar     rdi, 10h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                cmp     r14, rax
                jb      short loc_140277148
                mov     rax, 0FFFFF6FB7FFFFFFFh
                cmp     r14, rax
                ja      short loc_140277148
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     r14, rax
                jnz     short loc_140277110
                mov     rax, 8000000000000000h
                or      rbx, rax
                jmp     short loc_14027711D
; ---------------------------------------------------------------------------

loc_140277110:                          ; CODE XREF: sub_140276AE0+61F↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                and     rbx, rax

loc_14027711D:                          ; CODE XREF: sub_140276AE0+62E↑j
                mov     rcx, r14
                call    sub_14033FA34
                mov     rdx, 0FFFFF68000000000h
                lea     r8, cs:140000000h
                mov     r9, 0FFFFF6FFFFFFFFFFh
                test    eax, eax
                jz      short loc_140277148
                or      rbx, 4

loc_140277148:                          ; CODE XREF: sub_140276AE0+601↑j
                                        ; sub_140276AE0+610↑j ...
                mov     rax, rdx
                mov     rcx, 3FFFFFFF78h
                add     rax, rcx
                cmp     r14, rax
                ja      short loc_140277161
                or      rbx, 4

loc_140277161:                          ; CODE XREF: sub_140276AE0+67B↑j
                mov     rax, 0FFFF800000000000h
                cmp     rdi, rax
                jnb     short loc_140277179
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jmp     short loc_1402771C5
; ---------------------------------------------------------------------------

loc_140277179:                          ; CODE XREF: sub_140276AE0+68E↑j
                mov     rax, rdi
                shr     rax, 27h
                and     eax, 1FFh
                add     eax, 0FFFFFF00h
                cmp     byte ptr [rax+r8+0C4F848h], 1
                jz      short loc_1402771CE
                mov     rax, rdx
                cmp     rdi, rax
                jb      short loc_1402771A5
                mov     rax, r9
                cmp     rdi, rax
                jbe     short loc_1402771CE

loc_1402771A5:                          ; CODE XREF: sub_140276AE0+6BB↑j
                cmp     rdi, cs:qword_140C4F9B8
                jb      short loc_1402771BE
                cmp     rdi, cs:qword_140C4E1E8
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jbe     short loc_1402771C5

loc_1402771BE:                          ; CODE XREF: sub_140276AE0+6CC↑j
                movzx   eax, byte ptr cs:word_140C4DE88

loc_1402771C5:                          ; CODE XREF: sub_140276AE0+697↑j
                                        ; sub_140276AE0+6DC↑j
                test    eax, eax
                jz      short loc_1402771CE

loc_1402771C9:                          ; CODE XREF: sub_140276AE0+5C0↑j
                                        ; sub_140276AE0+5D6↑j
                bts     rbx, 8

loc_1402771CE:                          ; CODE XREF: sub_140276AE0+6B3↑j
                                        ; sub_140276AE0+6C3↑j ...
                movzx   edi, byte ptr cs:word_140C4DE88
                and     edi, 1
                shl     rdi, 8
                mov     rax, 0FAFFFFFFFFFFFEFFh
                and     rbx, rax
                or      rdi, rbx
                mov     rax, 0A00000000000042h
                or      rdi, rax
                xor     eax, eax
                mov     ebx, eax
                mov     rcx, r14
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027724B
                call    sub_140349680
                test    eax, eax
                jz      short loc_140277222
                mov     ebx, 1
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14027724B
                jmp     short loc_14027723E
; ---------------------------------------------------------------------------

loc_140277222:                          ; CODE XREF: sub_140276AE0+730↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027724B

loc_14027723E:                          ; CODE XREF: sub_140276AE0+740↑j
                mov     rax, 8000000000000000h
                or      rdi, rax

loc_14027724B:                          ; CODE XREF: sub_140276AE0+727↑j
                                        ; sub_140276AE0+73E↑j ...
                mov     [r14], rdi
                test    ebx, ebx
                jz      short loc_14027725D
                mov     rdx, rdi
                mov     rcx, r14
                call    sub_140349620

loc_14027725D:                          ; CODE XREF: sub_140276AE0+770↑j
                mov     rcx, r14
                shl     rcx, 19h
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                mov     rbx, r13
                lea     rdi, [rcx+r13]
                test    r15d, r15d
                jz      short loc_1402772B0
                test    r13d, r13d
                jz      short loc_140277297
                mov     r8, rbx
                xor     edx, edx
                call    memset

loc_140277297:                          ; CODE XREF: sub_140276AE0+7AB↑j
                mov     r8d, 1000h
                sub     r8, rbx
                sub     r8, r12
                jz      short loc_1402772B0
                lea     rcx, [r12+rdi]
                xor     edx, edx
                call    memset

loc_1402772B0:                          ; CODE XREF: sub_140276AE0+7A6↑j
                                        ; sub_140276AE0+7C3↑j
                xor     ebx, ebx
                mov     [rsp+178h+var_13C], ebx

loc_1402772B6:                          ; DATA XREF: .rdata:000000014005DCEC↑o
;   __try { // __except at loc_1402772F4
                mov     r8, r12
                mov     rdx, [rsp+178h+var_A8]
                mov     rcx, rdi
                call    memmove
                mov     r12, 0FFFFFA8000000028h
                mov     r13, 4000000000000h
                mov     rdi, [rsp+178h+var_138]
                lea     eax, [rbx+1]
                mov     r15, 0FFFFF68000000000h
                jmp     loc_14027738A
;   } // starts at 1402772B6
; ---------------------------------------------------------------------------

loc_1402772F4:                          ; DATA XREF: .rdata:000000014005DCEC↑o
;   __except(loc_1404189A0) // owned by 1402772B6
                mov     eax, 1
                mov     r12, 0FFFFFA8000000028h
                mov     r13, 4000000000000h
                mov     r15, 0FFFFF68000000000h
                mov     ebx, [rsp+178h+var_13C]
                mov     rdi, [rsp+178h+var_A0]
                mov     [rsp+178h+var_138], rdi
                mov     r14, [rsp+178h+var_98]
                mov     rdx, [rsp+178h+var_90]
                mov     [rsp+178h+var_E0], rdx
                mov     edx, [rsp+178h+var_140]
                mov     [rsp+178h+var_144], edx
                mov     esi, [rsp+178h+var_100]
                mov     rcx, [rsp+178h+var_88]
                mov     [rsp+178h+var_D8], rcx
                mov     [rsp+178h+var_11C], esi
                mov     rcx, [rsp+178h+var_80]
                mov     [rsp+178h+var_108], rcx
                mov     rcx, [rsp+178h+var_B8]
                mov     [rsp+178h+var_110], rcx
                mov     r8, [rsp+178h+var_B0]
                mov     [rsp+178h+var_C8], r8

loc_14027738A:                          ; CODE XREF: sub_140276AE0+80F↑j
                mov     r8d, eax
                mov     rdx, r14
                lea     rcx, qword_140C4EDC0
                call    sub_14025EFB0
                test    ebx, ebx
                jns     loc_140276F23
                mov     rcx, rdi
                call    sub_1403B748C
                mov     rax, [rsp+178h+var_C0]
                mov     [rax], ebx
                xor     eax, eax
                jmp     loc_140278401
; ---------------------------------------------------------------------------

loc_1402773BD:                          ; CODE XREF: sub_140276AE0+503↑j
                lea     rax, [rsp+178h+var_130]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                test    al, 20h
                jz      short loc_1402773D7
                or      rbx, 20h

loc_1402773D7:                          ; CODE XREF: sub_140276AE0+8F1↑j
                test    al, 42h
                jz      short loc_1402773DF
                or      rbx, 42h

loc_1402773DF:                          ; CODE XREF: sub_140276AE0+4A8↑j
                                        ; sub_140276AE0+4B8↑j ...
                shr     rbx, 0Ch
                mov     r10, 0FFFFFFFFFh
                and     rbx, r10
                lea     rdx, [rbx+rbx*2]
                shl     rdx, 4
                mov     [rsp+178h+var_B8], rdx
                mov     rax, r12
                test    [rdx+rax], r13
                jz      loc_140276F60
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                lea     rdi, [rdx+rax]
                mov     r12, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140277471
                test    al, 1
                jz      short loc_140277471
                cmp     r12b, 0Fh
                ja      short loc_140277471
                mov     rax, gs:20h
                mov     r8, [rax+84B8h]
                mov     edx, [r8+14h]
                movzx   ecx, r12b
                inc     ecx
                mov     r14, 0FFFFFFFFFFFFFFFFh
                mov     rax, r14
                shl     rax, cl
                and     eax, 4
                or      edx, eax
                mov     [r8+14h], edx
                jmp     short loc_140277478
; ---------------------------------------------------------------------------

loc_140277471:                          ; CODE XREF: sub_140276AE0+953↑j
                                        ; sub_140276AE0+957↑j ...
                mov     r14, 0FFFFFFFFFFFFFFFFh

loc_140277478:                          ; CODE XREF: sub_140276AE0+98F↑j
                mov     [rsp+178h+var_FC], 0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_1402774B6
                nop     dword ptr [rax+00000000h]

loc_140277490:                          ; CODE XREF: sub_140276AE0+9C1↓j
                                        ; sub_140276AE0+9CA↓j
                lea     rcx, [rsp+178h+var_FC]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140277490
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140277490
                mov     r10, 0FFFFFFFFFh

loc_1402774B6:                          ; CODE XREF: sub_140276AE0+9A7↑j
                mov     r13, [rsp+178h+var_118]
                mov     rax, [r13+0]
                mov     [rsp+178h+var_130], rax
                test    al, 1
                jz      loc_140278382
                bt      rax, 9
                jb      loc_140278382
                test    r15d, r15d
                jz      short loc_140277551
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140277551
                mov     rcx, gs:188h
                mov     rdx, [rcx+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_140277551
                test    al, 20h
                jz      short loc_140277509
                test    al, 42h
                jnz     short loc_140277551

loc_140277509:                          ; CODE XREF: sub_140276AE0+A23↑j
                mov     rcx, gs:188h
                mov     rdx, [rcx+0B8h]
                mov     r8, [rdx+788h]
                test    r8, r8
                jnz     short loc_14027752C
                mov     rax, [rsp+178h+var_130]
                jmp     short loc_140277551
; ---------------------------------------------------------------------------

loc_14027752C:                          ; CODE XREF: sub_140276AE0+A43↑j
                lea     rcx, [rsp+178h+var_130]
                shr     rcx, 3
                and     ecx, 1FFh
                mov     rcx, [r8+rcx*8]
                test    cl, 20h
                jz      short loc_140277548
                or      rax, 20h

loc_140277548:                          ; CODE XREF: sub_140276AE0+A62↑j
                test    cl, 42h
                jz      short loc_140277551
                or      rax, 42h

loc_140277551:                          ; CODE XREF: sub_140276AE0+9FA↑j
                                        ; sub_140276AE0+A06↑j ...
                shr     rax, 0Ch
                and     rax, r10
                cmp     rbx, rax
                jnz     loc_140278382
                mov     rcx, rdi
                call    sub_140275EA0
                test    eax, eax
                jz      loc_140277645
                xor     r10b, r10b
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_140277594
                mov     eax, [rdi+10h]
                bt      rax, 0Ah
                jnb     short loc_140277594
                mov     r14b, 1
                mov     ebx, 1
                jmp     short loc_1402775A8
; ---------------------------------------------------------------------------

loc_140277594:                          ; CODE XREF: sub_140276AE0+A9E↑j
                                        ; sub_140276AE0+AA8↑j
                call    sub_140279D40
                movzx   r14d, r10b
                test    eax, eax
                mov     ebx, 1
                cmovnz  r14d, ebx

loc_1402775A8:                          ; CODE XREF: sub_140276AE0+AB2↑j
                mov     rcx, [rdi+28h]
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rax, cs:qword_140C4E4C8
                mov     r15, [rax+rcx*8]
                test    r14b, r14b
                jz      short loc_1402775DB
                mov     r8d, 4
                mov     rdx, rbx
                mov     rcx, r15
                call    sub_140232160
                test    eax, eax
                jz      short loc_140277649

loc_1402775DB:                          ; CODE XREF: sub_140276AE0+AE4↑j
                lea     r9, unk_140C50C00
                cmp     r15, r9
                jnz     short loc_14027761A
                mov     rdx, gs:20h
                mov     eax, [rdx+831Ch]
                cmp     eax, 1
                jb      short loc_14027761A
                mov     r8d, 0FFFFFFFFh

loc_140277601:                          ; CODE XREF: sub_140276AE0+B36↓j
                cmp     eax, r8d
                jz      short loc_140277620
                lea     ecx, [rax-1]
                lock cmpxchg [rdx+831Ch], ecx
                jz      short loc_140277645
                cmp     eax, 1
                jnb     short loc_140277601
                jmp     short loc_140277620
; ---------------------------------------------------------------------------

loc_14027761A:                          ; CODE XREF: sub_140276AE0+B05↑j
                                        ; sub_140276AE0+B19↑j
                mov     r8d, 0FFFFFFFFh

loc_140277620:                          ; CODE XREF: sub_140276AE0+B24↑j
                                        ; sub_140276AE0+B38↑j
                mov     rdx, rbx
                mov     rcx, r15
                call    sub_1403438BC
                mov     ebx, eax
                test    eax, eax
                jnz     short loc_140277641
                test    r14b, r14b
                jz      short loc_140277641
                lea     edx, [rax+1]
                mov     rcx, r15
                call    sub_14026B700

loc_140277641:                          ; CODE XREF: sub_140276AE0+B4F↑j
                                        ; sub_140276AE0+B54↑j
                test    ebx, ebx
                jz      short loc_140277649

loc_140277645:                          ; CODE XREF: sub_140276AE0+A8B↑j
                                        ; sub_140276AE0+B31↑j
                inc     word ptr [rdi+20h]

loc_140277649:                          ; CODE XREF: sub_140276AE0+AF9↑j
                                        ; sub_140276AE0+B63↑j
                cmp     r12b, 11h
                jz      loc_140277781
                mov     [rsp+178h+var_148], r12b
                mov     [rsp+178h+var_128], 0
                mov     rbx, [rdi+8]
                mov     rax, 8000000000000000h
                or      rbx, rax
                mov     [rsp+178h+var_B0], rbx
                movzx   eax, byte ptr [rdi+22h]
                test    al, 20h
                jz      loc_14027774B
                movzx   r15d, r12b
                movzx   r14d, r12b
                mov     rbx, 7FFFFFFFFFFFFFFFh
                nop     word ptr [rax+rax+00000000h]

loc_1402776A0:                          ; CODE XREF: sub_140276AE0+C58↓j
                lock and [rdi+18h], rbx
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_1402776FC
                test    al, 1
                jz      short loc_1402776FC
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_1402776FC
                cmp     r12b, 0Fh
                ja      short loc_1402776FC
                cmp     al, 2
                jb      short loc_1402776FC
                mov     r9, gs:20h
                mov     r8, [r9+84B8h]
                mov     edx, [r8+14h]
                lea     ecx, [r15+1]
                mov     rax, 0FFFFFFFFFFFFFFFFh
                shl     rax, cl
                movzx   ecx, ax
                not     ecx
                and     edx, ecx
                mov     [r8+14h], edx
                jnz     short loc_1402776FC
                mov     rcx, r9
                call    sub_1403F2EC4

loc_1402776FC:                          ; CODE XREF: sub_140276AE0+BCD↑j
                                        ; sub_140276AE0+BD1↑j ...
                mov     cr8, r14
                mov     [rsp+178h+var_128], 0
                movzx   eax, byte ptr [rdi+22h]
                mov     [rsp+178h+var_147], al
                test    al, 20h
                jz      short loc_14027772A

loc_140277714:                          ; CODE XREF: sub_140276AE0+C48↓j
                lea     rcx, [rsp+178h+var_128]
                call    sub_1402C8C70
                movzx   eax, byte ptr [rdi+22h]
                mov     [rsp+178h+var_147], al
                test    al, 20h
                jnz     short loc_140277714

loc_14027772A:                          ; CODE XREF: sub_140276AE0+C32↑j
                mov     rcx, rdi
                call    sub_1402DAA00
                movzx   eax, byte ptr [rdi+22h]
                test    al, 20h
                jnz     loc_1402776A0
                mov     rbx, [rsp+178h+var_B0]
                mov     r13, [rsp+178h+var_118]

loc_14027774B:                          ; CODE XREF: sub_140276AE0+B9F↑j
                or      al, 20h
                mov     [rdi+22h], al
                mov     rax, [rdi+18h]
                shr     rax, 3Eh
                test    al, 1
                jnz     short loc_140277770
                test    byte ptr [rbx], 20h
                jnz     short loc_140277770
                xor     r8d, r8d
                lea     edx, [r8+1]
                mov     rcx, rbx
                call    sub_1402C67E0

loc_140277770:                          ; CODE XREF: sub_140276AE0+C7A↑j
                                        ; sub_140276AE0+C7F↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                jmp     short loc_14027778B
; ---------------------------------------------------------------------------

loc_140277781:                          ; CODE XREF: sub_140276AE0+B6D↑j
                mov     dl, 11h
                mov     rcx, rdi
                call    sub_140299EF0

loc_14027778B:                          ; CODE XREF: sub_140276AE0+C9F↑j
                mov     rbx, [rsp+178h+var_110]
                mov     rdx, [rbx]
                mov     r11, 0FFFFF6FB7DBED000h
                mov     rax, r11
                cmp     rbx, rax
                jb      short loc_140277817
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rbx, rax
                ja      short loc_140277817
                call    sub_140349680
                test    eax, eax
                jz      short loc_140277817
                test    dl, 1
                jz      short loc_140277817
                test    dl, 20h
                jz      short loc_1402777CF
                test    dl, 42h
                jnz     short loc_140277817

loc_1402777CF:                          ; CODE XREF: sub_140276AE0+CE8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140277817
                mov     rax, rbx
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                movzx   ecx, al
                mov     r8, rdx
                or      r8, 20h
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140277817
                or      rdx, 42h

loc_140277817:                          ; CODE XREF: sub_140276AE0+CC3↑j
                                        ; sub_140276AE0+CD5↑j ...
                mov     [rsp+178h+var_D0], rdx
                test    dl, 1
                jnz     loc_140278373
                bt      rdx, 0Bh
                jnb     short loc_14027783A
                bt      rdx, 0Ah
                jnb     loc_140278373

loc_14027783A:                          ; CODE XREF: sub_140276AE0+D4D↑j
                shr     rdx, 5
                and     edx, 1Fh
                cmp     esi, edx
                jnz     loc_140278373
                xor     r14d, r14d
                mov     [rsp+178h+var_F8], r14d
                mov     r15, [rsp+178h+var_138]
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jnb     short loc_14027788B

loc_140277862:                          ; CODE XREF: sub_140276AE0+D96↓j
                                        ; sub_140276AE0+D9F↓j
                lea     rcx, [rsp+178h+var_F8]
                call    sub_1402C8C70
                mov     rax, [r15+18h]
                test    rax, rax
                js      short loc_140277862
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jb      short loc_140277862
                mov     r11, 0FFFFF6FB7DBED000h

loc_14027788B:                          ; CODE XREF: sub_140276AE0+D80↑j
                mov     rdx, [rbx]
                mov     rax, r11
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     rbx, rax
                jb      short loc_140277908
                mov     rax, r10
                cmp     rbx, rax
                ja      short loc_140277908
                call    sub_140349680
                test    eax, eax
                jz      short loc_140277908
                test    dl, 1
                jz      short loc_140277908
                test    dl, 20h
                jz      short loc_1402778C0
                test    dl, 42h
                jnz     short loc_140277908

loc_1402778C0:                          ; CODE XREF: sub_140276AE0+DD9↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140277908
                mov     rax, rbx
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                movzx   ecx, al
                mov     r8, rdx
                or      r8, 20h
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140277908
                or      rdx, 42h

loc_140277908:                          ; CODE XREF: sub_140276AE0+DBE↑j
                                        ; sub_140276AE0+DC6↑j ...
                bt      rdx, 0Ah
                mov     rax, 0FFFFFFFFFFFFFFF7h
                mov     rcx, 0FFFFFFFFFFFFF7FFh
                cmovb   rax, rcx
                and     rax, rdx
                mov     [r15+10h], rax
                mov     rax, 8000000000000000h
                or      [r15+28h], rax
                mov     r9, [r15+28h]
                test    esi, esi
                jnz     short loc_140277944
                lea     ecx, [rsi+1]
                lea     esi, [rcx+2]
                jmp     short loc_14027797D
; ---------------------------------------------------------------------------

loc_140277944:                          ; CODE XREF: sub_140276AE0+E5A↑j
                cmp     esi, 1Fh
                jnz     short loc_140277952
                mov     ecx, 1
                mov     esi, ecx
                jmp     short loc_14027797D
; ---------------------------------------------------------------------------

loc_140277952:                          ; CODE XREF: sub_140276AE0+E67↑j
                mov     eax, esi
                shr     eax, 3
                cmp     eax, 3
                jnz     short loc_140277970
                test    sil, 7
                jz      short loc_140277970
                mov     r12d, 2
                mov     esi, r12d
                lea     ecx, [rax-2]
                jmp     short loc_140277983
; ---------------------------------------------------------------------------

loc_140277970:                          ; CODE XREF: sub_140276AE0+E7A↑j
                                        ; sub_140276AE0+E80↑j
                mov     ecx, 1
                mov     esi, ecx
                cmp     eax, ecx
                cmovz   esi, r14d

loc_14027797D:                          ; CODE XREF: sub_140276AE0+E62↑j
                                        ; sub_140276AE0+E70↑j
                mov     r12d, 2

loc_140277983:                          ; CODE XREF: sub_140276AE0+E8E↑j
                mov     [r15+20h], cx
                mov     r8, [r13+0]
                mov     rax, r11
                cmp     r13, rax
                jb      short loc_1402779FE
                mov     rax, r10
                cmp     r13, rax
                ja      short loc_1402779FE
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402779FE
                test    r8b, 1
                jz      short loc_1402779FE
                test    r8b, 20h
                jz      short loc_1402779B7
                test    r8b, 42h
                jnz     short loc_1402779FE

loc_1402779B7:                          ; CODE XREF: sub_140276AE0+ECF↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_1402779FE
                shr     r13, 3
                and     r13d, 1FFh
                mov     rax, [rax+r13*8]
                movzx   ecx, al
                mov     rdx, r8
                or      rdx, 20h
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_1402779FE
                or      r8, 42h

loc_1402779FE:                          ; CODE XREF: sub_140276AE0+EB2↑j
                                        ; sub_140276AE0+EBA↑j ...
                mov     [rsp+178h+var_E8], r8
                mov     rax, r11
                lea     rcx, [rsp+178h+var_E8]
                cmp     rcx, rax
                jb      short loc_140277A8E
                mov     rax, r10
                lea     rcx, [rsp+178h+var_E8]
                cmp     rcx, rax
                ja      short loc_140277A8E
                call    sub_140349680
                test    eax, eax
                jz      short loc_140277A8E
                test    r8b, 1
                jz      short loc_140277A8E
                test    r8b, 20h
                jz      short loc_140277A41
                test    r8b, 42h
                jnz     short loc_140277A8E

loc_140277A41:                          ; CODE XREF: sub_140276AE0+F59↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140277A8E
                lea     rax, [rsp+178h+var_E8]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                mov     rdx, r8
                or      rdx, 20h
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_140277A8E
                or      r8, 42h

loc_140277A8E:                          ; CODE XREF: sub_140276AE0+F34↑j
                                        ; sub_140276AE0+F44↑j ...
                shr     r8, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     r8, rcx
                mov     rax, r8
                xor     rax, r9
                and     rax, rcx
                xor     rax, r9
                mov     [r15+28h], rax
                lea     rbx, [r8+r8*2]
                shl     rbx, 4
                mov     rcx, gs:188h
                mov     eax, [rcx+518h]
                bt      eax, 8
                jnb     short loc_140277ADA
                and     eax, 0E00h
                shr     eax, 9
                mov     [rsp+178h+var_124], eax
                jmp     short loc_140277B08
; ---------------------------------------------------------------------------

loc_140277ADA:                          ; CODE XREF: sub_140276AE0+FEA↑j
                mov     edx, [rcx+510h]
                shr     edx, 0Ch
                and     edx, 7
                mov     rax, [rcx+220h]
                test    dword ptr [rax+464h], 100000h
                jz      short loc_140277B04
                mov     eax, r12d
                cmp     edx, 2
                cmovb   eax, edx
                mov     edx, eax

loc_140277B04:                          ; CODE XREF: sub_140276AE0+1017↑j
                mov     [rsp+178h+var_124], edx

loc_140277B08:                          ; CODE XREF: sub_140276AE0+FF8↑j
                mov     [rsp+178h+var_F4], r14d
                mov     r13, 0FFFFFA8000000018h
                lock bts qword ptr [rbx+r13], 3Fh ; '?'
                jnb     short loc_140277B42

loc_140277B23:                          ; CODE XREF: sub_140276AE0+1057↓j
                                        ; sub_140276AE0+1060↓j
                lea     rcx, [rsp+178h+var_F4]
                call    sub_1402C8C70
                mov     rax, [rbx+r13]
                test    rax, rax
                js      short loc_140277B23
                lock bts qword ptr [rbx+r13], 3Fh ; '?'
                jb      short loc_140277B23

loc_140277B42:                          ; CODE XREF: sub_140276AE0+1041↑j
                mov     rax, [rbx+r13]
                mov     rcx, rax
                mov     rdx, 3FFFFFFFFFFFFFFFh
                and     rcx, rdx
                inc     rcx
                xor     rcx, rax
                and     rcx, rdx
                xor     rcx, rax
                mov     [rbx+r13], rcx
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+r13], rax
                movzx   ecx, byte ptr [r15+22h]
                mov     eax, ecx
                shr     eax, 6
                mov     r13d, 1
                cmp     eax, esi
                jz      short loc_140277B9B
                mov     r8d, r13d
                mov     edx, esi
                mov     rcx, r15
                call    sub_14031F848
                movzx   ecx, byte ptr [r15+22h]

loc_140277B9B:                          ; CODE XREF: sub_140276AE0+10A7↑j
                mov     rax, [r15+18h]
                mov     rdx, 0C000000000000001h
                and     rax, rdx
                or      rax, 1
                mov     [r15+18h], rax
                movzx   eax, byte ptr [r15+23h]
                and     al, 0F8h
                or      al, byte ptr [rsp+178h+var_124]
                mov     [r15+23h], al
                mov     rax, [rsp+178h+var_110]
                mov     [r15+8], rax
                and     cl, 0FEh
                or      cl, 6
                mov     [r15+22h], cl
                movzx   eax, cl
                or      al, 10h
                mov     [r15+22h], al
                test    [rsp+178h+arg_20], 2
                jz      short loc_140277C07
                movzx   ecx, byte ptr [r15+23h]
                test    cl, 8
                jnz     short loc_140277BFD
                mov     eax, ecx
                and     eax, 7
                cmp     eax, 2
                jbe     short loc_140277C07

loc_140277BFD:                          ; CODE XREF: sub_140276AE0+1111↑j
                and     cl, 0FAh
                or      cl, 2
                mov     [r15+23h], cl

loc_140277C07:                          ; CODE XREF: sub_140276AE0+1107↑j
                                        ; sub_140276AE0+111B↑j
                mov     rdx, [rsp+178h+var_E0]
                mov     eax, [rdx+38h]
                test    al, 20h
                jnz     short loc_140277C1C
                cmp     [rdx+40h], r14
                jnz     short loc_140277C24

loc_140277C1C:                          ; CODE XREF: sub_140276AE0+1134↑j
                mov     [rsp+178h+var_D8], r14

loc_140277C24:                          ; CODE XREF: sub_140276AE0+113A↑j
                lea     rbx, [rdx+48h]
                mov     r14, cr8
                mov     cr8, r12
                mov     eax, cs:dword_140CFC660
                mov     r12, 0FFFFFFFFFFFFFFFFh
                test    eax, eax
                jz      short loc_140277C75
                test    al, 1
                jz      short loc_140277C75
                cmp     r14b, 0Fh
                ja      short loc_140277C75
                mov     rax, gs:20h
                mov     r9, [rax+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, r14b
                inc     ecx
                mov     rdx, r12
                shl     rdx, cl
                and     edx, 4
                or      r8d, edx
                mov     [r9+14h], r8d

loc_140277C75:                          ; CODE XREF: sub_140276AE0+115F↑j
                                        ; sub_140276AE0+1163↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_140277C8F
                movzx   edx, r14b
                mov     rcx, rbx
                call    sub_1405B5E68
                jmp     loc_140277D25
; ---------------------------------------------------------------------------

loc_140277C8F:                          ; CODE XREF: sub_140276AE0+119C↑j
                mov     [rsp+178h+var_120], 0
                mov     rsi, gs:20h
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jz      short loc_140277CC5
                cmp     byte ptr [rsi+20h], 1
                ja      short loc_140277CC5
                mov     eax, [rcx+18h]
                add     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_140277CC5
                mov     rcx, rsi
                call    sub_1403F2EC4

loc_140277CC5:                          ; CODE XREF: sub_140276AE0+11CA↑j
                                        ; sub_140276AE0+11D0↑j ...
                lock bts dword ptr [rbx], 1Fh
                jnb     short loc_140277CE6
                xor     edx, edx
                mov     rcx, rsi
                call    sub_140245F90
                movzx   edx, r14b
                mov     rcx, rbx
                call    sub_14028EAE0
                mov     [rsp+178h+var_120], eax

loc_140277CE6:                          ; CODE XREF: sub_140276AE0+11EA↑j
                mov     edx, [rbx]
                mov     ecx, edx
                btr     ecx, 1Eh
                cmp     ecx, 80000000h
                jz      short loc_140277D25

loc_140277CF6:                          ; CODE XREF: sub_140276AE0+1243↓j
                bt      edx, 1Eh
                jb      short loc_140277D0C
                mov     ecx, edx
                bts     ecx, 1Eh
                mov     eax, edx
                lock cmpxchg [rbx], ecx
                mov     edx, eax
                jnz     short loc_140277D18

loc_140277D0C:                          ; CODE XREF: sub_140276AE0+121A↑j
                lea     rcx, [rsp+178h+var_120]
                call    sub_1402C8C70
                mov     edx, [rbx]

loc_140277D18:                          ; CODE XREF: sub_140276AE0+122A↑j
                mov     eax, edx
                btr     eax, 1Eh
                cmp     eax, 80000000h
                jnz     short loc_140277CF6

loc_140277D25:                          ; CODE XREF: sub_140276AE0+11AA↑j
                                        ; sub_140276AE0+1214↑j
                mov     rdx, [rsp+178h+var_E0]
                inc     qword ptr [rdx+20h]
                mov     rax, [rsp+178h+var_D8]
                test    rax, rax
                jz      short loc_140277D41
                inc     dword ptr [rax+68h]

loc_140277D41:                          ; CODE XREF: sub_140276AE0+125C↑j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_140277D5C
                mov     rdx, [rsp+178h]
                mov     rcx, rbx
                call    sub_1405B6044
                jmp     short loc_140277D62
; ---------------------------------------------------------------------------

loc_140277D5C:                          ; CODE XREF: sub_140276AE0+1268↑j
                mov     dword ptr [rbx], 0

loc_140277D62:                          ; CODE XREF: sub_140276AE0+127A↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_140277D8D
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_140277D8D
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_140277D8D
                call    sub_1403F2EC4

loc_140277D8D:                          ; CODE XREF: sub_140276AE0+1295↑j
                                        ; sub_140276AE0+129B↑j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140277DE3
                test    al, 1
                jz      short loc_140277DE3
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140277DE3
                cmp     r14b, 0Fh
                ja      short loc_140277DE3
                cmp     al, 2
                jb      short loc_140277DE3
                mov     r10, gs:20h
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, r14b
                inc     ecx
                mov     rdx, r12
                shl     rdx, cl
                movzx   eax, dx
                not     eax
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_140277DE3
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140277DE3:                          ; CODE XREF: sub_140276AE0+12B5↑j
                                        ; sub_140276AE0+12B9↑j ...
                movzx   eax, r14b
                mov     cr8, rax
                mov     eax, [rsp+178h+var_11C]
                and     eax, 1Fh
                mov     r14d, eax
                lea     rbx, cs:140000000h
                mov     rbx, ds:rva qword_140017520[rbx+rax*8]
                mov     rax, 0FFFF000000000E7Fh
                and     rbx, rax
                mov     rax, [rsp+178h+var_108]
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                shl     rax, 0Ch
                or      rbx, rax
                or      rbx, 21h
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                test    rax, rax
                jnz     short loc_140277E9B
                mov     rsi, rdx
                neg     rsi
                shl     rsi, 19h
                sar     rsi, 10h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                test    rax, rax
                jnz     short loc_140277E7C
                mov     rax, 7FFFFFFFFFFFFFFFh
                and     rbx, rax
                xor     ecx, ecx
                call    sub_14033FA34
                test    eax, eax
                jz      short loc_140277E7C
                or      rbx, 4

loc_140277E7C:                          ; CODE XREF: sub_140276AE0+137E↑j
                                        ; sub_140276AE0+1396↑j
                mov     r8, rbx
                or      rbx, 4
                mov     rcx, rsi
                call    sub_140271580
                test    eax, eax
                jz      short loc_140277EA0
                mov     rbx, r8
                or      rbx, 104h
                jmp     short loc_140277EA0
; ---------------------------------------------------------------------------

loc_140277E9B:                          ; CODE XREF: sub_140276AE0+135E↑j
                bts     rbx, 8

loc_140277EA0:                          ; CODE XREF: sub_140276AE0+13AD↑j
                                        ; sub_140276AE0+13B9↑j
                and     r14b, 5
                cmp     r14b, 4
                jnz     short loc_140277EAE
                or      rbx, 42h

loc_140277EAE:                          ; CODE XREF: sub_140276AE0+13C8↑j
                mov     rax, 0FAFFFFFFFFFFFEFFh
                and     rbx, rax
                mov     rax, 0A00000000000000h
                or      rbx, rax
                mov     [rsp+178h+var_D0], rbx
                xor     r14d, r14d
                mov     edx, r14d
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                mov     r8, [rsp+178h+var_110]
                mov     r11, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                jb      short loc_140277F44
                mov     rax, r11
                cmp     r8, rax
                ja      short loc_140277F44
                call    sub_140349680
                mov     rsi, 8000000000000000h
                test    eax, eax
                jz      short loc_140277F23
                mov     edx, r13d
                cmp     byte ptr cs:word_140C4DE88+1, r14b
                jnz     short loc_140277F4E
                or      rbx, rsi
                jmp     short loc_140277F4E
; ---------------------------------------------------------------------------

loc_140277F23:                          ; CODE XREF: sub_140276AE0+1430↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140277F4E
                or      rbx, rsi
                jmp     short loc_140277F4E
; ---------------------------------------------------------------------------

loc_140277F44:                          ; CODE XREF: sub_140276AE0+1415↑j
                                        ; sub_140276AE0+141D↑j
                mov     rsi, 8000000000000000h

loc_140277F4E:                          ; CODE XREF: sub_140276AE0+143C↑j
                                        ; sub_140276AE0+1441↑j ...
                mov     [r8], rbx
                test    edx, edx
                jz      short loc_140277F60
                mov     rdx, rbx
                mov     rcx, r8
                call    sub_140349620

loc_140277F60:                          ; CODE XREF: sub_140276AE0+1473↑j
                mov     rdx, [rsp+178h+var_D0]
                mov     r8d, r14d
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                mov     r9, [rsp+178h+var_C8]
                cmp     r9, rax
                jb      short loc_140277FC8
                mov     rax, r11
                cmp     r9, rax
                ja      short loc_140277FC8
                call    sub_140349680
                test    eax, eax
                jz      short loc_140277FA4
                mov     r8d, r13d
                cmp     byte ptr cs:word_140C4DE88+1, r14b
                jnz     short loc_140277FC8
                jmp     short loc_140277FC0
; ---------------------------------------------------------------------------

loc_140277FA4:                          ; CODE XREF: sub_140276AE0+14B4↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140277FC8

loc_140277FC0:                          ; CODE XREF: sub_140276AE0+14C2↑j
                test    dl, 1
                jz      short loc_140277FC8
                or      rdx, rsi

loc_140277FC8:                          ; CODE XREF: sub_140276AE0+14A3↑j
                                        ; sub_140276AE0+14AB↑j ...
                mov     [r9], rdx
                test    r8d, r8d
                jz      short loc_140277FD8
                mov     rcx, r9
                call    sub_140349620

loc_140277FD8:                          ; CODE XREF: sub_140276AE0+14EE↑j
                cmp     [rsp+178h+var_140], r14d
                jz      short loc_140278002
                xorps   xmm0, xmm0
                movups  [rsp+178h+var_78], xmm0
                movups  [rsp+178h+var_68], xmm0
                lea     rdx, [rsp+178h+var_78]
                mov     rcx, r15
                call    sub_140243C30

loc_140278002:                          ; CODE XREF: sub_140276AE0+14FD↑j
                movzx   eax, byte ptr [r15+22h]
                and     al, 7
                cmp     al, 6
                jnz     loc_14027842D
                mov     rcx, [r15+18h]
                mov     rdx, rcx
                mov     r8, 3FFFFFFFFFFFFFFFh
                and     rdx, r8
                dec     rdx
                mov     rax, rcx
                xor     rax, rdx
                and     rax, r8
                xor     rax, rcx
                mov     [r15+18h], rax
                test    rdx, rdx
                jnz     short loc_140278045
                mov     rcx, r15
                call    sub_140278C00

loc_140278045:                          ; CODE XREF: sub_140276AE0+155B↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r15+18h], rax
                mov     [rsp+178h+var_F0], r14d
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_14027808F
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140278070:                          ; CODE XREF: sub_140276AE0+15A4↓j
                                        ; sub_140276AE0+15AD↓j
                lea     rcx, [rsp+178h+var_F0]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140278070
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140278070

loc_14027808F:                          ; CODE XREF: sub_140276AE0+1583↑j
                movzx   eax, byte ptr [rdi+22h]
                and     al, 0DFh
                mov     [rdi+22h], al
                movzx   ebx, word ptr [rdi+20h]
                test    bx, bx
                jz      loc_140278436
                sub     bx, 1
                mov     [rdi+20h], bx
                jnz     short loc_1402780BF
                mov     rcx, rdi
                call    sub_1402303F0
                test    eax, eax
                jnz     loc_14027826E

loc_1402780BF:                          ; CODE XREF: sub_140276AE0+15CD↑j
                mov     r8, [rdi+28h]
                mov     rax, 1000000000h
                test    rax, r8
                jnz     loc_140278296
                mov     rax, 2000000000000h
                test    rax, r8
                jnz     loc_140278296
                mov     r10, [rdi+18h]
                mov     rax, r10
                mov     rcx, 3FFFFFFFFFFFFFFFh
                and     rax, rcx
                test    bx, bx
                jz      short loc_14027812C
                cmp     bx, 1
                jnz     short loc_14027810F
                test    rax, rax
                jnz     short loc_14027812C
                jmp     short loc_140278122
; ---------------------------------------------------------------------------

loc_14027810F:                          ; CODE XREF: sub_140276AE0+1626↑j
                cmp     bx, 2
                jnz     loc_140278296
                test    rax, rax
                jz      loc_140278296

loc_140278122:                          ; CODE XREF: sub_140276AE0+162D↑j
                test    byte ptr [rdi+22h], 8
                jz      loc_140278296

loc_14027812C:                          ; CODE XREF: sub_140276AE0+1620↑j
                                        ; sub_140276AE0+162B↑j
                mov     r15, 0FFFFF68000000000h
                mov     rax, r15
                mov     r11, 3FFFFFFF78h
                add     r11, rax
                mov     r9, [rdi+8]
                or      r9, rsi
                cmp     r9, r11
                ja      short loc_14027815A
                mov     rax, r15
                cmp     r9, rax
                jnb     short loc_14027816C

loc_14027815A:                          ; CODE XREF: sub_140276AE0+1670↑j
                movzx   eax, byte ptr [rdi+23h]
                test    al, 20h
                jz      short loc_14027816C
                and     al, 0DFh
                mov     [rdi+23h], al
                jmp     loc_140278269
; ---------------------------------------------------------------------------

loc_14027816C:                          ; CODE XREF: sub_140276AE0+1678↑j
                                        ; sub_140276AE0+1680↑j
                mov     edx, r14d
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14027818A
                mov     eax, [rdi+10h]
                bt      rax, 0Ah
                jnb     short loc_14027818A
                mov     edx, r13d
                jmp     short loc_1402781B3
; ---------------------------------------------------------------------------

loc_14027818A:                          ; CODE XREF: sub_140276AE0+1699↑j
                                        ; sub_140276AE0+16A3↑j
                cmp     r9, r11
                ja      short loc_1402781A2
                mov     rax, r15
                cmp     r9, rax
                jb      short loc_1402781A2
                test    byte ptr [rdi+23h], 20h
                jz      short loc_1402781A2
                mov     edx, r13d
                jmp     short loc_1402781B3
; ---------------------------------------------------------------------------

loc_1402781A2:                          ; CODE XREF: sub_140276AE0+16AD↑j
                                        ; sub_140276AE0+16B5↑j ...
                test    bx, bx
                jnz     short loc_1402781B3
                shr     r10, 3Eh
                test    r10b, 1
                cmovnz  edx, r13d

loc_1402781B3:                          ; CODE XREF: sub_140276AE0+16A8↑j
                                        ; sub_140276AE0+16C0↑j ...
                shr     r8, 27h
                and     r8d, 3FFh
                mov     rax, cs:qword_140C4E4C8
                mov     rsi, [rax+r8*8]
                cmp     edx, 1
                jnz     short loc_1402781D9
                mov     rdx, r13
                mov     rcx, rsi
                call    sub_14026B700

loc_1402781D9:                          ; CODE XREF: sub_140276AE0+16EC↑j
                mov     r8, r13
                lea     rax, unk_140C50C00
                cmp     rsi, rax
                jnz     short loc_140278260
                mov     r9, gs:20h
                movsxd  rdx, dword ptr [r9+831Ch]
                mov     r10d, 0FFFFFFFFh
                cmp     edx, r10d
                jz      short loc_140278260
                lea     rcx, [rdx+1]
                cmp     rcx, 100h
                ja      short loc_140278234

loc_140278210:                          ; CODE XREF: sub_140276AE0+1752↓j
                lea     ecx, [rdx+1]
                mov     eax, edx
                lock cmpxchg [r9+831Ch], ecx
                movsxd  rdx, eax
                jz      short loc_140278269
                cmp     edx, r10d
                jz      short loc_140278234
                lea     rax, [rdx+1]
                cmp     rax, 100h
                jbe     short loc_140278210

loc_140278234:                          ; CODE XREF: sub_140276AE0+172E↑j
                                        ; sub_140276AE0+1746↑j
                mov     ecx, 0C0h
                cmp     edx, ecx
                jle     short loc_14027825B
                cmp     edx, r10d
                jz      short loc_14027825B
                mov     eax, edx
                lock cmpxchg [r9+831Ch], ecx
                jnz     short loc_14027825B
                lea     eax, [rdx-0C0h]
                movsxd  r8, eax
                inc     r8

loc_14027825B:                          ; CODE XREF: sub_140276AE0+175B↑j
                                        ; sub_140276AE0+1760↑j ...
                test    r8, r8
                jz      short loc_140278269

loc_140278260:                          ; CODE XREF: sub_140276AE0+1706↑j
                                        ; sub_140276AE0+1721↑j
                lock xadd [rsi+1C00h], r8

loc_140278269:                          ; CODE XREF: sub_140276AE0+1687↑j
                                        ; sub_140276AE0+1741↑j ...
                test    bx, bx
                jnz     short loc_140278296

loc_14027826E:                          ; CODE XREF: sub_140276AE0+15D9↑j
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    [rsp+178h+var_B8]
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                mov     rcx, rdi
                call    sub_140278860

loc_140278296:                          ; CODE XREF: sub_140276AE0+15F0↑j
                                        ; sub_140276AE0+1603↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                movzx   ebx, [rsp+178h+var_148]
                cmp     bl, 11h
                jz      short loc_14027830A
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140278303
                test    al, 1
                jz      short loc_140278303
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140278303
                cmp     bl, 0Fh
                ja      short loc_140278303
                cmp     al, 2
                jb      short loc_140278303
                mov     r9, gs:20h
                mov     r8, [r9+84B8h]
                mov     edx, [r8+14h]
                movzx   ebx, [rsp+178h+var_148]
                lea     ecx, [rbx+1]
                shl     r12, cl
                movzx   eax, r12w
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_140278303
                mov     rcx, r9
                call    sub_1403F2EC4

loc_140278303:                          ; CODE XREF: sub_140276AE0+17D7↑j
                                        ; sub_140276AE0+17DB↑j ...
                movzx   eax, bl
                mov     cr8, rax

loc_14027830A:                          ; CODE XREF: sub_140276AE0+17CD↑j
                mov     rax, [rsp+178h+var_C0]
                mov     [rax], r14d
                cmp     [rsp+178h+var_140], r14d
                jz      short loc_140278365
                or      qword ptr [rsp+178h+var_68+8], 4
                lea     rax, [rsp+178h+var_78]
                mov     [rsp+178h+var_50], rax
                mov     [rsp+178h+var_48], 20h ; ' '
                mov     r9d, 282h
                mov     [rsp+178h+var_158], 11401B02h
                mov     r8d, 20000001h
                mov     edx, r13d
                lea     rcx, [rsp+178h+var_50]
                call    sub_1402B8C20

loc_140278365:                          ; CODE XREF: sub_140276AE0+183A↑j
                neg     [rsp+178h+var_144]
                sbb     eax, eax
                and     eax, 4
                jmp     loc_140278401
; ---------------------------------------------------------------------------

loc_140278373:                          ; CODE XREF: sub_140276AE0+D42↑j
                                        ; sub_140276AE0+D54↑j ...
                movzx   edx, [rsp+178h+var_148]
                mov     rcx, rdi
                call    sub_140297330
                jmp     short loc_1402783F2
; ---------------------------------------------------------------------------

loc_140278382:                          ; CODE XREF: sub_140276AE0+9E6↑j
                                        ; sub_140276AE0+9F1↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax
                cmp     r12b, 11h
                jz      short loc_1402783F2
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_1402783EA
                test    al, 1
                jz      short loc_1402783EA
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_1402783EA
                cmp     r12b, 0Fh
                ja      short loc_1402783EA
                cmp     al, 2
                jb      short loc_1402783EA
                mov     r9, gs:20h
                mov     r8, [r9+84B8h]
                mov     edx, [r8+14h]
                movzx   ecx, r12b
                inc     ecx
                shl     r14, cl
                movzx   eax, r14w
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_1402783EA
                mov     rcx, r9
                call    sub_1403F2EC4

loc_1402783EA:                          ; CODE XREF: sub_140276AE0+18BF↑j
                                        ; sub_140276AE0+18C3↑j ...
                movzx   eax, r12b
                mov     cr8, rax

loc_1402783F2:                          ; CODE XREF: sub_140276AE0+483↑j
                                        ; sub_140276AE0+493↑j ...
                mov     rcx, [rsp+178h+var_138]
                call    sub_1403B748C
                mov     eax, 1

loc_140278401:                          ; CODE XREF: sub_140276AE0+23F↑j
                                        ; sub_140276AE0+401↑j ...
                mov     rcx, [rsp+178h+var_40]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 140h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140278425:                          ; CODE XREF: sub_140276AE0+3C2↑j
                mov     rdx, rax
                jmp     loc_140276E90
; ---------------------------------------------------------------------------

loc_14027842D:                          ; CODE XREF: sub_140276AE0+152B↑j
                mov     rcx, r15
                call    sub_1403F4244
; ---------------------------------------------------------------------------
                align 2

loc_140278436:                          ; CODE XREF: sub_140276AE0+15BF↑j
                mov     rcx, rdi
                call    sub_1403F41EC
sub_140276AE0   endp

; ---------------------------------------------------------------------------
                db 90h
; } // starts at 140276AE0
byte_14027843F  db 11h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE61C↑o

; =============== S U B R O U T I N E =======================================


sub_140278450   proc near               ; CODE XREF: sub_14026CC48+61↑p
                                        ; sub_14053D330+7B↓p
                                        ; DATA XREF: ...

var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
arg_0           = dword ptr  8
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 00000001404427C8 SIZE 000001BF BYTES

                cmp     rcx, rdx
                jnb     locret_140278640
                mov     rax, rsp
                push    rsi
                push    r12
                push    r13
                sub     rsp, 60h
                mov     r13d, [r8]
                mov     r12, rdx

loc_14027846B:                          ; DATA XREF: .rdata:000000014005DD34↑o
                                        ; .rdata:000000014005DD44↑o ...
                mov     [rax+18h], rbx
                mov     rsi, rcx
                mov     [rax-20h], rbp
                mov     edx, 2
                mov     [rax-28h], rdi
                mov     r10d, 0C0h
                mov     [rax-30h], r14
                mov     r14, 7FFFFFFFFFFFFFFFh
                mov     [rax-38h], r15
                shr     r13d, 1Fh
                mov     rcx, 0FFFFFA8000000000h
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_1402784B0:                          ; CODE XREF: sub_140278450+1C5↓j
                mov     rax, [rsi]
                lea     rbx, [rax+rax*2]
                shl     rbx, 4
                mov     rax, rcx
                add     rbx, rax
                mov     r15, cr8
                mov     cr8, rdx
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404427C8

loc_1402784D7:                          ; CODE XREF: sub_140278450+1CA37A↓j
                                        ; sub_140278450+1CA384↓j ...
                mov     [rsp+78h+arg_0], 0
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      loc_1402786C0

loc_1402784EF:                          ; CODE XREF: sub_140278450+295↓j
                mov     rax, cs:qword_140C4E4C8
                xorps   xmm0, xmm0
                mov     rcx, [rbx+28h]
                mov     ebp, 1
                shr     rcx, 27h
                and     ecx, 3FFh
                movups  [rsp+78h+var_58], xmm0
                mov     rdi, [rax+rcx*8]
                xor     eax, eax
                mov     [rsp+78h+var_48], rax
                cmp     [rdi+1878h], rax
                jnz     loc_14044280D

loc_140278529:                          ; CODE XREF: sub_140278450+1CA464↓j
                lea     rax, unk_140C50C00
                cmp     rdi, rax
                jnz     loc_140278642
                mov     rdx, gs:20h
                prefetchw byte ptr [rdx+8318h]
                mov     eax, [rdx+8318h]
                mov     r8d, eax
                add     rax, rbp
                cmp     rax, 100h
                ja      loc_140278642

loc_140278561:                          ; CODE XREF: sub_140278450+1CA476↓j
                lea     ecx, [r8+rbp]
                mov     eax, r8d
                lock cmpxchg [rdx+8318h], ecx
                movsxd  rcx, eax
                cmp     rcx, r8
                jnz     loc_1404428B9

loc_14027857C:                          ; CODE XREF: sub_140278450+221↓j
                                        ; sub_140278450+1CA45E↓j ...
                lea     rax, unk_140C50C00
                mov     r9d, 1
                cmp     rdi, rax
                jnz     loc_1402786A8
                mov     r8, gs:20h
                movsxd  rdx, dword ptr [r8+831Ch]
                cmp     edx, 0FFFFFFFFh
                jz      loc_1402786A8
                lea     rcx, [rdx+1]
                cmp     rcx, 100h
                ja      loc_14027867C

loc_1402785BC:                          ; CODE XREF: sub_140278450+1CA4C2↓j
                lea     ecx, [rdx+1]
                mov     eax, edx
                lock cmpxchg [r8+831Ch], ecx
                movsxd  rdx, eax
                jnz     loc_1404428FF

loc_1402785D3:                          ; CODE XREF: sub_140278450+252↓j
                                        ; sub_140278450+261↓j
                mov     edx, r13d
                mov     rcx, rbx
                call    sub_1402786F0
                lock and [rbx+18h], r14
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14044291D

loc_1402785F1:                          ; CODE XREF: sub_140278450+1CA4CF↓j
                                        ; sub_140278450+1CA4DB↓j ...
                movzx   eax, r15b
                mov     cr8, rax
                add     rsi, 8
                mov     rcx, 0FFFFFA8000000000h
                mov     edx, 2
                mov     r10d, 0C0h
                cmp     rsi, r12
                jb      loc_1402784B0
                mov     r15, [rsp+78h+var_38]
                mov     r14, [rsp+78h+var_30]
                mov     rdi, [rsp+78h+var_28]
                mov     rbp, [rsp+78h+var_20]
                mov     rbx, [rsp+78h+arg_10]
                add     rsp, 60h
                pop     r13
                pop     r12
                pop     rsi

locret_140278640:                       ; CODE XREF: sub_140278450+3↑j
                retn
; ---------------------------------------------------------------------------
algn_140278641:                         ; DATA XREF: .pdata:00000001400CE634↑o
                                        ; .pdata:00000001400CE640↑o
                align 2

loc_140278642:                          ; CODE XREF: sub_140278450+E3↑j
                                        ; sub_140278450+10B↑j ...
                mov     rcx, rbp
                neg     rcx
                lock xadd [rdi+1D28h], rcx
                mov     rdx, [rdi+1860h]
                cmp     rcx, rdx
                jnb     loc_1404428D1

loc_140278661:                          ; CODE XREF: sub_140278450+1CA48C↓j
                mov     rdx, [rdi+1858h]
                mov     rax, rcx
                sub     rax, rbp
                cmp     rcx, rdx
                jb      loc_14027857C
                jmp     loc_1404428E1
; ---------------------------------------------------------------------------

loc_14027867C:                          ; CODE XREF: sub_140278450+166↑j
                                        ; sub_140278450+1CA4B2↓j ...
                cmp     edx, r10d
                jle     short loc_14027869F
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14027869F
                mov     eax, edx
                lock cmpxchg [r8+831Ch], r10d
                jnz     short loc_14027869F
                lea     eax, [rdx-0C0h]
                movsxd  r9, eax
                inc     r9

loc_14027869F:                          ; CODE XREF: sub_140278450+22F↑j
                                        ; sub_140278450+234↑j ...
                test    r9, r9
                jz      loc_1402785D3

loc_1402786A8:                          ; CODE XREF: sub_140278450+13C↑j
                                        ; sub_140278450+155↑j
                lock xadd [rdi+1C00h], r9
                jmp     loc_1402785D3
; ---------------------------------------------------------------------------
                align 20h

loc_1402786C0:                          ; CODE XREF: sub_140278450+99↑j
                                        ; sub_140278450+284↓j ...
                lea     rcx, [rsp+78h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_1402786C0
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_1402786C0
                mov     r10d, 0C0h
                jmp     loc_1402784EF
sub_140278450   endp

; ---------------------------------------------------------------------------
algn_1402786EA:                         ; DATA XREF: .pdata:00000001400CE64C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402786F0   proc near               ; CODE XREF: sub_140278450+189↑p
                                        ; sub_1402CB390+1B4↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140442988 SIZE 00000069 BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                mov     [rsp+arg_18], rsi
                push    rdi
                sub     rsp, 20h
                xor     edi, edi
                mov     ebx, edx
                mov     rsi, rcx
                test    dl, 1
                jnz     loc_1402787A3
                test    bl, 2
                jnz     loc_1402787E1

loc_14027871D:                          ; CODE XREF: sub_1402786F0+CE↓j
                                        ; sub_1402786F0+147↓j
                movzx   eax, byte ptr [rsi+22h]
                and     al, 0F7h
                mov     [rsi+22h], al
                mov     eax, 0FFFFh
                add     [rsi+20h], ax
                jnz     short loc_14027878A
                mov     eax, [rsi+10h]
                bt      rax, 0Ah
                jnb     loc_1402787C3

loc_14027873F:                          ; CODE XREF: sub_1402786F0+DD↓j
                                        ; sub_1402786F0+1CA2B6↓j ...
                test    bl, 8
                jnz     loc_1402787D8

loc_140278748:                          ; CODE XREF: sub_1402786F0+EC↓j
                mov     rax, 0FFFFFA8000000000h
                mov     rcx, rsi
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rcx, rsi
                mov     rbp, rdx
                sar     rbp, 3
                mov     rax, rbp
                shr     rax, 3Fh
                add     rbp, rax
                test    bl, 4
                jnz     loc_1404429D4
                mov     rdx, rbp
                call    sub_140278860

loc_14027878A:                          ; CODE XREF: sub_1402786F0+3F↑j
                                        ; sub_1402786F0+1CA2FC↓j
                mov     rbx, [rsp+28h+arg_8]
                mov     rax, rdi
                mov     rbp, [rsp+28h+arg_10]
                mov     rsi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402787A3:                          ; CODE XREF: sub_1402786F0+1E↑j
                mov     eax, [rcx+10h]
                add     rcx, 10h
                bt      rax, 0Ah
                jnb     loc_140442988

loc_1402787B5:                          ; CODE XREF: sub_1402786F0+1CA2A7↓j
                movzx   eax, byte ptr [rsi+22h]
                or      al, 10h
                mov     [rsi+22h], al
                jmp     loc_14027871D
; ---------------------------------------------------------------------------

loc_1402787C3:                          ; CODE XREF: sub_1402786F0+49↑j
                mov     rax, [rsi+18h]
                shr     rax, 3Eh
                test    al, 1
                jz      loc_14027873F
                jmp     loc_14044299C
; ---------------------------------------------------------------------------

loc_1402787D8:                          ; CODE XREF: sub_1402786F0+52↑j
                and     byte ptr [rsi+23h], 0F8h
                jmp     loc_140278748
; ---------------------------------------------------------------------------

loc_1402787E1:                          ; CODE XREF: sub_1402786F0+27↑j
                mov     r9, [rcx+28h]
                lea     rdx, [rcx+10h]
                mov     rcx, cs:qword_140C4E4C8
                mov     rax, r9
                shr     rax, 27h
                and     eax, 3FFh

loc_1402787FC:                          ; DATA XREF: .rdata:000000014005DDB8↑o
                                        ; .rdata:000000014005DDCC↑o ...
                mov     [rsp+28h+arg_0], r14
                mov     rcx, [rcx+rax*8]
                call    sub_140340134
                mov     ebp, eax
                test    eax, eax
                jnz     short loc_14027881A
                mov     ecx, [rsi+10h]
                shr     cl, 1
                test    cl, 1
                jnz     short loc_14027883C

loc_14027881A:                          ; CODE XREF: sub_1402786F0+11E↑j
                                        ; sub_1402786F0+158↓j ...
                mov     r8d, ebp
                lea     rcx, [rsi+10h]
                mov     edx, 1
                call    sub_140338C90
                mov     rdi, rax
                test    ebp, ebp
                jnz     short loc_140278851

loc_140278832:                          ; CODE XREF: sub_1402786F0+166↓j
                mov     r14, [rsp+28h+arg_0]
                jmp     loc_14027871D
; ---------------------------------------------------------------------------

loc_14027883C:                          ; CODE XREF: sub_1402786F0+128↑j
                                        ; DATA XREF: .pdata:00000001400CE664↑o ...
                shr     r9, 3Ch
                and     r9b, 7
                cmp     r9b, 2
                jnz     short loc_14027881A
                mov     ebp, 1
                jmp     short loc_14027881A
; ---------------------------------------------------------------------------

loc_140278851:                          ; CODE XREF: sub_1402786F0+140↑j
                and     qword ptr [rsi+10h], 0FFFFFFFFFFFFFFFDh
                jmp     short loc_140278832
sub_1402786F0   endp

; ---------------------------------------------------------------------------
algn_140278858:                         ; DATA XREF: .pdata:00000001400CE670↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140278860   proc near               ; CODE XREF: sub_14022CA60+B75↑p
                                        ; sub_14022DE20+A37↑p ...

var_18          = qword ptr -18h

; FUNCTION CHUNK AT 00000001404429F2 SIZE 0000001A BYTES

                push    rbx
                sub     rsp, 30h
                mov     rax, [rcx+18h]
                mov     rbx, rdx
                mov     r9, rax
                mov     rdx, 3FFFFFFFFFFFFFFFh
                and     r9, rdx
                jnz     loc_1404429F2
                shr     rax, 3Eh
                test    al, 1
                jnz     short loc_1402788D4
                mov     rdx, [rcx+10h]
                mov     rax, 0FFFFFFFFFFFFFFF7h
                bt      rdx, 0Ah
                mov     r8, 0FFFFFFFFFFFFF7FFh
                cmovb   rax, r8
                and     rax, rdx
                mov     [rcx+10h], rax
                test    byte ptr [rcx+22h], 10h
                jnz     short loc_1402788C3
                lea     edx, [r9+4]
                call    sub_140279270
                add     rsp, 30h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402788C3:                          ; CODE XREF: sub_140278860+51↑j
                mov     edx, 8
                call    sub_140279270
                add     rsp, 30h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 4

loc_1402788D4:                          ; CODE XREF: sub_140278860+29↑j
                movzx   eax, byte ptr [rcx+23h]
                test    al, 10h
                jnz     short loc_140278917

loc_1402788DC:                          ; CODE XREF: sub_140278860+BC↓j
                mov     rax, [rcx+28h]
                mov     r8d, 1
                mov     rdx, [rcx+10h]
                mov     rcx, cs:qword_140C4E4C8
                shr     rax, 27h
                and     eax, 3FFh
                mov     rcx, [rcx+rax*8]
                call    sub_1402D9B64
                mov     edx, 2
                mov     rcx, rbx
                call    sub_140292A50
                add     rsp, 30h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140278917:                          ; CODE XREF: sub_140278860+7A↑j
                and     al, 0EFh
                mov     [rcx+23h], al
                jmp     short loc_1402788DC
sub_140278860   endp

; ---------------------------------------------------------------------------
byte_14027891E  db 12h dup(0CCh)        ; DATA XREF: .rdata:000000014005DDFC↑o
                                        ; .pdata:00000001400CE67C↑o

; =============== S U B R O U T I N E =======================================


sub_140278930   proc near               ; CODE XREF: sub_14027EB10+254↓p
                                        ; sub_1402973D0+3C9↓p ...

var_68          = qword ptr -68h
var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_18          = byte ptr  20h

; FUNCTION CHUNK AT 0000000140442A0C SIZE 000000AE BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_18], r9b
                mov     [rsp+arg_8], rdx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 50h
                xor     r13d, r13d
                mov     ebp, r8d
                xor     eax, eax
                xorps   xmm0, xmm0
                mov     [rsp+88h+var_48], rax
                movzx   ebx, r9b
                mov     r14, rdx
                mov     rsi, rcx
                mov     r15d, r13d
                movups  [rsp+88h+var_58], xmm0
                test    rcx, rcx
                jnz     loc_140278BA7
                mov     r12d, 0FFFFFFh
                mov     esi, r13d
                test    r8d, r8d
                jz      loc_140278AC3
                mov     rax, 0FFFFFA8000000000h
                mov     rdx, 2AAAAAAAAAAAAAABh
                mov     r8, 3FFFFFFFFFFFFFFFh
                mov     r10, 2000000000000h
                nop     dword ptr [rax+00h]
                nop     word ptr [rax+rax+00000000h]

loc_1402789C0:                          ; CODE XREF: sub_140278930+16A↓j
                mov     rdi, [r14]
                mov     rax, rax
                mov     r9, [rdi+18h]
                mov     rcx, rdi
                sub     rcx, rax
                mov     rax, rdx
                imul    rcx
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                and     r9, r8
                jnz     loc_140442A39
                movzx   ecx, byte ptr [rdi+22h]
                movzx   eax, cl
                and     al, 7
                cmp     al, 6
                jz      loc_140442A39
                test    cl, 10h
                jnz     loc_140442A39
                mov     r8, [rdi+28h]
                test    r10, r8
                jnz     loc_140442A16
                movzx   eax, byte ptr [rdi+23h]
                test    al, 40h
                jnz     loc_140442A16
                test    al, 8
                jnz     loc_140442A0C
                mov     ebx, eax
                and     ebx, 7

loc_140278A2D:                          ; CODE XREF: sub_140278930+1CA0E1↓j
                mov     rdx, r8
                shr     rdx, 27h
                test    r15, r15
                jz      loc_140278B8E

loc_140278A3D:                          ; CODE XREF: sub_140278930+272↓j
                cmp     ebx, r12d
                jnz     loc_140278B41
                mov     rax, cs:qword_140C4E4C8
                and     edx, 3FFh
                cmp     r15, [rax+rdx*8]
                jnz     loc_140278B41

loc_140278A5D:                          ; CODE XREF: sub_140278930+259↓j
                mov     edx, 84h

loc_140278A62:                          ; CODE XREF: sub_140278930+1CA104↓j
                mov     rcx, rdi
                call    sub_140279270
                inc     esi
                mov     rax, 0FFFFFA8000000000h
                add     r14, 8
                mov     r10, 2000000000000h
                mov     rdx, 2AAAAAAAAAAAAAABh
                mov     r8, 3FFFFFFFFFFFFFFFh
                cmp     esi, ebp
                jb      loc_1402789C0
                cmp     r12d, 0FFFFFFh
                jz      short loc_140278AB3
                lea     rcx, [rsp+88h+var_58]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel

loc_140278AB3:                          ; CODE XREF: sub_140278930+177↑j
                mov     r14, [rsp+88h+arg_8]

loc_140278ABB:                          ; CODE XREF: sub_140278930+2A5↓j
                movzx   ebx, [rsp+88h+arg_18]

loc_140278AC3:                          ; CODE XREF: sub_140278930+55↑j
                                        ; sub_140278930+27A↓j
                cmp     bl, 11h
                lea     ecx, [rbp-1]
                mov     r8, 7FFFFFFFFFFFFFFFh
                cmovz   ecx, ebp
                test    ecx, ecx
                jz      short loc_140278B02
                mov     rax, r14
                mov     edx, ecx
                mov     r13d, ecx
                nop     dword ptr [rax+00h]
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140278AF0:                          ; CODE XREF: sub_140278930+1D0↓j
                mov     rcx, [rax]
                lock and [rcx+18h], r8
                lea     rax, [rax+8]
                sub     rdx, 1
                jnz     short loc_140278AF0

loc_140278B02:                          ; CODE XREF: sub_140278930+1A8↑j
                cmp     bl, 11h
                jz      short loc_140278B28
                mov     eax, r13d
                mov     rcx, [r14+rax*8]
                lock and [rcx+18h], r8
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140442A52

loc_140278B21:                          ; CODE XREF: sub_140278930+1CA124↓j
                                        ; sub_140278930+1CA130↓j ...
                movzx   eax, bl
                mov     cr8, rax

loc_140278B28:                          ; CODE XREF: sub_140278930+1D5↑j
                mov     rbx, [rsp+88h+arg_0]
                add     rsp, 50h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140278B41:                          ; CODE XREF: sub_140278930+110↑j
                                        ; sub_140278930+127↑j
                cmp     r12d, 0FFFFFFh
                jnz     loc_140278BDA

loc_140278B4E:                          ; CODE XREF: sub_140278930+2B8↓j
                mov     rax, cs:qword_140C4E4C8
                mov     r12d, ebx
                shr     r8, 27h
                and     r8d, 3FFh
                mov     r15, [rax+r8*8]
                mov     eax, ebx
                mov     qword ptr [rsp+88h+var_58], r13
                lea     rcx, [rax+4Dh]
                lea     rcx, [rax+rcx*4]
                lea     rdx, [r15+rcx*8]
                lea     rcx, [rsp+88h+var_58]
                mov     qword ptr [rsp+88h+var_58+8], rdx
                call    sub_14024B3F0
                jmp     loc_140278A5D
; ---------------------------------------------------------------------------

loc_140278B8E:                          ; CODE XREF: sub_140278930+107↑j
                mov     rax, cs:qword_140C4E4C8
                mov     rcx, rdx
                and     ecx, 3FFh
                mov     r15, [rax+rcx*8]
                jmp     loc_140278A3D
; ---------------------------------------------------------------------------

loc_140278BA7:                          ; CODE XREF: sub_140278930+43↑j
                test    r8d, r8d
                jz      loc_140278AC3
                mov     rbx, rdx
                mov     rdi, rbp
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140278BC0:                          ; CODE XREF: sub_140278930+2A3↓j
                mov     rdx, [rbx]
                mov     rcx, rsi
                call    sub_14027BEE0
                lea     rbx, [rbx+8]
                sub     rdi, 1
                jnz     short loc_140278BC0
                jmp     loc_140278ABB
; ---------------------------------------------------------------------------

loc_140278BDA:                          ; CODE XREF: sub_140278930+218↑j
                lea     rcx, [rsp+88h+var_58]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     r8, [rdi+28h]
                jmp     loc_140278B4E
sub_140278930   endp

; ---------------------------------------------------------------------------
algn_140278BED:                         ; DATA XREF: .rdata:000000014005DE28↑o
                                        ; .pdata:00000001400CE688↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140278C00   proc near               ; CODE XREF: MmUnlockPages+BA1↑p
                                        ; sub_140276AE0+1560↑p ...

var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                push    rbx
                push    rbp
                push    rdi
                push    r12
                sub     rsp, 38h
                mov     r12, rdx
                mov     rbp, rcx
                call    sub_1403F41D8
                mov     rdi, 0FFFFFA8000000000h
                test    eax, eax
                jz      loc_1402790AB

loc_140278C27:                          ; DATA XREF: .rdata:000000014005DE54↑o
                                        ; .rdata:000000014005DE68↑o ...
                mov     [rsp+58h+arg_8], rsi
                lea     r8, [rcx+10h]
                mov     rsi, [r8]
                mov     [rsp+58h+var_28], r13
                mov     [rsp+58h+var_30], r14

loc_140278C3D:                          ; DATA XREF: .rdata:000000014005DE68↑o
                                        ; .rdata:000000014005DE78↑o ...
                mov     [rsp+58h+var_38], r15
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                mov     rcx, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                jb      short loc_140278CC8
                mov     rax, rcx
                cmp     r8, rax
                ja      short loc_140278CC8
                call    sub_140349680
                test    eax, eax
                jz      short loc_140278CC8
                test    sil, 1
                jz      short loc_140278CC8
                test    sil, 20h
                jz      short loc_140278C81
                test    sil, 42h
                jnz     short loc_140278CC8

loc_140278C81:                          ; CODE XREF: sub_140278C00+79↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140278CC8
                shr     r8, 3
                mov     rdx, rsi
                and     r8d, 1FFh
                or      rdx, 20h
                mov     rax, [rax+r8*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rsi
                mov     rsi, rdx
                test    al, 42h
                jz      short loc_140278CC8
                or      rsi, 42h

loc_140278CC8:                          ; CODE XREF: sub_140278C00+5C↑j
                                        ; sub_140278C00+64↑j ...
                mov     r8, [rbp+28h]
                mov     rax, 0FFFFFFFFFh
                mov     r15, [rbp+8]
                and     r8, rax
                shr     rsi, 5
                mov     edx, 4
                lea     rcx, [r8+r8*2]
                add     rcx, rcx
                mov     rax, rdi
                movzx   eax, byte ptr [rax+rcx*8+22h]
                shr     eax, 6
                test    eax, eax
                jz      short loc_140278D0B
                cmp     eax, 3
                jz      short loc_140278D0B
                cmp     eax, 2
                jnz     short loc_140278D10
                lea     edx, [rax+1Ah]
                jmp     short loc_140278D10
; ---------------------------------------------------------------------------

loc_140278D0B:                          ; CODE XREF: sub_140278C00+FA↑j
                                        ; sub_140278C00+FF↑j
                mov     edx, 0Ch

loc_140278D10:                          ; CODE XREF: sub_140278C00+104↑j
                                        ; sub_140278C00+109↑j
                mov     ebx, edx
                shl     r8, 0Ch
                and     ebx, 1Fh
                mov     r13, 0FFFFF68000000000h
                lea     rax, qword_140017520
                mov     rbx, [rax+rbx*8]
                mov     rax, 0FFFF000000000E7Fh
                and     rbx, rax
                or      rbx, r8
                or      rbx, 21h
                mov     rax, r13
                test    rax, rax
                jnz     short loc_140278DA2
                mov     rdi, r13
                neg     rdi
                shl     rdi, 19h
                sar     rdi, 10h
                mov     rax, 0FFFFF6FB40000000h
                test    rax, rax
                jnz     short loc_140278D83
                mov     rax, 7FFFFFFFFFFFFFFFh
                xor     ecx, ecx
                and     rbx, rax
                call    sub_14033FA34
                test    eax, eax
                jz      short loc_140278D83
                or      rbx, 4

loc_140278D83:                          ; CODE XREF: sub_140278C00+165↑j
                                        ; sub_140278C00+17D↑j
                mov     r8, rbx
                mov     rcx, rdi
                or      rbx, 4
                call    sub_140271580
                test    eax, eax
                jz      short loc_140278DA7
                mov     rbx, r8
                or      rbx, 104h
                jmp     short loc_140278DA7
; ---------------------------------------------------------------------------

loc_140278DA2:                          ; CODE XREF: sub_140278C00+148↑j
                bts     rbx, 8

loc_140278DA7:                          ; CODE XREF: sub_140278C00+194↑j
                                        ; sub_140278C00+1A0↑j
                movzx   edi, byte ptr cs:word_140C4DE88
                mov     rax, 0FAFFFFFFFFFFFEFFh
                mov     r14, gs:20h
                and     edi, 1
                and     rbx, rax
                shl     rdi, 8
                or      rdi, rbx
                mov     rax, 0A00000000000042h
                or      rdi, rax
                mov     rbx, [r14+7FF8h]
                test    rbx, rbx
                jz      short loc_140278E29
                xor     r9d, r9d
                lea     rcx, [rbx+30A0h]
                lea     edx, [r9+3]
                lea     r8d, [r9+1]
                call    sub_140292240
                mov     r8, rax
                mov     rdx, 7FFFFFFFF8h
                shr     r8, 9
                mov     r11, rax
                and     r8, rdx
                mov     rcx, r13
                add     r8, rcx
                mov     [rbx+3038h], r8
                test    rax, rax
                jnz     short loc_140278E61
                jmp     short loc_140278E33
; ---------------------------------------------------------------------------

loc_140278E29:                          ; CODE XREF: sub_140278C00+1E5↑j
                mov     rdx, 7FFFFFFFF8h

loc_140278E33:                          ; CODE XREF: sub_140278C00+227↑j
                mov     r11, [r14+8200h]
                mov     rax, r11
                and     r11d, 0FFFh
                shl     r11, 0Ch
                and     rax, 0FFFFFFFFFFFFF000h
                add     r11, rax
                mov     r8, r11
                shr     r8, 9
                and     r8, rdx
                mov     rax, r13
                add     r8, rax

loc_140278E61:                          ; CODE XREF: sub_140278C00+225↑j
                mov     r13, 0FFFFF6FB7DBED000h
                mov     rax, r13
                mov     r14, 0FFFFF6FB7DBED7F8h
                mov     rbx, 8000000000000000h
                cmp     r8, rax
                jb      short loc_140278ED3
                mov     rax, r14
                cmp     r8, rax
                ja      short loc_140278ED3
                call    sub_140349680
                test    eax, eax
                jz      short loc_140278EB4
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140278EA4
                or      rdi, rbx

loc_140278EA4:                          ; CODE XREF: sub_140278C00+29F↑j
                mov     rdx, rdi
                mov     [r8], rdi
                mov     rcx, r8
                call    sub_140349620
                jmp     short loc_140278ED6
; ---------------------------------------------------------------------------

loc_140278EB4:                          ; CODE XREF: sub_140278C00+296↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140278ED3
                or      rdi, rbx

loc_140278ED3:                          ; CODE XREF: sub_140278C00+285↑j
                                        ; sub_140278C00+28D↑j ...
                mov     [r8], rdi

loc_140278ED6:                          ; CODE XREF: sub_140278C00+2B2↑j
                shr     r15, 3
                and     r15d, 1FFh
                mov     r8, [r11+r15*8]
                lea     r11, [r11+r15*8]
                mov     rax, r13
                mov     r15, [rsp+58h+var_38]
                cmp     r11, rax
                jb      short loc_140278F61

loc_140278EF6:                          ; DATA XREF: .pdata:00000001400CE6AC↑o
                                        ; .pdata:00000001400CE6B8↑o
                mov     rax, r14
                cmp     r11, rax
                ja      short loc_140278F61
                call    sub_140349680
                test    eax, eax
                jz      short loc_140278F61
                test    r8b, 1
                jz      short loc_140278F61
                test    r8b, 20h
                jz      short loc_140278F19
                test    r8b, 42h
                jnz     short loc_140278F61

loc_140278F19:                          ; CODE XREF: sub_140278C00+311↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140278F61
                mov     rax, r11
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r8
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_140278F61
                or      r8, 42h

loc_140278F61:                          ; CODE XREF: sub_140278C00+2F4↑j
                                        ; sub_140278C00+2FC↑j ...
                mov     [rsp+58h+arg_0], r8
                mov     rax, r13
                lea     rcx, [rsp+58h+arg_0]
                cmp     rcx, rax
                jb      short loc_140278FE5
                mov     rax, r14
                lea     rcx, [rsp+58h+arg_0]
                cmp     rcx, rax
                ja      short loc_140278FE5
                call    sub_140349680
                test    eax, eax
                jz      short loc_140278FE5
                test    r8b, 1
                jz      short loc_140278FE5
                test    r8b, 20h
                jz      short loc_140278F9B
                test    r8b, 42h
                jnz     short loc_140278FE5

loc_140278F9B:                          ; CODE XREF: sub_140278C00+393↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140278FE5
                lea     rax, [rsp+58h+arg_0]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r8
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_140278FE5
                or      r8, 42h

loc_140278FE5:                          ; CODE XREF: sub_140278C00+371↑j
                                        ; sub_140278C00+37E↑j ...
                mov     rcx, cs:qword_140C4DDC0
                mov     edx, esi
                mov     rsi, [rsp+58h+arg_8]
                and     edx, 1Fh
                or      rdx, 40h
                mov     rax, 0FFFFFFFFF000h
                shl     rdx, 5
                and     r8, rax
                or      rdx, r8
                test    rcx, rcx
                jz      short loc_140279024

loc_140279013:                          ; DATA XREF: .pdata:00000001400CE6B8↑o
                                        ; .pdata:00000001400CE6C4↑o
                mov     rax, rdx
                and     rax, rcx
                jnz     short loc_140279020
                or      rdx, rcx
                jmp     short loc_140279024
; ---------------------------------------------------------------------------

loc_140279020:                          ; CODE XREF: sub_140278C00+419↑j
                or      rdx, 10h

loc_140279024:                          ; CODE XREF: sub_140278C00+411↑j
                                        ; sub_140278C00+41E↑j
                mov     [rsp+58h+arg_0], rdx
                mov     rax, r13
                mov     r13, [rsp+58h+var_28]
                cmp     r11, rax
                jb      short loc_140279089

loc_140279036:                          ; DATA XREF: .pdata:00000001400CE6C4↑o
                                        ; .pdata:00000001400CE6D0↑o
                mov     rax, r14
                cmp     r11, rax
                ja      short loc_140279089
                call    sub_140349680
                test    eax, eax
                jz      short loc_140279065
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140279058
                test    dl, 1
                jz      short loc_140279058
                or      rdx, rbx

loc_140279058:                          ; CODE XREF: sub_140278C00+44E↑j
                                        ; sub_140278C00+453↑j
                mov     rcx, r11
                mov     [r11], rdx
                call    sub_140349620
                jmp     short loc_14027908C
; ---------------------------------------------------------------------------

loc_140279065:                          ; CODE XREF: sub_140278C00+445↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140279089
                test    dl, 1
                jz      short loc_140279089
                or      rdx, rbx

loc_140279089:                          ; CODE XREF: sub_140278C00+434↑j
                                        ; sub_140278C00+43C↑j ...
                mov     [r11], rdx

loc_14027908C:                          ; CODE XREF: sub_140278C00+463↑j
                mov     r8d, 80000000h
                mov     dl, 11h
                mov     rcx, r11
                call    sub_1402432B0
                mov     r14, [rsp+58h+var_30]
                mov     rdi, 0FFFFFA8000000000h

loc_1402790AB:                          ; CODE XREF: sub_140278C00+21↑j
                                        ; DATA XREF: .pdata:00000001400CE6D0↑o ...
                mov     rcx, [rbp+18h]
                mov     eax, 0FFFFh
                add     [rbp+20h], ax
                shr     rcx, 3Eh
                and     ecx, 1
                cmp     word ptr [rbp+20h], 0
                jz      short loc_140279129
                movzx   eax, byte ptr [rbp+22h]
                test    ecx, ecx
                jz      short loc_1402790D2
                or      al, 7
                jmp     short loc_1402790E0
; ---------------------------------------------------------------------------

loc_1402790D2:                          ; CODE XREF: sub_140278C00+4CC↑j
                test    al, 10h
                jz      short loc_1402790DC
                and     al, 0FBh
                or      al, 3
                jmp     short loc_1402790E0
; ---------------------------------------------------------------------------

loc_1402790DC:                          ; CODE XREF: sub_140278C00+4D4↑j
                and     al, 0FAh
                or      al, 2

loc_1402790E0:                          ; CODE XREF: sub_140278C00+4D0↑j
                                        ; sub_140278C00+4DA↑j
                lea     rcx, [rbp+10h]
                mov     [rbp+22h], al
                mov     eax, [rcx]
                bt      rax, 0Ah
                jb      short loc_140279119
                call    sub_1402DF6E4
                test    eax, eax
                jz      short loc_140279119
                mov     rdx, [rbp+28h]
                mov     rcx, cs:qword_140C4E4C8
                shr     rdx, 27h
                and     edx, 3FFh
                mov     rdx, [rcx+rdx*8]
                mov     byte ptr [rdx+2A3h], 1

loc_140279119:                          ; CODE XREF: sub_140278C00+4EE↑j
                                        ; sub_140278C00+4F7↑j
                mov     eax, 3
                add     rsp, 38h
                pop     r12
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140279129:                          ; CODE XREF: sub_140278C00+4C4↑j
                test    ecx, ecx
                jz      loc_1402791D3
                movzx   eax, byte ptr [rbp+23h]
                test    al, 10h
                jz      short loc_14027913E
                and     al, 0EFh
                mov     [rbp+23h], al

loc_14027913E:                          ; CODE XREF: sub_140278C00+537↑j
                mov     rdx, [rbp+10h]
                mov     rcx, [rbp+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     [rsp+58h+arg_10], rdx
                mov     rbx, [rax+rcx*8]
                bt      rdx, 0Ah
                jb      short loc_140279195
                movzx   eax, dl
                shr     al, 2
                test    al, 1
                jnz     short loc_140279178
                shr     dl, 1
                test    dl, 1
                jz      short loc_140279195

loc_140279178:                          ; CODE XREF: sub_140278C00+56F↑j
                lea     rcx, [rsp+58h+arg_10]
                call    sub_1402805F0
                test    rax, rax
                jz      short loc_140279195
                xor     r8d, r8d
                mov     rdx, rax
                mov     rcx, rbx
                call    sub_14020B2C0

loc_140279195:                          ; CODE XREF: sub_140278C00+565↑j
                                        ; sub_140278C00+576↑j ...
                mov     rcx, rdi
                sub     rbp, rcx
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rbp
                mov     rcx, rdx
                sar     rcx, 3
                mov     rdx, rcx
                shr     rdx, 3Fh
                add     rcx, rdx
                mov     edx, 2
                call    sub_140292A50
                mov     eax, 4
                add     rsp, 38h
                pop     r12
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402791D3:                          ; CODE XREF: sub_140278C00+52B↑j
                mov     rcx, [rbp+10h]
                mov     rax, 0FFFFFFFFFFFFFFF7h
                bt      rcx, 0Ah
                mov     rdx, 0FFFFFFFFFFFFF7FFh
                cmovb   rax, rdx
                and     rax, rcx
                mov     [rbp+10h], rax
                movzx   eax, byte ptr [rbp+22h]
                test    al, 10h
                jz      short loc_140279210
                cmp     r12, 1
                mov     edx, 88h
                mov     eax, 8
                cmovnz  edx, eax
                jmp     short loc_14027924A
; ---------------------------------------------------------------------------

loc_140279210:                          ; CODE XREF: sub_140278C00+5FB↑j
                and     al, 0FAh
                or      al, 2
                mov     [rbp+22h], al
                cmp     r12, 1
                jbe     short loc_140279245
                mov     rcx, rbp
                call    sub_14022FC60
                cmp     eax, 5
                jnb     short loc_140279245
                mov     rdx, rbp
                mov     rcx, r12
                call    sub_14027BEE0
                mov     eax, 4
                add     rsp, 38h
                pop     r12
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140279245:                          ; CODE XREF: sub_140278C00+61B↑j
                                        ; sub_140278C00+628↑j
                mov     edx, 4

loc_14027924A:                          ; CODE XREF: sub_140278C00+60E↑j
                mov     rcx, rbp
                call    sub_140279270
                mov     eax, 4
                add     rsp, 38h
                pop     r12
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140278C00   endp

algn_140279262:                         ; DATA XREF: .pdata:00000001400CE6DC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140279270   proc near               ; CODE XREF: sub_140213950+D7↑p
                                        ; sub_140278860+57↑p ...

var_98          = dword ptr -98h
var_78          = qword ptr -78h
var_68          = xmmword ptr -68h
var_58          = qword ptr -58h
var_50          = xmmword ptr -50h
var_40          = qword ptr -40h
arg_0           = dword ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_8], edx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 60h
                mov     r9, [rcx+28h]
                xor     eax, eax
                mov     [rsp+98h+var_58], rax
                mov     r8, r9
                mov     rax, cs:qword_140C4E4C8
                xorps   xmm0, xmm0
                shr     r8, 27h
                mov     r10d, edx
                and     r8d, 3FFh
                mov     rsi, rcx
                movups  [rsp+98h+var_68], xmm0
                mov     r14, [rax+r8*8]
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                sub     rcx, rax
                xor     r11d, r11d
                mov     rax, 2AAAAAAAAAAAAAABh
                mov     edi, r11d
                imul    rcx
                mov     r12d, 1
                mov     r13, rdx
                sar     r13, 3
                mov     rax, r13
                shr     rax, 3Fh
                add     r13, rax
                mov     rax, 2000000000000h
                test    rax, r9
                mov     rax, cs:qword_140C4E820
                cmovnz  edi, r12d
                cmp     r13, rax
                jb      short loc_14027931C
                add     rax, 800h
                cmp     r13, rax
                jnb     short loc_14027931C
                or      edi, 8
                jmp     short loc_14027933C
; ---------------------------------------------------------------------------

loc_14027931C:                          ; CODE XREF: sub_140279270+9A↑j
                                        ; sub_140279270+A5↑j
                cmp     cs:byte_140C51EDE, r11b
                jz      short loc_14027933C
                mov     rax, cs:qword_140C52408
                mov     rcx, r13
                shr     rcx, 9
                bt      [rax], rcx
                jnb     short loc_14027933C
                or      edi, 2

loc_14027933C:                          ; CODE XREF: sub_140279270+AA↑j
                                        ; sub_140279270+B3↑j ...
                mov     ebx, edi
                mov     [rsp+98h+arg_10], ebx
                test    r10b, 8
                jz      short loc_140279372
                test    r12b, dil
                jz      short loc_140279372
                cmp     cs:byte_140C4DD68, r11b
                jz      short loc_140279372
                movzx   eax, byte ptr [rsi+22h]
                and     r10d, 0FFFFFFF7h
                or      r10d, 4
                and     al, 0EFh
                mov     [rsp+98h+arg_8], r10d
                mov     [rsi+22h], al

loc_140279372:                          ; CODE XREF: sub_140279270+D9↑j
                                        ; sub_140279270+DE↑j ...
                lea     rcx, qword_140C4C940
                test    r10b, 4
                jz      short loc_14027939D
                lea     r15, [r14+940h]
                test    r12b, dil
                jz      short loc_1402793F4
                test    byte ptr [rsi+23h], 40h
                jz      short loc_1402793F4
                lea     r14, unk_140C50C00
                mov     r15, rcx
                jmp     short loc_1402793F4
; ---------------------------------------------------------------------------

loc_14027939D:                          ; CODE XREF: sub_140279270+10D↑j
                test    r10b, 8
                jz      short loc_1402793AC
                lea     r15, [r14+1D40h]
                jmp     short loc_1402793F4
; ---------------------------------------------------------------------------

loc_1402793AC:                          ; CODE XREF: sub_140279270+131↑j
                test    r10b, 10h
                jz      short loc_1402793BB
                lea     r15, [r14+1D80h]
                jmp     short loc_1402793F4
; ---------------------------------------------------------------------------

loc_1402793BB:                          ; CODE XREF: sub_140279270+140↑j
                bt      r10d, 8
                jnb     short loc_1402793CB
                lea     r15, [r14+1040h]
                jmp     short loc_1402793F4
; ---------------------------------------------------------------------------

loc_1402793CB:                          ; CODE XREF: sub_140279270+150↑j
                bt      r10d, 0Bh
                jnb     short loc_1402793ED
                mov     edx, r12d
                mov     rcx, rsi
                call    sub_140553084
                mov     r10d, [rsp+98h+arg_8]
                mov     r15, rax
                xor     r11d, r11d
                jmp     short loc_1402793F4
; ---------------------------------------------------------------------------

loc_1402793ED:                          ; CODE XREF: sub_140279270+160↑j
                lea     r15, [r14+1000h]

loc_1402793F4:                          ; CODE XREF: sub_140279270+119↑j
                                        ; sub_140279270+11F↑j ...
                mov     r8d, [r15+8]
                mov     edx, edi
                mov     [rsp+98h+arg_0], r8d
                and     edx, r12d
                jnz     short loc_14027942A
                lock or [rsp+98h+var_98], edx
                mov     ecx, cs:dword_140D23080
                mov     rax, 0F00000000000000h
                shl     rcx, 38h
                xor     rcx, [rsi+18h]
                and     rcx, rax
                xor     [rsi+18h], rcx

loc_14027942A:                          ; CODE XREF: sub_140279270+195↑j
                mov     [rsp+98h+arg_18], r11
                cmp     r8d, 2
                jnz     loc_140279611
                movzx   ecx, byte ptr [rsi+23h]
                test    cl, 40h
                jz      short loc_140279472
                test    r8b, bl
                jnz     short loc_140279472
                xor     edx, edx
                mov     rcx, rsi
                call    sub_1402D6010
                mov     edx, 20h ; ' '
                mov     rcx, rsi
                call    sub_140279270
                add     rsp, 60h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140279472:                          ; CODE XREF: sub_140279270+1D3↑j
                                        ; sub_140279270+1D8↑j
                test    edx, edx
                jz      short loc_140279492
                movzx   eax, byte ptr [rsi+22h]
                and     al, 0FAh
                or      al, 2
                mov     [rsi+22h], al
                add     rsp, 60h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140279492:                          ; CODE XREF: sub_140279270+204↑j
                bt      r10d, 0Bh
                jb      loc_14027958C
                test    cl, 8
                jz      short loc_1402794A9
                mov     eax, 5
                jmp     short loc_1402794AF
; ---------------------------------------------------------------------------

loc_1402794A9:                          ; CODE XREF: sub_140279270+230↑j
                mov     rax, rcx
                and     eax, 7

loc_1402794AF:                          ; CODE XREF: sub_140279270+237↑j
                lea     r15, [rax+4Ch]
                lea     r15, [rax+r15*4]
                lea     r15, [r14+r15*8]
                test    cl, 8
                jnz     loc_14027958C
                test    bl, 2
                jnz     loc_14027958C
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                mov     ecx, 1100h
                mov     edx, 13C0h
                cmovz   ecx, edx
                lock inc qword ptr [rcx+r14]
                xorps   xmm0, xmm0
                xor     eax, eax
                movups  [rsp+98h+var_50], xmm0
                mov     [rsp+98h+var_40], rax
                lock xadd [r14+1BC0h], r12
                inc     r12
                cmp     r12, 420h
                ja      short loc_14027956F
                cmp     r12, 0A0h
                jnz     short loc_14027951B
                lea     eax, [rdx-58h]
                jmp     short loc_140279536
; ---------------------------------------------------------------------------

loc_14027951B:                          ; CODE XREF: sub_140279270+2A4↑j
                cmp     r12, 420h
                jnz     short loc_14027952B
                mov     eax, 1388h
                jmp     short loc_140279536
; ---------------------------------------------------------------------------

loc_14027952B:                          ; CODE XREF: sub_140279270+2B2↑j
                cmp     r12, 22h ; '"'
                jnz     short loc_14027956F
                mov     eax, 1348h

loc_140279536:                          ; CODE XREF: sub_140279270+2A9↑j
                                        ; sub_140279270+2B9↑j
                lea     rdx, [r14+1340h]
                mov     qword ptr [rsp+98h+var_50], r11
                lea     rcx, [rsp+98h+var_50]
                mov     qword ptr [rsp+98h+var_50+8], rdx
                lea     rbx, [r14+rax]
                call    sub_14024B3F0
                xor     r8d, r8d
                xor     edx, edx
                mov     rcx, rbx
                call    KeSetEvent
                inc     dword ptr [rbx+18h]
                lea     rcx, [rsp+98h+var_50]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel

loc_14027956F:                          ; CODE XREF: sub_140279270+29B↑j
                                        ; sub_140279270+2BF↑j
                dec     r12
                cmp     r12, [r14+1430h]
                jz      short loc_140279584
                cmp     r12, [r14+1438h]
                jnz     short loc_14027958C

loc_140279584:                          ; CODE XREF: sub_140279270+309↑j
                mov     rcx, r14
                call    sub_1403B69C4

loc_14027958C:                          ; CODE XREF: sub_140279270+227↑j
                                        ; sub_140279270+24E↑j ...
                mov     edx, [rsp+98h+arg_8]
                test    dl, dl
                js      loc_14027998C
                xor     eax, eax
                lea     rbx, [r15+20h]
                mov     qword ptr [rsp+98h+var_68+8], rbx
                mov     qword ptr [rsp+98h+var_68], rax
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_1402795D6
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_1402795D6
                mov     eax, [rdx+18h]
                add     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_1402795D6
                call    sub_1403F2EC4

loc_1402795D6:                          ; CODE XREF: sub_140279270+34E↑j
                                        ; sub_140279270+354↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_1402795F1
                mov     rdx, rbx
                lea     rcx, [rsp+98h+var_68]
                call    sub_14051652C
                jmp     loc_140279985
; ---------------------------------------------------------------------------

loc_1402795F1:                          ; CODE XREF: sub_140279270+36D↑j
                lea     rdx, [rsp+98h+var_68]
                xchg    rdx, [rbx]
                test    rdx, rdx
                jz      loc_140279985
                lea     rcx, [rsp+98h+var_68]
                call    sub_14025FC20
                jmp     loc_140279985
; ---------------------------------------------------------------------------

loc_140279611:                          ; CODE XREF: sub_140279270+1C6↑j
                cmp     r8d, 3
                jnz     short loc_14027963D
                mov     rcx, rsi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_140279630
                lock inc qword ptr [r14+1100h]
                jmp     loc_1402796E4
; ---------------------------------------------------------------------------

loc_140279630:                          ; CODE XREF: sub_140279270+3B1↑j
                lock inc qword ptr [r14+13C0h]
                jmp     loc_1402796E4
; ---------------------------------------------------------------------------

loc_14027963D:                          ; CODE XREF: sub_140279270+3A5↑j
                cmp     r8d, 4
                jnz     loc_140279905
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, [rsi+10h]
                test    rcx, rcx
                jz      short loc_140279661
                test    al, 10h
                jnz     short loc_140279661
                not     rcx
                and     rax, rcx

loc_140279661:                          ; CODE XREF: sub_140279270+3E5↑j
                                        ; sub_140279270+3E9↑j
                sar     rax, 10h
                mov     rcx, rsi
                mov     r12, [rax]
                mov     [rsp+98h+arg_18], r12
                call    sub_1403F41D8
                test    eax, eax
                mov     ecx, 1100h
                mov     edx, 13C0h
                cmovz   ecx, edx
                lock inc qword ptr [rcx+r14]
                lea     rdx, [r15+20h]
                mov     qword ptr [rsp+98h+var_68], r11
                lea     rcx, [rsp+98h+var_68]
                mov     qword ptr [rsp+98h+var_68+8], rdx
                call    sub_14024B3F0
                lea     rcx, [r12+48h]
                call    ExAcquireSpinLockExclusiveAtDpcLevel
                mov     eax, [r12+38h]
                test    al, 8
                jnz     loc_140279985
                lea     rcx, [r12+48h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel
                lea     rcx, [rsp+98h+var_68]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     ebx, [rsp+98h+arg_10]
                xor     r11d, r11d
                mov     [rsp+98h+arg_0], 3

loc_1402796E4:                          ; CODE XREF: sub_140279270+3BB↑j
                                        ; sub_140279270+3C8↑j
                lock inc qword ptr [r14+1D40h]
                mov     eax, [rsi+10h]
                bt      rax, 0Ah
                jb      loc_1402797BB
                mov     r12d, [rsp+98h+arg_8]
                test    r12b, r12b
                js      short loc_14027976F
                add     r15, 20h ; ' '
                mov     qword ptr [rsp+98h+var_68], r11
                mov     qword ptr [rsp+98h+var_68+8], r15
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_140279740
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_140279740
                mov     eax, [rdx+18h]
                add     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_140279740
                call    sub_1403F2EC4

loc_140279740:                          ; CODE XREF: sub_140279270+4B8↑j
                                        ; sub_140279270+4BE↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_140279758
                mov     rdx, r15
                lea     rcx, [rsp+98h+var_68]
                call    sub_14051652C
                jmp     short loc_14027976F
; ---------------------------------------------------------------------------

loc_140279758:                          ; CODE XREF: sub_140279270+4D7↑j
                lea     rdx, [rsp+98h+var_68]
                xchg    rdx, [r15]
                test    rdx, rdx
                jz      short loc_14027976F
                lea     rcx, [rsp+98h+var_68]
                call    sub_14025FC20

loc_14027976F:                          ; CODE XREF: sub_140279270+495↑j
                                        ; sub_140279270+4E6↑j ...
                mov     rax, [rsi+10h]
                mov     rcx, rax
                shr     al, 1
                shr     rcx, 0Ch
                and     ecx, 0Fh
                test    al, 1
                jnz     short loc_140279795
                cmp     ecx, [r14+484h]
                jz      short loc_140279795
                lea     r15, [r14+0AC0h]
                jmp     short loc_1402797A1
; ---------------------------------------------------------------------------

loc_140279795:                          ; CODE XREF: sub_140279270+511↑j
                                        ; sub_140279270+51A↑j
                lea     r15, [rcx+58h]
                lea     r15, [rcx+r15*4]
                lea     r15, [r14+r15*8]

loc_1402797A1:                          ; CODE XREF: sub_140279270+523↑j
                mov     rax, [r15]
                mov     edi, ebx
                inc     qword ptr [r14+1DB0h]
                or      edi, 4
                test    rax, rax
                cmovnz  edi, ebx
                jmp     loc_140279843
; ---------------------------------------------------------------------------

loc_1402797BB:                          ; CODE XREF: sub_140279270+484↑j
                mov     rax, [r14+1AC0h]
                mov     ebx, [rax+18h]
                mov     qword ptr [rsp+98h+var_68], r11
                lea     rcx, [rbx+6Ch]
                lea     rcx, [rbx+rcx*4]
                lea     r15, [r14+rcx*8]
                lea     r12, [r15+20h]
                mov     qword ptr [rsp+98h+var_68+8], r12
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14027980A
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14027980A
                mov     eax, [rdx+18h]
                add     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14027980A
                call    sub_1403F2EC4

loc_14027980A:                          ; CODE XREF: sub_140279270+582↑j
                                        ; sub_140279270+588↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_140279822
                mov     rdx, r12
                lea     rcx, [rsp+98h+var_68]
                call    sub_14051652C
                jmp     short loc_14027983A
; ---------------------------------------------------------------------------

loc_140279822:                          ; CODE XREF: sub_140279270+5A1↑j
                lea     rdx, [rsp+98h+var_68]
                xchg    rdx, [r12]
                test    rdx, rdx
                jz      short loc_14027983A
                lea     rcx, [rsp+98h+var_68]
                call    sub_14025FC20

loc_14027983A:                          ; CODE XREF: sub_140279270+5B0↑j
                                        ; sub_140279270+5BE↑j
                xor     bl, [rsi+27h]
                and     bl, 0Fh
                xor     [rsi+27h], bl

loc_140279843:                          ; CODE XREF: sub_140279270+546↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                inc     dword ptr [rcx+7D0h]
                mov     r8, [r14+1BC0h]
                cmp     r8, 420h
                jnb     loc_1402798F6
                mov     r9d, cs:dword_140C4DD7C
                lea     r10, [r14+1068h]
                xor     eax, eax
                mov     r11d, eax

loc_140279880:                          ; CODE XREF: sub_140279270+647↓j
                mov     rcx, [r10]
                mov     edx, eax
                test    r9d, r9d
                jz      short loc_1402798AC
                nop     word ptr [rax+rax+00h]

loc_140279890:                          ; CODE XREF: sub_140279270+638↓j
                movzx   eax, word ptr [rcx]
                add     r8, rax
                cmp     r8, 420h
                jnb     short loc_1402798F6
                inc     edx
                add     rcx, 10h
                cmp     edx, r9d
                jb      short loc_140279890
                xor     eax, eax

loc_1402798AC:                          ; CODE XREF: sub_140279270+618↑j
                inc     r11
                add     r10, 8
                cmp     r11, 1
                jle     short loc_140279880
                mov     rbx, [r14+1DB0h]
                cmp     rbx, 10h
                jb      short loc_1402798D5
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                mov     rcx, r14
                call    sub_140309B9C

loc_1402798D5:                          ; CODE XREF: sub_140279270+654↑j
                mov     rax, [r14+1D40h]
                sub     rax, rbx
                cmp     rax, 10h
                jb      short loc_1402798F6
                lea     rcx, [r14+318h]
                xor     r8d, r8d
                xor     edx, edx
                call    KeSetEvent

loc_1402798F6:                          ; CODE XREF: sub_140279270+5F7↑j
                                        ; sub_140279270+62D↑j ...
                xor     eax, eax
                mov     [rsp+98h+arg_18], rax
                jmp     loc_140279985
; ---------------------------------------------------------------------------

loc_140279905:                          ; CODE XREF: sub_140279270+3D1↑j
                test    byte ptr [rsi+23h], 40h
                jz      short loc_140279918
                xor     edx, edx
                mov     rcx, rsi
                call    sub_14054F5F8
                xor     r11d, r11d

loc_140279918:                          ; CODE XREF: sub_140279270+699↑j
                test    [rsp+98h+arg_8], 100h
                jz      short loc_140279942
                lea     rdx, [r14+1060h]
                mov     qword ptr [rsp+98h+var_68], r11
                lea     rcx, [rsp+98h+var_68]
                mov     qword ptr [rsp+98h+var_68+8], rdx
                call    sub_14024B3F0
                jmp     short loc_14027997D
; ---------------------------------------------------------------------------

loc_140279942:                          ; CODE XREF: sub_140279270+6B3↑j
                lea     rbx, qword_140C4C940
                cmp     r15, rbx
                jz      short loc_14027995B
                mov     edx, 0Ch
                mov     rcx, rsi
                call    sub_1402D69E8

loc_14027995B:                          ; CODE XREF: sub_140279270+6DC↑j
                lea     rdx, [r14+1020h]
                xor     eax, eax
                lea     rcx, [rsp+98h+var_68]
                mov     qword ptr [rsp+98h+var_68+8], rdx
                mov     qword ptr [rsp+98h+var_68], rax
                call    sub_14024B3F0
                cmp     r15, rbx
                jz      short loc_140279985

loc_14027997D:                          ; CODE XREF: sub_140279270+6D0↑j
                mov     qword ptr [rsi+8], 0FFFFFFFFFFFFFFFCh

loc_140279985:                          ; CODE XREF: sub_140279270+37C↑j
                                        ; sub_140279270+38C↑j ...
                mov     edx, [rsp+98h+arg_8]

loc_14027998C:                          ; CODE XREF: sub_140279270+325↑j
                mov     ecx, edi
                shr     ecx, 1
                test    byte ptr [rsi+23h], 8
                jnz     short loc_1402799B2
                mov     ebx, ecx
                and     ebx, 1
                jz      short loc_1402799AD
                bt      edx, 0Bh
                jb      short loc_1402799AD
                cmp     [rsp+98h+arg_0], 2
                jz      short loc_1402799B2

loc_1402799AD:                          ; CODE XREF: sub_140279270+72B↑j
                                        ; sub_140279270+731↑j
                inc     qword ptr [r15]
                jmp     short loc_1402799C1
; ---------------------------------------------------------------------------

loc_1402799B2:                          ; CODE XREF: sub_140279270+724↑j
                                        ; sub_140279270+73B↑j
                mov     ebx, ecx
                and     ebx, 1
                jnz     short loc_1402799C1
                mov     rcx, rsi
                call    sub_14034292C

loc_1402799C1:                          ; CODE XREF: sub_140279270+740↑j
                                        ; sub_140279270+747↑j
                mov     r12, [r15+18h]
                mov     r10, 0FFFFFFFFFh
                cmp     r12, r10
                jz      short loc_1402799FA
                lea     rdx, [r12+r12*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rdx, 4
                mov     rax, rax
                add     rdx, rax
                mov     rax, [rdx]
                xor     rax, r13
                and     rax, r10
                xor     [rdx], rax
                jmp     short loc_1402799FE
; ---------------------------------------------------------------------------

loc_1402799FA:                          ; CODE XREF: sub_140279270+762↑j
                mov     [r15+10h], r13

loc_1402799FE:                          ; CODE XREF: sub_140279270+788↑j
                movzx   eax, byte ptr [rsi+22h]
                lea     rcx, qword_140C4C940
                cmp     r15, rcx
                jnz     short loc_140279A2F
                and     al, 0FAh
                or      al, 2
                mov     [rsi+22h], al
                movzx   eax, byte ptr [rsi+23h]
                or      al, 10h
                mov     [rsi+23h], al
                call    sub_140542A84
                mov     r10, 0FFFFFFFFFh
                jmp     short loc_140279A41
; ---------------------------------------------------------------------------

loc_140279A2F:                          ; CODE XREF: sub_140279270+79C↑j
                movzx   ecx, byte ptr [rsp+98h+arg_0]
                xor     cl, al
                and     cl, 7
                xor     cl, al
                mov     [rsi+22h], cl

loc_140279A41:                          ; CODE XREF: sub_140279270+7BD↑j
                mov     [r15+18h], r13
                and     r12, r10
                mov     rax, [rsi+18h]
                mov     r11, 0FFFFFFF000000000h
                or      [rsi], r10
                and     rax, r11
                or      rax, r12
                cmp     [rsp+98h+arg_0], 2
                mov     [rsi+18h], rax
                jnz     loc_140279C22
                test    ebx, ebx
                jz      short loc_140279A93
                mov     r12d, [rsp+98h+arg_8]
                mov     rcx, rsi
                mov     edx, r12d
                shr     edx, 0Bh
                and     edx, 1
                call    sub_1403495E0
                jmp     loc_140279C2A
; ---------------------------------------------------------------------------

loc_140279A93:                          ; CODE XREF: sub_140279270+803↑j
                movzx   r15d, byte ptr [rsi+23h]
                test    r15b, 8
                jnz     loc_140279C22
                mov     rcx, [rsi+28h]
                mov     rax, cs:qword_140C4E4C8
                mov     edx, cs:dword_140C4DD08
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     r12, [rax+rcx*8]
                movsxd  rcx, cs:dword_140C4DD04
                cmp     ecx, edx
                ja      short loc_140279AE9
                mov     rax, rcx
                shl     rax, 4
                add     rax, cs:qword_140C4DD48
                cmp     r13, [rax]
                jb      short loc_140279AE9
                cmp     ecx, edx
                jz      short loc_140279B4B
                cmp     r13, [rax+10h]
                jb      short loc_140279B4B

loc_140279AE9:                          ; CODE XREF: sub_140279270+85A↑j
                                        ; sub_140279270+86D↑j
                xor     r9d, r9d
                mov     r8d, r9d
                test    edx, edx
                js      loc_140279CF8
                nop     word ptr [rax+rax+00000000h]

loc_140279B00:                          ; CODE XREF: sub_140279270+8D1↓j
                lea     ecx, [r8+rdx]
                sar     ecx, 1
                movsxd  rax, ecx
                shl     rax, 4
                add     rax, cs:qword_140C4DD48
                cmp     r13, [rax]
                jnb     short loc_140279B26
                test    ecx, ecx
                jz      loc_140279D10
                lea     edx, [rcx-1]
                jmp     short loc_140279B38
; ---------------------------------------------------------------------------

loc_140279B26:                          ; CODE XREF: sub_140279270+8A7↑j
                cmp     ecx, cs:dword_140C4DD08
                jz      short loc_140279B43
                cmp     r13, [rax+10h]
                jb      short loc_140279B43
                lea     r8d, [rcx+1]

loc_140279B38:                          ; CODE XREF: sub_140279270+8B4↑j
                cmp     edx, r8d
                jl      loc_140279CF8
                jmp     short loc_140279B00
; ---------------------------------------------------------------------------

loc_140279B43:                          ; CODE XREF: sub_140279270+8BC↑j
                                        ; sub_140279270+8C2↑j
                mov     cs:dword_140C4DD04, ecx
                jmp     short loc_140279B4E
; ---------------------------------------------------------------------------

loc_140279B4B:                          ; CODE XREF: sub_140279270+871↑j
                                        ; sub_140279270+877↑j
                xor     r9d, r9d

loc_140279B4E:                          ; CODE XREF: sub_140279270+8D9↑j
                cmp     cs:qword_140C4DD50, 0
                mov     ebx, [rax+8]
                jz      short loc_140279B7C
                mov     rcx, r13
                call    sub_1403216F8
                mov     r8d, eax
                mov     r10, 0FFFFFFFFFh
                mov     r11, 0FFFFFFF000000000h
                jmp     short loc_140279B7F
; ---------------------------------------------------------------------------

loc_140279B7C:                          ; CODE XREF: sub_140279270+8E9↑j
                mov     r8d, r9d

loc_140279B7F:                          ; CODE XREF: sub_140279270+90A↑j
                mov     eax, r8d
                mov     rcx, r15
                imul    rdx, rbx, 11C0h
                and     ecx, 7
                add     rdx, [r12+10h]
                lea     rcx, [rcx+rax*8]
                lea     rax, [rcx+rcx*2]
                lea     r9, [rdx+rax*8]
                inc     qword ptr [r9+0CB8h]
                mov     r8, [r9+0CC8h]
                cmp     r8, r10
                jz      short loc_140279BEB
                lea     rdx, [r8+r8*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rdx, 4
                mov     rax, rax
                add     rdx, rax
                mov     rcx, r13
                shl     rcx, 1Ch
                mov     rax, r13
                shl     rax, 1Ch
                xor     rcx, [rdx]
                and     rcx, r10
                mov     [rdx+27h], r13b
                xor     rcx, rax
                mov     [rdx], rcx
                jmp     short loc_140279BF2
; ---------------------------------------------------------------------------

loc_140279BEB:                          ; CODE XREF: sub_140279270+941↑j
                mov     [r9+0CC0h], r13

loc_140279BF2:                          ; CODE XREF: sub_140279270+979↑j
                or      [rsi], r11
                mov     rax, 0FFFFF000000000h
                mov     [rsi+24h], r8w
                shr     r8, 10h
                shl     r8, 24h
                xor     r8, [rsi+18h]
                and     r8, rax
                mov     byte ptr [rsi+27h], 0FFh
                xor     [rsi+18h], r8
                mov     [r9+0CC8h], r13

loc_140279C22:                          ; CODE XREF: sub_140279270+7FB↑j
                                        ; sub_140279270+82C↑j
                mov     r12d, [rsp+98h+arg_8]

loc_140279C2A:                          ; CODE XREF: sub_140279270+81E↑j
                mov     rax, [rsp+98h+arg_18]
                test    rax, rax
                jz      short loc_140279C40
                lea     rcx, [rax+48h]
                call    ExReleaseSpinLockExclusiveFromDpcLevel

loc_140279C40:                          ; CODE XREF: sub_140279270+9C5↑j
                test    r12b, r12b
                js      loc_140279CD0
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_140279C66
                mov     rdx, [rsp+98h]
                lea     rcx, [rsp+98h+var_68]
                call    sub_1405165EC
                jmp     short loc_140279CA5
; ---------------------------------------------------------------------------

loc_140279C66:                          ; CODE XREF: sub_140279270+9E0↑j
                prefetchw byte ptr [rsp+98h+var_68]
                mov     rax, qword ptr [rsp+98h+var_68]
                xor     ebx, ebx
                test    rax, rax
                jnz     short loc_140279C9A
                mov     rcx, qword ptr [rsp+98h+var_68+8]
                lea     rax, [rsp+98h+var_68]
                lock cmpxchg [rcx], rbx
                lea     rcx, [rsp+98h+var_68]
                cmp     rax, rcx
                jz      short loc_140279CA5
                lea     rcx, [rsp+98h+var_68]
                call    sub_140313680

loc_140279C9A:                          ; CODE XREF: sub_140279270+A05↑j
                mov     qword ptr [rsp+98h+var_68], rbx
                lock xor qword ptr [rax+8], 1

loc_140279CA5:                          ; CODE XREF: sub_140279270+9F4↑j
                                        ; sub_140279270+A1E↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_140279CD0
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_140279CD0
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_140279CD0
                call    sub_1403F2EC4

loc_140279CD0:                          ; CODE XREF: sub_140279270+9D3↑j
                                        ; sub_140279270+A48↑j ...
                test    dil, 4
                jz      short loc_140279CE7
                lea     rcx, [r14+370h]
                xor     r8d, r8d
                xor     edx, edx
                call    KeSetEvent

loc_140279CE7:                          ; CODE XREF: sub_140279270+A64↑j
                add     rsp, 60h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 8

loc_140279CF8:                          ; CODE XREF: sub_140279270+881↑j
                                        ; sub_140279270+8CB↑j
                mov     r8, r13
                mov     [rsp+98h+var_78], r9
                mov     edx, 6201h
                mov     ecx, 1Ah
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140279D10:                          ; CODE XREF: sub_140279270+8AB↑j
                mov     [rsp+98h+var_78], r9
                mov     r8, r13
                mov     r9, rax
                mov     edx, 6200h
                mov     ecx, 1Ah
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_140279270   endp

algn_140279D2B:                         ; DATA XREF: .pdata:00000001400CE6E8↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140279D40   proc near               ; CODE XREF: sub_14022FC80:loc_14022FEDA↑p
                                        ; sub_140274000:loc_140274C52↑p ...
                mov     rax, [rcx+8]
                mov     rdx, 8000000000000000h
                or      rax, rdx
                mov     r9, 0FFFFF68000000000h
                mov     rdx, r9
                mov     r8, 3FFFFFFF78h
                add     rdx, r8
                cmp     rax, rdx
                jbe     short loc_140279D74

loc_140279D70:                          ; CODE XREF: sub_140279D40+3A↓j
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140279D74:                          ; CODE XREF: sub_140279D40+2E↑j
                mov     rdx, r9
                cmp     rax, rdx
                jb      short loc_140279D70
                movzx   eax, byte ptr [rcx+23h]
                shr     eax, 5
                and     eax, 1
                retn
sub_140279D40   endp

; ---------------------------------------------------------------------------
                align 8
algn_140279D88:                         ; DATA XREF: .pdata:00000001400CE6F4↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140279D90   proc near               ; CODE XREF: sub_14020A8C8+82↑p
                                        ; sub_140280660+232↓p ...

var_1A8         = dword ptr -1A8h
var_1A4         = word ptr -1A4h
var_1A2         = word ptr -1A2h
var_1A0         = qword ptr -1A0h
var_198         = qword ptr -198h
var_190         = qword ptr -190h
var_188         = byte ptr -188h
var_E8          = qword ptr -0E8h
var_48          = qword ptr -48h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140442ABA SIZE 00000019 BYTES

; __unwind { // __GSHandlerCheck
                mov     [rsp+arg_10], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 190h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+1C8h+var_48], rax
                mov     r15d, r8d
                mov     r13, rdx
                mov     r14, rcx
                xor     eax, eax
                xor     edx, edx
                mov     [rsp+1C8h+var_1A2], ax
                mov     r8d, 98h
                lea     rcx, [rsp+1C8h+var_188]
                call    memset
                mov     edi, [r13+0Ch]
                mov     rcx, r14
                xor     ebp, ebp
                mov     [rsp+1C8h+var_1A0], 14h
                call    sub_140289778
                test    byte ptr [r14+0B8h], 7
                mov     r12d, ebp
                mov     [rsp+1C8h+var_1A8], eax
                mov     [rsp+1C8h+var_1A4], bp
                mov     [rsp+1C8h+var_198], rbp
                mov     [rsp+1C8h+var_190], rbp
                jnz     short loc_140279E36
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+690h]
                cmp     [rax+168h], rbp
                jnz     loc_140442ABA

loc_140279E36:                          ; CODE XREF: sub_140279D90+80↑j
                                        ; sub_140279D90+1C8D2E↓j
                mov     esi, ebp

loc_140279E38:                          ; CODE XREF: sub_140279D90+11E↓j
                mov     rbx, rbp
                test    rdi, rdi
                jz      short loc_140279E9B
                lea     rcx, [rsp+1C8h+var_E8+1]
                mov     rbp, r13
                sub     rbp, rcx
                xchg    ax, ax

loc_140279E50:                          ; CODE XREF: sub_140279D90+107↓j
                lea     rax, [rsp+1C8h+var_E8+1]
                lea     rax, [rax+rbx*8]
                mov     rdx, [rax+rbp+18h]
                and     rdx, 0FFFFFFFFFFFFF000h
                test    esi, esi
                jnz     loc_140279F2F
                lea     r9, [rsp+1C8h+var_1A8]
                mov     r8d, r15d
                mov     rcx, r14
                call    sub_140279F60
                mov     [rsp+rbx*8+0E0h], rax
                test    rax, rax
                jz      loc_140442AC3

loc_140279E91:                          ; CODE XREF: sub_140279D90+1C3↓j
                                        ; sub_140279D90+1C8D36↓j ...
                inc     rbx
                cmp     rbx, rdi
                jb      short loc_140279E50
                xor     ebp, ebp

loc_140279E9B:                          ; CODE XREF: sub_140279D90+AE↑j
                test    esi, esi
                jnz     short loc_140279EA9
                lea     rcx, [rsp+1C8h+var_1A8]
                call    sub_14028EDB0

loc_140279EA9:                          ; CODE XREF: sub_140279D90+10D↑j
                inc     esi
                cmp     esi, 2
                jb      short loc_140279E38
                cmp     r12, rdi
                jz      short loc_140279EFC
                mov     r9, rdi
                lea     r8, [rsp+1C8h+var_E8]
                mov     rdx, r13
                mov     rcx, r14
                call    sub_14031DF70
                test    rax, rax
                jz      short loc_140279EFC
                mov     rcx, 0FFFFF68000000000h
                shl     rax, 19h
                shl     rcx, 19h
                sub     rax, rcx
                sar     rax, 10h
                shl     rax, 19h
                sub     rax, rcx
                sar     rax, 10h
                mov     rdx, rax
                call    sub_1402FD520

loc_140279EFC:                          ; CODE XREF: sub_140279D90+123↑j
                                        ; sub_140279D90+13E↑j
                mov     [r13+0Ch], ebp
                mov     rax, r12
                mov     rcx, [rsp+1C8h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+1C8h+arg_10]
                add     rsp, 190h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140279F2F:                          ; CODE XREF: sub_140279D90+DA↑j
                mov     r9, [rsp+rbx*8+1C8h+var_E8]
                test    r9, r9
                jz      loc_140442ACB
                mov     r8d, r15d
                mov     rcx, r14
                call    sub_14027A940
                mov     word ptr [rsp+rbx*8+1C8h+var_E8], ax
                jmp     loc_140279E91
; } // starts at 140279D90
sub_140279D90   endp

; ---------------------------------------------------------------------------
algn_140279F58:                         ; DATA XREF: .rdata:000000014005DF14↑o
                                        ; .pdata:00000001400CE700↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140279F60   proc near               ; CODE XREF: sub_140279D90+EB↑p
                                        ; DATA XREF: .rdata:000000014005DF40↑o ...

var_58          = dword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_18], r9
                mov     [rsp+arg_10], r8d
                mov     [rsp+arg_8], rdx
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rdi
                push    r12
                push    r14
                push    r15
                sub     rsp, 50h
                mov     rax, 7FFFFFFFF8h
                mov     r12, rdx
                shr     r12, 9
                mov     r9, rdx
                and     r12, rax
                mov     r11, rcx
                mov     rax, 0FFFFF68000000000h
                xor     r14d, r14d
                mov     rax, rax
                add     r12, rax
                mov     r8, 0FFFFF6FB7DBED000h
                mov     rbx, [r12]
                mov     rax, r8
                mov     rdx, 0FFFFF6FB7DBED7F8h
                cmp     r12, rax
                jb      short loc_14027A03F
                mov     rax, rdx
                cmp     r12, rax
                ja      short loc_14027A03F
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027A035
                test    bl, 1
                jz      short loc_14027A035
                test    bl, 20h
                jz      short loc_140279FED
                test    bl, 42h
                jnz     short loc_14027A035

loc_140279FED:                          ; CODE XREF: sub_140279F60+86↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027A035
                mov     rax, r12
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14027A035
                or      rbx, 42h

loc_14027A035:                          ; CODE XREF: sub_140279F60+7C↑j
                                        ; sub_140279F60+81↑j ...
                mov     rdx, 0FFFFF6FB7DBED7F8h

loc_14027A03F:                          ; CODE XREF: sub_140279F60+6B↑j
                                        ; sub_140279F60+73↑j
                mov     [rsp+78h+var_50], rbx
                mov     rax, r8
                lea     rcx, [rsp+78h+var_50]
                cmp     rcx, rax
                jb      short loc_14027A0C2
                mov     rax, rdx
                lea     rcx, [rsp+78h+var_50]
                cmp     rcx, rax
                ja      short loc_14027A0C2
                mov     rdx, rbx
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027A0C5
                test    bl, 1
                jz      short loc_14027A0C5
                test    bl, 20h
                jz      short loc_14027A079
                test    bl, 42h
                jnz     short loc_14027A0C5

loc_14027A079:                          ; CODE XREF: sub_140279F60+112↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027A0C2
                lea     rax, [rsp+78h+var_50]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                test    al, 42h
                jz      short loc_14027A0C5
                or      rdx, 42h
                jmp     short loc_14027A0C5
; ---------------------------------------------------------------------------

loc_14027A0C2:                          ; CODE XREF: sub_140279F60+EF↑j
                                        ; sub_140279F60+FC↑j ...
                mov     rdx, rbx

loc_14027A0C5:                          ; CODE XREF: sub_140279F60+108↑j
                                        ; sub_140279F60+10D↑j ...
                shr     rdx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax

loc_14027A0D6:                          ; DATA XREF: .rdata:000000014005DF40↑o
                                        ; .rdata:000000014005DF50↑o ...
                mov     [rsp+78h+var_30], rsi
                mov     [rsp+78h+var_38], r13
                lea     r15, [rdx+rdx*2]
                shl     r15, 4
                mov     rax, 0FFFFFA8000000000h
                add     r15, rax
                mov     rdi, 3FFFFFFFFFFFFFFFh
                mov     rax, [r15+18h]
                and     rax, rdi
                cmp     rax, 1
                jbe     short loc_14027A11C
                mov     rcx, r15
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14027A455

loc_14027A11C:                          ; CODE XREF: sub_140279F60+1AA↑j
                test    byte ptr [r11+0B8h], 7
                jz      short loc_14027A171
                cmp     word ptr [r15+20h], 1
                ja      loc_14027A455
                mov     [rsp+78h+var_58], r14d
                mov     r13, r15
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jnb     short loc_14027A174

loc_14027A143:                          ; CODE XREF: sub_140279F60+1F4↓j
                                        ; sub_140279F60+1FD↓j
                lea     rcx, [rsp+78h+var_58]
                call    sub_1402C8C70
                mov     rax, [r15+18h]
                test    rax, rax
                js      short loc_14027A143
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jb      short loc_14027A143
                mov     r9, [rsp+78h+arg_8]
                mov     r11, [rsp+78h+arg_0]
                jmp     short loc_14027A174
; ---------------------------------------------------------------------------

loc_14027A171:                          ; CODE XREF: sub_140279F60+1C4↑j
                mov     r13, r14

loc_14027A174:                          ; CODE XREF: sub_140279F60+1E1↑j
                                        ; sub_140279F60+20F↑j
                mov     rax, [r15+18h]
                and     rax, rdi
                cmp     rax, 1
                jbe     short loc_14027A191
                mov     rcx, r15
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14027A441

loc_14027A191:                          ; CODE XREF: sub_140279F60+21F↑j
                movzx   eax, byte ptr [r11+0B8h]
                and     al, 7
                jz      short loc_14027A1A9
                cmp     word ptr [r15+20h], 1
                ja      loc_14027A441

loc_14027A1A9:                          ; CODE XREF: sub_140279F60+23B↑j
                mov     rsi, rbx
                mov     rdx, 3FFFFFFF78h
                and     rsi, 0FFFFFFFFFFFFFFFBh
                test    al, al
                jnz     short loc_14027A213
                mov     rcx, r15
                call    sub_1403F41D8
                mov     r8, 0FFFFF68000000000h
                test    eax, eax
                jnz     short loc_14027A21D
                mov     rax, r8
                add     rax, rdx
                cmp     r12, rax
                ja      short loc_14027A21D
                mov     rax, r8
                cmp     r12, rax
                jb      short loc_14027A21D
                test    bl, 42h
                jz      short loc_14027A21D
                test    dword ptr [r11-21Ch], 8000h
                lea     rcx, [r11-680h]
                jz      short loc_14027A21D
                xor     r8d, r8d
                mov     rdx, r9
                call    sub_14026BA68
                mov     r11, [rsp+78h+arg_0]

loc_14027A213:                          ; CODE XREF: sub_140279F60+25C↑j
                mov     r8, 0FFFFF68000000000h

loc_14027A21D:                          ; CODE XREF: sub_140279F60+272↑j
                                        ; sub_140279F60+27D↑j ...
                mov     rcx, r15
                mov     edi, r14d
                call    sub_1403F41D8
                mov     rdx, 0FFFFF6FFFFFFFFFFh
                test    eax, eax
                jz      loc_14027A3DF
                mov     rdi, [r12]
                mov     rcx, r12
                mov     dword ptr [rsp+78h+var_48], r12d
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027A2B5
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027A2B5
                test    dil, 1
                jz      short loc_14027A2B5
                test    dil, 20h
                jz      short loc_14027A26A
                test    dil, 42h
                jnz     short loc_14027A2B5

loc_14027A26A:                          ; CODE XREF: sub_140279F60+302↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14027A2B5
                mov     rcx, [rsp+78h+var_48]
                mov     rdx, rdi
                shr     rcx, 3
                or      rdx, 20h
                and     ecx, 1FFh
                mov     rax, [rax+rcx*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_14027A2B5
                or      rdi, 42h

loc_14027A2B5:                          ; CODE XREF: sub_140279F60+2ED↑j
                                        ; sub_140279F60+2F6↑j ...
                mov     rdx, rdi
                shr     rdi, 38h
                shr     rdx, 3Ch
                and     dil, 0Fh
                and     dl, 7
                shl     dl, 4
                or      dl, dil
                mov     rdi, [rsp+78h+arg_8]
                mov     rcx, rdi
                call    sub_1402C6870
                test    eax, eax
                jz      short loc_14027A300
                mov     ecx, eax
                and     ecx, 1Fh
                or      rcx, 0FFFFFFFFF8000020h
                shl     rcx, 5
                call    sub_14027C6C0
                mov     [rsp+78h+var_50], rax
                jmp     loc_14027A680
; ---------------------------------------------------------------------------

loc_14027A300:                          ; CODE XREF: sub_140279F60+37F↑j
                mov     rdx, [r15+8]
                mov     r10, 8000000000000000h
                mov     r9, rdx
                or      r9, r10
                mov     rcx, r9
                shl     rcx, 10h
                bts     rcx, 0Ah
                call    sub_14027C6C0
                mov     r11, [rsp+78h+arg_0]
                mov     r8, rax
                mov     [rsp+78h+var_50], rax
                mov     rcx, rax
                movzx   eax, byte ptr [r11+0B8h]
                and     al, 7
                cmp     al, 2
                jb      short loc_14027A360
                test    rbx, 0A00h
                jnz     short loc_14027A360
                test    rbx, rbx
                jns     short loc_14027A360
                or      r8, 8
                mov     [rsp+78h+var_50], r8
                mov     rcx, r8

loc_14027A360:                          ; CODE XREF: sub_140279F60+3E4↑j
                                        ; sub_140279F60+3ED↑j ...
                mov     rbx, 1000000000h
                test    [r15+28h], rbx
                jnz     short loc_14027A386
                test    rdx, rdx
                js      short loc_14027A386
                jz      short loc_14027A386
                bts     rcx, 0Bh
                mov     [rsp+78h+var_50], rcx
                jmp     loc_14027A68A
; ---------------------------------------------------------------------------

loc_14027A386:                          ; CODE XREF: sub_140279F60+40E↑j
                                        ; sub_140279F60+413↑j ...
                test    byte ptr [rsp+78h+arg_10], 2
                jz      loc_14027A68A
                cmp     [r11-190h], r14
                lea     rcx, [r11-680h]
                jz      loc_14027A68A
                mov     rdx, r9
                call    sub_1402C6E74
                test    rax, rax
                jz      loc_14027A68A
                mov     rcx, [rcx+690h]
                mov     rax, [rax+60h]
                cmp     [rcx+168h], rax
                jbe     loc_14027A68A
                or      r8, 8
                mov     [rsp+78h+var_50], r8
                jmp     loc_14027A68A
; ---------------------------------------------------------------------------

loc_14027A3DF:                          ; CODE XREF: sub_140279F60+2D4↑j
                mov     rax, r8
                mov     rcx, [rsp+78h+arg_8]
                cmp     rcx, rax
                jb      short loc_14027A45D
                mov     rax, rdx
                cmp     rcx, rax
                ja      short loc_14027A45D
                xor     r8d, r8d
                mov     rdx, r12
                mov     rcx, r11
                mov     edi, 1
                call    sub_140225CC0
                mov     rax, [r15+18h]
                mov     rcx, 3FFFFFFFFFFFFFFFh
                and     rax, rcx
                cmp     rax, rdi
                jnz     short loc_14027A431
                mov     rcx, [rsp+78h+arg_8]
                call    sub_1403566BC
                test    eax, eax
                jz      short loc_14027A45D

loc_14027A431:                          ; CODE XREF: sub_140279F60+4BE↑j
                mov     rcx, [rsp+78h+arg_0]
                mov     rdx, r12
                call    sub_140312B40

loc_14027A441:                          ; CODE XREF: sub_140279F60+22B↑j
                                        ; sub_140279F60+243↑j
                test    r13, r13
                jz      short loc_14027A455
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax

loc_14027A455:                          ; CODE XREF: sub_140279F60+1B6↑j
                                        ; sub_140279F60+1CC↑j ...
                mov     rax, r14
                jmp     loc_14027A921
; ---------------------------------------------------------------------------

loc_14027A45D:                          ; CODE XREF: sub_140279F60+48D↑j
                                        ; sub_140279F60+495↑j ...
                mov     rax, [r15+28h]
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 4
                jnz     loc_14027A577
                mov     ecx, 2
                call    sub_1402A46FC
                mov     r11, [rsp+78h+arg_0]
                cmp     r11, rax
                jnz     loc_14027A57F
                mov     rdx, [r15+10h]
                lea     rcx, unk_140C50C00
                mov     r8d, 1
                call    sub_1402D9B64
                mov     rax, [rsp+78h+arg_8]
                and     rax, 0FFFFFFFFFFFFF000h
                mov     rcx, rax
                mov     [rsp+78h+arg_8], rax
                call    sub_1402805F0
                mov     rdi, rax
                mov     rcx, r12
                or      rdi, 2
                or      rsi, 4
                mov     [rsp+78h+var_50], rdi
                mov     rbx, rdi
                mov     r14d, 1
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027A546
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027A518
                cmp     byte ptr cs:word_140C4DE88+1, 0
                mov     rdx, rdi
                jnz     short loc_14027A50A
                test    r14b, dil
                jz      short loc_14027A50A
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14027A50A:                          ; CODE XREF: sub_140279F60+596↑j
                                        ; sub_140279F60+59B↑j
                mov     rcx, r12
                mov     [r12], rdx
                call    sub_140349620
                jmp     short loc_14027A54A
; ---------------------------------------------------------------------------

loc_14027A518:                          ; CODE XREF: sub_140279F60+58A↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027A546
                test    r14b, dil
                jz      short loc_14027A546
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14027A546:                          ; CODE XREF: sub_140279F60+581↑j
                                        ; sub_140279F60+5D2↑j ...
                mov     [r12], rbx

loc_14027A54A:                          ; CODE XREF: sub_140279F60+5B6↑j
                mov     rdx, [rsp+78h+arg_8]
                xor     r9d, r9d
                mov     rcx, [rsp+78h+arg_18]
                mov     r8, r14
                call    sub_1402882E0
                mov     rcx, [rsp+78h+arg_18]
                call    sub_14028EDB0
                jmp     loc_14027A79E
; ---------------------------------------------------------------------------

loc_14027A577:                          ; CODE XREF: sub_140279F60+509↑j
                mov     r11, [rsp+78h+arg_0]

loc_14027A57F:                          ; CODE XREF: sub_140279F60+524↑j
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                lea     rcx, [rsp+78h+var_50]
                cmp     rcx, rax
                jb      short loc_14027A60F
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                lea     rcx, [rsp+78h+var_50]
                cmp     rcx, rax
                ja      short loc_14027A60F
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027A60F
                test    bl, 1
                jz      short loc_14027A60F
                test    bl, 20h
                jz      short loc_14027A5C5
                test    bl, 42h
                jnz     short loc_14027A60F

loc_14027A5C5:                          ; CODE XREF: sub_140279F60+65E↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027A60F
                lea     rax, [rsp+78h+var_50]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14027A60F
                or      rbx, 42h

loc_14027A60F:                          ; CODE XREF: sub_140279F60+634↑j
                                        ; sub_140279F60+64B↑j ...
                mov     r8d, [r15+10h]
                mov     rax, 0FFFFFFFFF000h
                shr     r8, 5
                and     rbx, rax
                mov     rax, cs:qword_140C4DDC0
                and     r8d, 1Fh
                or      r8, 40h
                shl     r8, 5
                or      r8, rbx
                test    rax, rax
                jz      short loc_14027A64D
                test    r8, rax
                jnz     short loc_14027A649
                or      r8, rax
                jmp     short loc_14027A64D
; ---------------------------------------------------------------------------

loc_14027A649:                          ; CODE XREF: sub_140279F60+6E2↑j
                or      r8, 10h

loc_14027A64D:                          ; CODE XREF: sub_140279F60+6DD↑j
                                        ; sub_140279F60+6E7↑j
                mov     [rsp+78h+var_50], r8
                test    edi, edi
                jz      short loc_14027A678
                xor     r9d, r9d
                mov     rdx, r12
                mov     rcx, r11
                call    sub_14029B94C
                mov     rdx, [rsp+78h+arg_8]
                and     rdx, 0FFFFFFFFFFFFF000h
                jmp     loc_14027A78A
; ---------------------------------------------------------------------------

loc_14027A678:                          ; CODE XREF: sub_140279F60+6F4↑j
                mov     rdi, [rsp+78h+arg_8]

loc_14027A680:                          ; CODE XREF: sub_140279F60+39B↑j
                mov     r10, 8000000000000000h

loc_14027A68A:                          ; CODE XREF: sub_140279F60+421↑j
                                        ; sub_140279F60+42E↑j ...
                mov     rdx, [r12]
                mov     rbx, 0FFFFF6FB7DBED000h
                mov     rax, rbx
                mov     rcx, 0FFFFF6FB7DBED7F8h
                cmp     r12, rax
                jb      short loc_14027A6C9
                mov     rax, rcx
                cmp     r12, rax
                ja      short loc_14027A6C9
                call    sub_140349680
                mov     rcx, 0FFFFF6FB7DBED7F8h
                test    eax, eax
                jz      short loc_14027A6C9
                or      rdx, 20h

loc_14027A6C9:                          ; CODE XREF: sub_140279F60+748↑j
                                        ; sub_140279F60+750↑j ...
                mov     eax, cs:dword_140CFC400
                bt      eax, 0Bh
                jnb     short loc_14027A6DC
                mov     edx, 20h ; ' '
                jmp     short loc_14027A6E5
; ---------------------------------------------------------------------------

loc_14027A6DC:                          ; CODE XREF: sub_140279F60+773↑j
                bt      eax, 1Ah
                jnb     short loc_14027A6E5
                lfence

loc_14027A6E5:                          ; CODE XREF: sub_140279F60+77A↑j
                                        ; sub_140279F60+780↑j
                test    dl, 20h
                jnz     short loc_14027A71B
                mov     r11, [rsp+78h+var_50]
                xchg    r11, [r12]
                mov     rax, rbx
                cmp     r12, rax
                jb      short loc_14027A710
                mov     rax, rcx
                cmp     r12, rax
                ja      short loc_14027A710
                mov     rdx, [rsp+78h+var_50]
                mov     rcx, r12
                call    sub_140349620

loc_14027A710:                          ; CODE XREF: sub_140279F60+799↑j
                                        ; sub_140279F60+7A1↑j
                test    r11b, 20h
                jnz     short loc_14027A780
                jmp     loc_14027A7A8
; ---------------------------------------------------------------------------

loc_14027A71B:                          ; CODE XREF: sub_140279F60+788↑j
                mov     rdx, [rsp+78h+var_50]
                mov     rax, rbx
                cmp     r12, rax
                jb      short loc_14027A77C
                mov     rax, rcx
                cmp     r12, rax
                ja      short loc_14027A77C
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027A758
                cmp     byte ptr cs:word_140C4DE88+1, r14b
                jnz     short loc_14027A74A
                test    dl, 1
                jz      short loc_14027A74A
                or      rdx, r10

loc_14027A74A:                          ; CODE XREF: sub_140279F60+7E0↑j
                                        ; sub_140279F60+7E5↑j
                mov     rcx, r12
                mov     [r12], rdx
                call    sub_140349620
                jmp     short loc_14027A780
; ---------------------------------------------------------------------------

loc_14027A758:                          ; CODE XREF: sub_140279F60+7D7↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027A77C
                test    dl, 1
                jz      short loc_14027A77C
                or      rdx, r10

loc_14027A77C:                          ; CODE XREF: sub_140279F60+7C6↑j
                                        ; sub_140279F60+7CE↑j ...
                mov     [r12], rdx

loc_14027A780:                          ; CODE XREF: sub_140279F60+7B4↑j
                                        ; sub_140279F60+7F6↑j
                and     rdi, 0FFFFFFFFFFFFF000h
                mov     rdx, rdi

loc_14027A78A:                          ; CODE XREF: sub_140279F60+713↑j
                mov     rcx, [rsp+78h+arg_18]
                xor     r9d, r9d
                lea     r8d, [r9+1]
                call    sub_1402882E0

loc_14027A79E:                          ; CODE XREF: sub_140279F60+612↑j
                mov     rbx, 0FFFFF6FB7DBED000h

loc_14027A7A8:                          ; CODE XREF: sub_140279F60+7B6↑j
                test    r13, r13
                jz      short loc_14027A7BC
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax

loc_14027A7BC:                          ; CODE XREF: sub_140279F60+84B↑j
                cmp     r14d, 1
                jz      loc_14027A91E
                mov     rcx, r15
                call    sub_1403F41D8
                test    eax, eax
                jnz     loc_14027A91E
                mov     rdx, [r15+10h]
                lea     r8, [r15+10h]
                mov     rax, rbx
                cmp     r8, rax
                jb      short loc_14027A857
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r8, rax
                ja      short loc_14027A857
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027A857
                test    dl, 1
                jz      short loc_14027A860
                test    dl, 20h
                jz      short loc_14027A810
                test    dl, 42h
                jnz     short loc_14027A857

loc_14027A810:                          ; CODE XREF: sub_140279F60+8A9↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14027A857
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14027A857
                or      rdx, 42h

loc_14027A857:                          ; CODE XREF: sub_140279F60+884↑j
                                        ; sub_140279F60+896↑j ...
                test    dl, 1
                jnz     loc_14027A91E

loc_14027A860:                          ; CODE XREF: sub_140279F60+8A4↑j
                test    rdx, rdx
                jz      short loc_14027A87A
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14027A87A
                test    rax, rdx
                jz      loc_14027A91E

loc_14027A87A:                          ; CODE XREF: sub_140279F60+903↑j
                                        ; sub_140279F60+90F↑j
                mov     rax, cs:qword_140C4E4C8
                mov     rcx, [r15+28h]
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     r9, [rax+rcx*8]
                mov     eax, [r9+40Ch]
                test    eax, eax
                jz      loc_14027A91E
                movzx   eax, dl
                shr     al, 1
                test    al, 1
                jnz     short loc_14027A91E
                mov     r8, [rsp+78h+arg_0]
                mov     rcx, r8
                call    sub_140209D60
                test    rax, rax
                jnz     short loc_14027A91E
                mov     rcx, rdx
                call    sub_1402C9850
                test    eax, eax
                jz      short loc_14027A8DA
                test    byte ptr [r15+22h], 10h
                jnz     short loc_14027A8DA
                test    byte ptr [r12], 42h
                jz      short loc_14027A91E

loc_14027A8DA:                          ; CODE XREF: sub_140279F60+96A↑j
                                        ; sub_140279F60+971↑j
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                mov     rcx, 3FFFFFFF78h
                add     rax, rcx
                cmp     r12, rax
                ja      short loc_14027A91E
                mov     rax, rdx
                cmp     r12, rax
                jb      short loc_14027A91E
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r12, rax
                ja      short loc_14027A91E
                mov     rdx, r12
                mov     rcx, r9
                call    sub_1402C8CC0

loc_14027A91E:                          ; CODE XREF: sub_140279F60+860↑j
                                        ; sub_140279F60+870↑j ...
                mov     rax, rsi

loc_14027A921:                          ; CODE XREF: sub_140279F60+4F8↑j
                mov     r13, [rsp+78h+var_38]
                mov     rsi, [rsp+78h+var_30]
                add     rsp, 50h
                pop     r15
                pop     r14
                pop     r12
                pop     rdi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
algn_14027A938:                         ; DATA XREF: .pdata:00000001400CE718↑o
                                        ; .pdata:00000001400CE724↑o ...
                align 20h
sub_140279F60   endp


; =============== S U B R O U T I N E =======================================


sub_14027A940   proc near               ; CODE XREF: sub_140279D90+1B6↑p
                                        ; DATA XREF: .pdata:00000001400CE730↑o

var_68          = dword ptr -68h
var_64          = dword ptr -64h
var_60          = dword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = word ptr  18h
arg_18          = qword ptr  20h

                mov     r11, rsp
                mov     [r11+20h], r9
                mov     [r11+18h], r8d
                mov     [r11+8], rcx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 48h
                mov     r13, rdx
                mov     r15, 0FFFFF68000000000h
                shr     r13, 9
                mov     rax, 7FFFFFFFF8h
                and     r13, rax
                mov     rbx, r9
                mov     ebp, r8d
                mov     rdi, rdx
                mov     rsi, rcx
                mov     rax, r15
                lea     rcx, [r11+20h]
                add     r13, rax
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     r14, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     r14, 4
                mov     rax, rax
                add     r14, rax
                mov     rax, r15
                mov     rcx, 0FFFFF6FFFFFFFFFFh
                cmp     rdi, rax
                jb      short loc_14027A9E8
                mov     rax, rcx
                cmp     rdi, rax
                ja      short loc_14027A9E8
                movzx   r12d, byte ptr [r14]
                shr     r12b, 1
                and     r12b, 7
                jmp     short loc_14027AA01
; ---------------------------------------------------------------------------

loc_14027A9E8:                          ; CODE XREF: sub_14027A940+91↑j
                                        ; sub_14027A940+99↑j
                mov     r12, rbx
                shr     rbx, 38h
                shr     r12, 3Ch
                and     bl, 0Fh
                and     r12b, 7
                shl     r12b, 4
                or      r12b, bl

loc_14027AA01:                          ; CODE XREF: sub_14027A940+A6↑j
                mov     rcx, r14
                call    sub_1403F41D8
                xor     r15d, r15d
                mov     [rsp+88h+arg_8], eax
                mov     ecx, 1
                test    bpl, 4
                jnz     loc_14027AAB2
                test    eax, eax
                jnz     loc_14027AB6A
                movzx   ecx, byte ptr [rsi+0B8h]
                and     cl, 7
                cmp     cl, 2
                jnb     short loc_14027AAB2
                xor     r8d, r8d
                xor     edx, edx
                mov     rcx, r14
                call    sub_14027B160
                test    eax, 0FFFFFFFDh
                jnz     short loc_14027AAB2
                mov     rcx, r14
                call    sub_1403F41D8
                test    eax, eax
                jnz     short loc_14027AA92
                mov     rcx, r13
                mov     rdx, 0FFFFF68000000000h
                shl     rcx, 19h
                mov     rax, rdx
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                mov     rax, rdx
                cmp     rcx, rax
                jb      short loc_14027AA92
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rcx, rax
                jbe     short loc_14027AAB2

loc_14027AA92:                          ; CODE XREF: sub_14027A940+117↑j
                                        ; sub_14027A940+13E↑j
                mov     ecx, 1

loc_14027AA97:                          ; CODE XREF: sub_14027A940+252↓j
                cmp     word ptr [r14+20h], 1
                jnz     short loc_14027AAB2
                movzx   eax, byte ptr [r14+22h]
                and     al, 0C0h
                cmp     al, 40h ; '@'
                jnz     short loc_14027AAB2
                mov     ebp, ecx
                test    [r14+23h], al
                jz      short loc_14027AAB5

loc_14027AAB2:                          ; CODE XREF: sub_14027A940+DC↑j
                                        ; sub_14027A940+F7↑j ...
                mov     ebp, r15d

loc_14027AAB5:                          ; CODE XREF: sub_14027A940+170↑j
                lea     rsi, [r14+18h]
                mov     [rsp+88h+var_68], r15d
                lock bts qword ptr [rsi], 3Fh ; '?'
                jnb     short loc_14027AAE0

loc_14027AAC6:                          ; CODE XREF: sub_14027A940+196↓j
                                        ; sub_14027A940+19E↓j
                lea     rcx, [rsp+88h+var_68]
                call    sub_1402C8C70
                mov     rax, [rsi]
                test    rax, rax
                js      short loc_14027AAC6
                lock bts qword ptr [rsi], 3Fh ; '?'
                jb      short loc_14027AAC6

loc_14027AAE0:                          ; CODE XREF: sub_14027A940+184↑j
                mov     rcx, 3FFFFFFFFFFFFFFFh
                mov     rdx, 2AAAAAAAAAAAAAABh
                test    ebp, ebp
                jz      loc_14027AD29
                mov     rax, [rsi]
                and     rax, rcx
                cmp     rax, 1
                jnz     loc_14027AD26
                cmp     [r14+20h], ax
                jnz     loc_14027AD26
                mov     r9, 0FFFFFA8000000000h
                mov     rax, r9
                mov     rcx, r14
                mov     r8d, 4
                sub     rcx, rax
                mov     rax, rdx
                imul    rcx
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                lea     rcx, [rdx+rdx*2]
                add     rcx, rcx
                mov     rax, r9
                movzx   eax, byte ptr [rax+rcx*8+22h]
                shr     eax, 6
                test    eax, eax
                jz      short loc_14027AB9D
                cmp     eax, 3
                jz      short loc_14027AB9D
                cmp     eax, 2
                jnz     short loc_14027ABA3
                lea     r8d, [rax+1Ah]
                jmp     short loc_14027ABA3
; ---------------------------------------------------------------------------

loc_14027AB6A:                          ; CODE XREF: sub_14027A940+E4↑j
                mov     rdx, 1000000000h
                test    [r14+28h], rdx
                jnz     short loc_14027AB89
                mov     rax, [r14+8]
                test    rax, rax
                js      short loc_14027AB89
                jnz     loc_14027AAB2

loc_14027AB89:                          ; CODE XREF: sub_14027A940+238↑j
                                        ; sub_14027A940+241↑j
                mov     eax, [r14+10h]
                bt      rax, 0Ah
                jnb     loc_14027AA97
                jmp     loc_14027AAB2
; ---------------------------------------------------------------------------

loc_14027AB9D:                          ; CODE XREF: sub_14027A940+218↑j
                                        ; sub_14027A940+21D↑j
                mov     r8d, 0Ch

loc_14027ABA3:                          ; CODE XREF: sub_14027A940+222↑j
                                        ; sub_14027A940+228↑j
                or      r8d, 0A0000000h
                xor     ecx, ecx
                call    sub_140280E60
                mov     r15, gs:20h
                mov     rbx, rax
                mov     rdi, [r15+7FF8h]
                test    rdi, rdi
                jz      short loc_14027AC15
                xor     r9d, r9d
                lea     rcx, [rdi+30A0h]
                lea     edx, [r9+3]
                lea     r8d, [r9+1]
                call    sub_140292240
                mov     r8, rax
                mov     rdx, 0FFFFF68000000000h
                shr     r8, 9
                mov     r9, 7FFFFFFFF8h
                and     r8, r9
                mov     r11, rax
                mov     rcx, rdx
                add     r8, rcx
                mov     [rdi+3038h], r8
                test    rax, rax
                jnz     short loc_14027AC57
                jmp     short loc_14027AC29
; ---------------------------------------------------------------------------

loc_14027AC15:                          ; CODE XREF: sub_14027A940+287↑j
                mov     rdx, 0FFFFF68000000000h
                mov     r9, 7FFFFFFFF8h

loc_14027AC29:                          ; CODE XREF: sub_14027A940+2D3↑j
                mov     rax, [r15+8200h]
                mov     r11, rax
                and     rax, 0FFFFFFFFFFFFF000h
                and     r11d, 0FFFh
                shl     r11, 0Ch
                add     r11, rax
                mov     r8, r11
                shr     r8, 9
                and     r8, r9
                mov     rax, rdx
                add     r8, rax

loc_14027AC57:                          ; CODE XREF: sub_14027A940+2D1↑j
                mov     rax, 0FFFFF6FB7DBED000h
                cmp     r8, rax
                jb      short loc_14027ACD7
                mov     rax, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                ja      short loc_14027ACD7
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027ACA9
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14027AC99
                test    bl, 1
                jz      short loc_14027AC99
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14027AC99:                          ; CODE XREF: sub_14027A940+345↑j
                                        ; sub_14027A940+34A↑j
                mov     rdx, rbx
                mov     [r8], rbx
                mov     rcx, r8
                call    sub_140349620
                jmp     short loc_14027ACDA
; ---------------------------------------------------------------------------

loc_14027ACA9:                          ; CODE XREF: sub_14027A940+33C↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027ACD7
                test    bl, 1
                jz      short loc_14027ACD7
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14027ACD7:                          ; CODE XREF: sub_14027A940+324↑j
                                        ; sub_14027A940+333↑j ...
                mov     [r8], rbx

loc_14027ACDA:                          ; CODE XREF: sub_14027A940+367↑j
                mov     rbx, r11
                lea     rdi, [r11+0FF8h]

loc_14027ACE4:                          ; CODE XREF: sub_14027A940+3B7↓j
                mov     rax, [rdi]
                or      rax, [rbx]
                jnz     short loc_14027ACF9
                add     rbx, 8
                sub     rdi, 8
                cmp     rbx, rdi
                jbe     short loc_14027ACE4

loc_14027ACF9:                          ; CODE XREF: sub_14027A940+3AA↑j
                mov     r8d, 80000000h
                mov     dl, 11h
                mov     rcx, r11
                call    sub_1402432B0
                cmp     rbx, rdi
                jbe     short loc_14027AD23
                mov     rcx, [rsp+88h+arg_0]
                mov     rdx, r14
                call    sub_1402CEE00
                xor     r15d, r15d
                jmp     short loc_14027AD29
; ---------------------------------------------------------------------------

loc_14027AD23:                          ; CODE XREF: sub_14027A940+3CC↑j
                xor     r15d, r15d

loc_14027AD26:                          ; CODE XREF: sub_14027A940+1C6↑j
                                        ; sub_14027A940+1D1↑j
                mov     ebp, r15d

loc_14027AD29:                          ; CODE XREF: sub_14027A940+1B6↑j
                                        ; sub_14027A940+3E1↑j
                mov     rbx, [rsp+88h+arg_18]
                mov     rdi, r15
                mov     [rsp+88h+var_58], r15
                mov     r11, 7FFFFFFFFFFFFFFFh
                test    ebp, ebp
                jnz     loc_14027AFD9
                test    bl, 4
                jnz     loc_14027AFD9
                test    bl, 42h
                jz      short loc_14027AD84
                mov     rcx, r14
                call    sub_1402A6940
                mov     rdi, rax
                test    rax, rax
                jz      short loc_14027AD89
                mov     rcx, [r14+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rbp, [rax+rcx*8]
                jmp     short loc_14027AD8C
; ---------------------------------------------------------------------------

loc_14027AD84:                          ; CODE XREF: sub_14027A940+417↑j
                mov     rbp, rdi
                jmp     short loc_14027AD8C
; ---------------------------------------------------------------------------

loc_14027AD89:                          ; CODE XREF: sub_14027A940+427↑j
                mov     rbp, r15

loc_14027AD8C:                          ; CODE XREF: sub_14027A940+442↑j
                                        ; sub_14027A940+447↑j
                cmp     [rsp+88h+arg_8], 0
                jz      loc_14027AEB6
                shr     r13, 9
                mov     r15, 7FFFFFFFF8h
                and     r15, r13
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     r15, rax
                mov     rcx, r15
                mov     rbx, [r15]
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027AE2B
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027AE2B
                test    bl, 1
                jz      short loc_14027AE2B
                test    bl, 20h
                jz      short loc_14027ADE2
                test    bl, 42h
                jnz     short loc_14027AE2B

loc_14027ADE2:                          ; CODE XREF: sub_14027A940+49B↑j
                mov     rax, gs:188h
                mov     edx, r15d
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14027AE2B
                shr     rdx, 3
                and     edx, 1FFh
                mov     rax, [rax+rdx*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14027AE2B
                or      rbx, 42h

loc_14027AE2B:                          ; CODE XREF: sub_14027A940+488↑j
                                        ; sub_14027A940+491↑j ...
                lea     rcx, [rsp+88h+var_50]
                mov     [rsp+88h+var_50], rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027AEA0
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027AEA0
                test    bl, 1
                jz      short loc_14027AEA0
                test    bl, 20h
                jz      short loc_14027AE56
                test    bl, 42h
                jnz     short loc_14027AEA0

loc_14027AE56:                          ; CODE XREF: sub_14027A940+50F↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027AEA0
                lea     rax, [rsp+88h+var_50]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14027AEA0
                or      rbx, 42h

loc_14027AEA0:                          ; CODE XREF: sub_14027A940+4FC↑j
                                        ; sub_14027A940+505↑j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                xor     r15d, r15d
                jmp     short loc_14027AEBD
; ---------------------------------------------------------------------------

loc_14027AEB6:                          ; CODE XREF: sub_14027A940+454↑j
                mov     rbx, 0FFFFFFFFFFFFFFFFh

loc_14027AEBD:                          ; CODE XREF: sub_14027A940+574↑j
                test    byte ptr [rsp+88h+arg_10], 1
                mov     r13, 3FFFFFFFFFFFFFFFh
                jz      short loc_14027AF05
                mov     rax, [rsi]
                and     rax, r13
                cmp     rax, 1
                jnz     short loc_14027AF05
                cmp     [r14+20h], ax
                jnz     short loc_14027AF05
                test    byte ptr [r14+22h], 10h
                jnz     short loc_14027AF05
                mov     rcx, r14
                call    sub_14022FC60
                cmp     eax, 5
                jnz     short loc_14027AF05
                movzx   eax, byte ptr [r14+23h]
                and     al, 0FCh
                or      al, 4
                mov     [r14+23h], al

loc_14027AF05:                          ; CODE XREF: sub_14027A940+58F↑j
                                        ; sub_14027A940+59B↑j ...
                movzx   eax, byte ptr [r14+22h]
                and     al, 7
                cmp     al, 6
                jnz     loc_14027B13E
                mov     rcx, [rsi]
                mov     rdx, rcx
                and     rdx, r13
                dec     rdx
                mov     rax, rdx
                xor     rax, rcx
                and     rax, r13
                xor     rax, rcx
                mov     [rsi], rax
                test    rdx, rdx
                jnz     short loc_14027AF3C
                mov     rcx, r14
                call    sub_140278C00

loc_14027AF3C:                          ; CODE XREF: sub_14027A940+5F2↑j
                mov     r14, 7FFFFFFFFFFFFFFFh
                cmp     rbx, 0FFFFFFFFFFFFFFFFh
                jz      loc_14027B0E6
                lock and [rsi], r14
                lea     rbx, [rbx+rbx*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                mov     [rsp+88h+var_64], r15d
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                lea     rsi, [rbx+18h]
                jnb     short loc_14027AF9A
                xchg    ax, ax

loc_14027AF80:                          ; CODE XREF: sub_14027A940+650↓j
                                        ; sub_14027A940+658↓j
                lea     rcx, [rsp+88h+var_64]
                call    sub_1402C8C70
                mov     rax, [rsi]
                test    rax, rax
                js      short loc_14027AF80
                lock bts qword ptr [rsi], 3Fh ; '?'
                jb      short loc_14027AF80

loc_14027AF9A:                          ; CODE XREF: sub_14027A940+63C↑j
                movzx   eax, byte ptr [rbx+22h]
                and     al, 7
                cmp     al, 6
                jnz     loc_14027B147
                mov     rcx, [rsi]
                mov     rdx, rcx
                and     rdx, r13
                dec     rdx
                mov     rax, rdx
                xor     rax, rcx
                and     rax, r13
                xor     rax, rcx
                mov     [rsi], rax
                test    rdx, rdx
                jnz     loc_14027B0E6
                mov     rcx, rbx
                call    sub_140278C00
                jmp     loc_14027B0E6
; ---------------------------------------------------------------------------

loc_14027AFD9:                          ; CODE XREF: sub_14027A940+405↑j
                                        ; sub_14027A940+40E↑j
                mov     rcx, r13
                call    sub_1402C78A0
                movzx   ecx, byte ptr [r14+22h]
                mov     r15, rax
                and     [r14+28h], r11
                and     cl, 0C7h
                mov     [r14+22h], cl
                mov     rax, 0C000000000000000h
                movzx   ecx, byte ptr [r14+23h]
                xor     r13d, r13d
                and     [rsi], rax
                and     cl, 0DFh
                mov     [r14+23h], cl
                xor     r8d, r8d
                lea     rcx, [r14+10h]
                mov     [r14+20h], r13w
                xor     edx, edx
                call    sub_140338C90
                mov     rdi, rax
                test    rax, rax
                jz      short loc_14027B046
                mov     rdx, [r14+28h]
                mov     rcx, cs:qword_140C4E4C8
                shr     rdx, 27h
                and     edx, 3FFh
                mov     rbp, [rcx+rdx*8]
                jmp     short loc_14027B04B
; ---------------------------------------------------------------------------

loc_14027B046:                          ; CODE XREF: sub_14027A940+6E9↑j
                mov     rbp, [rsp+88h+var_58]

loc_14027B04B:                          ; CODE XREF: sub_14027A940+704↑j
                test    bl, 4
                mov     rax, 0FFFFFA8000000000h
                mov     r8d, r13d
                setnz   r8b
                mov     rcx, rax
                sub     r14, rcx
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    r14
                mov     rcx, rdx
                lea     edx, [r8+1]
                sar     rcx, 3
                mov     rax, rcx
                shr     rax, 3Fh
                add     rcx, rax
                call    sub_140292A50
                mov     r14, 7FFFFFFFFFFFFFFFh
                lock and [rsi], r14
                lea     rbx, [r15+r15*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                mov     [rsp+88h+var_60], r13d
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                lea     rsi, [rbx+18h]
                jnb     short loc_14027B0DE

loc_14027B0C4:                          ; CODE XREF: sub_14027A940+794↓j
                                        ; sub_14027A940+79C↓j
                lea     rcx, [rsp+88h+var_60]
                call    sub_1402C8C70
                mov     rax, [rsi]
                test    rax, rax
                js      short loc_14027B0C4
                lock bts qword ptr [rsi], 3Fh ; '?'
                jb      short loc_14027B0C4

loc_14027B0DE:                          ; CODE XREF: sub_14027A940+782↑j
                mov     rcx, rbx
                call    sub_1402C5FA0

loc_14027B0E6:                          ; CODE XREF: sub_14027A940+60A↑j
                                        ; sub_14027A940+686↑j ...
                lock and [rsi], r14
                test    rdi, rdi
                jz      short loc_14027B100
                mov     r8d, 1
                mov     rdx, rdi
                mov     rcx, rbp
                call    sub_14020B2C0

loc_14027B100:                          ; CODE XREF: sub_14027A940+7AD↑j
                cmp     [rsp+88h+arg_8], 0
                mov     eax, 1
                mov     ecx, 3
                mov     byte ptr [rsp+88h+arg_10], r12b
                cmovz   eax, ecx
                mov     byte ptr [rsp+88h+arg_10+1], al
                movzx   eax, [rsp+88h+arg_10]
                add     rsp, 48h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027B13E:                          ; CODE XREF: sub_14027A940+5CE↑j
                mov     rcx, r14
                call    sub_1403F4244
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027B147:                          ; CODE XREF: sub_14027A940+662↑j
                mov     rcx, rbx
                call    sub_1403F4244
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027A940   endp

algn_14027B150:                         ; DATA XREF: .pdata:00000001400CE730↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027B160   proc near               ; CODE XREF: sub_140228E90+356↑p
                                        ; sub_140228E90+43D↑p ...

var_28          = qword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                push    rbx
                push    rbp
                push    rdi
                push    r13
                sub     rsp, 28h
                mov     r9d, cs:dword_140CFC400
                mov     rbx, r8
                mov     r13d, edx
                mov     rbp, rcx
                bt      r9d, 0Dh
                jnb     loc_14027B4F8
                mov     rax, [rcx+28h]
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 3
                jnz     loc_14027B4F8
                call    sub_1402303F0
                test    eax, eax
                jnz     loc_14027B4F8
                xor     r8d, r8d
                test    rbx, rbx
                jz      short loc_14027B1B5
                bt      r9d, 0Fh
                cmovnb  rbx, r8

loc_14027B1B5:                          ; CODE XREF: sub_14027B160+4A↑j
                mov     rdx, [rbp+8]
                mov     rax, 8000000000000000h
                mov     rdi, rdx
                mov     rcx, rbp
                or      rdi, rax
                call    sub_1403F41D8
                test    eax, eax
                jnz     loc_14027B3C8

loc_14027B1D9:                          ; DATA XREF: .rdata:000000014005DF98↑o
                                        ; .rdata:000000014005DFA8↑o ...
                mov     [rsp+48h+arg_0], rsi
                mov     [rsp+48h+arg_8], r12
                bt      r9d, 12h
                jnb     short loc_14027B239
                shl     rdi, 19h
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                shl     rax, 19h
                mov     r12, 0FFFF800000000000h
                sub     rdi, rax
                mov     esi, 11h
                sar     rdi, 10h
                mov     r8d, 2
                cmp     rdi, r12
                mov     r12, [rsp+48h+arg_8]
                cmovb   esi, r8d
                mov     eax, esi
                mov     rsi, [rsp+48h+arg_0]
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
byte_14027B238  db 0CCh                 ; DATA XREF: .pdata:00000001400CE748↑o
                                        ; .pdata:00000001400CE754↑o
; ---------------------------------------------------------------------------

loc_14027B239:                          ; CODE XREF: sub_14027B160+88↑j
                                        ; DATA XREF: .pdata:00000001400CE754↑o ...
                test    rdx, rdx
                jnz     short loc_14027B268
                lea     esi, [rdx+4]
                test    rbx, rbx
                jz      loc_14027B3B1
                mov     r12, [rsp+48h+arg_8]
                mov     eax, esi
                mov     rsi, [rsp+48h+arg_0]
                mov     [rbx], r8
                mov     [rbx+8], r8
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
algn_14027B267:                         ; DATA XREF: .pdata:00000001400CE760↑o
                                        ; .pdata:00000001400CE76C↑o
                align 8

loc_14027B268:                          ; CODE XREF: sub_14027B160+DC↑j
                                        ; DATA XREF: .pdata:00000001400CE76C↑o ...
                shl     rdi, 19h
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                shl     rax, 19h
                mov     r12, 0FFFF800000000000h
                sub     rdi, rax
                sar     rdi, 10h
                cmp     rdi, r12
                jb      short loc_14027B2CF
                mov     eax, [rbp+10h]
                mov     esi, 1
                shr     al, 5
                test    al, 2
                mov     eax, 40h ; '@'
                cmovz   esi, eax
                test    rbx, rbx
                jz      loc_14027B3B1
                mov     r12, [rsp+48h+arg_8]
                mov     eax, esi
                mov     rsi, [rsp+48h+arg_0]
                mov     [rbx], rdi
                mov     [rbx+8], r8
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
byte_14027B2CE  db 0CCh                 ; DATA XREF: .pdata:00000001400CE778↑o
                                        ; .pdata:00000001400CE784↑o
; ---------------------------------------------------------------------------

loc_14027B2CF:                          ; CODE XREF: sub_14027B160+131↑j
                                        ; DATA XREF: .rdata:000000014005E030↑o ...
                mov     esi, 14h
                test    rbx, rbx
                jz      loc_14027B3B1

loc_14027B2DD:                          ; DATA XREF: .rdata:000000014005E030↑o
                                        ; .rdata:000000014005E044↑o ...
                mov     [rsp+48h+arg_10], r14
                mov     [rsp+48h+var_28], r15
                test    r13d, r13d
                jnz     short loc_14027B2F7
                call    sub_1402DAA00
                movzx   r14d, al
                jmp     short loc_14027B2FA
; ---------------------------------------------------------------------------

loc_14027B2F7:                          ; CODE XREF: sub_14027B160+18A↑j
                mov     r14b, 11h

loc_14027B2FA:                          ; CODE XREF: sub_14027B160+195↑j
                mov     rcx, rbp
                call    sub_1402E4150
                mov     rcx, 7FFFFFFFFFFFFFFFh
                mov     r15, [rax]
                shr     r15, 0Dh
                and     r15, 0FFFFFFFFFFFFFFF0h
                or      r15, r12
                lock and [rax+18h], rcx
                test    r13d, r13d
                jnz     short loc_14027B38B
                lock and [rbp+18h], rcx
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027B383
                test    al, 1
                jz      short loc_14027B383
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14027B383
                cmp     r14b, 0Fh
                ja      short loc_14027B383
                cmp     al, 2
                jb      short loc_14027B383
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r14b
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14027B383
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14027B383:                          ; CODE XREF: sub_14027B160+1D1↑j
                                        ; sub_14027B160+1D5↑j ...
                movzx   eax, r14b
                mov     cr8, rax

loc_14027B38B:                          ; CODE XREF: sub_14027B160+1C2↑j
                cmp     qword ptr [r15+3E0h], 0
                mov     r14, [rsp+48h+arg_10]
                jz      short loc_14027B3AA

loc_14027B39A:                          ; DATA XREF: .pdata:00000001400CE79C↑o
                                        ; .pdata:00000001400CE7A8↑o
                mov     [rbx], rdi
                mov     rax, [r15+3E0h]
                mov     [rbx+8], rax
                jmp     short loc_14027B3AC
; ---------------------------------------------------------------------------

loc_14027B3AA:                          ; CODE XREF: sub_14027B160+238↑j
                xor     esi, esi

loc_14027B3AC:                          ; CODE XREF: sub_14027B160+248↑j
                mov     r15, [rsp+48h+var_28]

loc_14027B3B1:                          ; CODE XREF: sub_14027B160+E4↑j
                                        ; sub_14027B160+14B↑j ...
                mov     r12, [rsp+48h+arg_8]
                mov     eax, esi
                mov     rsi, [rsp+48h+arg_0]
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
algn_14027B3C7:                         ; DATA XREF: .pdata:00000001400CE7B4↑o
                                        ; .pdata:00000001400CE7C0↑o
                align 8

loc_14027B3C8:                          ; CODE XREF: sub_14027B160+73↑j
                mov     r10, [rbp+10h]
                bt      r10, 0Ah
                jb      short loc_14027B3FA
                shr     r9d, 12h
                and     r9d, 1
                shl     r9d, 4
                test    rbx, rbx
                jz      short loc_14027B3EB
                mov     [rbx], r8
                mov     [rbx+8], r8

loc_14027B3EB:                          ; CODE XREF: sub_14027B160+282↑j
                lea     eax, [r9+3]
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027B3FA:                          ; CODE XREF: sub_14027B160+271↑j
                mov     rax, cs:qword_140C4DDC0
                mov     rdx, r10
                test    rax, rax
                jz      short loc_14027B414
                test    dl, 10h
                jnz     short loc_14027B414
                not     rax
                and     rdx, rax

loc_14027B414:                          ; CODE XREF: sub_14027B160+2A7↑j
                                        ; sub_14027B160+2AC↑j
                sar     rdx, 10h
                mov     r11, [rdx]
                mov     eax, [r11+38h]
                test    al, 20h
                jnz     short loc_14027B433
                mov     eax, 2
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027B433:                          ; CODE XREF: sub_14027B160+2C1↑j
                mov     rcx, [rdx+8]
                cmp     rdi, rcx
                jb      loc_14027B4F8
                mov     eax, [rdx+2Ch]
                lea     rcx, [rcx+rax*8]
                cmp     rdi, rcx
                jnb     loc_14027B4F8
                mov     ecx, [r11+5Ch]
                test    ecx, 0C0000h
                jz      short loc_14027B47E
                bt      ecx, 11h
                jnb     short loc_14027B47E
                lea     rax, [r11+80h]
                cmp     rdx, rax
                jz      short loc_14027B47E
                mov     eax, 28h ; '('
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027B47E:                          ; CODE XREF: sub_14027B160+2FA↑j
                                        ; sub_14027B160+300↑j ...
                shr     r10, 5
                and     ecx, 0C0000h
                bt      r9d, 12h
                jnb     short loc_14027B4AD
                mov     r8d, 2
                test    ecx, ecx
                jz      short loc_14027B4C7
                mov     r8d, 0Ah
                test    r10b, 2
                jz      short loc_14027B4C7
                mov     r8d, 0Bh
                jmp     short loc_14027B4C7
; ---------------------------------------------------------------------------

loc_14027B4AD:                          ; CODE XREF: sub_14027B160+32D↑j
                test    ecx, ecx
                jz      short loc_14027B4F8
                mov     r8d, 0Bh
                test    r10b, 2
                mov     eax, 8
                cmovnz  eax, r8d
                mov     r8d, eax

loc_14027B4C7:                          ; CODE XREF: sub_14027B160+337↑j
                                        ; sub_14027B160+343↑j ...
                test    rbx, rbx
                jz      short loc_14027B4EA
                mov     rcx, [r11+60h]
                mov     rdx, [rcx+38h]
                mov     [rbx+8], rdx
                sub     rdi, [r11+88h]
                sar     rdi, 3
                shl     rdi, 0Ch
                mov     [rbx], rdi

loc_14027B4EA:                          ; CODE XREF: sub_14027B160+36A↑j
                mov     eax, r8d
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 8

loc_14027B4F8:                          ; CODE XREF: sub_14027B160+1F↑j
                                        ; sub_14027B160+31↑j ...
                xor     eax, eax
                add     rsp, 28h
                pop     r13
                pop     rdi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027B160   endp

algn_14027B505:                         ; DATA XREF: .pdata:00000001400CE7C0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14027B510   proc near               ; CODE XREF: sub_14022FC80+524↑p
                                        ; sub_140297FF0+445↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r14
                sub     rsp, 20h
                and     edx, 1
                mov     r14d, 0FFFFFFFFh
                mov     eax, edx
                neg     eax
                sbb     rbx, rbx
                xor     edx, 1
                and     rbx, r14
                xor     r11b, r11b
                lea     r10d, ds:4[rdx*4]
                call    sub_1403F41D8
                mov     ebp, 1
                test    eax, eax
                jz      short loc_14027B569
                mov     eax, [rcx+10h]
                bt      rax, 0Ah
                jnb     short loc_14027B569
                movzx   edi, bpl
                jmp     short loc_14027B577
; ---------------------------------------------------------------------------

loc_14027B569:                          ; CODE XREF: sub_14027B510+47↑j
                                        ; sub_14027B510+51↑j
                call    sub_140279D40
                test    eax, eax
                movzx   edi, r11b
                cmovnz  edi, ebp

loc_14027B577:                          ; CODE XREF: sub_14027B510+57↑j
                mov     rcx, [rcx+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rsi, [rax+rcx*8]
                test    dil, dil
                jz      short loc_14027B5A7
                mov     r8d, r10d
                mov     rdx, rbp
                mov     rcx, rsi
                call    sub_140232160
                test    eax, eax
                jz      short loc_14027B602

loc_14027B5A7:                          ; CODE XREF: sub_14027B510+83↑j
                lea     rax, unk_140C50C00
                cmp     rsi, rax
                jnz     short loc_14027B5DC
                mov     rdx, gs:20h
                mov     eax, [rdx+831Ch]
                cmp     eax, ebp
                jb      short loc_14027B5DC

loc_14027B5C6:                          ; CODE XREF: sub_14027B510+CA↓j
                cmp     eax, r14d
                jz      short loc_14027B5DC
                lea     ecx, [rax-1]
                lock cmpxchg [rdx+831Ch], ecx
                jz      short loc_14027B61E
                cmp     eax, ebp
                jnb     short loc_14027B5C6

loc_14027B5DC:                          ; CODE XREF: sub_14027B510+A1↑j
                                        ; sub_14027B510+B4↑j ...
                mov     r8, rbx
                mov     rdx, rbp
                mov     rcx, rsi
                call    sub_1403438BC
                mov     ebx, eax
                test    eax, eax
                jnz     short loc_14027B600
                test    dil, dil
                jz      short loc_14027B600
                mov     rdx, rbp
                mov     rcx, rsi
                call    sub_14026B700

loc_14027B600:                          ; CODE XREF: sub_14027B510+DE↑j
                                        ; sub_14027B510+E3↑j ...
                mov     eax, ebx

loc_14027B602:                          ; CODE XREF: sub_14027B510+95↑j
                mov     rbx, [rsp+28h+arg_0]
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027B61E:                          ; CODE XREF: sub_14027B510+C6↑j
                mov     ebx, ebp
                jmp     short loc_14027B600
sub_14027B510   endp

; ---------------------------------------------------------------------------
algn_14027B622:                         ; DATA XREF: .pdata:00000001400CE7CC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14027B630   proc near               ; CODE XREF: sub_140221EA0+492↑p
                                        ; sub_140226D20+2A2↑p ...

arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

                push    rbx
                sub     rsp, 20h
                movzx   edx, word ptr [rcx+20h]
                mov     rbx, rcx
                test    dx, dx
                jz      loc_14027B87C

loc_14027B646:                          ; DATA XREF: .rdata:000000014005E0B8↑o
                                        ; .rdata:000000014005E0C8↑o ...
                mov     [rsp+28h+arg_8], rbp
                mov     eax, 0FFFFh
                add     dx, ax
                mov     [rsp+28h+arg_10], rsi
                mov     [rcx+20h], dx
                mov     ebp, 1
                mov     [rsp+28h+arg_18], rdi
                jnz     short loc_14027B675
                call    sub_1402303F0
                test    eax, eax
                jnz     loc_14027B82D

loc_14027B675:                          ; CODE XREF: sub_14027B630+36↑j
                mov     r11, [rbx+28h]
                mov     rax, 1000000000h
                test    rax, r11
                jnz     loc_14027B864
                mov     rax, 2000000000000h
                test    rax, r11
                jnz     loc_14027B864
                mov     rdi, [rbx+18h]
                mov     rcx, 3FFFFFFFFFFFFFFFh
                mov     rax, rdi
                xor     r10d, r10d
                and     rax, rcx
                test    dx, dx
                jz      short loc_14027B6E9
                cmp     dx, bp
                jnz     short loc_14027B6C7
                test    rax, rax
                jnz     short loc_14027B6E4
                jmp     short loc_14027B6DA
; ---------------------------------------------------------------------------

loc_14027B6C7:                          ; CODE XREF: sub_14027B630+8E↑j
                cmp     dx, 2
                jnz     loc_14027B864
                test    rax, rax
                jz      loc_14027B864

loc_14027B6DA:                          ; CODE XREF: sub_14027B630+95↑j
                test    byte ptr [rbx+22h], 8
                jz      loc_14027B864

loc_14027B6E4:                          ; CODE XREF: sub_14027B630+93↑j
                mov     esi, r10d
                jmp     short loc_14027B6EB
; ---------------------------------------------------------------------------

loc_14027B6E9:                          ; CODE XREF: sub_14027B630+89↑j
                mov     esi, ebp

loc_14027B6EB:                          ; CODE XREF: sub_14027B630+B7↑j
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                mov     rcx, 3FFFFFFF78h
                mov     rdx, 8000000000000000h
                add     rax, rcx
                mov     rcx, [rbx+8]
                or      rcx, rdx
                cmp     rcx, rax
                ja      short loc_14027B723
                mov     rax, r8
                cmp     rcx, rax
                jnb     short loc_14027B735

loc_14027B723:                          ; CODE XREF: sub_14027B630+E9↑j
                movzx   eax, byte ptr [rbx+23h]
                test    al, 20h
                jz      short loc_14027B735
                and     al, 0DFh
                mov     [rbx+23h], al
                jmp     loc_14027B829
; ---------------------------------------------------------------------------

loc_14027B735:                          ; CODE XREF: sub_14027B630+F1↑j
                                        ; sub_14027B630+F9↑j
                mov     rcx, rbx
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14027B750
                mov     eax, [rbx+10h]
                bt      rax, 0Ah
                jnb     short loc_14027B750
                mov     r10d, ebp
                jmp     short loc_14027B76D
; ---------------------------------------------------------------------------

loc_14027B750:                          ; CODE XREF: sub_14027B630+10F↑j
                                        ; sub_14027B630+119↑j
                call    sub_140279D40
                test    eax, eax
                jz      short loc_14027B75E
                mov     r10d, ebp
                jmp     short loc_14027B76D
; ---------------------------------------------------------------------------

loc_14027B75E:                          ; CODE XREF: sub_14027B630+127↑j
                cmp     esi, ebp
                jnz     short loc_14027B76D
                shr     rdi, 3Eh
                test    bpl, dil
                cmovnz  r10d, ebp

loc_14027B76D:                          ; CODE XREF: sub_14027B630+11E↑j
                                        ; sub_14027B630+12C↑j ...
                mov     rax, cs:qword_140C4E4C8
                shr     r11, 27h
                and     r11d, 3FFh
                mov     rdi, [rax+r11*8]
                cmp     r10d, ebp
                jnz     short loc_14027B793
                mov     rdx, rbp
                mov     rcx, rdi
                call    sub_14026B700

loc_14027B793:                          ; CODE XREF: sub_14027B630+156↑j
                lea     rax, unk_140C50C00
                mov     r8, rbp
                cmp     rdi, rax
                jnz     short loc_14027B820
                mov     r9, gs:20h
                movsxd  rdx, dword ptr [r9+831Ch]
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14027B820
                lea     rcx, [rdx+1]
                cmp     rcx, 100h
                ja      short loc_14027B7F4
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_14027B7D0:                          ; CODE XREF: sub_14027B630+1C2↓j
                lea     ecx, [rdx+1]
                mov     eax, edx
                lock cmpxchg [r9+831Ch], ecx
                movsxd  rdx, eax
                jz      short loc_14027B829
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14027B7F4
                lea     rax, [rdx+1]
                cmp     rax, 100h
                jbe     short loc_14027B7D0

loc_14027B7F4:                          ; CODE XREF: sub_14027B630+192↑j
                                        ; sub_14027B630+1B6↑j
                mov     ecx, 0C0h
                cmp     edx, ecx
                jle     short loc_14027B81B
                cmp     edx, 0FFFFFFFFh
                jz      short loc_14027B81B
                mov     eax, edx
                lock cmpxchg [r9+831Ch], ecx
                jnz     short loc_14027B81B
                lea     eax, [rdx-0C0h]
                movsxd  r8, eax
                inc     r8

loc_14027B81B:                          ; CODE XREF: sub_14027B630+1CB↑j
                                        ; sub_14027B630+1D0↑j ...
                test    r8, r8
                jz      short loc_14027B829

loc_14027B820:                          ; CODE XREF: sub_14027B630+170↑j
                                        ; sub_14027B630+185↑j
                lock xadd [rdi+1C00h], r8

loc_14027B829:                          ; CODE XREF: sub_14027B630+100↑j
                                        ; sub_14027B630+1B1↑j ...
                test    esi, esi
                jz      short loc_14027B864

loc_14027B82D:                          ; CODE XREF: sub_14027B630+3F↑j
                mov     rdx, 0FFFFFA8000000000h
                mov     rcx, rbx
                mov     rax, 2AAAAAAAAAAAAAABh
                sub     rcx, rdx
                imul    rcx
                sar     rdx, 3
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rdx, rcx
                mov     rcx, rbx
                call    sub_140278860
                mov     eax, ebp
                jmp     short loc_14027B866
; ---------------------------------------------------------------------------

loc_14027B864:                          ; CODE XREF: sub_14027B630+56↑j
                                        ; sub_14027B630+69↑j ...
                xor     eax, eax

loc_14027B866:                          ; CODE XREF: sub_14027B630+232↑j
                mov     rsi, [rsp+28h+arg_10]
                mov     rbp, [rsp+28h+arg_8]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
algn_14027B87B:                         ; DATA XREF: .pdata:00000001400CE7E4↑o
                                        ; .pdata:00000001400CE7F0↑o
                align 4

loc_14027B87C:                          ; CODE XREF: sub_14027B630+10↑j
                call    sub_1403F41EC
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027B630   endp

algn_14027B882:                         ; DATA XREF: .pdata:00000001400CE7F0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14027B890   proc near               ; CODE XREF: sub_140213C50+102↑p
                                        ; sub_14028E340+4F0↓p ...

var_78          = qword ptr -78h
var_68          = dword ptr -68h
var_64          = dword ptr -64h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_18], r9
                mov     [rsp+arg_10], r8d
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                sub     rsp, 68h
                mov     rdi, cs:qword_14001D278
                xor     r11d, r11d
                mov     rbx, [rdx]
                mov     r14, rdx
                mov     [rsp+98h+var_50], r11
                mov     r8, rcx
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rax, r10
                mov     rdx, 0FFFFF6FB7DBED7F8h
                cmp     r14, rax
                jb      short loc_14027B952
                mov     rax, rdx
                cmp     r14, rax
                ja      short loc_14027B952
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027B948
                test    bl, 1
                jz      short loc_14027B948
                test    bl, 20h
                jz      short loc_14027B900
                test    bl, 42h
                jnz     short loc_14027B948

loc_14027B900:                          ; CODE XREF: sub_14027B890+69↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027B948
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14027B948
                or      rbx, 42h

loc_14027B948:                          ; CODE XREF: sub_14027B890+5F↑j
                                        ; sub_14027B890+64↑j ...
                mov     rdx, 0FFFFF6FB7DBED7F8h

loc_14027B952:                          ; CODE XREF: sub_14027B890+4E↑j
                                        ; sub_14027B890+56↑j
                movzx   ecx, word ptr [r8+0AEh]
                mov     rax, cs:qword_140C4E4C8
                mov     [rsp+98h+var_60], rbx
                mov     r13, [rax+rcx*8]
                mov     rax, r10
                lea     rcx, [rsp+98h+var_60]
                cmp     rcx, rax
                jb      short loc_14027B9E8
                mov     rax, rdx
                lea     rcx, [rsp+98h+var_60]
                cmp     rcx, rax
                ja      short loc_14027B9E8
                mov     rdx, rbx
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027B9EB
                test    bl, 1
                jz      short loc_14027B9EB
                test    bl, 20h
                jz      short loc_14027B99F
                test    bl, 42h
                jnz     short loc_14027B9EB

loc_14027B99F:                          ; CODE XREF: sub_14027B890+108↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027B9E8
                lea     rax, [rsp+98h+var_60]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                test    al, 42h
                jz      short loc_14027B9EB
                or      rdx, 42h
                jmp     short loc_14027B9EB
; ---------------------------------------------------------------------------

loc_14027B9E8:                          ; CODE XREF: sub_14027B890+E5↑j
                                        ; sub_14027B890+F2↑j ...
                mov     rdx, rbx

loc_14027B9EB:                          ; CODE XREF: sub_14027B890+FE↑j
                                        ; sub_14027B890+103↑j ...
                shr     rdx, 0Ch
                mov     r10, 0FFFFFFFFFh
                and     rdx, r10

loc_14027B9FC:                          ; DATA XREF: .rdata:000000014005E0F8↑o
                                        ; .rdata:000000014005E108↑o ...
                mov     [rsp+98h+var_38], rbp
                mov     [rsp+98h+var_40], r15
                mov     r8, 0FFFFFA8000000000h
                lea     r12, [rdx+rdx*2]
                shl     r12, 4
                mov     rax, r8
                mov     rdx, [r12+rax+28h]
                lea     rsi, [r12+rax]
                mov     rax, cs:qword_140C4E4C8
                mov     rcx, rdx
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rax, [rax+rcx*8]
                mov     rcx, rsi
                mov     [rsp+98h+var_58], rax
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14027BB68
                mov     rax, 1000000000h
                mov     r15, 8000000000000000h
                test    rax, rdx
                jnz     short loc_14027BA83
                mov     rax, [rsi+8]
                test    rax, rax
                js      short loc_14027BA83
                jz      short loc_14027BA83
                mov     r11, rax
                or      r11, r15
                mov     [rsp+98h+var_50], r11
                xor     r11d, r11d

loc_14027BA83:                          ; CODE XREF: sub_14027B890+1D8↑j
                                        ; sub_14027B890+1E1↑j ...
                mov     rcx, r14
                call    sub_1402C78A0
                lea     rbp, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rbp, 4
                mov     rax, rax
                add     rbp, rax
                mov     [rsp+98h+arg_8], r11d
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jnb     short loc_14027BADF
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_14027BAC0:                          ; CODE XREF: sub_14027B890+244↓j
                                        ; sub_14027B890+24D↓j
                lea     rcx, [rsp+98h+arg_8]
                call    sub_1402C8C70
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_14027BAC0
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_14027BAC0

loc_14027BADF:                          ; CODE XREF: sub_14027B890+222↑j
                test    bl, 42h
                jz      short loc_14027BAEF
                mov     rcx, rsi
                call    sub_1402A6940
                mov     rdi, rax

loc_14027BAEF:                          ; CODE XREF: sub_14027B890+252↑j
                mov     rcx, [rsi+10h]
                bt      rcx, 0Ah
                jnb     short loc_14027BB4E
                bt      rbx, 9
                jb      short loc_14027BB4E
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14027BB18
                test    cl, 10h
                jnz     short loc_14027BB18
                not     rax
                and     rcx, rax

loc_14027BB18:                          ; CODE XREF: sub_14027B890+27B↑j
                                        ; sub_14027B890+280↑j
                mov     r12, [rsp+98h+arg_18]
                mov     r10d, [rsp+98h+arg_10]
                sar     rcx, 10h
                mov     rax, [rcx]
                mov     ecx, [rax+38h]
                and     ecx, 820h
                cmp     ecx, 820h
                jnz     loc_14027BCD5
                inc     qword ptr [r12+18h]
                jmp     loc_14027BCD5
; ---------------------------------------------------------------------------

loc_14027BB4E:                          ; CODE XREF: sub_14027B890+268↑j
                                        ; sub_14027B890+26F↑j
                mov     r12, [rsp+98h+arg_18]
                mov     r10d, [rsp+98h+arg_10]
                inc     qword ptr [r12+18h]
                jmp     loc_14027BCD5
; ---------------------------------------------------------------------------

loc_14027BB68:                          ; CODE XREF: sub_14027B890+1BB↑j
                cmp     rsi, cs:qword_140C4EBE0
                jnz     loc_14027BBF5
                mov     rbx, cs:qword_14001D278
                mov     rcx, r14
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027BBED
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027BBBF
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14027BBAC
                test    bl, 1
                jz      short loc_14027BBAC
                mov     r15, 8000000000000000h
                or      rbx, r15

loc_14027BBAC:                          ; CODE XREF: sub_14027B890+308↑j
                                        ; sub_14027B890+30D↑j
                mov     rdx, rbx
                mov     [r14], rbx
                mov     rcx, r14
                call    sub_140349620
                jmp     loc_14027BE5A
; ---------------------------------------------------------------------------

loc_14027BBBF:                          ; CODE XREF: sub_14027B890+2FF↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027BBED
                test    bl, 1
                jz      short loc_14027BBED
                mov     r15, 8000000000000000h
                or      rbx, r15

loc_14027BBED:                          ; CODE XREF: sub_14027B890+2F6↑j
                                        ; sub_14027B890+349↑j ...
                mov     [r14], rbx
                jmp     loc_14027BE5A
; ---------------------------------------------------------------------------

loc_14027BBF5:                          ; CODE XREF: sub_14027B890+2DF↑j
                mov     rcx, [rsi+8]
                mov     r15, 8000000000000000h
                mov     rax, rcx
                or      rax, r15
                cmp     rax, r14
                jnz     loc_14027BE73
                and     rdx, r10
                lea     rbp, [rdx+rdx*2]
                shl     rbp, 4
                mov     rax, r8
                inc     qword ptr [r9+18h]
                add     rbp, rax
                mov     [rsp+98h+var_68], r11d
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jnb     short loc_14027BC51

loc_14027BC35:                          ; CODE XREF: sub_14027B890+3B6↓j
                                        ; sub_14027B890+3BF↓j
                lea     rcx, [rsp+98h+var_68]
                call    sub_1402C8C70
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_14027BC35
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_14027BC35

loc_14027BC51:                          ; CODE XREF: sub_14027B890+3A3↑j
                mov     rax, 4000000000000000h
                or      [rsi+18h], rax
                mov     rax, [rsi+28h]
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 2
                jnz     short loc_14027BCAA
                mov     rcx, rsi
                call    sub_1402A6940
                movzx   ecx, word ptr [rsi+20h]
                mov     rdi, rax
                test    cx, cx
                jz      short loc_14027BC91
                cmp     ecx, 2
                jbe     short loc_14027BC9C
                cmp     ecx, 3
                jnz     short loc_14027BC91
                test    byte ptr [rsi+22h], 8
                jnz     short loc_14027BC9C

loc_14027BC91:                          ; CODE XREF: sub_14027B890+3EF↑j
                                        ; sub_14027B890+3F9↑j
                cmp     [rsp+98h+var_58], r13
                jnz     loc_14027BE8E

loc_14027BC9C:                          ; CODE XREF: sub_14027B890+3F4↑j
                                        ; sub_14027B890+3FF↑j
                mov     rax, 8FFFFFFFFFFFFFFFh
                and     [rsi+28h], rax

loc_14027BCAA:                          ; CODE XREF: sub_14027B890+3DB↑j
                mov     r10d, [rsp+98h+arg_10]
                test    r10b, 4
                jz      short loc_14027BCCD
                mov     rcx, rsi
                call    sub_14037CC28
                test    eax, eax
                jz      short loc_14027BCCD
                call    sub_1405359C4
                and     byte ptr [rsi+23h], 0DFh

loc_14027BCCD:                          ; CODE XREF: sub_14027B890+426↑j
                                        ; sub_14027B890+432↑j
                mov     r12, [rsp+98h+arg_18]

loc_14027BCD5:                          ; CODE XREF: sub_14027B890+2AE↑j
                                        ; sub_14027B890+2B9↑j ...
                test    r10b, 10h
                jz      short loc_14027BCDF
                and     byte ptr [rsi+23h], 0F7h

loc_14027BCDF:                          ; CODE XREF: sub_14027B890+449↑j
                mov     rdx, cs:qword_14001D278
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r14, rax
                jb      short loc_14027BD55
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r14, rax
                ja      short loc_14027BD55
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027BD31
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14027BD24
                test    dl, 1
                jz      short loc_14027BD24
                or      rdx, r15

loc_14027BD24:                          ; CODE XREF: sub_14027B890+48A↑j
                                        ; sub_14027B890+48F↑j
                mov     rcx, r14
                mov     [r14], rdx
                call    sub_140349620
                jmp     short loc_14027BD58
; ---------------------------------------------------------------------------

loc_14027BD31:                          ; CODE XREF: sub_14027B890+481↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027BD55
                test    dl, 1
                jz      short loc_14027BD55
                or      rdx, r15

loc_14027BD55:                          ; CODE XREF: sub_14027B890+466↑j
                                        ; sub_14027B890+478↑j ...
                mov     [r14], rdx

loc_14027BD58:                          ; CODE XREF: sub_14027B890+49F↑j
                movzx   eax, byte ptr [rsi+22h]
                and     al, 7
                cmp     al, 6
                jnz     loc_14027BEC1
                mov     rcx, [rsi+18h]
                mov     r14, 3FFFFFFFFFFFFFFFh
                mov     rdx, rcx
                mov     rax, rcx
                and     rdx, r14
                dec     rdx
                xor     rax, rdx
                and     rax, r14
                xor     rax, rcx
                mov     [rsi+18h], rax
                test    rdx, rdx
                jnz     short loc_14027BD9E
                mov     rcx, rsi
                call    sub_140278C00
                mov     ebx, eax
                jmp     short loc_14027BDA3
; ---------------------------------------------------------------------------

loc_14027BD9E:                          ; CODE XREF: sub_14027B890+500↑j
                mov     ebx, 2

loc_14027BDA3:                          ; CODE XREF: sub_14027B890+50C↑j
                mov     r15, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], r15
                mov     [rsp+98h+var_64], 0
                lock bts qword ptr [rbp+18h], 3Fh ; '?'
                jnb     short loc_14027BDDF

loc_14027BDC3:                          ; CODE XREF: sub_14027B890+544↓j
                                        ; sub_14027B890+54D↓j
                lea     rcx, [rsp+98h+var_64]
                call    sub_1402C8C70
                mov     rax, [rbp+18h]
                test    rax, rax
                js      short loc_14027BDC3
                lock bts qword ptr [rbp+18h], 3Fh ; '?'
                jb      short loc_14027BDC3

loc_14027BDDF:                          ; CODE XREF: sub_14027B890+531↑j
                movzx   eax, byte ptr [rbp+22h]
                and     al, 7
                cmp     al, 6
                jnz     loc_14027BECA
                mov     rcx, [rbp+18h]
                mov     rdx, rcx
                mov     rax, rcx
                and     rdx, r14
                dec     rdx
                xor     rax, rdx
                and     rax, r14
                xor     rax, rcx
                mov     [rbp+18h], rax
                test    rdx, rdx
                jnz     short loc_14027BE17
                mov     rcx, rbp
                call    sub_140278C00

loc_14027BE17:                          ; CODE XREF: sub_14027B890+57D↑j
                lock and [rbp+18h], r15
                test    rdi, rdi
                jz      short loc_14027BE34
                mov     rcx, [rsp+98h+var_58]
                mov     r8d, 1
                mov     rdx, rdi
                call    sub_14020B2C0

loc_14027BE34:                          ; CODE XREF: sub_14027B890+58F↑j
                mov     rax, [rsp+98h+var_50]
                test    rax, rax
                jz      short loc_14027BE50
                mov     rcx, [rsp+98h+arg_0]
                mov     rdx, rax
                call    sub_140366EF4
                mov     ebx, eax

loc_14027BE50:                          ; CODE XREF: sub_14027B890+5AC↑j
                cmp     ebx, 3
                jnz     short loc_14027BE5A
                inc     qword ptr [r12+8]

loc_14027BE5A:                          ; CODE XREF: sub_14027B890+32A↑j
                                        ; sub_14027B890+360↑j ...
                mov     r15, [rsp+98h+var_40]
                mov     rbp, [rsp+98h+var_38]
                add     rsp, 68h
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
byte_14027BE72  db 0CCh                 ; DATA XREF: .pdata:00000001400CE808↑o
                                        ; .pdata:00000001400CE814↑o
; ---------------------------------------------------------------------------

loc_14027BE73:                          ; CODE XREF: sub_14027B890+37C↑j
                                        ; DATA XREF: .pdata:00000001400CE814↑o ...
                mov     [rsp+98h+var_78], rcx
                mov     r9, rbx
                mov     ecx, 1Ah
                mov     r8, r14
                mov     edx, 404h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14027BE8E:                          ; CODE XREF: sub_14027B890+406↑j
                mov     [rsp+98h+var_78], rcx
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    r12
                mov     r8, r14
                mov     ecx, 1Ah
                sar     rdx, 3
                mov     r9, rdx
                shr     r9, 3Fh
                add     r9, rdx
                mov     edx, 406h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14027BEC1:                          ; CODE XREF: sub_14027B890+4D0↑j
                mov     rcx, rsi
                call    sub_1403F4244
; ---------------------------------------------------------------------------
                align 2

loc_14027BECA:                          ; CODE XREF: sub_14027B890+557↑j
                mov     rcx, rbp
                call    sub_1403F4244
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027B890   endp

algn_14027BED3:                         ; DATA XREF: .pdata:00000001400CE820↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027BEE0   proc near               ; CODE XREF: sub_140278930+296↑p
                                        ; sub_140278C00+630↑p ...

var_78          = dword ptr -78h
var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
var_40          = xmmword ptr -40h
var_30          = qword ptr -30h
var_28          = byte ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                push    rsi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 50h
                xorps   xmm0, xmm0
                mov     r10, 0FFFFFA8000000000h
                xor     eax, eax
                mov     r14, rdx
                movups  [rsp+78h+var_58], xmm0
                mov     [rsp+78h+var_48], rax
                mov     rbp, rcx
                mov     rax, r10
                mov     rsi, [r14+28h]
                mov     r8, rdx
                sub     r8, rax
                mov     r9, 2AAAAAAAAAAAAAABh
                mov     rax, r9
                imul    r8
                mov     r15, rdx
                sar     r15, 3
                mov     rax, r15
                shr     rax, 3Fh
                add     r15, rax
                mov     rax, 2000000000000h
                test    rax, rsi
                jnz     loc_14027C079
                cmp     cs:byte_140C51EDE, 0
                jz      short loc_14027BF78
                mov     rax, cs:qword_140C52408
                mov     rcx, r15
                shr     rcx, 9
                bt      [rax], rcx
                jb      loc_14027C079

loc_14027BF78:                          ; CODE XREF: sub_14027BEE0+7E↑j
                test    rbp, rbp
                jz      loc_14027C079
                movzx   r8d, byte ptr [r14+23h]
                test    r8b, 10h
                jnz     loc_14027C079
                test    r8b, 40h
                jnz     loc_14027C079
                mov     rdx, cs:qword_140C4E4C8
                mov     rcx, [rbp+28h]
                shr     rcx, 27h
                shr     rsi, 27h
                and     ecx, 3FFh
                and     esi, 3FFh
                mov     rcx, [rdx+rcx*8]
                mov     rsi, [rdx+rsi*8]
                cmp     rcx, rsi
                jnz     loc_14027C079
                mov     ecx, r8d
                and     ecx, 7
                cmp     ecx, 5
                jnb     loc_14027C079
                mov     rcx, r10
                xor     r13d, r13d
                lea     rbx, [rsi+0A68h]
                mov     qword ptr [rsp+78h+var_58+8], rbx
                mov     rdx, rbp
                sub     rdx, rcx
                mov     qword ptr [rsp+78h+var_58], r13
                mov     rcx, gs:20h
                mov     rax, r9
                imul    rdx
                mov     r8, [rcx+84B8h]
                mov     r12, rdx
                sar     r12, 3
                mov     rax, r12
                shr     rax, 3Fh
                add     r12, rax
                test    r8, r8
                jz      short loc_14027C03A
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14027C03A
                mov     eax, [r8+18h]
                add     eax, 1
                mov     [r8+18h], eax
                jnz     short loc_14027C03A
                call    sub_1403F2EC4

loc_14027C03A:                          ; CODE XREF: sub_14027BEE0+140↑j
                                        ; sub_14027BEE0+146↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_14027C052
                mov     rdx, rbx
                lea     rcx, [rsp+78h+var_58]
                call    sub_14051652C
                jmp     short loc_14027C069
; ---------------------------------------------------------------------------

loc_14027C052:                          ; CODE XREF: sub_14027BEE0+161↑j
                lea     rdx, [rsp+78h+var_58]
                xchg    rdx, [rbx]
                test    rdx, rdx
                jz      short loc_14027C069
                lea     rcx, [rsp+78h+var_58]
                call    sub_14025FC20

loc_14027C069:                          ; CODE XREF: sub_14027BEE0+170↑j
                                        ; sub_14027BEE0+17D↑j
                test    byte ptr [rbp+23h], 8
                jnz     short loc_14027C09F
                lea     rcx, [rsp+78h+var_58]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel

loc_14027C079:                          ; CODE XREF: sub_14027BEE0+71↑j
                                        ; sub_14027BEE0+92↑j ...
                mov     rdx, r15
                mov     rcx, r14
                call    sub_140278860

loc_14027C084:                          ; CODE XREF: sub_14027BEE0+3EF↓j
                                        ; sub_14027BEE0+3F9↓j ...
                lea     r11, [rsp+78h+var_28]
                mov     rbx, [r11+38h]
                mov     rbp, [r11+40h]
                mov     rsp, r11
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027C09F:                          ; CODE XREF: sub_14027BEE0+18D↑j
                movzx   eax, byte ptr [r14+23h]
                mov     rcx, r14
                or      al, 8

loc_14027C0A9:                          ; DATA XREF: .rdata:000000014005E150↑o
                                        ; .rdata:000000014005E160↑o ...
                mov     [rsp+78h+arg_0], rdi
                mov     [r14+23h], al
                call    sub_1403F41D8
                test    eax, eax
                mov     ecx, 1100h
                mov     edx, 13C0h
                cmovz   ecx, edx
                lock inc qword ptr [rcx+rsi]
                xorps   xmm0, xmm0
                xor     eax, eax
                movups  [rsp+78h+var_40], xmm0
                mov     [rsp+78h+var_30], rax
                mov     edi, 1
                lock xadd [rsi+1BC0h], rdi
                inc     rdi
                cmp     rdi, 420h
                ja      short loc_14027C159
                cmp     rdi, 0A0h
                jnz     short loc_14027C105
                lea     eax, [rdx-58h]
                jmp     short loc_14027C120
; ---------------------------------------------------------------------------

loc_14027C105:                          ; CODE XREF: sub_14027BEE0+21E↑j
                cmp     rdi, 420h
                jnz     short loc_14027C115
                mov     eax, 1388h
                jmp     short loc_14027C120
; ---------------------------------------------------------------------------

loc_14027C115:                          ; CODE XREF: sub_14027BEE0+22C↑j
                cmp     rdi, 22h ; '"'
                jnz     short loc_14027C159
                mov     eax, 1348h

loc_14027C120:                          ; CODE XREF: sub_14027BEE0+223↑j
                                        ; sub_14027BEE0+233↑j
                lea     rdx, [rsi+1340h]
                mov     qword ptr [rsp+78h+var_40], r13
                lea     rcx, [rsp+78h+var_40]
                mov     qword ptr [rsp+78h+var_40+8], rdx
                lea     rbx, [rsi+rax]
                call    sub_14024B3F0
                xor     r8d, r8d
                xor     edx, edx
                mov     rcx, rbx
                call    KeSetEvent
                inc     dword ptr [rbx+18h]
                lea     rcx, [rsp+78h+var_40]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel

loc_14027C159:                          ; CODE XREF: sub_14027BEE0+215↑j
                                        ; sub_14027BEE0+239↑j
                dec     rdi
                cmp     rdi, [rsi+1430h]
                jz      short loc_14027C16E
                cmp     rdi, [rsi+1438h]
                jnz     short loc_14027C176

loc_14027C16E:                          ; CODE XREF: sub_14027BEE0+283↑j
                mov     rcx, rsi
                call    sub_1403B69C4

loc_14027C176:                          ; CODE XREF: sub_14027BEE0+28C↑j
                lock or [rsp+78h+var_78], r13d
                mov     ecx, cs:dword_140D23080
                mov     rax, 0F00000000000000h
                mov     rdi, [rsp+78h+arg_0]
                shl     rcx, 38h
                xor     rcx, [r14+18h]
                and     rcx, rax
                movzx   eax, byte ptr [r14+22h]
                xor     [r14+18h], rcx
                and     al, 0FAh
                or      al, 2
                mov     [r14+22h], al
                mov     rax, cs:qword_140C4DDC0
                mov     rcx, [rbp+10h]
                test    rax, rax
                jz      short loc_14027C1CA

loc_14027C1BF:                          ; DATA XREF: .pdata:00000001400CE838↑o
                                        ; .pdata:00000001400CE844↑o
                test    cl, 10h
                jnz     short loc_14027C1CA
                not     rax
                and     rcx, rax

loc_14027C1CA:                          ; CODE XREF: sub_14027BEE0+2DD↑j
                                        ; sub_14027BEE0+2E2↑j
                mov     rdx, [rbp+28h]
                mov     r9, 0FFFFFFFFFh
                mov     rax, [r14]
                and     rdx, r9
                xor     rax, r12
                shr     rcx, 0Ch
                and     rax, r9
                mov     r10, 0FFFFFFF000000000h
                xor     [r14], rax
                mov     r8, r15
                mov     rax, [r14+18h]
                and     rcx, r9
                and     rax, r10
                and     r8, r9
                or      rax, rdx
                mov     [r14+18h], rax
                cmp     rcx, r12
                jnz     short loc_14027C224
                mov     edx, 4
                mov     rcx, r15
                call    sub_1402810E0
                mov     [rbp+10h], rax
                jmp     short loc_14027C248
; ---------------------------------------------------------------------------

loc_14027C224:                          ; CODE XREF: sub_14027BEE0+32F↑j
                lea     rcx, [rdx+rdx*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                add     rcx, rax
                mov     rax, [rcx]
                and     rax, r10
                or      rax, r8
                mov     [rcx], rax

loc_14027C248:                          ; CODE XREF: sub_14027BEE0+342↑j
                mov     rax, [rbp+28h]
                mov     rcx, r14
                and     rax, r10
                or      rax, r8
                mov     [rbp+28h], rax
                call    sub_14027C300
                inc     qword ptr [rsi+0A48h]
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_14027C27F
                mov     rdx, [rsp+78h]
                lea     rcx, [rsp+78h+var_58]
                call    sub_1405165EC
                jmp     short loc_14027C2BC
; ---------------------------------------------------------------------------

loc_14027C27F:                          ; CODE XREF: sub_14027BEE0+38C↑j
                prefetchw byte ptr [rsp+78h+var_58]
                mov     rax, qword ptr [rsp+78h+var_58]
                test    rax, rax
                jnz     short loc_14027C2B1
                mov     rcx, qword ptr [rsp+78h+var_58+8]
                lea     rax, [rsp+78h+var_58]
                lock cmpxchg [rcx], r13
                lea     rcx, [rsp+78h+var_58]
                cmp     rax, rcx
                jz      short loc_14027C2BC
                lea     rcx, [rsp+78h+var_58]
                call    sub_140313680

loc_14027C2B1:                          ; CODE XREF: sub_14027BEE0+3AC↑j
                mov     qword ptr [rsp+78h+var_58], r13
                lock xor qword ptr [rax+8], 1

loc_14027C2BC:                          ; CODE XREF: sub_14027BEE0+39D↑j
                                        ; sub_14027BEE0+3C5↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      loc_14027C084
                cmp     byte ptr [rcx+20h], 1
                ja      loc_14027C084
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     loc_14027C084
                call    sub_1403F2EC4
                jmp     loc_14027C084
sub_14027BEE0   endp

; ---------------------------------------------------------------------------
algn_14027C2F8:                         ; DATA XREF: .pdata:00000001400CE844↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027C300   proc near               ; CODE XREF: sub_14027BEE0+379↑p
                                        ; sub_1402E3A38+17B4B3↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140442AD4 SIZE 0000001A BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r14
                push    r15
                sub     rsp, 20h
                mov     rdi, rcx
                mov     r15, 0FFFFFA8000000000h
                mov     rax, r15
                mov     rdx, rcx
                mov     rcx, [rcx+28h]
                sub     rdx, rax
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rdx
                mov     rsi, rdx
                sar     rsi, 3
                mov     rax, rsi
                shr     rax, 3Fh
                add     rsi, rax
                mov     rax, cs:qword_140C4E4C8
                mov     rbp, [rax+rcx*8]
                movzx   eax, byte ptr [rdi+23h]
                test    al, 8
                jz      loc_140442AD4
                mov     r14d, 5

loc_14027C377:                          ; CODE XREF: sub_14027C300+1C67DB↓j
                mov     rcx, rsi
                call    sub_14027DEC0
                cmp     cs:qword_140C4DD50, 0
                mov     ebx, [rax+8]
                jnz     loc_140442AE0
                xor     eax, eax

loc_14027C392:                          ; CODE XREF: sub_14027C300+1C67E9↓j
                mov     eax, eax
                mov     r10, 0FFFFFFFFFh
                lea     rcx, [r14+rax*8]
                lea     rdx, [rcx+rcx*2]
                imul    rcx, rbx, 11C0h
                lea     r9, [rcx+rdx*8]
                add     r9, [rbp+10h]
                inc     qword ptr [r9+0CB8h]
                mov     rax, [r9+0CC8h]
                cmp     rax, r10
                jz      short loc_14027C443
                lea     r8, [rax+rax*2]
                shl     r8, 4
                mov     rcx, r15
                add     r8, rcx
                mov     rdx, rsi
                shl     rdx, 1Ch
                mov     rcx, rsi
                shl     rcx, 1Ch
                xor     rdx, [r8]
                and     rdx, r10
                mov     [r8+27h], sil
                xor     rdx, rcx
                mov     [r8], rdx

loc_14027C3F4:                          ; CODE XREF: sub_14027C300+14A↓j
                mov     rbx, [rsp+38h+arg_0]
                mov     rcx, 0FFFFFFF000000000h
                or      [rdi], rcx
                mov     rcx, 0FFFFF000000000h
                mov     rbp, [rsp+38h+arg_8]
                mov     [rdi+24h], ax
                shl     rax, 14h
                xor     rax, [rdi+18h]
                and     rax, rcx
                mov     byte ptr [rdi+27h], 0FFh
                xor     [rdi+18h], rax
                mov     [r9+0CC8h], rsi
                mov     rsi, [rsp+38h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027C443:                          ; CODE XREF: sub_14027C300+C6↑j
                mov     [r9+0CC0h], rsi
                jmp     short loc_14027C3F4
sub_14027C300   endp

; ---------------------------------------------------------------------------
algn_14027C44C:                         ; DATA XREF: .rdata:000000014005E18C↑o
                                        ; .pdata:00000001400CE850↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027C460   proc near               ; CODE XREF: sub_140320C3C+F6↓p
                                        ; DATA XREF: .pdata:00000001400CE85C↑o

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 20h
                mov     eax, edx
                lea     r13, qword_14001A848
                lea     r14, [rcx+rcx*2]
                mov     r12d, r8d
                mov     rsi, rcx
                shl     r14, 4
                xor     ebp, ebp
                mov     r13, [r13+rax*8+0]
                mov     rax, 0FFFFFA8000000000h
                add     r14, rax
                mov     rcx, r14
                mov     rbx, r14
                call    sub_14054FB04
                mov     rcx, [r14]
                mov     rdx, 0FFFFFFFFFh
                xor     rcx, r13
                and     rcx, rdx
                movzx   edx, al
                xor     [r14], rcx
                mov     rcx, r14
                call    sub_1403423EC
                lea     r15, [rsi+r13]
                cmp     rsi, r15
                jnb     loc_14027C5F7
                mov     rdi, 4000000000000000h
                nop     word ptr [rax+rax+00h]

loc_14027C4F0:                          ; CODE XREF: sub_14027C460+143↓j
                cmp     word ptr [rbx+20h], 2
                jz      short loc_14027C526
                mov     rcx, rbx
                call    sub_14054FB04
                cmp     word ptr [rbx+20h], 2
                movzx   edx, al
                mov     rcx, rbx
                jz      short loc_14027C521
                or      [rbx+18h], rdi
                call    sub_1403423EC
                test    r12b, 4
                jnz     loc_14027C617
                jmp     short loc_14027C599
; ---------------------------------------------------------------------------

loc_14027C521:                          ; CODE XREF: sub_14027C460+AA↑j
                call    sub_1403423EC

loc_14027C526:                          ; CODE XREF: sub_14027C460+95↑j
                mov     rcx, [rbx+28h]
                mov     rax, rcx
                shr     rax, 3Ch
                and     al, 7
                cmp     al, 3
                jnz     short loc_14027C569
                mov     rcx, rbx
                call    sub_14054FB04
                mov     edx, 0Ch
                mov     rcx, rbx
                movzx   edi, al
                call    sub_1402D69E8
                movzx   edx, dil
                mov     rcx, rbx
                call    sub_1403423EC
                mov     rcx, [rbx+28h]
                mov     rdi, 4000000000000000h

loc_14027C569:                          ; CODE XREF: sub_14027C460+D5↑j
                shr     rcx, 3Ch
                and     cl, 7
                cmp     cl, 1
                jnz     short loc_14027C596
                mov     rcx, rbx
                call    sub_14054FB04
                mov     rcx, 8FFFFFFFFFFFFFFFh
                movzx   edx, al
                and     [rbx+28h], rcx
                mov     rcx, rbx
                call    sub_1403423EC

loc_14027C596:                          ; CODE XREF: sub_14027C460+113↑j
                inc     rbp

loc_14027C599:                          ; CODE XREF: sub_14027C460+BF↑j
                add     rbx, 30h ; '0'
                inc     rsi
                cmp     rsi, r15
                jb      loc_14027C4F0
                test    rbp, rbp
                jz      short loc_14027C5F7
                cmp     rbp, r13
                jz      short loc_14027C5F0
                mov     rcx, r14
                call    sub_14054FB04
                mov     r8, [r14]
                mov     rcx, 0FFFFFFFFFh
                mov     rbx, r8
                mov     rdx, r8
                and     rbx, rcx
                sub     rbx, rbp
                xor     rdx, rbx
                and     rdx, rcx
                mov     rcx, r14
                xor     rdx, r8
                mov     [r14], rdx
                movzx   edx, al
                call    sub_1403423EC
                test    rbx, rbx
                jnz     short loc_14027C5F7

loc_14027C5F0:                          ; CODE XREF: sub_14027C460+151↑j
                mov     eax, 1
                jmp     short loc_14027C5F9
; ---------------------------------------------------------------------------

loc_14027C5F7:                          ; CODE XREF: sub_14027C460+7A↑j
                                        ; sub_14027C460+14C↑j ...
                xor     eax, eax

loc_14027C5F9:                          ; CODE XREF: sub_14027C460+195↑j
                mov     rbx, [rsp+48h+arg_0]
                mov     rbp, [rsp+48h+arg_8]
                mov     rsi, [rsp+48h+arg_10]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027C617:                          ; CODE XREF: sub_14027C460+B9↑j
                mov     rcx, rbx
                call    sub_1403F41EC
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027C460   endp

byte_14027C620  db 10h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE85C↑o

; =============== S U B R O U T I N E =======================================


sub_14027C630   proc near               ; CODE XREF: sub_14026C660+36D↑p
                                        ; sub_140320C3C+88↓p ...
                xor     dl, [rcx+22h]
                and     dl, 7
                xor     dl, [rcx+22h]
                mov     [rcx+22h], dl
                retn
sub_14027C630   endp

; ---------------------------------------------------------------------------
                align 2
byte_14027C63E  db 12h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE868↑o

; =============== S U B R O U T I N E =======================================


sub_14027C650   proc near               ; DATA XREF: .rdata:0000000140008D98↑o
                                        ; .pdata:00000001400CE874↑o ...
                movzx   eax, byte ptr [rcx]
                retn
sub_14027C650   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14027C655:                         ; DATA XREF: .pdata:00000001400CE874↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027C660   proc near               ; CODE XREF: sub_14026C660+C8↑p
                                        ; sub_14026C660+38E↑p ...
                sub     rsp, 28h
                mov     rax, [rcx]
                mov     rdx, rcx
                test    rax, rax
                jnz     short loc_14027C682
                mov     ecx, 80h
                call    sub_14027C6C0
                mov     [rdx], rax

loc_14027C67C:                          ; CODE XREF: sub_14027C660+30↓j
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027C682:                          ; CODE XREF: sub_14027C660+D↑j
                and     rax, 0FFFFFFFFFFFFFC9Fh
                bts     rax, 7
                mov     [rcx], rax
                jmp     short loc_14027C67C
sub_14027C660   endp

; ---------------------------------------------------------------------------
algn_14027C692:                         ; DATA XREF: .pdata:00000001400CE880↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027C6A0   proc near               ; CODE XREF: sub_14053DBE4+12A↓p
                                        ; sub_1406A1D1C+A9↓p ...
                sub     rsp, 28h
                and     ecx, 1Fh
                shl     rcx, 5
                call    sub_14027C6C0
                add     rsp, 28h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027C6A0   endp

algn_14027C6B6:                         ; DATA XREF: .pdata:00000001400CE88C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027C6C0   proc near               ; CODE XREF: sub_140209860+B4↑p
                                        ; sub_14020ACA0+73↑p ...
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14027C6DA
                test    rcx, rax
                jnz     short loc_14027C6D6
                or      rax, rcx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027C6D6:                          ; CODE XREF: sub_14027C6C0+F↑j
                or      rcx, 10h

loc_14027C6DA:                          ; CODE XREF: sub_14027C6C0+A↑j
                mov     rax, rcx
                retn
sub_14027C6C0   endp

; ---------------------------------------------------------------------------
                db 0CCh
byte_14027C6DF  db 11h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE898↑o
; Exported entry 1149. KeExpandKernelStackAndCalloutEx

; =============== S U B R O U T I N E =======================================


                public KeExpandKernelStackAndCalloutEx
KeExpandKernelStackAndCalloutEx proc near
                                        ; CODE XREF: sub_1406F6148+3F↓p
                                        ; sub_14089C0A8+C8↓p ...

var_18          = qword ptr -18h
arg_20          = qword ptr  28h

                sub     rsp, 38h
                mov     rax, [rsp+38h+arg_20]
                neg     r9b
                mov     [rsp+38h+var_18], rax
                sbb     r9d, r9d
                and     r9d, 2
                call    ntoskrnl_7
                add     rsp, 38h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
KeExpandKernelStackAndCalloutEx endp

algn_14027C713:                         ; DATA XREF: .pdata:00000001400CE8A4↑o
                align 20h
; Exported entry   7.

; =============== S U B R O U T I N E =======================================


                public ntoskrnl_7
ntoskrnl_7      proc near               ; CODE XREF: KeExpandKernelStackAndCalloutEx+18↑p
                                        ; sub_1402E5B14+5AF↓p ...

var_48          = qword ptr -48h
var_38          = byte ptr -38h
var_37          = byte ptr -37h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_20          = qword ptr  28h

; FUNCTION CHUNK AT 00000001404189D0 SIZE 00000040 BYTES
; FUNCTION CHUNK AT 0000000140442AEE SIZE 00000034 BYTES

; __unwind { // __C_specific_handler
                mov     [rsp+arg_10], rbx
                mov     [rsp+arg_8], rdx
                mov     [rsp+arg_0], rcx
                push    rsi
                push    rdi
                push    r12
                push    r14
                push    r15
                sub     rsp, 40h
                mov     rsi, rdx
                mov     r14, rcx
                mov     rax, [rsp+68h+arg_20]
                mov     [rsp+68h+var_48], rax
                call    sub_14027C800
                cmp     eax, 0C000048Bh
                jnz     short loc_14027C7D3
                mov     r12, cr8
                movzx   r15d, r12b
                mov     [rsp+68h+var_37], r12b
                mov     rbx, gs:188h
                mov     [rsp+68h+var_30], rbx
                mov     eax, [rbx+74h]
                bt      eax, 0Ch
                jb      short loc_14027C7E9
                bts     eax, 0Ch
                mov     [rbx+74h], eax
                xor     dil, dil

loc_14027C788:                          ; CODE XREF: ntoskrnl_7+CC↓j
                mov     [rsp+68h+var_38], dil

loc_14027C78D:                          ; DATA XREF: .rdata:000000014005E35C↑o
                                        ; .rdata:000000014005E36C↑o
;   __try { // __finally(loc_1404189EE)
;     __try { // __except at loc_14027C79A
                mov     rcx, rsi
                mov     rax, r14
                call    sub_1404079D0
                jmp     short loc_14027C7B8
;     } // starts at 14027C78D
; ---------------------------------------------------------------------------

loc_14027C79A:                          ; DATA XREF: .rdata:000000014005E35C↑o
;   __except(loc_1404189D0) // owned by 14027C78D
                mov     rsi, [rsp+68h+arg_8]
                mov     r14, [rsp+68h+arg_0]
                movzx   r15d, [rsp+68h+var_37]
                movzx   edi, [rsp+68h+var_38]
                mov     rbx, [rsp+68h+var_30]
                movzx   r12d, r15b
;   } // starts at 14027C78D

loc_14027C7B8:                          ; CODE XREF: ntoskrnl_7+78↑j
                                        ; DATA XREF: .rdata:000000014005E36C↑o
                test    dil, dil
                jnz     short loc_14027C7C4
                and     dword ptr [rbx+74h], 0FFFFEFFFh

loc_14027C7C4:                          ; CODE XREF: ntoskrnl_7+9B↑j
                mov     rax, cr8
                cmp     al, r15b
                jnz     loc_140442AEE
                xor     eax, eax

loc_14027C7D3:                          ; CODE XREF: ntoskrnl_7+38↑j
                mov     rbx, [rsp+68h+arg_10]
                add     rsp, 40h
                pop     r15
                pop     r14
                pop     r12
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027C7E9:                          ; CODE XREF: ntoskrnl_7+5C↑j
                mov     dil, 1
                jmp     short loc_14027C788
; } // starts at 14027C720
ntoskrnl_7      endp ; sp-analysis failed

; ---------------------------------------------------------------------------
algn_14027C7EE:                         ; DATA XREF: .rdata:000000014005E380↑o
                                        ; .pdata:00000001400CE8B0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027C800   proc near               ; CODE XREF: ntoskrnl_7+2E↑p
                                        ; DATA XREF: .rdata:000000014005E3C4↑o ...

var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = byte ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h
arg_20          = qword ptr  28h

; FUNCTION CHUNK AT 0000000140442B22 SIZE 00000053 BYTES

                mov     rax, rsp
                push    rbx
                push    rsi
                push    r13
                push    r14
                push    r15
                sub     rsp, 40h
                xor     r13d, r13d
                mov     esi, r9d
                mov     [rax-38h], r13
                mov     rbx, r8
                mov     [rax-30h], r13
                mov     r14, rdx
                mov     [rax+18h], r13d
                mov     r15, rcx
                cmp     r8, 11800h
                ja      loc_140442B22

loc_14027C837:                          ; DATA XREF: .rdata:000000014005E3C4↑o
                                        ; .rdata:000000014005E3D8↑o ...
                mov     [rax+8], rbp
                mov     [rax+10h], rdi
                mov     rdi, gs:188h
                mov     [rax+20h], r12
                call    sub_1403FDE10
                mov     r12, [rdi+30h]
                mov     rbp, rax
                mov     rcx, [rdi+28h]
                mov     rdi, [rcx+8]
                and     rdi, 0FFFFFFFFFFFFFFFEh
                mov     rcx, cr8
                cmp     cl, 2
                jz      loc_14027C8F9
                ja      loc_140442B2C
                mov     ecx, cs:dword_140CFB038
                cmp     rbx, rcx
                jz      short loc_14027C8F4
                cmp     rbx, 6000h
                jz      loc_140442B4C

loc_14027C88F:                          ; CODE XREF: sub_14027C800+F7↓j
                                        ; sub_14027C800+13A↓j ...
                mov     rax, rbp
                sub     rax, rdi
                cmp     rax, rbx
                jb      short loc_14027C8D4
                test    sil, 1
                jnz     short loc_14027C8D4
                mov     rax, rbp
                sub     rax, r12
                cmp     rax, rbx
                jb      loc_140442B5D

loc_14027C8AF:                          ; CODE XREF: sub_14027C800+1C6370↓j
                mov     eax, 0C000048Bh

loc_14027C8B4:                          ; CODE XREF: sub_14027C800+F2↓j
                                        ; sub_14027C800+14F↓j
                mov     rdi, [rsp+68h+arg_8]
                mov     rbp, [rsp+68h+arg_0]
                mov     r12, [rsp+68h+arg_18]

loc_14027C8C6:                          ; CODE XREF: sub_14027C800+1C6327↓j
                                        ; DATA XREF: .pdata:00000001400CE8C8↑o ...
                add     rsp, 40h
                pop     r15
                pop     r14
                pop     r13
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14027C8D4:                          ; CODE XREF: sub_14027C800+98↑j
                                        ; sub_14027C800+9E↑j ...
                mov     rax, [rsp+68h+arg_20]
                mov     r9d, esi
                mov     r8, rbx
                mov     [rsp+68h+var_48], rax
                mov     rdx, r14
                mov     rcx, r15
                call    sub_14027C960
                jmp     short loc_14027C8B4
; ---------------------------------------------------------------------------

loc_14027C8F4:                          ; CODE XREF: sub_14027C800+80↑j
                                        ; sub_14027C800+1C6358↓j
                or      esi, 5
                jmp     short loc_14027C88F
; ---------------------------------------------------------------------------

loc_14027C8F9:                          ; CODE XREF: sub_14027C800+6B↑j
                test    sil, 2
                jnz     short loc_14027C94A
                call    sub_1403FDE10
                mov     rcx, rax
                lea     r9, [rsp+68h+var_30]
                lea     r8, [rsp+68h+var_38]
                lea     rdx, [rsp+68h+arg_10]
                call    sub_14024AF20
                test    al, al
                jz      loc_140442B45
                mov     eax, [rsp+68h+arg_10]
                cmp     eax, 1
                jnz     short loc_14027C93F

loc_14027C932:                          ; CODE XREF: sub_14027C800+148↓j
                mov     r12, [rsp+68h+var_38]
                mov     rdi, r12
                jmp     loc_14027C88F
; ---------------------------------------------------------------------------

loc_14027C93F:                          ; CODE XREF: sub_14027C800+130↑j
                cmp     eax, 0Ah
                jnz     loc_14027C88F
                jmp     short loc_14027C932
; ---------------------------------------------------------------------------

loc_14027C94A:                          ; CODE XREF: sub_14027C800+FD↑j
                mov     eax, 0C00000F2h
                jmp     loc_14027C8B4
sub_14027C800   endp

; ---------------------------------------------------------------------------
algn_14027C954:                         ; DATA XREF: .pdata:00000001400CE8E0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027C960   proc near               ; CODE XREF: sub_14027C800+ED↑p
                                        ; DATA XREF: .rdata:000000014005E44C↑o ...

var_78          = qword ptr -78h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = dword ptr  20h
arg_20          = qword ptr  28h

; FUNCTION CHUNK AT 0000000140442B76 SIZE 000000EE BYTES

                mov     [rsp+arg_8], rdx
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 58h
                xor     ecx, ecx
                mov     ebx, r9d
                mov     [rsp+98h+var_60], rcx
                mov     r14, r8
                mov     rdi, gs:188h
                xor     bpl, bpl
                mov     r15d, ecx
                mov     [rsp+98h+var_68], rcx
                mov     r13, cr8
                mov     rsi, [rsp+98h+arg_20]
                cmp     r13b, 2
                jz      loc_14027CB65

loc_14027C9B1:                          ; CODE XREF: sub_14027C960+212↓j
                                        ; sub_14027C960+21B↓j
                test    bl, 8
                jnz     loc_140442B76

loc_14027C9BA:                          ; CODE XREF: sub_14027C960+1C6225↓j
                mov     eax, cs:dword_140CFB038
                mov     r12d, ecx
                cmp     r8, rax
                ja      loc_14027CC41
                or      ebx, 4
                mov     r14, rcx

loc_14027C9D2:                          ; CODE XREF: sub_14027C960+2F1↓j
                                        ; sub_14027C960+1C622D↓j ...
                mov     [rsp+98h+arg_18], r15d
                test    bpl, 0F0h
                jnz     loc_14027CB88
                mov     ecx, r12d
                mov     eax, ebx
                or      ecx, 2
                mov     r8, rdi
                and     al, 2
                mov     eax, [rdi+24Ch]
                cmovnz  ecx, r12d
                mov     r12d, ecx
                or      r12d, 10h
                and     ebx, 4
                cmovz   r12d, ecx
                lea     rcx, qword_140CFDCC0
                mov     rax, [rcx+rax*8]
                mov     rcx, [rax+0C0h]
                movzx   edx, byte ptr [rcx+92h]
                mov     ecx, r12d
                call    sub_14027CC90
                or      r15d, 4
                mov     rsi, rax
                test    ebx, ebx
                cmovz   r15d, [rsp+98h+arg_18]
                test    rax, rax
                jz      loc_14027CB80

loc_14027CA45:                          ; CODE XREF: sub_14027C960+299↓j
                                        ; sub_14027C960+2A3↓j ...
                mov     [rsi-30h], rsi
                lea     rbx, [rsi-30h]
                test    bpl, 1
                jnz     loc_14027CC6F
                mov     ecx, cs:dword_140CFB038
                mov     rax, rsi
                sub     rax, rcx
                inc     rax

loc_14027CA66:                          ; CODE XREF: sub_14027C960+316↓j
                mov     [rbx+8], rax
                mov     rax, [rdi+38h]
                mov     [rbx+10h], rax
                mov     rax, [rdi+28h]
                mov     [rbx+28h], rax
                test    r12b, 1
                jnz     loc_14027CC5C

loc_14027CA84:                          ; CODE XREF: sub_14027C960+304↓j
                                        ; sub_14027C960+1C62A4↓j
                mov     eax, [rdi+74h]
                bt      eax, 0Ch
                jnb     loc_14027CB48
                or      bpl, 2
                mov     byte ptr [rsp+98h+arg_18], 2

loc_14027CA9D:                          ; CODE XREF: sub_14027C960+1F7↓j
                xor     r12d, r12d
                mov     [rsp+98h+var_50], r12
                mov     [rsp+98h+var_58], r12
                mov     [rsp+98h+arg_10], r12d
                call    sub_1403FDE10
                mov     rcx, rax
                lea     r9, [rsp+98h+var_58]
                lea     r8, [rsp+98h+var_50]
                lea     rdx, [rsp+98h+arg_10]
                call    sub_14024AF20
                cmp     [rsp+98h+arg_10], 0Ah
                jz      loc_140442C09

loc_14027CADF:                          ; CODE XREF: sub_14027C960+1C62B8↓j
                mov     rdx, [rsp+98h+arg_0]
                mov     r9, r14
                mov     r14, [rsp+98h+arg_8]
                mov     r8, rbx
                mov     rcx, r14
                call    sub_140401CE0
                mov     ebx, eax
                test    r12d, r12d
                jnz     loc_140442C1D

loc_14027CB08:                          ; CODE XREF: sub_14027C960+1C62C6↓j
                test    bpl, 8
                jnz     loc_14027CC0E
                mov     edx, r15d
                mov     rcx, rsi
                call    sub_14027D2A0

loc_14027CB1D:                          ; CODE XREF: sub_14027C960+2DC↓j
                cmp     byte ptr [rsp+98h+arg_18], 0
                jz      short loc_14027CB5C

loc_14027CB27:                          ; CODE XREF: sub_14027C960+203↓j
                mov     rax, cr8
                cmp     al, r13b
                jnz     loc_140442C2B
                mov     eax, ebx

loc_14027CB36:                          ; CODE XREF: sub_14027C960+320↓j
                                        ; sub_14027C960+1C626D↓j
                add     rsp, 58h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 8

loc_14027CB48:                          ; CODE XREF: sub_14027C960+12B↑j
                bts     eax, 0Ch
                mov     byte ptr [rsp+98h+arg_18], 0
                mov     [rdi+74h], eax
                jmp     loc_14027CA9D
; ---------------------------------------------------------------------------

loc_14027CB5C:                          ; CODE XREF: sub_14027C960+1C5↑j
                and     dword ptr [rdi+74h], 0FFFFEFFFh
                jmp     short loc_14027CB27
; ---------------------------------------------------------------------------

loc_14027CB65:                          ; CODE XREF: sub_14027C960+4B↑j
                lea     rax, [rsp+98h+var_60]
                mov     [rsp+98h+var_68], rax
                test    rsi, rsi
                jz      loc_14027C9B1
                mov     bpl, 10h
                jmp     loc_14027C9B1
; ---------------------------------------------------------------------------

loc_14027CB80:                          ; CODE XREF: sub_14027C960+DF↑j
                mov     rsi, [rsp+98h+arg_20]

loc_14027CB88:                          ; CODE XREF: sub_14027C960+7E↑j
                test    rsi, rsi
                jz      loc_14027CC7B
                test    bpl, 1
                jnz     loc_140442B9E

loc_14027CB9B:                          ; CODE XREF: sub_14027C960+1C6248↓j
                bts     dword ptr [rdi+74h], 0Fh
                jb      loc_140442BAD

loc_14027CBA6:                          ; CODE XREF: sub_14027C960+1C6251↓j
                mov     rax, [rsp+98h+var_68]
                lea     rcx, [rsi+8]
                xor     r9d, r9d
                mov     [rsp+98h+var_78], rax
                xor     r8d, r8d
                lea     edx, [r9+19h]
                call    KeWaitForSingleObject
                cmp     eax, 102h
                jz      loc_140442BB6
                movzx   r8d, byte ptr [rsi+6]
                cmp     r8b, [rsi+5]
                jnb     loc_140442BD2
                mov     rsi, [rsi+r8*8+40h]
                or      bpl, 8
                mov     rax, [rsp+98h+arg_20]
                inc     r8b
                mov     [rax+6], r8b
                test    bpl, 1
                jnz     loc_14027CA45
                cmp     byte ptr [rax+4], 0
                jz      loc_14027CA45
                jmp     loc_140442BEB
; ---------------------------------------------------------------------------

loc_14027CC0E:                          ; CODE XREF: sub_14027C960+1AC↑j
                mov     rax, [rsp+98h+arg_20]
                add     byte ptr [rax+6], 0FFh
                jnz     short loc_14027CC29
                test    bpl, 4
                jnz     short loc_14027CC29
                and     dword ptr [rdi+74h], 0FFFF7FFFh

loc_14027CC29:                          ; CODE XREF: sub_14027C960+2BA↑j
                                        ; sub_14027C960+2C0↑j
                xor     r9d, r9d
                lea     rcx, [rax+8]
                xor     r8d, r8d
                lea     edx, [r9+1]
                call    KeReleaseMutant
                jmp     loc_14027CB1D
; ---------------------------------------------------------------------------

loc_14027CC41:                          ; CODE XREF: sub_14027C960+66↑j
                or      bpl, 1
                mov     r12d, 1
                mov     r15d, r12d
                test    rsi, rsi
                jz      loc_14027C9D2
                jmp     loc_140442B8A
; ---------------------------------------------------------------------------

loc_14027CC5C:                          ; CODE XREF: sub_14027C960+11E↑j
                or      rbx, 1
                test    r12b, 4
                jz      loc_14027CA84
                jmp     loc_140442C00
; ---------------------------------------------------------------------------

loc_14027CC6F:                          ; CODE XREF: sub_14027C960+F1↑j
                lea     rax, [rsi-11FFFh]
                jmp     loc_14027CA66
; ---------------------------------------------------------------------------

loc_14027CC7B:                          ; CODE XREF: sub_14027C960+22B↑j
                                        ; sub_14027C960+1C6242↓j ...
                mov     eax, 0C0000017h
                jmp     loc_14027CB36
sub_14027C960   endp

; ---------------------------------------------------------------------------
algn_14027CC85:                         ; DATA XREF: .rdata:000000014005E44C↑o
                                        ; .pdata:00000001400CE8EC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14027CC90   proc near               ; CODE XREF: sub_14027C960+C5↑p
                                        ; KeUserModeCallback+9F↓p ...

var_78          = qword ptr -78h
var_70          = dword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 0000000140442C64 SIZE 00000396 BYTES

                mov     [rsp+arg_0], ecx
                push    rsi
                push    rdi
                push    r12
                push    r13
                sub     rsp, 78h
                mov     r9d, ecx
                mov     esi, edx
                mov     [rsp+98h+var_50], 0
                lea     r10, unk_140C50C00
                mov     r12d, ecx
                mov     rdi, r10
                and     r9d, 10h
                jnz     loc_14027D038
                test    r8, r8
                jz      loc_14027D26F
                mov     rax, [r8+220h]
                mov     r13, r8
                mov     [rsp+98h+var_48], r8
                movzx   ecx, word ptr [rax+72Eh]
                mov     rax, cs:qword_140C4E4C8
                mov     rdi, [rax+rcx*8]

loc_14027CCED:                          ; CODE XREF: sub_14027CC90+3B7↓j
                                        ; sub_14027CC90+3D6↓j ...
                mov     [rsp+98h+arg_8], rbx
                mov     [rsp+98h+var_28], rbp
                mov     [rsp+98h+var_30], r14
                mov     [rsp+98h+var_38], r15
                test    r12b, 1
                jnz     loc_14027D24B
                movzx   r8d, cs:byte_140C4EA3C
                mov     [rsp+98h+var_60], r8
                mov     [rsp+98h+var_58], r8
                test    r9d, r9d
                jnz     loc_14027D06B
                xor     r14d, r14d

loc_14027CD2C:                          ; CODE XREF: sub_14027CC90+3FA↓j
                                        ; sub_14027CC90+40A↓j ...
                cmp     rdi, r10
                jnz     loc_14027D15B
                mov     eax, 2
                mov     ebp, r14d
                imul    r12, rsi, 0B0h
                lea     rdx, [rax-3]

loc_14027CD48:                          ; CODE XREF: sub_14027CC90+5A6↓j
                mov     rbx, rbp
                shl     rbx, 5
                add     rbx, r12
                add     rbx, cs:qword_140C4DD20
                movzx   r15d, word ptr [rbx]
                test    r15w, r15w
                jz      loc_14027D141
                cmp     rbp, 1
                jz      loc_14027D23B
                mov     rcx, cr8
                mov     [rsp+98h+var_68], rcx
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140442C7C

loc_14027CD8C:                          ; CODE XREF: sub_14027CC90+5B0↓j
                                        ; sub_14027CC90+1C5FEE↓j ...
                mov     rcx, rbx
                call    ExpInterlockedPopEntrySList
                test    rax, rax
                jz      loc_14027D117
                cmp     r15w, 1
                jz      loc_14027D101

loc_14027CDA8:                          ; CODE XREF: sub_14027CC90+475↓j
                                        ; sub_14027CC90+482↓j
                mov     r9, [rax-10h]
                lea     rcx, [rax-0FF0h]
                mov     rax, cs:qword_140C4ED48
                xor     rax, rcx
                cmp     r9, rax
                jnz     loc_140442D22
                shr     rcx, 9
                mov     rsi, 7FFFFFFFF8h
                and     rsi, rcx
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                add     rsi, rax
                mov     rbp, rsi
                shl     rbp, 19h
                mov     rax, rdx
                shl     rax, 19h
                sub     rbp, rax
                add     rbp, 10000000h
                sar     rbp, 10h
                mov     [rsp+98h+var_48], rbp
                cmp     r14d, 1
                jz      loc_14027CF4F
                movzx   eax, cs:byte_140C4EA3C
                lea     rcx, [rsp+98h+var_50]
                shl     rax, 3
                mov     r14, rsi
                sub     r14, rax
                add     r14, 8
                call    sub_1402433C0
                mov     r15d, eax
                mov     r11, 0FFFFF6FB7DBED7F8h
                mov     r10, 0FFFFFFFFFh
                mov     r9, 0FFFFFA8000000000h
                mov     r8, 0FFFFFFFFFFEh
                mov     r12, 0FFFFF6FB7DBED000h
                mov     rbp, 7FFFFFFFFFFFFFFFh

loc_14027CE70:                          ; CODE XREF: sub_14027CC90+299↓j
                mov     rbx, [rsi]
                mov     rax, r12
                cmp     rsi, rax
                jnb     loc_14027D016

loc_14027CE7F:                          ; CODE XREF: sub_14027CC90+38C↓j
                                        ; sub_14027CC90+1C60B4↓j ...
                mov     [rsp+98h+var_50], rbx
                mov     rdx, rbx
                test    r15d, r15d
                jnz     loc_14027CF83

loc_14027CE90:                          ; CODE XREF: sub_14027CC90+2FD↓j
                                        ; sub_14027CC90+31A↓j ...
                shr     rdx, 0Ch
                and     rdx, r10
                lea     rdi, [rdx+rdx*2]
                shl     rdi, 4
                mov     rax, r9
                add     rdi, rax
                mov     [rsp+98h+arg_18], 0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      loc_140442DD3

loc_14027CEBD:                          ; CODE XREF: sub_14027CC90+1C618A↓j
                mov     rcx, [rsi]
                mov     rax, r12
                cmp     rsi, rax
                jnb     loc_14027D027

loc_14027CECC:                          ; CODE XREF: sub_14027CC90+39D↓j
                                        ; sub_14027CC90+1C6199↓j ...
                cmp     rbx, rcx
                jnz     short loc_14027CF21
                mov     rax, [rdi]
                mov     rcx, r13
                shr     rcx, 3
                xor     rcx, rax
                and     rcx, r8
                xor     rcx, rax
                mov     [rdi], rcx
                test    r13, r13
                jz      short loc_14027CEF5
                test    byte ptr [rdi], 1
                jz      loc_14027D280

loc_14027CEF5:                          ; CODE XREF: sub_14027CC90+25A↑j
                                        ; sub_14027CC90+5FD↓j
                sub     rsi, 8
                mov     r9, 0FFFFFA8000000000h
                mov     r8, 0FFFFFFFFFFEh
                mov     r11, 0FFFFF6FB7DBED7F8h
                mov     r10, 0FFFFFFFFFh

loc_14027CF21:                          ; CODE XREF: sub_14027CC90+23F↑j
                lock and [rdi+18h], rbp
                cmp     rsi, r14
                jnb     loc_14027CE70
                mov     eax, cs:dword_140CFC660
                mov     rbp, [rsp+98h+var_48]
                mov     r14, [rsp+98h+var_68]
                test    eax, eax
                jnz     loc_140442EBA

loc_14027CF47:                          ; CODE XREF: sub_14027CC90+1C622C↓j
                                        ; sub_14027CC90+1C6238↓j ...
                movzx   eax, r14b
                mov     cr8, rax

loc_14027CF4F:                          ; CODE XREF: sub_14027CC90+17C↑j
                                        ; sub_14027CC90+456↓j ...
                mov     eax, dword ptr cs:xmmword_140CFC480+4
                test    al, 1
                jnz     loc_140442FC8

loc_14027CF5D:                          ; CODE XREF: sub_14027CC90+1C6340↓j
                                        ; sub_14027CC90+1C6365↓j
                mov     rax, rbp

loc_14027CF60:                          ; CODE XREF: sub_14027CC90+1C6333↓j
                mov     r15, [rsp+98h+var_38]
                mov     r14, [rsp+98h+var_30]
                mov     rbp, [rsp+98h+var_28]
                mov     rbx, [rsp+98h+arg_8]
                add     rsp, 78h
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
byte_14027CF82  db 0CCh                 ; DATA XREF: .pdata:00000001400CE904↑o
                                        ; .pdata:00000001400CE910↑o
; ---------------------------------------------------------------------------

loc_14027CF83:                          ; CODE XREF: sub_14027CC90+1FA↑j
                                        ; DATA XREF: .pdata:00000001400CE910↑o ...
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_14027CE90
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      loc_14027CE90
                test    bl, 1
                jz      loc_14027CE90
                test    bl, 20h
                jnz     loc_14027D0EB

loc_14027CFC2:                          ; CODE XREF: sub_14027CC90+464↓j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      loc_14027D0F9
                lea     rax, [rsp+98h+var_50]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                test    al, 42h
                jz      loc_14027CE90
                or      rdx, 42h
                jmp     loc_14027CE90
; ---------------------------------------------------------------------------

loc_14027D016:                          ; CODE XREF: sub_14027CC90+1E9↑j
                mov     rax, r11
                cmp     rsi, rax
                ja      loc_14027CE7F
                jmp     loc_140442D3A
; ---------------------------------------------------------------------------

loc_14027D027:                          ; CODE XREF: sub_14027CC90+236↑j
                mov     rax, r11
                cmp     rsi, rax
                ja      loc_14027CECC
                jmp     loc_140442E1F
; ---------------------------------------------------------------------------

loc_14027D038:                          ; CODE XREF: sub_14027CC90+2D↑j
                                        ; DATA XREF: .pdata:00000001400CE91C↑o ...
                mov     r13, 0FFFFFFFFFFFFFFE0h
                mov     [rsp+98h+var_48], r13
                test    r8, r8
                jz      loc_14027CCED
                mov     rax, [r8+220h]
                movzx   ecx, word ptr [rax+72Eh]
                mov     rax, cs:qword_140C4E4C8
                mov     rdi, [rax+rcx*8]
                jmp     loc_14027CCED
; ---------------------------------------------------------------------------

loc_14027D06B:                          ; CODE XREF: sub_14027CC90+93↑j
                                        ; DATA XREF: .pdata:00000001400CE928↑o ...
                mov     rdx, gs:20h
                mov     r14d, 1
                mov     rax, [rdx+0C0h]
                movzx   ecx, word ptr [rax+92h]
                cmp     ecx, esi
                jnz     loc_14027CD2C
                mov     rax, [rdx+7F08h]
                test    rax, rax
                jz      loc_14027CD2C
                xor     eax, eax
                xchg    rax, [rdx+7F08h]
                test    rax, rax
                jz      loc_14027CD2C
                mov     r9, [rax-10h]
                lea     rbp, [rax-0FF0h]
                mov     rax, cs:qword_140C4ED48
                xor     rax, rbp
                cmp     r9, rax
                jnz     loc_140442C64
                and     rbp, 0FFFFFFFFFFFFF000h
                shl     rbp, 10h
                add     rbp, 10000000h
                sar     rbp, 10h
                jmp     loc_14027CF4F
; ---------------------------------------------------------------------------

loc_14027D0EB:                          ; CODE XREF: sub_14027CC90+32C↑j
                test    bl, 42h
                jnz     loc_14027CE90
                jmp     loc_14027CFC2
; ---------------------------------------------------------------------------

loc_14027D0F9:                          ; CODE XREF: sub_14027CC90+34C↑j
                mov     rdx, rbx
                jmp     loc_14027CE90
; ---------------------------------------------------------------------------

loc_14027D101:                          ; CODE XREF: sub_14027CC90+112↑j
                cmp     dword ptr [rbx+1Ch], 0
                jnz     loc_14027CDA8
                mov     dword ptr [rbx+1Ch], 1
                jmp     loc_14027CDA8
; ---------------------------------------------------------------------------

loc_14027D117:                          ; CODE XREF: sub_14027CC90+107↑j
                cmp     rbp, 1
                jz      short loc_14027D138
                mov     eax, cs:dword_140CFC660
                mov     r14, [rsp+98h+var_68]
                test    eax, eax
                jnz     loc_140442CB8

loc_14027D130:                          ; CODE XREF: sub_14027CC90+1C602A↓j
                                        ; sub_14027CC90+1C6036↓j ...
                movzx   eax, r14b
                mov     cr8, rax

loc_14027D138:                          ; CODE XREF: sub_14027CC90+48B↑j
                mov     eax, 2
                lea     rdx, [rax-3]

loc_14027D141:                          ; CODE XREF: sub_14027CC90+D1↑j
                inc     dword ptr [rbx+14h]
                cmp     rbp, 1
                jz      loc_14027D231
                mov     r12d, [rsp+98h+arg_0]
                mov     r8, [rsp+98h+var_60]

loc_14027D15B:                          ; CODE XREF: sub_14027CC90+9F↑j
                                        ; sub_14027CC90+5DA↓j
                mov     ebx, r8d
                mov     rcx, rdi
                mov     r8d, r12d
                mov     edx, ebx
                shr     r8d, 1
                and     r8d, 1
                call    sub_140232160
                test    eax, eax
                jz      loc_140442FC1
                mov     r15, [rsp+98h+var_60]
                lea     rcx, unk_140C4E9D8
                lea     edx, [r15+1]
                call    sub_1402583E0
                mov     r14, rax
                test    rax, rax
                jz      loc_140442FB6
                lea     rbp, [rbx+1]
                mov     rdx, 0FFFFF68000000000h
                shl     rbp, 1Ch
                mov     rax, rdx
                shl     rax, 19h
                mov     r13, r14
                sub     rbp, rax
                mov     rax, r14
                shl     rax, 19h
                add     rbp, rax
                mov     eax, r12d
                and     al, 5
                sar     rbp, 10h
                cmp     al, 1
                jz      short loc_14027D245

loc_14027D1D1:                          ; CODE XREF: sub_14027CC90+5B9↓j
                mov     rdx, [rsp+98h+var_58]
                xor     r8d, r8d
                mov     rcx, rdi
                call    sub_1402D4174
                test    eax, eax
                jz      loc_140442FA3
                mov     r9, [rsp+98h+var_48]
                lea     rdx, [r13+8]
                mov     [rsp+98h+var_70], r12d
                mov     rcx, rdi
                mov     dword ptr [rsp+98h+var_78], esi
                mov     rsi, [rsp+98h+var_58]
                mov     r8, rsi
                call    sub_1402C6E90
                test    eax, eax
                lea     rax, unk_140C50C00
                jz      loc_140442F24
                cmp     rdi, rax
                jnz     loc_14027CF4F
                lock xadd cs:qword_140C4EE48, rbx
                jmp     loc_14027CF4F
; ---------------------------------------------------------------------------

loc_14027D231:                          ; CODE XREF: sub_14027CC90+4B8↑j
                xor     r14d, r14d
                xor     ebp, ebp
                jmp     loc_14027CD48
; ---------------------------------------------------------------------------

loc_14027D23B:                          ; CODE XREF: sub_14027CC90+DB↑j
                mov     byte ptr [rsp+98h+var_68], 11h
                jmp     loc_14027CD8C
; ---------------------------------------------------------------------------

loc_14027D245:                          ; CODE XREF: sub_14027CC90+53F↑j
                lea     r13, [r14+60h]
                jmp     short loc_14027D1D1
; ---------------------------------------------------------------------------

loc_14027D24B:                          ; CODE XREF: sub_14027CC90+78↑j
                mov     r8d, 12h
                test    r12b, 4
                mov     eax, r8d
                mov     [rsp+98h+var_60], r8
                mov     ecx, 6
                cmovz   eax, ecx
                mov     [rsp+98h+var_58], rax
                jmp     loc_14027D15B
; ---------------------------------------------------------------------------

loc_14027D26F:                          ; CODE XREF: sub_14027CC90+36↑j
                                        ; DATA XREF: .pdata:00000001400CE934↑o ...
                mov     r13, 0FFFFFFFFFFFFFFF0h
                mov     [rsp+98h+var_48], r13
                jmp     loc_14027CCED
; ---------------------------------------------------------------------------

loc_14027D280:                          ; CODE XREF: sub_14027CC90+25F↑j
                                        ; DATA XREF: .pdata:00000001400CE940↑o ...
                mov     edx, 1
                mov     rcx, rdi
                call    sub_1403032A8
                jmp     loc_14027CEF5
sub_14027CC90   endp

; ---------------------------------------------------------------------------
algn_14027D292:                         ; DATA XREF: .pdata:00000001400CE94C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027D2A0   proc near               ; CODE XREF: sub_14027C960+1B8↑p
                                        ; sub_140356280+C↓p ...

var_98          = qword ptr -98h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
arg_0           = dword ptr  8
arg_8           = dword ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h

                mov     [rsp+arg_8], edx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 78h
                mov     eax, dword ptr cs:xmmword_140CFC480+4
                xor     r12d, r12d
                mov     [rsp+0B8h+var_88], r12
                mov     esi, edx
                mov     rbx, rcx
                test    al, 1
                jz      short loc_14027D2F5
                test    sil, 2
                jz      short loc_14027D2F5
                lea     edx, [r12+12h]
                test    sil, 1
                jnz     short loc_14027D2E3
                movzx   edx, cs:byte_140C4EA3C

loc_14027D2E3:                          ; CODE XREF: sub_14027D2A0+3A↑j
                mov     r8d, edx
                shl     r8d, 0Ch
                sub     rcx, r8
                xor     r8d, r8d
                call    sub_140546D10

loc_14027D2F5:                          ; CODE XREF: sub_14027D2A0+29↑j
                                        ; sub_14027D2A0+2F↑j
                shr     rbx, 9
                mov     rax, 7FFFFFFFF8h
                and     rbx, rax
                mov     r12, 0FFFFF68000000000h
                mov     rax, r12
                lea     r14, [rax-8]
                mov     r15, 0FFFFF6FB7DBED000h
                add     r14, rbx
                mov     [rsp+0B8h+var_60], r14
                mov     rdi, [r14]
                mov     rbx, rdi
                mov     rax, r15
                mov     rbp, 0FFFFF6FB7DBED7F8h
                cmp     r14, rax
                jb      short loc_14027D3BF
                mov     rax, rbp
                cmp     r14, rax
                ja      short loc_14027D3BF
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14027D3BF
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14027D3BF
                test    bl, 1
                jz      short loc_14027D3BF
                test    bl, 20h
                jz      short loc_14027D37D
                test    bl, 42h
                jnz     short loc_14027D3BF

loc_14027D37D:                          ; CODE XREF: sub_14027D2A0+D6↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027D3BF
                or      rbx, 20h
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rbx, rdi
                test    al, 42h
                jz      short loc_14027D3BF
                or      rbx, 42h

loc_14027D3BF:                          ; CODE XREF: sub_14027D2A0+9F↑j
                                        ; sub_14027D2A0+A7↑j ...
                lea     rcx, [rsp+0B8h+var_70]
                mov     [rsp+0B8h+var_70], rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027D450
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14027D450
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14027D450
                test    bl, 1
                jz      short loc_14027D450
                test    bl, 20h
                jz      short loc_14027D406
                test    bl, 42h
                jnz     short loc_14027D450

loc_14027D406:                          ; CODE XREF: sub_14027D2A0+15F↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027D450
                lea     rax, [rsp+0B8h+var_70]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14027D450
                or      rbx, 42h

loc_14027D450:                          ; CODE XREF: sub_14027D2A0+130↑j
                                        ; sub_14027D2A0+13C↑j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                mov     r13, 0FFFFFA8000000000h
                lea     rcx, [rbx+rbx*2]
                add     rcx, rcx
                mov     rax, r13
                mov     rcx, [rax+rcx*8+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rcx, [rax+rcx*8]
                lea     rax, unk_140C50C00
                cmp     rcx, rax
                jnz     loc_14027DE6E
                test    sil, 1
                jnz     loc_14027DE6E
                mov     rax, r15
                cmp     r14, rax
                jb      loc_14027D53C
                mov     rax, rbp
                cmp     r14, rax
                ja      short loc_14027D53C
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14027D53C
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14027D53C
                test    dil, 1
                jz      short loc_14027D53C
                test    dil, 20h
                jz      short loc_14027D4F4
                test    dil, 42h
                jnz     short loc_14027D53C

loc_14027D4F4:                          ; CODE XREF: sub_14027D2A0+24C↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027D53C
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_14027D53C
                or      rdi, 42h

loc_14027D53C:                          ; CODE XREF: sub_14027D2A0+20F↑j
                                        ; sub_14027D2A0+21B↑j ...
                lea     rcx, [rsp+0B8h+var_68]
                mov     [rsp+0B8h+var_68], rdi
                call    sub_1402433C0
                test    eax, eax
                jz      loc_14027D5D4
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14027D5D4
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14027D5D4
                test    dil, 1
                jz      short loc_14027D5D4
                test    dil, 20h
                jz      short loc_14027D58A
                test    dil, 42h
                jnz     short loc_14027D5D4

loc_14027D58A:                          ; CODE XREF: sub_14027D2A0+2E2↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027D5D4
                lea     rax, [rsp+0B8h+var_68]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_14027D5D4
                or      rdi, 42h

loc_14027D5D4:                          ; CODE XREF: sub_14027D2A0+2AD↑j
                                        ; sub_14027D2A0+2BD↑j ...
                shr     rdi, 0Ch
                mov     rbp, 0FFFFFFFFFh
                and     rdi, rbp
                lea     rcx, [rdi+rdi*2]
                shl     rcx, 4
                mov     rax, r13
                add     rcx, rax
                mov     rax, r13
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                sar     rdx, 3
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                call    sub_14027DEC0
                xor     r10d, r10d
                mov     ecx, r10d
                mov     [rsp+0B8h+var_78], rcx
                mov     ebx, [rax+8]
                mov     dword ptr [rsp+0B8h+arg_10], ebx
                lea     r8d, [r10+2]
                lea     r15, [r10-1]
                test    sil, 4
                jz      loc_14027D939
                lea     rcx, [rsp+0B8h+var_88]
                call    sub_1402433C0
                mov     esi, eax
                xor     r12d, r12d
                mov     rbx, 7FFFFFFFFFFFFFFFh
                nop     dword ptr [rax+00000000h]

loc_14027D660:                          ; CODE XREF: sub_14027D2A0+56B↓j
                mov     rcx, r14
                call    sub_1402805F0
                mov     [rsp+0B8h+var_88], rax
                mov     r8, rax
                test    esi, esi
                jz      loc_14027D6FA
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14027D6FA
                mov     rcx, gs:188h
                mov     rdx, [rcx+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_14027D6FA
                test    r8b, 1
                jz      short loc_14027D6FA
                mov     rdx, rax
                test    r8b, 20h
                jz      short loc_14027D6B2
                test    r8b, 42h
                jnz     short loc_14027D6FA

loc_14027D6B2:                          ; CODE XREF: sub_14027D2A0+40A↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r9, [rcx+788h]
                test    r9, r9
                jnz     short loc_14027D6D5
                mov     r8, [rsp+0B8h+var_88]
                jmp     short loc_14027D6FA
; ---------------------------------------------------------------------------

loc_14027D6D5:                          ; CODE XREF: sub_14027D2A0+42C↑j
                lea     rax, [rsp+0B8h+var_88]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r9+rax*8]
                test    al, 20h
                jz      short loc_14027D6F2
                mov     r8, rdx
                or      r8, 20h

loc_14027D6F2:                          ; CODE XREF: sub_14027D2A0+449↑j
                test    al, 42h
                jz      short loc_14027D6FA
                or      r8, 42h

loc_14027D6FA:                          ; CODE XREF: sub_14027D2A0+3D2↑j
                                        ; sub_14027D2A0+3E2↑j ...
                shr     r8, 0Ch
                and     r8, rbp
                lea     rdi, [r8+r8*2]
                shl     rdi, 4
                mov     rax, r13
                add     rdi, rax
                mov     rbp, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027D75A
                test    al, 1
                jz      short loc_14027D75A
                cmp     bpl, 0Fh
                ja      short loc_14027D75A
                mov     rax, gs:20h
                mov     rdx, r15
                movzx   ecx, bpl
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_14027D75A:                          ; CODE XREF: sub_14027D2A0+484↑j
                                        ; sub_14027D2A0+488↑j ...
                mov     [rsp+0B8h+arg_0], r12d
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_14027D78F
                nop     dword ptr [rax+rax+00h]

loc_14027D770:                          ; CODE XREF: sub_14027D2A0+4E4↓j
                                        ; sub_14027D2A0+4ED↓j
                lea     rcx, [rsp+0B8h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_14027D770
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_14027D770

loc_14027D78F:                          ; CODE XREF: sub_14027D2A0+4C9↑j
                mov     rcx, r14
                call    sub_1402805F0
                cmp     [rsp+0B8h+var_88], rax
                jz      short loc_14027D810
                lock and [rdi+18h], rbx
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027D7F9
                test    al, 1
                jz      short loc_14027D7F9
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14027D7F9
                cmp     bpl, 0Fh
                ja      short loc_14027D7F9
                cmp     al, 2
                jb      short loc_14027D7F9
                mov     r10, gs:20h
                mov     rdx, r15
                movzx   ecx, bpl
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14027D7F9
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14027D7F9:                          ; CODE XREF: sub_14027D2A0+50B↑j
                                        ; sub_14027D2A0+50F↑j ...
                movzx   eax, bpl
                mov     cr8, rax
                mov     rbp, 0FFFFFFFFFh
                jmp     loc_14027D660
; ---------------------------------------------------------------------------

loc_14027D810:                          ; CODE XREF: sub_14027D2A0+4FC↑j
                mov     rsi, [rdi]
                mov     rax, 0FFFFFFFFFFEh
                test    rax, rsi
                jnz     short loc_14027D827
                mov     rsi, r12
                jmp     short loc_14027D83C
; ---------------------------------------------------------------------------

loc_14027D827:                          ; CODE XREF: sub_14027D2A0+580↑j
                and     rsi, 0FFFFFFFFFFFFFFFEh
                mov     rax, 0FFFFF00000000000h
                or      rsi, rax
                shl     rsi, 3

loc_14027D83C:                          ; CODE XREF: sub_14027D2A0+585↑j
                mov     rax, rbx
                lock and [rdi+18h], rax
                mov     eax, cs:dword_140CFC660
                mov     ebx, dword ptr [rsp+0B8h+arg_10]
                test    eax, eax
                jz      short loc_14027D8A1
                test    al, 1
                jz      short loc_14027D8A1
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14027D8A1
                cmp     bpl, 0Fh
                ja      short loc_14027D8A1
                cmp     al, 2
                jb      short loc_14027D8A1
                mov     r10, gs:20h
                mov     rdx, r15
                movzx   ecx, bpl
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14027D8A1
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14027D8A1:                          ; CODE XREF: sub_14027D2A0+5B3↑j
                                        ; sub_14027D2A0+5B7↑j ...
                movzx   eax, bpl
                mov     cr8, rax
                xor     r10d, r10d
                mov     r12, 0FFFFF68000000000h
                mov     ecx, r10d
                mov     [rsp+0B8h+var_78], rcx
                cmp     rsi, 0FFFFFFFFFFFFFFE0h
                jnz     short loc_14027D933
                mov     rdx, gs:20h
                mov     rax, [rdx+0C0h]
                movzx   ecx, word ptr [rax+92h]
                cmp     ecx, ebx
                jnz     short loc_14027D929
                mov     rax, [rdx+7F08h]
                test    rax, rax
                jnz     short loc_14027D929
                mov     rcx, r14
                shl     rcx, 19h
                mov     rax, r12
                shl     rax, 19h
                sub     rcx, rax
                mov     rax, cs:qword_140C4ED48
                sar     rcx, 10h
                xor     rax, rcx
                mov     [rcx+0FE0h], rax
                add     rcx, 0FF0h
                xor     eax, eax
                lock cmpxchg [rdx+7F08h], rcx
                jz      loc_14027DE78

loc_14027D929:                          ; CODE XREF: sub_14027D2A0+63D↑j
                                        ; sub_14027D2A0+649↑j
                mov     ecx, 1
                mov     [rsp+0B8h+var_78], rcx

loc_14027D933:                          ; CODE XREF: sub_14027D2A0+622↑j
                mov     r8d, 2

loc_14027D939:                          ; CODE XREF: sub_14027D2A0+39A↑j
                mov     eax, ebx
                imul    rax, 0B0h
                mov     [rsp+0B8h+var_58], rax
                nop     word ptr [rax+rax+00000000h]

loc_14027D950:                          ; CODE XREF: sub_14027D2A0+B3F↓j
                mov     r15, rcx
                shl     r15, 5
                add     r15, rax
                add     r15, cs:qword_140C4DD20
                movzx   eax, word ptr [r15]
                cmp     eax, [r15+10h]
                jge     loc_14027DDB7
                mov     r13, r14
                shl     r13, 19h
                mov     rax, r12
                shl     rax, 19h
                sub     r13, rax
                mov     rax, cs:qword_140C4ED48
                sar     r13, 10h
                xor     rax, r13
                mov     [r13+0FE0h], rax
                cmp     rcx, 1
                jz      loc_14027DE56
                mov     r12, cr8
                mov     cr8, r8
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027D9E9
                test    al, 1
                jz      short loc_14027D9E9
                cmp     r12b, 0Fh
                ja      short loc_14027D9E9
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r12b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_14027D9E9:                          ; CODE XREF: sub_14027D2A0+70F↑j
                                        ; sub_14027D2A0+713↑j ...
                movzx   ecx, cs:byte_140C4EA3C
                mov     ebp, 1
                mov     eax, ecx
                mov     [rsp+0B8h+var_80], r10
                shl     rax, 3
                mov     edi, 0FFFFFFFFh
                sub     r14, rax
                lea     eax, [rcx+1]
                lea     rax, [r14+rax*8]
                add     r14, 8
                mov     [rsp+0B8h+arg_10], rax
                cmp     r14, rax
                jnb     loc_14027DDE4
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_14027DA30:                          ; CODE XREF: sub_14027D2A0+A9C↓j
                mov     rbx, [r14]
                mov     rcx, 0FFFFF6FB7DBED000h
                mov     rax, rcx
                mov     r8, 0FFFFF6FB7DBED7F8h
                cmp     r14, rax
                jb      short loc_14027DAC1
                mov     rax, r8
                cmp     r14, rax
                ja      short loc_14027DAC1
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027DAB7
                test    bl, 1
                jz      short loc_14027DAB7
                test    bl, 20h
                jz      short loc_14027DA6F
                test    bl, 42h
                jnz     short loc_14027DAB7

loc_14027DA6F:                          ; CODE XREF: sub_14027D2A0+7C8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027DAB7
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14027DAB7
                or      rbx, 42h

loc_14027DAB7:                          ; CODE XREF: sub_14027D2A0+7BE↑j
                                        ; sub_14027D2A0+7C3↑j ...
                mov     rcx, 0FFFFF6FB7DBED000h

loc_14027DAC1:                          ; CODE XREF: sub_14027D2A0+7AD↑j
                                        ; sub_14027D2A0+7B5↑j
                mov     [rsp+0B8h+var_80], rbx
                test    bl, 1
                jnz     short loc_14027DAD4
                add     r14, 8
                jmp     loc_14027DD34
; ---------------------------------------------------------------------------

loc_14027DAD4:                          ; CODE XREF: sub_14027D2A0+829↑j
                mov     rdx, rbx
                mov     rax, rcx
                lea     rcx, [rsp+0B8h+var_80]
                cmp     rcx, rax
                jb      short loc_14027DB50
                mov     rax, r8
                lea     rcx, [rsp+0B8h+var_80]
                cmp     rcx, rax
                ja      short loc_14027DB50
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027DB50
                test    bl, 20h
                jz      short loc_14027DB04
                test    bl, 42h
                jnz     short loc_14027DB50

loc_14027DB04:                          ; CODE XREF: sub_14027D2A0+85D↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     short loc_14027DB25
                mov     rdx, rbx
                jmp     short loc_14027DB50
; ---------------------------------------------------------------------------

loc_14027DB25:                          ; CODE XREF: sub_14027D2A0+87E↑j
                lea     rax, [rsp+0B8h+var_80]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                test    al, 42h
                jz      short loc_14027DB50
                or      rdx, 42h

loc_14027DB50:                          ; CODE XREF: sub_14027D2A0+842↑j
                                        ; sub_14027D2A0+84F↑j ...
                shr     rdx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax
                mov     r9, 0FFFFFA8000000000h
                lea     rsi, [rdx+rdx*2]
                shl     rsi, 4
                mov     rax, r9
                add     rsi, rax
                mov     [rsp+0B8h+arg_18], r10d
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jnb     short loc_14027DBBC
                nop     word ptr [rax+rax+00h]

loc_14027DB90:                          ; CODE XREF: sub_14027D2A0+904↓j
                                        ; sub_14027D2A0+90D↓j
                lea     rcx, [rsp+0B8h+arg_18]
                call    sub_1402C8C70
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_14027DB90
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_14027DB90
                xor     r10d, r10d
                mov     r9, 0FFFFFA8000000000h

loc_14027DBBC:                          ; CODE XREF: sub_14027D2A0+8E8↑j
                mov     rdx, [r14]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r14, rax
                jb      short loc_14027DC43
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r14, rax
                ja      short loc_14027DC43
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027DC43
                test    dl, 1
                jz      short loc_14027DC43
                test    dl, 20h
                jz      short loc_14027DBFB
                test    dl, 42h
                jnz     short loc_14027DC43

loc_14027DBFB:                          ; CODE XREF: sub_14027D2A0+954↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14027DC43
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14027DC43
                or      rdx, 42h

loc_14027DC43:                          ; CODE XREF: sub_14027D2A0+92F↑j
                                        ; sub_14027D2A0+941↑j ...
                cmp     rbx, rdx
                jnz     loc_14027DD25
                mov     rax, r9
                mov     rcx, rsi
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     r8, rdx
                sar     r8, 3
                mov     rax, r8
                shr     rax, 3Fh
                add     r8, rax
                cmp     edi, 0FFFFFFFFh
                jnz     short loc_14027DC8B
                mov     rcx, r8
                call    sub_14027DEC0
                xor     r10d, r10d
                mov     edi, [rax+8]
                jmp     loc_14027DD0E
; ---------------------------------------------------------------------------

loc_14027DC8B:                          ; CODE XREF: sub_14027D2A0+9D6↑j
                movsxd  rax, cs:dword_140C4DD04
                mov     ecx, cs:dword_140C4DD08
                cmp     eax, ecx
                ja      short loc_14027DCB9
                mov     r9, rax
                shl     r9, 4
                add     r9, cs:qword_140C4DD48
                cmp     r8, [r9]
                jb      short loc_14027DCB9
                cmp     eax, ecx
                jz      short loc_14027DD06
                cmp     r8, [r9+10h]
                jb      short loc_14027DD06

loc_14027DCB9:                          ; CODE XREF: sub_14027D2A0+9FA↑j
                                        ; sub_14027D2A0+A0D↑j
                mov     edx, r10d
                nop     dword ptr [rax+00h]

loc_14027DCC0:                          ; CODE XREF: sub_14027D2A0+A4B↓j
                                        ; sub_14027D2A0+A5E↓j
                cmp     ecx, edx
                jl      loc_14027DE9F
                lea     eax, [rdx+rcx]
                sar     eax, 1
                movsxd  r9, eax
                shl     r9, 4
                add     r9, cs:qword_140C4DD48
                cmp     r8, [r9]
                jnb     short loc_14027DCED
                test    eax, eax
                jz      loc_14027DE8A
                lea     ecx, [rax-1]
                jmp     short loc_14027DCC0
; ---------------------------------------------------------------------------

loc_14027DCED:                          ; CODE XREF: sub_14027D2A0+A3E↑j
                cmp     eax, cs:dword_140C4DD08
                jz      short loc_14027DD00
                cmp     r8, [r9+10h]
                jb      short loc_14027DD00
                lea     edx, [rax+1]
                jmp     short loc_14027DCC0
; ---------------------------------------------------------------------------

loc_14027DD00:                          ; CODE XREF: sub_14027D2A0+A53↑j
                                        ; sub_14027D2A0+A59↑j
                mov     cs:dword_140C4DD04, eax

loc_14027DD06:                          ; CODE XREF: sub_14027D2A0+A11↑j
                                        ; sub_14027D2A0+A17↑j
                cmp     edi, [r9+8]
                cmovnz  ebp, r10d

loc_14027DD0E:                          ; CODE XREF: sub_14027D2A0+9E6↑j
                mov     rax, [rsi]
                mov     rcx, 0FFFFF00000000001h
                and     rax, rcx
                mov     [rsi], rax
                add     r14, 8

loc_14027DD25:                          ; CODE XREF: sub_14027D2A0+9A6↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], rax

loc_14027DD34:                          ; CODE XREF: sub_14027D2A0+82F↑j
                cmp     r14, [rsp+0B8h+arg_10]
                jb      loc_14027DA30
                cmp     ebp, 1
                jz      loc_14027DDE4
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027DDA5
                test    al, 1
                jz      short loc_14027DDA5
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14027DDA5
                cmp     r12b, 0Fh
                ja      short loc_14027DDA5
                cmp     al, 2
                jb      short loc_14027DDA5
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r12b
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14027DDA5
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14027DDA5:                          ; CODE XREF: sub_14027D2A0+AB3↑j
                                        ; sub_14027D2A0+AB7↑j ...
                movzx   eax, r12b
                mov     cr8, rax
                mov     rcx, [rsp+0B8h+var_78]
                mov     r14, [rsp+0B8h+var_60]

loc_14027DDB7:                          ; CODE XREF: sub_14027D2A0+6C9↑j
                cmp     rcx, 1
                jnz     loc_14027DE67
                mov     rax, [rsp+0B8h+var_58]
                xor     r10d, r10d
                mov     ecx, r10d
                mov     r12, 0FFFFF68000000000h
                mov     [rsp+0B8h+var_78], rcx
                lea     r8d, [r10+2]
                jmp     loc_14027D950
; ---------------------------------------------------------------------------

loc_14027DDE4:                          ; CODE XREF: sub_14027D2A0+77E↑j
                                        ; sub_14027D2A0+AA5↑j
                lea     rdx, [r13+0FF0h]
                mov     rcx, r15
                call    ExpInterlockedPushEntrySList
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027DE4C
                test    al, 1
                jz      short loc_14027DE4C
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14027DE4C
                cmp     r12b, 0Fh
                ja      short loc_14027DE4C
                cmp     al, 2
                jb      short loc_14027DE4C
                mov     r9, gs:20h
                mov     rax, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r12b
                inc     ecx
                shl     rax, cl
                mov     r8, [r9+84B8h]
                movzx   eax, ax
                not     eax
                mov     edx, [r8+14h]
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_14027DE4C
                mov     rcx, r9
                call    sub_1403F2EC4

loc_14027DE4C:                          ; CODE XREF: sub_14027D2A0+B5B↑j
                                        ; sub_14027D2A0+B5F↑j ...
                movzx   eax, r12b
                mov     cr8, rax
                jmp     short loc_14027DE78
; ---------------------------------------------------------------------------

loc_14027DE56:                          ; CODE XREF: sub_14027D2A0+6F9↑j
                lea     rdx, [r13+0FF0h]
                mov     rcx, r15
                call    ExpInterlockedPushEntrySList
                jmp     short loc_14027DE78
; ---------------------------------------------------------------------------

loc_14027DE67:                          ; CODE XREF: sub_14027D2A0+B1B↑j
                mov     esi, [rsp+0B8h+arg_8]

loc_14027DE6E:                          ; CODE XREF: sub_14027D2A0+1F9↑j
                                        ; sub_14027D2A0+203↑j
                mov     edx, esi
                mov     rcx, r14
                call    sub_140213C50

loc_14027DE78:                          ; CODE XREF: sub_14027D2A0+683↑j
                                        ; sub_14027D2A0+BB4↑j ...
                add     rsp, 78h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027DE8A:                          ; CODE XREF: sub_14027D2A0+A42↑j
                mov     edx, 6200h
                mov     [rsp+0B8h+var_98], r10
                mov     ecx, 1Ah
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14027DE9F:                          ; CODE XREF: sub_14027D2A0+A22↑j
                xor     r9d, r9d
                mov     [rsp+0B8h+var_98], r10
                mov     edx, 6201h
                lea     ecx, [r9+1Ah]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027D2A0   endp

algn_14027DEB6:                         ; DATA XREF: .pdata:00000001400CE958↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027DEC0   proc near               ; CODE XREF: sub_14022FC80+195↑p
                                        ; sub_14022FC80+1FA↑p ...

var_18          = qword ptr -18h

; FUNCTION CHUNK AT 0000000140442FFA SIZE 0000004A BYTES

                sub     rsp, 38h
                movsxd  rdx, cs:dword_140C4DD04
                mov     r8d, cs:dword_140C4DD08
                cmp     edx, r8d
                ja      short loc_14027DEFB
                mov     rax, rdx
                shl     rax, 4
                add     rax, cs:qword_140C4DD48
                cmp     rcx, [rax]
                jb      short loc_14027DEFB
                cmp     edx, r8d
                jnz     short loc_14027DEF5

loc_14027DEEF:                          ; CODE XREF: sub_14027DEC0+39↓j
                add     rsp, 38h
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027DEF5:                          ; CODE XREF: sub_14027DEC0+2D↑j
                cmp     rcx, [rax+10h]
                jb      short loc_14027DEEF

loc_14027DEFB:                          ; CODE XREF: sub_14027DEC0+15↑j
                                        ; sub_14027DEC0+28↑j
                xor     r9d, r9d
                test    r8d, r8d
                js      loc_140443026

loc_14027DF07:                          ; CODE XREF: sub_14027DEC0+85↓j
                lea     edx, [r9+r8]
                sar     edx, 1
                movsxd  rax, edx
                shl     rax, 4
                add     rax, cs:qword_140C4DD48
                cmp     rcx, [rax]
                jb      loc_140442FFA
                cmp     edx, cs:dword_140C4DD08
                jz      short loc_14027DF32
                cmp     rcx, [rax+10h]
                jnb     short loc_14027DF3E

loc_14027DF32:                          ; CODE XREF: sub_14027DEC0+6A↑j
                mov     cs:dword_140C4DD04, edx
                add     rsp, 38h
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027DF3E:                          ; CODE XREF: sub_14027DEC0+70↑j
                lea     r9d, [rdx+1]

loc_14027DF42:                          ; CODE XREF: sub_14027DEC0+1C5142↓j
                cmp     r8d, r9d
                jge     short loc_14027DF07
                jmp     loc_140443026
sub_14027DEC0   endp

; ---------------------------------------------------------------------------
algn_14027DF4C:                         ; DATA XREF: .rdata:000000014005E5BC↑o
                                        ; .pdata:00000001400CE964↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_14027DF60   proc near               ; CODE XREF: sub_1402947A0+537↓p
                                        ; DATA XREF: .pdata:00000001400CE970↑o

var_B0          = qword ptr -0B0h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = xmmword ptr -60h
var_50          = qword ptr -50h
var_48          = xmmword ptr -48h
var_38          = qword ptr -38h
arg_10          = qword ptr  20h

; __unwind { // __GSHandlerCheck
                mov     [rsp-8+arg_10], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-27h]
                sub     rsp, 0A0h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+57h+var_38], rax
                xor     eax, eax
                mov     r15, rcx
                mov     [rbp+57h+var_50], rax
                mov     rsi, 0FFFFFFFFFFFFFFFFh
                xorps   xmm0, xmm0
                mov     [rbp+57h+var_A0], rsi
                movups  [rbp+57h+var_60], xmm0
                mov     rax, gs:188h
                mov     rbx, r15
                shr     rbx, 9
                mov     r12, rdx
                mov     r13, rsi
                mov     rax, [rax+0B8h]
                mov     [rbp+57h+var_68], rax
                movzx   ecx, word ptr [rax+72Eh]
                mov     rax, cs:qword_140C4E4C8
                mov     rax, [rax+rcx*8]
                mov     rcx, 7FFFFFFFF8h
                and     rbx, rcx
                mov     [rbp+57h+var_80], rax
                mov     rcx, 0FFFFF68000000000h
                add     rbx, rcx
                mov     rcx, rbx
                mov     r14, [rbx]
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027E068
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027E068
                test    r14b, 1
                jz      short loc_14027E068
                test    r14b, 20h
                jz      short loc_14027E020
                test    r14b, 42h
                jnz     short loc_14027E068

loc_14027E020:                          ; CODE XREF: sub_14027DF60+B8↑j
                mov     rax, gs:188h
                mov     edx, ebx
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14027E068
                shr     rdx, 3
                and     edx, 1FFh
                mov     rax, [rax+rdx*8]
                mov     rdx, r14
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r14
                mov     r14, rdx
                test    al, 42h
                jz      short loc_14027E068
                or      r14, 42h

loc_14027E068:                          ; CODE XREF: sub_14027DF60+A3↑j
                                        ; sub_14027DF60+AC↑j ...
                lea     rcx, [rbp+57h+var_88]
                mov     [rbp+57h+var_88], r14
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027E0DD
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027E0DD
                test    r14b, 1
                jz      short loc_14027E0DD
                test    r14b, 20h
                jz      short loc_14027E094
                test    r14b, 42h
                jnz     short loc_14027E0DD

loc_14027E094:                          ; CODE XREF: sub_14027DF60+12C↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027E0DD
                lea     rax, [rbp+57h+var_88]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r14
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r14
                mov     r14, rdx
                test    al, 42h
                jz      short loc_14027E0DD
                or      r14, 42h

loc_14027E0DD:                          ; CODE XREF: sub_14027DF60+117↑j
                                        ; sub_14027DF60+120↑j ...
                shr     r14, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     r14, rax
                mov     rdi, r15
                mov     [rbp+57h+var_70], r14
                xor     ebx, ebx

loc_14027E0F7:                          ; CODE XREF: sub_14027DF60+2FA↓j
                mov     rcx, rdi
                call    sub_1402805F0
                mov     r8, rax
                test    rax, rax
                jz      loc_14027E393
                bt      rax, 0Ah
                jnb     loc_14027E393
                or      r8, 1
                mov     rax, 0FFFFF6FB7DBED000h
                btr     r8, 0Ah
                mov     [rbp+57h+var_98], r8
                mov     rax, rax
                lea     rcx, [rbp+57h+var_98]
                cmp     rcx, rax
                jb      short loc_14027E1A7
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                lea     rcx, [rbp+57h+var_98]
                cmp     rcx, rax
                ja      short loc_14027E1A7
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027E1A7
                test    r8b, 20h
                jz      short loc_14027E164
                test    r8b, 42h
                jnz     short loc_14027E1A7

loc_14027E164:                          ; CODE XREF: sub_14027DF60+1FC↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     short loc_14027E186
                mov     r8, [rbp+57h+var_98]
                jmp     short loc_14027E1A7
; ---------------------------------------------------------------------------

loc_14027E186:                          ; CODE XREF: sub_14027DF60+21E↑j
                lea     rax, [rbp+57h+var_98]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                test    al, 20h
                jz      short loc_14027E19F
                or      r8, 20h

loc_14027E19F:                          ; CODE XREF: sub_14027DF60+239↑j
                test    al, 42h
                jz      short loc_14027E1A7
                or      r8, 42h

loc_14027E1A7:                          ; CODE XREF: sub_14027DF60+1D7↑j
                                        ; sub_14027DF60+1ED↑j ...
                shr     r8, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     r8, rax
                test    rbx, rbx
                jz      short loc_14027E1C6
                cmp     r8, r13
                jnz     loc_14027E393

loc_14027E1C6:                          ; CODE XREF: sub_14027DF60+25B↑j
                lea     rcx, [r8+r8*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                cmp     cs:byte_140C51EDE, 0
                lea     r9, [rcx+rax]
                jz      short loc_14027E218
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                sar     rdx, 3
                mov     rax, rdx
                shr     rax, 3Fh
                add     rdx, rax
                mov     rax, cs:qword_140C52408
                shr     rdx, 9
                bt      [rax], rdx
                jb      loc_14027E393

loc_14027E218:                          ; CODE XREF: sub_14027DF60+286↑j
                mov     rcx, r9
                call    sub_1403F41D8
                test    eax, eax
                jnz     loc_14027E393
                mov     rdx, [r9+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rdx, 27h
                and     edx, 3FFh
                mov     rdx, [rax+rdx*8]
                cmp     rdx, [rbp+57h+var_80]
                jnz     loc_14027E393
                inc     rbx
                lea     r13, [r8+1]
                add     rdi, 8
                cmp     rbx, 10h
                jb      loc_14027E0F7
                mov     rcx, r12
                call    sub_140295F90
                lea     rax, [r13-10h]
                lea     rdx, [rax+rax*2]
                mov     [rbp+57h+var_78], rax
                mov     rdi, rax
                shl     rdx, 4
                mov     rax, 0FFFFFA8000000000h
                mov     rcx, rax
                lea     rbx, [rdx+rcx]
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rdx
                mov     r12, rbx
                sar     rdx, 3
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                call    sub_14027DEC0
                xorps   xmm0, xmm0
                movups  [rbp+57h+var_48], xmm0
                cmp     rdi, r13
                jnb     loc_14027E34A
                lea     rax, [r13-10h]
                mov     [rbp+57h+var_78], rax

loc_14027E2C7:                          ; CODE XREF: sub_14027DF60+3DC↓j
                mov     rcx, rbx
                cmp     rdi, rax
                jnz     short loc_14027E2D6
                call    sub_14054FB1C
                jmp     short loc_14027E2DF
; ---------------------------------------------------------------------------

loc_14027E2D6:                          ; CODE XREF: sub_14027DF60+36D↑j
                call    sub_1402D69D0
                test    eax, eax
                jz      short loc_14027E33E

loc_14027E2DF:                          ; CODE XREF: sub_14027DF60+374↑j
                mov     rsi, [rbx+8]
                mov     rcx, 8000000000000000h
                mov     rax, rsi
                mov     [rbp+57h+var_A0], rdi
                or      rax, rcx
                cmp     rax, r15
                jnz     loc_14027E60B
                movzx   ecx, byte ptr [rbx+22h]
                movzx   eax, cl
                and     al, 7
                cmp     al, 6
                jnz     loc_14027E602
                cmp     word ptr [rbx+20h], 1
                jnz     short loc_14027E344
                test    byte ptr [rbx+23h], 40h
                jnz     short loc_14027E344
                mov     eax, ecx
                inc     rdi
                shr     rax, 6
                add     rbx, 30h ; '0'
                add     r15, 8
                inc     dword ptr [rbp+rax*4+57h+var_48]
                cmp     rdi, r13
                jnb     short loc_14027E33E
                lea     rax, [r13-10h]
                jmp     short loc_14027E2C7
; ---------------------------------------------------------------------------

loc_14027E33E:                          ; CODE XREF: sub_14027DF60+37D↑j
                                        ; sub_14027DF60+3D6↑j
                mov     rsi, [rbp+57h+var_A0]
                jmp     short loc_14027E347
; ---------------------------------------------------------------------------

loc_14027E344:                          ; CODE XREF: sub_14027DF60+3B6↑j
                                        ; sub_14027DF60+3BC↑j
                mov     rsi, rdi

loc_14027E347:                          ; CODE XREF: sub_14027DF60+3E2↑j
                cmp     rdi, r13

loc_14027E34A:                          ; CODE XREF: sub_14027DF60+359↑j
                jz      short loc_14027E3BD
                cmp     rsi, 0FFFFFFFFFFFFFFFFh
                jz      short loc_14027E393
                lea     rcx, [rsi+rsi*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                add     rcx, rax
                mov     rdi, 7FFFFFFFFFFFFFFFh
                cmp     rcx, r12
                jz      short loc_14027E38E
                nop     dword ptr [rax+00000000h]

loc_14027E380:                          ; CODE XREF: sub_14027DF60+42C↓j
                lock and [rcx+18h], rdi
                sub     rcx, 30h ; '0'
                cmp     rcx, r12
                jnz     short loc_14027E380

loc_14027E38E:                          ; CODE XREF: sub_14027DF60+417↑j
                lock and [rcx+18h], rdi

loc_14027E393:                          ; CODE XREF: sub_14027DF60+1A5↑j
                                        ; sub_14027DF60+1B0↑j ...
                xor     eax, eax

loc_14027E395:                          ; CODE XREF: sub_14027DF60+69D↓j
                mov     rcx, [rbp+57h+var_38]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+0D0h+arg_10]
                add     rsp, 0A0h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027E3BD:                          ; CODE XREF: sub_14027DF60:loc_14027E34A↑j
                mov     ecx, dword ptr [rbp+57h+var_48]
                xor     eax, eax
                mov     r13, rbx
                add     r15, 0FFFFFFFFFFFFFF80h
                sub     rbx, 300h
                lea     esi, [rax+1]
                test    ecx, ecx
                jz      short loc_14027E3DB
                mov     eax, ecx
                xor     esi, esi

loc_14027E3DB:                          ; CODE XREF: sub_14027DF60+475↑j
                mov     ecx, dword ptr [rbp+57h+var_48+4]
                cmp     eax, ecx
                jnb     short loc_14027E3E9
                mov     eax, ecx
                mov     esi, 1

loc_14027E3E9:                          ; CODE XREF: sub_14027DF60+480↑j
                mov     ecx, dword ptr [rbp+57h+var_48+8]
                mov     edx, 2
                cmp     eax, ecx
                jnb     short loc_14027E3F9
                mov     eax, ecx
                mov     esi, edx

loc_14027E3F9:                          ; CODE XREF: sub_14027DF60+493↑j
                cmp     eax, dword ptr [rbp+57h+var_48+0Ch]
                mov     ecx, 3
                mov     r14, [rbp+57h+var_80]
                mov     rdi, 7FFFFFFFFFFFFFFFh
                cmovb   esi, ecx
                nop     dword ptr [rax+00h]
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_14027E420:                          ; CODE XREF: sub_14027DF60+61A↓j
                mov     rax, [rbx+28h]
                shr     rax, 3Ch
                and     al, 7
                mov     [rbx+20h], dx
                cmp     al, 3
                jnz     short loc_14027E43F
                mov     edx, 0Ch
                mov     rcx, rbx
                call    sub_1402D69E8

loc_14027E43F:                          ; CODE XREF: sub_14027DF60+4D0↑j
                mov     rcx, [rbx+10h]
                mov     [rbp+57h+var_90], rcx
                bt      rcx, 0Ah
                jb      short loc_14027E48E
                movzx   eax, cl
                shr     al, 2
                test    al, 1
                jz      short loc_14027E463
                lea     rcx, [rbp+57h+var_90]
                call    sub_1402805F0
                jmp     short loc_14027E477
; ---------------------------------------------------------------------------

loc_14027E463:                          ; CODE XREF: sub_14027DF60+4F6↑j
                shr     cl, 1
                test    cl, 1
                jz      short loc_14027E475
                lea     rcx, [rbp+57h+var_90]
                call    sub_1402805F0
                jmp     short loc_14027E477
; ---------------------------------------------------------------------------

loc_14027E475:                          ; CODE XREF: sub_14027DF60+508↑j
                xor     eax, eax

loc_14027E477:                          ; CODE XREF: sub_14027DF60+501↑j
                                        ; sub_14027DF60+513↑j
                mov     [rbp+57h+var_90], rax
                test    rax, rax
                jz      short loc_14027E48E
                xor     r8d, r8d
                mov     rdx, rax
                mov     rcx, r14
                call    sub_14020B2C0

loc_14027E48E:                          ; CODE XREF: sub_14027DF60+4EC↑j
                                        ; sub_14027DF60+51E↑j
                mov     rax, cs:qword_14001D278
                mov     [rbx+10h], rax
                movzx   eax, byte ptr [rbx+22h]
                shr     eax, 6
                cmp     eax, esi
                jz      short loc_14027E4B4
                mov     r8d, 1
                mov     edx, esi
                mov     rcx, rbx
                call    sub_14031F848

loc_14027E4B4:                          ; CODE XREF: sub_14027DF60+542↑j
                movzx   eax, byte ptr [rbx+23h]
                test    al, 10h
                jz      short loc_14027E4C1
                and     al, 0EFh
                mov     [rbx+23h], al

loc_14027E4C1:                          ; CODE XREF: sub_14027DF60+55A↑j
                xor     r9d, r9d
                mov     rdx, r12
                mov     rcx, rbx
                lea     r8d, [r9+2]
                call    sub_1403F5A88
                cmp     rbx, r12
                jz      short loc_14027E4DD
                lock and [rbx+18h], rdi

loc_14027E4DD:                          ; CODE XREF: sub_14027DF60+576↑j
                mov     rdx, cs:qword_14001D278
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r15, rax
                jb      short loc_14027E567
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r15, rax
                ja      short loc_14027E567
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027E539
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14027E52C
                test    dl, 1
                jz      short loc_14027E52C
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14027E52C:                          ; CODE XREF: sub_14027DF60+5B8↑j
                                        ; sub_14027DF60+5BD↑j
                mov     rcx, r15
                mov     [r15], rdx
                call    sub_140349620
                jmp     short loc_14027E56A
; ---------------------------------------------------------------------------

loc_14027E539:                          ; CODE XREF: sub_14027DF60+5AF↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027E567
                test    dl, 1
                jz      short loc_14027E567
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14027E567:                          ; CODE XREF: sub_14027DF60+594↑j
                                        ; sub_14027DF60+5A6↑j ...
                mov     [r15], rdx

loc_14027E56A:                          ; CODE XREF: sub_14027DF60+5D7↑j
                add     rbx, 30h ; '0'
                add     r15, 8
                mov     edx, 2
                cmp     rbx, r13
                jb      loc_14027E420
                mov     rax, [rbp+57h+var_78]
                lea     rcx, [rbp+57h+var_60]
                mov     qword ptr [rbp+57h+var_60], rax
                mov     qword ptr [rbp+57h+var_60+8], 1
                mov     byte ptr [rbp+57h+var_50], dl
                call    sub_140321040
                mov     r14, [rbp+57h+var_70]
                mov     rax, 0FFFFFA8000000000h
                lea     rbx, [r14+r14*2]
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                mov     rcx, rbx
                call    sub_14054FB1C
                mov     rcx, [rbx+18h]
                mov     r8, 3FFFFFFFFFFFFFFFh
                lea     rdx, [rcx-10h]
                xor     rdx, rcx
                and     rdx, r8
                xor     rdx, rcx
                mov     [rbx+18h], rdx
                lock and [rbx+18h], rdi
                mov     rdx, [rbp+57h+var_68]
                mov     rcx, 0FFFFFFFFFFFFFFF0h
                lock xadd [rdx+4F8h], rcx
                mov     eax, 1
                jmp     loc_14027E395
; ---------------------------------------------------------------------------

loc_14027E602:                          ; CODE XREF: sub_14027DF60+3AB↑j
                mov     rcx, rbx
                call    sub_1403F4244
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14027E60B:                          ; CODE XREF: sub_14027DF60+39A↑j
                mov     rcx, r15
                call    sub_1402805F0
                mov     r9, rax
                mov     [rsp+0D0h+var_B0], rsi
                mov     r8, r15
                mov     edx, 403h
                mov     ecx, 1Ah
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 14027DF60
sub_14027DF60   endp

algn_14027E62E:                         ; DATA XREF: .pdata:00000001400CE970↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027E640   proc near               ; CODE XREF: sub_140263560+55A↑p
                                        ; sub_14065BC40+3AC↓p ...

arg_0           = qword ptr  8
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_0], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 20h
                mov     r12d, edx
                mov     r14, rcx
                mov     r15, 0FFFFFFFFFFFFFFFFh
                mov     r13, 7FFFFFFFFFFFFFFFh

loc_14027E66B:                          ; CODE XREF: sub_14027E640+3CD↓j
                mov     rdi, 0FFFFF68000000000h

loc_14027E675:                          ; CODE XREF: sub_14027E640+344↓j
                mov     rbp, 0FFFFF6FB7DBED000h
                mov     rsi, 0FFFFF6FB7DBED7F8h
                nop     dword ptr [rax+00000000h]

loc_14027E690:                          ; CODE XREF: sub_14027E640+302↓j
                mov     ebx, 2

loc_14027E695:                          ; CODE XREF: sub_14027E640+2EC↓j
                                        ; sub_14027E640+330↓j
                mov     rcx, r14
                call    sub_1402805F0
                mov     [rsp+58h+arg_18], rax
                mov     rdx, rax
                test    al, 1
                jz      loc_14027E730
                mov     rax, rbp
                lea     rcx, [rsp+58h+arg_18]
                cmp     rcx, rax
                jb      short loc_14027E729
                mov     rax, rsi
                lea     rcx, [rsp+58h+arg_18]
                cmp     rcx, rax
                ja      short loc_14027E729
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027E729
                mov     r8, rdx
                test    dl, 20h
                jz      short loc_14027E6DD
                test    dl, 42h
                jnz     short loc_14027E729

loc_14027E6DD:                          ; CODE XREF: sub_14027E640+96↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r9, [rcx+788h]
                test    r9, r9
                jnz     short loc_14027E704
                mov     rdx, [rsp+58h+arg_18]
                lea     ebp, [r9+6]
                jmp     short loc_14027E775
; ---------------------------------------------------------------------------

loc_14027E704:                          ; CODE XREF: sub_14027E640+B7↑j
                lea     rax, [rsp+58h+arg_18]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r9+rax*8]
                test    al, 20h
                jz      short loc_14027E721
                mov     rdx, r8
                or      rdx, 20h

loc_14027E721:                          ; CODE XREF: sub_14027E640+D8↑j
                test    al, 42h
                jz      short loc_14027E729
                or      rdx, 42h

loc_14027E729:                          ; CODE XREF: sub_14027E640+78↑j
                                        ; sub_14027E640+85↑j ...
                mov     ebp, 6
                jmp     short loc_14027E775
; ---------------------------------------------------------------------------

loc_14027E730:                          ; CODE XREF: sub_14027E640+67↑j
                bt      rdx, 0Ah
                jb      loc_14027EAE6
                bt      rdx, 0Bh
                jnb     loc_14027EAE6
                mov     rcx, rdx
                call    sub_140299080
                test    eax, eax
                jz      loc_14027EAE6
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14027E773
                test    dl, 10h
                jnz     short loc_14027E76F
                not     rax
                and     rdx, rax
                jmp     short loc_14027E773
; ---------------------------------------------------------------------------

loc_14027E76F:                          ; CODE XREF: sub_14027E640+125↑j
                and     rdx, 0FFFFFFFFFFFFFFEFh

loc_14027E773:                          ; CODE XREF: sub_14027E640+120↑j
                                        ; sub_14027E640+12D↑j
                mov     ebp, ebx

loc_14027E775:                          ; CODE XREF: sub_14027E640+C2↑j
                                        ; sub_14027E640+EE↑j
                mov     rax, 0FFFFFFFFFh
                shr     rdx, 0Ch
                and     rdx, rax
                mov     rax, 0FFFFFA8000000028h
                lea     r8, [rdx+rdx*2]
                add     r8, r8
                mov     rax, rax
                mov     rcx, [rax+r8*8]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      loc_14027EAE6
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                lea     rbx, [rax+r8*8]
                mov     rsi, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027E80D
                test    al, 1
                jz      short loc_14027E80D
                cmp     sil, 0Fh
                ja      short loc_14027E80D
                mov     rax, gs:20h
                mov     rdx, r15
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_14027E80D:                          ; CODE XREF: sub_14027E640+197↑j
                                        ; sub_14027E640+19B↑j ...
                mov     [rsp+58h+arg_10], 0
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jnb     short loc_14027E83C
                xchg    ax, ax

loc_14027E820:                          ; CODE XREF: sub_14027E640+1F1↓j
                                        ; sub_14027E640+1FA↓j
                lea     rcx, [rsp+58h+arg_10]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_14027E820
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_14027E820

loc_14027E83C:                          ; CODE XREF: sub_14027E640+1DC↑j
                mov     rax, [rbx+8]
                mov     rcx, 8000000000000000h
                or      rax, rcx
                cmp     rax, r14
                jz      short loc_14027E884
                mov     rcx, rbx
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14027EA86
                mov     rax, rdi
                cmp     r14, rax
                jb      loc_14027EA86
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r14, rax
                ja      loc_14027EA86

loc_14027E884:                          ; CODE XREF: sub_14027E640+210↑j
                movzx   edi, byte ptr [rbx+22h]
                movzx   eax, dil
                and     al, 7
                cmp     ebp, 6
                jnz     loc_14027E989
                cmp     al, bpl
                jz      loc_14027E99B
                lock and [rbx+18h], r13
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027E8FB
                test    al, 1
                jz      short loc_14027E8FB
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14027E8FB
                cmp     sil, 0Fh
                ja      short loc_14027E8FB
                cmp     al, 2
                jb      short loc_14027E8FB
                mov     r10, gs:20h
                mov     rdx, r15
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14027E8FB
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14027E8FB:                          ; CODE XREF: sub_14027E640+26D↑j
                                        ; sub_14027E640+271↑j ...
                movzx   eax, sil
                mov     cr8, rax
                mov     rdi, 0FFFFF68000000000h
                mov     rax, rdi
                mov     rsi, 0FFFFF6FB7DBED7F8h
                mov     ebx, 2
                mov     rbp, 0FFFFF6FB7DBED000h
                cmp     r14, rax
                jb      loc_14027E695
                mov     rbx, 0FFFFF6FFFFFFFFFFh
                mov     rax, rbx
                cmp     r14, rax
                ja      loc_14027E690
                mov     rcx, r14
                shl     rcx, 19h
                mov     rax, rdi
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                mov     rax, rdi
                cmp     rcx, rax
                jb      short loc_14027E976
                mov     rax, rbx
                mov     ebx, 2
                cmp     rcx, rax
                jbe     loc_14027E695

loc_14027E976:                          ; CODE XREF: sub_14027E640+323↑j
                call    sub_140245330
                cmp     eax, 9
                jz      loc_14027EAE6
                jmp     loc_14027E675
; ---------------------------------------------------------------------------

loc_14027E989:                          ; CODE XREF: sub_14027E640+251↑j
                sub     al, 2
                cmp     al, 2
                ja      short loc_14027E9AA
                mov     rax, [rbx+18h]
                shr     rax, 3Eh
                test    al, 1
                jnz     short loc_14027E9AA

loc_14027E99B:                          ; CODE XREF: sub_14027E640+25A↑j
                mov     rcx, r14
                call    sub_1402805F0
                cmp     [rsp+58h+arg_18], rax
                jz      short loc_14027EA12

loc_14027E9AA:                          ; CODE XREF: sub_14027E640+34D↑j
                                        ; sub_14027E640+359↑j
                lock and [rbx+18h], r13
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027EA05
                test    al, 1
                jz      short loc_14027EA05
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14027EA05
                cmp     sil, 0Fh
                ja      short loc_14027EA05
                cmp     al, 2
                jb      short loc_14027EA05
                mov     r10, gs:20h
                mov     rdx, r15
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14027EA05
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14027EA05:                          ; CODE XREF: sub_14027E640+377↑j
                                        ; sub_14027E640+37B↑j ...
                movzx   eax, sil
                mov     cr8, rax
                jmp     loc_14027E66B
; ---------------------------------------------------------------------------

loc_14027EA12:                          ; CODE XREF: sub_14027E640+368↑j
                movzx   ecx, byte ptr [rbx+23h]
                test    cl, 8
                jz      short loc_14027EA22
                mov     eax, 5
                jmp     short loc_14027EA27
; ---------------------------------------------------------------------------

loc_14027EA22:                          ; CODE XREF: sub_14027E640+3D9↑j
                mov     eax, ecx
                and     eax, 7

loc_14027EA27:                          ; CODE XREF: sub_14027E640+3E0↑j
                cmp     r12d, eax
                jz      short loc_14027EA86
                jb      short loc_14027EA86
                and     dil, 7
                cmp     dil, 2
                jnz     short loc_14027EA79
                test    eax, eax
                jnz     short loc_14027EA6C
                mov     eax, [rbx+10h]
                bt      rax, 0Ah
                jb      short loc_14027EA6C
                mov     rax, cs:qword_140C4E4C8
                mov     rcx, [rbx+28h]
                mov     rdx, [rbx+10h]
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rcx, [rax+rcx*8]
                call    sub_14031B1B0
                test    eax, eax
                jnz     short loc_14027EA86

loc_14027EA6C:                          ; CODE XREF: sub_14027E640+3FA↑j
                                        ; sub_14027E640+404↑j
                mov     edx, r12d
                mov     rcx, rbx
                call    sub_140213950
                jmp     short loc_14027EA86
; ---------------------------------------------------------------------------

loc_14027EA79:                          ; CODE XREF: sub_14027E640+3F6↑j
                movzx   eax, cl
                xor     al, r12b
                and     al, 7
                xor     al, cl
                mov     [rbx+23h], al

loc_14027EA86:                          ; CODE XREF: sub_14027E640+21C↑j
                                        ; sub_14027E640+228↑j ...
                lock and [rbx+18h], r13
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14027EADE
                test    al, 1
                jz      short loc_14027EADE
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14027EADE
                cmp     sil, 0Fh
                ja      short loc_14027EADE
                cmp     al, 2
                jb      short loc_14027EADE
                mov     r9, gs:20h
                movzx   ecx, sil
                inc     ecx
                shl     r15, cl
                mov     r8, [r9+84B8h]
                movzx   eax, r15w
                not     eax
                mov     edx, [r8+14h]
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_14027EADE
                mov     rcx, r9
                call    sub_1403F2EC4

loc_14027EADE:                          ; CODE XREF: sub_14027E640+453↑j
                                        ; sub_14027E640+457↑j ...
                movzx   eax, sil
                mov     cr8, rax

loc_14027EAE6:                          ; CODE XREF: sub_14027E640+F5↑j
                                        ; sub_14027E640+100↑j ...
                mov     rbx, [rsp+58h+arg_0]
                add     rsp, 20h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027E640   endp

byte_14027EAFC  db 14h dup(0CCh)        ; DATA XREF: .pdata:00000001400CE97C↑o

; =============== S U B R O U T I N E =======================================


sub_14027EB10   proc near               ; CODE XREF: sub_140265E70+41A↑p
                                        ; sub_140265E70+AA8↑p ...

var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = byte ptr  18h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 0000000140443044 SIZE 000001E0 BYTES

                mov     rax, rsp
                mov     [rax+18h], r8b
                mov     [rax+10h], edx
                mov     [rax+8], rcx
                push    rbx
                push    rdi
                push    r12
                sub     rsp, 60h
                xor     edi, edi
                mov     rbx, rcx
                mov     r12d, edi
                test    edx, edx
                jz      loc_14027ED4E

loc_14027EB36:                          ; DATA XREF: .rdata:000000014005E630↑o
                                        ; .rdata:000000014005E644↑o ...
                mov     [rax-20h], rbp
                lea     rcx, [rax-58h]
                mov     [rax-28h], rsi
                mov     [rax-30h], r13
                mov     [rax-38h], r14
                mov     [rax-40h], r15
                call    sub_1402433C0
                mov     [rsp+78h+arg_18], eax
                mov     rcx, 0C000000000000000h
                mov     rsi, 0FFFFFFFFFh
                mov     r14, 0FFFFFA8000000000h
                nop     dword ptr [rax+rax+00000000h]

loc_14027EB80:                          ; CODE XREF: sub_14027EB10+21F↓j
                mov     rbx, [rbx+r12*8]
                mov     [rsp+78h+var_58], rdi
                movzx   eax, byte ptr [rbx+22h]
                and     [rbx+18h], rcx
                and     al, 0FAh
                or      al, 2
                mov     [rbx+20h], di
                mov     [rbx+22h], al
                lea     rax, [rbx+10h]
                mov     rcx, rax
                mov     [rsp+78h+var_50], rax
                call    sub_1402805F0
                mov     rdx, [rbx+28h]
                mov     rdi, rax
                mov     rbp, [rbx+8]
                and     rdx, rsi
                shr     rdi, 5
                mov     r8d, 4
                and     edi, 1Fh
                lea     rcx, [rdx+rdx*2]
                add     rcx, rcx
                mov     rax, r14
                movzx   eax, byte ptr [rax+rcx*8+22h]
                shr     eax, 6
                test    eax, eax
                jz      loc_14044304F
                cmp     eax, 3
                jz      loc_14044304F
                cmp     eax, 2
                jz      loc_140443044

loc_14027EBF4:                          ; CODE XREF: sub_14027EB10+1C453A↓j
                                        ; sub_14027EB10+1C4545↓j
                or      r8d, 0A0000000h
                xor     ecx, ecx
                call    sub_140280E60
                mov     r13, gs:20h
                mov     rbx, rax
                mov     r14, [r13+7FF8h]
                test    r14, r14
                jz      loc_14044305A
                xor     r9d, r9d
                lea     rcx, [r14+30A0h]
                lea     edx, [r9+3]
                lea     r8d, [r9+1]
                call    sub_140292240
                mov     rsi, rax
                mov     r15, rax
                mov     rax, 7FFFFFFFF8h
                shr     rsi, 9
                and     rsi, rax
                mov     rax, 0FFFFF68000000000h
                mov     rcx, rax
                add     rsi, rcx
                mov     [r14+3038h], rsi
                test    r15, r15
                jz      loc_14044305A

loc_14027EC6C:                          ; CODE XREF: sub_14027EB10+1C458C↓j
                mov     rcx, rsi
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_1404430A1

loc_14027EC7C:                          ; CODE XREF: sub_14027EB10+1C45E3↓j
                                        ; sub_14027EB10+1C45EC↓j ...
                mov     [rsi], rbx

loc_14027EC7F:                          ; CODE XREF: sub_14027EB10+1C45C4↓j
                shr     rbp, 3
                and     ebp, 1FFh
                lea     rsi, [r15+rbp*8]
                mov     rcx, rsi
                call    sub_1402805F0
                cmp     [rsp+78h+arg_18], 0
                mov     [rsp+78h+var_58], rax
                jnz     loc_140443114

loc_14027ECA8:                          ; CODE XREF: sub_14027EB10+1C460E↓j
                                        ; sub_14027EB10+1C462B↓j ...
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rcx, rax
                mov     edx, edi
                call    sub_1402810E0
                mov     rcx, rsi
                mov     [rsp+78h+var_58], rax
                mov     rdi, rax
                mov     rbx, rax
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_1404431AF

loc_14027ECDB:                          ; CODE XREF: sub_14027EB10+1C46F2↓j
                                        ; sub_14027EB10+1C46FC↓j ...
                mov     [rsi], rbx

loc_14027ECDE:                          ; CODE XREF: sub_14027EB10+1C46D3↓j
                mov     r8d, 80000000h
                mov     dl, 11h
                mov     rcx, rsi
                call    sub_1402432B0
                mov     rcx, [rsp+78h+var_50]
                xor     edx, edx
                call    sub_1402C75A0
                mov     ecx, [rsp+78h+arg_8]
                inc     r12
                mov     rbx, [rsp+78h+arg_0]
                cmp     r12, rcx
                mov     rcx, 0C000000000000000h
                mov     r14, 0FFFFFA8000000000h
                mov     rsi, 0FFFFFFFFFh
                mov     edi, edx
                jb      loc_14027EB80
                mov     r15, [rsp+78h+var_40]
                mov     r14, [rsp+78h+var_38]
                mov     r13, [rsp+78h+var_30]
                mov     rsi, [rsp+78h+var_28]
                mov     rbp, [rsp+78h+var_20]

loc_14027ED4E:                          ; CODE XREF: sub_14027EB10+20↑j
                                        ; DATA XREF: .pdata:00000001400CE994↑o ...
                movzx   r9d, [rsp+78h+arg_10]
                mov     rdx, rbx
                mov     r8d, [rsp+78h+arg_8]
                xor     ecx, ecx
                call    sub_140278930
                add     rsp, 60h
                pop     r12
                pop     rdi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027EB10   endp

algn_14027ED73:                         ; DATA XREF: .pdata:00000001400CE9A0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027ED80   proc near               ; DATA XREF: .rdata:000000014005E6C0↑o
                                        ; .pdata:00000001400CE9AC↑o ...

var_A08         = dword ptr -0A08h
var_A00         = qword ptr -0A00h
var_9F8         = qword ptr -9F8h
var_9E8         = byte ptr -9E8h
var_9E0         = qword ptr -9E0h
var_9D8         = qword ptr -9D8h
var_9D0         = qword ptr -9D0h
var_9C8         = dword ptr -9C8h
var_9C0         = qword ptr -9C0h
var_9B8         = qword ptr -9B8h
var_9B0         = qword ptr -9B0h
var_9A8         = qword ptr -9A8h
var_9A0         = qword ptr -9A0h
var_998         = dword ptr -998h
var_990         = qword ptr -990h
var_988         = qword ptr -988h
var_980         = qword ptr -980h
var_978         = qword ptr -978h
var_970         = qword ptr -970h
var_968         = qword ptr -968h
var_960         = qword ptr -960h
var_958         = qword ptr -958h
var_950         = qword ptr -950h
var_948         = qword ptr -948h
var_940         = xmmword ptr -940h
var_930         = xmmword ptr -930h
var_920         = xmmword ptr -920h
var_908         = dword ptr -908h
var_904         = word ptr -904h
var_902         = word ptr -902h
var_900         = qword ptr -900h
var_8F8         = qword ptr -8F8h
var_8F0         = qword ptr -8F0h
var_8E8         = byte ptr -8E8h
var_848         = byte ptr -848h
var_48          = qword ptr -48h
arg_20          = qword ptr  28h
arg_28          = qword ptr  30h
arg_30          = qword ptr  38h

; FUNCTION CHUNK AT 0000000140418A20 SIZE 0000002C BYTES
; FUNCTION CHUNK AT 0000000140443224 SIZE 00000277 BYTES

; __unwind { // __GSHandlerCheck_SEH
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 9F0h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+0A28h+var_48], rax
                mov     r15, r9
                mov     r14, r8
                mov     edi, edx
                mov     [rsp+0A28h+var_9C8], edx
                mov     [rsp+0A28h+var_960], rcx
                mov     r12, [rsp+0A28h+arg_20]
                mov     [rsp+0A28h+var_958], r12
                mov     rbx, [rsp+0A28h+arg_28]
                mov     [rsp+0A28h+var_950], rbx
                mov     r13, [rsp+0A28h+arg_30]
                mov     [rsp+0A28h+var_948], r13
                xor     esi, esi
                mov     [rsp+0A28h+var_9A0], rsi
                mov     [rsp+0A28h+var_998], esi
                mov     dword ptr [rsp+0A28h+var_9E0], esi
                xorps   xmm0, xmm0
                movups  [rsp+0A28h+var_940], xmm0
                movups  [rsp+0A28h+var_930], xmm0
                movups  [rsp+0A28h+var_920], xmm0
                xor     eax, eax
                mov     [rsp+0A28h+var_902], ax
                xor     edx, edx
                mov     r8d, 98h
                lea     rcx, [rsp+0A28h+var_8E8]
                call    memset
                mov     [rsp+0A28h+var_900], 14h
                mov     eax, 1
                mov     [rsp+0A28h+var_908], eax
                mov     [rsp+0A28h+var_904], si
                mov     [rsp+0A28h+var_8F8], rsi
                mov     [rsp+0A28h+var_8F0], rsi
                test    edi, 0FFFFFFFEh
                jnz     loc_140443224
                mov     rax, gs:188h
                mov     rsi, [rax+0B8h]
                movzx   edi, byte ptr [rax+232h]

loc_14027EE8B:                          ; DATA XREF: .rdata:000000014005E698↑o
;   __try { // __except at loc_14027EF5A
                test    dil, dil
                jz      loc_14027EF4D
                mov     rax, 7FFFFFFEFFFFh
                cmp     r14, rax
                ja      short loc_14027EF1B
                mov     rdx, 7FFFFFFF0000h
                mov     rax, rdx
                sub     rax, r14
                cmp     rax, r15
                jb      short loc_14027EF25
                mov     rcx, rbx
                cmp     rbx, rdx
                jnb     short loc_14027EF2F

loc_14027EEC0:                          ; CODE XREF: sub_14027ED80+1B2↓j
                mov     rax, [rcx]
                mov     [rcx], rax
                mov     rdx, [rbx]
                mov     [rsp+0A28h+var_990], rdx
                test    rdx, rdx
                jz      short loc_14027EF34
                mov     rax, 1FFFFFFFFFFFFFFFh
                cmp     rdx, rax
                ja      short loc_14027EF3E
                lea     rdx, ds:0[rdx*8]
                mov     r8d, 8
                mov     rcx, r12
                call    ProbeForWrite
                mov     rcx, r13
                mov     rax, 7FFFFFFF0000h
                cmp     r13, rax
                jnb     short loc_14027EF48

loc_14027EF0D:                          ; CODE XREF: sub_14027ED80+1CB↓j
                mov     eax, [rcx]
                mov     [rcx], eax
                mov     rcx, [rsp+0A28h+var_990]
                jmp     short loc_14027EF58
; ---------------------------------------------------------------------------

loc_14027EF1B:                          ; CODE XREF: sub_14027ED80+121↑j
                mov     eax, 0C00000F1h
                jmp     loc_14027F3F2
; ---------------------------------------------------------------------------

loc_14027EF25:                          ; CODE XREF: sub_14027ED80+136↑j
                mov     eax, 0C00000F2h
                jmp     loc_14027F3F2
; ---------------------------------------------------------------------------

loc_14027EF2F:                          ; CODE XREF: sub_14027ED80+13E↑j
                mov     rcx, rdx
                jmp     short loc_14027EEC0
; ---------------------------------------------------------------------------

loc_14027EF34:                          ; CODE XREF: sub_14027ED80+154↑j
                mov     eax, 0C00000F3h
                jmp     loc_14027F3F2
; ---------------------------------------------------------------------------

loc_14027EF3E:                          ; CODE XREF: sub_14027ED80+163↑j
                mov     eax, 0C00000F3h
                jmp     loc_14027F3F2
; ---------------------------------------------------------------------------

loc_14027EF48:                          ; CODE XREF: sub_14027ED80+18B↑j
                mov     rcx, rax
                jmp     short loc_14027EF0D
; ---------------------------------------------------------------------------

loc_14027EF4D:                          ; CODE XREF: sub_14027ED80+10E↑j
                mov     rcx, [rbx]
                mov     [rsp+0A28h+var_990], rcx

loc_14027EF58:                          ; CODE XREF: sub_14027ED80+199↑j
                jmp     short loc_14027EF5F
;   } // starts at 14027EE8B
; ---------------------------------------------------------------------------

loc_14027EF5A:                          ; DATA XREF: .rdata:000000014005E698↑o
;   __except(loc_140418A20) // owned by 14027EE8B
                jmp     loc_14027F3F2
; ---------------------------------------------------------------------------

loc_14027EF5F:                          ; CODE XREF: sub_14027ED80:loc_14027EF58↑j
                lea     rax, [rsp+0A28h+var_848]
                mov     [rsp+0A28h+var_9A8], rax
                lea     rdx, ds:0[rcx*8]
                cmp     rcx, 100h
                ja      loc_14027F4A7

loc_14027EF84:                          ; CODE XREF: sub_14027ED80+742↓j
                mov     r12d, 1
                xor     r13d, r13d
                mov     [rsp+0A28h+var_9B8], r13
                mov     [rsp+0A28h+var_988], rax
                mov     [rsp+0A28h+var_968], r13
                mov     ebx, r13d
                mov     rax, [rsp+0A28h+var_960]
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jnz     loc_140443238
                mov     rax, rsi

loc_14027EFBA:                          ; CODE XREF: sub_14027ED80+1C4500↓j
                mov     [rsp+0A28h+var_9A0], rax
                mov     [rsp+0A28h+var_9D8], r13
                lea     rdi, [r14-1]
                add     rdi, r15
                cmp     r14, rdi
                ja      loc_140443285
                cmp     rsi, rax
                jnz     loc_14044328F

loc_14027EFE0:                          ; CODE XREF: sub_14027ED80+1C452A↓j
                add     rax, 680h
                mov     [rsp+0A28h+var_9C0], rax
                mov     rsi, r14
                shr     rsi, 9
                mov     r8, 7FFFFFFFF8h
                and     rsi, r8
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                add     rsi, rax
                mov     rcx, rdi
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     [rsp+0A28h+var_980], rcx
                lea     r8, [rsp+0A28h+var_9E0]
                xor     edx, edx
                mov     rcx, r14
                call    sub_140232930
                mov     r13, rax
                mov     [rsp+0A28h+var_970], rax
                test    rax, rax
                jz      loc_1404432AF
                mov     [rsp+0A28h+var_968], rax
                mov     r8d, [rax+30h]
                mov     eax, r8d
                and     eax, 300000h
                cmp     eax, 300000h
                jnz     loc_14027F498
                movzx   ecx, byte ptr [r13+21h]
                shl     rcx, 20h
                mov     eax, [r13+1Ch]
                or      rcx, rax
                shl     rcx, 0Ch
                or      rcx, 0FFFh
                cmp     rdi, rcx
                ja      loc_14027F498
                mov     rcx, r13
                call    sub_14026B3E0
                mov     r12, rax
                mov     [rsp+0A28h+var_9B0], rax
                cmp     rax, 1
                ja      loc_1404432C9

loc_14027F0A7:                          ; CODE XREF: sub_14027ED80+1C456A↓j
                mov     ecx, r8d
                mov     eax, r8d
                and     eax, 500000h
                cmp     eax, 500000h
                jnz     loc_14027F48D
                shr     rcx, 12h
                and     ecx, 3
                lea     rax, qword_14002DE90
                mov     r12d, 10h
                cmp     [rax+rcx*8], r12
                mov     eax, 1
                cmovnz  r12d, eax

loc_14027F0DE:                          ; CODE XREF: sub_14027ED80+713↓j
                mov     edx, 4
                mov     rcx, r13
                call    sub_1402EBB3C
                mov     [rsp+0A28h+var_9D0], rax
                movzx   edx, byte ptr [r13+20h]
                shl     rdx, 20h
                mov     ecx, [r13+18h]
                or      rdx, rcx
                shr     r14, 0Ch
                sub     r14, rdx
                xor     edx, edx
                mov     rax, r14
                mov     r14, [rsp+0A28h+var_9B0]
                div     r14
                mov     r15, rax
                mov     rdi, [rsp+0A28h+var_9C0]
                mov     rcx, rdi
                call    sub_140231340
                mov     [rsp+0A28h+var_9E8], al
                cmp     rsi, [rsp+0A28h+var_980]
                ja      loc_14027F31E

loc_14027F136:                          ; CODE XREF: sub_14027ED80+593↓j
                mov     rdi, [rsp+0A28h+var_9B8]
                test    rdi, rdi
                jnz     loc_14027F4F8
                mov     rdi, [rsp+0A28h+var_9C0]

loc_14027F149:                          ; CODE XREF: sub_14027ED80+79E↓j
                mov     rcx, rdi
                call    sub_14029A5E0
                test    eax, eax
                jnz     loc_14027F523
                call    sub_140536BA8
                test    eax, eax
                jnz     loc_14027F523

loc_14027F166:                          ; CODE XREF: sub_14027ED80+7B8↓j
                lea     rax, [rsp+0A28h+var_998]
                mov     [rsp+0A28h+var_A00], rax
                mov     eax, 1
                mov     [rsp+0A28h+var_A08], eax
                movzx   r9d, [rsp+0A28h+var_9E8]
                xor     r8d, r8d
                mov     rdi, [rsp+0A28h+var_980]
                mov     rdx, rdi
                mov     rcx, rsi
                call    sub_1402A7DC0
                mov     rcx, rax
                test    rax, rax
                jz      loc_14027F565
                mov     rdx, rax
                shr     rdx, 9
                mov     rax, 7FFFFFFFF8h
                and     rdx, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     rdx, rax
                mov     [rsp+0A28h+var_9B8], rdx

loc_14027F1CD:                          ; CODE XREF: sub_14027ED80+7E9↓j
                sub     rcx, rsi
                sar     rcx, 3
                xor     edx, edx
                mov     rax, rcx
                div     r14
                mov     rdi, rax
                or      ebx, 4
                mov     rcx, r13
                call    sub_14034282C
                mov     r11, [rsp+0A28h+var_9D0]
                test    rdi, rdi
                jnz     loc_14027F540

loc_14027F1F8:                          ; CODE XREF: sub_14027ED80+7E0↓j
                mov     rax, [rsp+0A28h+var_980]
                cmp     rsi, rax
                ja      loc_14027F319
                mov     r10, rax
                mov     [rsp+0A28h+var_9E0], rax
                mov     ecx, [rsp+0A28h+var_998]
                test    ecx, ecx
                jnz     loc_140443360
                mov     rdi, r12

loc_14027F223:                          ; CODE XREF: sub_14027ED80+1C469D↓j
                xor     edx, edx
                mov     rax, rdi
                div     r14
                mov     r9, rax
                mov     [rsp+0A28h+var_978], rax
                cmp     rsi, r10
                ja      loc_14027F2D2
                nop

loc_14027F240:                          ; CODE XREF: sub_14027ED80+544↓j
                mov     rcx, rsi
                call    sub_14027F590
                mov     r13, rax
                and     ebx, 0FFFFFFFDh
                mov     rdi, rsi
                mov     rdx, [r11+10h]
                bt      [rdx], r15
                setb    cl
                cmp     cl, 1
                jz      loc_14027F56E
                xor     r14d, r14d

loc_14027F268:                          ; CODE XREF: sub_14027ED80+50F↓j
                mov     rcx, rdi
                call    sub_1402805F0
                test    al, 42h
                setnz   cl
                test    al, 1
                setnz   al
                test    al, cl
                jnz     loc_14027F416

loc_14027F282:                          ; CODE XREF: sub_14027ED80+6B4↓j
                add     rdi, 8
                inc     r14d
                mov     eax, r14d
                cmp     rax, r12
                jb      short loc_14027F268

loc_14027F291:                          ; CODE XREF: sub_14027ED80+69E↓j
                                        ; sub_14027ED80+1C46DE↓j
                mov     r9, [rsp+0A28h+var_978]
                mov     r10, [rsp+0A28h+var_9E0]
                mov     r11, [rsp+0A28h+var_9D0]
                mov     r14, [rsp+0A28h+var_9B0]

loc_14027F2A8:                          ; CODE XREF: sub_14027ED80+7F6↓j
                test    bl, 2
                jnz     loc_14027F439

loc_14027F2B1:                          ; CODE XREF: sub_14027ED80+6BE↓j
                                        ; sub_14027ED80+705↓j
                add     r15, r9
                lea     rsi, [rsi+r12*8]
                test    rsi, 0FFFh
                jz      short loc_14027F2CA
                cmp     rsi, r10
                jbe     loc_14027F240

loc_14027F2CA:                          ; CODE XREF: sub_14027ED80+53F↑j
                mov     r13, [rsp+0A28h+var_970]

loc_14027F2D2:                          ; CODE XREF: sub_14027ED80+4B9↑j
                mov     dl, 2
                mov     rcx, r13
                call    sub_140345A70
                and     ebx, 0FFFFFFFBh
                mov     rcx, rsi
                call    sub_14027F590
                mov     rsi, rax
                shr     rsi, 9
                mov     rax, 7FFFFFFFF8h
                and     rsi, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     rsi, rax
                cmp     rsi, [rsp+0A28h+var_980]
                jbe     loc_14027F136

loc_14027F319:                          ; CODE XREF: sub_14027ED80+483↑j
                                        ; sub_14027ED80+773↓j ...
                mov     rdi, [rsp+0A28h+var_9C0]

loc_14027F31E:                          ; CODE XREF: sub_14027ED80+3B0↑j
                lea     rcx, [rsp+0A28h+var_908]
                call    sub_14028EDB0
                test    bl, 4
                jnz     loc_14027F4DC

loc_14027F334:                          ; CODE XREF: sub_14027ED80+766↓j
                mov     rax, [rsp+0A28h+var_9B8]
                test    rax, rax
                jz      short loc_14027F349
                mov     rdx, rax
                mov     rcx, rdi
                call    sub_1403B6AB0

loc_14027F349:                          ; CODE XREF: sub_14027ED80+5BC↑j
                movzx   edx, [rsp+0A28h+var_9E8]
                mov     rcx, rdi
                call    sub_140226960
                xor     edi, edi
                mov     r12, [rsp+0A28h+var_9B0]
                mov     r13, [rsp+0A28h+var_9D8]

loc_14027F362:                          ; CODE XREF: sub_14027ED80+722↓j
                                        ; sub_14027ED80+1C450A↓j ...
                mov     rcx, [rsp+0A28h+var_968]
                test    rcx, rcx
                jz      short loc_14027F374
                call    sub_140232610

loc_14027F374:                          ; CODE XREF: sub_14027ED80+5ED↑j
                test    bl, 1
                jnz     loc_140443463

loc_14027F37D:                          ; CODE XREF: sub_14027ED80+1C46F1↓j
                cmp     [rsp+0A28h+var_960], 0FFFFFFFFFFFFFFFFh
                jnz     loc_140443476

loc_14027F38C:                          ; CODE XREF: sub_14027ED80+1C4709↓j
                test    edi, edi
                jnz     loc_14044348E

loc_14027F394:                          ; DATA XREF: .rdata:000000014005E6A8↑o
;   __try { // __except at loc_14027F3D5
                mov     rcx, [rsp+0A28h+var_958]
                mov     rbx, [rsp+0A28h+var_9A8]
                test    rcx, rcx
                jz      short loc_14027F3C4
                lea     r8, ds:0[r13*8]
                mov     rdx, rbx
                call    memmove
                mov     rax, [rsp+0A28h+var_950]
                mov     [rax], r13

loc_14027F3C4:                          ; CODE XREF: sub_14027ED80+627↑j
                shl     r12d, 0Ch
                mov     rax, [rsp+0A28h+var_948]
                mov     [rax], r12d
                jmp     short loc_14027F3DF
;   } // starts at 14027F394
; ---------------------------------------------------------------------------

loc_14027F3D5:                          ; DATA XREF: .rdata:000000014005E6A8↑o
;   __except(loc_140418A36) // owned by 14027F394
                mov     edi, eax
                mov     rbx, [rsp+0A28h+var_9A8]

loc_14027F3DF:                          ; CODE XREF: sub_14027ED80+653↑j
                                        ; sub_14027ED80+1C4716↓j
                lea     rax, [rsp+0A28h+var_848]
                cmp     rbx, rax
                jnz     loc_14027F4CD

loc_14027F3F0:                          ; CODE XREF: sub_14027ED80+757↓j
                mov     eax, edi

loc_14027F3F2:                          ; CODE XREF: sub_14027ED80+1A0↑j
                                        ; sub_14027ED80+1AA↑j ...
                mov     rcx, [rsp+0A28h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 9F0h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14027F416:                          ; CODE XREF: sub_14027ED80+4FC↑j
                or      ebx, 2
                test    byte ptr [rsp+0A28h+var_9C8], 1
                jz      loc_14027F291
                lea     rdx, [rsp+0A28h+var_908]
                mov     rcx, rdi
                call    sub_1402A639C
                jmp     loc_14027F282
; ---------------------------------------------------------------------------

loc_14027F439:                          ; CODE XREF: sub_14027ED80+52B↑j
                xor     eax, eax
                test    r9, r9
                jz      loc_14027F2B1
                mov     rcx, r14
                shl     rcx, 0Ch
                mov     rdx, [rsp+0A28h+var_9D8]
                mov     r8, [rsp+0A28h+var_988]
                mov     rdi, [rsp+0A28h+var_990]

loc_14027F460:                          ; CODE XREF: sub_14027ED80+70B↓j
                mov     [r8], r13
                add     r8, 8
                mov     [rsp+0A28h+var_988], r8
                inc     rdx
                mov     [rsp+0A28h+var_9D8], rdx
                cmp     rdx, rdi
                jz      short loc_14027F4EB
                inc     rax
                add     r13, rcx
                cmp     rax, r9
                jnb     loc_14027F2B1
                jmp     short loc_14027F460
; ---------------------------------------------------------------------------

loc_14027F48D:                          ; CODE XREF: sub_14027ED80+337↑j
                mov     r12d, 1
                jmp     loc_14027F0DE
; ---------------------------------------------------------------------------

loc_14027F498:                          ; CODE XREF: sub_14027ED80+2E3↑j
                                        ; sub_14027ED80+307↑j
                mov     r13, [rsp+0A28h+var_9D8]

loc_14027F49D:                          ; CODE XREF: sub_14027ED80+1C4544↓j
                mov     edi, 0C00000EFh
                jmp     loc_14027F362
; ---------------------------------------------------------------------------

loc_14027F4A7:                          ; CODE XREF: sub_14027ED80+1FE↑j
                mov     ecx, 41h ; 'A'
                mov     r8d, 63476D4Dh
                call    sub_140268720
                mov     [rsp+0A28h+var_9A8], rax
                test    rax, rax
                jnz     loc_14027EF84
                jmp     loc_14044322E
; ---------------------------------------------------------------------------

loc_14027F4CD:                          ; CODE XREF: sub_14027ED80+66A↑j
                xor     edx, edx
                mov     rcx, rbx
                call    ExFreePoolWithTag
                jmp     loc_14027F3F0
; ---------------------------------------------------------------------------

loc_14027F4DC:                          ; CODE XREF: sub_14027ED80+5AE↑j
                mov     dl, 2
                mov     rcx, r13
                call    sub_140345A70
                jmp     loc_14027F334
; ---------------------------------------------------------------------------

loc_14027F4EB:                          ; CODE XREF: sub_14027ED80+6FA↑j
                mov     r13, [rsp+0A28h+var_970]
                jmp     loc_14027F319
; ---------------------------------------------------------------------------

loc_14027F4F8:                          ; CODE XREF: sub_14027ED80+3BE↑j
                lea     rcx, [rsp+0A28h+var_908]
                call    sub_14028EDB0
                mov     rdx, rdi
                mov     rdi, [rsp+0A28h+var_9C0]
                mov     rcx, rdi
                call    sub_1403B6AB0
                mov     [rsp+0A28h+var_9B8], 0
                jmp     loc_14027F149
; ---------------------------------------------------------------------------

loc_14027F523:                          ; CODE XREF: sub_14027ED80+3D3↑j
                                        ; sub_14027ED80+3E0↑j
                movzx   edx, [rsp+0A28h+var_9E8]
                mov     rcx, rdi
                call    sub_140226960
                mov     rcx, rdi
                call    sub_140231340
                jmp     loc_14027F166
; ---------------------------------------------------------------------------
                align 20h

loc_14027F540:                          ; CODE XREF: sub_14027ED80+472↑j
                                        ; sub_14027ED80+7DE↓j
                mov     rcx, [r11+10h]
                bt      [rcx], r15
                setb    al
                cmp     al, 1
                jz      loc_1404432FF

loc_14027F553:                          ; CODE XREF: sub_14027ED80+1C45DB↓j
                inc     r15
                lea     rsi, [rsi+r14*8]
                sub     rdi, 1
                jnz     short loc_14027F540
                jmp     loc_14027F1F8
; ---------------------------------------------------------------------------

loc_14027F565:                          ; CODE XREF: sub_14027ED80+41E↑j
                lea     rcx, [rdi+8]
                jmp     loc_14027F1CD
; ---------------------------------------------------------------------------

loc_14027F56E:                          ; CODE XREF: sub_14027ED80+4DF↑j
                or      ebx, 2
                test    byte ptr [rsp+0A28h+var_9C8], 1
                jz      loc_14027F2A8
                jmp     loc_140443422
; } // starts at 14027ED80
sub_14027ED80   endp

; ---------------------------------------------------------------------------
algn_14027F581:                         ; DATA XREF: .rdata:000000014005E6C0↑o
                                        ; .pdata:00000001400CE9AC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14027F590   proc near               ; CODE XREF: sub_140227A20+266↑p
                                        ; sub_140258D20+189↑p ...
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                cmp     rcx, rax
                jb      short loc_14027F5CE
                mov     r8, 0FFFFF6FFFFFFFFFFh

loc_14027F5AC:                          ; CODE XREF: sub_14027F590+3C↓j
                mov     rax, r8
                cmp     rcx, rax
                ja      short loc_14027F5CE
                shl     rcx, 19h
                mov     rax, rdx
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                mov     rax, rdx
                cmp     rcx, rax
                jnb     short loc_14027F5AC

loc_14027F5CE:                          ; CODE XREF: sub_14027F590+10↑j
                                        ; sub_14027F590+22↑j
                mov     rax, rcx
                retn
sub_14027F590   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14027F5D3:                         ; DATA XREF: .pdata:00000001400CE9B8↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14027F5E0   proc near               ; DATA XREF: .rdata:000000014005E6FC↑o
                                        ; .rdata:000000014005E778↑o ...

var_48          = qword ptr -48h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                push    r12
                push    r13
                sub     rsp, 58h
                mov     r13, [rcx+0A8h]
                mov     r12, rdx
                mov     rax, [r13+10h]
                mov     [rsp+68h+var_40], rax
                test    r8d, r8d
                jnz     loc_14027FDC6
                mov     rax, [r13+18h]

loc_14027F608:                          ; DATA XREF: .rdata:000000014005E6FC↑o
                                        ; .rdata:000000014005E710↑o ...
                mov     [rsp+68h+arg_8], rbx
                xor     ebx, ebx
                mov     [rsp+68h+var_18], rbp
                mov     ebp, ebx

loc_14027F616:                          ; DATA XREF: .rdata:000000014005E710↑o
                                        ; .rdata:000000014005E72C↑o ...
                mov     [rsp+68h+var_20], rsi
                mov     esi, ebx

loc_14027F61D:                          ; DATA XREF: .rdata:000000014005E72C↑o
                                        ; .rdata:000000014005E740↑o ...
                mov     [rsp+68h+var_28], rdi
                mov     edi, ebx
                mov     [rsp+68h+var_30], r14
                mov     [rsp+68h+var_38], r15
                mov     r15d, ebx
                mov     [rsp+68h+var_48], rax

loc_14027F636:                          ; CODE XREF: sub_14027F5E0+9F↓j
                mov     rcx, r12
                call    sub_1402805F0
                mov     r14, rax
                mov     [rsp+68h+arg_18], rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                test    r14b, 1
                jnz     loc_14027F787
                bt      r14, 0Ah
                jb      loc_14027FD55
                bt      r14, 0Bh
                jnb     short loc_14027F6E0
                xor     edx, edx
                mov     rcx, r12
                call    sub_1402A886C
                mov     r15, rax
                test    rax, rax
                jz      short loc_14027F636
                movzx   eax, byte ptr [rax+22h]
                mov     edi, 1
                test    al, 28h
                jnz     loc_14027FD4B
                mov     rdx, [r15+10h]
                movzx   ecx, dl
                shr     cl, 1
                test    dil, cl
                jz      loc_14027FD4B
                mov     rsi, rdx
                cmp     [r15+20h], bx
                jnz     short loc_14027F6D3
                and     al, 7
                cmp     al, 3
                jnz     short loc_14027F6D3
                xor     edx, edx
                mov     rcx, r15
                call    sub_14022EF40
                and     qword ptr [r15+10h], 0FFFFFFFFFFFFFFFDh
                lea     edx, [rdi+7]
                mov     rcx, r15
                call    sub_140279270
                jmp     loc_14027FD4B
; ---------------------------------------------------------------------------

loc_14027F6D3:                          ; CODE XREF: sub_14027F5E0+CC↑j
                                        ; sub_14027F5E0+D2↑j
                and     rdx, 0FFFFFFFFFFFFFFFDh
                mov     [r15+10h], rdx
                jmp     loc_14027FD4B
; ---------------------------------------------------------------------------

loc_14027F6E0:                          ; CODE XREF: sub_14027F5E0+8D↑j
                movzx   eax, r14b
                shr     al, 1
                test    al, 1
                jz      loc_14027FD4B
                mov     rsi, r14
                mov     rcx, r12
                and     rsi, 0FFFFFFFFFFFFFFFDh
                mov     [rsp+68h+arg_18], rsi
                mov     rbx, rsi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14027F766
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027F737
                cmp     byte ptr cs:word_140C4DE88+1, dil
                mov     edx, 1
                jnz     short loc_14027F768
                test    dl, sil
                jz      short loc_14027F768
                mov     rax, 8000000000000000h
                or      rbx, rax
                jmp     short loc_14027F768
; ---------------------------------------------------------------------------

loc_14027F737:                          ; CODE XREF: sub_14027F5E0+133↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027F766
                test    sil, 1
                jz      short loc_14027F766
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_14027F766:                          ; CODE XREF: sub_14027F5E0+12A↑j
                                        ; sub_14027F5E0+171↑j ...
                xor     edx, edx

loc_14027F768:                          ; CODE XREF: sub_14027F5E0+141↑j
                                        ; sub_14027F5E0+146↑j ...
                mov     [r12], rbx
                mov     rsi, r14
                test    edx, edx
                jz      loc_14027FD4B
                mov     rdx, rbx
                mov     rcx, r12
                call    sub_140349620
                jmp     loc_14027FD4B
; ---------------------------------------------------------------------------

loc_14027F787:                          ; CODE XREF: sub_14027F5E0+77↑j
                mov     r11, 0FFFFF6FB7DBED000h
                mov     rax, r11
                lea     rcx, [rsp+68h+arg_18]
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     rcx, rax
                jb      short loc_14027F81B
                mov     rax, r10
                lea     rcx, [rsp+68h+arg_18]
                cmp     rcx, rax
                ja      short loc_14027F81B
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027F81B
                test    r14b, 20h
                jz      short loc_14027F7D0
                test    r14b, 42h
                jnz     short loc_14027F81B

loc_14027F7D0:                          ; CODE XREF: sub_14027F5E0+1E8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14027F81B
                lea     rax, [rsp+68h+arg_18]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r14
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r14
                test    al, 42h
                mov     r14, rdx
                cmovnz  r14, rdx

loc_14027F81B:                          ; CODE XREF: sub_14027F5E0+1C9↑j
                                        ; sub_14027F5E0+1D9↑j ...
                shr     r14, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     r14, rax
                lea     r14, [r14+r14*2]
                shl     r14, 4
                mov     rax, 0FFFFFA8000000028h
                mov     rax, [r14+rax]
                shr     rax, 32h
                and     eax, 1
                jz      loc_14027FD4B
                mov     rax, 0FFFFFA8000000000h
                lea     r15, [r14+rax]
                mov     rcx, r15
                call    sub_1403F41D8
                mov     rdx, 0FFFFF68000000000h
                test    eax, eax
                jz      short loc_14027F885
                mov     rbx, [r13+8]
                test    rbx, rbx
                jz      loc_14027FD4B
                jmp     loc_14027FCBD
; ---------------------------------------------------------------------------

loc_14027F885:                          ; CODE XREF: sub_14027F5E0+291↑j
                mov     rax, 0FFFFFA8000000008h
                mov     rax, [r14+rax]
                mov     rcx, 8000000000000000h
                or      rax, rcx
                cmp     rax, r12
                jnz     loc_14027FD4B
                mov     edi, 1
                mov     [rsp+68h+arg_10], ebx
                mov     rbx, 0FFFFFA8000000018h
                lock bts qword ptr [r14+rbx], 3Fh ; '?'
                jnb     short loc_14027F90D
                nop     dword ptr [rax+rax+00000000h]

loc_14027F8D0:                          ; CODE XREF: sub_14027F5E0+304↓j
                                        ; sub_14027F5E0+30D↓j
                lea     rcx, [rsp+68h+arg_10]
                call    sub_1402C8C70
                mov     rax, [r14+rbx]
                test    rax, rax
                js      short loc_14027F8D0
                lock bts qword ptr [r14+rbx], 3Fh ; '?'
                jb      short loc_14027F8D0
                mov     r10, 0FFFFF6FB7DBED7F8h
                mov     r11, 0FFFFF6FB7DBED000h
                mov     rdx, 0FFFFF68000000000h

loc_14027F90D:                          ; CODE XREF: sub_14027F5E0+2E6↑j
                mov     r9, 0FFFFFA8000000022h
                test    byte ptr [r14+r9], 8
                jnz     loc_14027FD4B
                mov     rax, 0FFFFFA8000000010h
                mov     rcx, [r14+rax]
                lea     rbx, [r14+rax]
                movzx   eax, cl
                shr     al, 1
                test    dil, al
                jz      short loc_14027F948
                mov     rsi, rcx
                and     rcx, 0FFFFFFFFFFFFFFFDh
                mov     [rbx], rcx

loc_14027F948:                          ; CODE XREF: sub_14027F5E0+35C↑j
                cmp     [r13+90h], ebp
                jnz     loc_14027FA2C
                mov     rax, 0FFFFFA8000000020h
                cmp     [r14+rax], di
                jnz     loc_14027FD4B
                mov     rax, [rsp+68h+var_40]
                movzx   eax, byte ptr [rax+0B8h]
                test    al, 7
                jnz     loc_14027FA2C
                mov     r8, r12
                shl     r8, 19h
                mov     rax, rdx
                shl     rax, 19h
                sub     r8, rax
                mov     rax, 0FFFFFFFFF000h
                sar     r8, 10h
                and     r8, rax
                shr     r8, 9
                mov     rax, rdx
                add     r8, rax
                mov     rdx, [r8]
                mov     rax, r11
                cmp     r8, rax
                jb      short loc_14027FA1C
                mov     rax, r10
                cmp     r8, rax
                ja      short loc_14027FA1C
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027FA1C
                test    dil, dl
                jz      short loc_14027FA1C
                test    dl, 20h
                jz      short loc_14027F9D5
                test    dl, 42h
                jnz     short loc_14027FA1C

loc_14027F9D5:                          ; CODE XREF: sub_14027F5E0+3EE↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14027FA1C
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14027FA1C
                or      rdx, 42h

loc_14027FA1C:                          ; CODE XREF: sub_14027F5E0+3D3↑j
                                        ; sub_14027F5E0+3DB↑j ...
                shr     rdx, 38h
                and     dl, 0Fh
                cmp     dl, 8
                jz      loc_14027FD4B

loc_14027FA2C:                          ; CODE XREF: sub_14027F5E0+36F↑j
                                        ; sub_14027F5E0+398↑j
                test    byte ptr [rsp+68h+arg_18], 42h
                movzx   ecx, byte ptr [r14+r9]
                jnz     short loc_14027FA53
                test    cl, 10h
                jnz     short loc_14027FA53
                mov     eax, [rbx]
                shr     al, 2
                test    dil, al
                jz      loc_14027FD4B
                mov     edi, 3

loc_14027FA53:                          ; CODE XREF: sub_14027F5E0+459↑j
                                        ; sub_14027F5E0+45E↑j
                xor     edx, edx
                test    cl, 10h
                jnz     short loc_14027FA96
                mov     eax, [rbx]
                movzx   edx, cl
                bt      rax, 0Ah
                jb      short loc_14027FA8C
                test    cl, 8
                jnz     short loc_14027FA8C
                xor     r8d, r8d
                mov     rcx, rbx
                lea     edx, [r8+1]
                call    sub_140338C90
                mov     rbp, rax
                mov     r9, 0FFFFFA8000000022h
                movzx   edx, byte ptr [r14+r9]

loc_14027FA8C:                          ; CODE XREF: sub_14027F5E0+484↑j
                                        ; sub_14027F5E0+489↑j
                or      dl, 10h
                mov     [r14+r9], dl
                movzx   ecx, dl

loc_14027FA96:                          ; CODE XREF: sub_14027F5E0+478↑j
                shr     cl, 6
                cmp     cl, 1
                jz      short loc_14027FAAF
                cmp     cl, 2
                jnz     short loc_14027FAA8
                or      edi, 4
                jmp     short loc_14027FAAF
; ---------------------------------------------------------------------------

loc_14027FAA8:                          ; CODE XREF: sub_14027F5E0+4C1↑j
                test    cl, cl
                jnz     short loc_14027FAAF
                or      edi, 8

loc_14027FAAF:                          ; CODE XREF: sub_14027F5E0+4BC↑j
                                        ; sub_14027F5E0+4C6↑j ...
                cmp     dword ptr [r13+20h], 0FFFFFFFFh
                mov     r10, [rsp+68h+var_48]
                jnz     loc_14027FC1A
                mov     eax, [r10+484h]
                mov     rdx, 0FFFFFFFFFFFFFFF7h
                mov     r9, 0FFFFFFFFFFFFF7FFh
                mov     r8, [r10+rax*8+1B20h]
                mov     rax, [rbx]
                mov     rcx, rax
                and     ecx, 400h
                cmovnz  rdx, r9
                and     rdx, rax
                test    rcx, rcx
                jnz     short loc_14027FAF8
                and     rdx, 0FFFFFFFFFFFFFFF9h

loc_14027FAF8:                          ; CODE XREF: sub_14027F5E0+512↑j
                test    r8, r8
                jz      short loc_14027FB70
                movzx   r9d, word ptr [r8+0CCh]
                test    rdx, rdx
                jnz     short loc_14027FB1E
                mov     rcx, 0FFFFFFFF00000000h
                call    sub_14027C6C0
                mov     rdx, rax
                jmp     short loc_14027FB5E
; ---------------------------------------------------------------------------

loc_14027FB1E:                          ; CODE XREF: sub_14027F5E0+528↑j
                mov     rcx, cs:qword_140C4DDC0
                test    rcx, rcx
                jz      short loc_14027FB3E
                test    dl, 10h
                jnz     short loc_14027FB3A
                mov     rax, rcx
                not     rax
                and     rdx, rax
                jmp     short loc_14027FB3E
; ---------------------------------------------------------------------------

loc_14027FB3A:                          ; CODE XREF: sub_14027F5E0+54D↑j
                and     rdx, 0FFFFFFFFFFFFFFEFh

loc_14027FB3E:                          ; CODE XREF: sub_14027F5E0+548↑j
                                        ; sub_14027F5E0+558↑j
                mov     rax, 0FFFFFFFF00000000h
                or      rdx, rax
                test    rcx, rcx
                jz      short loc_14027FB5E
                test    rcx, rdx
                jnz     short loc_14027FB5A
                or      rdx, rcx
                jmp     short loc_14027FB5E
; ---------------------------------------------------------------------------

loc_14027FB5A:                          ; CODE XREF: sub_14027F5E0+573↑j
                or      rdx, 10h

loc_14027FB5E:                          ; CODE XREF: sub_14027F5E0+53C↑j
                                        ; sub_14027F5E0+56E↑j ...
                mov     rax, r9
                shl     rax, 0Ch
                xor     rax, rdx
                and     eax, 0F000h
                xor     rdx, rax

loc_14027FB70:                          ; CODE XREF: sub_14027F5E0+51B↑j
                mov     [rsp+68h+arg_18], rdx
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     rbx, rax
                jb      loc_14027FC17
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rbx, rax
                ja      short loc_14027FC17
                call    sub_140349680
                test    eax, eax
                jz      short loc_14027FBDC
                cmp     byte ptr cs:word_140C4DE88+1, 0
                mov     rax, rdx
                jnz     short loc_14027FBC7
                test    dl, 1
                jz      short loc_14027FBC7
                mov     r8, 8000000000000000h
                or      rax, r8

loc_14027FBC7:                          ; CODE XREF: sub_14027F5E0+5D3↑j
                                        ; sub_14027F5E0+5D8↑j
                mov     rdx, rax
                mov     [rbx], rax
                mov     rcx, rbx
                call    sub_140349620
                mov     r10, [rsp+68h+var_48]
                jmp     short loc_14027FC1A
; ---------------------------------------------------------------------------

loc_14027FBDC:                          ; CODE XREF: sub_14027F5E0+5C7↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14027FC17
                mov     rax, rdx
                mov     r8, 8000000000000000h
                or      rax, r8
                movzx   ecx, dl
                and     cl, 1
                cmovz   rax, rdx
                mov     [rbx], rax
                jmp     short loc_14027FC1A
; ---------------------------------------------------------------------------

loc_14027FC17:                          ; CODE XREF: sub_14027F5E0+5A8↑j
                                        ; sub_14027F5E0+5BE↑j ...
                mov     [rbx], rdx

loc_14027FC1A:                          ; CODE XREF: sub_14027F5E0+4D9↑j
                                        ; sub_14027F5E0+5FA↑j ...
                mov     rax, 0FFFFFA8000000018h
                mov     rcx, 7FFFFFFFFFFFFFFFh
                lock and [r14+rax], rcx
                mov     ecx, [r13+20h]
                and     edi, 0FFFFFFFEh
                mov     rbx, [r13+0]
                cmp     ecx, 0FFFFFFFFh
                jz      short loc_14027FCB3
                mov     r14d, ecx
                shl     r14, 4
                add     r14, r13
                cmp     ecx, 5
                jnb     loc_14027FD4B
                cmp     dword ptr [r14+30h], 0
                jz      loc_14027FD4B
                lea     r9, [r14+28h]
                mov     r8d, 80h
                mov     rdx, r12
                mov     rcx, r10
                call    sub_1402C9190
                mov     rax, cs:qword_140C4DDC0
                mov     rdx, [r14+28h]
                test    rax, rax
                jz      short loc_14027FC91
                test    dl, 10h
                jnz     short loc_14027FC91
                not     rax
                and     rdx, rax

loc_14027FC91:                          ; CODE XREF: sub_14027F5E0+6A4↑j
                                        ; sub_14027F5E0+6A9↑j
                mov     rcx, [r14+28h]
                shr     rdx, 20h
                inc     rdx
                call    sub_1402C98B0
                add     dword ptr [r14+30h], 0FFFFFFFFh
                mov     [r14+28h], rax
                jnz     short loc_14027FCB0
                inc     dword ptr [r13+20h]

loc_14027FCB0:                          ; CODE XREF: sub_14027F5E0+6CA↑j
                or      edi, 10h

loc_14027FCB3:                          ; CODE XREF: sub_14027F5E0+661↑j
                mov     rdx, 0FFFFF68000000000h

loc_14027FCBD:                          ; CODE XREF: sub_14027F5E0+2A0↑j
                mov     r8, [rbx+10h]
                cmp     r8, [rbx+8]
                jnb     loc_14027FD4B
                shl     r12, 19h
                mov     rax, rdx
                shl     rax, 19h
                mov     r9, r8
                sub     r12, rax
                shl     r9, 4
                add     r9, [rbx]
                sar     r12, 10h
                test    r8, r8
                jz      short loc_14027FD00
                mov     r10, [r9-8]
                lea     rdx, [r9-8]
                mov     rcx, [r9-10h]
                add     rcx, r10
                cmp     rcx, r12
                jz      short loc_14027FD17

loc_14027FD00:                          ; CODE XREF: sub_14027F5E0+70A↑j
                lea     rax, [r8+1]
                mov     [rbx+10h], rax
                lea     rdx, [r9+8]
                xor     eax, eax
                mov     [r9], r12
                mov     [rdx], rax
                mov     r10d, eax

loc_14027FD17:                          ; CODE XREF: sub_14027F5E0+71E↑j
                lea     rax, [r10+1000h]
                mov     [rdx], rax
                inc     qword ptr [rbx+18h]
                test    dil, 2
                jz      short loc_14027FD32
                inc     qword ptr [r13+88h]

loc_14027FD32:                          ; CODE XREF: sub_14027F5E0+749↑j
                test    dil, 4
                jz      short loc_14027FD3E
                inc     qword ptr [r13+78h]
                jmp     short loc_14027FD4B
; ---------------------------------------------------------------------------

loc_14027FD3E:                          ; CODE XREF: sub_14027F5E0+756↑j
                test    dil, 8
                jz      short loc_14027FD4B
                inc     qword ptr [r13+80h]

loc_14027FD4B:                          ; CODE XREF: sub_14027F5E0+AC↑j
                                        ; sub_14027F5E0+BE↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh

loc_14027FD55:                          ; CODE XREF: sub_14027F5E0+82↑j
                mov     r14, [rsp+68h+var_30]
                test    dil, 1
                mov     rdi, [rsp+68h+var_28]
                jz      short loc_14027FD6A

loc_14027FD65:                          ; DATA XREF: .pdata:00000001400CE9E8↑o
                                        ; .pdata:00000001400CE9F4↑o
                lock and [r15+18h], rax

loc_14027FD6A:                          ; CODE XREF: sub_14027F5E0+783↑j
                mov     r15, [rsp+68h+var_38]
                mov     rbx, [rsp+68h+var_48]
                test    rsi, rsi
                jz      short loc_14027FD98

loc_14027FD79:                          ; DATA XREF: .pdata:00000001400CE9F4↑o
                                        ; .pdata:00000001400CEA00↑o
                movzx   eax, sil
                mov     rdx, rsi
                and     rdx, 0FFFFFFFFFFFFFFFBh
                shr     al, 2
                and     al, 1
                mov     rcx, rbx
                cmovz   rdx, rsi
                xor     r8d, r8d
                call    sub_14020B2C0

loc_14027FD98:                          ; CODE XREF: sub_14027F5E0+797↑j
                mov     rsi, [rsp+68h+var_20]
                test    rbp, rbp
                jz      short loc_14027FDB0

loc_14027FDA2:                          ; DATA XREF: .pdata:00000001400CEA00↑o
                                        ; .pdata:00000001400CEA0C↑o
                xor     r8d, r8d
                mov     rdx, rbp
                mov     rcx, rbx
                call    sub_14020B2C0

loc_14027FDB0:                          ; CODE XREF: sub_14027F5E0+7C0↑j
                mov     rbx, [rsp+68h+arg_8]
                xor     eax, eax
                mov     rbp, [rsp+68h+var_18]
                add     rsp, 58h
                pop     r13
                pop     r12
                retn
; ---------------------------------------------------------------------------
algn_14027FDC5:                         ; DATA XREF: .pdata:00000001400CEA0C↑o
                                        ; .pdata:00000001400CEA18↑o
                align 2

loc_14027FDC6:                          ; CODE XREF: sub_14027F5E0+1E↑j
                xor     eax, eax
                add     rsp, 58h
                pop     r13
                pop     r12
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14027F5E0   endp

algn_14027FDD2:                         ; DATA XREF: .pdata:00000001400CEA18↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_14027FDE0   proc near               ; CODE XREF: sub_14020A8C8+29D↑p
                                        ; sub_14028C190+178↓p ...

var_A0          = dword ptr -0A0h
var_9C          = byte ptr -9Ch
var_98          = dword ptr -98h
var_94          = dword ptr -94h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = dword ptr -58h
var_38          = qword ptr -38h
arg_10          = qword ptr  20h

; FUNCTION CHUNK AT 000000014044349C SIZE 000004E8 BYTES

; __unwind { // __GSHandlerCheck
                mov     [rsp-8+arg_10], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-27h]
                sub     rsp, 90h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+57h+var_38], rax
                movzx   r12d, r9b
                mov     [rbp+57h+var_9C], r9b
                mov     r9, rdx
                mov     [rbp+57h+var_98], r8d
                shr     r9, 9
                xor     r10d, r10d
                mov     rax, 7FFFFFFFF8h
                mov     [rbp+57h+var_78], r10
                and     r9, rax
                mov     r11, 0FFFFF68000000000h
                mov     rsi, rdx
                mov     r15, rcx
                xor     r14b, r14b
                mov     rax, r11
                add     r9, rax
                mov     [rbp+57h+var_94], r10d
                mov     [rbp+57h+var_90], r9
                mov     rax, r11
                mov     rcx, 0FFFFF6FFFFFFFFFFh
                cmp     rdx, rax
                jnb     loc_1402802A1

loc_14027FE68:                          ; CODE XREF: sub_14027FDE0+4C7↓j
                movzx   eax, byte ptr [r15+0B8h]
                mov     r13d, 1
                mov     edi, r13d
                mov     [rbp+57h+var_A0], r13d

loc_14027FE7D:                          ; CODE XREF: sub_14027FDE0+4E4↓j
                                        ; sub_14027FDE0+1C36C0↓j
                and     al, 7
                cmp     al, 2
                jz      loc_140280367
                lea     rbx, [r15+100h]

loc_14027FE8E:                          ; CODE XREF: sub_14027FDE0+58E↓j
                mov     [rbp+57h+var_80], rbx
                mov     [rbp+57h+var_88], r10
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_1404434A5

loc_14027FEAF:                          ; CODE XREF: sub_14027FDE0+1C36C9↓j
                                        ; sub_14027FDE0+1C36D8↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_1404434D3
                lea     rdx, [rbp+57h+var_88]
                xchg    rdx, [rbx]
                test    rdx, rdx
                jnz     loc_140280478

loc_14027FECC:                          ; CODE XREF: sub_14027FDE0+6AC↓j
                cmp     r12b, 8
                jz      loc_14028040F

loc_14027FED6:                          ; CODE XREF: sub_14027FDE0+645↓j
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rdx, 0FFFFF6FB7DBED7F8h
                mov     r12, 0FFFFF6FB40000000h
                test    r8d, r8d
                jz      loc_140280170

loc_14027FEFD:                          ; CODE XREF: sub_14027FDE0+62A↓j
                test    edi, edi
                jz      loc_1402804C0
                mov     rcx, [r9]
                mov     r12, r10
                mov     rax, rax
                cmp     r9, rax
                jnb     loc_140280305

loc_14027FF17:                          ; CODE XREF: sub_14027FDE0+52B↓j
                                        ; sub_14027FDE0+1C371F↓j ...
                mov     r14, rcx
                shr     rcx, 38h
                shr     r14, 3Ch
                and     cl, 0Fh
                and     r14b, 7
                shl     r14b, 4
                or      r14b, cl
                mov     ecx, r10d
                movzx   ebx, r14b
                and     bl, 0Fh
                cmp     bl, 8
                cmovz   ecx, r13d
                mov     [rbp+57h+var_94], ecx

loc_14027FF44:                          ; CODE XREF: sub_14027FDE0+725↓j
                cmp     bl, 8
                jz      loc_140280443

loc_14027FF4D:                          ; CODE XREF: sub_14027FDE0+66B↓j
                test    ecx, ecx
                jnz     loc_14028001C
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rsi, rax
                jnb     loc_1402802CF

loc_14027FF6B:                          ; CODE XREF: sub_14027FDE0+4FF↓j
                mov     rdx, rsi
                mov     rax, 0FFFFF6FB40000000h
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rax, rax
                add     rdx, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rdi, [rdx]
                mov     rax, rax
                cmp     rdx, rax
                jnb     loc_140280316

loc_14027FFA1:                          ; CODE XREF: sub_14027FDE0+546↓j
                                        ; sub_14027FDE0+1C37B8↓j ...
                lea     rcx, [rbp+57h+var_70]
                mov     [rbp+57h+var_70], rdi
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140443628

loc_14027FFB6:                          ; CODE XREF: sub_14027FDE0+1C3852↓j
                                        ; sub_14027FDE0+1C386F↓j ...
                mov     rax, 0FFFFFFFFFh
                shr     rdi, 0Ch
                and     rdi, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rdx, [rdi+rdi*2]
                shl     rdx, 4
                mov     rax, rax
                add     rdx, rax
                mov     r8, [rdx]
                mov     rax, r8
                mov     rcx, r8
                shr     rax, 0Eh
                and     al, 7
                shr     rcx, 4
                and     ecx, 3FFh
                jz      short loc_140280008
                cmp     bl, al
                jz      loc_140280287
                ja      loc_1404436C5

loc_140280008:                          ; CODE XREF: sub_14027FDE0+218↑j
                                        ; sub_14027FDE0+4BC↓j ...
                mov     edi, [rbp+57h+var_A0]

loc_14028000B:                          ; CODE XREF: sub_14027FDE0+505↓j
                movzx   eax, bl
                dec     qword ptr [r15+rax*8+28h]
                cmp     bl, 7
                jz      loc_140280593

loc_14028001C:                          ; CODE XREF: sub_14027FDE0+16F↑j
                                        ; sub_14027FDE0+7C2↓j
                movzx   eax, [rbp+57h+var_9C]
                movzx   ebx, al
                dec     al
                cmp     al, 5
                ja      short loc_14028003A
                mov     rcx, [rbp+57h+var_90]
                call    sub_1402805F0
                test    al, 20h
                jnz     loc_1402805A7

loc_14028003A:                          ; CODE XREF: sub_14027FDE0+247↑j
                                        ; sub_14027FDE0+7E8↓j ...
                test    r12, r12
                jnz     loc_140280491
                mov     r8, [rbp+57h+var_90]
                movzx   eax, r14b
                xor     al, bl
                mov     r9, 80FFFFFFFFFFFFFFh
                and     al, 0Fh
                xor     r14b, al
                mov     rax, [r8]
                movzx   edx, r14b
                and     edx, 7Fh
                shl     rdx, 38h

loc_14028006A:                          ; CODE XREF: sub_14027FDE0+298↓j
                mov     rcx, rax
                and     rcx, r9
                or      rcx, rdx
                lock cmpxchg [r8], rcx
                jnz     short loc_14028006A

loc_14028007A:                          ; CODE XREF: sub_14027FDE0+6C8↓j
                cmp     bl, 8
                jnb     loc_140280430
                test    edi, edi
                jz      loc_1402804AD

loc_14028008B:                          ; CODE XREF: sub_14027FDE0+6D5↓j
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rsi, rax
                jnb     loc_1402802EA

loc_1402800A1:                          ; CODE XREF: sub_14027FDE0+51A↓j
                mov     rdx, rsi
                mov     rax, 0FFFFF6FB40000000h
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rax, rax
                add     rdx, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rdi, [rdx]
                mov     rax, rax
                cmp     rdx, rax
                jnb     loc_140280331

loc_1402800D7:                          ; CODE XREF: sub_14027FDE0+561↓j
                                        ; sub_14027FDE0+1C390F↓j ...
                lea     rcx, [rbp+57h+var_68]
                mov     [rbp+57h+var_68], rdi
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_14044377F

loc_1402800EC:                          ; CODE XREF: sub_14027FDE0+1C39A9↓j
                                        ; sub_14027FDE0+1C39C6↓j ...
                mov     rax, 0FFFFFFFFFh
                shr     rdi, 0Ch
                and     rdi, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rdx, [rdi+rdi*2]
                shl     rdx, 4
                mov     rax, rax
                add     rdx, rax
                mov     r8, [rdx]
                mov     rax, r8
                mov     rcx, r8
                shr     rax, 0Eh
                and     al, 7
                shr     rcx, 4
                and     ecx, 3FFh
                jz      short loc_14028013E
                cmp     bl, al
                jz      loc_14028026D
                ja      loc_140280373

loc_14028013E:                          ; CODE XREF: sub_14027FDE0+34E↑j
                                        ; sub_14027FDE0+4A2↓j ...
                mov     edi, [rbp+57h+var_A0]

loc_140280141:                          ; CODE XREF: sub_14027FDE0+520↓j
                movzx   eax, bl
                inc     qword ptr [r15+rax*8+28h]
                cmp     bl, 7
                jz      loc_140280450

loc_140280152:                          ; CODE XREF: sub_14027FDE0:loc_140280430↓j
                                        ; sub_14027FDE0+65E↓j ...
                add     [rbp+57h+var_98], 0FFFFFFFFh
                mov     r10d, 0
                mov     r9, [rbp+57h+var_90]
                jnz     loc_1402803F6
                mov     r12, 0FFFFF6FB40000000h

loc_140280170:                          ; CODE XREF: sub_14027FDE0+117↑j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_14044381C
                prefetchw byte ptr [rbp+57h+var_88]
                mov     rax, [rbp+57h+var_88]
                xor     ebx, ebx
                test    rax, rax
                jnz     loc_140280469
                mov     rcx, [rbp+57h+var_80]
                lea     rax, [rbp+57h+var_88]
                lock cmpxchg [rcx], rbx
                lea     rcx, [rbp+57h+var_88]
                cmp     rax, rcx
                jnz     loc_140280460

loc_1402801AA:                          ; CODE XREF: sub_14027FDE0+693↓j
                                        ; sub_14027FDE0+1C3A4A↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14044382F

loc_1402801C3:                          ; CODE XREF: sub_14027FDE0+1C3A53↓j
                                        ; sub_14027FDE0+1C3A62↓j ...
                test    edi, edi
                jz      short loc_140280242
                mov     rdx, rsi
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rax, r12
                add     rdx, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rbx, [rdx]
                mov     rax, rax
                cmp     rdx, rax
                jnb     loc_14028034C

loc_1402801F3:                          ; CODE XREF: sub_14027FDE0+57C↓j
                                        ; sub_14027FDE0+1C3A7D↓j ...
                lea     rcx, [rbp+57h+var_60]
                mov     [rbp+57h+var_60], rbx
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_1404438EA

loc_140280208:                          ; CODE XREF: sub_14027FDE0+1C3B14↓j
                                        ; sub_14027FDE0+1C3B31↓j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rbx, [rbx+rbx*2]
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                mov     eax, [rbx]
                shr     rax, 4
                test    eax, 3FFh
                jz      loc_140280393

loc_140280242:                          ; CODE XREF: sub_14027FDE0+3E5↑j
                                        ; sub_14027FDE0+5E4↓j ...
                mov     eax, r13d

loc_140280245:                          ; CODE XREF: sub_14027FDE0+1C3710↓j
                mov     rcx, [rbp+57h+var_38]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+0C0h+arg_10]
                add     rsp, 90h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028026D:                          ; CODE XREF: sub_14027FDE0+352↑j
                inc     ecx
                shl     rcx, 4
                xor     rcx, r8
                and     ecx, 3FF0h
                xor     rcx, r8
                mov     [rdx], rcx
                jmp     loc_14028013E
; ---------------------------------------------------------------------------

loc_140280287:                          ; CODE XREF: sub_14027FDE0+21C↑j
                dec     ecx
                shl     rcx, 4
                xor     rcx, r8
                and     ecx, 3FF0h
                xor     rcx, r8
                mov     [rdx], rcx
                jmp     loc_140280008
; ---------------------------------------------------------------------------

loc_1402802A1:                          ; CODE XREF: sub_14027FDE0+82↑j
                mov     rax, rcx
                cmp     rsi, rax
                ja      loc_14027FE68
                movzx   eax, byte ptr [r15+0B8h]
                mov     edi, r10d
                mov     [rbp+57h+var_A0], r10d
                mov     r13d, 1
                test    al, 7
                jz      loc_14027FE7D
                jmp     loc_14044349C
; ---------------------------------------------------------------------------

loc_1402802CF:                          ; CODE XREF: sub_14027FDE0+185↑j
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rsi, rax
                ja      loc_14027FF6B
                jmp     loc_14028000B
; ---------------------------------------------------------------------------

loc_1402802EA:                          ; CODE XREF: sub_14027FDE0+2BB↑j
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rsi, rax
                ja      loc_1402800A1
                jmp     loc_140280141
; ---------------------------------------------------------------------------

loc_140280305:                          ; CODE XREF: sub_14027FDE0+131↑j
                mov     rax, rdx
                cmp     r9, rax
                ja      loc_14027FF17
                jmp     loc_1404434F5
; ---------------------------------------------------------------------------

loc_140280316:                          ; CODE XREF: sub_14027FDE0+1BB↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdx, rax
                ja      loc_14027FFA1
                jmp     loc_14044358E
; ---------------------------------------------------------------------------

loc_140280331:                          ; CODE XREF: sub_14027FDE0+2F1↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdx, rax
                ja      loc_1402800D7
                jmp     loc_1404436E5
; ---------------------------------------------------------------------------

loc_14028034C:                          ; CODE XREF: sub_14027FDE0+40D↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdx, rax
                ja      loc_1402801F3
                jmp     loc_140443853
; ---------------------------------------------------------------------------

loc_140280367:                          ; CODE XREF: sub_14027FDE0+A1↑j
                lea     rbx, unk_140C4F640
                jmp     loc_14027FE8E
; ---------------------------------------------------------------------------

loc_140280373:                          ; CODE XREF: sub_14027FDE0+358↑j
                movzx   eax, bl
                and     r8, 0FFFFFFFFFFFE001Fh
                and     eax, 7
                shl     rax, 0Eh
                or      rax, r8
                or      rax, 10h
                mov     [rdx], rax
                jmp     loc_14028013E
; ---------------------------------------------------------------------------

loc_140280393:                          ; CODE XREF: sub_14027FDE0+45C↑j
                lea     r8, [rbp+57h+var_58]
                mov     rdx, rsi
                call    sub_1402FD640
                mov     cl, 8
                nop     dword ptr [rax+00h]
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_1402803B0:                          ; CODE XREF: sub_14027FDE0+5E2↓j
                add     cl, 0FFh
                movzx   eax, cl
                mov     r8d, [rbp+rax*4+57h+var_58]
                test    r8d, r8d
                jnz     short loc_1402803C9
                test    cl, cl
                jnz     short loc_1402803B0
                jmp     loc_140280242
; ---------------------------------------------------------------------------

loc_1402803C9:                          ; CODE XREF: sub_14027FDE0+5DE↑j
                movzx   edx, cl
                and     r8d, 3FFh
                mov     rcx, [rbx]
                and     edx, 7
                shl     rdx, 0Ah
                and     rcx, 0FFFFFFFFFFFE000Fh
                or      rdx, r8
                shl     rdx, 4
                or      rdx, rcx
                mov     [rbx], rdx
                jmp     loc_140280242
; ---------------------------------------------------------------------------

loc_1402803F6:                          ; CODE XREF: sub_14027FDE0+380↑j
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rdx, 0FFFFF6FB7DBED7F8h
                jmp     loc_14027FEFD
; ---------------------------------------------------------------------------

loc_14028040F:                          ; CODE XREF: sub_14027FDE0+F0↑j
                mov     rax, [r15+10h]
                mov     ecx, r8d
                mov     rax, [rax+20h]
                add     rax, 6
                add     rcx, rax
                cmp     [r15+70h], rcx
                jnb     loc_14027FED6
                jmp     loc_1404434E5
; ---------------------------------------------------------------------------

loc_140280430:                          ; CODE XREF: sub_14027FDE0+29D↑j
                jnz     loc_140280152
                mov     rax, [r15+10h]
                inc     qword ptr [rax+20h]
                jmp     loc_140280152
; ---------------------------------------------------------------------------

loc_140280443:                          ; CODE XREF: sub_14027FDE0+167↑j
                mov     rax, [r15+10h]
                dec     qword ptr [rax+20h]
                jmp     loc_14027FF4D
; ---------------------------------------------------------------------------

loc_140280450:                          ; CODE XREF: sub_14027FDE0+36C↑j
                mov     rdx, r13
                mov     rcx, r15
                call    sub_1402898C0
                jmp     loc_140280152
; ---------------------------------------------------------------------------

loc_140280460:                          ; CODE XREF: sub_14027FDE0+3C4↑j
                lea     rcx, [rbp+57h+var_88]
                call    sub_140313680

loc_140280469:                          ; CODE XREF: sub_14027FDE0+3AA↑j
                mov     [rbp+57h+var_88], rbx
                lock xor qword ptr [rax+8], 1
                jmp     loc_1402801AA
; ---------------------------------------------------------------------------

loc_140280478:                          ; CODE XREF: sub_14027FDE0+E6↑j
                lea     rcx, [rbp+57h+var_88]
                call    sub_14025FC20

loc_140280481:                          ; CODE XREF: sub_14027FDE0+1C3700↓j
                mov     r8d, [rbp+57h+var_98]
                xor     r10d, r10d
                mov     r9, [rbp+57h+var_90]
                jmp     loc_14027FECC
; ---------------------------------------------------------------------------

loc_140280491:                          ; CODE XREF: sub_14027FDE0+25D↑j
                mov     rax, [r12]
                movzx   ecx, bl
                add     rcx, rcx
                xor     rcx, rax
                and     ecx, 0Eh
                xor     rcx, rax
                mov     [r12], rcx
                jmp     loc_14028007A
; ---------------------------------------------------------------------------

loc_1402804AD:                          ; CODE XREF: sub_14027FDE0+2A5↑j
                test    byte ptr [r15+0B8h], 7
                jz      loc_14028008B
                jmp     loc_140280152
; ---------------------------------------------------------------------------

loc_1402804C0:                          ; CODE XREF: sub_14027FDE0+11F↑j
                mov     rbx, [r9]
                mov     rcx, r9
                call    sub_1402433C0
                test    eax, eax
                jnz     short loc_14028050A

loc_1402804CF:                          ; CODE XREF: sub_14027FDE0+734↓j
                                        ; sub_14027FDE0+74D↓j ...
                mov     rax, 0FFFFFFFFFh
                shr     rbx, 0Ch
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     r12, [rbx+rbx*2]
                shl     r12, 4
                mov     rax, rax
                mov     ecx, [rbp+57h+var_94]
                add     r12, rax
                movzx   ebx, byte ptr [r12]
                shr     bl, 1
                and     bl, 7
                jmp     loc_14027FF44
; ---------------------------------------------------------------------------

loc_14028050A:                          ; CODE XREF: sub_14027FDE0+6ED↑j
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_1402804CF
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_1402804CF
                test    bl, 1
                jz      short loc_1402804CF
                test    bl, 20h
                jnz     loc_1402805D5

loc_14028053D:                          ; CODE XREF: sub_14027FDE0+7FE↓j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      loc_1402804CF
                mov     rax, [rbp+57h+var_90]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      loc_1402804CF
                or      rbx, 42h
                jmp     loc_1402804CF
; ---------------------------------------------------------------------------

loc_140280593:                          ; CODE XREF: sub_14027FDE0+236↑j
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                mov     rcx, r15
                call    sub_1402898C0
                jmp     loc_14028001C
; ---------------------------------------------------------------------------

loc_1402805A7:                          ; CODE XREF: sub_14027FDE0+254↑j
                mov     rax, 7FFFFFFEFFFFh
                cmp     rsi, rax
                ja      short loc_1402805CE
                test    byte ptr [r15+0B8h], 7
                jnz     short loc_1402805CE
                cmp     qword ptr [r15+270h], 0
                jnz     loc_14028003A

loc_1402805CE:                          ; CODE XREF: sub_14027FDE0+7D4↑j
                                        ; sub_14027FDE0+7DE↑j
                xor     bl, bl
                jmp     loc_14028003A
; ---------------------------------------------------------------------------

loc_1402805D5:                          ; CODE XREF: sub_14027FDE0+757↑j
                test    bl, 42h
                jnz     loc_1402804CF
                jmp     loc_14028053D
; } // starts at 14027FDE0
sub_14027FDE0   endp

; ---------------------------------------------------------------------------
algn_1402805E3:                         ; DATA XREF: .rdata:000000014005E7B0↑o
                                        ; .pdata:00000001400CEA24↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402805F0   proc near               ; CODE XREF: sub_140207C5C+AB↑p
                                        ; sub_140207E6C+9A↑p ...

; FUNCTION CHUNK AT 000000014041D658 SIZE 00000050 BYTES

                mov     rax, [rcx]
                mov     rdx, 0FFFFF6FB7DBED000h
                cmp     rcx, rdx
                jnb     short loc_140280604

locret_140280602:                       ; CODE XREF: sub_1402805F0+21↓j
                                        ; sub_1402805F0+2D↓j ...
                retn
; ---------------------------------------------------------------------------
                align 4

loc_140280604:                          ; CODE XREF: sub_1402805F0+10↑j
                mov     rdx, 0FFFFF6FB7DBED7F8h
                cmp     rcx, rdx
                ja      short locret_140280602
                test    cs:dword_140CFC400, 0C00000h
                jz      short locret_140280602
                mov     rdx, gs:188h
                mov     r8, [rdx+0B8h]
                cmp     byte ptr [r8+390h], 1
                jz      short locret_140280602
                test    al, 1
                jz      short locret_140280602
                test    al, 20h
                jz      loc_14041D658
                test    al, 42h
                jnz     short locret_140280602
                jmp     loc_14041D658
sub_1402805F0   endp

; ---------------------------------------------------------------------------
algn_14028064E:                         ; DATA XREF: .pdata:00000001400CEA30↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140280660   proc near               ; DATA XREF: .pdata:00000001400CEA3C↑o
                                        ; PAGE:000000014098B2E8↓o

var_1B8         = qword ptr -1B8h
var_1B0         = qword ptr -1B0h
var_1A8         = qword ptr -1A8h
var_198         = byte ptr -198h
var_194         = dword ptr -194h
var_190         = dword ptr -190h
var_188         = qword ptr -188h
var_180         = qword ptr -180h
var_178         = qword ptr -178h
var_170         = qword ptr -170h
var_168         = qword ptr -168h
var_160         = qword ptr -160h
var_158         = qword ptr -158h
var_150         = qword ptr -150h
var_148         = qword ptr -148h
var_140         = qword ptr -140h
var_138         = dword ptr -138h
var_134         = word ptr -134h
var_132         = word ptr -132h
var_130         = qword ptr -130h
var_128         = qword ptr -128h
var_120         = qword ptr -120h
var_118         = xmmword ptr -118h
var_108         = xmmword ptr -108h
var_F8          = xmmword ptr -0F8h
var_E8          = xmmword ptr -0E8h
var_D8          = xmmword ptr -0D8h
var_C8          = xmmword ptr -0C8h
var_B8          = xmmword ptr -0B8h
var_A8          = xmmword ptr -0A8h
var_98          = xmmword ptr -98h
var_78          = byte ptr -78h
var_48          = qword ptr -48h

; __unwind { // __GSHandlerCheck_SEH
                mov     r11, rsp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 1A0h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+1D8h+var_48], rax
                mov     [rsp+1D8h+var_148], r8
                mov     [rsp+1D8h+var_140], rdx
                mov     rdi, rcx
                xor     r13d, r13d
                mov     [rsp+1D8h+var_188], r13
                mov     [rsp+1D8h+var_178], r13
                mov     [rsp+1D8h+var_180], r13
                xorps   xmm0, xmm0
                movups  xmmword ptr [r11-78h], xmm0
                movups  xmmword ptr [r11-68h], xmm0
                movups  xmmword ptr [r11-58h], xmm0
                xor     ecx, ecx
                mov     [rsp+1D8h+var_132], cx
                movups  [rsp+1D8h+var_118], xmm0
                movups  [rsp+1D8h+var_108], xmm0
                movups  [rsp+1D8h+var_F8], xmm0
                movups  [rsp+1D8h+var_E8], xmm0
                movups  [rsp+1D8h+var_D8], xmm0
                movups  [rsp+1D8h+var_C8], xmm0
                movups  [rsp+1D8h+var_B8], xmm0
                movups  [rsp+1D8h+var_A8], xmm0
                movups  [rsp+1D8h+var_98], xmm0
                mov     [r11-88h], rcx
                lea     rcx, [rsp+1D8h+var_180]
                mov     [rsp+1D8h+var_1A8], rcx
                lea     rcx, [rsp+1D8h+var_188]
                mov     [rsp+1D8h+var_1B0], rcx
                lea     rcx, [rsp+1D8h+var_178]
                mov     [rsp+1D8h+var_1B8], rcx
                mov     rcx, rdi
                call    sub_1406FD5BC
                mov     r12d, eax
                mov     [rsp+1D8h+var_194], eax
                test    eax, eax
                js      loc_140280E2E
                mov     r15d, r13d
                mov     [rsp+1D8h+var_160], r13
                mov     ebx, r13d
                mov     [rsp+1D8h+var_190], ebx
                mov     r14, [rsp+1D8h+var_188]
                dec     r14
                add     r14, [rsp+1D8h+var_178]
                and     r14, 0FFFFFFFFFFFFF000h
                mov     [rsp+1D8h+var_188], r14
                mov     rax, [rsp+1D8h+var_178]
                and     rax, 0FFFFFFFFFFFFF000h
                mov     [rsp+1D8h+var_150], rax
                mov     rsi, rax
                cmp     rdi, 0FFFFFFFFFFFFFFFFh
                jz      short loc_1402807AB
                lea     rdx, [rsp+1D8h+var_78]
                mov     rcx, [rsp+1D8h+var_180]
                call    KeStackAttachProcess
                mov     ebx, 2
                mov     [rsp+1D8h+var_190], ebx

loc_1402807AB:                          ; CODE XREF: sub_140280660+12E↑j
                mov     [rsp+1D8h+var_130], 14h
                mov     [rsp+1D8h+var_138], 1
                mov     [rsp+1D8h+var_134], 4
                mov     [rsp+1D8h+var_128], r13
                mov     [rsp+1D8h+var_120], r13
                mov     rdi, r13
                xor     r9d, r9d
                mov     r8, r14
                mov     rdx, rsi
                mov     r14, [rsp+1D8h+var_180]
                mov     rcx, r14
                call    sub_14068459C
                mov     [rsp+1D8h+var_158], rax
                test    rax, rax
                jz      loc_140280DF7
                add     r14, 680h
                mov     rcx, r14
                call    sub_140231340
                mov     [rsp+1D8h+var_198], al
                cmp     rsi, [rsp+1D8h+var_188]
                ja      loc_140280B8C
                mov     r10, 0FFFFF68000000000h
                mov     r11, 0FFFFF6FB40000000h
                nop     dword ptr [rax+rax+00000000h]

loc_140280840:                          ; CODE XREF: sub_140280660+526↓j
                mov     rax, rsi
                shr     rax, 0Ch
                inc     al
                test    al, 0Fh
                jnz     loc_1402808D3
                mov     rcx, r14
                call    sub_14029A5E0
                test    eax, eax
                jnz     short loc_14028087A
                test    r13, r13
                jz      short loc_140280871
                mov     rdx, r13
                mov     rcx, r14
                call    sub_14029F0B0
                test    eax, eax
                jnz     short loc_14028087A

loc_140280871:                          ; CODE XREF: sub_140280660+200↑j
                call    sub_140536BA8
                test    eax, eax
                jz      short loc_1402808BF

loc_14028087A:                          ; CODE XREF: sub_140280660+1FB↑j
                                        ; sub_140280660+20F↑j
                cmp     dword ptr [rsp+1D8h+var_130+4], 0
                jz      short loc_140280897
                xor     r8d, r8d
                lea     rdx, [rsp+1D8h+var_138]
                mov     rcx, r14
                call    sub_140279D90

loc_140280897:                          ; CODE XREF: sub_140280660+222↑j
                test    r13, r13
                jz      short loc_1402808AA
                mov     rdx, r13
                mov     rcx, r14
                call    sub_1403B6AB0
                xor     r13d, r13d

loc_1402808AA:                          ; CODE XREF: sub_140280660+23A↑j
                movzx   edx, [rsp+1D8h+var_198]
                mov     rcx, r14
                call    sub_140226960
                mov     rcx, r14
                call    sub_140231340

loc_1402808BF:                          ; CODE XREF: sub_140280660+218↑j
                mov     r11, 0FFFFF6FB40000000h
                mov     r10, 0FFFFF68000000000h

loc_1402808D3:                          ; CODE XREF: sub_140280660+1EB↑j
                cmp     rsi, r15
                ja      short loc_1402808E1
                test    rdi, rdi
                jnz     loc_140280982

loc_1402808E1:                          ; CODE XREF: sub_140280660+276↑j
                test    rdi, rdi
                jnz     short loc_1402808F3
                mov     rcx, rsi
                call    sub_14026A130
                mov     rdi, rax
                jmp     short loc_140280942
; ---------------------------------------------------------------------------

loc_1402808F3:                          ; CODE XREF: sub_140280660+284↑j
                mov     rcx, rdi
                mov     rax, [rdi+8]
                test    rax, rax
                jz      short loc_140280920
                mov     rdi, rax
                mov     rcx, [rax]
                test    rcx, rcx
                jz      short loc_140280942
                nop     word ptr [rax+rax+00h]

loc_140280910:                          ; CODE XREF: sub_140280660+2BC↓j
                mov     rdi, rcx
                mov     rax, [rcx]
                mov     rcx, rax
                test    rax, rax
                jnz     short loc_140280910
                jmp     short loc_140280942
; ---------------------------------------------------------------------------

loc_140280920:                          ; CODE XREF: sub_140280660+29D↑j
                mov     rdi, [rdi+10h]
                and     rdi, 0FFFFFFFFFFFFFFFCh
                jz      short loc_140280942
                nop     word ptr [rax+rax+00h]

loc_140280930:                          ; CODE XREF: sub_140280660+2E0↓j
                cmp     [rdi], rcx
                jz      short loc_140280942
                mov     rcx, rdi
                mov     rdi, [rdi+10h]
                and     rdi, 0FFFFFFFFFFFFFFFCh
                jnz     short loc_140280930

loc_140280942:                          ; CODE XREF: sub_140280660+291↑j
                                        ; sub_140280660+2A8↑j ...
                and     ebx, 0FFFFFFFBh
                mov     [rsp+1D8h+var_190], ebx
                mov     eax, [rdi+30h]
                and     al, 70h
                cmp     al, 40h ; '@'
                jnz     short loc_14028095B
                or      ebx, 4
                mov     [rsp+1D8h+var_190], ebx
                jmp     short loc_14028096B
; ---------------------------------------------------------------------------

loc_14028095B:                          ; CODE XREF: sub_140280660+2F0↑j
                mov     rcx, rdi
                call    sub_1402E4688
                test    eax, eax
                jz      loc_140280B8C

loc_14028096B:                          ; CODE XREF: sub_140280660+2F9↑j
                movzx   ecx, byte ptr [rdi+21h]
                shl     rcx, 20h
                mov     eax, [rdi+1Ch]
                or      rcx, rax
                shl     rcx, 0Ch
                mov     [rsp+1D8h+var_160], rcx

loc_140280982:                          ; CODE XREF: sub_140280660+27B↑j
                mov     r15, rsi
                shr     r15, 9
                mov     rax, 7FFFFFFFF8h
                and     r15, rax
                mov     rax, r10
                add     r15, rax
                mov     r12, rsi
                shr     r12, 12h
                and     r12d, 3FFFFFF8h
                mov     rax, r11
                add     r12, rax
                cmp     r13, r12
                jz      loc_140280A4D
                test    r13, r13
                jz      short loc_1402809E6
                cmp     dword ptr [rsp+1D8h+var_130+4], 0
                jz      short loc_1402809DB
                xor     r8d, r8d
                lea     rdx, [rsp+1D8h+var_138]
                mov     rcx, r14
                call    sub_140279D90

loc_1402809DB:                          ; CODE XREF: sub_140280660+366↑j
                mov     rdx, r13
                mov     rcx, r14
                call    sub_1403B6AB0

loc_1402809E6:                          ; CODE XREF: sub_140280660+35C↑j
                lea     r8, [rsp+1D8h+var_168]
                mov     rdx, r15
                mov     rcx, r14
                call    sub_1402A82C0
                mov     r13, rax
                cmp     rax, r12
                jz      short loc_140280A4D
                mov     rdx, rax
                mov     rcx, r14
                call    sub_1403B6AB0
                xor     r13d, r13d
                mov     r10, 0FFFFF68000000000h
                mov     rax, r10
                shl     rax, 19h
                mov     rsi, r12
                shl     rsi, 19h
                sub     rsi, rax
                add     rsi, 10000000h
                sar     rsi, 10h
                shl     rsi, 19h
                sub     rsi, rax
                sar     rsi, 10h
                mov     r12d, 0C000002Ah
                mov     [rsp+1D8h+var_194], r12d
                jmp     loc_140280B72
; ---------------------------------------------------------------------------

loc_140280A4D:                          ; CODE XREF: sub_140280660+353↑j
                                        ; sub_140280660+39C↑j
                mov     rcx, r15
                call    sub_1402805F0
                mov     [rsp+1D8h+var_170], rax
                test    al, 1
                jnz     short loc_140280A6E
                mov     r12d, 0C000002Ah
                mov     [rsp+1D8h+var_194], r12d
                jmp     loc_140280B61
; ---------------------------------------------------------------------------

loc_140280A6E:                          ; CODE XREF: sub_140280660+3FC↑j
                lea     rcx, [rsp+1D8h+var_170]
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rcx, [rax+rax*2]
                shl     rcx, 4
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                add     rcx, rax
                mov     [rsp+1D8h+var_170], rcx
                mov     r12, [rcx+8]
                mov     rdx, r12
                mov     rax, 8000000000000000h
                or      rdx, rax
                mov     [rsp+1D8h+var_168], rdx
                test    bl, 4
                jz      short loc_140280ADF
                mov     rcx, r15
                call    sub_140342C88
                cmp     eax, 1
                jz      loc_140280B5C
                mov     rcx, [rsp+1D8h+var_170]
                mov     rdx, [rsp+1D8h+var_168]

loc_140280ADF:                          ; CODE XREF: sub_140280660+462↑j
                mov     rax, [rcx+28h]
                mov     rcx, 1000000000h
                test    rcx, rax
                jnz     short loc_140280B07
                test    r12, r12
                js      short loc_140280B07
                jz      short loc_140280B07
                mov     r8, rdx
                mov     rdx, r15
                mov     rcx, r14
                call    sub_14036B290

loc_140280B07:                          ; CODE XREF: sub_140280660+490↑j
                                        ; sub_140280660+495↑j ...
                mov     rdx, rsi
                call    sub_1402DECC0
                and     al, 0Fh
                cmp     al, 8
                jz      short loc_140280B5C
                xor     r9d, r9d
                lea     r8d, [r9+1]
                mov     rdx, rsi
                lea     rcx, [rsp+1D8h+var_138]
                call    sub_1402882E0
                mov     eax, dword ptr [rsp+1D8h+var_130]
                cmp     dword ptr [rsp+1D8h+var_130+4], eax
                jnz     short loc_140280B4F
                xor     r8d, r8d
                lea     rdx, [rsp+1D8h+var_138]
                mov     rcx, r14
                call    sub_140279D90

loc_140280B4F:                          ; CODE XREF: sub_140280660+4DA↑j
                mov     r12d, 0C000002Ah
                mov     [rsp+1D8h+var_194], r12d
                jmp     short loc_140280B61
; ---------------------------------------------------------------------------

loc_140280B5C:                          ; CODE XREF: sub_140280660+46F↑j
                                        ; sub_140280660+4B3↑j
                mov     r12d, [rsp+1D8h+var_194]

loc_140280B61:                          ; CODE XREF: sub_140280660+409↑j
                                        ; sub_140280660+4FA↑j
                mov     r10, 0FFFFF68000000000h
                add     rsi, 1000h

loc_140280B72:                          ; CODE XREF: sub_140280660+3E8↑j
                cmp     rsi, [rsp+1D8h+var_188]
                mov     r15, [rsp+1D8h+var_160]
                mov     r11, 0FFFFF6FB40000000h
                jbe     loc_140280840

loc_140280B8C:                          ; CODE XREF: sub_140280660+1BE↑j
                                        ; sub_140280660+305↑j
                cmp     dword ptr [rsp+1D8h+var_130+4], 0
                jz      short loc_140280BA9
                xor     r8d, r8d
                lea     rdx, [rsp+1D8h+var_138]
                mov     rcx, r14
                call    sub_140279D90

loc_140280BA9:                          ; CODE XREF: sub_140280660+534↑j
                test    r13, r13
                jz      short loc_140280BBC
                mov     rdx, r13
                mov     rcx, r14
                call    sub_1403B6AB0
                xor     r13d, r13d

loc_140280BBC:                          ; CODE XREF: sub_140280660+54C↑j
                cmp     r12d, 0C000002Ah
                jnz     short loc_140280BE4
                movzx   edx, [rsp+1D8h+var_198]
                mov     rcx, r14
                call    sub_140226960
                mov     r14, [rsp+1D8h+var_180]
                mov     rax, [rsp+1D8h+var_158]
                jmp     loc_140280DF7
; ---------------------------------------------------------------------------

loc_140280BE4:                          ; CODE XREF: sub_140280660+563↑j
                mov     r15, [rsp+1D8h+var_150]
                xor     esi, esi
                xor     edi, edi
                mov     r12, [rsp+1D8h+var_188]
                cmp     r15, r12
                ja      loc_140280D6F
                movzx   ebx, [rsp+1D8h+var_198]

loc_140280C03:                          ; CODE XREF: sub_140280660+705↓j
                cmp     r15, rsi
                ja      short loc_140280C11
                test    rdi, rdi
                jnz     loc_140280C94

loc_140280C11:                          ; CODE XREF: sub_140280660+5A6↑j
                test    rdi, rdi
                jnz     short loc_140280C23
                mov     rcx, r15
                call    sub_14026A130
                mov     rdi, rax
                jmp     short loc_140280C72
; ---------------------------------------------------------------------------

loc_140280C23:                          ; CODE XREF: sub_140280660+5B4↑j
                mov     rcx, rdi
                mov     rax, [rdi+8]
                test    rax, rax
                jz      short loc_140280C50
                mov     rdi, rax
                mov     rcx, [rax]
                test    rcx, rcx
                jz      short loc_140280C72
                nop     word ptr [rax+rax+00h]

loc_140280C40:                          ; CODE XREF: sub_140280660+5EC↓j
                mov     rdi, rcx
                mov     rax, [rcx]
                mov     rcx, rax
                test    rax, rax
                jnz     short loc_140280C40
                jmp     short loc_140280C72
; ---------------------------------------------------------------------------

loc_140280C50:                          ; CODE XREF: sub_140280660+5CD↑j
                mov     rdi, [rdi+10h]
                and     rdi, 0FFFFFFFFFFFFFFFCh
                jz      short loc_140280C72
                nop     word ptr [rax+rax+00h]

loc_140280C60:                          ; CODE XREF: sub_140280660+610↓j
                cmp     [rdi], rcx
                jz      short loc_140280C72
                mov     rcx, rdi
                mov     rdi, [rdi+10h]
                and     rdi, 0FFFFFFFFFFFFFFFCh
                jnz     short loc_140280C60

loc_140280C72:                          ; CODE XREF: sub_140280660+5C1↑j
                                        ; sub_140280660+5D8↑j ...
                mov     rcx, rdi
                call    sub_1402E4688
                test    eax, eax
                jz      loc_140280D6B
                movzx   esi, byte ptr [rdi+21h]
                shl     rsi, 20h
                mov     eax, [rdi+1Ch]
                or      rsi, rax
                shl     rsi, 0Ch

loc_140280C94:                          ; CODE XREF: sub_140280660+5AB↑j
                mov     r12, r15
                shr     r12, 9
                mov     rax, 7FFFFFFFF8h
                and     r12, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     r12, rax
                mov     rcx, r15
                shr     rcx, 12h
                and     ecx, 3FFFFFF8h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                add     rcx, rax
                cmp     r13, rcx
                jz      short loc_140280CFD
                test    r13, r13
                jz      short loc_140280CEA
                mov     rdx, r13
                mov     rcx, r14
                call    sub_1403B6AB0

loc_140280CEA:                          ; CODE XREF: sub_140280660+67D↑j
                lea     r8, [rsp+1D8h+var_168]
                mov     rdx, r12
                mov     rcx, r14
                call    sub_1402A82C0
                mov     r13, rax

loc_140280CFD:                          ; CODE XREF: sub_140280660+678↑j
                mov     rdx, r15
                mov     rcx, r14
                call    sub_1402DDA7C
                add     r15, 1000h
                test    r15, 0F000h
                jnz     short loc_140280D5D
                mov     rcx, r14
                call    sub_14029A5E0
                test    eax, eax
                jnz     short loc_140280D3C
                mov     rdx, r13
                mov     rcx, r14
                call    sub_14029F0B0
                test    eax, eax
                jnz     short loc_140280D3C
                call    sub_140536BA8
                test    eax, eax
                jz      short loc_140280D5D

loc_140280D3C:                          ; CODE XREF: sub_140280660+6C2↑j
                                        ; sub_140280660+6D1↑j
                mov     rdx, r13
                mov     rcx, r14
                call    sub_1403B6AB0
                xor     r13d, r13d
                movzx   edx, bl
                mov     rcx, r14
                call    sub_140226960
                mov     rcx, r14
                call    sub_140231340

loc_140280D5D:                          ; CODE XREF: sub_140280660+6B6↑j
                                        ; sub_140280660+6DA↑j
                mov     r12, [rsp+1D8h+var_188]
                cmp     r15, r12
                jbe     loc_140280C03

loc_140280D6B:                          ; CODE XREF: sub_140280660+61C↑j
                mov     ebx, [rsp+1D8h+var_190]

loc_140280D6F:                          ; CODE XREF: sub_140280660+598↑j
                test    r13, r13
                jz      short loc_140280D7F
                mov     rdx, r13
                mov     rcx, r14
                call    sub_1403B6AB0

loc_140280D7F:                          ; CODE XREF: sub_140280660+712↑j
                movzx   edx, [rsp+1D8h+var_198]
                mov     rcx, r14
                call    sub_140226960
                xor     r9d, r9d
                mov     r8, [rsp+1D8h+var_158]
                mov     rdx, [rsp+1D8h+var_178]
                mov     rdi, [rsp+1D8h+var_180]
                mov     rcx, rdi
                call    sub_14068448C
                test    bl, 2
                jz      short loc_140280DBB
                lea     rcx, [rsp+1D8h+var_78]
                call    KeUnstackDetachProcess

loc_140280DBB:                          ; CODE XREF: sub_140280660+74C↑j
                mov     edx, 6D566D4Dh
                mov     rcx, rdi
                call    ObfDereferenceObjectWithTag
                nop

loc_140280DC9:                          ; DATA XREF: .rdata:000000014005E7E0↑o
;   __try { // __except at loc_140280DF5
                mov     rax, [rsp+1D8h+var_150]
                sub     r12, rax
                add     r12, 1000h
                mov     rcx, [rsp+1D8h+var_148]
                mov     [rcx], r12
                mov     rcx, [rsp+1D8h+var_140]
                mov     [rcx], rax
;   } // starts at 140280DC9

loc_140280DF1:                          ; DATA XREF: .rdata:000000014005E7E0↑o
                xor     eax, eax
                jmp     short loc_140280E2E
; ---------------------------------------------------------------------------

loc_140280DF5:                          ; DATA XREF: .rdata:000000014005E7E0↑o
;   __except(1) // owned by 140280DC9
                jmp     short loc_140280E2E
; ---------------------------------------------------------------------------

loc_140280DF7:                          ; CODE XREF: sub_140280660+1A0↑j
                                        ; sub_140280660+57F↑j
                xor     r9d, r9d
                mov     r8, rax
                mov     rdx, [rsp+1D8h+var_178]
                mov     rcx, r14
                call    sub_14068448C
                test    bl, 2
                jz      short loc_140280E1C
                lea     rcx, [rsp+1D8h+var_78]
                call    KeUnstackDetachProcess

loc_140280E1C:                          ; CODE XREF: sub_140280660+7AD↑j
                mov     edx, 6D566D4Dh
                mov     rcx, r14
                call    ObfDereferenceObjectWithTag
                mov     eax, 0C000002Ah

loc_140280E2E:                          ; CODE XREF: sub_140280660+E6↑j
                                        ; sub_140280660+793↑j ...
                mov     rcx, [rsp+1D8h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 1A0h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140280660
sub_140280660   endp

algn_140280E52:                         ; DATA XREF: .pdata:00000001400CEA3C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140280E60   proc near               ; CODE XREF: sub_140229EE0+5D0↑p
                                        ; sub_140229EE0+6FC↑p ...

var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
var_10          = qword ptr -10h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140443984 SIZE 00000030 BYTES

                mov     rax, rsp
                push    rdi
                sub     rsp, 40h

loc_140280E68:                          ; DATA XREF: .rdata:000000014005E81C↑o
                                        ; .rdata:000000014005E830↑o ...
                mov     [rax+8], rbx
                mov     edi, r8d
                mov     [rax+10h], rbp
                mov     [rax+18h], rsi
                mov     esi, r8d
                mov     [rax-10h], r12
                and     esi, 1Fh
                mov     [rax-18h], r13
                lea     r12, cs:140000000h
                mov     [rax-20h], r14
                mov     r14, rcx
                mov     [rax-28h], r15
                mov     rax, 0FFFF000000000E7Fh
                mov     rbx, ds:rva qword_140017520[r12+rsi*8]
                and     rbx, rax
                mov     r15, 0FFFFF68000000000h
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax
                shl     rdx, 0Ch
                or      rbx, rdx
                or      rbx, 21h
                mov     rax, r15
                cmp     rcx, rax
                jnb     loc_140280F91

loc_140280EDA:                          ; CODE XREF: sub_140280E60+141↓j
                                        ; sub_140280E60+1EA↓j
                bts     rbx, 8

loc_140280EDF:                          ; CODE XREF: sub_140280E60+1C4↓j
                                        ; sub_140280E60+1E4↓j ...
                mov     r15, [rsp+48h+var_28]
                and     sil, 5
                mov     r14, [rsp+48h+var_20]
                cmp     sil, 4
                mov     r13, [rsp+48h+var_18]
                mov     r12, [rsp+48h+var_10]
                setz    cl
                mov     rsi, [rsp+48h+arg_10]
                bt      edi, 1Fh
                mov     rbp, [rsp+48h+arg_8]
                setb    al
                and     cl, al
                mov     rax, rbx
                or      rax, 42h
                test    cl, cl
                cmovz   rax, rbx
                mov     rbx, [rsp+48h+arg_0]
                bt      edi, 1Eh
                jb      loc_1404439AB

loc_140280F2D:                          ; CODE XREF: sub_140280E60+1C2B4F↓j
                                        ; DATA XREF: .pdata:00000001400CEA54↑o ...
                bt      edi, 1Dh
                jnb     short loc_140280F4A
                movzx   ecx, byte ptr cs:word_140C4DE88
                shl     rcx, 8
                xor     rcx, rax
                and     ecx, 100h
                xor     rax, rcx

loc_140280F4A:                          ; CODE XREF: sub_140280E60+D1↑j
                mov     rdx, rax
                mov     ecx, edi
                btr     rdx, 8
                and     ecx, 8000000h
                mov     rcx, 0FAFFFFFFFFFFFFFFh
                cmovz   rdx, rax
                mov     rax, rdx
                bts     rax, 7
                and     edi, 4000000h
                cmovz   rax, rdx
                and     rax, rcx
                mov     rcx, 0A00000000000000h
                or      rax, rcx
                add     rsp, 40h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140280F91:                          ; CODE XREF: sub_140280E60+74↑j
                                        ; DATA XREF: .pdata:00000001400CEA60↑o ...
                mov     r13, 0FFFFF6FFFFFFFFFFh
                mov     rax, r13
                cmp     r14, rax
                ja      loc_140280EDA
                mov     rbp, r14
                shl     rbp, 19h
                mov     rax, r15
                shl     rax, 19h
                sub     rbp, rax
                sar     rbp, 10h
                mov     rax, 0FFFFF6FB40000000h
                cmp     r14, rax
                jnb     loc_14028104F

loc_140280FCF:                          ; CODE XREF: sub_140280E60+1FC↓j
                                        ; sub_140280E60+22F↓j ...
                mov     rcx, rbx
                mov     rax, r15
                or      rbx, 4
                mov     rdx, 3FFFFFFF78h
                add     rax, rdx
                cmp     r14, rax
                cmova   rbx, rcx
                bt      edi, 1Ah
                jb      loc_1402810BE

loc_140280FF7:                          ; CODE XREF: sub_140280E60+269↓j
                mov     rax, 0FFFF800000000000h
                cmp     rbp, rax
                jb      loc_1402810B5
                mov     rax, rbp
                shr     rax, 27h
                and     eax, 1FFh
                sub     eax, 100h
                cmp     byte ptr [rax+r12+0C4F848h], 1
                jz      loc_140280EDF
                mov     rax, r15
                cmp     rbp, rax
                jnb     short loc_14028109A

loc_140281032:                          ; CODE XREF: sub_140280E60+240↓j
                cmp     rbp, cs:qword_140C4F9B8
                jnb     short loc_1402810A7

loc_14028103B:                          ; CODE XREF: sub_140280E60+24E↓j
                movzx   eax, byte ptr cs:word_140C4DE88

loc_140281042:                          ; CODE XREF: sub_140280E60+25C↓j
                                        ; sub_140280E60+1C2B46↓j
                test    eax, eax
                jz      loc_140280EDF
                jmp     loc_140280EDA
; ---------------------------------------------------------------------------

loc_14028104F:                          ; CODE XREF: sub_140280E60+169↑j
                mov     rax, 0FFFFF6FB7FFFFFFFh
                cmp     r14, rax
                ja      loc_140280FCF
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     r14, rax
                jz      loc_140443984
                bt      edi, 1Ah
                jb      short loc_140281088
                mov     rax, 7FFFFFFFFFFFFFFFh
                and     rbx, rax

loc_140281088:                          ; CODE XREF: sub_140280E60+219↑j
                                        ; sub_140280E60+1C2B31↓j
                call    sub_14033FA34
                test    eax, eax
                jz      loc_140280FCF
                jmp     loc_140443996
; ---------------------------------------------------------------------------

loc_14028109A:                          ; CODE XREF: sub_140280E60+1D0↑j
                mov     rax, r13
                cmp     rbp, rax
                ja      short loc_140281032
                jmp     loc_140280EDF
; ---------------------------------------------------------------------------

loc_1402810A7:                          ; CODE XREF: sub_140280E60+1D9↑j
                cmp     rbp, cs:qword_140C4E1E8
                ja      short loc_14028103B
                jmp     loc_14044399F
; ---------------------------------------------------------------------------

loc_1402810B5:                          ; CODE XREF: sub_140280E60+1A4↑j
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jmp     short loc_140281042
; ---------------------------------------------------------------------------

loc_1402810BE:                          ; CODE XREF: sub_140280E60+191↑j
                mov     rcx, rbp
                call    sub_14027F590
                mov     rbp, rax
                jmp     loc_140280FF7
sub_140280E60   endp

; ---------------------------------------------------------------------------
algn_1402810CE:                         ; DATA XREF: .pdata:00000001400CEA6C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402810E0   proc near               ; CODE XREF: sub_140209860+1E2↑p
                                        ; sub_140227A20+C12↑p ...
                mov     rax, 0FFFFFFFFFh
                and     rcx, rax
                mov     eax, edx
                shl     rcx, 7
                and     eax, 1Fh
                or      rcx, rax
                mov     rax, cs:qword_140C4DDC0
                or      rcx, 40h
                shl     rcx, 5
                test    rax, rax
                jz      short loc_14028111B
                test    rcx, rax
                jnz     short loc_140281117
                or      rax, rcx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140281117:                          ; CODE XREF: sub_1402810E0+30↑j
                or      rcx, 10h

loc_14028111B:                          ; CODE XREF: sub_1402810E0+2B↑j
                mov     rax, rcx
                retn
sub_1402810E0   endp

; ---------------------------------------------------------------------------
                align 20h
byte_140281120  db 10h dup(0CCh)        ; DATA XREF: .pdata:00000001400CEA78↑o

; =============== S U B R O U T I N E =======================================


sub_140281130   proc near               ; CODE XREF: sub_140224940+C46↑p
                                        ; sub_14029AEC0+465↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_18          = byte ptr  20h

; FUNCTION CHUNK AT 00000001404439B4 SIZE 00000076 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                mov     rax, gs:188h
                mov     rbx, r8
                mov     rsi, rdx
                mov     rdi, rcx
                mov     r8, [rax+0B8h]
                mov     eax, [r8+87Ch]
                test    al, 1
                jnz     short loc_140281185
                mov     rax, rcx
                and     rax, 0FFFFFFFFFFFFF000h
                cmp     rax, 7FFE0000h
                jz      loc_1404439B4
                cmp     rax, cs:qword_140C4DCC8
                jz      loc_1404439C6

loc_140281185:                          ; CODE XREF: sub_140281130+31↑j
                                        ; sub_140281130+1C2899↓j
                mov     eax, [rbx+30h]
                and     al, 70h
                cmp     al, 20h ; ' '
                jz      short loc_14028120C

loc_14028118E:                          ; CODE XREF: sub_140281130+E3↓j
                                        ; sub_140281130+1C28C1↓j ...
                mov     eax, [rbx+30h]
                test    al, 4
                jnz     loc_140281286
                bt      eax, 14h
                jb      loc_140281252
                mov     eax, [rbx+40h]
                bt      eax, 18h
                jb      loc_140443A0F

loc_1402811B0:                          ; CODE XREF: sub_140281130+1C28ED↓j
                shr     rdi, 0Ch
                lea     r9, [rsp+28h+arg_18]
                mov     rdx, rdi
                mov     r8d, 4
                mov     rcx, rbx
                call    sub_140283270
                mov     r8, rax
                mov     r9d, 18h
                test    rax, rax
                jz      loc_140443A22
                mov     eax, [rbx+30h]
                mov     ecx, eax
                shr     ecx, 7
                and     al, 70h
                and     ecx, 1Fh
                mov     [rsi], ecx
                cmp     al, 20h ; ' '
                jz      short loc_14028121E

loc_1402811EF:                          ; CODE XREF: sub_140281130+FB↓j
                                        ; sub_140281130+1C28F5↓j
                mov     rdx, [rbx+78h]
                test    rdx, rdx
                js      short loc_14028122D

loc_1402811F8:                          ; CODE XREF: sub_140281130+11B↓j
                                        ; sub_140281130+120↓j
                mov     rax, r8

loc_1402811FB:                          ; CODE XREF: sub_140281130+151↓j
                                        ; sub_140281130+1C2891↓j ...
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14028120C:                          ; CODE XREF: sub_140281130+5C↑j
                mov     eax, [rbx+40h]
                bt      eax, 1Ch
                jnb     loc_14028118E
                jmp     loc_1404439E1
; ---------------------------------------------------------------------------

loc_14028121E:                          ; CODE XREF: sub_140281130+BD↑j
                cmp     ecx, 7
                mov     eax, 100h
                cmovz   ecx, eax
                mov     [rsi], ecx
                jmp     short loc_1402811EF
; ---------------------------------------------------------------------------

loc_14028122D:                          ; CODE XREF: sub_140281130+C6↑j
                mov     eax, [rbx+18h]
                movzx   ecx, byte ptr [rbx+20h]
                shl     rcx, 20h
                or      rcx, rax
                mov     rax, [rdx]
                dec     rax
                sub     rdi, rcx
                shr     rax, 0Ch
                cmp     rdi, rax
                jbe     short loc_1402811F8
                mov     [rsi], r9d
                jmp     short loc_1402811F8
; ---------------------------------------------------------------------------

loc_140281252:                          ; CODE XREF: sub_140281130+6D↑j
                and     eax, 70h
                cmp     eax, 10h
                jz      short loc_140281286
                cmp     eax, 30h ; '0'
                jz      short loc_140281286
                mov     rcx, rbx
                call    sub_14034027C
                test    eax, eax
                jnz     short loc_140281286
                cmp     [rbx+34h], eax
                jge     short loc_140281286
                mov     r9d, [rbx+30h]
                shr     r9d, 7
                and     r9d, 1Fh

loc_14028127C:                          ; CODE XREF: sub_140281130+15C↓j
                xor     eax, eax
                mov     [rsi], r9d
                jmp     loc_1402811FB
; ---------------------------------------------------------------------------

loc_140281286:                          ; CODE XREF: sub_140281130+63↑j
                                        ; sub_140281130+128↑j ...
                mov     r9d, 18h
                jmp     short loc_14028127C
sub_140281130   endp

; ---------------------------------------------------------------------------
algn_14028128E:                         ; DATA XREF: .rdata:000000014005E8BC↑o
                                        ; .pdata:00000001400CEA84↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=40h

sub_1402812A0   proc near               ; CODE XREF: sub_1402498E0+311↑p
                                        ; DATA XREF: .pdata:00000001400CEA90↑o

var_120         = qword ptr -120h
var_118         = qword ptr -118h
var_110         = xmmword ptr -110h
var_100         = xmmword ptr -100h
var_F0          = xmmword ptr -0F0h
var_E0          = xmmword ptr -0E0h
var_D0          = xmmword ptr -0D0h
var_C0          = xmmword ptr -0C0h
var_B0          = xmmword ptr -0B0h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = xmmword ptr -88h
var_78          = xmmword ptr -78h
var_68          = xmmword ptr -68h
var_58          = xmmword ptr -58h
arg_0           = dword ptr  10h
arg_8           = dword ptr  18h
arg_10          = dword ptr  20h
arg_18          = qword ptr  28h

                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-8]
                sub     rsp, 108h
                mov     rax, [rcx+8]
                xorps   xmm0, xmm0
                movups  [rsp+140h+var_110], xmm0
                xor     r12d, r12d
                mov     r15, rcx
                mov     [rbp+40h+var_A0], r12
                mov     r14, [rax]
                mov     rax, 7FFFFFFFF8h
                mov     rsi, r14
                mov     rcx, 0FFFFF68000000000h
                shr     rsi, 9
                and     rsi, rax
                movups  [rsp+140h+var_100], xmm0
                movups  [rsp+140h+var_F0], xmm0
                movups  [rsp+140h+var_E0], xmm0
                movups  [rsp+140h+var_D0], xmm0
                movups  [rbp+40h+var_C0], xmm0
                movups  [rbp+40h+var_B0], xmm0
                mov     rax, rcx
                mov     r10d, [r15+20h]
                add     rsi, rax
                mov     rbx, [r15+18h]
                mov     [rbp+40h+arg_0], r10d
                mov     r8, rcx
                shl     r8, 19h
                mov     rdx, rsi
                shl     rdx, 19h
                mov     ecx, r12d
                sub     rdx, r8
                mov     [rbp+40h+var_90], r8
                sar     rdx, 10h
                mov     r9, 7FFFFFFEFFFFh
                mov     rax, rdx
                nop     word ptr [rax+rax+00000000h]

loc_140281350:                          ; CODE XREF: sub_1402812A0+E3↓j
                mov     rdi, 0FFFFF6FB7DBED000h
                mov     r13, 8000000000000000h
                mov     r11, 0FFFFF6FB7DBED7F8h
                cmp     rax, r9
                jbe     short loc_14028138A
                shl     rax, 19h
                inc     ecx
                sub     rax, r8
                sar     rax, 10h
                cmp     ecx, 3
                jb      short loc_140281350
                jmp     loc_140281669
; ---------------------------------------------------------------------------

loc_14028138A:                          ; CODE XREF: sub_1402812A0+D1↑j
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                lea     r8, [rdx+rax]
                mov     rdx, [rdx+rax]
                mov     rax, rdi
                cmp     r8, rax
                jb      short loc_140281418
                mov     rax, r11
                cmp     r8, rax
                ja      short loc_140281418
                call    sub_140349680
                test    eax, eax
                jz      short loc_140281418
                test    dl, 1
                jz      short loc_140281418
                test    dl, 20h
                jz      short loc_1402813D1
                test    dl, 42h
                jnz     short loc_140281418

loc_1402813D1:                          ; CODE XREF: sub_1402812A0+12A↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140281418
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140281418
                or      rdx, 42h

loc_140281418:                          ; CODE XREF: sub_1402812A0+10F↑j
                                        ; sub_1402812A0+117↑j ...
                mov     [rsp+140h+var_120], rdx
                mov     rax, rdi
                lea     rcx, [rsp+140h+var_120]
                cmp     rcx, rax
                jb      short loc_140281499
                mov     rax, r11
                lea     rcx, [rsp+140h+var_120]
                cmp     rcx, rax
                ja      short loc_140281499
                call    sub_140349680
                test    eax, eax
                jz      short loc_140281499
                test    dl, 1
                jz      short loc_140281499
                test    dl, 20h
                jz      short loc_14028144F
                test    dl, 42h
                jnz     short loc_140281499

loc_14028144F:                          ; CODE XREF: sub_1402812A0+1A8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140281499
                lea     rax, [rsp+140h+var_120]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140281499
                or      rdx, 42h

loc_140281499:                          ; CODE XREF: sub_1402812A0+188↑j
                                        ; sub_1402812A0+195↑j ...
                mov     rax, 0FFFFFFFFFh
                shr     rdx, 0Ch
                and     rdx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rdi, [rdx+rdx*2]
                shl     rdi, 4
                mov     rax, rax
                add     rdi, rax
                mov     [rbp+40h+arg_8], r12d
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_1402814F9
                nop

loc_1402814D0:                          ; CODE XREF: sub_1402812A0+240↓j
                                        ; sub_1402812A0+249↓j
                lea     rcx, [rbp+40h+arg_8]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_1402814D0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_1402814D0
                mov     r10d, [rbp+40h+arg_0]
                mov     r11, 0FFFFF6FB7DBED7F8h

loc_1402814F9:                          ; CODE XREF: sub_1402812A0+22D↑j
                mov     rax, [rdi+10h]
                lea     rcx, [rax+10000h]
                xor     rcx, rax
                and     ecx, 3FF0000h
                xor     rcx, rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                mov     [rdi+10h], rcx
                lock and [rdi+18h], rax
                mov     rcx, [rdi+8]
                xorps   xmm0, xmm0
                or      rcx, r13
                mov     rax, rcx
                sar     rax, 2Fh
                inc     rax
                movups  [rbp+40h+var_88], xmm0
                movups  [rbp+40h+var_78], xmm0
                cmp     rax, 1
                ja      loc_14028165F
                shr     rcx, 9
                mov     r8, 7FFFFFFFF8h
                and     rcx, r8
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                add     rcx, rax
                mov     qword ptr [rbp+40h+var_88], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     qword ptr [rbp+40h+var_88+8], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     qword ptr [rbp+40h+var_78], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     rdi, 0FFFFF6FB7DBED000h
                mov     qword ptr [rbp+40h+var_78+8], rcx
                mov     r9d, 4

loc_1402815B1:                          ; CODE XREF: sub_1402812A0+3B7↓j
                mov     r8, [rbp+r9*8+40h+var_90]
                dec     r9
                mov     rcx, [r8]
                mov     rax, rdi
                cmp     r8, rax
                jb      loc_14028164B
                mov     rax, r11
                cmp     r8, rax
                ja      short loc_14028164B
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14028164B
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_14028164B
                test    cl, 1
                jz      short loc_140281669
                test    cl, 20h
                jz      short loc_140281604
                test    cl, 42h
                jnz     short loc_14028164B

loc_140281604:                          ; CODE XREF: sub_1402812A0+35D↑j
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     rax, [rdx+788h]
                test    rax, rax
                jz      short loc_14028164B
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rcx
                or      r8, 20h
                movzx   edx, al
                and     dl, 20h
                cmovz   r8, rcx
                mov     rcx, r8
                test    al, 42h
                jz      short loc_14028164B
                or      rcx, 42h

loc_14028164B:                          ; CODE XREF: sub_1402812A0+322↑j
                                        ; sub_1402812A0+32E↑j ...
                test    cl, 1
                jz      short loc_140281669
                test    cl, cl
                js      short loc_140281669
                test    r9, r9
                jnz     loc_1402815B1
                jmp     short loc_140281669
; ---------------------------------------------------------------------------

loc_14028165F:                          ; CODE XREF: sub_1402812A0+2A3↑j
                mov     rdi, 0FFFFF6FB7DBED000h

loc_140281669:                          ; CODE XREF: sub_1402812A0+E5↑j
                                        ; sub_1402812A0+358↑j ...
                cmp     r10d, 100h
                jnz     short loc_140281697
                mov     rax, cs:qword_140C4DDC0
                shl     rbx, 10h
                bts     rbx, 0Ah
                test    rax, rax
                jz      short loc_1402816B0
                test    rax, rbx
                jnz     short loc_140281691
                or      rbx, rax
                jmp     short loc_1402816B0
; ---------------------------------------------------------------------------

loc_140281691:                          ; CODE XREF: sub_1402812A0+3EA↑j
                or      rbx, 10h
                jmp     short loc_1402816B0
; ---------------------------------------------------------------------------

loc_140281697:                          ; CODE XREF: sub_1402812A0+3D0↑j
                mov     ecx, r10d
                and     ecx, 1Fh
                or      rcx, 0FFFFFFFFF8000020h
                shl     rcx, 5
                call    sub_14027C6C0
                mov     rbx, rax

loc_1402816B0:                          ; CODE XREF: sub_1402812A0+3E5↑j
                                        ; sub_1402812A0+3EF↑j ...
                mov     rax, rdi
                cmp     rsi, rax
                jb      short loc_14028170E
                mov     rax, r11
                cmp     rsi, rax
                ja      short loc_14028170E
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402816EA
                cmp     byte ptr cs:word_140C4DE88+1, r12b
                jnz     short loc_1402816DA
                test    bl, 1
                jz      short loc_1402816DA
                or      rbx, r13

loc_1402816DA:                          ; CODE XREF: sub_1402812A0+430↑j
                                        ; sub_1402812A0+435↑j
                mov     rdx, rbx
                mov     [rsi], rbx
                mov     rcx, rsi
                call    sub_140349620
                jmp     short loc_140281711
; ---------------------------------------------------------------------------

loc_1402816EA:                          ; CODE XREF: sub_1402812A0+427↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14028170E
                test    bl, 1
                jz      short loc_14028170E
                or      rbx, r13

loc_14028170E:                          ; CODE XREF: sub_1402812A0+416↑j
                                        ; sub_1402812A0+41E↑j ...
                mov     [rsi], rbx

loc_140281711:                          ; CODE XREF: sub_1402812A0+448↑j
                mov     r13, [r15+40h]
                test    r13, r13
                jz      loc_140281E42
                mov     eax, [r13+18h]
                lea     r9, qword_14002DE90
                movzx   r8d, byte ptr [r13+20h]
                movzx   ecx, byte ptr [r13+21h]
                mov     edx, [r13+30h]
                shl     r8, 20h
                or      r8, rax
                shl     rcx, 20h
                mov     eax, [r13+1Ch]
                or      rcx, rax
                mov     [rbp+40h+var_98], r8
                mov     eax, edx
                shr     rax, 12h
                and     eax, 3
                cmp     qword ptr [r9+rax*8], 10h
                jnz     short loc_1402817A1
                and     r14, 0FFFFFFFFFFFF0000h
                mov     qword ptr [rsp+140h+var_110+8], 10000h
                mov     rax, r14
                mov     qword ptr [rsp+140h+var_110], r14
                shr     rax, 0Ch
                cmp     rax, r8
                jb      loc_140281E42
                lea     rax, [r14+0FFFFh]
                shr     rax, 0Ch
                cmp     rax, rcx
                ja      loc_140281E42
                mov     r9d, 10h
                jmp     loc_14028183F
; ---------------------------------------------------------------------------

loc_1402817A1:                          ; CODE XREF: sub_1402812A0+4BB↑j
                mov     eax, [r15]
                test    al, 2
                jz      short loc_140281801
                mov     rax, [r15+38h]
                mov     r9d, 100h
                shr     r14, 0Ch
                sub     rcx, r14
                mov     [rbp+40h+arg_18], r9
                inc     rcx
                movups  xmm0, xmmword ptr [rax]
                movups  xmm1, xmmword ptr [rax+10h]
                movaps  [rsp+140h+var_100], xmm0
                movaps  [rsp+140h+var_F0], xmm1
                movups  xmm0, xmmword ptr [rax+20h]
                movups  xmm1, xmmword ptr [rax+30h]
                movaps  [rsp+140h+var_E0], xmm0
                movaps  [rsp+140h+var_D0], xmm1
                movups  xmm0, xmmword ptr [rax+40h]
                movups  xmm1, xmmword ptr [rax+50h]
                movaps  [rbp+40h+var_C0], xmm0
                movaps  [rbp+40h+var_B0], xmm1
                cmp     rcx, r9
                jnb     short loc_140281867
                mov     r9, rcx
                mov     [rbp+40h+arg_18], rcx
                jmp     short loc_140281867
; ---------------------------------------------------------------------------

loc_140281801:                          ; CODE XREF: sub_1402812A0+506↑j
                and     dl, 70h
                cmp     dl, 20h ; ' '
                jz      loc_140281E42
                mov     rax, r14
                mov     r9d, 8
                and     rax, 0FFFFFFFFFFFFF000h
                shr     r14, 0Ch
                sub     rcx, r14
                mov     qword ptr [rsp+140h+var_110], rax
                lea     rax, [rcx+1]
                cmp     rax, r9
                cmovb   r9, rax
                mov     rax, r9
                shl     rax, 0Ch
                mov     qword ptr [rsp+140h+var_110+8], rax

loc_14028183F:                          ; CODE XREF: sub_1402812A0+4FC↑j
                lea     rax, [rsp+140h+var_110]
                mov     qword ptr [rsp+140h+var_E0], r12
                mov     qword ptr [rsp+140h+var_100+8], rax
                mov     qword ptr [rsp+140h+var_F0+8], r12
                mov     qword ptr [rsp+140h+var_F0], 1
                mov     word ptr [rsp+140h+var_100], 2
                mov     [rbp+40h+arg_18], r9

loc_140281867:                          ; CODE XREF: sub_1402812A0+556↑j
                                        ; sub_1402812A0+55F↑j
                mov     rdx, r12
                mov     r15, r12
                test    r9, r9
                jz      loc_140281E42
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140281880:                          ; CODE XREF: sub_1402812A0+B9C↓j
                mov     r12, qword ptr [rsp+140h+var_F0+8]
                mov     rax, 7FFFFFFFF8h
                mov     r14, qword ptr [rsp+140h+var_E0]
                shl     r14, 0Ch
                shl     r12, 4
                add     r12, qword ptr [rsp+140h+var_100+8]
                add     r14, [r12]
                and     r14, 0FFFFFFFFFFFFF000h
                mov     rsi, r14
                shr     rsi, 9
                and     rsi, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     rsi, rax
                test    r15, r15
                jz      short loc_1402818E8
                lea     rax, [rdx+1000h]
                cmp     r14, rax
                jnz     loc_140281E42
                test    rsi, 0FFFh
                jz      loc_140281E42

loc_1402818E8:                          ; CODE XREF: sub_1402812A0+629↑j
                mov     rdx, [rsi]
                mov     rax, rdi
                cmp     rsi, rax
                jb      short loc_14028195B
                mov     rax, r11
                cmp     rsi, rax
                ja      short loc_14028195B
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028195B
                test    dl, 1
                jz      short loc_14028195B
                test    dl, 20h
                jz      short loc_140281913
                test    dl, 42h
                jnz     short loc_14028195B

loc_140281913:                          ; CODE XREF: sub_1402812A0+66C↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14028195B
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028195B
                or      rdx, 42h

loc_14028195B:                          ; CODE XREF: sub_1402812A0+651↑j
                                        ; sub_1402812A0+659↑j ...
                test    rdx, rdx
                jnz     loc_140281DC2
                lea     r8d, [rdx+4]
                mov     rdi, r14
                shr     rdi, 0Ch
                lea     r9, [rbp+40h+var_A0]
                mov     rdx, rdi
                mov     rcx, r13
                call    sub_140283270
                mov     rbx, rax
                test    rax, rax
                jz      loc_140281E42
                mov     rax, [r13+78h]
                test    rax, rax
                jns     short loc_1402819AA
                mov     rax, [rax]
                sub     rdi, [rbp+40h+var_98]
                dec     rax
                shr     rax, 0Ch
                cmp     rdi, rax
                ja      loc_140281E42

loc_1402819AA:                          ; CODE XREF: sub_1402812A0+6F1↑j
                mov     r8, [rbp+40h+var_90]
                mov     rdx, rsi
                shl     rdx, 19h
                mov     r9, 7FFFFFFEFFFFh
                sub     rdx, r8
                sar     rdx, 10h
                mov     rax, rdx
                xor     ecx, ecx
                nop     dword ptr [rax+rax+00h]

loc_1402819D0:                          ; CODE XREF: sub_1402812A0+745↓j
                cmp     rax, r9
                jbe     short loc_140281A25
                shl     rax, 19h
                inc     ecx
                sub     rax, r8
                sar     rax, 10h
                cmp     ecx, 3
                jb      short loc_1402819D0
                mov     r8, 8000000000000000h

loc_1402819F1:                          ; CODE XREF: sub_1402812A0+959↓j
                mov     r11, 0FFFFF6FB7DBED7F8h

loc_1402819FB:                          ; CODE XREF: sub_1402812A0+A86↓j
                mov     r10d, [rbp+40h+arg_0]
                cmp     r10d, 100h
                jnz     loc_140281D2B
                shl     rbx, 10h
                bts     rbx, 0Ah
                mov     rcx, rbx
                call    sub_14027C6C0
                mov     rdx, rax
                jmp     loc_140281D56
; ---------------------------------------------------------------------------

loc_140281A25:                          ; CODE XREF: sub_1402812A0+733↑j
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                lea     r8, [rdx+rax]
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rdx, [r8]
                mov     rax, r10
                mov     r9, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                jb      short loc_140281AC6
                mov     rax, r9
                cmp     r8, rax
                ja      short loc_140281AC6
                call    sub_140349680
                test    eax, eax
                jz      short loc_140281AC6
                test    dl, 1
                jz      short loc_140281AC6
                test    dl, 20h
                jz      short loc_140281A7F
                test    dl, 42h
                jnz     short loc_140281AC6

loc_140281A7F:                          ; CODE XREF: sub_1402812A0+7D8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140281AC6
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140281AC6
                or      rdx, 42h

loc_140281AC6:                          ; CODE XREF: sub_1402812A0+7BD↑j
                                        ; sub_1402812A0+7C5↑j ...
                mov     [rsp+140h+var_118], rdx
                mov     rax, r10
                lea     rcx, [rsp+140h+var_118]
                cmp     rcx, rax
                jb      short loc_140281B47
                mov     rax, r9
                lea     rcx, [rsp+140h+var_118]
                cmp     rcx, rax
                ja      short loc_140281B47
                call    sub_140349680
                test    eax, eax
                jz      short loc_140281B47
                test    dl, 1
                jz      short loc_140281B47
                test    dl, 20h
                jz      short loc_140281AFD
                test    dl, 42h
                jnz     short loc_140281B47

loc_140281AFD:                          ; CODE XREF: sub_1402812A0+856↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140281B47
                lea     rax, [rsp+140h+var_118]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140281B47
                or      rdx, 42h

loc_140281B47:                          ; CODE XREF: sub_1402812A0+836↑j
                                        ; sub_1402812A0+843↑j ...
                mov     rax, 0FFFFFFFFFh
                shr     rdx, 0Ch
                and     rdx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rdi, [rdx+rdx*2]
                shl     rdi, 4
                mov     rax, rax
                add     rdi, rax
                mov     [rbp+40h+arg_10], 0
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_140281BA5

loc_140281B80:                          ; CODE XREF: sub_1402812A0+8F0↓j
                                        ; sub_1402812A0+8F9↓j
                lea     rcx, [rbp+40h+arg_10]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140281B80
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140281B80
                mov     r10, 0FFFFF6FB7DBED000h

loc_140281BA5:                          ; CODE XREF: sub_1402812A0+8DE↑j
                mov     rax, [rdi+10h]
                lea     rcx, [rax+10000h]
                xor     rcx, rax
                and     ecx, 3FF0000h
                xor     rcx, rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                mov     [rdi+10h], rcx
                lock and [rdi+18h], rax
                mov     rcx, [rdi+8]
                xorps   xmm0, xmm0
                mov     r8, 8000000000000000h
                or      rcx, r8
                mov     rax, rcx
                sar     rax, 2Fh
                inc     rax
                movups  [rbp+40h+var_68], xmm0
                movups  [rbp+40h+var_58], xmm0
                cmp     rax, 1
                ja      loc_1402819F1
                shr     rcx, 9
                mov     r8, 7FFFFFFFF8h
                and     rcx, r8
                mov     rdx, 0FFFFF68000000000h
                mov     r9d, 4
                mov     rax, rdx
                add     rcx, rax
                mov     qword ptr [rbp+40h+var_68], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     qword ptr [rbp+40h+var_68+8], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     qword ptr [rbp+40h+var_58], rcx
                shr     rcx, 9
                and     rcx, r8
                mov     rax, rdx
                add     rcx, rax
                mov     r11, 0FFFFF6FB7DBED7F8h
                mov     qword ptr [rbp+40h+var_58+8], rcx
                nop     word ptr [rax+rax+00000000h]

loc_140281C70:                          ; CODE XREF: sub_1402812A0+A76↓j
                mov     r8, qword ptr [rbp+r9*8+40h+var_78+8]
                dec     r9
                mov     rcx, [r8]
                mov     rax, r10
                cmp     r8, rax
                jb      loc_140281D0A
                mov     rax, r11
                cmp     r8, rax
                ja      short loc_140281D0A
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_140281D0A
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_140281D0A
                test    cl, 1
                jz      short loc_140281D1C
                test    cl, 20h
                jz      short loc_140281CC3
                test    cl, 42h
                jnz     short loc_140281D0A

loc_140281CC3:                          ; CODE XREF: sub_1402812A0+A1C↑j
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     rax, [rdx+788h]
                test    rax, rax
                jz      short loc_140281D0A
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rcx
                or      r8, 20h
                movzx   edx, al
                and     dl, 20h
                cmovz   r8, rcx
                mov     rcx, r8
                test    al, 42h
                jz      short loc_140281D0A
                or      rcx, 42h

loc_140281D0A:                          ; CODE XREF: sub_1402812A0+9E1↑j
                                        ; sub_1402812A0+9ED↑j ...
                test    cl, 1
                jz      short loc_140281D1C
                test    cl, cl
                js      short loc_140281D1C
                test    r9, r9
                jnz     loc_140281C70

loc_140281D1C:                          ; CODE XREF: sub_1402812A0+A17↑j
                                        ; sub_1402812A0+A6D↑j ...
                mov     r8, 8000000000000000h
                jmp     loc_1402819FB
; ---------------------------------------------------------------------------

loc_140281D2B:                          ; CODE XREF: sub_1402812A0+766↑j
                mov     rax, cs:qword_140C4DDC0
                mov     edx, r10d
                and     edx, 1Fh
                or      rdx, 0FFFFFFFFF8000020h
                shl     rdx, 5
                test    rax, rax
                jz      short loc_140281D56
                test    rdx, rax
                jnz     short loc_140281D52
                or      rdx, rax
                jmp     short loc_140281D56
; ---------------------------------------------------------------------------

loc_140281D52:                          ; CODE XREF: sub_1402812A0+AAB↑j
                or      rdx, 10h

loc_140281D56:                          ; CODE XREF: sub_1402812A0+780↑j
                                        ; sub_1402812A0+AA6↑j ...
                mov     rdi, 0FFFFF6FB7DBED000h
                mov     rax, rdi
                cmp     rsi, rax
                jb      short loc_140281DBB
                mov     rax, r11
                cmp     rsi, rax
                ja      short loc_140281DBB
                call    sub_140349680
                test    eax, eax
                jz      short loc_140281D97
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140281D8A
                test    dl, 1
                jz      short loc_140281D8A
                or      rdx, r8

loc_140281D8A:                          ; CODE XREF: sub_1402812A0+AE0↑j
                                        ; sub_1402812A0+AE5↑j
                mov     rcx, rsi
                mov     [rsi], rdx
                call    sub_140349620
                jmp     short loc_140281DBE
; ---------------------------------------------------------------------------

loc_140281D97:                          ; CODE XREF: sub_1402812A0+AD7↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140281DBB
                test    dl, 1
                jz      short loc_140281DBB
                or      rdx, r8

loc_140281DBB:                          ; CODE XREF: sub_1402812A0+AC6↑j
                                        ; sub_1402812A0+ACE↑j ...
                mov     [rsi], rdx

loc_140281DBE:                          ; CODE XREF: sub_1402812A0+AF5↑j
                mov     r9, [rbp+40h+arg_18]

loc_140281DC2:                          ; CODE XREF: sub_1402812A0+6BE↑j
                mov     ecx, [r12]
                mov     rdx, qword ptr [rsp+140h+var_E0]
                and     ecx, 0FFFh
                mov     rax, [r12+8]
                inc     rdx
                add     rax, 0FFFh
                mov     qword ptr [rsp+140h+var_E0], rdx
                add     rcx, rax
                shr     rcx, 0Ch
                cmp     rdx, rcx
                jnz     short loc_140281E1D
                mov     rcx, qword ptr [rsp+140h+var_F0+8]
                inc     rcx
                mov     qword ptr [rsp+140h+var_E0], 0
                mov     qword ptr [rsp+140h+var_F0+8], rcx
                cmp     rcx, qword ptr [rsp+140h+var_F0]
                jnb     short loc_140281E1D
                mov     rax, qword ptr [rsp+140h+var_100+8]
                add     rcx, rcx
                cmp     qword ptr [rax+rcx*8+8], 0
                jz      short loc_140281E42

loc_140281E1D:                          ; CODE XREF: sub_1402812A0+B4E↑j
                                        ; sub_1402812A0+B6B↑j
                mov     rax, qword ptr [rsp+140h+var_F0]
                cmp     qword ptr [rsp+140h+var_F0+8], rax
                jz      short loc_140281E42
                inc     r15
                mov     r11, 0FFFFF6FB7DBED7F8h
                mov     rdx, r14
                cmp     r15, r9
                jb      loc_140281880

loc_140281E42:                          ; CODE XREF: sub_1402812A0+478↑j
                                        ; sub_1402812A0+4DC↑j ...
                add     rsp, 108h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_1402812A0   endp

algn_140281E57:                         ; DATA XREF: .pdata:00000001400CEA90↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=100h

sub_140281E60   proc near               ; CODE XREF: sub_1402675F0+CA↑p
                                        ; sub_1402675F0+170↑p ...

var_1E0         = qword ptr -1E0h
var_1D0         = byte ptr -1D0h
var_1CC         = word ptr -1CCh
var_1C8         = dword ptr -1C8h
var_1C4         = dword ptr -1C4h
var_1C0         = qword ptr -1C0h
var_1B8         = qword ptr -1B8h
var_1B0         = word ptr -1B0h
var_1AC         = dword ptr -1ACh
var_1A8         = qword ptr -1A8h
var_1A0         = qword ptr -1A0h
var_198         = qword ptr -198h
var_190         = dword ptr -190h
var_188         = qword ptr -188h
var_180         = dword ptr -180h
var_17C         = dword ptr -17Ch
var_178         = qword ptr -178h
var_170         = dword ptr -170h
var_16C         = dword ptr -16Ch
var_168         = qword ptr -168h
var_160         = qword ptr -160h
var_158         = qword ptr -158h
var_150         = qword ptr -150h
var_148         = qword ptr -148h
var_140         = qword ptr -140h
var_138         = qword ptr -138h
var_130         = xmmword ptr -130h
var_120         = qword ptr -120h
var_118         = qword ptr -118h
var_110         = qword ptr -110h
var_100         = word ptr -100h
var_FE          = byte ptr -0FEh
var_FA          = byte ptr -0FAh
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
arg_20          = qword ptr  30h
arg_28          = qword ptr  38h
arg_30          = qword ptr  40h
arg_38          = qword ptr  48h
arg_40          = qword ptr  50h
arg_48          = qword ptr  58h

; __unwind { // __GSHandlerCheck
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-0C8h]
                sub     rsp, 1C8h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+100h+var_50], rax
                mov     rax, [rbp+100h+arg_28]
                mov     r15, rcx
                mov     [rbp+100h+var_148], rax
                movzx   r13d, r8b
                mov     rax, [rbp+100h+arg_30]
                mov     rdi, r15
                mov     [rbp+100h+var_140], rax
                mov     rax, [rbp+100h+arg_38]
                mov     [rbp+100h+var_138], rax
                mov     rax, [rbp+100h+arg_40]
                mov     [rbp+100h+var_150], rax
                mov     rax, gs:188h
                mov     [rsp+200h+var_1D0], r8b
                mov     r8, rdx
                mov     rdx, [rbp+100h+arg_48]
                mov     [rsp+200h+var_198], r9
                xor     r9d, r9d
                mov     rax, [rax+0B8h]
                add     rax, 680h
                mov     [rbp+100h+var_118], rdx
                mov     [rsp+200h+var_1C0], rax
                shr     rdi, 9
                mov     [rsp+200h+var_1A8], r9
                movzx   ecx, word ptr [rax+0AEh]
                mov     rax, cs:qword_140C4E4C8
                mov     [rbp+100h+var_178], r9
                mov     rcx, [rax+rcx*8]
                movzx   eax, word ptr [rcx]
                mov     dword ptr [rdx], 1
                mov     rdx, 7FFFFFFFF8h
                and     rdi, rdx
                mov     [rsp+200h+var_1B0], ax
                mov     [rsp+200h+var_1CC], ax
                mov     rcx, 0FFFFF68000000000h
                mov     rax, rcx
                add     rdi, rax
                shr     r8, 9
                mov     [rbp+100h+var_110], rdi
                and     r8, rdx
                mov     rax, rcx
                add     r8, rax
                mov     [rsp+200h+var_1B8], rdi
                mov     eax, 2000h
                mov     [rbp+100h+var_160], r8
                mov     [rbp+100h+var_170], eax
                mov     r12d, r9d
                mov     [rbp+100h+var_180], r9d
                mov     [rbp+100h+var_17C], r9d
                mov     [rsp+200h+var_188], r9
                mov     rbx, rcx
                shl     rbx, 19h
                mov     rax, r8
                shl     rax, 19h
                sub     rax, rbx
                mov     [rbp+100h+var_158], rbx
                sar     rax, 10h
                mov     [rbp+100h+var_120], rax
                nop     word ptr [rax+rax+00000000h]

loc_140281FA0:                          ; CODE XREF: sub_140281E60+122D↓j
                mov     [rbp+100h+var_168], r8
                lea     rcx, [rbp+100h+var_FE]
                xorps   xmm0, xmm0
                mov     [rsp+200h+var_190], r9d
                mov     r8d, 0AEh
                mov     [rsp+200h+var_1A0], r9
                xor     edx, edx
                mov     esi, r9d
                movups  [rbp+100h+var_130], xmm0
                call    memset
                mov     r14, rdi
                mov     rdx, 0FFFFF68000000000h
                shl     r14, 19h
                mov     eax, 861h
                sub     r14, rbx
                mov     [rbp+100h+var_100], ax
                sar     r14, 10h
                mov     rcx, r14
                mov     rax, rdx
                cmp     r14, rax
                jb      short loc_140282021
                mov     r13, 0FFFFF6FFFFFFFFFFh
                nop

loc_140282000:                          ; CODE XREF: sub_140281E60+1B9↓j
                mov     rax, r13
                cmp     rcx, rax
                ja      short loc_14028201B
                shl     rcx, 19h
                sub     rcx, rbx
                sar     rcx, 10h
                mov     rax, rdx
                cmp     rcx, rax
                jnb     short loc_140282000

loc_14028201B:                          ; CODE XREF: sub_140281E60+1A6↑j
                movzx   r13d, [rsp+200h+var_1D0]

loc_140282021:                          ; CODE XREF: sub_140281E60+193↑j
                mov     rax, 0FFFF800000000000h
                cmp     rcx, rax
                jb      short loc_140282051
                cmp     rcx, cs:qword_140C4F9B8
                jb      short loc_140282042
                cmp     rcx, cs:qword_140C4E1E8
                jbe     short loc_140282051

loc_140282042:                          ; CODE XREF: sub_140281E60+1D7↑j
                mov     ecx, 1
                call    sub_1402A46FC
                mov     rbx, rax
                jmp     short loc_140282068
; ---------------------------------------------------------------------------

loc_140282051:                          ; CODE XREF: sub_140281E60+1CE↑j
                                        ; sub_140281E60+1E0↑j
                mov     rax, gs:188h
                mov     rbx, [rax+0B8h]
                add     rbx, 680h

loc_140282068:                          ; CODE XREF: sub_140281E60+1EF↑j
                xor     r8d, r8d
                mov     rdx, r14
                mov     rcx, rbx
                call    sub_1402258A0
                test    eax, eax
                jz      short loc_1402820A7
                lea     edx, [rax-1]
                shr     r14, 9
                mov     r9, 7FFFFFFFF8h
                mov     dword ptr [rbp+100h+var_130], edx
                and     r14, r9
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                add     r14, rax
                mov     qword ptr [rbp+100h+var_130+8], r14
                jmp     short loc_140282110
; ---------------------------------------------------------------------------

loc_1402820A7:                          ; CODE XREF: sub_140281E60+218↑j
                or      [rbp+100h+var_100], 4
                lea     rax, [rbp+100h+var_130]
                mov     [rbp+100h+var_58], rax
                lea     rcx, [rbp+100h+var_100]
                movzx   eax, [rbp+100h+var_FE]
                and     al, 0E7h
                mov     [rbp+100h+var_F0], 0
                or      al, 4
                mov     [rbp+100h+var_E8], rbx
                mov     [rbp+100h+var_FE], al
                lea     rax, sub_14034E280
                mov     [rbp+100h+var_60], rax
                mov     rax, [rbp+100h+var_120]
                mov     [rbp+100h+var_D8], rax
                mov     [rbp+100h+var_FA], r13b
                mov     [rbp+100h+var_E0], r14
                call    sub_140220490
                mov     edx, dword ptr [rbp+100h+var_130]
                mov     r9, 7FFFFFFFF8h
                mov     r14, qword ptr [rbp+100h+var_130+8]
                mov     r8, 0FFFFF68000000000h

loc_140282110:                          ; CODE XREF: sub_140281E60+245↑j
                test    r14, r14
                jnz     short loc_140282122
                mov     r14, [rbp+100h+var_160]
                add     r14, 8
                jmp     loc_1402821AB
; ---------------------------------------------------------------------------

loc_140282122:                          ; CODE XREF: sub_140281E60+2B3↑j
                mov     r13, r14
                shr     r13, 9
                and     r13, r9
                mov     rax, r8
                add     r13, rax
                mov     [rsp+200h+var_188], r13
                test    edx, edx
                jz      loc_140282258
                mov     rbx, r13
                cmp     edx, 1
                jbe     short loc_140282163
                lea     ecx, [rdx-1]
                nop     word ptr [rax+rax+00h]

loc_140282150:                          ; CODE XREF: sub_140281E60+301↓j
                shr     rbx, 9
                and     rbx, r9
                mov     rax, r8
                add     rbx, rax
                sub     rcx, 1
                jnz     short loc_140282150

loc_140282163:                          ; CODE XREF: sub_140281E60+2E5↑j
                mov     r13, rbx
                shr     r13, 9
                and     r13, r9
                mov     rax, r8
                add     r13, rax
                cmp     r14, rdi
                jz      loc_140283092

loc_14028217C:                          ; CODE XREF: sub_140281E60+3FB↓j
                mov     rcx, [rsp+200h+var_1C0]
                mov     rdx, r13
                call    sub_140312B40
                xor     edx, edx
                mov     r13, r14
                and     r13, 0FFFFFFFFFFFFF000h
                mov     [rsp+200h+var_188], rdx
                sub     r13, 8

loc_14028219E:                          ; CODE XREF: sub_140281E60+434↓j
                cmp     r13, [rbp+100h+var_160]
                cmova   r13, [rbp+100h+var_160]
                mov     [rbp+100h+var_168], r13

loc_1402821AB:                          ; CODE XREF: sub_140281E60+2BD↑j
                xor     r10d, r10d
                xchg    ax, ax

loc_1402821B0:                          ; CODE XREF: sub_140281E60+11E1↓j
                mov     rdx, [rsp+200h+var_1A0]
                mov     ebx, r10d
                mov     [rsp+200h+var_1C4], r10d
                mov     r13d, 2000h
                mov     [rsp+200h+var_1AC], r10d
                mov     [rsp+200h+var_1C8], ebx
                test    rdx, rdx
                jz      loc_140282356
                mov     r8, rdx
                mov     r11, 0FFFFF6FB7DBED000h
                mov     rax, r11
                lea     rcx, [rsp+200h+var_1A0]
                cmp     rcx, rax
                jb      loc_1402822BE
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                lea     rcx, [rsp+200h+var_1A0]
                cmp     rcx, rax
                ja      loc_1402822BE
                call    sub_140349680
                test    eax, eax
                jz      loc_1402822BE
                test    r8b, 1
                jz      loc_1402822BE
                test    r8b, 20h
                jz      short loc_140282235
                test    r8b, 42h
                jnz     loc_1402822BE

loc_140282235:                          ; CODE XREF: sub_140281E60+3C9↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     short loc_140282299
                mov     rdx, [rsp+200h+var_1A0]
                jmp     short loc_1402822BE
; ---------------------------------------------------------------------------

loc_140282258:                          ; CODE XREF: sub_140281E60+2D9↑j
                cmp     rdi, r14
                jnz     loc_14028217C
                mov     rcx, rdi
                call    sub_1402805F0
                xor     esi, esi
                mov     [rsp+200h+var_1A0], rax
                mov     r13, rdi
                mov     [rsp+200h+var_190], 1
                and     r13, 0FFFFFFFFFFFFF000h
                lea     r14, [rdi+8]
                add     r13, 0FF8h
                test    rax, rax
                setz    sil
                jmp     loc_14028219E
; ---------------------------------------------------------------------------

loc_140282299:                          ; CODE XREF: sub_140281E60+3EF↑j
                lea     rax, [rsp+200h+var_1A0]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r8
                test    al, 20h
                jz      short loc_1402822B6
                or      rdx, 20h

loc_1402822B6:                          ; CODE XREF: sub_140281E60+450↑j
                test    al, 42h
                jz      short loc_1402822BE
                or      rdx, 42h

loc_1402822BE:                          ; CODE XREF: sub_140281E60+38D↑j
                                        ; sub_140281E60+3A8↑j ...
                mov     rax, rdx
                and     eax, 3E0h
                cmp     rax, 200h
                jnz     short loc_1402822EE
                test    dl, 1
                jnz     short loc_1402822EE
                bt      rdx, 0Ah
                jnb     loc_140282C29
                mov     rcx, rdx
                call    sub_14031C870
                test    eax, eax
                jnz     loc_140282C29

loc_1402822EE:                          ; CODE XREF: sub_140281E60+46C↑j
                                        ; sub_140281E60+471↑j
                mov     rcx, [rsp+200h+var_198]
                lea     rax, [rsp+200h+var_1CC]
                lea     r9, [rsp+200h+var_1AC]
                mov     [rsp+200h+var_1E0], rax
                lea     r8, [rsp+200h+var_1A8]
                mov     rdx, rdi
                mov     r13d, 1000h
                call    sub_1402834D0
                mov     rbx, [rsp+200h+var_1A8]
                test    rbx, rbx
                jnz     loc_140283046
                mov     ebx, [rsp+200h+var_1C8]
                xor     r10d, r10d
                mov     rsi, [rsp+200h+var_1C0]
                mov     r15d, eax
                mov     rcx, [rbp+100h+arg_20]
                mov     r11, 0FFFFF6FB7DBED000h
                test    eax, eax
                jnz     loc_14028252C
                mov     r13d, 2000h
                jmp     loc_14028252C
; ---------------------------------------------------------------------------

loc_140282356:                          ; CODE XREF: sub_140281E60+36F↑j
                mov     rax, [rbp+100h+var_118]
                mov     r11, [rsp+200h+var_198]
                mov     [rax], r10d
                mov     r9d, [r11+30h]
                mov     eax, r9d
                and     eax, 70h
                cmp     al, 30h ; '0'
                jz      loc_140282C06
                mov     eax, r9d
                and     al, 70h
                cmp     al, 10h
                jz      loc_140282C06
                bt      r9d, 14h
                jnb     loc_140282417
                cmp     dword ptr [r11+34h], 0
                jge     short loc_1402823B2
                mov     r15d, r9d
                mov     rcx, r11
                shr     r15d, 7
                mov     r13d, 1000h
                and     r15d, 1Fh
                call    sub_140267530
                mov     [rsp+200h+var_1AC], eax
                jmp     short loc_1402823B5
; ---------------------------------------------------------------------------

loc_1402823B2:                          ; CODE XREF: sub_140281E60+531↑j
                mov     r15d, ebx

loc_1402823B5:                          ; CODE XREF: sub_140281E60+550↑j
                and     r9d, 500000h
                cmp     r9d, 500000h
                jnz     loc_140282516
                mov     edx, 10h
                mov     rcx, r11
                call    sub_1402EBB3C
                test    rax, rax
                jz      loc_140282516
                mov     r8, [rax+18h]
                test    r8, r8
                jz      loc_140282516
                mov     rcx, r8
                call    sub_1402073F0
                test    al, al
                jz      loc_140282516
                mov     rax, [r8]
                movzx   ecx, word ptr [rax]
                mov     [rsp+200h+var_1CC], cx
                mov     rcx, r8
                call    sub_1402073C8
                xor     r10d, r10d
                jmp     loc_140282516
; ---------------------------------------------------------------------------

loc_140282417:                          ; CODE XREF: sub_140281E60+526↑j
                mov     rax, [r11+48h]
                lea     r9, [rbp+100h+var_178]
                shr     r15, 0Ch
                mov     r8d, 4
                mov     rdx, r15
                mov     rcx, [rax]
                mov     rax, cs:qword_140C4E4C8
                movzx   ecx, word ptr [rcx+3Ch]
                and     ecx, 3FFh
                mov     rcx, [rax+rcx*8]
                movzx   eax, word ptr [rcx]
                mov     rcx, r11
                mov     [rsp+200h+var_1CC], ax
                call    sub_140283270
                mov     [rsp+200h+var_1A8], rax
                mov     rdi, rax
                test    rax, rax
                jnz     loc_14028257B
                mov     rcx, [rbp+100h+arg_20]
                xor     r10d, r10d
                test    rcx, rcx
                jz      short loc_1402824A4
                xor     r9d, r9d
                mov     word ptr [rsp+200h+var_1E0], r10w
                xor     r8d, r8d
                mov     edx, r13d
                call    sub_140347BD4
                test    eax, eax
                jnz     short loc_1402824A4
                mov     rdi, [rsp+200h+var_1B8]
                mov     ebx, 1
                mov     r15d, [rsp+200h+var_1C4]
                mov     r14, rdi
                mov     [rsp+200h+var_1C8], ebx
                jmp     short loc_14028251D
; ---------------------------------------------------------------------------

loc_1402824A4:                          ; CODE XREF: sub_140281E60+612↑j
                                        ; sub_140281E60+62A↑j
                mov     r11, [rsp+200h+var_198]
                mov     rcx, r11
                call    sub_140233020
                test    eax, eax
                jz      short loc_14028250A
                mov     rax, [rbp+100h+var_178]
                test    rax, rax
                jz      short loc_14028250A
                cmp     qword ptr [rax+8], 0
                jnz     short loc_14028250A
                mov     rdi, [rsp+200h+var_1B8]
                mov     r9, r14
                mov     r8, rdi
                mov     [rsp+200h+var_1E0], rax
                mov     rdx, r15
                mov     rcx, r11
                call    sub_140547920
                mov     rsi, [rsp+200h+var_1C0]
                xor     r10d, r10d
                mov     rcx, [rbp+100h+arg_20]
                mov     r14, rax
                mov     r11, 0FFFFF6FB7DBED000h
                mov     r15d, ebx
                cmp     rax, rdi
                jnz     short loc_14028252C
                lea     r14, [rdi+8]
                jmp     short loc_14028252C
; ---------------------------------------------------------------------------

loc_14028250A:                          ; CODE XREF: sub_140281E60+653↑j
                                        ; sub_140281E60+65C↑j ...
                mov     rdi, [rsp+200h+var_1B8]
                lea     r14, [rdi+8]

loc_140282513:                          ; CODE XREF: sub_140281E60+DAE↓j
                                        ; sub_140281E60+DC4↓j
                mov     r15d, ebx

loc_140282516:                          ; CODE XREF: sub_140281E60+563↑j
                                        ; sub_140281E60+579↑j ...
                mov     rcx, [rbp+100h+arg_20]

loc_14028251D:                          ; CODE XREF: sub_140281E60+642↑j
                mov     rsi, [rsp+200h+var_1C0]

loc_140282522:                          ; CODE XREF: sub_140281E60+D04↓j
                mov     r11, 0FFFFF6FB7DBED000h

loc_14028252C:                          ; CODE XREF: sub_140281E60+4E5↑j
                                        ; sub_140281E60+4F1↑j ...
                mov     r8, [rbp+100h+var_110]
                cmp     rdi, r8
                jnz     loc_140282C4F
                movzx   eax, [rsp+200h+var_1CC]
                mov     ebx, [rsp+200h+var_1AC]
                mov     [rsp+200h+var_1B0], ax
                mov     [rbp+100h+var_170], r13d
                mov     [rbp+100h+var_180], r15d
                mov     [rbp+100h+var_17C], ebx
                test    rcx, rcx
                jz      loc_140282F64
                mov     r9d, ebx
                mov     word ptr [rsp+200h+var_1E0], ax
                mov     r8d, r15d
                mov     edx, r13d
                call    sub_140347BD4
                test    eax, eax
                jz      loc_1402831F8
                jmp     loc_140282F64
; ---------------------------------------------------------------------------

loc_14028257B:                          ; CODE XREF: sub_140281E60+5FF↑j
                mov     rbx, [rbp+100h+var_178]
                test    esi, esi
                jz      loc_1402826D8
                mov     ecx, [rbx+34h]
                mov     eax, 20h ; ' '
                mov     rdx, [rbp+100h+var_168]
                mov     rsi, [rsp+200h+var_1B8]
                mov     r8, [rbx+8]
                sub     rdx, rsi
                sar     rdx, 3
                inc     rdx
                cmp     rdx, 20h ; ' '
                cmovg   rdx, rax
                mov     eax, [rbx+2Ch]
                and     ecx, 3FFFFFFFh
                sub     rax, rcx
                test    byte ptr [rbx+22h], 2
                lea     rcx, [r8+rax*8]
                jnz     short loc_1402825E3
                cmp     rdi, r8
                jb      short loc_1402825E3
                cmp     rdi, rcx
                jnb     short loc_1402825E3
                lea     rax, [rdi+rdx*8]
                cmp     rax, rcx
                jbe     short loc_1402825E7
                mov     rdx, rcx
                sub     rdx, rdi
                sar     rdx, 3
                jmp     short loc_1402825E7
; ---------------------------------------------------------------------------

loc_1402825E3:                          ; CODE XREF: sub_140281E60+762↑j
                                        ; sub_140281E60+767↑j ...
                xor     eax, eax
                mov     edx, eax

loc_1402825E7:                          ; CODE XREF: sub_140281E60+775↑j
                                        ; sub_140281E60+781↑j
                lea     r9, [rsi-8]
                lea     r9, [r9+rdx*8]
                lea     r14, [rsi+8]
                cmp     r14, r9
                ja      loc_1402826A3
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rsi, 0FFFFF6FB7DBED7F8h

loc_140282610:                          ; CODE XREF: sub_140281E60+82F↓j
                mov     rdx, [r14]
                mov     rax, r10
                cmp     r14, rax
                jb      short loc_140282683
                mov     rax, rsi
                cmp     r14, rax
                ja      short loc_140282683
                call    sub_140349680
                test    eax, eax
                jz      short loc_140282683
                test    dl, 1
                jz      short loc_140282683
                test    dl, 20h
                jz      short loc_14028263B
                test    dl, 42h
                jnz     short loc_140282683

loc_14028263B:                          ; CODE XREF: sub_140281E60+7D4↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140282683
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140282683
                or      rdx, 42h

loc_140282683:                          ; CODE XREF: sub_140281E60+7B9↑j
                                        ; sub_140281E60+7C1↑j ...
                test    rdx, rdx
                jnz     short loc_140282695
                add     r14, 8
                cmp     r14, r9
                jbe     loc_140282610

loc_140282695:                          ; CODE XREF: sub_140281E60+826↑j
                mov     rdi, [rsp+200h+var_1A8]
                mov     rbx, [rbp+100h+var_178]
                mov     rsi, [rsp+200h+var_1B8]

loc_1402826A3:                          ; CODE XREF: sub_140281E60+796↑j
                cmp     [rsp+200h+var_190], 0
                jz      loc_140282731

loc_1402826AE:                          ; CODE XREF: sub_140281E60+87D↓j
                mov     r11, [rsp+200h+var_198]

loc_1402826B3:                          ; CODE XREF: sub_140281E60+8E0↓j
                                        ; sub_140281E60+903↓j
                xor     r10d, r10d

loc_1402826B6:                          ; CODE XREF: sub_140281E60+91F↓j
                mov     rdx, [r11+78h]
                test    rdx, rdx
                jns     loc_140282784
                mov     rdx, [rdx]
                mov     r8d, 1
                dec     rdx
                shr     rdx, 0Ch
                jmp     loc_14028278E
; ---------------------------------------------------------------------------

loc_1402826D8:                          ; CODE XREF: sub_140281E60+721↑j
                cmp     [rsp+200h+var_190], 0
                jnz     short loc_1402826AE
                mov     ecx, [rbx+34h]
                mov     rsi, [rsp+200h+var_1B8]
                and     ecx, 3FFFFFFFh
                mov     eax, [rbx+2Ch]
                sub     r14, rsi
                mov     rdx, [rbx+8]
                sub     rax, rcx
                sar     r14, 3
                test    byte ptr [rbx+22h], 2
                lea     rcx, [rdx+rax*8]
                jnz     short loc_140282727
                cmp     rdi, rdx
                jb      short loc_140282727
                cmp     rdi, rcx
                jnb     short loc_140282727
                lea     rax, [rdi+r14*8]
                cmp     rax, rcx
                jbe     short loc_14028272D
                mov     r14, rcx
                sub     r14, rdi
                sar     r14, 3
                jmp     short loc_14028272D
; ---------------------------------------------------------------------------

loc_140282727:                          ; CODE XREF: sub_140281E60+8A6↑j
                                        ; sub_140281E60+8AB↑j ...
                mov     r14d, 1

loc_14028272D:                          ; CODE XREF: sub_140281E60+8B9↑j
                                        ; sub_140281E60+8C5↑j
                lea     r14, [rsi+r14*8]

loc_140282731:                          ; CODE XREF: sub_140281E60+848↑j
                mov     r11, [rsp+200h+var_198]
                mov     rcx, r11
                call    sub_140233020
                test    eax, eax
                jz      loc_1402826B3
                mov     r8, r14
                mov     rdx, rbx
                sub     r8, rsi
                mov     rcx, rdi
                sar     r8, 3
                call    sub_140355C68
                mov     r11, [rsp+200h+var_198]
                cmp     rax, rdi
                jz      loc_1402826B3
                sub     rax, rdi
                sar     rax, 3
                xor     r10d, r10d
                mov     edi, r10d
                mov     [rsp+200h+var_1A8], r10
                lea     r14, [rsi+rax*8]
                jmp     loc_1402826B6
; ---------------------------------------------------------------------------

loc_140282784:                          ; CODE XREF: sub_140281E60+85D↑j
                mov     r8d, r10d
                mov     rdx, 0FFFFFFFFFFFFFFFFh

loc_14028278E:                          ; CODE XREF: sub_140281E60+873↑j
                test    rdi, rdi
                jz      loc_140282C3D
                mov     r10d, [r11+30h]
                mov     eax, r10d
                and     al, 70h
                cmp     al, 20h ; ' '
                jnz     loc_14028289A
                mov     rbx, [r11+48h]
                xor     r10d, r10d
                mov     edx, r10d
                test    rbx, rbx
                jz      short loc_14028281C

loc_1402827B7:                          ; CODE XREF: sub_140281E60+9B2↓j
                test    byte ptr [rbx+22h], 2
                jz      short loc_1402827F6
                mov     rsi, [rbx]
                test    dword ptr [rsi+38h], 4000000h
                jz      short loc_1402827F6
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                call    sub_140245840
                mov     r8, rbx
                mov     edx, eax
                mov     rcx, rsi
                call    sub_1403A61F8
                mov     rdi, [rsp+200h+var_1A8]
                mov     rdx, [rax+48h]
                jmp     short loc_1402827FA
; ---------------------------------------------------------------------------

loc_1402827F6:                          ; CODE XREF: sub_140281E60+95B↑j
                                        ; sub_140281E60+967↑j
                mov     rdx, [rbx+8]

loc_1402827FA:                          ; CODE XREF: sub_140281E60+994↑j
                cmp     rdi, rdx
                jb      short loc_14028280B
                mov     eax, [rbx+2Ch]
                lea     rcx, [rdx+rax*8]
                cmp     rdi, rcx
                jb      short loc_140282814

loc_14028280B:                          ; CODE XREF: sub_140281E60+99D↑j
                mov     rbx, [rbx+10h]
                test    rbx, rbx
                jnz     short loc_1402827B7

loc_140282814:                          ; CODE XREF: sub_140281E60+9A9↑j
                mov     r11, [rsp+200h+var_198]
                xor     r10d, r10d

loc_14028281C:                          ; CODE XREF: sub_140281E60+955↑j
                mov     ecx, [rbx+34h]
                sub     rdi, rdx
                mov     eax, [rbx+2Ch]
                and     ecx, 3FFFFFFFh
                sub     eax, ecx
                sar     rdi, 3
                mov     ecx, eax
                cmp     rdi, rcx
                jb      short loc_140282849
                mov     rdi, [rsp+200h+var_1B8]
                mov     r15d, r10d
                mov     ebx, [rsp+200h+var_1C8]
                jmp     loc_140282516
; ---------------------------------------------------------------------------

loc_140282849:                          ; CODE XREF: sub_140281E60+9D6↑j
                mov     r15d, [r11+30h]
                shr     r15d, 7
                and     r15d, 1Fh
                cmp     r15d, 7
                jnz     short loc_140282867
                movzx   r15d, word ptr [rbx+20h]
                shr     r15d, 1
                and     r15d, 1Fh

loc_140282867:                          ; CODE XREF: sub_140281E60+9F9↑j
                mov     rdi, [rsp+200h+var_1B8]
                mov     ebx, [rsp+200h+var_1C8]
                mov     rsi, [rsp+200h+var_1C0]
                mov     rcx, [rbp+100h+arg_20]
                mov     r11, 0FFFFF6FB7DBED000h
                test    r15d, r15d
                jz      loc_14028252C
                mov     r13d, 1000h
                jmp     loc_14028252C
; ---------------------------------------------------------------------------

loc_14028289A:                          ; CODE XREF: sub_140281E60+942↑j
                mov     rax, [rbx]
                mov     esi, r13d
                cmp     qword ptr [rax+40h], 0
                jnz     loc_140282B69
                mov     eax, [rax+38h]
                test    r13d, eax
                jnz     loc_140282B69
                mov     r15, [rsp+200h+var_188]
                test    r15, r15
                jz      short loc_1402828D5
                mov     rcx, [rsp+200h+var_1C0]
                mov     rdx, r15
                call    sub_140312B40
                xor     eax, eax
                mov     [rsp+200h+var_188], rax

loc_1402828D5:                          ; CODE XREF: sub_140281E60+A5F↑j
                movzx   edx, [rsp+200h+var_1D0]
                mov     rcx, [rsp+200h+var_1C0]
                call    sub_140226960
                mov     eax, [rbx+34h]
                mov     ecx, [rbx+2Ch]
                and     eax, 3FFFFFFFh
                sub     r14, [rsp+200h+var_1B8]
                sub     rcx, rax
                mov     rax, [rbx+8]
                mov     rbx, [rdi]
                sar     r14, 3
                lea     rsi, [rax+rcx*8]
                mov     rcx, rdi
                sub     rsi, rdi
                sar     rsi, 3
                cmp     rsi, r14
                cmova   rsi, r14
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_140282985
                call    sub_140349680
                test    eax, eax
                jz      short loc_140282985
                test    bl, 1
                jz      short loc_140282985
                test    bl, 20h
                jz      short loc_140282938
                test    bl, 42h
                jnz     short loc_140282985

loc_140282938:                          ; CODE XREF: sub_140281E60+AD1↑j
                mov     rax, gs:188h
                mov     rdi, [rsp+200h+var_1A8]
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140282985
                mov     rax, rdi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140282985
                or      rbx, 42h

loc_140282985:                          ; CODE XREF: sub_140281E60+ABE↑j
                                        ; sub_140281E60+AC7↑j ...
                test    rbx, rbx
                jz      short loc_1402829A3
                mov     rax, [rsp+200h+var_198]
                mov     r13d, 1000h
                mov     r15d, [rax+30h]
                shr     r15d, 7
                and     r15d, 1Fh
                jmp     short loc_1402829A8
; ---------------------------------------------------------------------------

loc_1402829A3:                          ; CODE XREF: sub_140281E60+B28↑j
                mov     r15d, [rsp+200h+var_1C4]

loc_1402829A8:                          ; CODE XREF: sub_140281E60+B41↑j
                mov     rcx, [rbp+100h+arg_20]
                test    rcx, rcx
                jz      short loc_1402829E3
                movzx   eax, [rsp+200h+var_1CC]
                xor     r9d, r9d
                mov     r8d, r15d
                mov     word ptr [rsp+200h+var_1E0], ax
                mov     edx, r13d
                call    sub_140347BD4
                test    eax, eax
                jnz     short loc_1402829E3
                mov     ebx, 1
                xor     eax, eax
                mov     [rsp+200h+var_1C8], ebx
                mov     r12d, eax
                jmp     loc_140282B44
; ---------------------------------------------------------------------------

loc_1402829E3:                          ; CODE XREF: sub_140281E60+B52↑j
                                        ; sub_140281E60+B6E↑j
                test    rsi, rsi
                jz      loc_140282B40
                nop     dword ptr [rax+00h]

loc_1402829F0:                          ; CODE XREF: sub_140281E60+C5A↓j
                                        ; sub_140281E60+CCC↓j
                mov     rdx, [rdi]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     rdi, rax
                jb      short loc_140282A7C
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdi, rax
                ja      short loc_140282A7C
                call    sub_140349680
                test    eax, eax
                jz      short loc_140282A7C
                test    dl, 1
                jz      short loc_140282A7C
                test    dl, 20h
                jz      short loc_140282A2F
                test    dl, 42h
                jnz     short loc_140282A7C

loc_140282A2F:                          ; CODE XREF: sub_140281E60+BC8↑j
                mov     rax, gs:188h
                mov     rdi, [rsp+200h+var_1A8]
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140282A7C
                mov     rax, rdi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140282A7C
                or      rdx, 42h

loc_140282A7C:                          ; CODE XREF: sub_140281E60+BA3↑j
                                        ; sub_140281E60+BB5↑j ...
                test    rdx, rdx
                jz      short loc_140282A90
                cmp     r13d, 1000h
                jnz     loc_140282B40
                jmp     short loc_140282A9D
; ---------------------------------------------------------------------------

loc_140282A90:                          ; CODE XREF: sub_140281E60+C1F↑j
                cmp     r13d, 1000h
                jz      loc_140282B40

loc_140282A9D:                          ; CODE XREF: sub_140281E60+C2E↑j
                add     rdi, 8
                inc     r12
                mov     [rsp+200h+var_1A8], rdi
                sub     rsi, 1
                jz      loc_140282B40

loc_140282AB3:                          ; CODE XREF: sub_140281E60+CC1↓j
                test    rdi, 0FFFh
                jnz     loc_1402829F0
                mov     rax, 7FFFFFFFF8h
                mov     rcx, rdi
                shr     rcx, 9
                and     rcx, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                add     rcx, rax
                call    sub_1402805F0
                test    al, 1
                jnz     short loc_140282B25
                test    rax, 3E0h
                jnz     short loc_140282B25
                cmp     r13d, 1000h
                jz      short loc_140282B40
                cmp     rsi, 200h
                jbe     short loc_140282B34
                add     rdi, 1000h
                add     r12, 200h
                mov     [rsp+200h+var_1A8], rdi
                sub     rsi, 200h
                jnz     short loc_140282AB3
                jmp     short loc_140282B40
; ---------------------------------------------------------------------------

loc_140282B25:                          ; CODE XREF: sub_140281E60+C8B↑j
                                        ; sub_140281E60+C93↑j
                cmp     r13d, 1000h
                jz      loc_1402829F0
                jmp     short loc_140282B40
; ---------------------------------------------------------------------------

loc_140282B34:                          ; CODE XREF: sub_140281E60+CA5↑j
                lea     rax, [rdi+rsi*8]
                add     r12, rsi
                mov     [rsp+200h+var_1A8], rax

loc_140282B40:                          ; CODE XREF: sub_140281E60+B86↑j
                                        ; sub_140281E60+C28↑j ...
                mov     ebx, [rsp+200h+var_1C8]

loc_140282B44:                          ; CODE XREF: sub_140281E60+B7E↑j
                mov     rdi, [rsp+200h+var_1B8]
                mov     rsi, [rsp+200h+var_1C0]
                mov     rcx, rsi
                lea     r14, [rdi+r12*8]
                call    sub_140231340
                mov     rcx, [rbp+100h+arg_20]
                xor     r10d, r10d
                jmp     loc_140282522
; ---------------------------------------------------------------------------

loc_140282B69:                          ; CODE XREF: sub_140281E60+A45↑j
                                        ; sub_140281E60+A51↑j
                mov     eax, [rbx+34h]
                mov     ecx, [rbx+2Ch]
                and     eax, 3FFFFFFFh
                sub     rcx, rax
                mov     rax, [rbx+8]
                lea     r12, [rax+rcx*8]
                sub     r12, rdi
                mov     rdi, [rsp+200h+var_1B8]
                sub     r14, rdi
                sar     r12, 3
                sar     r14, 3
                cmp     r12, r14
                cmova   r12, r14
                mov     r9, r12
                test    r8d, r8d
                jz      short loc_140282BD2
                mov     eax, [r11+18h]
                movzx   ecx, byte ptr [r11+20h]
                shl     rcx, 20h
                or      rcx, rax
                mov     rax, r15
                sub     rax, rcx
                cmp     rax, rdx
                ja      short loc_140282BD2
                sub     rcx, r15
                lea     r12, [rdx+1]
                add     r12, rcx
                xor     eax, eax
                cmp     r9, r12
                mov     r8d, eax
                cmovbe  r12, r9

loc_140282BD2:                          ; CODE XREF: sub_140281E60+D3F↑j
                                        ; sub_140281E60+D5A↑j
                lea     r14, [rdi+r12*8]
                test    r8d, r8d
                jnz     short loc_140282BE8
                mov     r15d, r10d
                shr     r15d, 7
                and     r15d, 1Fh
                jmp     short loc_140282BED
; ---------------------------------------------------------------------------

loc_140282BE8:                          ; CODE XREF: sub_140281E60+D79↑j
                mov     r15d, [rsp+200h+var_1C4]

loc_140282BED:                          ; CODE XREF: sub_140281E60+D86↑j
                mov     ebx, [rsp+200h+var_1C8]
                test    r8d, r8d
                mov     r13d, 1000h
                cmovnz  r13d, esi
                xor     r10d, r10d
                jmp     loc_140282516
; ---------------------------------------------------------------------------

loc_140282C06:                          ; CODE XREF: sub_140281E60+50E↑j
                                        ; sub_140281E60+51B↑j
                and     r9d, 70h
                cmp     r9b, 30h ; '0'
                jnz     loc_140282513
                mov     rcx, r11
                call    sub_14054C650
                movzx   ecx, word ptr [rax]
                mov     [rsp+200h+var_1CC], cx
                jmp     loc_140282513
; ---------------------------------------------------------------------------

loc_140282C29:                          ; CODE XREF: sub_140281E60+478↑j
                                        ; sub_140281E60+488↑j
                mov     rsi, [rsp+200h+var_1C0]
                mov     r15d, ebx
                mov     rcx, [rbp+100h+arg_20]
                jmp     loc_14028252C
; ---------------------------------------------------------------------------

loc_140282C3D:                          ; CODE XREF: sub_140281E60+931↑j
                mov     r15d, [rsp+200h+var_1C4]
                mov     ebx, r15d
                mov     rdi, [rsp+200h+var_1B8]
                jmp     loc_140282516
; ---------------------------------------------------------------------------

loc_140282C4F:                          ; CODE XREF: sub_140281E60+6D3↑j
                mov     edx, [rbp+100h+var_170]
                movzx   eax, [rsp+200h+var_1B0]
                cmp     r13d, edx
                jnz     loc_1402831E5
                cmp     [rsp+200h+var_1CC], ax
                jnz     loc_1402831E5
                cmp     r15d, [rbp+100h+var_180]
                jnz     loc_1402831E5
                mov     ecx, [rbp+100h+var_17C]
                cmp     [rsp+200h+var_1AC], ecx
                jnz     loc_1402831E5
                test    r12, r12
                jnz     loc_140282F64
                cmp     ebx, 1
                jz      loc_140282F64
                mov     rax, rdi
                sub     rax, r8
                and     rax, 0FFFFFFFFFFFFFFF8h
                cmp     rax, 100h
                jl      loc_140282F64
                mov     r9, [rsp+200h+var_188]
                test    r9, r9
                jz      loc_140282E55
                movzx   edx, byte ptr [rsi+0B8h]
                and     dl, 7
                mov     [rbp+100h+var_16C], r10d
                mov     rax, 0FFFFF6FB7DBEDF68h
                mov     rax, rax
                cmp     r9, rax
                jnz     short loc_140282D33
                mov     rax, gs:20h
                test    dl, dl
                jnz     short loc_140282CF6
                add     rax, 8D70h
                mov     rax, [rax]
                test    rax, rax
                jmp     loc_140282E4F
; ---------------------------------------------------------------------------

loc_140282CF6:                          ; CODE XREF: sub_140281E60+E83↑j
                cmp     dl, 7
                jnz     short loc_140282D0C
                add     rax, 8D58h
                mov     rax, [rax]
                test    rax, rax
                jmp     loc_140282E4F
; ---------------------------------------------------------------------------

loc_140282D0C:                          ; CODE XREF: sub_140281E60+E99↑j
                cmp     dl, 5
                jnz     short loc_140282D22
                add     rax, 8D40h
                mov     rax, [rax]
                test    rax, rax
                jmp     loc_140282E4F
; ---------------------------------------------------------------------------

loc_140282D22:                          ; CODE XREF: sub_140281E60+EAF↑j
                add     rax, 8D88h
                mov     rax, [rax]
                test    rax, rax
                jmp     loc_140282E4F
; ---------------------------------------------------------------------------

loc_140282D33:                          ; CODE XREF: sub_140281E60+E76↑j
                test    dl, dl
                jnz     short loc_140282D8D
                mov     rax, r11
                mov     rcx, 0FFFFF6FB7DBEDFFFh
                cmp     r9, rax
                jb      short loc_140282D97
                mov     rax, rcx
                cmp     r9, rax
                ja      short loc_140282D97
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+690h]
                mov     rcx, [rax+260h]
                test    rcx, rcx
                jz      short loc_140282D8D
                mov     eax, r9d
                shr     eax, 3
                and     eax, 1FFh
                mov     edx, [rcx+rax*4]
                shr     edx, 1Eh
                and     edx, 1
                jmp     loc_140282E4D
; ---------------------------------------------------------------------------

loc_140282D8D:                          ; CODE XREF: sub_140281E60+ED5↑j
                                        ; sub_140281E60+F12↑j
                mov     rcx, 0FFFFF6FB7DBEDFFFh

loc_140282D97:                          ; CODE XREF: sub_140281E60+EE7↑j
                                        ; sub_140281E60+EEF↑j
                test    dl, dl
                jz      short loc_140282DC9
                mov     rax, r11
                cmp     r9, rax
                jb      short loc_140282DC9
                mov     rax, rcx
                cmp     r9, rax
                ja      short loc_140282DC9
                lea     r8, [rbp+100h+var_16C]
                mov     rdx, r9
                mov     rcx, rsi
                call    sub_140312D68
                mov     edx, [rax]
                mov     ecx, [rbp+100h+var_16C]
                shr     edx, cl
                test    dl, 2
                jmp     loc_140282E4F
; ---------------------------------------------------------------------------

loc_140282DC9:                          ; CODE XREF: sub_140281E60+F39↑j
                                        ; sub_140281E60+F41↑j ...
                mov     rdx, [r9]
                mov     rax, r11
                cmp     r9, rax
                jb      short loc_140282E46
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r9, rax
                ja      short loc_140282E46
                call    sub_140349680
                test    eax, eax
                jz      short loc_140282E46
                test    dl, 1
                jz      short loc_140282E46
                test    dl, 20h
                jz      short loc_140282DFE
                test    dl, 42h
                jnz     short loc_140282E46

loc_140282DFE:                          ; CODE XREF: sub_140281E60+F97↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140282E46
                mov     rax, r9
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140282E46
                or      rdx, 42h

loc_140282E46:                          ; CODE XREF: sub_140281E60+F72↑j
                                        ; sub_140281E60+F84↑j ...
                shr     rdx, 3Ch
                and     edx, 2

loc_140282E4D:                          ; CODE XREF: sub_140281E60+F28↑j
                test    edx, edx

loc_140282E4F:                          ; CODE XREF: sub_140281E60+E91↑j
                                        ; sub_140281E60+EA7↑j ...
                jnz     loc_1402831DF

loc_140282E55:                          ; CODE XREF: sub_140281E60+E52↑j
                movzx   eax, byte ptr [rsi+0B8h]
                and     al, 7
                cmp     al, 2
                lea     rax, unk_140C4F600
                jz      short loc_140282E70
                lea     rax, [rsi+0C0h]

loc_140282E70:                          ; CODE XREF: sub_140281E60+1007↑j
                mov     eax, [rax]
                bt      eax, 1Eh
                jb      loc_1402831DF
                cmp     [rsp+200h+var_1D0], 2
                jnb     loc_140282F64
                mov     rcx, gs:20h
                mov     r8d, [rcx+312Ch]
                mov     edi, [rcx+7BECh]
                mov     esi, [rcx+7E9Ch]
                test    r8b, 1
                jz      short loc_140282EC2
                mov     edx, 1
                cmp     esi, 7
                jbe     short loc_140282EFA
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jz      short loc_140282F03
                mov     ebx, edx
                jmp     short loc_140282F3C
; ---------------------------------------------------------------------------

loc_140282EC2:                          ; CODE XREF: sub_140281E60+1047↑j
                mov     edx, r10d
                test    r8b, 1Eh
                jz      short loc_140282ED2
                mov     ebx, 2
                jmp     short loc_140282F3C
; ---------------------------------------------------------------------------

loc_140282ED2:                          ; CODE XREF: sub_140281E60+1069↑j
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jz      short loc_140282EE4
                mov     ebx, 3
                jmp     short loc_140282F3C
; ---------------------------------------------------------------------------

loc_140282EE4:                          ; CODE XREF: sub_140281E60+107B↑j
                mov     rax, [rcx+10h]
                test    rax, rax
                jz      short loc_140282EFA
                cmp     rax, [rcx+8]
                jz      short loc_140282EFA
                mov     ebx, 4
                jmp     short loc_140282F3C
; ---------------------------------------------------------------------------

loc_140282EFA:                          ; CODE XREF: sub_140281E60+1051↑j
                                        ; sub_140281E60+108B↑j ...
                cmp     edi, 7
                jbe     short loc_140282F5F
                test    edx, edx
                jz      short loc_140282F21

loc_140282F03:                          ; CODE XREF: sub_140281E60+105C↑j
                test    r8b, 1Eh
                jz      short loc_140282F10
                mov     ebx, 5
                jmp     short loc_140282F3C
; ---------------------------------------------------------------------------

loc_140282F10:                          ; CODE XREF: sub_140281E60+10A7↑j
                mov     rax, [rcx+18h]
                cmp     [rcx+8], rax
                jz      short loc_140282F21
                mov     ebx, 6
                jmp     short loc_140282F3C
; ---------------------------------------------------------------------------

loc_140282F21:                          ; CODE XREF: sub_140281E60+10A1↑j
                                        ; sub_140281E60+10B8↑j
                cli
                mov     [rcx+7BECh], r10d
                mov     [rcx+7E9Ch], r10d
                call    sub_140326178
                sti
                xor     r10d, r10d
                mov     ebx, r10d

loc_140282F3C:                          ; CODE XREF: sub_140281E60+1060↑j
                                        ; sub_140281E60+1070↑j ...
                test    dword ptr cs:xmmword_140CFC480+4, 4000000h
                jz      short loc_140282F57
                mov     r8d, esi
                mov     edx, edi
                mov     ecx, ebx
                call    sub_1405A83BC
                xor     r10d, r10d

loc_140282F57:                          ; CODE XREF: sub_140281E60+10E6↑j
                test    ebx, ebx
                jnz     loc_1402831DA

loc_140282F5F:                          ; CODE XREF: sub_140281E60+109D↑j
                mov     rdi, [rsp+200h+var_1B8]

loc_140282F64:                          ; CODE XREF: sub_140281E60+6F5↑j
                                        ; sub_140281E60+716↑j ...
                cmp     [rsp+200h+var_1C8], 0
                jnz     loc_1402831FB
                test    r12, r12
                jnz     loc_1402831FB
                add     rdi, 8
                mov     [rsp+200h+var_1B8], rdi
                cmp     r14, rdi
                jnz     loc_1402831FB
                cmp     r14, [rbp+100h+var_168]
                ja      loc_1402831FB
                cmp     [rsp+200h+var_190], r12d
                jz      loc_14028302B
                mov     rdx, [rdi]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     rdi, rax
                jb      short loc_140283026
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdi, rax
                ja      short loc_140283026
                call    sub_140349680
                test    eax, eax
                jz      short loc_140283026
                test    dl, 1
                jz      short loc_140283026
                test    dl, 20h
                jz      short loc_140282FDE
                test    dl, 42h
                jnz     short loc_140283026

loc_140282FDE:                          ; CODE XREF: sub_140281E60+1177↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140283026
                mov     rax, rdi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140283026
                or      rdx, 42h

loc_140283026:                          ; CODE XREF: sub_140281E60+1152↑j
                                        ; sub_140281E60+1164↑j ...
                mov     [rsp+200h+var_1A0], rdx

loc_14028302B:                          ; CODE XREF: sub_140281E60+1139↑j
                mov     r15, rdi
                mov     esi, r10d
                shl     r15, 19h
                sub     r15, [rbp+100h+var_158]
                sar     r15, 10h
                add     r14, 8
                jmp     loc_1402821B0
; ---------------------------------------------------------------------------

loc_140283046:                          ; CODE XREF: sub_140281E60+4BD↑j
                mov     r13, [rsp+200h+var_1C0]
                mov     rdx, [rsp+200h+var_188]
                mov     rcx, r13
                call    sub_140312B40
                movzx   edx, [rsp+200h+var_1D0]
                xor     eax, eax
                mov     rcx, r13
                mov     [rsp+200h+var_188], rax
                call    sub_140226960
                mov     rcx, rbx
                call    sub_14052D2E4
                mov     rcx, r13
                call    sub_140231340
                mov     r8, [rbp+100h+var_160]
                xor     r9d, r9d
                mov     rbx, [rbp+100h+var_158]
                movzx   r13d, [rsp+200h+var_1D0]
                jmp     loc_140281FA0
; ---------------------------------------------------------------------------

loc_140283092:                          ; CODE XREF: sub_140281E60+316↑j
                mov     rcx, rbx
                call    sub_1402805F0
                mov     [rsp+200h+var_1A0], rax
                mov     rdi, rax
                test    al, 1
                jz      short loc_14028311A
                lea     rcx, [rsp+200h+var_1A0]
                call    sub_1402433C0
                test    eax, eax
                jz      loc_140283138
                call    sub_140349680
                test    eax, eax
                jz      short loc_140283138
                mov     rdx, rdi
                test    dil, 20h
                jz      short loc_1402830D0
                test    dil, 42h
                jnz     short loc_140283138

loc_1402830D0:                          ; CODE XREF: sub_140281E60+1268↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jnz     short loc_1402830F3
                mov     rdi, [rsp+200h+var_1A0]
                jmp     short loc_140283138
; ---------------------------------------------------------------------------

loc_1402830F3:                          ; CODE XREF: sub_140281E60+128A↑j
                lea     rax, [rsp+200h+var_1A0]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                test    al, 20h
                jz      short loc_140283110
                mov     rdi, rdx
                or      rdi, 20h

loc_140283110:                          ; CODE XREF: sub_140281E60+12A7↑j
                test    al, 42h
                jz      short loc_140283138
                or      rdi, 42h
                jmp     short loc_140283138
; ---------------------------------------------------------------------------

loc_14028311A:                          ; CODE XREF: sub_140281E60+1244↑j
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_140283138
                test    dil, 10h
                jnz     short loc_140283134
                not     rax
                and     rdi, rax
                jmp     short loc_140283138
; ---------------------------------------------------------------------------

loc_140283134:                          ; CODE XREF: sub_140281E60+12CA↑j
                and     rdi, 0FFFFFFFFFFFFFFEFh

loc_140283138:                          ; CODE XREF: sub_140281E60+1252↑j
                                        ; sub_140281E60+125F↑j ...
                mov     rax, 0FFFFFFFFFh
                shr     rdi, 0Ch
                and     rdi, rax
                lea     rax, [rdi+rdi*2]
                add     rax, rax
                mov     rdi, 0FFFFFA8000000028h
                mov     rdi, [rdi+rax*8]
                mov     eax, 3FFh
                mov     r8, [rsp+200h+var_198]
                shr     rdi, 27h
                and     di, ax
                mov     ecx, [r8+30h]
                mov     eax, ecx
                and     eax, 70h
                cmp     al, 30h ; '0'
                jz      short loc_140283192
                mov     eax, ecx
                and     eax, 500000h
                cmp     eax, 500000h
                jz      short loc_140283192
                shr     ecx, 7
                and     ecx, 1Fh
                jmp     short loc_1402831A1
; ---------------------------------------------------------------------------

loc_140283192:                          ; CODE XREF: sub_140281E60+131A↑j
                                        ; sub_140281E60+1328↑j
                mov     rdx, [rsp+200h+var_1A0]
                mov     rcx, r8
                call    sub_1403F3E60
                mov     ecx, eax

loc_1402831A1:                          ; CODE XREF: sub_140281E60+1330↑j
                mov     rdx, [rbp+100h+var_148]
                mov     [rdx], ecx
                mov     rdx, r13
                mov     rcx, [rsp+200h+var_1C0]
                call    sub_140312B40
                mov     rdx, [rbp+100h+var_140]
                lea     rcx, [rbx+8]
                xor     eax, eax
                mov     [rdx], eax
                mov     rdx, [rbp+100h+var_138]
                mov     [rdx], di
                call    sub_14027F590
                mov     rcx, [rbp+100h+var_150]
                mov     [rcx], rax
                mov     eax, 1000h
                jmp     short loc_140283242
; ---------------------------------------------------------------------------

loc_1402831DA:                          ; CODE XREF: sub_140281E60+10F9↑j
                mov     rdi, [rsp+200h+var_1B8]

loc_1402831DF:                          ; CODE XREF: sub_140281E60:loc_140282E4F↑j
                                        ; sub_140281E60+1016↑j
                lea     r14, [rdi+8]
                jmp     short loc_1402831FB
; ---------------------------------------------------------------------------

loc_1402831E5:                          ; CODE XREF: sub_140281E60+DFA↑j
                                        ; sub_140281E60+E05↑j ...
                mov     r15d, [rbp+100h+var_180]
                mov     r13d, edx
                mov     [rsp+200h+var_1CC], ax
                mov     eax, [rbp+100h+var_17C]
                mov     [rsp+200h+var_1AC], eax

loc_1402831F8:                          ; CODE XREF: sub_140281E60+710↑j
                mov     r14, rdi

loc_1402831FB:                          ; CODE XREF: sub_140281E60+1109↑j
                                        ; sub_140281E60+1112↑j ...
                mov     rdx, [rsp+200h+var_188]
                test    rdx, rdx
                jz      short loc_14028320F
                mov     rcx, [rsp+200h+var_1C0]
                call    sub_140312B40

loc_14028320F:                          ; CODE XREF: sub_140281E60+13A3↑j
                mov     rcx, [rbp+100h+var_150]
                mov     eax, r13d
                mov     rdx, [rbp+100h+var_148]
                shl     r14, 19h
                sub     r14, [rbp+100h+var_158]
                sar     r14, 10h
                mov     [rcx], r14
                mov     ecx, [rsp+200h+var_1AC]
                mov     [rdx], r15d
                mov     rdx, [rbp+100h+var_140]
                mov     [rdx], ecx
                mov     rdx, [rbp+100h+var_138]
                movzx   ecx, [rsp+200h+var_1CC]
                mov     [rdx], cx

loc_140283242:                          ; CODE XREF: sub_140281E60+1378↑j
                mov     rcx, [rbp+100h+var_50]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 1C8h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140281E60
sub_140281E60   endp

algn_140283266:                         ; DATA XREF: .pdata:00000001400CEA9C↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140283270   proc near               ; CODE XREF: sub_140224260+59B↑p
                                        ; sub_1402335C0+443↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140443A2A SIZE 0000004E BYTES

                mov     [rsp+arg_18], rsi
                push    r14
                sub     rsp, 20h
                mov     eax, [rcx+18h]
                mov     r14, r9
                movzx   r10d, byte ptr [rcx+20h]
                mov     esi, r8d
                shl     r10, 20h
                mov     r11, rdx
                or      r10, rax
                mov     eax, [rcx+30h]
                and     al, 70h
                cmp     al, 20h ; ' '
                jnz     short loc_1402832AC
                mov     rax, [rcx+48h]
                mov     rdx, [rax]
                test    dword ptr [rdx+38h], 4000000h
                jnz     short loc_1402832CD

loc_1402832AC:                          ; CODE XREF: sub_140283270+2A↑j
                mov     rdx, [rcx+58h]
                mov     r8, r11
                sub     rdx, [rcx+50h]
                sub     r8, r10
                sar     rdx, 3
                cmp     rdx, r8
                jb      short loc_1402832CD
                test    sil, 4
                jz      loc_140283389

loc_1402832CD:                          ; CODE XREF: sub_140283270+3A↑j
                                        ; sub_140283270+51↑j
                                        ; DATA XREF: ...
                mov     [rsp+28h+arg_0], rbx
                xor     r9d, r9d
                mov     [r14], r9
                mov     rbx, [rcx+48h]
                mov     [rsp+28h+arg_8], rbp
                mov     [rsp+28h+arg_10], rdi
                mov     rdi, [rcx+50h]
                sub     rdi, [rbx+8]
                mov     rbp, [rbx]
                sar     rdi, 3
                sub     rdi, r10
                add     rdi, r11
                cmp     [rbp+40h], r9
                jz      loc_1402833A5
                mov     eax, [rbx+2Ch]
                mov     r8d, r9d
                mov     rdx, rdi
                mov     rcx, rbx
                cmp     rdi, rax
                jb      short loc_14028333B

loc_140283316:                          ; CODE XREF: sub_140283270+C9↓j
                mov     rcx, [rcx+10h]
                sub     rdx, rax
                inc     r8
                cmp     r8, 3
                jz      loc_1402833EC

loc_14028332A:                          ; CODE XREF: sub_140283270+181↓j
                test    rcx, rcx
                jz      loc_1402833F7
                mov     eax, [rcx+2Ch]
                cmp     rdx, rax
                jnb     short loc_140283316

loc_14028333B:                          ; CODE XREF: sub_140283270+A4↑j
                mov     rdi, rdx
                mov     rbx, rcx

loc_140283341:                          ; CODE XREF: sub_140283270+1E4↓j
                mov     eax, [rbx+2Ch]
                mov     ecx, [rbx+34h]
                and     ecx, 3FFFFFFFh
                sub     eax, ecx
                cmp     rdi, rax
                jnb     loc_1402834AD
                mov     rcx, [rbx+8]
                mov     [r14], rbx

loc_14028335F:                          ; CODE XREF: sub_140283270+172↓j
                test    byte ptr [rbx+22h], 2
                jnz     loc_140443A34

loc_140283369:                          ; CODE XREF: sub_140283270+1C07D7↓j
                                        ; sub_140283270+1C0803↓j
                lea     rax, [rcx+rdi*8]

loc_14028336D:                          ; CODE XREF: sub_140283270+17A↓j
                                        ; sub_140283270+23F↓j
                mov     rbp, [rsp+28h+arg_8]
                mov     rbx, [rsp+28h+arg_0]
                mov     rdi, [rsp+28h+arg_10]
                mov     rsi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
byte_140283388  db 0CCh                 ; DATA XREF: .pdata:00000001400CEAB4↑o
                                        ; .pdata:00000001400CEAC0↑o
; ---------------------------------------------------------------------------

loc_140283389:                          ; CODE XREF: sub_140283270+57↑j
                mov     rax, [rcx+48h]
                mov     rsi, [rsp+28h+arg_18]
                mov     [r9], rax
                mov     rax, [rcx+50h]
                lea     rax, [rax+r8*8]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402833A5:                          ; CODE XREF: sub_140283270+8F↑j
                                        ; DATA XREF: .pdata:00000001400CEAC0↑o ...
                test    dword ptr [rbp+38h], 1000h
                mov     r8d, [rbp+60h]
                jnz     loc_140283459
                cmp     dword ptr [rbx+30h], 40000000h
                jnb     loc_140283459
                mov     eax, [rbx+2Ch]
                cmp     rdi, rax
                jnb     loc_1402834AD

loc_1402833CF:                          ; CODE XREF: sub_140283270+237↓j
                test    rbx, rbx
                jz      loc_1402834AD
                mov     [r14], rbx
                mov     rcx, [rbx+8]
                test    rcx, rcx
                jnz     loc_14028335F
                xor     eax, eax
                jmp     short loc_14028336D
; ---------------------------------------------------------------------------

loc_1402833EC:                          ; CODE XREF: sub_140283270+B4↑j
                mov     eax, [rbp+38h]
                test    al, 20h
                jnz     loc_14028332A

loc_1402833F7:                          ; CODE XREF: sub_140283270+BD↑j
                mov     eax, [rbp+38h]
                test    al, 20h
                jnz     loc_1402834AD
                movzx   ecx, word ptr [rbx+20h]
                mov     eax, [rbx+24h]
                and     rcx, 0FFFFFFFFFFFFFFC0h
                shl     rcx, 1Ah
                or      rcx, rax
                add     rdi, rcx
                shl     rdi, 0Ch
                test    sil, 1
                jnz     loc_1402834BE

loc_140283425:                          ; CODE XREF: sub_140283270+254↓j
                mov     r8d, r9d
                mov     rdx, rdi
                mov     rcx, rbp
                call    sub_140269B00
                mov     rbx, rax
                test    rax, rax
                jz      short loc_1402834AD
                movzx   edx, word ptr [rax+20h]
                mov     ecx, [rax+24h]
                and     rdx, 0FFFFFFFFFFFFFFC0h
                shl     rdx, 1Ah
                or      rdx, rcx
                shr     rdi, 0Ch
                sub     rdi, rdx
                jmp     loc_140283341
; ---------------------------------------------------------------------------

loc_140283459:                          ; CODE XREF: sub_140283270+140↑j
                                        ; sub_140283270+14D↑j
                cmp     dword ptr [rbx+30h], 40000000h
                mov     ecx, 100000h
                jnb     loc_140443A2A

loc_14028346B:                          ; CODE XREF: sub_140283270+1C07BF↓j
                shr     rcx, 3
                mov     rax, rdi
                cmp     rcx, 20000h
                jnz     short loc_1402834B4
                shr     rax, 11h
                and     edi, 1FFFFh

loc_140283485:                          ; CODE XREF: sub_140283270+24C↓j
                mov     ecx, eax
                test    rdi, rdi
                lea     rdx, [rcx+1]
                cmovz   rdx, rcx
                cmp     rdx, r8
                ja      short loc_1402834AD
                imul    rax, 58h ; 'X'
                add     rax, rbx
                mov     rbx, rax
                mov     eax, [rax+2Ch]
                cmp     rdi, rax
                jb      loc_1402833CF

loc_1402834AD:                          ; CODE XREF: sub_140283270+E2↑j
                                        ; sub_140283270+159↑j ...
                xor     eax, eax
                jmp     loc_14028336D
; ---------------------------------------------------------------------------

loc_1402834B4:                          ; CODE XREF: sub_140283270+209↑j
                xor     edx, edx
                div     rcx
                mov     rdi, rdx
                jmp     short loc_140283485
; ---------------------------------------------------------------------------

loc_1402834BE:                          ; CODE XREF: sub_140283270+1AF↑j
                mov     r9d, 1
                jmp     loc_140283425
sub_140283270   endp

; ---------------------------------------------------------------------------
algn_1402834C9:                         ; DATA XREF: .pdata:00000001400CEACC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_1402834D0   proc near               ; CODE XREF: sub_140230420+CC9↑p
                                        ; sub_140281E60+4B0↑p ...

var_58          = qword ptr -58h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h
arg_20          = qword ptr  28h

                mov     rax, rsp
                mov     [rax+20h], r9
                mov     [rax+18h], r8
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 38h
                mov     r12, [rsp+78h+arg_20]
                xor     ebp, ebp
                mov     rdi, [rdx]
                mov     r14, r9
                mov     rsi, rdx
                mov     [rax+10h], rbp
                mov     r15, rcx
                mov     [rax+8], rbp
                mov     [r12], bp
                mov     [r8], rbp
                mov     [r9], ebp
                mov     r11, 0FFFFF6FB7DBED000h
                mov     rax, r11
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     rdx, rax
                jb      short loc_14028359B
                mov     rax, r10
                cmp     rdx, rax
                ja      short loc_14028359B
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028359B
                test    dil, 1
                jz      short loc_14028359B
                test    dil, 20h
                jz      short loc_140283553
                test    dil, 42h
                jnz     short loc_14028359B

loc_140283553:                          ; CODE XREF: sub_1402834D0+7B↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028359B
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                mov     rdi, rdx
                test    al, 42h
                jz      short loc_14028359B
                or      rdi, 42h

loc_14028359B:                          ; CODE XREF: sub_1402834D0+5E↑j
                                        ; sub_1402834D0+66↑j ...
                mov     ebx, [r15+30h]
                mov     r13d, ebx
                and     r13d, 70h
                mov     [rsp+78h+arg_20], rdi
                cmp     r13d, 30h ; '0'
                jnz     short loc_1402835E3
                bt      ebx, 14h
                jnb     short loc_1402835C6
                bt      ebx, 18h
                jb      short loc_1402835C6
                bt      ebx, 19h
                jb      short loc_1402835E3

loc_1402835C6:                          ; CODE XREF: sub_1402834D0+E8↑j
                                        ; sub_1402834D0+EE↑j
                mov     rcx, rdi
                call    sub_14054C6D0
                mov     rdx, rdi
                mov     [r12], ax
                mov     rcx, r15
                call    sub_14054C7F8
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_1402835E3:                          ; CODE XREF: sub_1402834D0+E2↑j
                                        ; sub_1402834D0+F4↑j
                test    dil, 1
                jz      loc_14028396B
                mov     rax, r11
                lea     rcx, [rsp+78h+arg_20]
                cmp     rcx, rax
                jb      short loc_140283671
                mov     rax, r10
                lea     rcx, [rsp+78h+arg_20]
                cmp     rcx, rax
                ja      short loc_140283671
                mov     rdx, rdi
                call    sub_140349680
                test    eax, eax
                jz      short loc_140283674
                test    dil, 20h
                jz      short loc_140283625
                test    dil, 42h
                jnz     short loc_140283674

loc_140283625:                          ; CODE XREF: sub_1402834D0+14D↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140283671
                lea     rax, [rsp+78h+arg_20]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rdi
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rdi
                test    al, 42h
                jz      short loc_140283674
                or      rdx, 42h
                jmp     short loc_140283674
; ---------------------------------------------------------------------------

loc_140283671:                          ; CODE XREF: sub_1402834D0+12B↑j
                                        ; sub_1402834D0+13B↑j ...
                mov     rdx, rdi

loc_140283674:                          ; CODE XREF: sub_1402834D0+147↑j
                                        ; sub_1402834D0+153↑j ...
                shr     rdx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax
                lea     r14, [rdx+rdx*2]
                shl     r14, 4
                mov     rax, 0FFFFFA8000000000h
                add     r14, rax
                cmp     r13d, 10h
                jnz     short loc_1402836CE
                mov     rcx, rdx
                call    sub_140243B30
                test    eax, eax
                jz      short loc_1402836C1
                mov     rcx, [r14+28h]
                mov     edx, 3FFh
                shr     rcx, 27h
                and     cx, dx
                mov     [r12], cx

loc_1402836C1:                          ; CODE XREF: sub_1402834D0+1DA↑j
                shr     ebx, 7
                and     ebx, 1Fh
                mov     eax, ebx
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_1402836CE:                          ; CODE XREF: sub_1402834D0+1CE↑j
                cmp     r13d, 40h ; '@'
                jnz     short loc_14028373D
                mov     rcx, rsi
                call    sub_140342C88
                test    eax, eax
                jz      short loc_140283729
                bt      rdi, 0Bh
                mov     eax, 1
                mov     r8d, 4
                cmovnb  r8d, eax
                mov     eax, ebx
                and     eax, 0C00h
                cmp     eax, 0C00h
                jnz     short loc_140283716
                test    ebx, 380h
                jz      short loc_140283716
                or      r8d, 18h
                mov     eax, r8d
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_140283716:                          ; CODE XREF: sub_1402834D0+230↑j
                                        ; sub_1402834D0+238↑j
                cmp     eax, 400h
                jnz     short loc_140283721
                or      r8d, 8

loc_140283721:                          ; CODE XREF: sub_1402834D0+24B↑j
                mov     eax, r8d
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_140283729:                          ; CODE XREF: sub_1402834D0+20E↑j
                mov     r10, 0FFFFF6FB7DBED7F8h
                mov     r11, 0FFFFF6FB7DBED000h

loc_14028373D:                          ; CODE XREF: sub_1402834D0+202↑j
                mov     rcx, [r14+28h]
                mov     edx, 3FFh
                mov     rax, rcx
                shr     rax, 27h
                and     ax, dx
                mov     [r12], ax
                mov     rax, 1000000000h
                test    rax, rcx
                jz      short loc_140283794
                mov     rdx, rdi
                mov     rcx, r15
                call    sub_1403F3E60
                mov     ecx, [r15+30h]
                and     ecx, 1100000h
                cmp     ecx, 1100000h
                jnz     loc_140283BF1
                mov     rcx, [rsp+78h+arg_18]
                mov     [rcx], ebp
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_140283794:                          ; CODE XREF: sub_1402834D0+292↑j
                mov     rcx, r14
                call    sub_1403F41D8
                test    eax, eax
                jnz     short loc_1402837B0
                mov     eax, [r14+10h]
                shr     rax, 5
                and     eax, 1Fh
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_1402837B0:                          ; CODE XREF: sub_1402834D0+2CE↑j
                shl     rsi, 19h
                mov     rcx, 0FFFFF68000000000h
                mov     rax, rcx
                shl     rax, 19h
                mov     r9, 0FFFFFFFFF000h
                sub     rsi, rax
                sar     rsi, 10h
                and     r9, rsi
                shr     r9, 9
                mov     rax, rcx
                add     r9, rax
                mov     rdx, [r9]
                mov     rax, r11
                cmp     r9, rax
                jb      short loc_140283856
                mov     rax, r10
                cmp     r9, rax
                ja      short loc_140283856
                call    sub_140349680
                test    eax, eax
                jz      short loc_140283856
                test    dl, 1
                jz      short loc_140283856
                test    dl, 20h
                jz      short loc_14028380E
                test    dl, 42h
                jnz     short loc_140283856

loc_14028380E:                          ; CODE XREF: sub_1402834D0+337↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140283856
                mov     rax, r9
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140283856
                or      rdx, 42h

loc_140283856:                          ; CODE XREF: sub_1402834D0+31C↑j
                                        ; sub_1402834D0+324↑j ...
                shr     rdx, 3Ch
                and     edx, 7
                jz      short loc_140283884
                mov     rcx, [r9]
                mov     rax, rcx
                and     eax, 10h
                jnz     short loc_140283874
                test    cl, 8
                jz      short loc_140283874
                or      edx, 18h
                jmp     short loc_14028387C
; ---------------------------------------------------------------------------

loc_140283874:                          ; CODE XREF: sub_1402834D0+398↑j
                                        ; sub_1402834D0+39D↑j
                test    rax, rax
                jz      short loc_14028387C
                or      edx, 8

loc_14028387C:                          ; CODE XREF: sub_1402834D0+3A2↑j
                                        ; sub_1402834D0+3A7↑j
                test    edx, edx
                jnz     loc_140283964

loc_140283884:                          ; CODE XREF: sub_1402834D0+38D↑j
                mov     r8, [r14+10h]
                lea     rdx, [r14+10h]
                mov     rax, r11
                cmp     rdx, rax
                jb      short loc_1402838FD
                mov     rax, r10
                cmp     rdx, rax
                ja      short loc_1402838FD
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402838FD
                test    r8b, 1
                jz      short loc_1402838FD
                test    r8b, 20h
                jz      short loc_1402838B7
                test    r8b, 42h
                jnz     short loc_1402838FD

loc_1402838B7:                          ; CODE XREF: sub_1402834D0+3DF↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_1402838FD
                shr     rdx, 3
                and     edx, 1FFh
                mov     rax, [rax+rdx*8]
                mov     rdx, r8
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_1402838FD
                or      r8, 42h

loc_1402838FD:                          ; CODE XREF: sub_1402834D0+3C2↑j
                                        ; sub_1402834D0+3CA↑j ...
                mov     rax, [r14+8]
                shr     r8, 5
                and     r8d, 1Fh
                test    rax, rax
                js      short loc_140283922
                jz      short loc_140283922
                lea     rax, dword_1400174A0
                mov     edx, [rax+r8*4]
                mov     eax, edx
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_140283922:                          ; CODE XREF: sub_1402834D0+43C↑j
                                        ; sub_1402834D0+43E↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     [rcx+4F0h], rbp
                jz      short loc_140283961
                mov     rdx, [r14+8]
                mov     rax, 8000000000000000h
                or      rdx, rax
                call    sub_1402C6E74
                test    rax, rax
                jz      short loc_140283961
                lea     rax, dword_1400174A0
                mov     r8d, [rax+r8*4]

loc_140283961:                          ; CODE XREF: sub_1402834D0+469↑j
                                        ; sub_1402834D0+484↑j
                mov     edx, r8d

loc_140283964:                          ; CODE XREF: sub_1402834D0+3AE↑j
                mov     eax, edx
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_14028396B:                          ; CODE XREF: sub_1402834D0+117↑j
                bt      rdi, 0Ah
                jnb     loc_140283B7A
                mov     rcx, rdi
                call    sub_14031C870
                test    eax, eax
                jz      loc_140283AA2
                shr     rdi, 5
                and     edi, 1Fh
                bt      ebx, 14h
                jb      loc_140283BEF
                mov     rax, [r15+48h]
                mov     edx, 3FFh
                shl     rsi, 19h
                mov     rcx, [rax]
                mov     rax, cs:qword_140C4E4C8
                movzx   ecx, word ptr [rcx+3Ch]
                and     rcx, rdx
                mov     rcx, [rax+rcx*8]
                movzx   eax, word ptr [rcx]
                mov     [r12], ax
                mov     rcx, 0FFFFF68000000000h
                mov     rax, rcx
                shl     rax, 19h
                lea     r9, [rsp+78h+arg_0]
                sub     rsi, rax
                mov     r8d, 4
                sar     rsi, 10h
                mov     rcx, r15
                shr     rsi, 0Ch
                mov     rdx, rsi
                call    sub_140283270
                mov     rbx, rax
                test    rax, rax
                jz      loc_140283A86
                mov     rdx, [r15+78h]
                test    rdx, rdx
                jns     short loc_140283A2D
                mov     eax, [r15+18h]
                movzx   ecx, byte ptr [r15+20h]
                shl     rcx, 20h
                or      rcx, rax
                mov     rax, [rdx]
                dec     rax
                sub     rsi, rcx
                shr     rax, 0Ch
                cmp     rsi, rax
                ja      short loc_140283A86

loc_140283A2D:                          ; CODE XREF: sub_1402834D0+539↑j
                mov     rax, [rsp+78h+arg_0]
                mov     rcx, [rax]
                cmp     [rcx+40h], rbp
                jnz     loc_140283BEF
                test    dword ptr [rcx+38h], 2000h
                jnz     loc_140283BEF
                xor     r9d, r9d
                lea     r8, [rsp+78h+arg_8]
                mov     rcx, rbx
                call    sub_1402DBC80
                test    eax, eax
                js      short loc_140283A8D
                mov     rcx, rbx
                call    sub_1402805F0
                mov     rcx, [rsp+78h+arg_8]
                mov     dl, 2
                mov     rbx, rax
                call    sub_140297330
                test    rbx, rbx
                cmovnz  ebp, edi

loc_140283A86:                          ; CODE XREF: sub_1402834D0+52C↑j
                                        ; sub_1402834D0+55B↑j
                mov     edi, ebp
                jmp     loc_140283BEF
; ---------------------------------------------------------------------------

loc_140283A8D:                          ; CODE XREF: sub_1402834D0+594↑j
                mov     rax, [rsp+78h+arg_10]
                mov     edi, 100h
                mov     [rax], rbx
                jmp     loc_140283BEF
; ---------------------------------------------------------------------------

loc_140283AA2:                          ; CODE XREF: sub_1402834D0+4B0↑j
                mov     rax, cs:qword_140C4DDC0
                mov     rbp, rdi
                test    rax, rax
                jz      short loc_140283AC0
                test    dil, 10h
                jnz     short loc_140283AC0
                mov     rbp, rax
                not     rbp
                and     rbp, rdi

loc_140283AC0:                          ; CODE XREF: sub_1402834D0+5DF↑j
                                        ; sub_1402834D0+5E5↑j
                mov     rcx, rdi
                sar     rbp, 10h
                call    sub_14031C5E8
                test    al, al
                jz      short loc_140283AE3
                lea     rax, [rbp-30h]
                and     rax, 0FFFFFFFFFFFFF000h
                mov     rax, [rax+10h]
                mov     rcx, [rax]
                jmp     short loc_140283B0A
; ---------------------------------------------------------------------------

loc_140283AE3:                          ; CODE XREF: sub_1402834D0+5FE↑j
                call    PsGetCurrentProcess
                cmp     qword ptr [rax+4F0h], 0
                jz      short loc_140283B2B
                mov     rdx, rbp
                mov     rcx, rax
                call    sub_1402C6E74
                test    rax, rax
                jz      short loc_140283B2B
                mov     rax, [rax+38h]
                mov     rcx, [rax+18h]

loc_140283B0A:                          ; CODE XREF: sub_1402834D0+611↑j
                movzx   eax, word ptr [rcx]
                mov     rcx, rbp
                mov     [r12], ax
                call    sub_14036C490
                mov     ecx, eax
                lea     rax, dword_1400174A0
                mov     eax, [rax+rcx*4]
                jmp     loc_140283BF1
; ---------------------------------------------------------------------------

loc_140283B2B:                          ; CODE XREF: sub_1402834D0+620↑j
                                        ; sub_1402834D0+630↑j
                cmp     r13d, 20h ; ' '
                jnz     loc_140283C03
                and     ebx, 0F80h
                cmp     ebx, 380h
                jnz     loc_140283C03
                mov     rax, [r15+48h]
                mov     edx, 3FFh
                mov     rcx, [rax]
                mov     rax, cs:qword_140C4E4C8
                movzx   ecx, word ptr [rcx+3Ch]
                and     rcx, rdx
                mov     rdx, rbp
                mov     rcx, [rax+rcx*8]
                movzx   eax, word ptr [rcx]
                mov     rcx, r15
                mov     [r12], ax
                call    sub_14034DFE0
                jmp     short loc_140283BF1
; ---------------------------------------------------------------------------

loc_140283B7A:                          ; CODE XREF: sub_1402834D0+4A0↑j
                bt      rdi, 0Bh
                jnb     short loc_140283BB6
                xor     edx, edx
                mov     rcx, rsi
                call    sub_1402A886C
                test    rax, rax
                jz      short loc_140283BB6
                mov     rcx, [rax+28h]
                mov     edx, 3FFh
                shr     rcx, 27h
                and     cx, dx
                mov     [r12], cx
                mov     rcx, 7FFFFFFFFFFFFFFFh
                lock and [rax+18h], rcx
                jmp     short loc_140283BD5
; ---------------------------------------------------------------------------

loc_140283BB6:                          ; CODE XREF: sub_1402834D0+6AF↑j
                                        ; sub_1402834D0+6BE↑j
                call    PsGetCurrentProcess
                movzx   ecx, word ptr [rax+72Eh]
                mov     rax, cs:qword_140C4E4C8
                mov     rcx, [rax+rcx*8]
                movzx   eax, word ptr [rcx]
                mov     [r12], ax

loc_140283BD5:                          ; CODE XREF: sub_1402834D0+6E4↑j
                mov     eax, [r15+30h]
                shr     rdi, 5
                and     eax, 1100000h
                and     edi, 1Fh
                cmp     eax, 1100000h
                jnz     short loc_140283BEF
                mov     [r14], ebp

loc_140283BEF:                          ; CODE XREF: sub_1402834D0+4C1↑j
                                        ; sub_1402834D0+56C↑j ...
                mov     eax, edi

loc_140283BF1:                          ; CODE XREF: sub_1402834D0+10E↑j
                                        ; sub_1402834D0+1F9↑j ...
                add     rsp, 38h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140283C03:                          ; CODE XREF: sub_1402834D0+65F↑j
                                        ; sub_1402834D0+671↑j
                mov     r9, rdi
                mov     [rsp+78h+var_58], r15
                mov     r8, rsi
                mov     edx, 41202h
                mov     ecx, 1Ah
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_1402834D0   endp

byte_140283C1E  db 12h dup(0CCh)        ; DATA XREF: .pdata:00000001400CEAD8↑o

; =============== S U B R O U T I N E =======================================


sub_140283C30   proc near               ; CODE XREF: sub_1402841E0+417↓p
                                        ; DATA XREF: .rdata:000000014005EAB8↑o ...

var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = qword ptr -98h
var_88          = byte ptr -88h
var_84          = dword ptr -84h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h
arg_20          = dword ptr  28h

; FUNCTION CHUNK AT 0000000140418A60 SIZE 00000024 BYTES
; FUNCTION CHUNK AT 0000000140443A78 SIZE 000005F8 BYTES

; __unwind { // __C_specific_handler
                mov     [rsp+arg_18], r9
                mov     [rsp+arg_10], r8d
                mov     [rsp+arg_8], rdx
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 90h
                mov     r14, r9
                mov     esi, r8d
                mov     r12, rdx
                mov     r13, rcx
                xor     eax, eax
                mov     [rsp+0C8h+var_78], rax
                mov     [rsp+0C8h+var_84], eax
                mov     [rsp+0C8h+var_70], rax
                mov     [rsp+0C8h+var_68], rax
                mov     rdx, rcx
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rcx, 0FFFFF6FB40000000h
                add     rdx, rcx
                mov     rbx, [rdx]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                mov     rdi, 0FFFFF6FB7DBED7F8h
                cmp     rdx, rax
                jnb     loc_140283F75

loc_140283CB4:                          ; CODE XREF: sub_140283C30+34B↓j
                                        ; sub_140283C30+1BFE52↓j ...
                mov     [rsp+0C8h+var_58], rbx
                lea     rcx, [rsp+0C8h+var_58]
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140283EDF

loc_140283CCB:                          ; CODE XREF: sub_140283C30+2B9↓j
                                        ; sub_140283C30+2D6↓j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                lea     rcx, [rbx+rbx*2]
                add     rcx, rcx
                mov     rbx, 0FFFFFA8000000000h
                mov     rax, rbx
                mov     rdx, [rax+rcx*8+10h]
                test    rdx, rdx
                jz      short loc_140283D0C
                mov     rax, r13
                shr     rax, 12h
                and     eax, 7
                lea     rax, [rax+rax*4]
                lea     rdx, [rdx+rax*8]

loc_140283D0C:                          ; CODE XREF: sub_140283C30+C8↑j
                mov     rdx, [rdx+18h]
                movzx   eax, dl
                mov     rcx, rdx
                and     rcx, 0FFFFFFFFFFFFFFFEh
                and     al, 1
                cmovz   rcx, rdx
                mov     rax, [rcx]
                mov     [rsp+0C8h+var_48], rax
                movzx   ecx, word ptr [rax+3Ch]
                and     ecx, 3FFh
                mov     rax, cs:qword_140C4E4C8
                mov     r9, [rax+rcx*8]
                add     r9, 1C40h
                mov     [rsp+0C8h+var_50], r9
                lea     rax, [rsi+r14]
                cmp     rax, 1000h
                ja      loc_140444055
                cmp     rax, r14
                jb      loc_140444055
                mov     rsi, r13
                shr     rsi, 9
                mov     rcx, 7FFFFFFFF8h
                and     rsi, rcx
                mov     rcx, 0FFFFF68000000000h
                add     rsi, rcx
                mov     r15d, [rsp+0C8h+arg_20]
                test    r15b, 4
                jnz     loc_140443B0F

loc_140283D98:                          ; CODE XREF: sub_140283C30+1BFEF3↓j
                test    r15b, 8
                jnz     loc_140443B33
                xor     ecx, ecx
                mov     [rsp+0C8h+var_80], rcx

loc_140283DA9:                          ; CODE XREF: sub_140283C30+1BFF30↓j
                mov     r8, [rsi]
                mov     rdx, 0FFFFF6FB7DBED000h
                mov     rax, rdx
                cmp     rsi, rax
                jnb     loc_140283F86

loc_140283DC2:                          ; CODE XREF: sub_140283C30+35C↓j
                                        ; sub_140283C30+1BFF3F↓j ...
                test    r8b, 1
                jnz     loc_140284169

loc_140283DCC:                          ; CODE XREF: sub_140283C30+1BFFF4↓j
                                        ; DATA XREF: .rdata:000000014005EA94↑o
;   __try { // __except at loc_140283DD3
                movzx   eax, byte ptr [r12]
                jmp     short loc_140283DFC
;   } // starts at 140283DCC
; ---------------------------------------------------------------------------

loc_140283DD3:                          ; DATA XREF: .rdata:000000014005EA94↑o
;   __except(1) // owned by 140283DCC
                mov     edi, eax
                mov     [rsp+0C8h+var_84], eax
                mov     r14, 0FFFFFFFFFh
                mov     r15, 0FFFFFA8000000000h
                mov     r12, 7FFFFFFFFFFFFFFFh
                jmp     loc_140284154
; ---------------------------------------------------------------------------

loc_140283DFC:                          ; CODE XREF: sub_140283C30+1A1↑j
                mov     rbx, [rsi]
                mov     rax, rdx
                cmp     rsi, rax
                jnb     loc_140283FA2

loc_140283E0B:                          ; CODE XREF: sub_140283C30+378↓j
                                        ; sub_140283C30+1C0003↓j ...
                test    bl, 1
                jnz     loc_140443CB3

loc_140283E14:                          ; CODE XREF: sub_140283C30+1C009E↓j
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_140283E2D
                test    bl, 10h
                jz      loc_140283F97
                and     rbx, 0FFFFFFFFFFFFFFEFh

loc_140283E2D:                          ; CODE XREF: sub_140283C30+1EE↑j
                                        ; sub_140283C30+36D↓j
                sar     rbx, 10h
                mov     r12, 7FFFFFFFFFFFFFFFh

loc_140283E3B:                          ; CODE XREF: sub_140283C30+462↓j
                                        ; sub_140283C30+1C0114↓j ...
                xor     edi, edi
                mov     r14b, 11h
                mov     [rsp+0C8h+var_88], r14b
                mov     rcx, rbx
                call    sub_1402805F0
                mov     [rsp+0C8h+var_78], rax
                test    al, 1
                jnz     loc_140283FC1
                bt      rax, 0Ah
                jnb     loc_140283FC1

loc_140283E65:                          ; CODE XREF: sub_140283C30+1C0198↓j
                test    rdi, rdi
                jnz     loc_140443DCD

loc_140283E6E:                          ; CODE XREF: sub_140283C30+1C01AA↓j
                mov     rcx, [rsp+0C8h+var_48]
                call    sub_1402851C0
                test    eax, eax
                jnz     loc_140443DDF
                lea     rax, [rsp+0C8h+var_84]
                mov     [rsp+0C8h+var_98], rax
                lea     rax, [rsp+0C8h+var_78]
                mov     [rsp+0C8h+var_A0], rax
                mov     dword ptr [rsp+0C8h+var_A8], r15d
                mov     r14, [rsp+0C8h+arg_18]
                mov     r9, r14
                mov     r8d, [rsp+0C8h+arg_10]
                mov     rdx, [rsp+0C8h+arg_8]
                mov     rcx, rbx
                call    sub_140276AE0
                test    eax, eax
                jnz     loc_140443E16
                mov     eax, [rsp+0C8h+var_84]

loc_140283ECB:                          ; CODE XREF: sub_140283C30+534↓j
                                        ; sub_140283C30+1BFEFE↓j ...
                add     rsp, 90h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140283EDF:                          ; CODE XREF: sub_140283C30+95↑j
                test    cs:dword_140CFC400, 0C00000h
                jz      loc_140283CCB
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      loc_140283CCB
                test    bl, 1
                jz      loc_140283CCB
                test    bl, 20h
                jnz     loc_140283FB3

loc_140283F1E:                          ; CODE XREF: sub_140283C30+38C↓j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      loc_140283CCB
                lea     rax, [rsp+0C8h+var_58]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                mov     rdx, rbx
                or      rdx, 20h
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      loc_140283CCB
                or      rbx, 42h
                jmp     loc_140283CCB
; ---------------------------------------------------------------------------

loc_140283F75:                          ; CODE XREF: sub_140283C30+7E↑j
                mov     rax, rdi
                cmp     rdx, rax
                ja      loc_140283CB4
                jmp     loc_140443A78
; ---------------------------------------------------------------------------

loc_140283F86:                          ; CODE XREF: sub_140283C30+18C↑j
                mov     rax, rdi
                cmp     rsi, rax
                ja      loc_140283DC2
                jmp     loc_140443B65
; ---------------------------------------------------------------------------

loc_140283F97:                          ; CODE XREF: sub_140283C30+1F3↑j
                not     rax
                and     rbx, rax
                jmp     loc_140283E2D
; ---------------------------------------------------------------------------

loc_140283FA2:                          ; CODE XREF: sub_140283C30+1D5↑j
                mov     rax, rdi
                cmp     rsi, rax
                ja      loc_140283E0B
                jmp     loc_140443C29
; ---------------------------------------------------------------------------

loc_140283FB3:                          ; CODE XREF: sub_140283C30+2E8↑j
                test    bl, 42h
                jnz     loc_140283CCB
                jmp     loc_140283F1E
; ---------------------------------------------------------------------------

loc_140283FC1:                          ; CODE XREF: sub_140283C30+224↑j
                                        ; sub_140283C30+22F↑j ...
                lea     rdx, [rsp+0C8h+var_88]
                mov     rcx, rbx
                call    sub_140299CD0
                mov     rdi, rax
                test    rax, rax
                jz      loc_140443CEA
                xor     edx, edx
                mov     rcx, rbx
                call    sub_14032EF40
                mov     r13, rax
                mov     rcx, rbx
                call    sub_1402805F0
                mov     [rsp+0C8h+var_78], rax
                test    r13, r13
                jz      loc_140443DBA
                test    al, 1
                jnz     loc_140284196
                mov     rax, [r13+10h]
                bt      rax, 0Ah
                jnb     loc_1402841C5
                shr     rax, 0Bh

loc_140284018:                          ; CODE XREF: sub_140283C30+599↓j
                test    al, 1
                jnz     loc_140443D02

loc_140284020:                          ; CODE XREF: sub_140283C30+1C00E8↓j
                mov     edx, r15d
                mov     rcx, rbx
                call    sub_140342FE0
                mov     r14d, eax
                test    eax, eax
                jnz     short loc_14028403F
                mov     rcx, rbx
                call    sub_1402805F0
                mov     [rsp+0C8h+var_78], rax

loc_14028403F:                          ; CODE XREF: sub_140283C30+400↑j
                                        ; sub_140283C30+590↓j
                mov     [rsp+0C8h+var_84], 0
                xor     r15d, r15d
                cmp     [rsp+0C8h+var_80], r15
                jnz     loc_140443D49

loc_140284055:                          ; CODE XREF: sub_140283C30+1C011C↓j
                                        ; sub_140283C30+1C012E↓j ...
                lock and [r13+18h], r12
                movzx   edx, [rsp+0C8h+var_88]
                mov     rcx, rdi
                call    sub_140297330
                mov     rdi, [rsp+0C8h+var_68]
                test    rdi, rdi
                jnz     loc_140443D77

loc_140284075:                          ; CODE XREF: sub_140283C30+1C015E↓j
                test    r15d, r15d
                js      loc_140443EEA
                cmp     r14d, 1
                mov     r15d, [rsp+0C8h+arg_20]
                mov     r13, [rsp+0C8h+arg_0]
                jz      loc_140283E3B
                cmp     r14d, 2
                jz      loc_140443D93
                mov     r14, [rsp+0C8h+var_80]
                test    r14, r14
                jnz     loc_140443E3B

loc_1402840B0:                          ; CODE XREF: sub_140283C30+1C02B5↓j
                mov     r13, [rsp+0C8h+arg_0]
                mov     r14, [rsp+0C8h+arg_18]
                mov     ebx, 1

loc_1402840C5:                          ; CODE XREF: sub_140283C30+1C0206↓j
                                        ; sub_140283C30+1C02C5↓j
                mov     r9d, r15d
                mov     r8, [rsp+0C8h+var_78]
                mov     rdx, rsi
                mov     rcx, [rsp+0C8h+var_50]
                call    sub_1402A4FB0
                mov     rcx, [rsp+0C8h+var_70]

loc_1402840DF:                          ; CODE XREF: sub_140283C30+561↓j
                xor     edi, edi
                mov     [rsp+0C8h+var_84], edi
                test    ebx, ebx
                jz      loc_140443DFD
                mov     eax, [rsp+0C8h+arg_10]
                test    rcx, rcx
                jnz     short loc_1402840FC
                mov     rcx, r13

loc_1402840FC:                          ; CODE XREF: sub_140283C30+4C7↑j
                                        ; DATA XREF: .rdata:000000014005EAA4↑o
;   __try { // __except at loc_140284132
                add     rcx, rax
                mov     r8, r14
                mov     rdx, [rsp+0C8h+arg_8]
                test    r15b, 4
                jnz     short loc_140284117
                call    memmove
                jmp     short loc_14028411C
; ---------------------------------------------------------------------------

loc_140284117:                          ; CODE XREF: sub_140283C30+4DE↑j
                call    RtlCopyMemoryNonTemporal

loc_14028411C:                          ; CODE XREF: sub_140283C30+4E5↑j
                mov     r14, 0FFFFFFFFFh
                mov     r15, 0FFFFFA8000000000h
                jmp     short loc_140284154
;   } // starts at 1402840FC
; ---------------------------------------------------------------------------

loc_140284132:                          ; DATA XREF: .rdata:000000014005EAA4↑o
;   __except(loc_140418A60) // owned by 1402840FC
                mov     r14, 0FFFFFFFFFh
                mov     r15, 0FFFFFA8000000000h
                mov     r12, 7FFFFFFFFFFFFFFFh
                mov     edi, [rsp+0C8h+var_84]

loc_140284154:                          ; CODE XREF: sub_140283C30+1C7↑j
                                        ; sub_140283C30+500↑j ...
                mov     rsi, [rsp+0C8h+var_80]
                test    rsi, rsi
                jnz     loc_140443EFA

loc_140284162:                          ; CODE XREF: sub_140283C30+1C02F2↓j
                                        ; sub_140283C30+1C0420↓j
                mov     eax, edi
                jmp     loc_140283ECB
; ---------------------------------------------------------------------------

loc_140284169:                          ; CODE XREF: sub_140283C30+196↑j
                mov     rdx, rsi
                test    rcx, rcx
                jnz     loc_140443BFC
                mov     rcx, r9
                call    sub_14034EEF8
                mov     r12, 7FFFFFFFFFFFFFFFh

loc_140284187:                          ; CODE XREF: sub_140283C30+1C01FB↓j
                mov     rcx, [rsp+0C8h+var_70]

loc_14028418C:                          ; CODE XREF: sub_140283C30+1C00B5↓j
                mov     ebx, 1
                jmp     loc_1402840DF
; ---------------------------------------------------------------------------

loc_140284196:                          ; CODE XREF: sub_140283C30+3CF↑j
                mov     rdx, [r13+18h]
                mov     rax, rdx
                mov     r8, 3FFFFFFFFFFFFFFFh
                and     rax, r8
                inc     rax
                mov     rcx, rdx
                xor     rcx, rax
                and     rcx, r8
                xor     rcx, rdx
                mov     [r13+18h], rcx
                xor     r14d, r14d
                jmp     loc_14028403F
; ---------------------------------------------------------------------------

loc_1402841C5:                          ; CODE XREF: sub_140283C30+3DE↑j
                shr     rax, 3
                jmp     loc_140284018
; } // starts at 140283C30
sub_140283C30   endp ; sp-analysis failed

; ---------------------------------------------------------------------------
algn_1402841CE:                         ; DATA XREF: .rdata:000000014005EAB8↑o
                                        ; .pdata:00000001400CEAE4↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402841E0   proc near               ; CODE XREF: CcCopyWriteEx+E5↓p
                                        ; DATA XREF: .rdata:000000014005EB18↑o ...

var_178         = qword ptr -178h
var_170         = qword ptr -170h
var_168         = byte ptr -168h
var_167         = byte ptr -167h
var_166         = byte ptr -166h
var_165         = byte ptr -165h
var_164         = byte ptr -164h
var_163         = byte ptr -163h
var_160         = dword ptr -160h
var_15C         = byte ptr -15Ch
var_15B         = byte ptr -15Bh
var_15A         = byte ptr -15Ah
var_159         = byte ptr -159h
var_158         = byte ptr -158h
var_157         = byte ptr -157h
var_154         = dword ptr -154h
var_14C         = dword ptr -14Ch
var_148         = dword ptr -148h
var_144         = dword ptr -144h
var_140         = qword ptr -140h
var_134         = dword ptr -134h
var_130         = qword ptr -130h
var_128         = qword ptr -128h
var_120         = dword ptr -120h
var_11C         = dword ptr -11Ch
var_118         = dword ptr -118h
var_114         = dword ptr -114h
var_110         = dword ptr -110h
var_10C         = dword ptr -10Ch
var_108         = xmmword ptr -108h
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = xmmword ptr -0E8h
var_D8          = qword ptr -0D8h
var_D0          = dword ptr -0D0h
var_CC          = dword ptr -0CCh
var_C8          = dword ptr -0C8h
var_C4          = dword ptr -0C4h
var_C0          = dword ptr -0C0h
var_B8          = dword ptr -0B8h
var_B0          = dword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = qword ptr -0A0h
var_98          = xmmword ptr -98h
var_88          = qword ptr -88h
var_80          = dword ptr -80h
var_7C          = dword ptr -7Ch
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = xmmword ptr -60h
var_50          = qword ptr -50h
var_38          = byte ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = dword ptr  20h
arg_20          = dword ptr  28h
arg_28          = qword ptr  30h
arg_30          = qword ptr  38h
arg_38          = byte ptr  40h
arg_40          = qword ptr  48h

; FUNCTION CHUNK AT 0000000140418A90 SIZE 00000234 BYTES
; FUNCTION CHUNK AT 0000000140444070 SIZE 000002C6 BYTES

; __unwind { // __C_specific_handler
                mov     [rsp+arg_18], r9d
                mov     [rsp+arg_10], r8
                mov     [rsp+arg_8], rdx
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 160h
                mov     [rsp+198h+var_118], r9d
                mov     r12, rcx
                movzx   r10d, [rsp+198h+arg_38]
                xor     r15d, r15d
                mov     [rsp+198h+var_144], r15d
                mov     [rsp+198h+var_154], r15d
                mov     [rsp+198h+var_F8], r15
                xorps   xmm0, xmm0
                movups  [rsp+198h+var_108], xmm0
                mov     r14, [rsp+198h+arg_28]
                mov     eax, [r14+50h]
                test    al, 10h
                jnz     loc_140284D61
                xor     bl, bl

loc_140284250:                          ; CODE XREF: sub_1402841E0+B83↓j
                mov     [rsp+198h+var_168], bl
                mov     [rsp+198h+var_C4], r9d
                mov     eax, [r8]
                and     eax, 0FFFh
                mov     [rsp+198h+var_14C], eax
                mov     [rsp+198h+var_128], r15
                mov     rdx, gs:188h
                mov     [rsp+198h+var_F0], rdx
                mov     r13d, r15d
                mov     [rsp+198h+var_160], r15d
                mov     [rsp+198h+var_159], r13b
                mov     [rsp+198h+var_165], r13b
                mov     rdi, r15
                mov     [rsp+198h+var_A0], r15
                mov     [rsp+198h+var_15C], 1
                mov     [rsp+198h+var_166], dil
                mov     [rsp+198h+var_163], dil
                xor     eax, eax
                movups  [rsp+198h+var_E8], xmm0
                mov     [rsp+198h+var_D8], rax
                xorps   xmm1, xmm1
                movups  [rsp+198h+var_98], xmm1
                mov     [rsp+198h+var_88], rax
                mov     ecx, 1000h
                test    [r12+98h], ecx
                jnz     loc_140444070
                mov     [rsp+198h+var_164], al

loc_1402842E6:                          ; CODE XREF: sub_1402841E0+1BFE95↓j
                mov     rax, [r8]
                mov     [rsp+198h+var_140], rax
                movzx   ecx, byte ptr [rdx+51Ch]
                mov     eax, [rdx+508h]
                lea     eax, [rcx+rax*4]
                mov     [rsp+198h+var_11C], eax
                mov     [rsp+198h+var_C8], eax
                movzx   esi, bl
                mov     [rsp+198h+var_15A], bl
                mov     [rsp+198h+var_157], bl
                test    bl, bl
                jnz     loc_1402843A8
                mov     [rsp+198h+var_15A], bl
                xor     eax, eax
                movups  [rsp+198h+var_60], xmm0
                mov     [rsp+198h+var_50], rax
                mov     rbx, [r12+210h]
                cmp     [r12+0A8h], rax
                jz      short loc_140284360
                mov     rcx, [r12+60h]
                and     rcx, 0FFFFFFFFFFFFFFF0h
                mov     rcx, [rcx+28h]
                call    sub_140285080
                cmp     rbx, [rax+8]
                jnz     loc_14044407A

loc_140284360:                          ; CODE XREF: sub_1402841E0+162↑j
                test    dword ptr [r14+50h], 1000000h
                jnz     loc_140284F3B

loc_14028436E:                          ; CODE XREF: sub_1402841E0+D7D↓j
                mov     rdx, gs:188h
                mov     rcx, rdx
                call    sub_140310190
                cmp     eax, 2
                jl      loc_140284D3E

loc_140284388:                          ; CODE XREF: sub_1402841E0+B6A↓j
                                        ; sub_1402841E0+B76↓j
                test    eax, eax
                jle     loc_140284DC5

loc_140284390:                          ; CODE XREF: sub_1402841E0+B7C↓j
                                        ; sub_1402841E0+BED↓j
                mov     r13d, [rsp+198h+var_160]

loc_140284395:                          ; CODE XREF: sub_1402841E0+C0C↓j
                                        ; sub_1402841E0+C59↓j
                mov     [rsp+198h+var_157], sil
                movzx   ebx, [rsp+198h+var_168]
                movzx   r10d, [rsp+198h+arg_38]

loc_1402843A8:                          ; CODE XREF: sub_1402841E0+136↑j
                mov     r14, 0FFFFFFFFFFFFFFFFh
                test    sil, sil
                jnz     loc_140284C6F

loc_1402843B8:                          ; CODE XREF: sub_1402841E0+A92↓j
                mov     eax, 6
                mov     ecx, 4
                test    r10b, r10b
                cmovnz  eax, ecx
                mov     [rsp+198h+var_D0], eax
                mov     rsi, [r12+210h]
                mov     [rsp+198h+var_70], rsi
                cmp     [r12+0A8h], rdi
                jz      short loc_140284405
                mov     rcx, [r12+60h]
                and     rcx, 0FFFFFFFFFFFFFFF0h
                mov     rcx, [rcx+28h]
                call    sub_140285080
                cmp     rsi, [rax+8]
                jnz     loc_14044410D

loc_140284405:                          ; CODE XREF: sub_1402841E0+207↑j
                mov     [rsp+198h+var_68], rsi
                test    bl, bl
                jnz     loc_140284D68

loc_140284415:                          ; CODE XREF: sub_1402841E0+BE0↓j
                test    rdi, rdi
                jnz     loc_14028504A

loc_14028441E:                          ; CODE XREF: sub_1402841E0+E72↓j
                mov     r14, [rsp+198h+arg_40]
                test    r14, r14
                jnz     short loc_140284441
                mov     r14, gs:188h
                mov     [rsp+198h+arg_40], r14
                mov     r13d, [rsp+198h+var_160]

loc_140284441:                          ; CODE XREF: sub_1402841E0+249↑j
                mov     rdi, [r14+5C0h]
                mov     [rsp+198h+var_114], r15d
                test    rdi, rdi
                jnz     loc_140284C43

loc_140284459:                          ; CODE XREF: sub_1402841E0+A7D↓j
                mov     rbx, [r14+220h]

loc_140284460:                          ; CODE XREF: sub_1402841E0+A8A↓j
                cmp     [rbx+958h], r15
                jnz     loc_140284E3E
                mov     ebx, 0C0000225h

loc_140284472:                          ; CODE XREF: sub_1402841E0+CC8↓j
                                        ; sub_1402841E0+1C0092↓j
                cmp     [rsp+198h+var_114], r15d
                jnz     loc_140284F2E

loc_140284480:                          ; CODE XREF: sub_1402841E0+D56↓j
                mov     [rsp+198h+var_148], ebx
                test    ebx, ebx
                jns     loc_140284EAD

loc_14028448C:                          ; CODE XREF: sub_1402841E0+CF3↓j
                                        ; DATA XREF: .rdata:000000014005EB04↑o
;   __try { // __finally(loc_140418AB1)
                mov     rbx, [rsp+198h+var_128]
                mov     esi, [rsp+198h+var_154]
                jmp     loc_140284770
; ---------------------------------------------------------------------------

loc_14028449A:                          ; CODE XREF: sub_1402841E0+598↓j
                mov     [rsp+198h+var_167], 0
                cmp     [rsp+198h+var_164], 0
                jnz     loc_140284A25
                mov     r14d, [rsp+198h+arg_20]

loc_1402844B2:                          ; CODE XREF: sub_1402841E0+850↓j
                mov     [rsp+198h+var_154], r15d
                mov     dword ptr [rsp+198h+var_170], r15d
                mov     dword ptr [rsp+198h+var_178], r15d
                lea     r9, [rsp+198h+var_144]
                lea     r8, [rsp+198h+var_128]
                mov     rdx, [rsp+198h+var_140]
                mov     rcx, r12
                call    sub_140273980
                mov     r10, rax
                mov     [rsp+198h+var_130], rax
                mov     esi, [rsp+198h+var_144]
                mov     ecx, [rsp+198h+arg_18]
                cmp     esi, ecx
                jbe     short loc_1402844F5
                mov     esi, ecx
                mov     [rsp+198h+var_144], ecx

loc_1402844F5:                          ; CODE XREF: sub_1402841E0+30D↑j
                mov     [rsp+198h+var_154], esi
                sub     [rsp+198h+arg_18], esi
                mov     edx, [rsp+198h+var_14C]
                sub     r10, rdx
                mov     [rsp+198h+var_130], r10
                add     esi, edx
                mov     [rsp+198h+var_120], esi
                mov     [rsp+198h+var_144], esi
                mov     eax, 1
                mov     [rsp+198h+var_134], eax
                mov     rbx, [rsp+198h+var_140]
                mov     [rsp+198h+var_F8], rbx
                sub     ebx, edx
                mov     dword ptr [rsp+198h+var_F8], ebx
                mov     [rsp+198h+var_166], 0
                mov     [rsp+198h+var_167], 0
                mov     ecx, esi
                mov     r8d, 1000h

loc_140284547:                          ; CODE XREF: sub_1402841E0+4D3↓j
                mov     [rsp+198h+var_15C], 1
                mov     edi, r15d
                cmp     ecx, r8d
                setnbe  dil
                mov     [rsp+198h+var_CC], edi
                mov     [rsp+198h+var_80], edi
                mov     [rsp+198h+var_148], r15d
                test    r14d, eax
                jz      loc_1402847C3
                mov     rax, [rsp+198h+arg_30]
                mov     rax, [rax]
                cmp     [rsp+198h+var_F8], rax
                jl      short loc_140284590
                or      r13d, 1
                mov     [rsp+198h+var_160], r13d

loc_140284590:                          ; CODE XREF: sub_1402841E0+3A5↑j
                mov     eax, [r12+98h]
                test    al, 40h
                jnz     loc_1402847A2

loc_1402845A0:                          ; CODE XREF: sub_1402841E0+5CB↓j
                bt      eax, 1Eh
                jb      loc_140284A35

loc_1402845AA:                          ; CODE XREF: sub_1402841E0+874↓j
                                        ; sub_1402841E0+883↓j ...
                test    edi, edi
                mov     r12d, r8d
                jz      loc_140284788

loc_1402845B5:                          ; CODE XREF: sub_1402841E0+5AB↓j
                sub     r12d, edx
                mov     esi, r13d
                mov     [rsp+198h+var_B8], r13d
                mov     edi, r15d
                mov     [rsp+198h+var_C0], r15d
                mov     r14d, 1
                mov     [rsp+198h+var_B0], r14d

loc_1402845DC:                          ; CODE XREF: sub_1402841E0+8C4↓j
                cmp     r14d, 2
                ja      short loc_140284613
                mov     r9d, r12d
                mov     dword ptr [rsp+198h+var_178], esi
                mov     r8d, edx
                mov     rdx, [rsp+198h+arg_8]
                mov     rcx, r10
                call    sub_140283C30
                mov     edi, eax
                mov     [rsp+198h+var_C0], eax
                test    sil, 8
                jnz     loc_140284A7B

loc_14028460F:                          ; CODE XREF: sub_1402841E0+8A0↓j
                mov     edx, [rsp+198h+var_14C]

loc_140284613:                          ; CODE XREF: sub_1402841E0+400↑j
                test    sil, 4
                jnz     loc_140284AA9
                mov     al, 1

loc_14028461F:                          ; CODE XREF: sub_1402841E0+8CB↓j
                mov     [rsp+198h+var_15B], al
                mov     [rsp+198h+var_148], edi
                test    edi, edi
                js      loc_140284AB0
                mov     [rsp+198h+var_166], 1
                cmp     [rsp+198h+var_167], 0
                jz      loc_140284790

loc_14028463F:                          ; CODE XREF: sub_1402841E0+5B2↓j
                                        ; sub_1402841E0+5BD↓j
                mov     r12, [rsp+198h+arg_0]

loc_140284647:                          ; CODE XREF: sub_1402841E0+7BC↓j
                mov     r8d, 1000h
                mov     eax, r8d
                sub     eax, edx
                add     [rsp+198h+arg_8], rax
                mov     edx, r15d
                mov     [rsp+198h+var_14C], edx
                cmp     [rsp+198h+var_CC], edx
                jz      short loc_1402846B8
                mov     r10, [rsp+198h+var_130]
                add     r10, r8
                mov     [rsp+198h+var_130], r10
                mov     esi, [rsp+198h+var_120]
                add     esi, 0FFFFF000h
                mov     [rsp+198h+var_120], esi
                mov     ecx, esi
                mov     [rsp+198h+var_144], esi
                add     ebx, r8d
                mov     dword ptr [rsp+198h+var_F8], ebx
                cmp     [rsp+198h+arg_18], edx
                jz      loc_1402847B0
                mov     eax, 2

loc_1402846A7:                          ; CODE XREF: sub_1402841E0+5DE↓j
                                        ; sub_1402841E0+7C6↓j
                mov     [rsp+198h+var_134], eax
                mov     r14d, [rsp+198h+arg_20]
                jmp     loc_140284547
; ---------------------------------------------------------------------------

loc_1402846B8:                          ; CODE XREF: sub_1402841E0+488↑j
                mov     [rsp+198h+var_166], dl
                mov     rax, [rsp+198h+var_128]
                mov     rbx, [rax+8]
                mov     ecx, 0FFFFFFFFh
                lock xadd [rax+10h], ecx
                dec     ecx
                test    cx, cx
                jnz     short loc_1402846ED
                mov     rcx, [rbx+0B8h]
                test    rcx, rcx
                jnz     loc_140284B4C

loc_1402846E6:                          ; CODE XREF: sub_1402841E0+974↓j
                lock dec dword ptr [rbx+220h]

loc_1402846ED:                          ; CODE XREF: sub_1402841E0+4F4↑j
                mov     rbx, r15
                mov     [rsp+198h+var_128], rbx
                mov     r14, [rsp+198h+arg_40]
                mov     r9, r14
                mov     esi, [rsp+198h+var_154]
                mov     r8d, esi
                lea     rdx, [rsp+198h+var_140]
                mov     rcx, r12
                call    sub_1402889E0
                mov     ecx, [r12+98h]
                and     ecx, 40000000h
                jnz     short loc_14028473D
                mov     eax, [rsp+198h+var_118]
                sub     eax, [rsp+198h+arg_18]
                cmp     eax, 1000000h
                ja      loc_140284B63

loc_14028473D:                          ; CODE XREF: sub_1402841E0+542↑j
                test    ecx, ecx
                jnz     loc_140284B59

loc_140284745:                          ; CODE XREF: sub_1402841E0+97D↓j
                                        ; sub_1402841E0+9BE↓j
                mov     eax, 1000h
                cmp     [rsp+198h+arg_18], eax
                mov     eax, [rsp+198h+arg_20]
                jnb     loc_1402849ED
                test    al, 4
                jz      loc_1402849E0

loc_140284766:                          ; CODE XREF: sub_1402841E0+808↓j
                                        ; sub_1402841E0+817↓j
                add     [rsp+198h+var_140], rsi
                mov     r13d, [rsp+198h+var_160]

loc_140284770:                          ; CODE XREF: sub_1402841E0+2B5↑j
                cmp     [rsp+198h+arg_18], 0
                jnz     loc_14028449A
                mov     [rsp+198h+var_158], 1
                jmp     loc_140284BBB
; ---------------------------------------------------------------------------

loc_140284788:                          ; CODE XREF: sub_1402841E0+3CF↑j
                mov     r12d, esi
                jmp     loc_1402845B5
; ---------------------------------------------------------------------------

loc_140284790:                          ; CODE XREF: sub_1402841E0+459↑j
                test    al, al
                jz      loc_14028463F
                mov     [rsp+198h+var_167], 1
                jmp     loc_14028463F
; ---------------------------------------------------------------------------

loc_1402847A2:                          ; CODE XREF: sub_1402841E0+3BA↑j
                or      r13d, 2
                mov     [rsp+198h+var_160], r13d
                jmp     loc_1402845A0
; ---------------------------------------------------------------------------

loc_1402847B0:                          ; CODE XREF: sub_1402841E0+4BC↑j
                cmp     ecx, r8d
                jbe     loc_1402849A1
                mov     eax, 2
                jmp     loc_1402846A7
; ---------------------------------------------------------------------------

loc_1402847C3:                          ; CODE XREF: sub_1402841E0+38C↑j
                test    edi, edi
                jnz     loc_1402849AB

loc_1402847CB:                          ; CODE XREF: sub_1402841E0+7CF↓j
                                        ; sub_1402841E0+7EB↓j ...
                lea     r9, [rsp+198h+var_15C]
                mov     r8d, [rsp+198h+var_D0]
                mov     edx, 1
                mov     rcx, r10
                call    sub_140274000
                mov     [rsp+198h+var_7C], eax
                cmp     [rsp+198h+var_15C], 0
                jz      loc_1402849FC

loc_1402847F7:                          ; CODE XREF: sub_1402841E0+824↓j
                mov     r14, r15
                mov     [rsp+198h+var_A8], r15
                mov     rcx, r15
                mov     [rsp+198h+var_78], rcx
                mov     [rsp+198h+var_110], r15d
                test    eax, eax
                js      loc_140284AC6
                movzx   r8d, [rsp+198h+var_164]
                test    r8b, r8b
                jnz     loc_140284ACD

loc_14028482C:                          ; CODE XREF: sub_1402841E0+94A↓j
                                        ; DATA XREF: .rdata:000000014005EAF4↑o
;     __try { // __except at loc_14028493C
                mov     edx, [rsp+198h+var_14C]
                test    r8b, r8b
                jnz     loc_1402848C3
                mov     r10, [rsp+198h+var_130]
                add     r10, rdx

loc_140284841:                          ; CODE XREF: sub_1402841E0+6E7↓j
                test    edi, edi
                jnz     short loc_1402848BC
                mov     ecx, esi

loc_140284847:                          ; CODE XREF: sub_1402841E0+6E1↓j
                sub     ecx, edx
                mov     esi, r15d
                mov     [rsp+198h+var_10C], r15d
                test    dword ptr [r12+98h], 40000000h
                jnz     short loc_1402848CC
                xor     dil, dil

loc_140284865:                          ; CODE XREF: sub_1402841E0+6EF↓j
                test    r8b, r8b
                jnz     short loc_1402848D1
                mov     r8d, ecx
                test    dil, dil
                jnz     loc_1402848FB
                mov     rdx, [rsp+198h+arg_8]
                mov     rcx, r10
                call    memmove

loc_140284886:                          ; CODE XREF: sub_1402841E0+712↓j
                                        ; sub_1402841E0+719↓j ...
                test    esi, esi
                js      loc_14028492B
                test    dil, dil
                jnz     loc_140284933
                mov     al, 1

loc_140284899:                          ; CODE XREF: sub_1402841E0+755↓j
                mov     [rsp+198h+var_15B], al
                mov     [rsp+198h+var_166], 1
                cmp     [rsp+198h+var_167], 0
                jnz     loc_14028493A
                test    al, al
                jz      loc_14028493A
                mov     [rsp+198h+var_167], 1
                jmp     short loc_14028493A
; ---------------------------------------------------------------------------

loc_1402848BC:                          ; CODE XREF: sub_1402841E0+663↑j
                mov     ecx, 1000h
                jmp     short loc_140284847
; ---------------------------------------------------------------------------

loc_1402848C3:                          ; CODE XREF: sub_1402841E0+653↑j
                lea     r10, [rdx+rcx]
                jmp     loc_140284841
; ---------------------------------------------------------------------------

loc_1402848CC:                          ; CODE XREF: sub_1402841E0+680↑j
                mov     dil, 1
                jmp     short loc_140284865
; ---------------------------------------------------------------------------

loc_1402848D1:                          ; CODE XREF: sub_1402841E0+688↑j
                mov     r8d, ecx
                mov     rdx, [rsp+198h+arg_8]
                mov     rcx, r10
                test    dil, dil
                jz      short loc_1402848F4
                call    sub_1405948E0
                mov     esi, eax
                mov     [rsp+198h+var_10C], eax
                jmp     short loc_140284886
; ---------------------------------------------------------------------------

loc_1402848F4:                          ; CODE XREF: sub_1402841E0+702↑j
                call    sub_140594864
                jmp     short loc_140284886
; ---------------------------------------------------------------------------

loc_1402848FB:                          ; CODE XREF: sub_1402841E0+690↑j
                mov     dword ptr [rsp+198h+var_178], 2
                mov     r9, r8
                mov     r8, [rsp+198h+arg_8]
                mov     rdx, r10
                mov     rcx, 0FFFFFFFFFFFFFFFFh
                call    RtlWriteNonVolatileMemory
                mov     esi, eax
                mov     [rsp+198h+var_10C], eax
                jmp     loc_140284886
; ---------------------------------------------------------------------------

loc_14028492B:                          ; CODE XREF: sub_1402841E0+6A8↑j
                mov     ecx, esi
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140284933:                          ; CODE XREF: sub_1402841E0+6B1↑j
                xor     al, al
                jmp     loc_140284899
; ---------------------------------------------------------------------------

loc_14028493A:                          ; CODE XREF: sub_1402841E0+6C7↑j
                                        ; sub_1402841E0+6CF↑j ...
                jmp     short loc_14028496D
;     } // starts at 14028482C
; ---------------------------------------------------------------------------

loc_14028493C:                          ; DATA XREF: .rdata:000000014005EAF4↑o
;   __except(loc_140418A90) // owned by 14028482C
                mov     eax, [rsp+198h+var_148]
                cmp     eax, 0C0000005h
                jnz     short loc_140284951
                mov     ecx, 0C00000E8h
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------

loc_140284951:                          ; CODE XREF: sub_1402841E0+765↑j
                mov     ecx, [rsp+198h+var_148]
                call    FsRtlIsNtstatusExpected
                test    al, al
                mov     ecx, [rsp+198h+var_148]
                jnz     short loc_140284967
                mov     ecx, 0C00000E9h

loc_140284967:                          ; CODE XREF: sub_1402841E0+780↑j
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------
                db 90h
; ---------------------------------------------------------------------------

loc_14028496D:                          ; CODE XREF: sub_1402841E0:loc_14028493A↑j
                test    r14, r14
                jnz     loc_140284B2F

loc_140284976:                          ; CODE XREF: sub_1402841E0+967↓j
                mov     ecx, [rsp+198h+var_11C]
                movzx   eax, cl
                and     al, 3
                mov     rdx, [rsp+198h+var_F0]
                mov     [rdx+51Ch], al
                mov     eax, ecx
                shr     eax, 2
                mov     [rdx+508h], eax
                mov     edx, [rsp+198h+var_14C]
                jmp     loc_140284647
; ---------------------------------------------------------------------------

loc_1402849A1:                          ; CODE XREF: sub_1402841E0+5D3↑j
                mov     eax, 4
                jmp     loc_1402846A7
; ---------------------------------------------------------------------------

loc_1402849AB:                          ; CODE XREF: sub_1402841E0+5E5↑j
                test    r14b, 4
                jz      loc_1402847CB
                mov     rax, [rsp+198h+var_F0]
                mov     byte ptr [rax+51Ch], 1
                cmp     dword ptr [rax+508h], 1
                jnb     loc_1402847CB
                mov     dword ptr [rax+508h], 1
                jmp     loc_1402847CB
; ---------------------------------------------------------------------------

loc_1402849E0:                          ; CODE XREF: sub_1402841E0+580↑j
                mov     [rsp+198h+arg_20], r15d
                jmp     loc_140284766
; ---------------------------------------------------------------------------

loc_1402849ED:                          ; CODE XREF: sub_1402841E0+578↑j
                or      eax, 1
                mov     [rsp+198h+arg_20], eax
                jmp     loc_140284766
; ---------------------------------------------------------------------------

loc_1402849FC:                          ; CODE XREF: sub_1402841E0+611↑j
                cmp     [rsp+198h+arg_38], 0
                jnz     loc_1402847F7
                mov     [rsp+198h+var_158], 0
                mov     rbx, [rsp+198h+var_128]
                mov     r14, [rsp+198h+arg_40]
                mov     esi, [rsp+198h+var_154]
                jmp     loc_140284BBB
; ---------------------------------------------------------------------------

loc_140284A25:                          ; CODE XREF: sub_1402841E0+2C4↑j
                mov     r14d, r15d
                mov     [rsp+198h+arg_20], r15d
                jmp     loc_1402844B2
; ---------------------------------------------------------------------------

loc_140284A35:                          ; CODE XREF: sub_1402841E0+3C4↑j
                test    edi, edi
                mov     eax, r8d
                jnz     short loc_140284A3E
                mov     eax, esi

loc_140284A3E:                          ; CODE XREF: sub_1402841E0+85A↑j
                sub     eax, edx
                or      eax, edx
                test    al, 3Fh
                jnz     short loc_140284A68
                or      r13d, 4
                mov     [rsp+198h+var_160], r13d
                cmp     [rsp+198h+var_168], 0
                jz      loc_1402845AA
                or      r13d, 8
                mov     [rsp+198h+var_160], r13d
                jmp     loc_1402845AA
; ---------------------------------------------------------------------------

loc_140284A68:                          ; CODE XREF: sub_1402841E0+864↑j
                and     r13d, 0FFFFFFF3h
                mov     [rsp+198h+var_160], r13d
                mov     [rsp+198h+var_167], 1
                jmp     loc_1402845AA
; ---------------------------------------------------------------------------

loc_140284A7B:                          ; CODE XREF: sub_1402841E0+429↑j
                cmp     eax, 0C000009Ah
                jnz     loc_14028460F
                and     esi, 0FFFFFFF3h
                mov     [rsp+198h+var_B8], esi
                inc     r14d
                mov     [rsp+198h+var_B0], r14d
                mov     edx, [rsp+198h+var_14C]
                mov     r10, [rsp+198h+var_130]
                jmp     loc_1402845DC
; ---------------------------------------------------------------------------

loc_140284AA9:                          ; CODE XREF: sub_1402841E0+437↑j
                xor     al, al
                jmp     loc_14028461F
; ---------------------------------------------------------------------------

loc_140284AB0:                          ; CODE XREF: sub_1402841E0+449↑j
                mov     ecx, edi
                call    FsRtlIsNtstatusExpected
                mov     ecx, 0C00000E8h
                test    al, al
                cmovnz  ecx, edi
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------

loc_140284AC6:                          ; CODE XREF: sub_1402841E0+637↑j
                mov     ecx, eax
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------

loc_140284ACD:                          ; CODE XREF: sub_1402841E0+646↑j
                mov     r8d, esi
                test    edi, edi
                mov     eax, 1000h
                cmovnz  r8d, eax
                lea     rax, [rsp+198h+var_110]
                mov     [rsp+198h+var_178], rax
                mov     r9d, 1
                lea     rdx, [rsp+198h+var_A8]
                mov     rcx, [rsp+198h+var_130]
                call    sub_1404EA878
                mov     rcx, rax
                mov     [rsp+198h+var_78], rax
                test    rax, rax
                jnz     short loc_140284B1C
                mov     ecx, [rsp+198h+var_110]
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------

loc_140284B1C:                          ; CODE XREF: sub_1402841E0+92E↑j
                mov     r14, [rsp+198h+var_A8]
                movzx   r8d, [rsp+198h+var_164]
                jmp     loc_14028482C
; ---------------------------------------------------------------------------

loc_140284B2F:                          ; CODE XREF: sub_1402841E0+790↑j
                mov     rcx, r14
                call    MmUnlockPages
                mov     rcx, r14
                call    IoFreeMdl
                mov     [rsp+198h+var_A8], r15
                jmp     loc_140284976
; ---------------------------------------------------------------------------

loc_140284B4C:                          ; CODE XREF: sub_1402841E0+500↑j
                xor     r8d, r8d
                call    KeSetEvent
                jmp     loc_1402846E6
; ---------------------------------------------------------------------------

loc_140284B59:                          ; CODE XREF: sub_1402841E0+55F↑j
                cmp     [rsp+198h+var_167], bl
                jz      loc_140284745

loc_140284B63:                          ; CODE XREF: sub_1402841E0+557↑j
                lea     rax, [rsp+198h+var_108]
                mov     [rsp+198h+var_170], rax
                movzx   eax, [rsp+198h+var_168]
                mov     byte ptr [rsp+198h+var_178], al
                xor     r9d, r9d
                mov     r8d, esi
                lea     rdx, [rsp+198h+var_140]
                mov     rcx, [rsp+198h+arg_28]
                mov     rcx, [rcx+28h]
                call    sub_140260E80
                mov     edi, dword ptr [rsp+198h+var_108]
                test    edi, edi
                jns     loc_140284745
                mov     ecx, edi
                call    FsRtlIsNtstatusExpected
                mov     ecx, 0C00000E9h
                test    al, al
                cmovnz  ecx, edi
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------
                db 90h
;   } // starts at 14028448C
; ---------------------------------------------------------------------------

loc_140284BBB:                          ; CODE XREF: sub_1402841E0+5A3↑j
                                        ; sub_1402841E0+840↑j
                                        ; DATA XREF: ...
                mov     ecx, [rsp+198h+var_11C]
                movzx   eax, cl
                and     al, 3
                mov     rdx, [rsp+198h+var_F0]
                mov     [rdx+51Ch], al
                shr     ecx, 2
                mov     [rdx+508h], ecx
                mov     r13, 0FFFFFFFFFFFFFFFFh
                test    rbx, rbx
                jnz     loc_140284FE6

loc_140284BEB:                          ; CODE XREF: sub_1402841E0+E1D↓j
                cmp     [rsp+198h+var_166], 0
                jnz     loc_140444287

loc_140284BF6:                          ; CODE XREF: sub_1402841E0+1C00A9↓j
                                        ; sub_1402841E0+1C00C3↓j
                mov     ecx, cs:dword_140C0F3D0
                mov     r10, [rsp+198h+arg_28]
                movzx   edx, [rsp+198h+var_168]
                cmp     ecx, 0FFFFFFFFh
                jz      short loc_140284C1C
                test    dword ptr [r10+50h], 1000000h
                jnz     loc_140284F68

loc_140284C1C:                          ; CODE XREF: sub_1402841E0+A2C↑j
                                        ; sub_1402841E0+D8A↓j ...
                cmp     [rsp+198h+var_15A], 0
                jnz     short loc_140284C7D
                cmp     [rsp+198h+var_163], 0
                jnz     short loc_140284C7D

loc_140284C2A:                          ; CODE XREF: sub_1402841E0+B53↓j
                movzx   eax, [rsp+198h+var_158]

loc_140284C2F:                          ; CODE XREF: sub_1402841E0+1BFF28↓j
                add     rsp, 160h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140284C43:                          ; CODE XREF: sub_1402841E0+273↑j
                mov     rax, gs:188h
                cmp     r14, rax
                jnz     loc_140284ED8

loc_140284C55:                          ; CODE XREF: sub_1402841E0+D49↓j
                mov     r13d, [rsp+198h+var_160]
                test    rdi, rdi
                jz      loc_140284459
                mov     rbx, [rdi+220h]
                jmp     loc_140284460
; ---------------------------------------------------------------------------

loc_140284C6F:                          ; CODE XREF: sub_1402841E0+1D2↑j
                test    r10b, r10b
                jnz     loc_1402843B8
                jmp     loc_140444106
; ---------------------------------------------------------------------------

loc_140284C7D:                          ; CODE XREF: sub_1402841E0+A41↑j
                                        ; sub_1402841E0+A48↑j
                mov     dword ptr [rsp+198h+var_108], r15d
                test    dl, dl
                jz      short loc_140284C97
                test    dword ptr [r12+98h], 40000000h
                jnz     short loc_140284CD9

loc_140284C97:                          ; CODE XREF: sub_1402841E0+AA7↑j
                mov     r8d, r15d
                cmp     [rsp+198h+var_165], r8b
                cmovz   r8d, [rsp+198h+var_118]
                cmovz   r15, [rsp+198h+arg_10]
                lea     rax, [rsp+198h+var_108]
                mov     [rsp+198h+var_170], rax
                mov     byte ptr [rsp+198h+var_178], dl
                xor     r9d, r9d
                mov     rdx, r15
                mov     rcx, [r10+28h]
                call    sub_140260E80
                mov     r15d, dword ptr [rsp+198h+var_108]

loc_140284CD9:                          ; CODE XREF: sub_1402841E0+AB5↑j
                cmp     [rsp+198h+var_159], 0
                jz      short loc_140284D30
                mov     rcx, [rsp+198h+var_70]
                sub     rcx, 0FFFFFFFFFFFFFF80h
                lea     rdx, [rsp+198h+var_E8]
                call    KeAcquireInStackQueuedSpinLock
                dec     dword ptr [r12+204h]
                lea     rcx, [rsp+198h+var_E8]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                movzx   ebx, byte ptr [rsp+198h+var_D8]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404442B7

loc_140284D24:                          ; CODE XREF: sub_1402841E0+1C00D9↓j
                                        ; sub_1402841E0+1C00E5↓j ...
                mov     cr8, rbx
                mov     r15d, dword ptr [rsp+198h+var_108]

loc_140284D30:                          ; CODE XREF: sub_1402841E0+AFE↑j
                test    r15d, r15d
                jns     loc_140284C2A
                jmp     loc_14044431D
; ---------------------------------------------------------------------------

loc_140284D3E:                          ; CODE XREF: sub_1402841E0+1A2↑j
                mov     rcx, gs:188h
                cmp     rdx, rcx
                jnz     loc_140284388
                cmp     [rdx+550h], edi
                jz      loc_140284388
                jmp     loc_140284390
; ---------------------------------------------------------------------------

loc_140284D61:                          ; CODE XREF: sub_1402841E0+68↑j
                mov     bl, 1
                jmp     loc_140284250
; ---------------------------------------------------------------------------

loc_140284D68:                          ; CODE XREF: sub_1402841E0+22F↑j
                lea     rcx, [rsi+80h]
                lea     rdx, [rsp+198h+var_E8]
                call    KeAcquireInStackQueuedSpinLock
                mov     eax, [r12+98h]
                test    al, 20h
                jnz     loc_140284F80

loc_140284D8C:                          ; CODE XREF: sub_1402841E0+E65↓j
                inc     dword ptr [r12+204h]
                mov     [rsp+198h+var_159], 1
                lea     rcx, [rsp+198h+var_E8]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                movzx   ebx, byte ptr [rsp+198h+var_D8]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14044412B

loc_140284DBC:                          ; CODE XREF: sub_1402841E0+1BFF4D↓j
                                        ; sub_1402841E0+1BFF59↓j ...
                mov     cr8, rbx
                jmp     loc_140284415
; ---------------------------------------------------------------------------

loc_140284DC5:                          ; CODE XREF: sub_1402841E0+1AA↑j
                test    dword ptr [r14+50h], 8000h
                jnz     loc_140284390
                mov     r13d, [rsp+198h+var_160]

loc_140284DD8:                          ; CODE XREF: sub_1402841E0+D83↓j
                mov     sil, 1
                mov     [rsp+198h+var_15A], sil
                test    dword ptr [r12+98h], 400h
                jnz     loc_140284395
                lea     rcx, [rbx+80h]
                lea     rdx, [rsp+198h+var_60]
                call    KeAcquireInStackQueuedSpinLock
                or      dword ptr [r12+98h], 400h
                lea     rcx, [rsp+198h+var_60]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                movzx   ebx, byte ptr [rsp+198h+var_50]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140444098

loc_140284E35:                          ; CODE XREF: sub_1402841E0+1BFEBB↓j
                                        ; sub_1402841E0+1BFEC7↓j ...
                mov     cr8, rbx
                jmp     loc_140284395
; ---------------------------------------------------------------------------

loc_140284E3E:                          ; CODE XREF: sub_1402841E0+287↑j
                lea     rcx, unk_140C458EC
                call    ExAcquireSpinLockShared
                movzx   esi, al
                mov     rbx, [rbx+958h]
                test    rbx, rbx
                jz      short loc_140284E7E
                mov     edx, 1
                lock xadd [rbx+20h], rdx
                inc     rdx
                cmp     rdx, 1
                jle     loc_1404441FA

loc_140284E71:                          ; CODE XREF: sub_1402841E0+1C0021↓j
                mov     [rsp+198h+var_A0], rbx
                mov     r13d, [rsp+198h+var_160]

loc_140284E7E:                          ; CODE XREF: sub_1402841E0+C77↑j
                lea     rcx, unk_140C458EC
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140444206

loc_140284E98:                          ; CODE XREF: sub_1402841E0+1C0028↓j
                                        ; sub_1402841E0+1C0034↓j ...
                mov     cr8, rsi
                test    rbx, rbx
                jz      loc_14044426D
                mov     ebx, r15d
                jmp     loc_140284472
; ---------------------------------------------------------------------------

loc_140284EAD:                          ; CODE XREF: sub_1402841E0+2A6↑j
                mov     rdx, [rsp+198h+var_A0]
                mov     rcx, [rsp+198h+arg_28]
                mov     rcx, [rcx+28h]
                call    sub_140319508
                mov     rcx, [rsp+198h+var_A0]
                call    sub_140319B24
                jmp     loc_14028448C
; ---------------------------------------------------------------------------

loc_140284ED8:                          ; CODE XREF: sub_1402841E0+A6F↑j
                lea     rcx, dword_140C1DF40
                call    ExAcquireSpinLockShared
                movzx   ebx, al
                mov     rdi, [r14+5C0h]
                test    rdi, rdi
                jz      short loc_140284F0B
                mov     edx, 746C6644h
                mov     rcx, rdi
                call    ObfReferenceObjectWithTag
                mov     [rsp+198h+var_114], 1

loc_140284F0B:                          ; CODE XREF: sub_1402841E0+D11↑j
                lea     rcx, dword_140C1DF40
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140444194

loc_140284F25:                          ; CODE XREF: sub_1402841E0+1BFFB6↓j
                                        ; sub_1402841E0+1BFFC2↓j ...
                mov     cr8, rbx
                jmp     loc_140284C55
; ---------------------------------------------------------------------------

loc_140284F2E:                          ; CODE XREF: sub_1402841E0+29A↑j
                mov     rcx, rdi
                call    ObDereferenceObjectDeferDelete
                jmp     loc_140284480
; ---------------------------------------------------------------------------

loc_140284F3B:                          ; CODE XREF: sub_1402841E0+188↑j
                mov     [rsp+198h+var_170], r15
                mov     dword ptr [rsp+198h+var_178], r15d
                xor     r9d, r9d
                mov     r8d, [rsp+198h+arg_18]
                mov     rdx, r14
                mov     rcx, rbx
                call    sub_140265630
                test    al, al
                jnz     loc_14028436E
                jmp     loc_140284DD8
; ---------------------------------------------------------------------------

loc_140284F68:                          ; CODE XREF: sub_1402841E0+A36↑j
                test    dl, dl
                jnz     loc_140284C1C
                cmp     [r12+70h], ecx
                jb      loc_140284C1C
                jmp     loc_1404442A8
; ---------------------------------------------------------------------------

loc_140284F80:                          ; CODE XREF: sub_1402841E0+BA6↑j
                lea     rdx, [rsi+0C0h]
                mov     qword ptr [rsp+198h+var_98+8], rdx
                mov     qword ptr [rsp+198h+var_98], r15
                lea     rcx, [rsp+198h+var_98]
                call    sub_14024B3F0
                mov     rdi, [r12+1F0h]
                test    rdi, rdi
                jnz     short loc_140285002
                lea     rcx, [rsp+198h+var_98]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                lea     rcx, [rsp+198h+var_E8]
                call    KeReleaseInStackQueuedSpinLock
                lea     r8, unk_140C11088
                xor     edx, edx
                xor     ecx, ecx
                call    KeDelayExecutionThread
                mov     ecx, 0C00000D8h
                call    RtlRaiseStatus
; ---------------------------------------------------------------------------
                align 2

loc_140284FE6:                          ; CODE XREF: sub_1402841E0+A05↑j
                mov     rdi, [rbx+8]
                mov     eax, r13d
                lock xadd [rbx+10h], eax
                dec     eax
                test    ax, ax
                jz      short loc_140285057

loc_140284FF9:                          ; CODE XREF: sub_1402841E0+E8E↓j
                mov     esi, [rsp+198h+var_154]
                jmp     loc_140284BEB
; ---------------------------------------------------------------------------

loc_140285002:                          ; CODE XREF: sub_1402841E0+DCF↑j
                mov     rcx, [rdi]
                mov     rax, [rdi+8]
                cmp     [rcx+8], rdi
                jnz     short loc_140285070
                cmp     [rax], rdi
                jnz     short loc_140285070
                mov     [rax], rcx
                mov     [rcx+8], rax
                mov     [rdi+8], r15
                mov     [rdi], r15
                mov     [r12+1F0h], r15
                and     dword ptr [r12+98h], 0FFFFFFDFh
                mov     [rsp+198h+var_165], 1
                lea     rcx, [rsp+198h+var_98]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                jmp     loc_140284D8C
; ---------------------------------------------------------------------------

loc_14028504A:                          ; CODE XREF: sub_1402841E0+238↑j
                mov     rcx, rdi
                call    sub_1402F9F3C
                jmp     loc_14028441E
; ---------------------------------------------------------------------------

loc_140285057:                          ; CODE XREF: sub_1402841E0+E17↑j
                mov     rcx, [rdi+0B8h]
                test    rcx, rcx
                jnz     loc_140444277

loc_140285067:                          ; CODE XREF: sub_1402841E0+1C00A2↓j
                lock dec dword ptr [rdi+220h]
                jmp     short loc_140284FF9
; ---------------------------------------------------------------------------

loc_140285070:                          ; CODE XREF: sub_1402841E0+E2D↑j
                                        ; sub_1402841E0+E32↑j
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
; } // starts at 1402841E0
sub_1402841E0   endp

; ---------------------------------------------------------------------------
algn_140285077:                         ; DATA XREF: .rdata:000000014005EB18↑o
                                        ; .pdata:00000001400CEAF0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140285080   proc near               ; CODE XREF: sub_1402841E0+171↑p
                                        ; sub_1402841E0+216↑p ...

arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140444336 SIZE 0000018B BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                push    rsi
                push    rdi
                push    r14
                sub     rsp, 20h
                mov     rdi, rcx
                mov     rsi, cr8
                mov     eax, 2
                mov     cr8, rax
                lea     rbp, [rax-3]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140444336

loc_1402850B4:                          ; CODE XREF: sub_140285080+1BF2B8↓j
                                        ; sub_140285080+1BF2C2↓j ...
                xor     r14d, r14d
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140444377
                mov     rbx, gs:20h
                mov     [rsp+38h+arg_0], r14d
                mov     rcx, [rbx+84B8h]
                test    rcx, rcx
                jnz     loc_14044438D

loc_1402850E2:                          ; CODE XREF: sub_140285080+1BF311↓j
                                        ; sub_140285080+1BF320↓j ...
                lock bts cs:dword_140C4C800, 1Fh
                jb      loc_140285188

loc_1402850F1:                          ; CODE XREF: sub_140285080+12C↓j
                mov     edx, cs:dword_140C4C800
                mov     ecx, edx
                btr     ecx, 1Eh
                cmp     ecx, 80000000h
                jnz     loc_1404443DB

loc_140285109:                          ; CODE XREF: sub_140285080+1BF308↓j
                                        ; sub_140285080+1BF392↓j
                mov     rax, [rdi]
                test    rax, rax
                jz      loc_140444417
                movzx   edx, word ptr [rax+3Ch]
                mov     rax, cs:qword_140C4E4C8
                and     edx, 3FFh
                mov     rbx, [rax+rdx*8]

loc_14028512A:                          ; CODE XREF: sub_140285080+1BF39E↓j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_140444423
                mov     cs:dword_140C4C800, r14d

loc_14028513E:                          ; CODE XREF: sub_140285080+1BF3B5↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14044443A

loc_140285157:                          ; CODE XREF: sub_140285080+1BF3BE↓j
                                        ; sub_140285080+1BF3CD↓j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14044445E

loc_140285165:                          ; CODE XREF: sub_140285080+1BF3E0↓j
                                        ; sub_140285080+1BF3EC↓j ...
                movzx   ecx, sil
                mov     cr8, rcx
                mov     rax, [rbx+0B0h]
                mov     rbx, [rsp+38h+arg_8]
                mov     rbp, [rsp+38h+arg_10]
                add     rsp, 20h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                align 8

loc_140285188:                          ; CODE XREF: sub_140285080+6B↑j
                mov     rcx, [rbx+84B8h]
                test    rcx, rcx
                jnz     loc_1404443B4

loc_140285198:                          ; CODE XREF: sub_140285080+1BF338↓j
                                        ; sub_140285080+1BF347↓j ...
                movzx   edx, sil
                lea     rcx, dword_140C4C800
                call    sub_14028EAE0
                mov     [rsp+38h+arg_0], eax
                jmp     loc_1402850F1
sub_140285080   endp

; ---------------------------------------------------------------------------
algn_1402851B1:                         ; DATA XREF: .rdata:000000014005EB60↑o
                                        ; .pdata:00000001400CEAFC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402851C0   proc near               ; CODE XREF: sub_140231440+81E↑p
                                        ; sub_14026BC98+81↑p ...
                test    dword ptr [rcx+38h], 40000000h
                jnz     short loc_1402851CD
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402851CD:                          ; CODE XREF: sub_1402851C0+7↑j
                mov     eax, 1
                retn
sub_1402851C0   endp

; ---------------------------------------------------------------------------
                align 4
algn_1402851D4:                         ; DATA XREF: .pdata:00000001400CEB08↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=200h

sub_1402851E0   proc near               ; CODE XREF: sub_14063CB90+77A↓p
                                        ; sub_14063E5A0+30F↓p ...

var_2E0         = qword ptr -2E0h
var_2D8         = qword ptr -2D8h
var_2D0         = qword ptr -2D0h
var_2C8         = qword ptr -2C8h
var_2C0         = qword ptr -2C0h
var_2B8         = qword ptr -2B8h
var_2B0         = qword ptr -2B0h
var_2A8         = dword ptr -2A8h
var_2A0         = qword ptr -2A0h
var_298         = qword ptr -298h
var_290         = qword ptr -290h
var_288         = dword ptr -288h
var_280         = qword ptr -280h
var_278         = qword ptr -278h
var_270         = dword ptr -270h
var_26C         = dword ptr -26Ch
var_268         = qword ptr -268h
var_260         = qword ptr -260h
var_258         = dword ptr -258h
var_254         = word ptr -254h
var_250         = qword ptr -250h
var_248         = qword ptr -248h
var_240         = dword ptr -240h
var_238         = qword ptr -238h
var_230         = qword ptr -230h
var_228         = dword ptr -228h
var_224         = dword ptr -224h
var_220         = dword ptr -220h
var_21C         = dword ptr -21Ch
var_218         = dword ptr -218h
var_210         = qword ptr -210h
var_208         = qword ptr -208h
var_200         = qword ptr -200h
var_1F8         = qword ptr -1F8h
var_1F0         = qword ptr -1F0h
var_1E8         = qword ptr -1E8h
var_1E0         = qword ptr -1E0h
var_1D8         = qword ptr -1D8h
var_1D0         = dword ptr -1D0h
var_1CC         = word ptr -1CCh
var_1CA         = word ptr -1CAh
var_1C8         = qword ptr -1C8h
var_1C0         = qword ptr -1C0h
var_1B8         = qword ptr -1B8h
var_1B0         = xmmword ptr -1B0h
var_1A0         = xmmword ptr -1A0h
var_190         = xmmword ptr -190h
var_180         = xmmword ptr -180h
var_170         = xmmword ptr -170h
var_160         = xmmword ptr -160h
var_150         = xmmword ptr -150h
var_140         = xmmword ptr -140h
var_130         = xmmword ptr -130h
var_120         = qword ptr -120h
var_110         = dword ptr -110h
var_10C         = word ptr -10Ch
var_10A         = word ptr -10Ah
var_108         = qword ptr -108h
var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = xmmword ptr -0F0h
var_E0          = xmmword ptr -0E0h
var_D0          = xmmword ptr -0D0h
var_C0          = xmmword ptr -0C0h
var_B0          = xmmword ptr -0B0h
var_A0          = xmmword ptr -0A0h
var_90          = xmmword ptr -90h
var_80          = xmmword ptr -80h
var_70          = xmmword ptr -70h
var_60          = qword ptr -60h
var_50          = qword ptr -50h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
arg_20          = dword ptr  30h
arg_28          = dword ptr  38h
arg_30          = qword ptr  40h
arg_38          = qword ptr  48h

; __unwind { // __GSHandlerCheck
                push    rbp
                push    rsi
                push    r12
                push    r14
                push    r15
                lea     rbp, [rsp-1E0h]
                sub     rsp, 2E0h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+200h+var_50], rax
                mov     rax, [rbp+200h+arg_38]
                xorps   xmm0, xmm0
                mov     r12, [rbp+200h+arg_30]
                mov     rsi, r9
                xor     r9d, r9d
                mov     [rbp+200h+var_1D8], rax
                xor     eax, eax
                mov     [rsp+300h+var_298], rdx
                mov     [rbp+200h+var_1CA], ax
                mov     r15, r8
                mov     [rbp+200h+var_120], rax
                mov     r14, rdx
                mov     [rbp+200h+var_10A], ax
                mov     r8, rcx
                mov     [rbp+200h+var_60], rax
                mov     eax, [rdx+30h]
                and     al, 70h
                mov     [rsp+300h+var_2B0], rcx
                mov     [rbp+200h+var_228], r9d
                mov     [rbp+200h+var_1E8], r9
                mov     [rbp+200h+var_200], r9
                mov     [rsp+300h+var_2A8], r9d
                mov     [rbp+200h+var_224], r9d
                mov     [rbp+200h+var_278], r9
                mov     [rbp+200h+var_254], r9w
                movups  [rbp+200h+var_1B0], xmm0
                movups  [rbp+200h+var_1A0], xmm0
                movups  [rbp+200h+var_190], xmm0
                movups  [rbp+200h+var_180], xmm0
                movups  [rbp+200h+var_170], xmm0
                movups  [rbp+200h+var_160], xmm0
                movups  [rbp+200h+var_150], xmm0
                movups  [rbp+200h+var_140], xmm0
                movups  [rbp+200h+var_130], xmm0
                movups  [rbp+200h+var_F0], xmm0
                movups  [rbp+200h+var_E0], xmm0
                movups  [rbp+200h+var_D0], xmm0
                movups  [rbp+200h+var_C0], xmm0
                movups  [rbp+200h+var_B0], xmm0
                movups  [rbp+200h+var_A0], xmm0
                movups  [rbp+200h+var_90], xmm0
                movups  [rbp+200h+var_80], xmm0
                movups  [rbp+200h+var_70], xmm0
                cmp     al, 20h ; ' '
                jnz     short loc_14028530C
                mov     rcx, rdx
                call    sub_14065E1F8
                test    eax, eax
                jz      short loc_140285307
                mov     rcx, r14
                call    sub_1408CB8A8
                cmp     rax, rsi
                jbe     short loc_140285321

loc_140285307:                          ; CODE XREF: sub_1402851E0+118↑j
                mov     r8, [rsp+300h+var_2B0]

loc_14028530C:                          ; CODE XREF: sub_1402851E0+10C↑j
                mov     ecx, [rbp+200h+arg_20]
                call    sub_1402320B0
                mov     [rbp+200h+var_258], eax
                mov     ecx, eax
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_14028532B

loc_140285321:                          ; CODE XREF: sub_1402851E0+125↑j
                mov     eax, 0C0000045h
                jmp     loc_1402867A8
; } // starts at 1402851E0
; ---------------------------------------------------------------------------

loc_14028532B:                          ; CODE XREF: sub_1402851E0+13F↑j
                                        ; DATA XREF: .rdata:000000014005EB98↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+300h+var_28], rbx
                mov     edx, ecx
                and     edx, 0FFFFFFFEh
                mov     [rsp+300h+var_30], rdi
                and     eax, 5
                mov     [rsp+300h+var_38], r13
                cmp     eax, 5
                mov     [rbp+200h+var_238], r9
                mov     rbx, r15
                mov     [rbp+200h+var_208], r9
                cmovnz  edx, ecx
                mov     [rbp+200h+var_108], 14h
                shr     rbx, 9
                mov     r10, 7FFFFFFFF8h
                mov     [rbp+200h+var_26C], edx
                and     rbx, r10
                mov     rdx, 0FFFFF68000000000h
                mov     rdi, r9
                mov     [rbp+200h+var_110], 1
                mov     [rbp+200h+var_10C], r9w
                mov     [rbp+200h+var_100], r9
                mov     [rbp+200h+var_F8], r9
                mov     [rsp+300h+var_288], eax
                mov     rax, rdx
                mov     rcx, rsi
                add     rbx, rax
                shr     rcx, 9
                and     rcx, r10
                mov     [rsp+300h+var_2A0], rbx
                mov     rax, rdx
                lea     rdx, [rcx+rax]
                mov     [rbp+200h+var_240], r9d
                mov     rax, gs:188h
                lea     r13, [r8+680h]
                mov     [rbp+200h+var_210], rax
                mov     rax, [r8+690h]
                mov     [rbp+200h+var_1C8], 14h
                mov     [rbp+200h+var_1D0], 1
                mov     [rbp+200h+var_1CC], 4
                mov     [rbp+200h+var_1C0], r9
                mov     [rbp+200h+var_1B8], r9
                mov     [rbp+200h+var_248], rdx
                mov     [rbp+200h+var_268], r9
                mov     [rbp+200h+var_260], r13
                cmp     [rax+168h], r9
                jz      short loc_14028548A
                mov     eax, [r14+34h]
                movzx   ecx, byte ptr [r14+22h]
                btr     eax, 1Fh
                shl     rcx, 1Fh
                or      rcx, rax
                jz      short loc_14028548A
                mov     rcx, r13
                call    sub_140231340
                movzx   ebx, al
                xor     ecx, ecx
                lea     rax, [rbp+200h+var_268]
                movzx   r9d, bl
                mov     [rsp+300h+var_2D8], rax
                mov     r8, r14
                mov     dword ptr [rsp+300h+var_2E0], ecx
                mov     rdx, rsi
                mov     rcx, r15
                call    sub_1402A5AD0
                movzx   edx, bl
                mov     rcx, r13
                call    sub_140226960
                mov     rdx, [rbp+200h+var_268]
                test    rdx, rdx
                jz      short loc_140285481
                mov     rcx, [rsp+300h+var_2B0]
                call    sub_14063D610
                test    eax, eax
                js      loc_140286790

loc_140285481:                          ; CODE XREF: sub_1402851E0+28D↑j
                mov     rdx, [rbp+200h+var_248]
                mov     rbx, [rsp+300h+var_2A0]

loc_14028548A:                          ; CODE XREF: sub_1402851E0+237↑j
                                        ; sub_1402851E0+24D↑j
                cmp     [rsp+300h+var_288], 5
                movzx   ecx, word ptr [r13+0AEh]
                mov     rax, cs:qword_140C4E4C8
                mov     rax, [rax+rcx*8]
                mov     [rbp+200h+var_230], rax
                jnz     short loc_140285512
                mov     r8, rdx
                mov     rcx, r14
                mov     rdx, rbx
                call    sub_14031B800
                cmp     [rbp+200h+arg_28], 1
                mov     rdi, rax
                jnz     loc_1402855C0
                mov     rax, [rbp+200h+var_248]
                sub     rax, rbx
                sar     rax, 3
                sub     rax, rdi
                add     rax, 1
                mov     [rbp+200h+var_238], rax
                jz      short loc_14028550E
                mov     rcx, [rbp+200h+var_230]
                xor     r8d, r8d
                mov     rdx, rax
                call    sub_140232160
                test    eax, eax
                jnz     short loc_14028550E
                mov     rdx, [rbp+200h+var_268]
                test    rdx, rdx
                jz      short loc_140285504
                mov     rcx, [rsp+300h+var_2B0]
                call    sub_14065C6A8

loc_140285504:                          ; CODE XREF: sub_1402851E0+318↑j
                mov     eax, 0C000012Dh
                jmp     loc_140286790
; ---------------------------------------------------------------------------

loc_14028550E:                          ; CODE XREF: sub_1402851E0+2FC↑j
                                        ; sub_1402851E0+30F↑j
                xor     eax, eax
                mov     edi, eax

loc_140285512:                          ; CODE XREF: sub_1402851E0+2C6↑j
                                        ; sub_1402851E0+3E3↓j ...
                mov     rcx, r14
                call    sub_140233020
                cmp     eax, 1
                jnz     loc_140285616
                mov     [rbp+200h+var_240], eax
                mov     rax, [rbp+200h+var_210]
                dec     word ptr [rax+1E6h]
                mov     rbx, [rsp+300h+var_2B0]
                xor     edx, edx
                add     rbx, 4D0h
                mov     rcx, rbx
                call    ExAcquirePushLockExclusiveEx
                mov     r8, rsi
                mov     rdx, r15
                mov     rcx, r14
                call    sub_14063D6E0
                mov     r14d, eax
                test    eax, eax
                jns     loc_140285611
                mov     rsi, 0FFFFFFFFFFFFFFFFh
                lock xadd [rbx], rsi
                and     sil, 6
                cmp     sil, 2
                jnz     short loc_14028557E
                mov     rcx, rbx
                call    ExfTryToWakePushLock

loc_14028557E:                          ; CODE XREF: sub_1402851E0+394↑j
                mov     rcx, rbx
                call    sub_140243660
                mov     rcx, [rbp+200h+var_210]
                call    sub_140245770
                cmp     [rbp+200h+var_238], 0
                jz      short loc_1402855FA
                mov     rcx, [rbp+200h+var_230]
                mov     rdx, rdi
                call    sub_14026B700

loc_1402855A2:                          ; CODE XREF: sub_1402851E0+41D↓j
                mov     rbx, [rsp+300h+var_2B0]

loc_1402855A7:                          ; CODE XREF: sub_1402851E0+42F↓j
                mov     rdx, [rbp+200h+var_268]
                test    rdx, rdx
                jz      short loc_1402855B8
                mov     rcx, rbx
                call    sub_14065C6A8

loc_1402855B8:                          ; CODE XREF: sub_1402851E0+3CE↑j
                mov     eax, r14d
                jmp     loc_140286790
; ---------------------------------------------------------------------------

loc_1402855C0:                          ; CODE XREF: sub_1402851E0+2E0↑j
                test    rdi, rdi
                jz      loc_140285512
                mov     rcx, [rsp+300h+var_2B0]
                mov     rdx, rdi
                call    sub_14063D610
                mov     ebx, eax
                test    eax, eax
                jns     loc_140285512
                mov     rdx, [rbp+200h+var_268]
                test    rdx, rdx
                jz      short loc_1402855F3
                mov     rcx, [rsp+300h+var_2B0]
                call    sub_14065C6A8

loc_1402855F3:                          ; CODE XREF: sub_1402851E0+407↑j
                mov     eax, ebx
                jmp     loc_140286790
; ---------------------------------------------------------------------------

loc_1402855FA:                          ; CODE XREF: sub_1402851E0+3B4↑j
                test    rdi, rdi
                jz      short loc_1402855A2
                mov     rbx, [rsp+300h+var_2B0]
                mov     rdx, rdi
                mov     rcx, rbx
                call    sub_14065C6A8
                jmp     short loc_1402855A7
; ---------------------------------------------------------------------------

loc_140285611:                          ; CODE XREF: sub_1402851E0+37A↑j
                mov     r14, [rsp+300h+var_298]

loc_140285616:                          ; CODE XREF: sub_1402851E0+33D↑j
                test    rdi, rdi
                jz      short loc_14028564D
                mov     r8d, [r14+34h]
                mov     edx, r8d
                movzx   eax, byte ptr [r14+22h]
                btr     edx, 1Fh
                shl     rax, 1Fh
                or      rdx, rax
                add     rdx, rdi
                mov     eax, edx
                xor     eax, r8d
                btr     eax, 1Fh
                xor     eax, r8d
                shr     rdx, 1Fh
                mov     [r14+34h], eax
                mov     [r14+22h], dl

loc_14028564D:                          ; CODE XREF: sub_1402851E0+439↑j
                movzx   eax, byte ptr [r13+0B8h]
                xor     edi, edi
                and     al, 7
                mov     [rbp+200h+var_270], 1
                mov     [rbp+200h+var_250], rdi
                mov     ebx, edi
                mov     [rsp+300h+var_290], rbx
                lea     rsi, [rdi-1]
                cmp     al, 6
                jb      short loc_1402856D9
                mov     rdi, cr8
                mov     [rbp+200h+var_280], rdi
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      loc_1402857D8
                test    al, 1
                jz      loc_1402857D8
                cmp     dil, 0Fh
                ja      loc_1402857D8
                mov     rax, gs:20h
                mov     edx, 1
                movzx   ecx, dil
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                dec     edx
                not     edx
                and     edx, 4
                mov     r8d, [r9+14h]
                or      edx, r8d
                mov     [r9+14h], edx
                jmp     loc_1402857D8
; ---------------------------------------------------------------------------

loc_1402856D9:                          ; CODE XREF: sub_1402851E0+491↑j
                lea     rbx, unk_140C4F600
                cmp     al, 2
                jz      short loc_1402856EB
                lea     rbx, [r13+0C0h]

loc_1402856EB:                          ; CODE XREF: sub_1402851E0+502↑j
                mov     r14, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140285736
                test    al, 1
                jz      short loc_140285736
                cmp     r14b, 0Fh
                ja      short loc_140285736
                mov     rax, gs:20h
                mov     rdx, rsi
                movzx   ecx, r14b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_140285736:                          ; CODE XREF: sub_1402851E0+520↑j
                                        ; sub_1402851E0+524↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_14028574D
                movzx   edx, r14b
                mov     rcx, rbx
                call    sub_1405B5F24
                jmp     short loc_1402857C0
; ---------------------------------------------------------------------------

loc_14028574D:                          ; CODE XREF: sub_1402851E0+55D↑j
                mov     rdi, gs:20h
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jz      short loc_14028577B
                cmp     byte ptr [rdi+20h], 1
                ja      short loc_14028577B
                mov     eax, [rcx+18h]
                add     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_14028577B
                mov     rcx, rdi
                call    sub_1403F2EC4

loc_14028577B:                          ; CODE XREF: sub_1402851E0+580↑j
                                        ; sub_1402851E0+586↑j ...
                prefetchw byte ptr [rbx]
                mov     eax, [rbx]
                btr     eax, 1Fh
                lea     ecx, [rax+1]
                lock cmpxchg [rbx], ecx
                jz      short loc_1402857BE
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jz      short loc_1402857B2
                cmp     byte ptr [rdi+20h], 1
                ja      short loc_1402857B2
                mov     eax, [rcx+18h]
                sub     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_1402857B2
                mov     rcx, rdi
                call    sub_1403F2EC4

loc_1402857B2:                          ; CODE XREF: sub_1402851E0+5B7↑j
                                        ; sub_1402851E0+5BD↑j ...
                movzx   edx, r14b
                mov     rcx, rbx
                call    sub_140329420

loc_1402857BE:                          ; CODE XREF: sub_1402851E0+5AB↑j
                xor     edi, edi

loc_1402857C0:                          ; CODE XREF: sub_1402851E0+56B↑j
                cmp     dword ptr [rbx+4], 0
                jz      short loc_1402857CB
                mov     eax, edi
                xchg    eax, [rbx+4]

loc_1402857CB:                          ; CODE XREF: sub_1402851E0+5E4↑j
                mov     rbx, [rsp+300h+var_290]
                movzx   edi, r14b
                mov     [rbp+200h+var_280], rdi

loc_1402857D8:                          ; CODE XREF: sub_1402851E0+4AC↑j
                                        ; sub_1402851E0+4B4↑j ...
                mov     r9, [rsp+300h+var_298]
                lea     rax, [rbp+200h+var_228]
                mov     [rsp+300h+var_2B8], rax
                movzx   r8d, dil
                lea     rax, [rbp+200h+var_1E8]
                mov     rdx, r15
                mov     [rsp+300h+var_2C0], rax
                mov     rcx, r15
                lea     rax, [rbp+200h+var_254]
                mov     [rsp+300h+var_2C8], rax
                lea     rax, [rbp+200h+var_224]
                mov     [rsp+300h+var_2D0], rax
                lea     rax, [rsp+300h+var_2A8]
                mov     [rsp+300h+var_2D8], rax
                xor     eax, eax
                mov     [rsp+300h+var_2E0], rax
                call    sub_140281E60
                mov     eax, [rsp+300h+var_2A8]
                lea     rcx, cs:140000000h
                mov     r15, [rsp+300h+var_298]
                mov     eax, ds:rva dword_140011250[rcx+rax*4]
                mov     [r12], eax
                mov     r14d, [r15+30h]
                mov     r12, [rsp+300h+var_2A0]
                shr     r14d, 0Ch
                and     r14d, 3Fh
                mov     [rbp+200h+var_21C], r14d

loc_140285851:                          ; CODE XREF: sub_1402851E0+AB8↓j
                                        ; sub_1402851E0+F50↓j ...
                cmp     r12, [rbp+200h+var_248]
                ja      loc_140286693
                mov     r11, 0FFFFFA8000000000h
                mov     r8, 8000000000000000h
                mov     r9, 0FFFFF6FB7DBED7F8h
                mov     rcx, 0FFFFF6FB7DBED000h
                test    r12, 0FFFh
                jz      short loc_140285896
                cmp     [rbp+200h+var_270], 1
                jnz     loc_140285A68

loc_140285896:                          ; CODE XREF: sub_1402851E0+6AA↑j
                xor     eax, eax
                mov     [rbp+200h+var_270], eax
                test    rbx, rbx
                jz      short loc_1402858B7
                lea     rcx, [rbp+200h+var_110]
                call    sub_14028EDB0
                mov     rdx, rbx
                mov     rcx, r13
                call    sub_140312B40

loc_1402858B7:                          ; CODE XREF: sub_1402851E0+6BE↑j
                movzx   eax, byte ptr [r13+0B8h]
                and     al, 7
                cmp     al, 2
                lea     rax, unk_140C4F600
                jz      short loc_1402858D3
                lea     rax, [r13+0C0h]

loc_1402858D3:                          ; CODE XREF: sub_1402851E0+6EA↑j
                mov     eax, [rax]
                bt      eax, 1Eh
                jb      short loc_1402858E4
                call    KeShouldYieldProcessor
                test    eax, eax
                jz      short loc_1402858F8

loc_1402858E4:                          ; CODE XREF: sub_1402851E0+6F9↑j
                movzx   edx, dil
                mov     rcx, r13
                call    sub_140226960
                mov     rcx, r13
                call    sub_140231340

loc_1402858F8:                          ; CODE XREF: sub_1402851E0+702↑j
                mov     rdi, r12
                mov     rdx, 0FFFFF68000000000h
                shr     rdi, 9
                mov     rax, 7FFFFFFFF8h
                and     rdi, rax
                mov     rax, rdx
                add     rdi, rax
                xor     ecx, ecx
                mov     rax, gs:188h
                mov     r15, r12
                mov     [rsp+300h+var_290], rdi
                mov     [rbp+200h+var_1E0], rcx
                shl     r15, 19h
                mov     r13, [rax+0B8h]
                lea     rbx, [r13+680h]
                mov     rax, rdx
                shl     rax, 19h
                sub     r15, rax
                sar     r15, 10h
                mov     rax, rdx
                cmp     r15, rax
                jb      short loc_140285970
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                mov     r12d, ecx
                cmp     r15, rax
                jbe     short loc_140285976

loc_140285970:                          ; CODE XREF: sub_1402851E0+779↑j
                mov     r12d, 1

loc_140285976:                          ; CODE XREF: sub_1402851E0+78E↑j
                                        ; sub_1402851E0+851↓j
                test    r12d, r12d
                jz      short loc_1402859B9
                xor     r8d, r8d
                mov     rdx, r15
                mov     rcx, rbx
                call    sub_1402258A0
                test    eax, eax
                jz      short loc_1402859B9
                cmp     eax, 1
                jz      loc_140285A36
                mov     rdx, 0FFFFF68000000000h

loc_1402859A0:                          ; CODE XREF: sub_1402851E0+7D7↓j
                shr     rdi, 9
                mov     rax, 7FFFFFFFF8h
                and     rdi, rax
                mov     rax, rdx
                add     rdi, rax
                jmp     short loc_1402859A0
; ---------------------------------------------------------------------------

loc_1402859B9:                          ; CODE XREF: sub_1402851E0+799↑j
                                        ; sub_1402851E0+7AB↑j
                mov     rdi, [rsp+300h+var_2A0]
                lea     r8, [rbp+200h+var_1E0]
                mov     rdx, rdi
                mov     rcx, rbx
                call    sub_1402A82C0
                cmp     rax, [rsp+300h+var_290]
                jz      short loc_140285A36
                mov     rdx, rax
                mov     rcx, rbx
                call    sub_140312B40
                lea     rcx, [rbp+200h+var_110]
                call    sub_14028EDB0
                movzx   edx, byte ptr [rbp+200h+var_280]
                mov     rcx, rbx
                call    sub_140226960
                mov     rax, 100000000000002h
                mov     ecx, r14d
                shl     rcx, 39h
                xor     r9d, r9d
                or      rcx, rax
                xor     r8d, r8d
                mov     rdx, rdi
                call    sub_140224260
                movsxd  rdi, eax
                test    eax, eax
                js      loc_1402867C8
                mov     rcx, rbx
                call    sub_140231340
                mov     rdi, [rsp+300h+var_290]
                jmp     loc_140285976
; ---------------------------------------------------------------------------

loc_140285A36:                          ; CODE XREF: sub_1402851E0+7B0↑j
                                        ; sub_1402851E0+7F2↑j
                mov     r12, [rsp+300h+var_2A0]
                mov     r8, 8000000000000000h
                mov     r15, [rsp+300h+var_298]
                mov     r9, 0FFFFF6FB7DBED7F8h
                mov     r11, 0FFFFFA8000000000h
                mov     rcx, 0FFFFF6FB7DBED000h

loc_140285A68:                          ; CODE XREF: sub_1402851E0+6B0↑j
                mov     r13, r12
                mov     r10, 0FFFFF68000000000h
                shl     r13, 19h
                mov     rax, r10
                mov     rbx, [r12]
                shl     rax, 19h
                sub     r13, rax
                sar     r13, 10h
                mov     rax, rcx
                cmp     r12, rax
                jb      loc_140285B09
                mov     rax, r9
                cmp     r12, rax
                ja      short loc_140285B09
                call    sub_140349680
                test    eax, eax
                jz      short loc_140285AFF
                test    bl, 1
                jz      short loc_140285AFF
                test    bl, 20h
                jz      short loc_140285AB7
                test    bl, 42h
                jnz     short loc_140285AFF

loc_140285AB7:                          ; CODE XREF: sub_1402851E0+8D0↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140285AFF
                mov     rax, r12
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140285AFF
                or      rbx, 42h

loc_140285AFF:                          ; CODE XREF: sub_1402851E0+8C6↑j
                                        ; sub_1402851E0+8CB↑j ...
                mov     rcx, 0FFFFF6FB7DBED000h

loc_140285B09:                          ; CODE XREF: sub_1402851E0+8B1↑j
                                        ; sub_1402851E0+8BD↑j
                mov     [rbp+200h+var_278], rbx
                test    bl, 1
                jz      loc_140286135
                mov     r15, rbx
                mov     rax, rcx
                lea     rcx, [rbp+200h+var_278]
                cmp     rcx, rax
                jb      short loc_140285B87
                mov     rax, r9
                lea     rcx, [rbp+200h+var_278]
                cmp     rcx, rax
                ja      short loc_140285B87
                call    sub_140349680
                test    eax, eax
                jz      short loc_140285B87
                test    bl, 20h
                jz      short loc_140285B44
                test    bl, 42h
                jnz     short loc_140285B87

loc_140285B44:                          ; CODE XREF: sub_1402851E0+95D↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140285B87
                or      r15, 20h
                lea     rax, [rbp+200h+var_278]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   r15, rbx
                test    al, 42h
                jz      short loc_140285B87
                or      r15, 42h

loc_140285B87:                          ; CODE XREF: sub_1402851E0+943↑j
                                        ; sub_1402851E0+94F↑j ...
                shr     r15, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     r15, rax
                mov     [rbp+200h+var_1F0], r15
                lea     rdi, [r15+r15*2]
                shl     rdi, 4
                mov     rax, r11
                add     rdi, rax
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_140285CBD
                mov     r15, [rdi+8]
                lea     r9, [rbp+200h+var_200]
                mov     rcx, [rsp+300h+var_298]
                mov     r12, r15
                or      r12, r8
                mov     rdx, r13
                xor     r8d, r8d
                shr     rdx, 0Ch
                call    sub_140283270
                cmp     r12, rax
                jz      loc_140285CAF
                xor     r9d, r9d
                mov     rcx, 1000000000h
                mov     ebx, r9d
                test    [rdi+28h], rcx
                jnz     short loc_140285C02
                test    r15, r15
                js      short loc_140285C02
                jnz     short loc_140285C28

loc_140285C02:                          ; CODE XREF: sub_1402851E0+A19↑j
                                        ; sub_1402851E0+A1E↑j
                mov     rcx, [rsp+300h+var_2B0]
                mov     rdx, r12
                call    sub_1402C6E74
                mov     r8, [rcx+690h]
                mov     rbx, rax
                mov     rdx, [rax+60h]
                cmp     [r8+168h], rdx
                cmovbe  rbx, r9

loc_140285C28:                          ; CODE XREF: sub_1402851E0+A20↑j
                lea     rcx, [rbp+200h+var_110]
                call    sub_14028EDB0
                mov     r12, [rsp+300h+var_2A0]
                xor     r9d, r9d
                mov     rdx, r12
                mov     r8, rsi
                mov     rcx, r13
                call    sub_1402C50E0
                mov     edi, eax
                test    eax, eax
                jns     short loc_140285C9D
                mov     r13, [rbp+200h+var_260]
                mov     rdx, [rsp+300h+var_290]
                mov     rcx, r13
                call    sub_140312B40
                movzx   edx, byte ptr [rbp+200h+var_280]
                mov     rcx, r13
                call    sub_140226960
                mov     edx, edi
                mov     rcx, r13
                call    sub_14055C0F8
                xor     eax, eax
                mov     [rbp+200h+var_270], 1
                mov     rcx, r13
                mov     [rsp+300h+var_290], rax
                mov     ebx, eax
                call    sub_140231340
                mov     rdi, [rbp+200h+var_280]
                mov     r15, [rsp+300h+var_298]
                jmp     loc_140285851
; ---------------------------------------------------------------------------

loc_140285C9D:                          ; CODE XREF: sub_1402851E0+A6E↑j
                test    rbx, rbx
                jz      loc_14028667C
                dec     [rbp+200h+var_268]
                jmp     loc_14028667C
; ---------------------------------------------------------------------------

loc_140285CAF:                          ; CODE XREF: sub_1402851E0+9FF↑j
                mov     r15, [rbp+200h+var_1F0]
                mov     r10, 0FFFFF68000000000h

loc_140285CBD:                          ; CODE XREF: sub_1402851E0+9D4↑j
                mov     r12d, [rbp+200h+arg_20]
                and     r12d, 101h
                jnz     loc_140285FE3
                cmp     [rbp+200h+arg_28], 1
                jnz     short loc_140285CEA
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_140285FE3

loc_140285CEA:                          ; CODE XREF: sub_1402851E0+AF8↑j
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_140285F32
                cmp     [rsp+300h+var_288], 5
                jz      short loc_140285D0C
                bt      rbx, 9
                jnb     short loc_140285D0C
                inc     [rbp+200h+var_250]

loc_140285D0C:                          ; CODE XREF: sub_1402851E0+B1F↑j
                                        ; sub_1402851E0+B26↑j
                shr     r13, 9
                mov     rbx, 7FFFFFFFF8h
                and     rbx, r13
                mov     rax, r10
                add     rbx, rax
                mov     r12, 0FFFFF6FB7DBED000h
                mov     rdx, [rbx]
                mov     rax, r12
                mov     r13, 0FFFFF6FB7DBED7F8h
                cmp     rbx, rax
                jb      short loc_140285DAA
                mov     rax, r13
                cmp     rbx, rax
                ja      short loc_140285DAA
                call    sub_140349680
                test    eax, eax
                jz      short loc_140285DAA
                test    dl, 1
                jz      short loc_140285DAA
                test    dl, 20h
                jz      short loc_140285D62
                test    dl, 42h
                jnz     short loc_140285DAA

loc_140285D62:                          ; CODE XREF: sub_1402851E0+B7B↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140285DAA
                mov     rax, rbx
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140285DAA
                or      rdx, 42h

loc_140285DAA:                          ; CODE XREF: sub_1402851E0+B60↑j
                                        ; sub_1402851E0+B68↑j ...
                shr     rdx, 3Ch
                and     edx, 7
                jz      short loc_140285DD2
                mov     rax, [rbx]
                test    al, 10h
                jnz     short loc_140285DC7
                test    al, 8
                jz      short loc_140285DC3
                or      edx, 18h
                jmp     short loc_140285DCA
; ---------------------------------------------------------------------------

loc_140285DC3:                          ; CODE XREF: sub_1402851E0+BDC↑j
                test    al, 10h
                jz      short loc_140285DCA

loc_140285DC7:                          ; CODE XREF: sub_1402851E0+BD8↑j
                or      edx, 8

loc_140285DCA:                          ; CODE XREF: sub_1402851E0+BE1↑j
                                        ; sub_1402851E0+BE5↑j
                test    edx, edx
                jnz     loc_140285E59

loc_140285DD2:                          ; CODE XREF: sub_1402851E0+BD1↑j
                lea     rcx, [rdi+10h]
                call    sub_1402805F0
                mov     r8, rax
                mov     rax, 1000000000h
                shr     r8, 5
                and     r8d, 1Fh
                test    [rdi+28h], rax
                jnz     short loc_140285E12
                mov     rax, [rdi+8]
                test    rax, rax
                js      short loc_140285E12
                jz      short loc_140285E12
                lea     rax, cs:140000000h
                mov     edx, ds:rva dword_1400174A0[rax+r8*4]
                jmp     short loc_140285E59
; ---------------------------------------------------------------------------

loc_140285E12:                          ; CODE XREF: sub_1402851E0+C14↑j
                                        ; sub_1402851E0+C1D↑j ...
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     qword ptr [rcx+4F0h], 0
                jz      short loc_140285E56
                mov     rdx, [rdi+8]
                mov     rax, 8000000000000000h
                or      rdx, rax
                call    sub_1402C6E74
                test    rax, rax
                jz      short loc_140285E56
                lea     rcx, cs:140000000h
                mov     r8d, ds:rva dword_1400174A0[rcx+r8*4]

loc_140285E56:                          ; CODE XREF: sub_1402851E0+C4A↑j
                                        ; sub_1402851E0+C65↑j
                mov     edx, r8d

loc_140285E59:                          ; CODE XREF: sub_1402851E0+BEC↑j
                                        ; sub_1402851E0+C30↑j
                mov     r8d, [rbp+200h+var_258]
                mov     rcx, [rsp+300h+var_298]
                mov     [rsp+300h+var_2A8], edx
                call    sub_140286800
                mov     rdx, [rbx]
                mov     r10d, eax
                mov     rax, r12
                cmp     rbx, rax
                jb      short loc_140285EE1
                mov     rax, r13
                cmp     rbx, rax
                ja      short loc_140285EE1
                call    sub_140349680
                test    eax, eax
                jz      short loc_140285EE1
                test    dl, 1
                jz      short loc_140285EE1
                test    dl, 20h
                jz      short loc_140285E99
                test    dl, 42h
                jnz     short loc_140285EE1

loc_140285E99:                          ; CODE XREF: sub_1402851E0+CB2↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140285EE1
                mov     rax, rbx
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140285EE1
                or      rdx, 42h

loc_140285EE1:                          ; CODE XREF: sub_1402851E0+C97↑j
                                        ; sub_1402851E0+C9F↑j ...
                mov     rax, [rbx]
                mov     rcx, 0F00000000000000h
                and     rdx, rcx
                mov     r8, r10
                shl     r8, 3Ch
                mov     rcx, 7F00000000000000h
                or      r8, rdx
                mov     rdx, 80FFFFFFFFFFFFFFh
                and     r8, rcx
                nop     dword ptr [rax+00h]
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140285F20:                          ; CODE XREF: sub_1402851E0+D4E↓j
                mov     rcx, rax
                and     rcx, rdx
                or      rcx, r8
                lock cmpxchg [rbx], rcx
                jnz     short loc_140285F20
                jmp     short loc_140285FB1
; ---------------------------------------------------------------------------

loc_140285F32:                          ; CODE XREF: sub_1402851E0+B14↑j
                xor     eax, eax
                mov     [rbp+200h+var_220], eax
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jnb     short loc_140285F5B

loc_140285F40:                          ; CODE XREF: sub_1402851E0+D70↓j
                                        ; sub_1402851E0+D79↓j
                lea     rcx, [rbp+200h+var_220]
                call    sub_1402C8C70
                mov     rax, [rdi+18h]
                test    rax, rax
                js      short loc_140285F40
                lock bts qword ptr [rdi+18h], 3Fh ; '?'
                jb      short loc_140285F40

loc_140285F5B:                          ; CODE XREF: sub_1402851E0+D5E↑j
                mov     r9, [rdi+10h]
                mov     r8d, [rbp+200h+var_26C]
                mov     rdx, r9
                mov     rcx, [rsp+300h+var_298]
                shr     rdx, 5
                and     edx, 1Fh
                call    sub_140286800
                mov     r10d, eax
                and     eax, 1Fh
                shl     rax, 5
                test    r9, r9
                jnz     short loc_140285F94
                mov     rcx, rax
                call    sub_14027C6C0
                mov     [rdi+10h], rax
                jmp     short loc_140285FA2
; ---------------------------------------------------------------------------

loc_140285F94:                          ; CODE XREF: sub_1402851E0+DA4↑j
                and     r9, 0FFFFFFFFFFFFFC1Fh
                or      r9, rax
                mov     [rdi+10h], r9

loc_140285FA2:                          ; CODE XREF: sub_1402851E0+DB2↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rdi+18h], rax

loc_140285FB1:                          ; CODE XREF: sub_1402851E0+D50↑j
                mov     r12, [rsp+300h+var_2A0]
                lea     rax, [rbp+200h+var_110]
                mov     rcx, [rsp+300h+var_298]
                mov     rdx, r12
                mov     r9, r15
                mov     [rsp+300h+var_2E0], rax
                mov     r8d, r10d
                call    sub_140286870
                add     r12, 8
                mov     [rsp+300h+var_2A0], r12
                jmp     loc_14028667C
; ---------------------------------------------------------------------------

loc_140285FE3:                          ; CODE XREF: sub_1402851E0+AEB↑j
                                        ; sub_1402851E0+B04↑j
                mov     rdx, [rsp+300h+var_2A0]
                mov     rax, [rbp+200h+var_248]
                mov     rcx, rdx
                and     rcx, 0FFFFFFFFFFFFF000h
                and     rax, 0FFFFFFFFFFFFF000h
                cmp     rcx, rax
                mov     rdi, rdx
                lea     r15, [rcx+0FF8h]
                cmovz   r15, [rbp+200h+var_248]
                xor     bl, bl
                cmp     rdx, r15
                ja      loc_140286100
                mov     r14, [rbp+200h+var_260]
                mov     rsi, [rbp+200h+var_1D8]

loc_140286021:                          ; CODE XREF: sub_1402851E0+F0F↓j
                mov     rcx, rdi
                call    sub_1402805F0
                mov     [rbp+200h+var_278], rax
                test    al, 1
                jz      loc_1402860F5
                test    r12d, r12d
                jnz     short loc_140286082
                cmp     [rbp+200h+arg_28], 1
                jnz     loc_1402860F5
                lea     rcx, [rbp+200h+var_278]
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rcx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rcx, 4
                mov     rax, rax
                add     rcx, rax
                call    sub_1403F41D8
                test    eax, eax
                jnz     short loc_1402860F5

loc_140286082:                          ; CODE XREF: sub_1402851E0+E58↑j
                mov     rdx, r13
                call    sub_1402DECC0
                and     al, 0Fh
                cmp     al, 8
                jnz     short loc_14028609A
                mov     bl, 1
                mov     dword ptr [rsi], 1
                jmp     short loc_1402860BA
; ---------------------------------------------------------------------------

loc_14028609A:                          ; CODE XREF: sub_1402851E0+EAE↑j
                xor     r9d, r9d
                lea     rcx, [rbp+200h+var_1D0]
                mov     rdx, r13
                lea     r8d, [r9+1]
                call    sub_1402882E0
                cmp     bl, 1
                jz      short loc_1402860BA
                mov     eax, dword ptr [rbp+200h+var_1C8]
                cmp     dword ptr [rbp+200h+var_1C8+4], eax
                jnz     short loc_1402860E1

loc_1402860BA:                          ; CODE XREF: sub_1402851E0+EB8↑j
                                        ; sub_1402851E0+ED0↑j
                cmp     dword ptr [rbp+200h+var_1C8+4], 0
                jz      short loc_1402860CF
                xor     r8d, r8d
                lea     rdx, [rbp+200h+var_1D0]
                mov     rcx, r14
                call    sub_140279D90

loc_1402860CF:                          ; CODE XREF: sub_1402851E0+EDE↑j
                cmp     bl, 1
                jnz     short loc_1402860E1
                mov     rdx, r13
                mov     rcx, r14
                call    sub_1402DDA7C
                xor     bl, bl

loc_1402860E1:                          ; CODE XREF: sub_1402851E0+ED8↑j
                                        ; sub_1402851E0+EF2↑j
                add     rdi, 8
                add     r13, 1000h
                cmp     rdi, r15
                jbe     loc_140286021

loc_1402860F5:                          ; CODE XREF: sub_1402851E0+E4F↑j
                                        ; sub_1402851E0+E61↑j ...
                mov     r14d, [rbp+200h+var_21C]
                mov     rsi, 0FFFFFFFFFFFFFFFFh

loc_140286100:                          ; CODE XREF: sub_1402851E0+E33↑j
                cmp     dword ptr [rbp+200h+var_1C8+4], 0
                jz      loc_140286677
                mov     r13, [rbp+200h+var_260]
                lea     rdx, [rbp+200h+var_1D0]
                mov     rcx, r13
                xor     r8d, r8d
                call    sub_140279D90
                mov     r12, [rsp+300h+var_2A0]
                mov     rbx, [rsp+300h+var_290]
                mov     rdi, [rbp+200h+var_280]
                mov     r15, [rsp+300h+var_298]
                jmp     loc_140285851
; ---------------------------------------------------------------------------

loc_140286135:                          ; CODE XREF: sub_1402851E0+930↑j
                bt      rbx, 0Ah
                jnb     loc_14028626D
                mov     rcx, rbx
                call    sub_14031C870
                test    eax, eax
                jnz     loc_1402861D4
                mov     rax, cs:qword_140C4DDC0
                mov     rdi, rbx
                test    rax, rax
                jz      short loc_14028616D
                test    bl, 10h
                jnz     short loc_14028616D
                mov     rdi, rax
                not     rdi
                and     rdi, rbx

loc_14028616D:                          ; CODE XREF: sub_1402851E0+F7D↑j
                                        ; sub_1402851E0+F82↑j
                shr     r13, 0Ch
                lea     r9, [rbp+200h+var_200]
                mov     rdx, r13
                xor     r8d, r8d
                mov     rcx, r15
                call    sub_140283270
                sar     rdi, 10h
                cmp     rdi, rax
                jz      short loc_1402861D4
                lea     rcx, [rbp+200h+var_110]
                call    sub_14028EDB0
                mov     rdi, [rbp+200h+var_280]
                mov     edx, 1
                movzx   r8d, dil
                mov     rcx, r12
                call    sub_14034F194
                test    eax, eax
                jns     short loc_1402861BA
                add     r12, 8
                mov     [rsp+300h+var_2A0], r12

loc_1402861BA:                          ; CODE XREF: sub_1402851E0+FCF↑j
                mov     rbx, [rsp+300h+var_290]
                mov     r13, [rbp+200h+var_260]
                mov     r15, [rsp+300h+var_298]
                mov     [rbp+200h+var_270], 1
                jmp     loc_140285851
; ---------------------------------------------------------------------------

loc_1402861D4:                          ; CODE XREF: sub_1402851E0+F6A↑j
                                        ; sub_1402851E0+FAA↑j
                cmp     [rsp+300h+var_288], 5
                jz      short loc_1402861F4
                mov     rcx, rbx
                call    sub_14031C870
                test    eax, eax
                jz      short loc_1402861F4
                movzx   eax, bl
                and     al, 0A0h
                cmp     al, 0A0h
                jnz     short loc_1402861F4
                inc     [rbp+200h+var_250]

loc_1402861F4:                          ; CODE XREF: sub_1402851E0+FF9↑j
                                        ; sub_1402851E0+1005↑j ...
                mov     rcx, rbx
                call    sub_14031C870
                test    eax, eax
                jz      short loc_140286206
                shr     rbx, 5
                jmp     short loc_140286210
; ---------------------------------------------------------------------------

loc_140286206:                          ; CODE XREF: sub_1402851E0+101E↑j
                mov     rax, [r15+48h]
                movzx   ebx, word ptr [rax+20h]
                shr     ebx, 1

loc_140286210:                          ; CODE XREF: sub_1402851E0+1024↑j
                mov     r8d, [rbp+200h+var_258]
                and     ebx, 1Fh
                mov     edx, ebx
                mov     [rsp+300h+var_2A8], ebx
                mov     rcx, r15
                call    sub_140286800
                mov     ecx, eax
                and     ecx, 1Fh
                or      rcx, 0FFFFFFFFF8000020h
                shl     rcx, 5
                call    sub_14027C6C0
                mov     rcx, r12
                mov     [rbp+200h+var_278], rax
                mov     rdi, rax
                mov     rbx, rax
                call    sub_1402433C0
                test    eax, eax
                jz      loc_140286668
                call    sub_140349680
                test    eax, eax
                jz      loc_140286639
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jmp     loc_14028660A
; ---------------------------------------------------------------------------

loc_14028626D:                          ; CODE XREF: sub_1402851E0+F5A↑j
                bt      rbx, 0Bh
                jnb     short loc_1402862CE
                cmp     [rbp+200h+arg_28], 1
                jnz     short loc_1402862AC
                mov     rcx, r12
                call    sub_14034E3D4
                cmp     eax, 3
                jnz     short loc_140286290
                inc     [rbp+200h+var_208]
                jmp     short loc_140286299
; ---------------------------------------------------------------------------

loc_140286290:                          ; CODE XREF: sub_1402851E0+10A8↑j
                cmp     eax, 1
                jz      loc_14028667C

loc_140286299:                          ; CODE XREF: sub_1402851E0+10AE↑j
                mov     rbx, [rsp+300h+var_2B0]
                mov     rax, rsi
                lock xadd [rbx+4F8h], rax
                jmp     short loc_14028630E
; ---------------------------------------------------------------------------

loc_1402862AC:                          ; CODE XREF: sub_1402851E0+109B↑j
                mov     r8d, [rbp+200h+var_26C]
                mov     r9d, 1
                mov     rdx, r12
                mov     rcx, r15
                call    sub_1402A877C
                test    eax, eax
                jz      loc_14028666C
                jmp     loc_14028667C
; ---------------------------------------------------------------------------

loc_1402862CE:                          ; CODE XREF: sub_1402851E0+1092↑j
                xor     r15b, r15b
                cmp     [rbp+200h+arg_28], 1
                jnz     short loc_140286328
                test    rbx, rbx
                jz      short loc_140286331
                mov     rcx, [rbp+200h+var_230]
                mov     r8d, 1
                mov     rdx, rbx
                call    sub_1402D9B64
                mov     rcx, rbx
                call    sub_1402CA91C
                test    eax, eax
                jz      short loc_14028630E
                mov     rcx, [rsp+300h+var_2B0]
                mov     rax, rsi
                lock xadd [rcx+4F8h], rax

loc_14028630E:                          ; CODE XREF: sub_1402851E0+10CA↑j
                                        ; sub_1402851E0+111B↑j
                mov     rcx, r13
                call    sub_14029BB60
                mov     edx, 1
                mov     rcx, rax
                call    sub_1403548C4
                mov     r15b, 1
                jmp     short loc_140286331
; ---------------------------------------------------------------------------

loc_140286328:                          ; CODE XREF: sub_1402851E0+10F8↑j
                test    rbx, rbx
                jnz     loc_1402865B4

loc_140286331:                          ; CODE XREF: sub_1402851E0+10FD↑j
                                        ; sub_1402851E0+1146↑j
                shr     r13, 12h
                and     r13d, 3FFFFFF8h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                mov     rbx, [rax+r13]
                lea     rdi, [rax+r13]
                mov     rcx, rdi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_1402863BD
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402863BD
                test    bl, 1
                jz      short loc_1402863BD
                test    bl, 20h
                jz      short loc_140286375
                test    bl, 42h
                jnz     short loc_1402863BD

loc_140286375:                          ; CODE XREF: sub_1402851E0+118E↑j
                mov     rax, gs:188h
                mov     edx, edi
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_1402863BD
                shr     rdx, 3
                and     edx, 1FFh
                mov     rax, [rax+rdx*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_1402863BD
                or      rbx, 42h

loc_1402863BD:                          ; CODE XREF: sub_1402851E0+117B↑j
                                        ; sub_1402851E0+1184↑j ...
                lea     rcx, [rbp+200h+var_1F8]
                mov     [rbp+200h+var_1F8], rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14028642F
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028642F
                test    bl, 1
                jz      short loc_14028642F
                test    bl, 20h
                jz      short loc_1402863E6
                test    bl, 42h
                jnz     short loc_14028642F

loc_1402863E6:                          ; CODE XREF: sub_1402851E0+11FF↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028642F
                lea     rax, [rbp+200h+var_1F8]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14028642F
                or      rbx, 42h

loc_14028642F:                          ; CODE XREF: sub_1402851E0+11EC↑j
                                        ; sub_1402851E0+11F5↑j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rbx, [rbx+rbx*2]
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                xor     eax, eax
                mov     [rbp+200h+var_218], eax
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jnb     short loc_140286481

loc_140286466:                          ; CODE XREF: sub_1402851E0+1296↓j
                                        ; sub_1402851E0+129F↓j
                lea     rcx, [rbp+200h+var_218]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_140286466
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_140286466

loc_140286481:                          ; CODE XREF: sub_1402851E0+1284↑j
                mov     rax, [rbx+10h]
                lea     rcx, [rax+10000h]
                xor     rcx, rax
                and     ecx, 3FF0000h
                xor     rcx, rax
                mov     rax, 7FFFFFFFFFFFFFFFh
                mov     [rbx+10h], rcx
                lock and [rbx+18h], rax
                mov     rcx, [rbx+8]
                mov     rbx, 8000000000000000h
                or      rcx, rbx
                call    sub_14029B5F0
                cmp     [rsp+300h+var_288], 5
                jz      short loc_1402864E3
                cmp     r15b, 1
                jz      short loc_1402864DF
                mov     rcx, [rsp+300h+var_298]
                mov     rdx, r12
                call    sub_14031BD38
                test    eax, eax
                jnz     short loc_1402864E3

loc_1402864DF:                          ; CODE XREF: sub_1402851E0+12EC↑j
                inc     [rbp+200h+var_250]

loc_1402864E3:                          ; CODE XREF: sub_1402851E0+12E6↑j
                                        ; sub_1402851E0+12FD↑j
                mov     rax, [rsp+300h+var_298]
                xor     ecx, ecx
                mov     r8d, [rbp+200h+var_258]
                mov     rax, [rax+48h]
                movzx   edx, word ptr [rax+20h]
                shr     edx, 1
                and     edx, 1Fh
                mov     [rsp+300h+var_2A8], edx
                call    sub_140286800
                mov     ecx, eax
                and     ecx, 1Fh
                or      rcx, 0FFFFFFFFF8000020h
                shl     rcx, 5
                call    sub_14027C6C0
                mov     rdx, rax
                mov     [rbp+200h+var_278], rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r12, rax
                jb      short loc_1402865A2
                mov     r13, 0FFFFF6FB7DBED7F8h
                mov     rax, r13
                cmp     r12, rax
                ja      short loc_1402865A2
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028657E
                cmp     byte ptr cs:word_140C4DE88+1, 0
                mov     rax, rdx
                jnz     short loc_140286561
                test    dl, 1
                jz      short loc_140286561
                or      rax, rbx

loc_140286561:                          ; CODE XREF: sub_1402851E0+1377↑j
                                        ; sub_1402851E0+137C↑j
                mov     rdx, rax
                mov     [r12], rax
                mov     rcx, r12
                call    sub_140349620
                add     r12, 8
                mov     [rsp+300h+var_2A0], r12
                jmp     loc_14028667C
; ---------------------------------------------------------------------------

loc_14028657E:                          ; CODE XREF: sub_1402851E0+136B↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_1402865A2
                test    dl, 1
                jz      short loc_1402865A2
                or      rdx, rbx

loc_1402865A2:                          ; CODE XREF: sub_1402851E0+1350↑j
                                        ; sub_1402851E0+1362↑j ...
                mov     [r12], rdx
                add     r12, 8
                mov     [rsp+300h+var_2A0], r12
                jmp     loc_14028667C
; ---------------------------------------------------------------------------

loc_1402865B4:                          ; CODE XREF: sub_1402851E0+114B↑j
                mov     r8d, [rbp+200h+var_26C]
                mov     rax, rbx
                mov     rcx, [rsp+300h+var_298]
                shr     rax, 5
                and     eax, 1Fh
                mov     edx, eax
                mov     [rsp+300h+var_2A8], eax
                call    sub_140286800
                mov     edi, eax
                mov     rcx, r12
                shl     rdi, 5
                xor     rdi, rbx
                mov     [rbp+200h+var_26C], eax
                and     edi, 3E0h
                xor     rdi, rbx
                mov     [rbp+200h+var_278], rdi
                mov     rbx, rdi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_140286668
                call    sub_140349680
                test    eax, eax
                jz      short loc_140286639
                cmp     byte ptr cs:word_140C4DE88+1, r15b

loc_14028660A:                          ; CODE XREF: sub_1402851E0+1088↑j
                mov     rdx, rdi
                jnz     short loc_140286622
                test    dil, 1
                jz      short loc_140286622
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_140286622:                          ; CODE XREF: sub_1402851E0+142D↑j
                                        ; sub_1402851E0+1433↑j
                mov     rcx, r12
                mov     [r12], rdx
                call    sub_140349620
                add     r12, 8
                mov     [rsp+300h+var_2A0], r12
                jmp     short loc_14028667C
; ---------------------------------------------------------------------------

loc_140286639:                          ; CODE XREF: sub_1402851E0+107B↑j
                                        ; sub_1402851E0+1421↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140286668
                test    dil, 1
                jz      short loc_140286668
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_140286668:                          ; CODE XREF: sub_1402851E0+106E↑j
                                        ; sub_1402851E0+1418↑j ...
                mov     [r12], rbx

loc_14028666C:                          ; CODE XREF: sub_1402851E0+10E3↑j
                add     r12, 8
                mov     [rsp+300h+var_2A0], r12
                jmp     short loc_14028667C
; ---------------------------------------------------------------------------

loc_140286677:                          ; CODE XREF: sub_1402851E0+F24↑j
                mov     r12, [rsp+300h+var_2A0]

loc_14028667C:                          ; CODE XREF: sub_1402851E0+AC0↑j
                                        ; sub_1402851E0+ACA↑j ...
                mov     r13, [rbp+200h+var_260]
                mov     rbx, [rsp+300h+var_290]
                mov     rdi, [rbp+200h+var_280]
                mov     r15, [rsp+300h+var_298]
                jmp     loc_140285851
; ---------------------------------------------------------------------------

loc_140286693:                          ; CODE XREF: sub_1402851E0+675↑j
                lea     rcx, [rbp+200h+var_110]
                call    sub_14028EDB0
                test    rbx, rbx
                jz      short loc_1402866AF
                mov     rdx, rbx
                mov     rcx, r13
                call    sub_140312B40

loc_1402866AF:                          ; CODE XREF: sub_1402851E0+14C2↑j
                movzx   edx, dil
                mov     rcx, r13
                call    sub_140226960
                cmp     [rbp+200h+var_240], 1
                mov     rdi, [rsp+300h+var_2B0]
                jnz     short loc_1402866FA
                lock xadd [rdi+4D0h], rsi
                and     sil, 6
                cmp     sil, 2
                jnz     short loc_1402866E5
                lea     rcx, [rdi+4D0h]
                call    ExfTryToWakePushLock

loc_1402866E5:                          ; CODE XREF: sub_1402851E0+14F7↑j
                lea     rcx, [rdi+4D0h]
                call    sub_140243660
                mov     rcx, [rbp+200h+var_210]
                call    sub_140245770

loc_1402866FA:                          ; CODE XREF: sub_1402851E0+14E4↑j
                mov     rsi, [rbp+200h+var_208]
                mov     rax, [rbp+200h+var_238]
                test    rsi, rsi
                jz      short loc_140286715
                cmp     [rsp+300h+var_288], 5
                jnz     short loc_140286715
                sub     rax, rsi
                xor     ecx, ecx
                mov     esi, ecx

loc_140286715:                          ; CODE XREF: sub_1402851E0+1525↑j
                                        ; sub_1402851E0+152C↑j
                mov     r14, [rbp+200h+var_230]
                test    rax, rax
                jz      short loc_140286729
                mov     rdx, rax
                mov     rcx, r14
                call    sub_14026B700

loc_140286729:                          ; CODE XREF: sub_1402851E0+153C↑j
                mov     rbx, [rbp+200h+var_250]
                test    rbx, rbx
                jz      short loc_14028677D
                mov     ecx, [r15+34h]
                mov     rdx, rbx
                movzx   eax, byte ptr [r15+22h]
                mov     r8d, ecx
                shl     rax, 1Fh
                btr     r8d, 1Fh
                or      r8, rax
                sub     rdx, rsi
                sub     r8, rbx
                mov     eax, r8d
                shr     r8, 1Fh
                xor     eax, ecx
                btr     eax, 1Fh
                xor     eax, ecx
                mov     rcx, r14
                mov     [r15+34h], eax
                mov     [r15+22h], r8b
                call    sub_14026B700
                mov     rdx, rbx
                mov     rcx, rdi
                call    sub_14026B7D0

loc_14028677D:                          ; CODE XREF: sub_1402851E0+1550↑j
                mov     rdx, [rbp+200h+var_268]
                test    rdx, rdx
                jz      short loc_14028678E
                mov     rcx, rdi
                call    sub_14065C6A8

loc_14028678E:                          ; CODE XREF: sub_1402851E0+15A4↑j
                xor     eax, eax

loc_140286790:                          ; CODE XREF: sub_1402851E0+29B↑j
                                        ; sub_1402851E0+329↑j ...
                mov     rdi, [rsp+300h+var_30]
                mov     rbx, [rsp+300h+var_28]
                mov     r13, [rsp+300h+var_38]
; } // starts at 14028532B

loc_1402867A8:                          ; CODE XREF: sub_1402851E0+146↑j
                                        ; DATA XREF: .pdata:00000001400CEB20↑o ...
; __unwind { // __GSHandlerCheck
                mov     rcx, [rbp+200h+var_50]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 2E0h
                pop     r15
                pop     r14
                pop     r12
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 8
; } // starts at 1402867A8

loc_1402867C8:                          ; CODE XREF: sub_1402851E0+83E↑j
                                        ; DATA XREF: .pdata:00000001400CEB2C↑o ...
; __unwind { // __GSHandlerCheck
                mov     ecx, 1
                call    sub_140535798
                mov     rdx, [rsp+300h+var_2A0]
                mov     r8, rdi
                mov     [rsp+300h+var_2E0], rdx
                mov     r9, r13
                mov     edx, 1
                lea     ecx, [rdx+79h]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 1402867C8
sub_1402851E0   endp

algn_1402867F0:                         ; DATA XREF: .pdata:00000001400CEB38↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140286800   proc near               ; CODE XREF: sub_14026CF00+26B↑p
                                        ; sub_1402851E0+C86↑p ...

; FUNCTION CHUNK AT 00000001404444C2 SIZE 00000022 BYTES

                cmp     r8d, 18h
                jz      short loc_140286825
                cmp     edx, 18h
                jz      short loc_14028682C

loc_14028680B:                          ; CODE XREF: sub_140286800+45↓j
                                        ; sub_140286800+49↓j
                and     edx, 18h
                jnz     short loc_140286850
                mov     eax, r8d
                and     eax, 18h
                cmp     eax, 18h
                jz      short loc_14028685F
                cmp     eax, 8
                jz      short loc_140286859

loc_140286820:                          ; CODE XREF: sub_140286800+5D↓j
                                        ; sub_140286800+63↓j ...
                mov     eax, r8d
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140286825:                          ; CODE XREF: sub_140286800+4↑j
                mov     eax, 18h
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14028682C:                          ; CODE XREF: sub_140286800+9↑j
                mov     edx, [rcx+30h]
                bt      edx, 14h
                jb      short loc_14028684B
                mov     rax, [rcx+48h]
                movzx   edx, word ptr [rax+20h]
                shr     edx, 1

loc_14028683F:                          ; CODE XREF: sub_140286800+4E↓j
                and     edx, 1Fh
                cmp     edx, 18h
                jnz     short loc_14028680B
                xor     edx, edx
                jmp     short loc_14028680B
; ---------------------------------------------------------------------------

loc_14028684B:                          ; CODE XREF: sub_140286800+33↑j
                shr     edx, 7
                jmp     short loc_14028683F
; ---------------------------------------------------------------------------

loc_140286850:                          ; CODE XREF: sub_140286800+E↑j
                cmp     edx, 10h
                jnz     loc_1404444C2

loc_140286859:                          ; CODE XREF: sub_140286800+1E↑j
                and     r8d, 0FFFFFFF7h
                jmp     short loc_140286820
; ---------------------------------------------------------------------------

loc_14028685F:                          ; CODE XREF: sub_140286800+19↑j
                and     r8d, 0FFFFFFE7h
                jmp     short loc_140286820
sub_140286800   endp

; ---------------------------------------------------------------------------
algn_140286865:                         ; DATA XREF: .pdata:00000001400CEB44↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140286870   proc near               ; CODE XREF: sub_1402851E0+DF0↑p
                                        ; sub_1402A6A10+6CB↓p ...

var_78          = dword ptr -78h
var_74          = dword ptr -74h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = dword ptr  20h
arg_20          = qword ptr  28h

; FUNCTION CHUNK AT 00000001404444E4 SIZE 000005EF BYTES

                mov     [rsp+arg_8], rdx
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 58h
                mov     r10d, [rcx+30h]
                mov     r15, rdx
                xor     edx, edx
                mov     eax, r10d
                and     eax, 500000h
                mov     [rsp+98h+arg_18], edx
                mov     r11, rcx
                mov     r12, r9
                lea     rcx, cs:140000000h
                mov     edi, r8d
                cmp     eax, 500000h
                jz      loc_1404444E4
                mov     ecx, 1
                mov     r9d, 3
                mov     [rsp+98h+arg_10], r9d
                mov     r14d, ecx
                mov     [rsp+98h+var_60], rcx

loc_1402868D8:                          ; CODE XREF: sub_140286870+1BDCC7↓j
                mov     r13, r15
                mov     [rsp+98h+var_68], rcx
                shl     r13, 19h
                mov     rbp, 0FFFFF68000000000h
                mov     rax, rbp
                mov     rsi, [r15]
                shl     rax, 19h
                sub     r13, rax
                mov     [rsp+98h+var_58], rsi
                sar     r13, 10h
                mov     [rsp+98h+var_50], r13
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                mov     rcx, 0FFFFF6FB7DBED7F8h
                cmp     r15, rax
                jnb     loc_14044453C

loc_140286929:                          ; CODE XREF: sub_140286870+1BDCD2↓j
                                        ; sub_140286870+1BDD5E↓j
                mov     eax, r8d
                movzx   ecx, sil
                and     eax, 18h
                and     cl, 18h
                cmp     cl, 8
                jz      loc_140286C4E
                test    sil, 10h
                jnz     loc_1404445D3
                test    eax, eax
                jnz     loc_1404445E7

loc_140286951:                          ; CODE XREF: sub_140286870+3E8↓j
                                        ; sub_140286870+1BDD66↓j ...
                mov     r10, 0FFFFFFFFFh
                cmp     r12, r10
                ja      loc_1404446CA
                lea     rcx, [r12+r12*2]
                shl     rcx, 4
                mov     rax, 0FFFFFA8000000028h
                mov     rax, [rcx+rax]
                mov     r8, 4000000000000h
                test    r8, rax
                jz      loc_1404446CA
                mov     rax, 0FFFFFA8000000000h
                add     rcx, rax
                test    cs:dword_140CFC400, 40000h
                mov     [rsp+98h+var_70], rcx
                jnz     loc_1404445EF

loc_1402869AF:                          ; CODE XREF: sub_140286870+1BDD83↓j
                                        ; sub_140286870+1BDE62↓j
                mov     r8, 7FFFFFFFFFFFFFFFh

loc_1402869B9:                          ; CODE XREF: sub_140286870+1BDE55↓j
                cmp     r9d, 1
                jbe     loc_1404446D7

loc_1402869C3:                          ; CODE XREF: sub_140286870+1BDE6B↓j
                mov     r14d, edi
                lea     rax, cs:140000000h
                and     r14d, 1Fh
                mov     rbx, ds:rva qword_140017520[rax+r14*8]
                mov     rax, 0FFFF000000000E7Fh
                and     rbx, rax
                mov     rax, r12
                and     rax, r10
                shl     rax, 0Ch
                or      rbx, rax
                or      rbx, 21h
                mov     rax, rbp
                mov     r9, 8000000000000000h
                cmp     r15, rax
                jb      loc_1404447B0
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r15, rax
                ja      loc_1404447B0
                mov     rax, 0FFFFF6FB40000000h
                cmp     r15, rax
                jnb     loc_1404446E0

loc_140286A36:                          ; CODE XREF: sub_140286870+1BDE7D↓j
                                        ; sub_140286870+1BDEBF↓j
                mov     rax, rbp
                mov     r8, 3FFFFFFF78h
                add     rax, r8
                cmp     r15, rax
                ja      short loc_140286A4F
                or      rbx, 4

loc_140286A4F:                          ; CODE XREF: sub_140286870+1D9↑j
                bt      edi, 1Ah
                jb      loc_140444734
                mov     rbp, r13

loc_140286A5C:                          ; CODE XREF: sub_140286870+1BDED6↓j
                mov     rax, 0FFFF800000000000h
                cmp     rbp, rax
                jnb     loc_14044474B
                movzx   eax, byte ptr cs:word_140C4DE88+1

loc_140286A76:                          ; CODE XREF: sub_140286870+1BDF3B↓j
                test    eax, eax
                jnz     loc_1404447B0

loc_140286A7E:                          ; CODE XREF: sub_140286870+1BDF45↓j
                                        ; sub_140286870+1BDF59↓j
                test    edi, edi
                js      loc_1404447CE

loc_140286A86:                          ; CODE XREF: sub_140286870+1BDF66↓j
                                        ; sub_140286870+1BDF70↓j
                bt      edi, 1Eh
                jb      loc_1404447E5

loc_140286A90:                          ; CODE XREF: sub_140286870+1BDF79↓j
                bt      edi, 1Dh
                jb      loc_1404447EE

loc_140286A9A:                          ; CODE XREF: sub_140286870+1BDF94↓j
                bt      edi, 1Bh
                jb      loc_140444809

loc_140286AA4:                          ; CODE XREF: sub_140286870+1BDF9E↓j
                bt      edi, 1Ah
                jb      loc_140444813

loc_140286AAE:                          ; CODE XREF: sub_140286870+1BDFA8↓j
                mov     rax, 0FAFFFFFFFFFFFFFFh
                and     rbx, rax
                mov     rax, 0A00000000000000h
                or      rbx, rax
                test    rcx, rcx
                jz      loc_14044481D
                test    cs:dword_140CFC400, 2000000h
                jnz     loc_140444834

loc_140286AE1:                          ; CODE XREF: sub_140286870+1BDFBF↓j
                                        ; sub_140286870+1BDFCC↓j ...
                mov     eax, [r11+30h]
                mov     r14, r15
                mov     esi, [rsp+98h+arg_10]
                xor     r15d, r15d
                and     eax, 300000h
                mov     r13d, r15d
                cmp     eax, 300000h
                mov     ebp, edx
                mov     rdi, 0FFFFFFFFF000h
                mov     r8, 0F00000000000000h
                setz    r13b
                mov     r9, 7000000000000000h

loc_140286B23:                          ; CODE XREF: sub_140286870+39F↓j
                test    r13d, r13d
                jnz     loc_140286D29

loc_140286B2C:                          ; CODE XREF: sub_140286870+4D9↓j
                mov     rax, r12
                shl     rax, 0Ch
                xor     rax, rbx
                and     rax, rdi
                xor     rbx, rax
                test    ebp, ebp
                jnz     loc_140444850
                mov     eax, cs:dword_140CFC400
                bt      eax, 8
                jb      short loc_140286B5A
                bt      eax, 9
                jnb     loc_14044484B

loc_140286B5A:                          ; CODE XREF: sub_140286870+2DE↑j
                mov     rcx, [r14]
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rdx, r10
                cmp     r14, rdx
                jnb     loc_14044485F

loc_140286B73:                          ; CODE XREF: sub_140286870+1BDFFF↓j
                                        ; sub_140286870+1BE00A↓j ...
                test    cl, 40h
                setnz   dl
                test    bl, 40h
                setz    al
                test    al, dl
                jnz     short loc_140286B93
                test    cl, 2
                setnz   dl
                test    bl, 2
                setz    al
                test    al, dl
                jz      short loc_140286B9A

loc_140286B93:                          ; CODE XREF: sub_140286870+311↑j
                                        ; sub_140286870+332↓j
                mov     ebp, 1
                jmp     short loc_140286BA4
; ---------------------------------------------------------------------------

loc_140286B9A:                          ; CODE XREF: sub_140286870+321↑j
                test    rbx, rbx
                jns     short loc_140286BA4
                test    rcx, rcx
                jns     short loc_140286B93

loc_140286BA4:                          ; CODE XREF: sub_140286870+328↑j
                                        ; sub_140286870+32D↑j ...
                inc     r12
                cmp     esi, 1
                jbe     loc_14044490B
                mov     rdi, [r14]
                mov     rax, r10
                cmp     r14, rax
                jnb     loc_140444933

loc_140286BBF:                          ; CODE XREF: sub_140286870+1BE0D3↓j
                                        ; sub_140286870+1BE0E3↓j ...
                mov     rax, rdi
                mov     rcx, r14
                xor     rax, rbx
                and     rax, r8
                xor     rax, rbx
                xor     rdi, rax
                and     rdi, r9
                xor     rdi, rax
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_1404449E5

loc_140286BE4:                          ; CODE XREF: sub_140286870+1BE1C8↓j
                                        ; sub_140286870+1BE1D2↓j ...
                mov     [r14], rdi

loc_140286BE7:                          ; CODE XREF: sub_140286870+1BE1A9↓j
                mov     rdi, 0FFFFFFFFF000h

loc_140286BF1:                          ; CODE XREF: sub_140286870+1BE0BE↓j
                add     r14, 8
                mov     r8, 0F00000000000000h
                sub     [rsp+98h+var_60], 1
                mov     r9, 7000000000000000h
                jnz     loc_140286B23
                mov     rsi, [rsp+98h+var_58]
                mov     r15, [rsp+98h+arg_8]
                mov     r13, [rsp+98h+var_50]
                test    ebp, ebp
                jnz     short loc_140286C5D

loc_140286C2B:                          ; CODE XREF: sub_140286870+1BE1F3↓j
                mov     rbx, [rsp+98h+var_68]

loc_140286C30:                          ; CODE XREF: sub_140286870+417↓j
                cmp     rbx, 1
                jnz     short loc_140286C3C
                test    sil, 42h
                jnz     short loc_140286C89

loc_140286C3C:                          ; CODE XREF: sub_140286870+3C4↑j
                                        ; sub_140286870+421↓j ...
                add     rsp, 58h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140286C4E:                          ; CODE XREF: sub_140286870+C9↑j
                or      edi, 18h
                cmp     eax, 18h
                cmovz   edi, r8d
                jmp     loc_140286951
; ---------------------------------------------------------------------------

loc_140286C5D:                          ; CODE XREF: sub_140286870+3B9↑j
                mov     edx, [rsp+98h+arg_18]
                mov     rcx, [rsp+98h+arg_20]
                test    edx, edx
                jnz     loc_140444A5A
                mov     rbx, [rsp+98h+var_68]
                xor     r9d, r9d
                mov     r8, rbx
                mov     rdx, r13
                call    sub_1402882E0
                jmp     short loc_140286C30
; ---------------------------------------------------------------------------

loc_140286C89:                          ; CODE XREF: sub_140286870+3CA↑j
                mov     rbx, [rsp+98h+var_70]
                test    rbx, rbx
                jz      short loc_140286C3C
                mov     rax, [rsp+98h+arg_0]
                mov     eax, [rax+30h]
                and     al, 70h
                cmp     al, 40h ; '@'
                jz      loc_140444A68

loc_140286CA8:                          ; CODE XREF: sub_140286870+1BE208↓j
                xor     edi, edi
                mov     [rsp+98h+var_74], edi
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      loc_140444A7D

loc_140286CBB:                          ; CODE XREF: sub_140286870+1BE229↓j
                movzx   r9d, byte ptr [rbx+22h]
                mov     rax, rdi
                test    r9b, 10h
                jz      short loc_140286CE6

loc_140286CC9:                          ; CODE XREF: sub_140286870+4B2↓j
                                        ; sub_140286870+1BE247↓j
                mov     rcx, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rcx
                test    rax, rax
                jz      loc_140286C3C
                jmp     loc_140444ABC
; ---------------------------------------------------------------------------

loc_140286CE6:                          ; CODE XREF: sub_140286870+457↑j
                movzx   r8d, r9b
                lea     rcx, [rbx+10h]
                shr     r8b, 3
                bt      qword ptr [rcx], 0Ah
                not     r8b
                setnb   dl
                and     r8b, dl
                test    r8b, 1
                jz      short loc_140286D17
                xor     r8d, r8d
                lea     edx, [r8+1]
                call    sub_140338C90
                movzx   r9d, byte ptr [rbx+22h]

loc_140286D17:                          ; CODE XREF: sub_140286870+494↑j
                or      r9b, 10h
                mov     [rbx+22h], r9b
                test    rax, rax
                jz      short loc_140286CC9
                jmp     loc_140444A9E
; ---------------------------------------------------------------------------

loc_140286D29:                          ; CODE XREF: sub_140286870+2B6↑j
                mov     rcx, r14
                call    sub_1402805F0
                test    al, 42h
                jnz     short loc_140286D4E

loc_140286D35:                          ; CODE XREF: sub_140286870+509↓j
                mov     r9, 7000000000000000h
                mov     r8, 0F00000000000000h
                jmp     loc_140286B2C
; ---------------------------------------------------------------------------

loc_140286D4E:                          ; CODE XREF: sub_140286870+4C3↑j
                mov     rcx, r14
                call    sub_14027F590
                mov     rcx, gs:188h
                mov     rdx, rax
                mov     r8, [rsp+98h+arg_0]
                mov     rcx, [rcx+0B8h]
                call    sub_14026BA68
                mov     r13d, r15d
                jmp     short loc_140286D35
sub_140286870   endp

; ---------------------------------------------------------------------------
byte_140286D7B  db 15h dup(0CCh)        ; DATA XREF: .rdata:000000014005EBF4↑o
                                        ; .pdata:00000001400CEB50↑o

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=0AC0h

sub_140286D90   proc near               ; CODE XREF: sub_140362E04+A3↓p
                                        ; sub_14065C460+78↓p ...

var_BA0         = qword ptr -0BA0h
var_B90         = dword ptr -0B90h
var_B88         = qword ptr -0B88h
var_B80         = qword ptr -0B80h
var_B78         = qword ptr -0B78h
var_B70         = dword ptr -0B70h
var_B68         = qword ptr -0B68h
var_B60         = dword ptr -0B60h
var_B58         = qword ptr -0B58h
var_B50         = qword ptr -0B50h
var_B48         = dword ptr -0B48h
var_B40         = qword ptr -0B40h
var_B38         = qword ptr -0B38h
var_B30         = qword ptr -0B30h
var_B28         = qword ptr -0B28h
var_B20         = dword ptr -0B20h
var_B1C         = dword ptr -0B1Ch
var_B18         = qword ptr -0B18h
var_B10         = qword ptr -0B10h
var_B08         = qword ptr -0B08h
var_B00         = qword ptr -0B00h
var_AF8         = qword ptr -0AF8h
var_AF0         = qword ptr -0AF0h
var_AE8         = qword ptr -0AE8h
var_AE0         = xmmword ptr -0AE0h
var_AD0         = xmmword ptr -0AD0h
var_AC0         = xmmword ptr -0AC0h
var_AA0         = word ptr -0AA0h
var_A9E         = byte ptr -0A9Eh
var_A9A         = byte ptr -0A9Ah
var_A90         = qword ptr -0A90h
var_A88         = qword ptr -0A88h
var_A80         = qword ptr -0A80h
var_A78         = qword ptr -0A78h
var_A00         = qword ptr -0A00h
var_9F8         = qword ptr -9F8h
var_9F0         = dword ptr -9F0h
var_9EC         = word ptr -9ECh
var_9EA         = word ptr -9EAh
var_9E8         = qword ptr -9E8h
var_9E0         = qword ptr -9E0h
var_9D8         = qword ptr -9D8h
var_9D0         = xmmword ptr -9D0h
var_9C0         = xmmword ptr -9C0h
var_9B0         = xmmword ptr -9B0h
var_9A0         = xmmword ptr -9A0h
var_990         = xmmword ptr -990h
var_980         = xmmword ptr -980h
var_970         = xmmword ptr -970h
var_960         = xmmword ptr -960h
var_950         = xmmword ptr -950h
var_940         = qword ptr -940h
var_930         = dword ptr -930h
var_92C         = word ptr -92Ch
var_928         = dword ptr -928h
var_920         = qword ptr -920h
var_918         = qword ptr -918h
var_870         = dword ptr -870h
var_86C         = word ptr -86Ch
var_86A         = word ptr -86Ah
var_868         = qword ptr -868h
var_860         = qword ptr -860h
var_858         = qword ptr -858h
var_850         = byte ptr -850h
var_50          = qword ptr -50h
arg_20          = dword ptr  30h
arg_28          = qword ptr  38h

; __unwind { // __GSHandlerCheck
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-0A88h]
                sub     rsp, 0B88h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+0AC0h+var_50], rax
                mov     r15, [rbp+0AC0h+arg_28]
                mov     rbx, rcx
                mov     [rsp+0BC0h+var_B80], r8
                lea     rcx, [rbp+0AC0h+var_850]
                mov     [rbp+0AC0h+var_B28], rdx
                xor     eax, eax
                xor     r12d, r12d
                mov     [rsp+0BC0h+var_B68], r15
                xor     edx, edx
                mov     [rbp+0AC0h+var_B10], r12
                mov     r8d, 7F8h
                mov     [rbp+0AC0h+var_86A], ax
                mov     rdi, r9
                mov     [rbp+0AC0h+var_B18], r9
                call    memset
                xorps   xmm0, xmm0
                mov     [rbp+0AC0h+var_868], 100h
                mov     r11d, 1
                mov     [rbp+0AC0h+var_86C], r12w
                mov     r9d, 2
                mov     [rbp+0AC0h+var_870], r11d
                movups  [rbp+0AC0h+var_AC0], xmm0
                mov     ecx, 200h
                mov     dword ptr [rbp+0AC0h+var_AC0+8], r9d
                movups  [rbp+0AC0h+var_AD0], xmm0
                mov     [rbp+0AC0h+var_860], r12
                mov     [rbp+0AC0h+var_858], r12
                mov     [rsp+0BC0h+var_B88], r11
                mov     [rsp+0BC0h+var_B48], r12d
                call    sub_14027C6C0
                movzx   ecx, byte ptr [rdi+21h]
                mov     r14, rax
                mov     [rbp+0AC0h+var_AF0], rax
                mov     rsi, rax
                mov     eax, [rdi+1Ch]
                shl     rcx, 20h
                or      rcx, rax
                mov     r10, 0FFFFF68000000000h
                mov     rax, 0FFFFFFFFFh
                and     rcx, rax
                mov     rax, r10
                mov     edx, [rdi+34h]
                lea     r8, [rax+rcx*8]
                movzx   ecx, byte ptr [rdi+22h]
                mov     eax, edx
                btr     eax, 1Fh
                shl     rcx, 1Fh
                or      rcx, rax
                mov     [rbp+0AC0h+var_B00], r8
                mov     rax, 7FFFFFFFEh
                cmp     rcx, rax
                jnz     short loc_140286ED2
                mov     ecx, [rdi+30h]
                shr     ecx, 7
                and     ecx, 1Fh
                shl     rcx, 5
                call    sub_14027C6C0
                mov     r14, rax
                mov     [rbp+0AC0h+var_AF0], rax
                mov     rsi, rax
                jmp     short loc_140286EFE
; ---------------------------------------------------------------------------

loc_140286ED2:                          ; CODE XREF: sub_140286D90+122↑j
                test    edx, edx
                js      short loc_140286EFE
                mov     eax, [rdi+30h]
                bt      eax, 14h
                jnb     short loc_140286EEB
                bt      eax, 18h
                jb      short loc_140286EEB
                bt      eax, 19h
                jb      short loc_140286EEE

loc_140286EEB:                          ; CODE XREF: sub_140286D90+14D↑j
                                        ; sub_140286D90+153↑j
                mov     rsi, r12

loc_140286EEE:                          ; CODE XREF: sub_140286D90+159↑j
                mov     rcx, rdi
                mov     [rbp+0AC0h+var_B00], r12
                call    sub_140233020
                mov     [rsp+0BC0h+var_B48], eax

loc_140286EFE:                          ; CODE XREF: sub_140286D90+140↑j
                                        ; sub_140286D90+144↑j
                mov     edx, [rdi+30h]
                mov     ecx, edx
                and     ecx, 500000h
                mov     [rbp+0AC0h+var_AF8], r11
                mov     [rsp+0BC0h+var_B60], 3
                cmp     ecx, 500000h
                jnz     short loc_140286F5A
                shr     rdx, 12h
                lea     rax, cs:140000000h
                and     edx, 3
                mov     r9d, 10h
                mov     r8, ds:rva qword_14002DE90[rax+rdx*8]
                mov     ecx, ds:rva dword_14002DE50[rax+rdx*4]
                cmp     r8, r9
                mov     [rsp+0BC0h+var_B88], r8
                cmovnz  r9, r11
                mov     [rsp+0BC0h+var_B60], ecx
                mov     [rbp+0AC0h+var_AF8], r9
                mov     r9d, 2

loc_140286F5A:                          ; CODE XREF: sub_140286D90+18B↑j
                cmp     [rbp+0AC0h+arg_20], r12d
                mov     eax, r9d
                mov     r13, rbx
                mov     [rsp+0BC0h+var_B50], r12
                cmovnz  eax, r12d
                mov     rdx, 7FFFFFFFF8h
                shr     r13, 9
                mov     rdi, r12
                and     r13, rdx
                mov     [rbp+0AC0h+var_B20], eax
                mov     rax, r10
                add     r13, rax
                mov     [rsp+0BC0h+var_B70], r11d
                mov     rax, cs:qword_140C4E4C8
                and     rbx, 0FFFFFFFFFFFFF000h
                mov     [rsp+0BC0h+var_B58], rbx
                mov     r10d, r11d
                mov     rbx, [rsp+0BC0h+var_B80]
                add     rbx, 680h
                mov     [rsp+0BC0h+var_B90], r12d
                mov     [rsp+0BC0h+var_B78], rbx
                movzx   ecx, word ptr [rbx+0AEh]
                mov     rax, [rax+rcx*8]
                mov     [rbp+0AC0h+var_B38], rax
                movzx   eax, byte ptr [rbx+0B8h]
                and     al, 7
                cmp     al, 6
                jb      short loc_140287029
                mov     rcx, cr8
                mov     [rbp+0AC0h+var_B30], rcx
                mov     cr8, r9
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140287063
                test    r10b, al
                jz      short loc_140287063
                cmp     cl, 0Fh
                ja      short loc_140287063
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, cl
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d
                jmp     short loc_140287063
; ---------------------------------------------------------------------------

loc_140287029:                          ; CODE XREF: sub_140286D90+248↑j
                cmp     al, 2
                jnz     short loc_140287036
                lea     rbx, unk_140C4F600
                jmp     short loc_14028703D
; ---------------------------------------------------------------------------

loc_140287036:                          ; CODE XREF: sub_140286D90+29B↑j
                add     rbx, 0C0h

loc_14028703D:                          ; CODE XREF: sub_140286D90+2A4↑j
                mov     rcx, rbx
                call    ExAcquireSpinLockShared
                cmp     [rbx+4], r12d
                jz      short loc_140287050
                xor     ecx, ecx
                xchg    ecx, [rbx+4]

loc_140287050:                          ; CODE XREF: sub_140286D90+2B9↑j
                mov     r10d, [rsp+0BC0h+var_B70]
                mov     r11d, 1
                mov     rbx, [rsp+0BC0h+var_B78]
                mov     byte ptr [rbp+0AC0h+var_B30], al

loc_140287063:                          ; CODE XREF: sub_140286D90+25E↑j
                                        ; sub_140286D90+263↑j ...
                cmp     r13, [rbp+0AC0h+var_B28]
                ja      loc_140287ECC
                nop     dword ptr [rax]

loc_140287070:                          ; CODE XREF: sub_140286D90+111A↓j
                xor     edx, edx
                mov     rdi, r13
                cmp     r10d, 1
                jnz     loc_14028715E
                mov     edx, r11d

loc_140287082:                          ; CODE XREF: sub_140286D90+3D5↓j
                mov     r9, 7FFFFFFFF8h
                mov     r8, 0FFFFF68000000000h

loc_140287096:                          ; CODE XREF: sub_140286D90+413↓j
                test    rdi, 0FFFh
                jz      short loc_1402870A7
                test    edx, edx
                jz      loc_140287464

loc_1402870A7:                          ; CODE XREF: sub_140286D90+30D↑j
                xor     edx, edx
                lea     rcx, [rbp+0AC0h+var_930]
                mov     r8d, 0B8h
                call    memset
                mov     rdx, qword ptr [rbp+0AC0h+var_AD0+8]
                mov     eax, 1
                test    rdx, rdx
                jz      loc_1402871A8
                xor     edi, edi
                mov     [rbp+0AC0h+var_930], eax
                mov     [rbp+0AC0h+var_920], rdi
                mov     [rbp+0AC0h+var_918], rdi
                mov     [rbp+0AC0h+var_92C], 0
                mov     [rbp+0AC0h+var_928], 14h
                shl     rdx, 19h
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                mov     r8, qword ptr [rbp+0AC0h+var_AC0]
                lea     rcx, [rbp+0AC0h+var_930]
                shl     rax, 19h
                xor     r9d, r9d
                sub     rdx, rax
                sar     rdx, 10h
                call    sub_1402882E0
                lea     rcx, [rbp+0AC0h+var_AD0]
                call    sub_14028E340
                mov     dword ptr [rsp+0BC0h+var_BA0], edi
                lea     rcx, [rbp+0AC0h+var_930]
                mov     rdi, [rsp+0BC0h+var_B80]
                mov     r9, r15
                mov     rdx, rdi
                mov     r8, rsi
                call    sub_14028F360
                test    eax, eax
                mov     eax, 1
                cmovnz  r12d, eax
                mov     [rsp+0BC0h+var_B90], r12d
                jmp     short loc_1402871AD
; ---------------------------------------------------------------------------

loc_14028715E:                          ; CODE XREF: sub_140286D90+2E9↑j
                mov     ecx, [rsp+0BC0h+var_B60]
                cmp     ecx, 1
                ja      loc_140287082
                mov     eax, 2
                mov     r8, 0FFFFF68000000000h
                sub     eax, ecx
                mov     r9, 7FFFFFFFF8h
                mov     ecx, eax
                nop     dword ptr [rax+rax+00000000h]

loc_140287190:                          ; CODE XREF: sub_140286D90+411↓j
                shr     rdi, 9
                and     rdi, r9
                mov     rax, r8
                add     rdi, rax
                sub     rcx, 1
                jnz     short loc_140287190
                jmp     loc_140287096
; ---------------------------------------------------------------------------

loc_1402871A8:                          ; CODE XREF: sub_140286D90+337↑j
                mov     rdi, [rsp+0BC0h+var_B80]

loc_1402871AD:                          ; CODE XREF: sub_140286D90+3CC↑j
                cmp     dword ptr [rbp+0AC0h+var_868+4], 0
                jz      short loc_1402871DF
                mov     r9, r15
                mov     dword ptr [rsp+0BC0h+var_BA0], eax
                mov     r8, rsi
                lea     rcx, [rbp+0AC0h+var_870]
                mov     rdx, rdi
                call    sub_14028F360
                test    eax, eax
                mov     eax, 1
                cmovnz  r12d, eax
                mov     [rsp+0BC0h+var_B90], r12d

loc_1402871DF:                          ; CODE XREF: sub_140286D90+424↑j
                mov     rax, [rsp+0BC0h+var_B50]
                test    rax, rax
                jz      short loc_1402871FD
                mov     rdx, rax
                mov     rcx, rbx
                call    sub_140312B40
                mov     [rsp+0BC0h+var_B50], 0

loc_1402871FD:                          ; CODE XREF: sub_140286D90+457↑j
                cmp     [rsp+0BC0h+var_B48], 0
                jz      loc_1402873CA
                xorps   xmm0, xmm0
                lea     rcx, [rbp+0AC0h+var_A9E]
                xor     edx, edx
                mov     r8d, 0AEh
                movups  [rbp+0AC0h+var_AE0], xmm0
                call    memset
                mov     rax, 0FFFFF68000000000h
                mov     r15, rax
                mov     rdi, [rbp+0AC0h+var_B28]
                mov     eax, 861h
                shl     r15, 19h
                mov     r9, r13
                shl     r9, 19h
                shl     rdi, 19h
                sub     r9, r15
                sar     r9, 10h
                sub     rdi, r15
                mov     rcx, r9
                mov     [rsp+0BC0h+var_B58], r9
                sar     rdi, 10h
                mov     [rbp+0AC0h+var_AA0], ax
                call    sub_14027F590
                mov     rcx, 0FFFF800000000000h
                cmp     rax, rcx
                jb      short loc_140287294
                cmp     rax, cs:qword_140C4F9B8
                jb      short loc_140287285
                cmp     rax, cs:qword_140C4E1E8
                jbe     short loc_140287294

loc_140287285:                          ; CODE XREF: sub_140286D90+4EA↑j
                mov     ecx, 1
                call    sub_1402A46FC
                mov     rbx, rax
                jmp     short loc_1402872AB
; ---------------------------------------------------------------------------

loc_140287294:                          ; CODE XREF: sub_140286D90+4E1↑j
                                        ; sub_140286D90+4F3↑j
                mov     rax, gs:188h
                mov     rbx, [rax+0B8h]
                add     rbx, 680h

loc_1402872AB:                          ; CODE XREF: sub_140286D90+502↑j
                xor     r8d, r8d
                mov     rdx, r9
                mov     rcx, rbx
                call    sub_1402258A0
                test    eax, eax
                jz      short loc_1402872EF
                mov     rbx, [rsp+0BC0h+var_B58]
                lea     ecx, [rax-1]
                shr     rbx, 9
                mov     r9, 7FFFFFFFF8h
                and     rbx, r9
                mov     dword ptr [rbp+0AC0h+var_AE0], ecx
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                add     rbx, rax
                mov     qword ptr [rbp+0AC0h+var_AE0+8], rbx
                jmp     short loc_14028735C
; ---------------------------------------------------------------------------

loc_1402872EF:                          ; CODE XREF: sub_140286D90+52B↑j
                or      [rbp+0AC0h+var_AA0], 4
                lea     rax, [rbp+0AC0h+var_AE0]
                mov     [rbp+0AC0h+var_9F8], rax
                lea     rcx, [rbp+0AC0h+var_AA0]
                movzx   eax, [rbp+0AC0h+var_A9E]
                and     al, 0E7h
                mov     [rbp+0AC0h+var_A90], 0
                or      al, 4
                mov     [rbp+0AC0h+var_A88], rbx
                mov     [rbp+0AC0h+var_A9E], al
                lea     rax, sub_14034E280
                mov     [rbp+0AC0h+var_A00], rax
                mov     rax, [rbp+0AC0h+var_B30]
                mov     [rbp+0AC0h+var_A9A], al
                mov     rax, [rsp+0BC0h+var_B58]
                mov     [rbp+0AC0h+var_A80], rax
                mov     [rbp+0AC0h+var_A78], rdi
                call    sub_140220490
                mov     ecx, dword ptr [rbp+0AC0h+var_AE0]
                mov     r9, 7FFFFFFFF8h
                mov     rbx, qword ptr [rbp+0AC0h+var_AE0+8]
                mov     r8, 0FFFFF68000000000h

loc_14028735C:                          ; CODE XREF: sub_140286D90+55D↑j
                mov     rdi, [rsp+0BC0h+var_B68]
                mov     rdx, [rdi+18h]
                test    rbx, rbx
                jz      loc_140287EAF
                mov     rax, rbx
                sub     rax, r13
                mov     r13, rbx
                sar     rax, 3
                add     rax, rdx
                mov     [rdi+18h], rax
                mov     rdi, rbx
                test    ecx, ecx
                jz      short loc_1402873B3
                shr     rdi, 9
                and     rdi, r9
                mov     rax, r8
                add     rdi, rax
                cmp     ecx, 1
                jbe     short loc_1402873B3
                dec     ecx
                nop     dword ptr [rax]

loc_1402873A0:                          ; CODE XREF: sub_140286D90+621↓j
                shr     rdi, 9
                and     rdi, r9
                mov     rax, r8
                add     rdi, rax
                sub     rcx, 1
                jnz     short loc_1402873A0

loc_1402873B3:                          ; CODE XREF: sub_140286D90+5F7↑j
                                        ; sub_140286D90+609↑j
                shl     rbx, 19h
                sub     rbx, r15
                mov     r15, [rsp+0BC0h+var_B68]
                sar     rbx, 10h
                mov     [rsp+0BC0h+var_B58], rbx
                jmp     short loc_140287431
; ---------------------------------------------------------------------------

loc_1402873CA:                          ; CODE XREF: sub_140286D90+472↑j
                mov     ecx, [rsp+0BC0h+var_B60]
                mov     rdi, r13
                cmp     ecx, 1
                ja      short loc_14028740B
                mov     eax, 2
                mov     r15, 0FFFFF68000000000h
                sub     eax, ecx
                mov     rdx, 7FFFFFFFF8h
                mov     ecx, eax

loc_1402873F3:                          ; CODE XREF: sub_140286D90+674↓j
                shr     rdi, 9
                and     rdi, rdx
                mov     rax, r15
                add     rdi, rax
                sub     rcx, 1
                jnz     short loc_1402873F3
                mov     r15, [rsp+0BC0h+var_B68]

loc_14028740B:                          ; CODE XREF: sub_140286D90+644↑j
                mov     rax, [rbp+0AC0h+var_B18]
                xor     edx, edx
                movzx   r9d, byte ptr [rbp+0AC0h+var_B30]
                mov     rcx, rdi
                mov     r8d, [rax+30h]
                mov     eax, [rbp+0AC0h+var_B20]
                shr     r8d, 0Ch
                and     r8d, 3Fh
                mov     dword ptr [rsp+0BC0h+var_BA0], eax
                call    sub_1402A73A0

loc_140287431:                          ; CODE XREF: sub_140286D90+638↑j
                mov     r10, rdi
                mov     r8, 0FFFFF68000000000h
                shr     r10, 9
                mov     r9, 7FFFFFFFF8h
                and     r10, r9
                mov     rax, r8
                add     r10, rax
                mov     [rsp+0BC0h+var_B50], r10
                xor     r10d, r10d
                mov     [rsp+0BC0h+var_B70], r10d
                jmp     short loc_140287467
; ---------------------------------------------------------------------------

loc_140287464:                          ; CODE XREF: sub_140286D90+311↑j
                xor     r10d, r10d

loc_140287467:                          ; CODE XREF: sub_140286D90+6D2↑j
                mov     rbx, [rdi]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                mov     r11, 0FFFFF6FB7DBED7F8h
                cmp     rdi, rax
                jb      short loc_1402874EE
                mov     rax, r11
                cmp     rdi, rax
                ja      short loc_1402874EE
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402874EE
                test    bl, 1
                jz      short loc_1402874EE
                test    bl, 20h
                jz      short loc_1402874A6
                test    bl, 42h
                jnz     short loc_1402874EE

loc_1402874A6:                          ; CODE XREF: sub_140286D90+70F↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_1402874EE
                mov     rax, rdi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_1402874EE
                or      rbx, 42h

loc_1402874EE:                          ; CODE XREF: sub_140286D90+6F4↑j
                                        ; sub_140286D90+6FC↑j ...
                mov     [rbp+0AC0h+var_AE8], rbx
                test    rbx, rbx
                jnz     loc_140287649
                cmp     r13, [rbp+0AC0h+var_B00]
                jbe     short loc_14028750A
                mov     rax, [rsp+0BC0h+var_B88]
                add     [r15+18h], rax

loc_14028750A:                          ; CODE XREF: sub_140286D90+76F↑j
                test    rsi, rsi
                jz      loc_1402875C0
                mov     rcx, rdi
                shl     rcx, 19h
                mov     rax, r8
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                call    sub_14029BB60
                mov     rbx, [rbp+0AC0h+var_AF8]
                mov     rcx, rax
                mov     edx, ebx
                call    sub_14029DD54
                mov     r15, rbx
                mov     r14, 8000000000000000h
                nop     dword ptr [rax+rax+00000000h]

loc_140287550:                          ; CODE XREF: sub_140286D90+82A↓j
                mov     rcx, rdi
                mov     rbx, rsi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_1402875AF
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028758A
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14028757A
                test    sil, 1
                jz      short loc_14028757A
                or      rbx, r14

loc_14028757A:                          ; CODE XREF: sub_140286D90+7DF↑j
                                        ; sub_140286D90+7E5↑j
                mov     rdx, rbx
                mov     [rdi], rbx
                mov     rcx, rdi
                call    sub_140349620
                jmp     short loc_1402875B2
; ---------------------------------------------------------------------------

loc_14028758A:                          ; CODE XREF: sub_140286D90+7D6↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_1402875AF
                test    sil, 1
                jz      short loc_1402875AF
                or      rbx, r14

loc_1402875AF:                          ; CODE XREF: sub_140286D90+7CD↑j
                                        ; sub_140286D90+814↑j ...
                mov     [rdi], rbx

loc_1402875B2:                          ; CODE XREF: sub_140286D90+7F8↑j
                add     rdi, 8
                sub     r15, 1
                jnz     short loc_140287550
                mov     r14, [rbp+0AC0h+var_AF0]

loc_1402875C0:                          ; CODE XREF: sub_140286D90+77D↑j
                                        ; sub_140286D90+A45↓j
                mov     rax, [rsp+0BC0h+var_B88]

loc_1402875C5:                          ; CODE XREF: sub_140286D90+D75↓j
                mov     ebx, 1

loc_1402875CA:                          ; CODE XREF: sub_140286D90+D4D↓j
                                        ; sub_140286D90+D5A↓j ...
                lea     r13, [r13+rax*8+0]
                test    r13b, 78h
                jnz     short loc_140287602
                mov     r15, [rsp+0BC0h+var_B78]
                movzx   eax, byte ptr [r15+0B8h]
                and     al, 7
                cmp     al, 2
                lea     rax, unk_140C4F600
                jz      short loc_1402875F6
                lea     rax, [r15+0C0h]

loc_1402875F6:                          ; CODE XREF: sub_140286D90+85D↑j
                mov     eax, [rax]
                bt      eax, 1Eh
                jb      loc_140287DE6

loc_140287602:                          ; CODE XREF: sub_140286D90+843↑j
                mov     rcx, gs:20h
                mov     r8d, [rcx+312Ch]
                mov     edi, [rcx+7BECh]
                mov     r15d, [rcx+7E9Ch]
                test    r8b, 1
                jz      loc_140287D4C
                mov     edx, ebx
                cmp     r15d, 7
                jbe     loc_140287D81
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jz      loc_140287D8E
                jmp     loc_140287DC1
; ---------------------------------------------------------------------------

loc_140287649:                          ; CODE XREF: sub_140286D90+765↑j
                test    bl, 1
                jz      loc_140287824
                cmp     [rsp+0BC0h+var_B88], 1
                jz      short loc_140287682

loc_14028765A:                          ; CODE XREF: sub_140286D90+BAF↓j
                mov     rcx, [rbp+0AC0h+var_B18]
                lea     rax, [rbp+0AC0h+var_870]
                mov     r9, r15
                mov     [rsp+0BC0h+var_BA0], rax
                mov     r8, rsi
                mov     rdx, rdi
                call    sub_14053CDB0
                mov     ebx, 1
                jmp     loc_140287AD6
; ---------------------------------------------------------------------------

loc_140287682:                          ; CODE XREF: sub_140286D90+8C8↑j
                mov     rdi, [rsp+0BC0h+var_B58]
                mov     rcx, rdi
                mov     [rbp+0AC0h+var_B1C], r10d
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                mov     rdx, [rcx+rax]
                lea     r8, [rcx+rax]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r8, rax
                jb      short loc_140287719
                mov     rax, r11
                cmp     r8, rax
                ja      short loc_140287719
                call    sub_140349680
                test    eax, eax
                jz      short loc_140287719
                test    dl, 1
                jz      short loc_140287719
                test    dl, 20h
                jz      short loc_1402876D2
                test    dl, 42h
                jnz     short loc_140287719

loc_1402876D2:                          ; CODE XREF: sub_140286D90+93B↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140287719
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140287719
                or      rdx, 42h

loc_140287719:                          ; CODE XREF: sub_140286D90+920↑j
                                        ; sub_140286D90+928↑j ...
                shr     rdx, 38h
                and     dl, 0Fh
                cmp     dl, 8
                jz      short loc_14028773E
                mov     rdx, [rsp+0BC0h+var_B78]
                lea     rcx, [rbp+0AC0h+var_AD0]
                mov     r8, r13
                call    sub_140288040
                test    eax, eax
                jnz     loc_1402877C7

loc_14028773E:                          ; CODE XREF: sub_140286D90+993↑j
                mov     rcx, [rsp+0BC0h+var_B78]
                lea     r9, [rbp+0AC0h+var_B1C]
                xor     r8d, r8d
                mov     rdx, rdi
                call    sub_140289320
                xor     r9d, r9d
                lea     rcx, [rbp+0AC0h+var_870]
                mov     rdx, rdi
                lea     r8d, [r9+1]
                call    sub_1402882E0
                and     rbx, 0FFFFFFFFFFFFFFFEh
                mov     rax, 0FFFFF6FB7DBED000h
                bts     rbx, 0Ah
                mov     [rbp+0AC0h+var_AE8], rbx
                mov     rax, rax
                cmp     r13, rax
                jb      short loc_1402877C3
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r13, rax
                ja      short loc_1402877C3
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402877BA
                cmp     byte ptr cs:word_140C4DE88+1, 0
                mov     rcx, r13
                mov     rdx, rbx
                mov     [r13+0], rbx
                call    sub_140349620
                jmp     short loc_1402877C7
; ---------------------------------------------------------------------------

loc_1402877BA:                          ; CODE XREF: sub_140286D90+A10↑j
                mov     rax, gs:188h

loc_1402877C3:                          ; CODE XREF: sub_140286D90+9F5↑j
                                        ; sub_140286D90+A07↑j
                mov     [r13+0], rbx

loc_1402877C7:                          ; CODE XREF: sub_140286D90+9A8↑j
                                        ; sub_140286D90+A28↑j
                mov     eax, dword ptr [rbp+0AC0h+var_868]
                dec     eax
                cmp     dword ptr [rbp+0AC0h+var_868+4], eax
                jnz     loc_1402875C0
                mov     rdx, [rsp+0BC0h+var_B80]
                lea     rcx, [rbp+0AC0h+var_AD0]
                mov     r9, r15
                mov     r8, rsi
                call    sub_140354078
                mov     rdx, [rsp+0BC0h+var_B80]
                lea     rcx, [rbp+0AC0h+var_870]
                test    eax, eax
                mov     r9, r15
                mov     eax, 1
                mov     r8, rsi
                cmovnz  r12d, eax
                mov     dword ptr [rsp+0BC0h+var_BA0], eax
                mov     [rsp+0BC0h+var_B90], r12d
                call    sub_14028F360
                mov     ebx, 1
                jmp     loc_140287AD6
; ---------------------------------------------------------------------------

loc_140287824:                          ; CODE XREF: sub_140286D90+8BC↑j
                bt      rbx, 0Ah
                jnb     loc_14028792E
                mov     rax, cs:qword_140C4DDC0
                mov     r9, rbx
                test    rax, rax
                jz      short loc_14028784C
                test    bl, 10h
                jnz     short loc_14028784C
                mov     r9, rax
                not     r9
                and     r9, rbx

loc_14028784C:                          ; CODE XREF: sub_140286D90+AAC↑j
                                        ; sub_140286D90+AB1↑j
                mov     rcx, rbx
                sar     r9, 10h
                call    sub_14031C5E8
                test    al, al
                jz      short loc_14028786B
                mov     rcx, [rsp+0BC0h+var_B78]
                mov     rdx, r9
                call    sub_140366EF4
                jmp     short loc_140287894
; ---------------------------------------------------------------------------

loc_14028786B:                          ; CODE XREF: sub_140286D90+ACA↑j
                mov     rcx, rbx
                call    sub_14031C870
                test    eax, eax
                jnz     short loc_1402878A8
                mov     rcx, [rsp+0BC0h+var_B80]
                mov     rdx, r9
                call    sub_1402C6E74
                test    rax, rax
                jz      short loc_1402878A8
                mov     r8, rcx
                mov     rcx, rax
                call    sub_14055A088

loc_140287894:                          ; CODE XREF: sub_140286D90+AD9↑j
                cmp     eax, 3
                jnz     short loc_14028789F
                inc     qword ptr [r15+8]
                jmp     short loc_1402878A8
; ---------------------------------------------------------------------------

loc_14028789F:                          ; CODE XREF: sub_140286D90+B07↑j
                cmp     eax, 5
                jnz     short loc_1402878A8
                inc     qword ptr [r15+10h]

loc_1402878A8:                          ; CODE XREF: sub_140286D90+AE5↑j
                                        ; sub_140286D90+AF7↑j ...
                mov     rcx, r13
                mov     rbx, rsi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_140287922
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402878F3
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_1402878DC
                test    sil, 1
                jz      short loc_1402878DC
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_1402878DC:                          ; CODE XREF: sub_140286D90+B37↑j
                                        ; sub_140286D90+B3D↑j
                mov     rdx, rbx
                mov     [r13+0], rbx
                mov     rcx, r13
                call    sub_140349620
                test    rsi, rsi
                jmp     loc_140287AC1
; ---------------------------------------------------------------------------

loc_1402878F3:                          ; CODE XREF: sub_140286D90+B2E↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140287922
                test    sil, 1
                jz      short loc_140287922
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_140287922:                          ; CODE XREF: sub_140286D90+B25↑j
                                        ; sub_140286D90+B7D↑j ...
                mov     [r13+0], rbx
                test    rsi, rsi
                jmp     loc_140287AC1
; ---------------------------------------------------------------------------

loc_14028792E:                          ; CODE XREF: sub_140286D90+A99↑j
                bt      rbx, 0Bh
                jnb     loc_140287AEF
                cmp     [rsp+0BC0h+var_B88], 1
                jnz     loc_14028765A
                xor     edx, edx
                mov     [rbp+0AC0h+var_B10], r10
                mov     rcx, r13
                mov     rdi, r10
                call    sub_1402A886C
                mov     r10, rax
                test    rax, rax
                jz      loc_140287E8F
                xor     ebx, ebx
                lea     r15d, [rbx+1]
                cmp     [rax+20h], bx
                jnz     short loc_1402879B1
                mov     rdi, [rax+10h]
                mov     rcx, [rax+28h]
                mov     rbx, rdi
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     [rbp+0AC0h+var_B10], rdi
                mov     rcx, [rax+rcx*8]
                movzx   eax, dil
                shr     al, 1
                mov     [rbp+0AC0h+var_B38], rcx
                test    r15b, al
                jz      short loc_1402879B1
                lea     rdx, [rbp+0AC0h+var_B10]
                call    sub_140340134
                test    eax, eax
                jnz     short loc_1402879B1
                xor     r15d, r15d

loc_1402879B1:                          ; CODE XREF: sub_140286D90+BDC↑j
                                        ; sub_140286D90+C0F↑j ...
                xor     r9d, r9d
                mov     r8b, 11h
                mov     rdx, r10
                mov     rcx, r13
                call    sub_140296370
                cmp     eax, 3
                jnz     short loc_1402879D0
                mov     rax, [rsp+0BC0h+var_B68]
                inc     qword ptr [rax+8]

loc_1402879D0:                          ; CODE XREF: sub_140286D90+C35↑j
                test    rbx, rbx
                jz      short loc_1402879E4
                mov     rcx, [rbp+0AC0h+var_B38]
                mov     r8d, r15d
                mov     rdx, rdi
                call    sub_1402D9B64

loc_1402879E4:                          ; CODE XREF: sub_140286D90+C43↑j
                mov     rcx, [rsp+0BC0h+var_B80]
                mov     rax, 0FFFFFFFFFFFFFFFFh
                lock xadd [rcx+4F8h], rax
                mov     rdi, rsi
                test    r15d, r15d
                jnz     short loc_140287A46
                mov     rcx, [rbp+0AC0h+var_B38]
                mov     rax, rbx
                shr     rax, 0Ch
                and     eax, 0Fh
                mov     rdx, [rcx+rax*8+1B20h]
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_140287A2E
                test    bl, 10h
                jnz     short loc_140287A2E
                not     rax
                and     rbx, rax

loc_140287A2E:                          ; CODE XREF: sub_140286D90+C91↑j
                                        ; sub_140286D90+C96↑j
                shr     rbx, 20h
                mov     r9d, 2
                mov     r8d, ebx
                mov     rcx, r14
                call    sub_1402CB2D4
                mov     rdi, rax

loc_140287A46:                          ; CODE XREF: sub_140286D90+C6F↑j
                mov     rcx, r13
                mov     rbx, rdi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_140287ABA
                call    sub_140349680
                test    eax, eax
                jz      short loc_140287A8B
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140287A7A
                test    dil, 1
                jz      short loc_140287A7A
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_140287A7A:                          ; CODE XREF: sub_140286D90+CD5↑j
                                        ; sub_140286D90+CDB↑j
                mov     rdx, rbx
                mov     [r13+0], rbx
                mov     rcx, r13
                call    sub_140349620
                jmp     short loc_140287ABE
; ---------------------------------------------------------------------------

loc_140287A8B:                          ; CODE XREF: sub_140286D90+CCC↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140287ABA
                test    dil, 1
                jz      short loc_140287ABA
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_140287ABA:                          ; CODE XREF: sub_140286D90+CC3↑j
                                        ; sub_140286D90+D15↑j ...
                mov     [r13+0], rbx

loc_140287ABE:                          ; CODE XREF: sub_140286D90+CF9↑j
                test    rdi, rdi

loc_140287AC1:                          ; CODE XREF: sub_140286D90+B5E↑j
                                        ; sub_140286D90+B99↑j
                mov     ebx, 1
                jnz     loc_140287D42
                mov     edx, ebx
                mov     rcx, r13
                call    sub_1403F3EF0

loc_140287AD6:                          ; CODE XREF: sub_140286D90+8ED↑j
                                        ; sub_140286D90+A8F↑j
                test    eax, eax
                mov     rax, [rsp+0BC0h+var_B88]
                jz      loc_1402875CA
                mov     r12d, ebx
                mov     [rsp+0BC0h+var_B90], ebx
                jmp     loc_1402875CA
; ---------------------------------------------------------------------------

loc_140287AEF:                          ; CODE XREF: sub_140286D90+BA3↑j
                mov     rax, rbx
                shr     rax, 5
                and     al, 1Fh
                cmp     al, 10h
                jnz     short loc_140287B0A
                mov     rax, [rsp+0BC0h+var_B88]
                add     [r15+18h], rax
                jmp     loc_1402875C5
; ---------------------------------------------------------------------------

loc_140287B0A:                          ; CODE XREF: sub_140286D90+D6A↑j
                mov     rcx, cs:qword_140C4DDC0
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_140287B27
                test    bl, 10h
                jnz     short loc_140287B27
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_140287B27:                          ; CODE XREF: sub_140286D90+D87↑j
                                        ; sub_140286D90+D8C↑j
                bt      rax, 0Ah
                jb      short loc_140287B39
                bt      rax, 0Bh
                jb      short loc_140287B39
                test    al, 4
                jz      short loc_140287B4E

loc_140287B39:                          ; CODE XREF: sub_140286D90+D9C↑j
                                        ; sub_140286D90+DA3↑j
                mov     rcx, [rsp+0BC0h+var_B80]
                mov     rax, 0FFFFFFFFFFFFFFFFh
                lock xadd [rcx+4F8h], rax

loc_140287B4E:                          ; CODE XREF: sub_140286D90+DA7↑j
                mov     rax, [rsp+0BC0h+var_B78]
                mov     r15, rbx
                mov     r12d, 1
                shr     r15, 1
                mov     rdi, rsi
                movzx   ecx, word ptr [rax+0AEh]
                mov     rax, cs:qword_140C4E4C8
                mov     r9, [rax+rcx*8]
                mov     [rbp+0AC0h+var_B38], r9
                and     r15d, r12d
                jz      loc_140287C33
                lea     rdx, [rbp+0AC0h+var_AE8]
                mov     rcx, r9
                call    sub_140340134
                test    eax, eax
                jnz     loc_140287C33
                mov     rax, rbx
                mov     r12d, r10d
                shr     rax, 0Ch
                mov     r10, rbx
                and     eax, 0Fh
                mov     r11, [r9+rax*8+1B20h]
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_140287BC7
                test    bl, 10h
                jnz     short loc_140287BC7
                mov     r10, rax
                not     r10
                and     r10, rbx

loc_140287BC7:                          ; CODE XREF: sub_140286D90+E27↑j
                                        ; sub_140286D90+E2C↑j
                xor     edx, edx
                shr     r10, 20h
                lea     rcx, [rbp+0AC0h+var_B40]
                mov     [rbp+0AC0h+var_B40], r14
                call    sub_1402C75A0
                mov     rdi, [rbp+0AC0h+var_B40]
                bt      r14, 0Ah
                jb      short loc_140287BED
                and     rdi, 0FFFFFFFFFFFFFFF9h
                mov     [rbp+0AC0h+var_B40], rdi

loc_140287BED:                          ; CODE XREF: sub_140286D90+E53↑j
                test    r11, r11
                jz      short loc_140287C33
                movzx   r8d, word ptr [r11+0CCh]
                test    rdi, rdi
                jnz     short loc_140287C0D
                shl     r10, 20h
                mov     rcx, r10
                call    sub_14027C6C0
                jmp     short loc_140287C18
; ---------------------------------------------------------------------------

loc_140287C0D:                          ; CODE XREF: sub_140286D90+E6D↑j
                mov     rdx, r10
                mov     rcx, rdi
                call    sub_1402C98B0

loc_140287C18:                          ; CODE XREF: sub_140286D90+E7B↑j
                mov     rdi, r8
                shl     rdi, 0Ch
                xor     rdi, rax
                and     edi, 0F000h
                xor     rdi, rax
                or      rdi, 2
                mov     [rbp+0AC0h+var_B40], rdi

loc_140287C33:                          ; CODE XREF: sub_140286D90+DEB↑j
                                        ; sub_140286D90+DFF↑j ...
                mov     rdx, rdi
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     r13, rax
                jb      short loc_140287CBC
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r13, rax
                ja      short loc_140287CBC
                call    sub_140349680
                test    eax, eax
                jz      short loc_140287C8D
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140287C7F
                test    dil, 1
                jz      short loc_140287C7F
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_140287C7F:                          ; CODE XREF: sub_140286D90+EDA↑j
                                        ; sub_140286D90+EE0↑j
                mov     rcx, r13
                mov     [r13+0], rdx
                call    sub_140349620
                jmp     short loc_140287CC0
; ---------------------------------------------------------------------------

loc_140287C8D:                          ; CODE XREF: sub_140286D90+ED1↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140287CBC
                test    dil, 1
                jz      short loc_140287CBC
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_140287CBC:                          ; CODE XREF: sub_140286D90+EB6↑j
                                        ; sub_140286D90+EC8↑j ...
                mov     [r13+0], rdx

loc_140287CC0:                          ; CODE XREF: sub_140286D90+EFB↑j
                mov     [rbp+0AC0h+var_B08], rbx
                shr     bl, 2
                test    bl, 1
                jz      short loc_140287CE0
                lea     rcx, [rbp+0AC0h+var_B08]
                call    sub_1402805F0
                test    r12d, r12d
                jnz     short loc_140287CF7
                and     rax, 0FFFFFFFFFFFFFFFDh
                jmp     short loc_140287CF7
; ---------------------------------------------------------------------------

loc_140287CE0:                          ; CODE XREF: sub_140286D90+F3A↑j
                test    r12d, r12d
                jz      short loc_140287CF5
                test    r15d, r15d
                jz      short loc_140287CF5
                lea     rcx, [rbp+0AC0h+var_B08]
                call    sub_1402805F0
                jmp     short loc_140287CF7
; ---------------------------------------------------------------------------

loc_140287CF5:                          ; CODE XREF: sub_140286D90+F53↑j
                                        ; sub_140286D90+F58↑j
                xor     eax, eax

loc_140287CF7:                          ; CODE XREF: sub_140286D90+F48↑j
                                        ; sub_140286D90+F4E↑j ...
                mov     [rbp+0AC0h+var_B08], rax
                test    rax, rax
                jz      short loc_140287D0F
                mov     rcx, [rbp+0AC0h+var_B38]
                xor     r8d, r8d
                mov     rdx, rax
                call    sub_14020B2C0

loc_140287D0F:                          ; CODE XREF: sub_140286D90+F6E↑j
                mov     ebx, 1
                test    rdi, rdi
                jnz     short loc_140287D3D
                mov     edx, ebx
                mov     rcx, r13
                call    sub_1403F3EF0
                mov     r12d, [rsp+0BC0h+var_B90]
                test    eax, eax
                mov     rax, [rsp+0BC0h+var_B88]
                cmovnz  r12d, ebx
                mov     [rsp+0BC0h+var_B90], r12d
                jmp     loc_1402875CA
; ---------------------------------------------------------------------------

loc_140287D3D:                          ; CODE XREF: sub_140286D90+F87↑j
                mov     r12d, [rsp+0BC0h+var_B90]

loc_140287D42:                          ; CODE XREF: sub_140286D90+D36↑j
                mov     rax, [rsp+0BC0h+var_B88]
                jmp     loc_1402875CA
; ---------------------------------------------------------------------------

loc_140287D4C:                          ; CODE XREF: sub_140286D90+893↑j
                xor     edx, edx
                test    r8b, 1Eh
                jz      short loc_140287D59
                lea     ebx, [rdx+2]
                jmp     short loc_140287DC1
; ---------------------------------------------------------------------------

loc_140287D59:                          ; CODE XREF: sub_140286D90+FC2↑j
                movzx   eax, byte ptr [rcx+3129h]
                test    al, al
                jz      short loc_140287D6B
                mov     ebx, 3
                jmp     short loc_140287DC1
; ---------------------------------------------------------------------------

loc_140287D6B:                          ; CODE XREF: sub_140286D90+FD2↑j
                mov     rax, [rcx+10h]
                test    rax, rax
                jz      short loc_140287D81
                cmp     rax, [rcx+8]
                jz      short loc_140287D81
                mov     ebx, 4
                jmp     short loc_140287DC1
; ---------------------------------------------------------------------------

loc_140287D81:                          ; CODE XREF: sub_140286D90+89F↑j
                                        ; sub_140286D90+FE2↑j ...
                cmp     edi, 7
                jbe     loc_140287E81
                test    edx, edx
                jz      short loc_140287DAC

loc_140287D8E:                          ; CODE XREF: sub_140286D90+8AE↑j
                test    r8b, 1Eh
                jz      short loc_140287D9B
                mov     ebx, 5
                jmp     short loc_140287DC1
; ---------------------------------------------------------------------------

loc_140287D9B:                          ; CODE XREF: sub_140286D90+1002↑j
                mov     rax, [rcx+18h]
                cmp     [rcx+8], rax
                jz      short loc_140287DAC
                mov     ebx, 6
                jmp     short loc_140287DC1
; ---------------------------------------------------------------------------

loc_140287DAC:                          ; CODE XREF: sub_140286D90+FFC↑j
                                        ; sub_140286D90+1013↑j
                cli
                xor     ebx, ebx
                mov     [rcx+7BECh], ebx
                mov     [rcx+7E9Ch], ebx
                call    sub_140326178
                sti

loc_140287DC1:                          ; CODE XREF: sub_140286D90+8B4↑j
                                        ; sub_140286D90+FC7↑j ...
                test    dword ptr cs:xmmword_140CFC480+4, 4000000h
                jz      short loc_140287DD9
                mov     r8d, r15d
                mov     edx, edi
                mov     ecx, ebx
                call    sub_1405A83BC

loc_140287DD9:                          ; CODE XREF: sub_140286D90+103B↑j
                test    ebx, ebx
                jz      loc_140287E81
                mov     r15, [rsp+0BC0h+var_B78]

loc_140287DE6:                          ; CODE XREF: sub_140286D90+86C↑j
                mov     rdi, [rsp+0BC0h+var_B68]
                lea     rcx, [rbp+0AC0h+var_AD0]
                mov     rbx, [rsp+0BC0h+var_B80]
                mov     r9, rdi
                mov     rdx, rbx
                mov     r8, rsi
                call    sub_140354078
                test    eax, eax
                mov     eax, 1
                cmovnz  r12d, eax
                cmp     dword ptr [rbp+0AC0h+var_868+4], 0
                mov     [rsp+0BC0h+var_B90], r12d
                jz      short loc_140287E46
                mov     r9, rdi
                mov     dword ptr [rsp+0BC0h+var_BA0], eax
                mov     r8, rsi
                lea     rcx, [rbp+0AC0h+var_870]
                mov     rdx, rbx
                call    sub_14028F360
                test    eax, eax
                mov     edi, 1
                cmovnz  r12d, edi
                mov     [rsp+0BC0h+var_B90], r12d
                jmp     short loc_140287E4B
; ---------------------------------------------------------------------------

loc_140287E46:                          ; CODE XREF: sub_140286D90+1089↑j
                mov     edi, 1

loc_140287E4B:                          ; CODE XREF: sub_140286D90+10B4↑j
                mov     rbx, [rsp+0BC0h+var_B50]
                test    rbx, rbx
                jz      short loc_140287E69
                mov     rdx, rbx
                mov     rcx, r15
                call    sub_140312B40
                mov     [rsp+0BC0h+var_B50], 0

loc_140287E69:                          ; CODE XREF: sub_140286D90+10C3↑j
                movzx   edx, byte ptr [rbp+0AC0h+var_B30]
                mov     rcx, r15
                call    sub_140226960
                mov     rcx, r15
                mov     [rsp+0BC0h+var_B70], edi
                call    sub_140231340

loc_140287E81:                          ; CODE XREF: sub_140286D90+FF4↑j
                                        ; sub_140286D90+104B↑j
                mov     rax, [rsp+0BC0h+var_B88]
                shl     rax, 0Ch
                add     [rsp+0BC0h+var_B58], rax

loc_140287E8F:                          ; CODE XREF: sub_140286D90+BCC↑j
                mov     r15, [rsp+0BC0h+var_B68]
                cmp     r13, [rbp+0AC0h+var_B28]
                ja      short loc_140287EC7
                mov     r10d, [rsp+0BC0h+var_B70]
                mov     r11d, 1
                mov     rbx, [rsp+0BC0h+var_B78]
                jmp     loc_140287070
; ---------------------------------------------------------------------------

loc_140287EAF:                          ; CODE XREF: sub_140286D90+5D8↑j
                mov     rax, [rbp+0AC0h+var_B28]
                mov     r15, rdi
                sub     rax, r13
                sar     rax, 3
                inc     rax
                add     rax, rdx
                mov     [rdi+18h], rax

loc_140287EC7:                          ; CODE XREF: sub_140286D90+1108↑j
                mov     rdi, [rsp+0BC0h+var_B50]

loc_140287ECC:                          ; CODE XREF: sub_140286D90+2D7↑j
                mov     rdx, qword ptr [rbp+0AC0h+var_AD0+8]
                xorps   xmm0, xmm0
                xor     eax, eax
                mov     [rbp+0AC0h+var_9EA], ax
                mov     [rbp+0AC0h+var_940], rax
                movups  [rbp+0AC0h+var_9D0], xmm0
                lea     r14d, [rax+1]
                movups  [rbp+0AC0h+var_9C0], xmm0
                movups  [rbp+0AC0h+var_9B0], xmm0
                movups  [rbp+0AC0h+var_9A0], xmm0
                movups  [rbp+0AC0h+var_990], xmm0
                movups  [rbp+0AC0h+var_980], xmm0
                movups  [rbp+0AC0h+var_970], xmm0
                movups  [rbp+0AC0h+var_960], xmm0
                movups  [rbp+0AC0h+var_950], xmm0
                test    rdx, rdx
                jz      loc_140287FB6
                xor     ebx, ebx
                mov     [rbp+0AC0h+var_9EC], ax
                mov     [rbp+0AC0h+var_9E0], rbx
                mov     [rbp+0AC0h+var_9D8], rbx
                mov     [rbp+0AC0h+var_9E8], 14h
                mov     [rbp+0AC0h+var_9F0], r14d
                shl     rdx, 19h
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                mov     r8, qword ptr [rbp+0AC0h+var_AC0]
                lea     rcx, [rbp+0AC0h+var_9F0]
                shl     rax, 19h
                xor     r9d, r9d
                sub     rdx, rax
                sar     rdx, 10h
                call    sub_1402882E0
                lea     rcx, [rbp+0AC0h+var_AD0]
                call    sub_14028E340
                mov     dword ptr [rsp+0BC0h+var_BA0], ebx
                lea     rcx, [rbp+0AC0h+var_9F0]
                mov     rbx, [rsp+0BC0h+var_B80]
                mov     r9, r15
                mov     rdx, rbx
                mov     r8, rsi
                call    sub_14028F360
                test    eax, eax
                cmovnz  r12d, r14d
                jmp     short loc_140287FBB
; ---------------------------------------------------------------------------

loc_140287FB6:                          ; CODE XREF: sub_140286D90+1199↑j
                mov     rbx, [rsp+0BC0h+var_B80]

loc_140287FBB:                          ; CODE XREF: sub_140286D90+1224↑j
                cmp     dword ptr [rbp+0AC0h+var_868+4], 0
                jz      short loc_140287FE4
                mov     r9, r15
                mov     dword ptr [rsp+0BC0h+var_BA0], r14d
                mov     r8, rsi
                lea     rcx, [rbp+0AC0h+var_870]
                mov     rdx, rbx
                call    sub_14028F360
                test    eax, eax
                cmovnz  r12d, r14d

loc_140287FE4:                          ; CODE XREF: sub_140286D90+1232↑j
                test    rdi, rdi
                jz      short loc_140287FF6
                mov     rcx, [rsp+0BC0h+var_B78]
                mov     rdx, rdi
                call    sub_140312B40

loc_140287FF6:                          ; CODE XREF: sub_140286D90+1257↑j
                movzx   edx, byte ptr [rbp+0AC0h+var_B30]
                mov     rcx, [rsp+0BC0h+var_B78]
                call    sub_140226960
                mov     eax, r12d
                mov     rcx, [rbp+0AC0h+var_50]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 0B88h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140286D90
sub_140286D90   endp

algn_14028802B:                         ; DATA XREF: .pdata:00000001400CEB5C↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140288040   proc near               ; CODE XREF: sub_140286D90+9A1↑p
                                        ; sub_14029E340+2C9↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                push    rsi
                push    rdi
                push    r14
                sub     rsp, 20h
                mov     r14, r8
                mov     rbx, rcx
                shl     r8, 19h
                mov     rbp, rdx
                mov     rcx, 0FFFFF68000000000h
                mov     rax, rcx
                shl     rax, 19h
                sub     r8, rax
                mov     rax, 0FFFFFFFFF000h
                sar     r8, 10h
                and     r8, rax
                shr     r8, 9
                mov     rax, rcx
                add     r8, rax
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rdx, [r8]
                mov     rax, r10
                mov     r9, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                jb      short loc_140288114
                mov     rax, r9
                cmp     r8, rax
                ja      short loc_140288114
                call    sub_140349680
                test    eax, eax
                jz      short loc_140288114
                test    dl, 1
                jz      short loc_140288114
                test    dl, 20h
                jz      short loc_1402880CD
                test    dl, 42h
                jnz     short loc_140288114

loc_1402880CD:                          ; CODE XREF: sub_140288040+86↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_140288114
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140288114
                or      rdx, 42h

loc_140288114:                          ; CODE XREF: sub_140288040+6B↑j
                                        ; sub_140288040+73↑j ...
                mov     rdi, rdx
                shr     rdx, 38h
                shr     rdi, 3Ch
                and     dl, 0Fh
                and     dil, 7
                shl     dil, 4
                or      dil, dl
                mov     rdx, [r14]
                mov     rax, r10
                cmp     r14, rax
                jb      short loc_1402881A0
                mov     rax, r9
                cmp     r14, rax
                ja      short loc_1402881A0
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402881A0
                test    dl, 1
                jz      short loc_1402881A0
                test    dl, 20h
                jz      short loc_140288158
                test    dl, 42h
                jnz     short loc_1402881A0

loc_140288158:                          ; CODE XREF: sub_140288040+111↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_1402881A0
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_1402881A0
                or      rdx, 42h

loc_1402881A0:                          ; CODE XREF: sub_140288040+F6↑j
                                        ; sub_140288040+FE↑j ...
                mov     [rsp+38h+arg_0], rdx
                mov     rax, r10
                lea     rcx, [rsp+38h+arg_0]
                cmp     rcx, rax
                jb      short loc_140288221
                mov     rax, r9
                lea     rcx, [rsp+38h+arg_0]
                cmp     rcx, rax
                ja      short loc_140288221
                call    sub_140349680
                test    eax, eax
                jz      short loc_140288221
                test    dl, 1
                jz      short loc_140288221
                test    dl, 20h
                jz      short loc_1402881D7
                test    dl, 42h
                jnz     short loc_140288221

loc_1402881D7:                          ; CODE XREF: sub_140288040+190↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_140288221
                lea     rax, [rsp+38h+arg_0]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_140288221
                or      rdx, 42h

loc_140288221:                          ; CODE XREF: sub_140288040+170↑j
                                        ; sub_140288040+17D↑j ...
                shr     rdx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax
                lea     rcx, [rdx+rdx*2]
                shl     rcx, 4
                mov     rax, 0FFFFFA8000000000h
                add     rcx, rax
                call    sub_1403F41D8
                xor     esi, esi
                test    eax, eax
                mov     rax, [rbx+8]
                setz    sil
                test    rax, rax
                jz      short loc_140288297
                mov     rcx, [rbx+10h]
                lea     rax, [rax+rcx*8]
                cmp     r14, rax
                jnz     short loc_140288284
                cmp     dil, [rbx+1Ch]
                jnz     short loc_140288284
                mov     eax, [rbx+18h]
                and     eax, 1
                cmp     esi, eax
                jnz     short loc_140288284
                lea     rax, [rcx+1]
                mov     [rbx+10h], rax
                jmp     short loc_1402882B5
; ---------------------------------------------------------------------------

loc_140288284:                          ; CODE XREF: sub_140288040+228↑j
                                        ; sub_140288040+22E↑j ...
                mov     eax, [rbx+18h]
                test    al, 2
                jz      short loc_14028828F
                xor     eax, eax
                jmp     short loc_1402882BA
; ---------------------------------------------------------------------------

loc_14028828F:                          ; CODE XREF: sub_140288040+249↑j
                mov     rcx, rbx
                call    sub_14028E340

loc_140288297:                          ; CODE XREF: sub_140288040+21B↑j
                mov     eax, [rbx+18h]
                and     eax, 0FFFFFFFEh
                mov     [rbx], rbp
                or      eax, esi
                mov     [rbx+8], r14
                mov     [rbx+18h], eax
                mov     qword ptr [rbx+10h], 1
                mov     [rbx+1Ch], dil

loc_1402882B5:                          ; CODE XREF: sub_140288040+242↑j
                mov     eax, 1

loc_1402882BA:                          ; CODE XREF: sub_140288040+24D↑j
                mov     rbx, [rsp+38h+arg_8]
                mov     rbp, [rsp+38h+arg_10]
                add     rsp, 20h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140288040   endp

algn_1402882CE:                         ; DATA XREF: .pdata:00000001400CEB68↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402882E0   proc near               ; CODE XREF: sub_140209860+3DC↑p
                                        ; sub_14025BAF0+183↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140444AD4 SIZE 0000000D BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r14
                sub     rsp, 20h
                mov     rbx, rcx
                mov     edi, 1000h
                lea     ecx, [r9+r9*8]
                mov     rsi, r8
                shl     rdi, cl
                mov     r14, rdx
                cmp     dword ptr [rbx], 1
                jnz     loc_1402884C3

loc_140288313:                          ; CODE XREF: sub_1402882E0+1E9↓j
                                        ; sub_1402882E0+1FC↓j ...
                mov     r8d, [rbx+0Ch]
                mov     r10d, 1
                test    r8d, r8d
                jz      short loc_140288378
                test    byte ptr [rbx+4], 4
                jnz     short loc_140288378
                lea     eax, [r8-1]
                mov     ecx, r9d
                mov     rax, [rbx+rax*8+18h]
                mov     rdx, rax
                shr     rdx, 0Ah
                and     edx, 3
                cmp     rdx, rcx
                jnz     short loc_140288382
                mov     rdx, rax
                and     rax, 0FFFFFFFFFFFFF000h
                and     edx, 3FFh
                lea     rcx, [rdx+1]
                imul    rcx, rdi
                add     rcx, rax
                cmp     rcx, r14
                jnz     short loc_140288382
                lea     rax, [rdx+rsi]
                cmp     rax, 3FFh
                ja      short loc_140288382
                cmp     rax, rdx
                jbe     short loc_140288382
                mov     eax, r10d
                jmp     short loc_14028837A
; ---------------------------------------------------------------------------

loc_140288378:                          ; CODE XREF: sub_1402882E0+40↑j
                                        ; sub_1402882E0+46↑j
                xor     eax, eax

loc_14028837A:                          ; CODE XREF: sub_1402882E0+96↑j
                test    eax, eax
                jnz     loc_140288431

loc_140288382:                          ; CODE XREF: sub_1402882E0+61↑j
                                        ; sub_1402882E0+80↑j ...
                test    r8d, r8d
                jnz     loc_140288458

loc_14028838B:                          ; CODE XREF: sub_1402882E0+17C↓j
                xor     r10d, r10d
                mov     r11, rsi
                imul    r11, rdi

loc_140288395:                          ; CODE XREF: sub_1402882E0+1D8↓j
                test    r10d, r10d
                jnz     loc_140288544

loc_14028839E:                          ; CODE XREF: sub_1402882E0+19B↓j
                                        ; sub_1402882E0+1B9↓j ...
                cmp     r8d, [rbx+8]
                jnb     loc_140288571
                test    rsi, rsi
                jz      short loc_14028841A

loc_1402883AD:                          ; DATA XREF: .rdata:000000014005EC58↑o
                                        ; .rdata:000000014005EC6C↑o ...
                mov     [rsp+28h+arg_0], rbp
                mov     ebp, r9d
                and     ebp, 3
                shl     rbp, 0Ah

loc_1402883BC:                          ; CODE XREF: sub_1402882E0+133↓j
                lea     rax, [rsi-1]
                mov     rcx, r14
                cmp     rax, 3FFh
                mov     edx, 400h
                cmovbe  rdx, rsi
                and     rcx, 0FFFFFFFFFFFFF000h
                sub     rsi, rdx
                lea     rax, [rdx-1]
                and     eax, 3FFh
                or      rax, rcx
                mov     rcx, rdi
                imul    rcx, rdx
                or      rax, rbp
                add     r14, rcx
                mov     ecx, [rbx+0Ch]
                mov     [rbx+rcx*8+18h], rax
                inc     dword ptr [rbx+0Ch]
                mov     ecx, [rbx+0Ch]
                add     [rbx+10h], rdx
                cmp     ecx, [rbx+8]
                jz      loc_1402884FF

loc_140288410:                          ; CODE XREF: sub_1402882E0+223↓j
                                        ; sub_1402882E0+250↓j
                test    rsi, rsi
                jnz     short loc_1402883BC

loc_140288415:                          ; CODE XREF: sub_1402882E0+259↓j
                                        ; sub_1402882E0+1BC7FC↓j
                mov     rbp, [rsp+28h+arg_0]

loc_14028841A:                          ; CODE XREF: sub_1402882E0+CB↑j
                                        ; sub_1402882E0+176↓j ...
                mov     rbx, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140288431:                          ; CODE XREF: sub_1402882E0+9C↑j
                lea     eax, [r8-1]
                lea     rdx, [rbx+rax*8]
                mov     rax, [rbx+rax*8+18h]
                add     [rbx+10h], rsi
                lea     rcx, [rax+rsi]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rcx, rax
                mov     [rdx+18h], rcx
                jmp     short loc_14028841A
; ---------------------------------------------------------------------------

loc_140288458:                          ; CODE XREF: sub_1402882E0+A5↑j
                test    byte ptr [rbx+4], 4
                jnz     loc_14028838B
                lea     eax, [r8-1]
                mov     ecx, r9d
                mov     rax, [rbx+rax*8+18h]
                mov     rdx, rax
                shr     rdx, 0Ah
                and     edx, 3
                cmp     rdx, rcx
                jnz     loc_14028839E
                mov     r11, rdi
                mov     rcx, rax
                imul    r11, rsi
                and     rcx, 0FFFFFFFFFFFFF000h
                lea     rdx, [r11+r14]
                cmp     rcx, rdx
                jnz     loc_14028839E
                and     eax, 3FFh
                lea     rcx, [rax+rsi]
                cmp     rcx, rax
                jbe     loc_14028839E
                cmp     rcx, 3FFh
                jbe     loc_140288395
                jmp     loc_14028839E
; ---------------------------------------------------------------------------

loc_1402884C3:                          ; CODE XREF: sub_1402882E0+2D↑j
                movzx   eax, byte ptr [rbx+4]
                test    al, 8
                jnz     loc_140288313
                mov     rcx, 0FFFFF68000000000h
                cmp     r14, rcx
                jb      loc_140288313
                mov     rcx, 0FFFFF6FFFFFFFFFFh
                cmp     r14, rcx
                ja      loc_140288313
                or      al, 8
                mov     [rbx+4], al
                jmp     loc_140288313
; ---------------------------------------------------------------------------

loc_1402884FF:                          ; CODE XREF: sub_1402882E0+12A↑j
                                        ; DATA XREF: .pdata:00000001400CEB8C↑o ...
                test    byte ptr [rbx+4], 4
                jnz     loc_140288410
                mov     rdx, rcx
                lea     r9, sub_14033B080
                lea     rcx, [rbx+18h]
                mov     r8d, 8
                call    qsort
                mov     rcx, rbx
                call    sub_14033A660
                mov     eax, [rbx+0Ch]
                cmp     eax, [rbx+8]
                jnz     loc_140288410
                test    rsi, rsi
                jz      loc_140288415
                jmp     loc_140444AD4
; ---------------------------------------------------------------------------

loc_140288544:                          ; CODE XREF: sub_1402882E0+B8↑j
                                        ; DATA XREF: .pdata:00000001400CEB98↑o ...
                lea     eax, [r8-1]
                lea     rdx, [rbx+rax*8]
                mov     rax, [rbx+rax*8+18h]
                add     [rbx+10h], rsi
                sub     rax, r11
                lea     rcx, [rax+rsi]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rcx, rax
                mov     [rdx+18h], rcx
                jmp     loc_14028841A
; ---------------------------------------------------------------------------

loc_140288571:                          ; CODE XREF: sub_1402882E0+C2↑j
                mov     byte ptr [rbx+5], 1
                jmp     loc_14028841A
sub_1402882E0   endp

; ---------------------------------------------------------------------------
algn_14028857A:                         ; DATA XREF: .pdata:00000001400CEBA4↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140288580   proc near               ; CODE XREF: sub_1402583E0+2EC↑p
                                        ; sub_14029A350+60↓p
                                        ; DATA XREF: ...

var_118         = qword ptr -118h
var_108         = dword ptr -108h
var_104         = word ptr -104h
var_102         = word ptr -102h
var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = byte ptr -0E8h
var_48          = qword ptr -48h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140444AE2 SIZE 0000012C BYTES

; __unwind { // __GSHandlerCheck
                mov     [rsp+arg_10], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 100h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+138h+var_48], rax
                mov     ebx, r8d
                mov     r14, rdx
                mov     rsi, rcx
                xor     eax, eax
                xor     edx, edx
                mov     [rsp+138h+var_102], ax
                mov     r8d, 98h
                lea     rcx, [rsp+138h+var_E8]
                mov     r13d, r9d
                call    memset
                xor     eax, eax
                mov     [rsp+138h+var_100], 14h
                mov     [rsp+138h+var_108], ebx
                mov     r12d, eax
                mov     [rsp+138h+var_104], ax
                mov     r15d, eax
                mov     [rsp+138h+var_F8], rax
                mov     ebp, eax
                mov     [rsp+138h+var_F0], rax
                test    r14, r14
                jz      loc_140288692

loc_1402885FD:                          ; CODE XREF: sub_140288580+10C↓j
                mov     rbx, [rsi]
                mov     rcx, 0FFFFF6FB7DBED7F8h
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     rsi, rax
                jnb     loc_1402886C8

loc_140288620:                          ; CODE XREF: sub_140288580+14E↓j
                                        ; sub_140288580+1BC56C↓j ...
                test    rbx, 0C01h
                setz    cl
                test    rbx, 3E0h
                setz    al
                test    al, cl
                jnz     short loc_140288643
                test    r13d, r13d
                jz      loc_140444BF0
                jmp     short loc_140288682
; ---------------------------------------------------------------------------

loc_140288643:                          ; CODE XREF: sub_140288580+B6↑j
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14028865A
                test    bl, 10h
                jnz     short loc_14028865A
                not     rax
                and     rbx, rax

loc_14028865A:                          ; CODE XREF: sub_140288580+CD↑j
                                        ; sub_140288580+D2↑j
                mov     rdi, cs:qword_14001D278
                mov     rcx, rsi
                shr     rbx, 20h
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140444B7B

loc_140288675:                          ; CODE XREF: sub_140288580+1BC64E↓j
                                        ; sub_140288580+1BC658↓j ...
                mov     [rsi], rdi

loc_140288678:                          ; CODE XREF: sub_140288580+1BC62F↓j
                test    ebx, ebx
                jnz     short loc_1402886D9
                xor     r15d, r15d
                xor     r12d, r12d

loc_140288682:                          ; CODE XREF: sub_140288580+C1↑j
                                        ; sub_140288580+162↓j ...
                inc     rbp
                add     rsi, 8
                cmp     rbp, r14
                jb      loc_1402885FD

loc_140288692:                          ; CODE XREF: sub_140288580+77↑j
                lea     rcx, [rsp+138h+var_108]
                call    sub_14028EDB0
                mov     rcx, [rsp+138h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+138h+arg_10]
                add     rsp, 100h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 8

loc_1402886C8:                          ; CODE XREF: sub_140288580+9A↑j
                mov     rax, rcx
                cmp     rsi, rax
                ja      loc_140288620
                jmp     loc_140444AE2
; ---------------------------------------------------------------------------

loc_1402886D9:                          ; CODE XREF: sub_140288580+FA↑j
                cmp     ebx, r12d
                jnz     short loc_140288718
                cmp     r15d, 1
                jnz     short loc_140288682
                mov     rdx, rsi
                mov     rax, 0FFFFF68000000000h
                shl     rdx, 19h
                mov     rax, rax
                shl     rax, 19h
                lea     rcx, [rsp+138h+var_108]
                sub     rdx, rax
                xor     r9d, r9d
                sar     rdx, 10h
                mov     r8d, r15d
                call    sub_1402882E0
                jmp     loc_140288682
; ---------------------------------------------------------------------------

loc_140288718:                          ; CODE XREF: sub_140288580+15C↑j
                mov     edx, 0FFFFFFFFh
                mov     ecx, ebx
                call    sub_14031FAEC
                test    al, al
                jnz     short loc_140288733
                xor     r15d, r15d
                mov     r12d, ebx
                jmp     loc_140288682
; ---------------------------------------------------------------------------

loc_140288733:                          ; CODE XREF: sub_140288580+1A6↑j
                mov     rdx, rsi
                mov     rax, 0FFFFF68000000000h
                shl     rdx, 19h
                mov     rax, rax
                xor     r9d, r9d
                shl     rax, 19h
                sub     rdx, rax
                lea     rcx, [rsp+138h+var_108]
                sar     rdx, 10h
                lea     r8d, [r9+1]
                call    sub_1402882E0
                mov     r15d, 1
                mov     r12d, ebx
                jmp     loc_140288682
; } // starts at 140288580
sub_140288580   endp

; ---------------------------------------------------------------------------
algn_140288771:                         ; DATA XREF: .rdata:000000014005ECDC↑o
                                        ; .pdata:00000001400CEBB0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140288780   proc near               ; CODE XREF: sub_1402889E0+397↓p
                                        ; CcSetDirtyPinnedData+436↓p ...

var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140444C0E SIZE 0000007F BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r14
                sub     rsp, 30h
                mov     esi, r9d
                mov     rbp, r8
                mov     r14, rdx
                mov     rbx, rcx
                test    rcx, rcx
                jz      loc_14028887D
                cmp     qword ptr [rcx+0A8h], 0
                mov     rdi, [rcx+210h]
                jz      short loc_1402887DB
                mov     rcx, [rcx+60h]
                and     rcx, 0FFFFFFFFFFFFFFF0h
                mov     rcx, [rcx+28h]
                call    sub_140285080
                cmp     rdi, [rax+8]
                jnz     loc_140444C0E

loc_1402887DB:                          ; CODE XREF: sub_140288780+3E↑j
                                        ; sub_140288780+108↓j
                mov     rdx, rsi
                add     [rdi+280h], rdx
                test    r14, r14
                jz      short loc_1402887EE
                add     [r14+8], esi

loc_1402887EE:                          ; CODE XREF: sub_140288780+68↑j
                test    rbp, rbp
                jz      short loc_1402887F6
                add     [rbp+20h], esi

loc_1402887F6:                          ; CODE XREF: sub_140288780+71↑j
                test    rbx, rbx
                jz      short loc_14028881A
                add     [rbx+70h], esi
                mov     rax, rdx
                mov     rcx, [rbx+1F8h]
                lock xadd [rcx+20h], rax
                test    dword ptr [rbx+98h], 1000000h
                jnz     short loc_14028885A

loc_14028881A:                          ; CODE XREF: sub_140288780+79↑j
                                        ; sub_140288780+F6↓j ...
                cmp     byte ptr [rdi+3C4h], 0
                jnz     loc_140444C50

loc_140288827:                          ; CODE XREF: sub_140288780+1BC4DB↓j
                                        ; sub_140288780+1BC4EF↓j
                cmp     byte ptr [rdi+8Ch], 0
                jnz     loc_140444C74

loc_140288834:                          ; CODE XREF: sub_140288780+1BC508↓j
                xor     edx, edx
                mov     rcx, rdi
                call    sub_1402888A0
                mov     rbx, [rsp+38h+arg_0]
                mov     rbp, [rsp+38h+arg_8]
                mov     rsi, [rsp+38h+arg_10]
                mov     rdi, [rsp+38h+arg_18]
                add     rsp, 30h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14028885A:                          ; CODE XREF: sub_140288780+98↑j
                mov     rax, [rbx+0F0h]
                lock xadd [rax+18h], rdx
                mov     rax, [rbx+0F0h]
                cmp     qword ptr [rax+88h], 0FFFFFFFFFFFFFFFFh
                jnz     short loc_14028881A
                jmp     loc_140444C30
; ---------------------------------------------------------------------------

loc_14028887D:                          ; CODE XREF: sub_140288780+29↑j
                mov     rax, cs:qword_140CFC760
                mov     rdi, [rax+8]
                jmp     loc_1402887DB
sub_140288780   endp

; ---------------------------------------------------------------------------
algn_14028888D:                         ; DATA XREF: .rdata:000000014005ED08↑o
                                        ; .pdata:00000001400CEBBC↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402888A0   proc near               ; CODE XREF: sub_140288780+B9↑p
                                        ; sub_1403B9320+13E↓p ...

var_28          = xmmword ptr -28h
var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 0000000140444C8E SIZE 00000077 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 40h
                xor     eax, eax
                xor     sil, sil
                cmp     byte ptr cs:dword_140CFB19C, al
                xorps   xmm0, xmm0
                movzx   edi, dl
                mov     [rsp+48h+var_18], rax
                mov     rbx, rcx
                movups  [rsp+48h+var_28], xmm0
                jz      short loc_1402888E0

loc_1402888CF:                          ; CODE XREF: sub_1402888A0+DD↓j
                                        ; sub_1402888A0+E9↓j ...
                mov     rbx, [rsp+48h+arg_0]
                mov     rsi, [rsp+48h+arg_8]
                add     rsp, 40h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 20h

loc_1402888E0:                          ; CODE XREF: sub_1402888A0+2D↑j
                add     rcx, 0C0h
                lea     rdx, [rsp+48h+var_28]
                call    KeAcquireInStackQueuedSpinLock
                cmp     dword ptr [rbx+164h], 0
                ja      loc_1402889BB
                cmp     qword ptr [rbx+280h], 2000h
                ja      loc_14028899E
                test    dil, dil
                jnz     loc_14028899E
                cmp     dword ptr [rbx+170h], 0
                jnz     short loc_140288959
                cmp     dword ptr [rbx+158h], 0
                jnz     short loc_140288959
                lea     rax, [rbx+100h]
                cmp     [rax], rax
                jnz     short loc_140288959
                lea     rax, [rbx+120h]
                cmp     [rax], rax
                jnz     short loc_140288959
                mov     dword ptr [rbx+3C0h], 1
                cmp     [rbx+308h], sil
                jnz     loc_140444C8E

loc_140288959:                          ; CODE XREF: sub_1402888A0+7F↑j
                                        ; sub_1402888A0+88↑j ...
                lea     rcx, [rsp+48h+var_28]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   edi, byte ptr [rsp+48h+var_18]
                test    eax, eax
                jnz     loc_140444C9A

loc_140288976:                          ; CODE XREF: sub_1402888A0+1BC3FC↓j
                                        ; sub_1402888A0+1BC408↓j ...
                mov     cr8, rdi
                test    sil, sil
                jz      loc_1402888CF
                mov     rax, cr8
                cmp     al, 2
                jnb     loc_1402888CF
                xor     edx, edx
                mov     rcx, rbx
                call    sub_1403221C0
                jmp     loc_1402888CF
; ---------------------------------------------------------------------------

loc_14028899E:                          ; CODE XREF: sub_1402888A0+69↑j
                                        ; sub_1402888A0+72↑j
                mov     eax, [rbx+0C8h]
                cmp     [rbx+3C0h], eax
                jnb     short loc_140288959
                xor     edx, edx
                mov     rcx, rbx
                call    sub_140381708
                mov     sil, 1
                jmp     short loc_140288959
; ---------------------------------------------------------------------------

loc_1402889BB:                          ; CODE XREF: sub_1402888A0+58↑j
                mov     eax, [rbx+0C8h]
                cmp     [rbx+3C0h], eax
                jnb     short loc_140288959
                xor     edx, edx
                mov     rcx, rbx
                mov     sil, 1
                call    sub_140381708
                jmp     short loc_140288959
sub_1402888A0   endp

; ---------------------------------------------------------------------------
algn_1402889D8:                         ; DATA XREF: .rdata:000000014005ED2C↑o
                                        ; .pdata:00000001400CEBC8↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_1402889E0   proc near               ; CODE XREF: sub_1402841E0+52F↑p
                                        ; sub_1402E4724+14F↓p ...

var_90          = qword ptr -90h
var_80          = dword ptr -80h
var_7C          = dword ptr -7Ch
var_78          = dword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
arg_0           = qword ptr  10h
arg_8           = qword ptr  18h
arg_10          = dword ptr  20h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 0000000140444D06 SIZE 000003C8 BYTES

                mov     [rsp-8+arg_18], r9
                mov     [rsp-8+arg_8], rdx
                mov     [rsp-8+arg_0], rcx
                push    rbp
                push    rdi
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-37h]
                sub     rsp, 90h
                mov     r14, [rdx]
                xor     r10d, r10d
                mov     rdi, rcx
                mov     [rbp+57h+var_68], r10
                xor     ecx, ecx
                mov     [rbp+57h+arg_10], r10d
                mov     [rbp+57h+var_48], rcx
                xorps   xmm0, xmm0
                mov     ecx, r8d
                mov     [rbp+57h+var_60], rcx
                add     rcx, r14
                mov     [rbp+57h+var_80], r10d
                movups  [rbp+57h+var_58], xmm0
                lea     r15, [rcx-1]
                mov     rax, r15
                xor     rax, r14
                test    rax, 0FFFFFFFFFE000000h
                jnz     loc_1404450B0
                test    dword ptr [rdi+98h], 40000000h
                jnz     loc_140444D06

loc_140288A55:                          ; CODE XREF: sub_1402889E0+1BC330↓j
                mov     rax, [rdi+20h]
                cqo
                sar     r14, 0Ch
                and     edx, 0FFFh
                sar     r15, 0Ch
                add     rax, rdx
                sar     rax, 0Ch
                cmp     rax, r15
                jle     loc_140445092

loc_140288A79:                          ; DATA XREF: .rdata:000000014005ED5C↑o
                                        ; .rdata:000000014005ED70↑o ...
                mov     [rsp+0B0h+var_28], rbx
                mov     rbx, [rdi+210h]
                mov     [rbp+57h+var_70], rbx
                cmp     [rdi+0A8h], r10
                jz      short loc_140288AB3
                mov     rcx, [rdi+60h]
                and     rcx, 0FFFFFFFFFFFFFFF0h
                mov     rcx, [rcx+28h]
                call    sub_140285080
                cmp     rbx, [rax+8]
                jnz     loc_140444D15
                xor     r10d, r10d

loc_140288AB3:                          ; CODE XREF: sub_1402889E0+B3↑j
                test    dword ptr [rdi+98h], 40000000h
                mov     r13d, 1
                mov     [rsp+0B0h+var_30], rsi
                mov     [rsp+0B0h+var_38], r12
                lea     r12, [r13-2]
                jnz     loc_140444D34

loc_140288ADA:                          ; CODE XREF: sub_1402889E0+41E↓j
                mov     esi, [rbp+57h+arg_10]

loc_140288ADD:                          ; CODE XREF: sub_1402889E0+6FD↓j
                cmp     qword ptr [rdi+20h], 300000h
                mov     r12, 7FFFFFFFFFFFFFFCh
                jbe     short loc_140288B13
                inc     cs:dword_140CDB5D4
                lea     rcx, word_140CDB5C0
                call    ExpInterlockedPopEntrySList
                test    rax, rax
                jz      loc_1402890E2

loc_140288B0C:                          ; CODE XREF: sub_1402889E0+72A↓j
                mov     [rbp+57h+var_68], rax
                xor     r10d, r10d

loc_140288B13:                          ; CODE XREF: sub_1402889E0+10F↑j
                mov     [rbp+57h+var_78], r10d
                lea     rsi, [rdi+118h]
                mov     rbx, gs:188h
                mov     [rbp+57h+arg_10], r13d
                dec     word ptr [rbx+1E6h]
                inc     byte ptr [rbx+31Ah]
                cmp     byte ptr [rbx+31Ah], 1
                jnz     loc_140288ECA
                movzx   ecx, byte ptr [rbx+318h]
                mov     [rbp+57h+var_7C], r10d
                test    cl, cl
                jz      loc_140444D46

loc_140288B58:                          ; CODE XREF: sub_1402889E0+1BC381↓j
                mov     eax, r13d
                movzx   edx, cl
                bsf     ecx, edx
                shl     al, cl
                not     al
                mov     [rbp+57h+var_7C], ecx
                and     al, dl
                lea     r13, [rcx+rcx*2]
                mov     [rbx+318h], al
                shl     r13, 5
                add     r13, [rbx+320h]
                jz      loc_140444D80
                mov     rcx, rsi
                call    sub_140245330
                cmp     eax, 1
                jz      loc_140444D8B
                mov     eax, 0FFFFFFFFh

loc_140288B9B:                          ; CODE XREF: sub_1402889E0+1BC3B8↓j
                mov     [r13+28h], eax
                mov     rax, rsi
                and     rax, r12
                mov     [r13+20h], rax

loc_140288BA9:                          ; CODE XREF: sub_1402889E0+1BC3A6↓j
                dec     byte ptr [rbx+31Ah]
                lea     r8, [rbp+57h+var_78]
                mov     rdx, rsi
                mov     rcx, rbx
                call    sub_1402456E0
                add     word ptr [rbx+1E6h], 1
                jnz     short loc_140288BD8
                lea     rax, [rbx+98h]
                cmp     [rax], rax
                jnz     loc_140288FDD

loc_140288BD8:                          ; CODE XREF: sub_1402889E0+1E6↑j
                                        ; sub_1402889E0+602↓j
                mov     rbx, cr8
                mov     eax, 1
                mov     cr8, rax
                lock btr dword ptr [rsi], 0
                jnb     loc_140289124

loc_140288BF0:                          ; CODE XREF: sub_1402889E0+74F↓j
                test    r13, r13
                jz      short loc_140288BFA
                or      byte ptr [r13+1Ah], 1

loc_140288BFA:                          ; CODE XREF: sub_1402889E0+213↑j
                mov     rax, gs:188h
                mov     [rsi+8], rax
                movzx   eax, bl
                mov     [rsi+30h], eax
                mov     r12, [rdi+0A0h]
                test    r12, r12
                jz      loc_140288F81

loc_140288C1D:                          ; CODE XREF: sub_1402889E0+5B9↓j
                cmp     r14, r15
                jnz     short loc_140288C2D
                cmp     r14, [r12+28h]
                jz      loc_140288EE8

loc_140288C2D:                          ; CODE XREF: sub_1402889E0+240↑j
                cmp     r15, 300h
                jb      short loc_140288C47
                mov     r13d, 2F9h
                cmp     [r12], r13w
                jnz     loc_140288FE7

loc_140288C47:                          ; CODE XREF: sub_1402889E0+254↑j
                lea     r8, [rbp+57h+var_68]
                mov     rdx, r14
                mov     rcx, r12
                call    sub_140289158
                mov     rsi, rax
                test    rax, rax
                jz      loc_140444F73
                mov     rdx, [rax+10h]
                mov     ecx, [rax+18h]
                mov     r8d, edx
                add     rcx, rdx
                cmp     r14, rcx
                jl      loc_140288F47

loc_140288C78:                          ; CODE XREF: sub_1402889E0+56F↓j
                mov     eax, [rsi+1Ch]
                add     rax, rdx
                cmp     r15, rax
                jle     short loc_140288C8C
                mov     eax, r15d
                sub     eax, r8d
                mov     [rsi+1Ch], eax

loc_140288C8C:                          ; CODE XREF: sub_1402889E0+2A1↑j
                mov     r9, [rbp+57h+var_70]
                xor     eax, eax
                mov     qword ptr [rbp+57h+var_58], rax
                lea     rbx, [r9+80h]
                mov     qword ptr [rbp+57h+var_58+8], rbx
                mov     r10, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140444D9D

loc_140288CBC:                          ; CODE XREF: sub_1402889E0+1BC3BF↓j
                                        ; sub_1402889E0+1BC3C9↓j ...
                mov     byte ptr [rbp+57h+var_48], r10b
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140444DE6

loc_140288CD9:                          ; CODE XREF: sub_1402889E0+1BC40A↓j
                                        ; sub_1402889E0+1BC419↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140444E0D
                lea     rdx, [rbp+57h+var_58]
                xchg    rdx, [rbx]
                test    rdx, rdx
                jnz     loc_140288FB9

loc_140288CF6:                          ; CODE XREF: sub_1402889E0+5E6↓j
                cmp     dword ptr [rdi+70h], 0
                jz      loc_140288F54

loc_140288D00:                          ; CODE XREF: sub_1402889E0+57C↓j
                                        ; sub_1402889E0+59C↓j
                mov     rax, [rsi+28h]
                mov     ecx, r14d
                sub     ecx, [rsi+10h]
                mov     r9d, 1
                shr     rcx, 5
                mov     ebx, r9d
                lea     rdx, [rax+rcx*4]
                mov     ecx, r14d
                and     ecx, 1Fh
                shl     ebx, cl
                cmp     r14, r15
                jg      short loc_140288D67
                mov     edi, [rbp+57h+var_80]
                mov     rcx, r15
                sub     rcx, r14
                inc     rcx
                add     r14, rcx

loc_140288D37:                          ; CODE XREF: sub_1402889E0+37E↓j
                mov     eax, [rdx]
                mov     r8, rdx
                test    ebx, eax
                jnz     short loc_140288D46
                or      eax, ebx
                mov     [rdx], eax
                inc     edi

loc_140288D46:                          ; CODE XREF: sub_1402889E0+35E↑j
                lea     eax, [rbx+rbx]
                mov     ebx, r9d
                test    eax, eax
                cmovnz  ebx, eax
                add     rdx, 4
                test    eax, eax
                cmovnz  rdx, r8
                sub     rcx, r9
                jnz     short loc_140288D37
                mov     [rbp+57h+var_80], edi
                mov     rdi, [rbp+57h+arg_0]

loc_140288D67:                          ; CODE XREF: sub_1402889E0+346↑j
                mov     r13d, [rbp+57h+var_80]
                mov     r8, rsi
                mov     r9d, r13d
                mov     rdx, r12
                mov     rcx, rdi
                call    sub_140288780
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_140444E1F
                prefetchw byte ptr [rbp+57h+var_58]
                mov     rax, qword ptr [rbp+57h+var_58]
                test    rax, rax
                jnz     loc_140288FA7
                mov     rcx, qword ptr [rbp+57h+var_58+8]
                lea     rax, [rbp+57h+var_58]
                xor     r10d, r10d
                lock cmpxchg [rcx], r10
                lea     rcx, [rbp+57h+var_58]
                cmp     rax, rcx
                jnz     loc_140288F9E

loc_140288DB7:                          ; CODE XREF: sub_1402889E0+5D4↓j
                                        ; sub_1402889E0+1BC44F↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140444E34

loc_140288DD0:                          ; CODE XREF: sub_1402889E0+1BC458↓j
                                        ; sub_1402889E0+1BC467↓j ...
                mov     eax, cs:dword_140CFC660
                movzx   esi, byte ptr [rbp+57h+var_48]
                test    eax, eax
                jnz     loc_140444E5A

loc_140288DE2:                          ; CODE XREF: sub_1402889E0+1BC47C↓j
                                        ; sub_1402889E0+1BC488↓j ...
                mov     cr8, rsi
                test    dword ptr [rdi+98h], 10000000h
                jnz     loc_140288EF3

loc_140288DF6:                          ; CODE XREF: sub_1402889E0+516↓j
                                        ; sub_1402889E0+543↓j
                mov     r13d, 1

loc_140288DFC:                          ; CODE XREF: sub_1402889E0+562↓j
                test    ebx, ebx
                jz      loc_140288ADA
                mov     [r12+28h], r15

loc_140288E09:                          ; CODE XREF: sub_1402889E0+50E↓j
                mov     rbx, [rbp+57h+var_70]
                mov     r12, 0FFFFFFFFFFFFFFFFh

loc_140288E14:                          ; CODE XREF: sub_1402889E0+1BC361↓j
                mov     rax, [rbp+57h+arg_8]
                mov     rcx, [rbp+57h+var_60]
                mov     rax, [rax]
                add     rcx, rax
                cmp     rcx, [rdi+30h]
                jle     short loc_140288E3C
                test    dword ptr [rdi+98h], 40000000h
                mov     [rdi+30h], rcx
                jnz     loc_140444ECD

loc_140288E3C:                          ; CODE XREF: sub_1402889E0+446↑j
                                        ; sub_1402889E0+1BC58E↓j ...
                add     rdi, 118h
                xor     eax, eax
                movzx   ebx, byte ptr [rdi+30h]
                mov     [rdi+8], rax
                lock cmpxchg [rdi], r13d
                jnz     loc_140289115

loc_140288E58:                          ; CODE XREF: sub_1402889E0+73F↓j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140445033

loc_140288E66:                          ; CODE XREF: sub_1402889E0+1BC655↓j
                                        ; sub_1402889E0+1BC661↓j ...
                mov     cr8, rbx
                mov     rcx, rdi
                call    sub_140243660

loc_140288E72:                          ; CODE XREF: sub_1402889E0+1BC648↓j
                mov     rcx, [rbp+57h+var_68]
                test    rcx, rcx
                jz      short loc_140288EA4
                inc     cs:dword_140CDB5DC
                movzx   eax, cs:word_140CDB5D0
                cmp     cs:word_140CDB5C0, ax
                jnb     loc_140289134
                mov     rdx, rcx
                lea     rcx, word_140CDB5C0
                call    ExpInterlockedPushEntrySList

loc_140288EA4:                          ; CODE XREF: sub_1402889E0+499↑j
                                        ; sub_1402889E0+766↓j
                mov     rsi, [rsp+0B0h+var_30]
                mov     r12, [rsp+0B0h+var_38]
                mov     rbx, [rsp+0B0h+var_28]

loc_140288EB9:                          ; CODE XREF: sub_1402889E0+1BC32A↓j
                                        ; DATA XREF: .pdata:00000001400CEBE0↑o ...
                add     rsp, 90h
                pop     r15
                pop     r14
                pop     r13
                pop     rdi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 2

loc_140288ECA:                          ; CODE XREF: sub_1402889E0+15F↑j
                                        ; DATA XREF: .pdata:00000001400CEBEC↑o ...
                mov     rax, cr8
                movzx   r9d, al
                mov     r8, rsi
                mov     rdx, rbx
                mov     [rsp+0B0h+var_90], r10
                mov     ecx, 192h
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_140288EE8:                          ; CODE XREF: sub_1402889E0+247↑j
                mov     r13d, 1
                jmp     loc_140288E09
; ---------------------------------------------------------------------------

loc_140288EF3:                          ; CODE XREF: sub_1402889E0+410↑j
                test    r13d, r13d
                jz      loc_140288DF6
                mov     r9, [rbp+57h+arg_18]
                test    r9, r9
                jz      loc_140288FCB

loc_140288F09:                          ; CODE XREF: sub_1402889E0+5F8↓j
                mov     rcx, [r9+220h]
                mov     eax, r13d
                shl     eax, 0Ch
                mov     r8d, eax
                mov     rdx, [rcx+8B8h]
                test    rdx, rdx
                jz      loc_140288DF6
                test    eax, eax
                jz      short loc_140288F33
                lock xadd [rdx+8], r8

loc_140288F33:                          ; CODE XREF: sub_1402889E0+54B↑j
                mov     r13d, 1
                mov     eax, r13d
                lock xadd [rdx+18h], rax
                jmp     loc_140288DFC
; ---------------------------------------------------------------------------

loc_140288F47:                          ; CODE XREF: sub_1402889E0+292↑j
                mov     eax, r14d
                sub     eax, edx
                mov     [rsi+18h], eax
                jmp     loc_140288C78
; ---------------------------------------------------------------------------

loc_140288F54:                          ; CODE XREF: sub_1402889E0+31A↑j
                mov     eax, [rdi+98h]
                test    al, 2
                jnz     loc_140288D00
                xor     r8d, r8d
                xor     edx, edx
                mov     rcx, r9
                call    sub_1402F9FDC
                mov     rcx, rdi
                call    sub_1402FA068
                mov     [r12+20h], r14
                jmp     loc_140288D00
; ---------------------------------------------------------------------------

loc_140288F81:                          ; CODE XREF: sub_1402889E0+237↑j
                call    sub_140351BF0
                mov     r12, rax
                test    rax, rax
                jz      loc_140444F73
                mov     [rdi+0A0h], rax
                jmp     loc_140288C1D
; ---------------------------------------------------------------------------

loc_140288F9E:                          ; CODE XREF: sub_1402889E0+3D1↑j
                lea     rcx, [rbp+57h+var_58]
                call    sub_140313680

loc_140288FA7:                          ; CODE XREF: sub_1402889E0+3B4↑j
                xor     r10d, r10d
                mov     qword ptr [rbp+57h+var_58], r10
                lock xor qword ptr [rax+8], 1
                jmp     loc_140288DB7
; ---------------------------------------------------------------------------

loc_140288FB9:                          ; CODE XREF: sub_1402889E0+310↑j
                lea     rcx, [rbp+57h+var_58]
                call    sub_14025FC20

loc_140288FC2:                          ; CODE XREF: sub_1402889E0+1BC43A↓j
                mov     r9, [rbp+57h+var_70]
                jmp     loc_140288CF6
; ---------------------------------------------------------------------------

loc_140288FCB:                          ; CODE XREF: sub_1402889E0+523↑j
                mov     r9, gs:188h
                mov     [rbp+57h+arg_18], r9
                jmp     loc_140288F09
; ---------------------------------------------------------------------------

loc_140288FDD:                          ; CODE XREF: sub_1402889E0+1F2↑j
                call    KiCheckForKernelApcDelivery
                jmp     loc_140288BD8
; ---------------------------------------------------------------------------

loc_140288FE7:                          ; CODE XREF: sub_1402889E0+261↑j
                mov     rbx, [rbp+57h+var_68]
                xor     edx, edx
                mov     rcx, rbx
                mov     r8d, 400h
                call    memset
                cmp     dword ptr [r12+50h], 0
                jz      short loc_140289046
                mov     rax, [r12+58h]
                xor     edx, edx
                movups  xmm0, xmmword ptr [rax]
                lea     r8d, [rdx+60h]
                movups  xmmword ptr [rbx], xmm0
                movups  xmm1, xmmword ptr [rax+10h]
                movups  xmmword ptr [rbx+10h], xmm1
                movups  xmm0, xmmword ptr [rax+20h]
                movups  xmmword ptr [rbx+20h], xmm0
                movups  xmm1, xmmword ptr [rax+30h]
                movups  xmmword ptr [rbx+30h], xmm1
                movups  xmm0, xmmword ptr [rax+40h]
                movups  xmmword ptr [rbx+40h], xmm0
                movups  xmm1, xmmword ptr [rax+50h]
                movups  xmmword ptr [rbx+50h], xmm1
                mov     rcx, [r12+58h]
                call    memset

loc_140289046:                          ; CODE XREF: sub_1402889E0+621↑j
                xor     eax, eax
                mov     [r12+58h], rbx
                mov     rdx, [r12+18h]
                lea     rcx, [r12+60h]
                mov     [rbp+57h+var_68], rax
                lea     rax, [r12+10h]
                cmp     [rdx], rax
                jnz     loc_14028914B
                mov     [rcx], rax
                mov     rbx, 7FFFFFFFFFFFFFFFh
                mov     [rcx+8], rdx
                mov     [rdx], rcx
                mov     [rax+8], rcx
                lea     rcx, [r12+90h]
                mov     [r12+70h], rbx
                mov     dword ptr [r12+78h], 0FFFFFFFFh
                mov     rdx, [rax+8]
                cmp     [rdx], rax
                jnz     loc_14028914B
                mov     [rcx], rax
                mov     [rcx+8], rdx
                mov     [rdx], rcx
                mov     [rax+8], rcx
                mov     rcx, rsi
                mov     [r12+0A0h], rbx
                mov     dword ptr [r12+0A8h], 0FFFFFFFFh
                mov     [r12], r13w
                call    KeReleaseGuardedMutex
                xor     r10d, r10d
                mov     esi, r10d
                lea     r13d, [r10+1]
                jmp     loc_140288ADD
; ---------------------------------------------------------------------------

loc_1402890E2:                          ; CODE XREF: sub_1402889E0+126↑j
                mov     edx, cs:dword_140CDB5EC
                mov     rax, cs:qword_140CDB5F0
                mov     r8d, cs:dword_140CDB5E8
                mov     ecx, cs:dword_140CDB5E4
                inc     cs:dword_140CDB5D8
                call    sub_1404079D0
                test    rax, rax
                jnz     loc_140288B0C
                jmp     loc_140444EC2
; ---------------------------------------------------------------------------

loc_140289115:                          ; CODE XREF: sub_1402889E0+472↑j
                mov     edx, eax
                mov     rcx, rdi
                call    sub_1402F424C
                jmp     loc_140288E58
; ---------------------------------------------------------------------------

loc_140289124:                          ; CODE XREF: sub_1402889E0+20A↑j
                mov     rdx, r13
                mov     rcx, rsi
                call    sub_1402F5E40
                jmp     loc_140288BF0
; ---------------------------------------------------------------------------

loc_140289134:                          ; CODE XREF: sub_1402889E0+4AF↑j
                inc     cs:dword_140CDB5E0
                mov     rax, cs:qword_140CDB5F8
                call    sub_1404079D0
                jmp     loc_140288EA4
; ---------------------------------------------------------------------------

loc_14028914B:                          ; CODE XREF: sub_1402889E0+683↑j
                                        ; sub_1402889E0+6BE↑j
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
sub_1402889E0   endp

; ---------------------------------------------------------------------------
algn_140289152:                         ; DATA XREF: .pdata:00000001400CEBF8↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_140289158   proc near               ; CODE XREF: sub_1402889E0+271↑p
                                        ; DATA XREF: .rdata:000000014005EE04↑o ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 00000001404450CE SIZE 00000007 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                mov     [rsp+arg_10], rdi
                push    r14
                sub     rsp, 20h
                mov     rsi, rdx
                xor     edi, edi
                lea     rdx, [rcx+10h]
                mov     r14, r8
                mov     rax, [rdx]
                mov     rbx, rdx
                and     rsi, 0FFFFFFFFFFFFE000h

loc_140289186:                          ; CODE XREF: sub_140289158+6B↓j
                                        ; sub_140289158+70↓j
                mov     rcx, [rax+10h]
                cmp     rsi, rcx
                jnz     short loc_1402891A6

loc_14028918F:                          ; CODE XREF: sub_140289158+C4↓j
                                        ; sub_140289158:loc_14028927F↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                mov     rdi, [rsp+28h+arg_10]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402891A6:                          ; CODE XREF: sub_140289158+35↑j
                cmp     dword ptr [rax+20h], 0
                jz      short loc_140289221

loc_1402891AC:                          ; CODE XREF: sub_140289158+CC↓j
                cmp     rsi, rcx
                cmovg   rbx, rax

loc_1402891B3:                          ; CODE XREF: sub_140289158+D1↓j
                mov     rax, [rax]
                cmp     rax, rdx
                jz      loc_140289248
                cmp     rsi, [rax+10h]
                jge     short loc_140289186
                test    rdi, rdi
                jz      short loc_140289186

loc_1402891CA:                          ; CODE XREF: sub_140289158+F3↓j
                mov     rax, [rdi]
                cmp     [rax+8], rdi
                jnz     FatalListEntryError_11
                mov     rcx, [rdi+8]
                cmp     [rcx], rdi
                jnz     FatalListEntryError_11
                mov     [rcx], rax
                mov     [rax+8], rcx

loc_1402891EB:                          ; CODE XREF: sub_140289158+122↓j
                mov     rax, [rbx]
                cmp     [rax+8], rbx
                jnz     FatalListEntryError_11
                mov     [rdi], rax
                mov     [rdi+8], rbx
                mov     [rax+8], rdi
                mov     [rbx], rdi
                or      dword ptr [rdi+18h], 0FFFFFFFFh
                and     dword ptr [rdi+1Ch], 0
                cmp     qword ptr [rdi+28h], 0
                mov     [rdi+10h], rsi
                jz      short loc_14028922B

loc_140289219:                          ; CODE XREF: sub_140289158+EE↓j
                mov     rax, rdi
                jmp     loc_14028918F
; ---------------------------------------------------------------------------

loc_140289221:                          ; CODE XREF: sub_140289158+52↑j
                test    rdi, rdi
                jnz     short loc_1402891AC
                mov     rdi, rax
                jmp     short loc_1402891B3
; ---------------------------------------------------------------------------

loc_14028922B:                          ; CODE XREF: sub_140289158+BF↑j
                mov     rbx, [r14]
                xor     edx, edx
                mov     rcx, rbx
                mov     r8d, 400h
                call    memset
                and     qword ptr [r14], 0
                mov     [rdi+28h], rbx
                jmp     short loc_140289219
; ---------------------------------------------------------------------------

loc_140289248:                          ; CODE XREF: sub_140289158+61↑j
                test    rdi, rdi
                jnz     loc_1402891CA
                lea     edx, [rdi+30h]
                mov     ecx, 200h
                mov     r8d, 72426343h
                call    ExAllocatePoolWithTag
                mov     rdi, rax
                test    rax, rax
                jz      short loc_14028927F
                xorps   xmm0, xmm0
                movups  xmmword ptr [rax], xmm0
                movups  xmmword ptr [rax+10h], xmm0
                movups  xmmword ptr [rax+20h], xmm0
                jmp     loc_1402891EB
; ---------------------------------------------------------------------------

loc_14028927F:                          ; CODE XREF: sub_140289158+112↑j
                jmp     loc_14028918F
sub_140289158   endp

; ---------------------------------------------------------------------------
algn_140289284:                         ; DATA XREF: .rdata:000000014005EE04↑o
                                        ; .pdata:00000001400CEC04↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140289290   proc near               ; CODE XREF: sub_140289320+25B↓p
                                        ; sub_14036A080+7E3↓p
                                        ; DATA XREF: ...

arg_0           = qword ptr  8

; FUNCTION CHUNK AT 00000001404450D6 SIZE 000000A6 BYTES

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 20h
                mov     rbx, rdx
                mov     rdi, rcx
                mov     rdx, [rcx]
                mov     rax, 0FFFFF6FB7DBED000h
                cmp     rcx, rax
                jnb     loc_1404450D6

loc_1402892B6:                          ; CODE XREF: sub_140289290+1BBE53↓j
                                        ; sub_140289290+1BBE60↓j ...
                mov     eax, cs:dword_140CFC400
                bt      eax, 0Bh
                jb      loc_1404450FF
                bt      eax, 1Ah
                jb      short loc_14028930F

loc_1402892CC:                          ; CODE XREF: sub_140289290+82↓j
                                        ; sub_140289290+1BBE74↓j
                mov     rcx, rdi
                test    dl, 20h
                jz      short loc_1402892F5
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140445109

loc_1402892E1:                          ; CODE XREF: sub_140289290+1BBECB↓j
                                        ; sub_140289290+1BBED4↓j ...
                mov     [rdi], rbx

loc_1402892E4:                          ; CODE XREF: sub_140289290+6F↓j
                                        ; sub_140289290+1BBEAC↓j
                mov     eax, 1
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402892F5:                          ; CODE XREF: sub_140289290+42↑j
                mov     rdx, rbx
                call    sub_14034E08C
                test    al, 20h
                jnz     short loc_1402892E4
                mov     rbx, [rsp+28h+arg_0]
                xor     eax, eax
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028930F:                          ; CODE XREF: sub_140289290+3A↑j
                lfence
                jmp     short loc_1402892CC
sub_140289290   endp

; ---------------------------------------------------------------------------
algn_140289314:                         ; DATA XREF: .rdata:000000014005EE28↑o
                                        ; .pdata:00000001400CEC10↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140289320   proc near               ; CODE XREF: sub_140286D90+9BD↑p
                                        ; sub_140354D98+6E↓p ...

var_98          = dword ptr -98h
var_90          = dword ptr -90h
var_88          = dword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = dword ptr -68h
var_48          = qword ptr -48h
arg_10          = qword ptr  18h

; __unwind { // __GSHandlerCheck
                mov     [rsp+arg_10], rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 80h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+0B8h+var_48], rax
                mov     edi, 1
                mov     [rsp+0B8h+var_70], r9
                mov     rax, 7FFFFFFFF8h
                mov     [rsp+0B8h+var_88], r8d
                mov     r13, rdx
                mov     [rsp+0B8h+var_80], rcx
                shr     r13, 9
                mov     rbp, rdx
                and     r13, rax
                lea     r14d, [rdi+9]
                mov     rax, 0FFFFF68000000000h
                mov     r15d, edi
                xor     esi, esi
                mov     rax, rax
                add     r13, rax
                mov     rcx, r13
                mov     r12d, r13d
                mov     rbx, [r13+0]
                call    sub_1402433C0
                mov     r8d, eax
                test    eax, eax
                jz      short loc_140289400
                call    sub_140349680
                test    eax, eax
                jz      short loc_140289400
                test    dil, bl
                jz      short loc_140289400
                test    bl, 20h
                jz      short loc_1402893B8
                test    bl, 42h
                jnz     short loc_140289400

loc_1402893B8:                          ; CODE XREF: sub_140289320+91↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_140289400
                mov     rax, r12
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_140289400
                or      rbx, 42h

loc_140289400:                          ; CODE XREF: sub_140289320+7E↑j
                                        ; sub_140289320+87↑j ...
                mov     rax, 0FFFFFFFFFh
                shr     rbx, 0Ch
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     r9, [rbx+rbx*2]
                shl     r9, 4
                mov     rax, rax
                add     r9, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rbp, rax
                jb      short loc_140289498
                mov     rax, 0FFFFF6FFFFFFFFFFh
                cmp     rbp, rax
                ja      short loc_140289498
                movzx   ebx, byte ptr [r9]
                mov     edi, esi
                shr     bl, 1
                and     bl, 7

loc_140289455:                          ; CODE XREF: sub_140289320+21D↓j
                mov     r12, [rsp+0B8h+var_80]

loc_14028945A:                          ; CODE XREF: sub_140289320+241↓j
                test    byte ptr [rsp+0B8h+var_88], 3
                jnz     loc_14028958E
                test    edi, edi
                jnz     loc_140289571
                mov     r8, cs:qword_14001D278
                xor     r9d, r9d
                mov     rdx, r13
                mov     rcx, r12
                call    sub_14029B720
                test    eax, eax
                jnz     loc_140289566
                mov     rax, [rsp+0B8h+var_70]
                mov     [rax], esi
                xor     eax, eax
                jmp     loc_140289748
; ---------------------------------------------------------------------------

loc_140289498:                          ; CODE XREF: sub_140289320+119↑j
                                        ; sub_140289320+128↑j
                mov     eax, [rsp+0B8h+var_88]
                mov     rdx, [r13+0]
                and     al, 2
                neg     al
                sbb     r14d, r14d
                add     r14d, 0Ah
                test    r8d, r8d
                jz      short loc_14028950F
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028950F
                test    dil, dl
                jz      short loc_14028950F
                test    dl, 20h
                jz      short loc_1402894C8
                test    dl, 42h
                jnz     short loc_14028950F

loc_1402894C8:                          ; CODE XREF: sub_140289320+1A1↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14028950F
                shr     r12, 3
                mov     r8, rdx
                and     r12d, 1FFh
                or      r8, 20h
                mov     rax, [rax+r12*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028950F
                or      rdx, 42h

loc_14028950F:                          ; CODE XREF: sub_140289320+18E↑j
                                        ; sub_140289320+197↑j ...
                mov     rbx, rdx
                mov     rcx, r9
                shr     rbx, 3Ch
                and     bl, 7
                shr     rdx, 38h
                shl     bl, 4
                and     dl, 0Fh
                or      bl, dl
                call    sub_1403F41D8
                test    eax, eax
                mov     r15d, esi
                movzx   eax, bl
                setz    r15b
                and     al, 0Fh
                cmp     al, 8
                jnz     loc_140289455
                mov     r12, [rsp+0B8h+var_80]
                mov     r8, r9
                mov     rcx, r12
                mov     rdx, rbp
                call    sub_1402DDB98
                mov     rdx, rbp
                call    sub_1402DECC0
                movzx   ebx, al
                jmp     loc_14028945A
; ---------------------------------------------------------------------------

loc_140289566:                          ; CODE XREF: sub_140289320+164↑j
                mov     r13d, 1
                mov     esi, r13d
                jmp     short loc_140289594
; ---------------------------------------------------------------------------

loc_140289571:                          ; CODE XREF: sub_140289320+147↑j
                mov     rdx, cs:qword_14001D278
                mov     rcx, r13
                call    sub_140289290
                test    eax, eax
                mov     r13d, 1
                cmovnz  esi, r13d
                jmp     short loc_140289594
; ---------------------------------------------------------------------------

loc_14028958E:                          ; CODE XREF: sub_140289320+13F↑j
                mov     r13d, 1

loc_140289594:                          ; CODE XREF: sub_140289320+24F↑j
                                        ; sub_140289320+26C↑j
                mov     [rsp+0B8h+var_90], r15d
                movzx   r9d, bl
                mov     r8, r13
                mov     [rsp+0B8h+var_98], r14d
                mov     rdx, rbp
                mov     rcx, r12
                call    sub_14028B7E0
                test    edi, edi
                jz      loc_14028973E
                mov     rax, rbp
                shr     rax, 12h
                and     eax, 3FFFFFF8h
                mov     rcx, 0FFFFF6FB40000000h
                add     rcx, rax
                mov     edi, ecx
                mov     rbx, [rcx]
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14028963D
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028963D
                test    bl, 1
                jz      short loc_14028963D
                test    bl, 20h
                jz      short loc_1402895F7
                test    bl, 42h
                jnz     short loc_14028963D

loc_1402895F7:                          ; CODE XREF: sub_140289320+2D0↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14028963D
                shr     rdi, 3
                mov     rdx, rbx
                and     edi, 1FFh
                or      rdx, 20h
                mov     rax, [rax+rdi*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14028963D
                or      rbx, 42h

loc_14028963D:                          ; CODE XREF: sub_140289320+2BD↑j
                                        ; sub_140289320+2C6↑j ...
                lea     rcx, [rsp+0B8h+var_78]
                mov     [rsp+0B8h+var_78], rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_1402896B2
                call    sub_140349680
                test    eax, eax
                jz      short loc_1402896B2
                test    bl, 1
                jz      short loc_1402896B2
                test    bl, 20h
                jz      short loc_140289668
                test    bl, 42h
                jnz     short loc_1402896B2

loc_140289668:                          ; CODE XREF: sub_140289320+341↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_1402896B2
                lea     rax, [rsp+0B8h+var_78]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_1402896B2
                or      rbx, 42h

loc_1402896B2:                          ; CODE XREF: sub_140289320+32E↑j
                                        ; sub_140289320+337↑j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rbx, [rbx+rbx*2]
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                mov     eax, [rbx]
                shr     rax, 4
                test    eax, 3FFh
                jnz     short loc_14028973E
                lea     r8, [rsp+0B8h+var_68]
                mov     rdx, rbp
                call    sub_1402FD640
                mov     cl, 8
                nop     word ptr [rax+rax+00000000h]

loc_140289700:                          ; CODE XREF: sub_140289320+3F2↓j
                add     cl, 0FFh
                movzx   eax, cl
                mov     r8d, [rsp+rax*4+0B8h+var_68]
                test    r8d, r8d
                jnz     short loc_140289716
                test    cl, cl
                jnz     short loc_140289700
                jmp     short loc_14028973E
; ---------------------------------------------------------------------------

loc_140289716:                          ; CODE XREF: sub_140289320+3EE↑j
                movzx   edx, cl
                and     r8d, 3FFh
                mov     rcx, [rbx]
                and     edx, 7
                shl     rdx, 0Ah
                and     rcx, 0FFFFFFFFFFFE000Fh
                or      rdx, r8
                shl     rdx, 4
                or      rdx, rcx
                mov     [rbx], rdx

loc_14028973E:                          ; CODE XREF: sub_140289320+292↑j
                                        ; sub_140289320+3C6↑j ...
                mov     rax, [rsp+0B8h+var_70]
                mov     [rax], esi
                mov     eax, r13d

loc_140289748:                          ; CODE XREF: sub_140289320+173↑j
                mov     rcx, [rsp+0B8h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                mov     rbx, [rsp+0B8h+arg_10]
                add     rsp, 80h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140289320
sub_140289320   endp

algn_140289771:                         ; DATA XREF: .pdata:00000001400CEC1C↑o
                align 8

; =============== S U B R O U T I N E =======================================


sub_140289778   proc near               ; CODE XREF: sub_14020A054+FC↑p
                                        ; sub_140220920+638↑p ...
                mov     al, [rcx+0B8h]
                and     al, 7
                jnz     short loc_140289789
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140289789:                          ; CODE XREF: sub_140289778+8↑j
                cmp     al, 2
                sbb     eax, eax
                and     eax, 2
                retn
sub_140289778   endp

; ---------------------------------------------------------------------------
                align 2
algn_140289792:                         ; DATA XREF: .pdata:00000001400CEC28↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402897A0   proc near               ; CODE XREF: sub_14023E510+DBE↑p
                                        ; DATA XREF: .pdata:00000001400CEC34↑o

; FUNCTION CHUNK AT 000000014044517C SIZE 0000008E BYTES

                mov     eax, cs:dword_140CFC450
                test    al, 2
                jz      short locret_1402897BA
                mov     rax, [rdx+84B8h]
                test    rax, rax
                jnz     loc_14044517C

locret_1402897BA:                       ; CODE XREF: sub_1402897A0+8↑j
                                        ; sub_1402897A0+1BB9E4↓j ...
                retn
sub_1402897A0   endp

; ---------------------------------------------------------------------------
                align 4
byte_1402897BC  db 14h dup(0CCh)        ; DATA XREF: .pdata:00000001400CEC34↑o

; =============== S U B R O U T I N E =======================================


sub_1402897D0   proc near               ; CODE XREF: sub_14025C570+178↑p
                                        ; sub_14025C570+2EF↑p ...

var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 000000014044520C SIZE 00000007 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 30h
                mov     edi, r8d
                mov     rbx, rdx
                mov     rsi, rcx
                test    rdx, rdx
                jz      short loc_14028982D
                movsx   eax, byte ptr [rdx+0C3h]
                cmp     al, 1Fh
                jz      loc_14044520C
                mov     r10d, eax
                test    dil, 2
                jnz     short loc_140289808
                inc     r10d

loc_140289808:                          ; CODE XREF: sub_1402897D0+33↑j
                mov     rdx, [rdx+68h]
                test    rdx, rdx
                jnz     short loc_140289856

loc_140289811:                          ; CODE XREF: sub_1402897D0+8F↓j
                                        ; sub_1402897D0+B5↓j
                mov     ecx, r10d

loc_140289814:                          ; CODE XREF: sub_1402897D0+84↓j
                mov     rdx, rsi
                call    sub_140242060

loc_14028981C:                          ; CODE XREF: sub_1402897D0+6D↓j
                                        ; sub_1402897D0+7A↓j ...
                mov     rbx, [rsp+38h+arg_0]
                mov     rsi, [rsp+38h+arg_8]
                add     rsp, 30h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028982D:                          ; CODE XREF: sub_1402897D0+1B↑j
                mov     rdx, rsi
                mov     ecx, 1
                call    sub_140242060
                test    rax, rax
                jnz     short loc_14028981C
                mov     rcx, rsi
                call    sub_1402CEC74
                test    rax, rax
                jnz     short loc_14028981C
                test    dil, 1
                jnz     short loc_14028981C
                xor     ecx, ecx
                jmp     short loc_140289814
; ---------------------------------------------------------------------------

loc_140289856:                          ; CODE XREF: sub_1402897D0+3F↑j
                mov     eax, [rcx+0D8h]
                add     rdx, rax
                jz      short loc_140289811
                mov     rax, gs:20h
                cmp     rsi, rax
                jnz     short loc_1402898A6

loc_14028986F:                          ; CODE XREF: sub_1402897D0+DA↓j
                mov     r9b, 1

loc_140289872:                          ; CODE XREF: sub_1402897D0+DF↓j
                mov     rcx, rbx
                mov     [rsp+38h+var_18], 0
                call    sub_1402D0A30
                test    eax, eax
                jz      short loc_140289811
                mov     r8d, r10d
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_14030B1EC
                mov     rbx, [rsp+38h+arg_0]
                mov     rsi, [rsp+38h+arg_8]
                add     rsp, 30h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_1402898A6:                          ; CODE XREF: sub_1402897D0+9D↑j
                cmp     rbx, [rcx+8]
                jnz     short loc_14028986F
                xor     r9b, r9b
                jmp     short loc_140289872
sub_1402897D0   endp

; ---------------------------------------------------------------------------
algn_1402898B1:                         ; DATA XREF: .rdata:000000014005EE74↑o
                                        ; .pdata:00000001400CEC40↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_1402898C0   proc near               ; CODE XREF: sub_14027FDE0+676↑p
                                        ; sub_14027FDE0+7BD↑p ...

var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 0000000140445214 SIZE 00000020 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 40h
                mov     rax, cs:qword_140C4E4C8
                xor     r9d, r9d
                movzx   r8d, word ptr [rcx+0AEh]
                mov     [rsp+48h+var_18], r9
                mov     rbx, [rax+r8*8]
                mov     rdi, [rbx+1AC0h]
                mov     rax, [rdi+38h]
                cmp     [rcx+60h], rax
                jnb     short loc_14028992E
                test    rdx, rdx
                jg      short loc_140289918
                cmp     [rcx+18h], r9
                lea     rsi, [rcx+18h]
                jz      short loc_140289918
                cmp     [rbx+1AD0h], rsi
                jnz     short loc_14028994D

loc_140289918:                          ; CODE XREF: sub_1402898C0+43↑j
                                        ; sub_1402898C0+4D↑j ...
                mov     rbx, [rsp+48h+arg_0]
                mov     rbp, [rsp+48h+arg_8]
                mov     rsi, [rsp+48h+arg_10]
                add     rsp, 40h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14028992E:                          ; CODE XREF: sub_1402898C0+3E↑j
                test    rdx, rdx
                js      short loc_140289918
                cmp     [rcx+18h], r9
                lea     rsi, [rcx+18h]
                jz      short loc_140289918
                cmp     [rbx+1AC8h], rsi
                jz      short loc_140289918
                mov     ebp, 1
                jmp     short loc_140289952
; ---------------------------------------------------------------------------

loc_14028994D:                          ; CODE XREF: sub_1402898C0+56↑j
                mov     ebp, 2

loc_140289952:                          ; CODE XREF: sub_1402898C0+8B↑j
                lea     rdx, qword_140C4ECC0
                mov     [rsp+48h+var_28], r9
                lea     rcx, [rsp+48h+var_28]
                mov     [rsp+48h+var_20], rdx
                call    sub_14024B3F0
                cmp     byte ptr [rdi+35h], 0
                jz      short loc_140289983

loc_140289973:                          ; CODE XREF: sub_1402898C0+C9↓j
                mov     byte ptr [rdi+36h], 1

loc_140289977:                          ; CODE XREF: sub_1402898C0+1BB96F↓j
                lea     rcx, [rsp+48h+var_28]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                jmp     short loc_140289918
; ---------------------------------------------------------------------------

loc_140289983:                          ; CODE XREF: sub_1402898C0+B1↑j
                mov     rax, [rsi]
                test    rax, rax
                jz      short loc_140289973
                cmp     [rax+8], rsi
                jnz     short loc_1402899D7
                mov     rcx, [rsi+8]
                cmp     [rcx], rsi
                jnz     short loc_1402899D7
                add     rbx, 1AC8h
                mov     [rcx], rax
                mov     [rax+8], rcx
                cmp     ebp, 1
                jz      loc_140445214
                mov     rax, [rbx+8]
                cmp     [rax], rbx
                jnz     short loc_1402899D7
                mov     [rsi], rbx
                lea     rcx, [rsp+48h+var_28]
                mov     [rsi+8], rax
                mov     [rax], rsi
                mov     [rbx+8], rsi
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                jmp     loc_140289918
; ---------------------------------------------------------------------------

loc_1402899D7:                          ; CODE XREF: sub_1402898C0+CF↑j
                                        ; sub_1402898C0+D8↑j ...
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
sub_1402898C0   endp

; ---------------------------------------------------------------------------
byte_1402899DE  db 12h dup(0CCh)        ; DATA XREF: .rdata:000000014005EE9C↑o
                                        ; .pdata:00000001400CEC4C↑o

; =============== S U B R O U T I N E =======================================


sub_1402899F0   proc near               ; CODE XREF: sub_140234C00+94↑p
                                        ; DATA XREF: .rdata:000000014005EEC4↑o ...

var_28          = qword ptr -28h
arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140445234 SIZE 000000EB BYTES

                mov     [rsp+arg_10], rbx
                mov     [rsp+arg_18], rbp
                push    rsi
                push    rdi
                push    r14
                sub     rsp, 30h
                xor     ebp, ebp
                mov     rbx, rcx
                mov     [rsp+48h+arg_8], rbp
                mov     rsi, cr8
                mov     r14d, 2
                mov     cr8, r14
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140445234

loc_140289A28:                          ; CODE XREF: sub_1402899F0+1BB846↓j
                                        ; sub_1402899F0+1BB850↓j ...
                mov     rdi, gs:20h
                mov     [rsp+48h+arg_0], ebp
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_140445279

loc_140289A45:                          ; CODE XREF: sub_1402899F0+15D↓j
                                        ; sub_1402899F0+1BB88D↓j ...
                lock bts qword ptr [rbx+40h], 0
                jb      loc_140289B18
                movsx   rcx, byte ptr [rbx+31Bh]
                movzx   eax, byte ptr [rcx+rbx+338h]
                test    al, al
                jz      loc_1404452E2
                sub     al, 1
                mov     [rcx+rbx+338h], al
                jnz     short loc_140289AB6
                mov     edx, [rbx+358h]
                mov     eax, 1
                btc     edx, ecx
                shl     eax, cl
                mov     [rbx+358h], edx
                cmp     edx, eax
                jnb     short loc_140289AB6
                movzx   edx, byte ptr [rbx+0C3h]
                cmp     dl, 10h
                jge     short loc_140289AB6
                movzx   eax, byte ptr [rbx+234h]
                movzx   ecx, al
                and     al, 0Fh
                shr     cl, 4
                add     cl, al
                add     cl, [rbx+233h]
                cmp     cl, dl
                jl      short loc_140289B05

loc_140289AB6:                          ; CODE XREF: sub_1402899F0+83↑j
                                        ; sub_1402899F0+9D↑j ...
                mov     [rbx+31Bh], bpl
                mov     [rbx+40h], rbp
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_1404452FB

loc_140289ADA:                          ; CODE XREF: sub_1402899F0+1BB90F↓j
                                        ; sub_1402899F0+1BB91E↓j ...
                mov     rcx, gs:20h
                lea     rdx, [rsp+48h+arg_8]
                movzx   r8d, sil
                call    sub_14028D950
                mov     rbx, [rsp+48h+arg_10]
                mov     rbp, [rsp+48h+arg_18]
                add     rsp, 30h
                pop     r14
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_140289B05:                          ; CODE XREF: sub_1402899F0+C4↑j
                movsx   r8d, cl
                lea     rdx, [rsp+48h+arg_8]
                mov     rcx, rbx
                call    sub_14025C570
                jmp     short loc_140289AB6
; ---------------------------------------------------------------------------

loc_140289B18:                          ; CODE XREF: sub_1402899F0+5C↑j
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jnz     loc_1404452A0
                nop     dword ptr [rax+rax+00000000h]

loc_140289B30:                          ; CODE XREF: sub_1402899F0+151↓j
                                        ; sub_1402899F0+1BB8B4↓j ...
                lea     rcx, [rsp+48h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rbx+40h]
                test    rax, rax
                jnz     short loc_140289B30
                mov     rcx, [rdi+84B8h]
                test    rcx, rcx
                jz      loc_140289A45
                jmp     loc_1404452C7
sub_1402899F0   endp

; ---------------------------------------------------------------------------
algn_140289B58:                         ; DATA XREF: .rdata:000000014005EEC4↑o
                                        ; .pdata:00000001400CEC58↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=200h

sub_140289B60   proc near               ; CODE XREF: sub_1402335C0+35B↑p
                                        ; sub_1402EBCF0+43↓p ...

var_2E0         = byte ptr -2E0h
var_2DC         = dword ptr -2DCh
var_2D8         = dword ptr -2D8h
var_2D4         = dword ptr -2D4h
var_2D0         = dword ptr -2D0h
var_2CC         = dword ptr -2CCh
var_2C8         = dword ptr -2C8h
var_2C0         = qword ptr -2C0h
var_2B8         = qword ptr -2B8h
var_2B0         = qword ptr -2B0h
var_2A0         = xmmword ptr -2A0h
var_290         = qword ptr -290h
var_288         = qword ptr -288h
var_280         = qword ptr -280h
var_278         = qword ptr -278h
var_270         = qword ptr -270h
var_260         = xmmword ptr -260h
var_250         = qword ptr -250h
var_248         = qword ptr -248h
var_240         = qword ptr -240h
var_238         = qword ptr -238h
var_230         = xmmword ptr -230h
var_220         = xmmword ptr -220h
var_210         = xmmword ptr -210h
var_200         = xmmword ptr -200h
var_1F0         = xmmword ptr -1F0h
var_1E0         = xmmword ptr -1E0h
var_1D0         = qword ptr -1D0h
var_1C8         = qword ptr -1C8h
var_1C0         = qword ptr -1C0h
var_1B8         = qword ptr -1B8h
var_1B0         = xmmword ptr -1B0h
var_1A0         = xmmword ptr -1A0h
var_190         = xmmword ptr -190h
var_180         = xmmword ptr -180h
var_170         = xmmword ptr -170h
var_160         = xmmword ptr -160h
var_150         = xmmword ptr -150h
var_140         = xmmword ptr -140h
var_130         = xmmword ptr -130h
var_120         = qword ptr -120h
var_110         = dword ptr -110h
var_10C         = word ptr -10Ch
var_10A         = word ptr -10Ah
var_108         = qword ptr -108h
var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = xmmword ptr -0F0h
var_E0          = xmmword ptr -0E0h
var_D0          = xmmword ptr -0D0h
var_C0          = xmmword ptr -0C0h
var_B0          = xmmword ptr -0B0h
var_A0          = xmmword ptr -0A0h
var_90          = xmmword ptr -90h
var_80          = xmmword ptr -80h
var_70          = xmmword ptr -70h
var_60          = qword ptr -60h
var_50          = qword ptr -50h
arg_20          = byte ptr  30h
arg_28          = dword ptr  38h
arg_30          = qword ptr  40h

; __unwind { // __GSHandlerCheck
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                lea     rbp, [rsp-1C8h]
                sub     rsp, 2C8h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+200h+var_50], rax
                mov     r12d, [rbp+200h+arg_28]
                xorps   xmm0, xmm0
                mov     r13, [rbp+200h+arg_30]
                mov     r14, rcx
                xor     ecx, ecx
                mov     [rsp+300h+var_2B0], r8
                mov     [rbp+200h+var_10A], cx
                mov     r15, r8
                mov     [rbp+200h+var_60], rcx
                movzx   eax, dl
                mov     [rsp+300h+var_290], rcx
                mov     r11d, r12d
                movzx   ecx, [rbp+200h+arg_20]
                mov     r8d, r12d
                and     cl, 7
                mov     [rsp+300h+var_2E0], dl
                shl     cl, 2
                and     r8d, 200h
                mov     [rbp+200h+arg_20], cl
                mov     edx, r12d
                mov     ecx, 800h
                mov     [rsp+300h+var_2C0], r9
                and     r11d, ecx
                mov     [rsp+300h+var_2D4], r8d
                and     edx, 100h
                mov     [rsp+300h+var_2C8], r11d
                mov     ecx, r12d
                mov     [rsp+300h+var_2D8], edx
                and     ecx, 80h
                xor     bl, bl
                mov     r10d, r12d
                mov     [rsp+300h+var_2CC], ecx
                and     r10d, 10h
                mov     [rsp+300h+var_2D0], r10d
                movups  [rbp+200h+var_F0], xmm0
                movups  [rbp+200h+var_E0], xmm0
                movups  [rbp+200h+var_D0], xmm0
                movups  [rbp+200h+var_C0], xmm0
                movups  [rbp+200h+var_B0], xmm0
                movups  [rbp+200h+var_A0], xmm0
                movups  [rbp+200h+var_90], xmm0
                movups  [rbp+200h+var_80], xmm0
                movups  [rbp+200h+var_70], xmm0
                movups  [rsp+300h+var_2A0], xmm0

loc_140289C68:                          ; CODE XREF: sub_140289B60+6EB↓j
                mov     [rsp+300h+var_2DC], ebx
                nop     dword ptr [rax+00h]
                xorps   xmm0, xmm0
                movzx   esi, al
                xor     eax, eax
                xorps   xmm1, xmm1
                mov     [rbp+200h+var_120], rax
                mov     rcx, r14
                or      dword ptr [rbp+200h+var_120], 2
                xor     dil, dil
                movups  [rbp+200h+var_1A0], xmm0
                mov     [rbp+200h+var_1D0], rax
                movups  [rbp+200h+var_150], xmm0
                mov     qword ptr [rbp+200h+var_1A0], r13
                movups  [rbp+200h+var_1B0], xmm0
                mov     dword ptr [rbp+200h+var_150+8], r12d
                movups  [rbp+200h+var_190], xmm0
                movups  [rbp+200h+var_180], xmm0
                movups  [rbp+200h+var_170], xmm0
                movups  [rbp+200h+var_160], xmm0
                movups  [rbp+200h+var_140], xmm0
                movups  [rbp+200h+var_130], xmm0
                movaps  [rbp+200h+var_260], xmm1
                movups  [rbp+200h+var_230], xmm0
                movups  [rbp+200h+var_220], xmm0
                movups  [rbp+200h+var_210], xmm0
                movups  [rbp+200h+var_200], xmm0
                movups  [rbp+200h+var_1F0], xmm0
                movups  [rbp+200h+var_1E0], xmm0
                call    sub_140289778
                mov     [rbp+200h+var_110], eax
                xor     ecx, ecx
                test    byte ptr cs:xmmword_140CFC480+4, 1
                lea     rax, [rbp+200h+var_110]
                mov     [rbp+200h+var_250], rax
                movzx   eax, byte ptr [rbp+200h+var_150+0Ch]
                mov     [rbp+200h+var_10C], cx
                mov     [rbp+200h+var_100], rcx
                mov     [rbp+200h+var_F8], rcx
                mov     ecx, 1
                cmovnz  eax, ecx
                psrldq  xmm1, 2
                mov     byte ptr [rbp+200h+var_150+0Ch], al
                movd    eax, xmm1
                mov     [rbp+200h+var_108], 14h
                and     al, 0E3h
                or      al, [rbp+200h+arg_20]
                mov     byte ptr [rbp+200h+var_260+2], al
                lea     rax, [rbp+200h+var_1B0]
                mov     [rbp+200h+var_1B8], rax
                mov     eax, 27h ; '''
                mov     word ptr [rbp+200h+var_260], ax
                test    r8d, r8d
                jz      short loc_140289D77
                mov     eax, 423h
                mov     word ptr [rbp+200h+var_260], ax

loc_140289D77:                          ; CODE XREF: sub_140289B60+20C↑j
                test    edx, edx
                jz      short loc_140289D87
                mov     ecx, 800h
                or      ax, cx
                mov     word ptr [rbp+200h+var_260], ax

loc_140289D87:                          ; CODE XREF: sub_140289B60+219↑j
                movzx   ecx, byte ptr [rbp+200h+var_260+5]
                test    r11d, r11d
                mov     edx, 3Fh ; '?'
                mov     [rbp+200h+var_240], r15
                cmovnz  ecx, edx
                mov     [rbp+200h+var_238], r9
                mov     byte ptr [rbp+200h+var_260+5], cl
                xor     r12b, r12b
                mov     [rbp+200h+var_248], r14
                lea     rcx, sub_14028A280
                mov     [rbp+200h+var_1C8], rcx
                lea     rcx, sub_14028E9D0
                mov     [rbp+200h+var_1C0], rcx
                test    r10d, r10d
                jz      short loc_140289DEA
                mov     rax, [r13+20h]
                mov     rcx, [rax+20h]
                mov     rax, gs:188h
                dec     word ptr [rax+1E6h]
                add     rcx, 38h ; '8'
                xor     edx, edx
                call    ExAcquireAutoExpandPushLockExclusive
                movzx   eax, word ptr [rbp+200h+var_260]

loc_140289DEA:                          ; CODE XREF: sub_140289B60+261↑j
                cmp     [rsp+300h+var_2E0], 11h
                jz      short loc_140289E05
                mov     ecx, 0FFFDh
                mov     r12b, 1
                and     ax, cx
                mov     word ptr [rbp+200h+var_260], ax
                jmp     loc_140289EC3
; ---------------------------------------------------------------------------

loc_140289E05:                          ; CODE XREF: sub_140289B60+28F↑j
                test    byte ptr [rbp+200h+var_260], 4
                jz      loc_140289E99
                movzx   eax, byte ptr [r14+0B8h]
                and     al, 7
                cmp     al, 6
                jb      short loc_140289E72
                mov     rsi, cr8
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      loc_140289EBA
                test    al, 1
                jz      short loc_140289EBA
                cmp     sil, 0Fh
                ja      short loc_140289EBA
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d
                jmp     short loc_140289EBA
; ---------------------------------------------------------------------------

loc_140289E72:                          ; CODE XREF: sub_140289B60+2BB↑j
                lea     rbx, unk_140C4F600
                cmp     al, 2
                jz      short loc_140289E84
                lea     rbx, [r14+0C0h]

loc_140289E84:                          ; CODE XREF: sub_140289B60+31B↑j
                mov     rcx, rbx
                call    ExAcquireSpinLockShared
                cmp     dword ptr [rbx+4], 0
                jz      short loc_140289EB3
                xor     ecx, ecx
                xchg    ecx, [rbx+4]
                jmp     short loc_140289EB3
; ---------------------------------------------------------------------------

loc_140289E99:                          ; CODE XREF: sub_140289B60+2A9↑j
                mov     rcx, r14
                call    sub_1402325E0
                mov     rcx, rax
                mov     rbx, rax
                call    ExAcquireSpinLockExclusive
                mov     dword ptr [rbx+4], 0

loc_140289EB3:                          ; CODE XREF: sub_140289B60+330↑j
                                        ; sub_140289B60+337↑j
                mov     ebx, [rsp+300h+var_2DC]
                movzx   esi, al

loc_140289EBA:                          ; CODE XREF: sub_140289B60+2D2↑j
                                        ; sub_140289B60+2DA↑j ...
                movzx   eax, word ptr [rbp+200h+var_260]
                mov     ecx, 0FFFDh

loc_140289EC3:                          ; CODE XREF: sub_140289B60+2A0↑j
                cmp     [rsp+300h+var_2D8], 0
                mov     byte ptr [rbp+200h+var_260+6], sil
                jz      short loc_140289F10
                cmp     [rsp+300h+var_2D4], 0
                jnz     short loc_140289EE5
                mov     edx, 0FFFBh
                and     ax, dx
                mov     edx, 1000h
                or      ax, dx

loc_140289EE5:                          ; CODE XREF: sub_140289B60+373↑j
                and     ax, cx
                mov     rcx, r14
                mov     word ptr [rbp+200h+var_260], ax
                call    sub_1402325E0
                lea     rcx, [rsp+300h+var_2A0]
                mov     qword ptr [rsp+300h+var_2A0], 0
                lea     rdx, [rax+40h]
                mov     qword ptr [rsp+300h+var_2A0+8], rdx
                call    sub_14024B3F0

loc_140289F10:                          ; CODE XREF: sub_140289B60+36C↑j
                cmp     [rsp+300h+var_2CC], 0
                jz      loc_14028A048
                test    bl, bl
                jnz     loc_14028A048
                mov     rax, r15
                mov     rcx, 0FFFFFFE00000h
                xor     rax, [rsp+300h+var_2C0]
                test    rcx, rax
                jnz     loc_14028A048
                xor     r8d, r8d
                mov     rdx, r15
                mov     rcx, r14
                call    sub_1402258A0
                movsxd  rdx, eax
                test    eax, eax
                jz      loc_14028A048
                mov     rbx, r15
                mov     r8, 0FFFFF68000000000h
                shr     rbx, 9
                mov     r9, 7FFFFFFFF8h
                and     rbx, r9
                mov     rcx, r8
                add     rbx, rcx
                mov     rcx, rbx
                mov     [rsp+300h+var_288], rbx
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                add     rcx, rax
                mov     [rbp+200h+var_280], rcx
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                add     rcx, rax
                mov     [rbp+200h+var_278], rcx
                shr     rcx, 9
                and     rcx, r9
                mov     rax, r8
                add     rcx, rax
                mov     [rbp+200h+var_270], rcx
                mov     r15, [rsp+rdx*8+300h+var_288]
                cmp     edx, 1
                jnz     short loc_14028A038
                mov     rdi, [rsp+300h+var_2C0]
                shr     rdi, 9
                and     rdi, r9
                mov     rax, r8
                add     rdi, rax
                cmp     rbx, rdi
                ja      short loc_14028A002
                nop     word ptr [rax+rax+00000000h]

loc_140289FE0:                          ; CODE XREF: sub_140289B60+4A0↓j
                xor     r8d, r8d
                lea     rcx, [rbp+200h+var_260]
                mov     rdx, rbx
                call    sub_14028A280
                movzx   eax, byte ptr [rbp+200h+var_260+3]
                inc     eax
                mov     byte ptr [rbp+200h+var_260+3], 0
                lea     rbx, [rbx+rax*8]
                cmp     rbx, rdi
                jbe     short loc_140289FE0

loc_14028A002:                          ; CODE XREF: sub_140289B60+475↑j
                lea     rcx, [rbp+200h+var_260]
                call    sub_14028E9D0
                mov     rcx, [rsp+300h+var_2B0]
                call    sub_14029BB60
                mov     ecx, [rax+10h]
                mov     eax, [rsp+300h+var_2DC]
                shr     rcx, 10h
                and     ecx, 3FFh
                movzx   eax, al
                mov     ecx, 1
                cmovz   eax, ecx
                movzx   edi, cl
                mov     [rsp+300h+var_2DC], eax

loc_14028A038:                          ; CODE XREF: sub_140289B60+45E↑j
                mov     rdx, r15
                mov     rcx, r14
                call    sub_140312B40
                test    dil, dil
                jnz     short loc_14028A051

loc_14028A048:                          ; CODE XREF: sub_140289B60+3B5↑j
                                        ; sub_140289B60+3BD↑j ...
                lea     rcx, [rbp+200h+var_260]
                call    sub_140220490

loc_14028A051:                          ; CODE XREF: sub_140289B60+4E6↑j
                cmp     [rsp+300h+var_2D8], 0
                jz      short loc_14028A06E
                lea     rcx, [rsp+300h+var_2A0]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                cmp     [rsp+300h+var_2D4], 0
                jnz     short loc_14028A06E
                or      word ptr [rbp+200h+var_260], 4

loc_14028A06E:                          ; CODE XREF: sub_140289B60+4F6↑j
                                        ; sub_140289B60+507↑j
                test    r12b, r12b
                jnz     loc_14028A1A2
                test    byte ptr [rbp+200h+var_260], 4
                jz      loc_14028A196
                movzx   eax, byte ptr [r14+0B8h]
                and     al, 7
                cmp     al, 6
                jnb     loc_14028A132
                mov     eax, [r14+0B8h]
                mov     ecx, eax
                shr     ecx, 18h
                test    cl, 8
                jnz     short loc_14028A0AE
                test    cl, 4
                jnz     short loc_14028A0AE
                test    cl, 10h
                jz      short loc_14028A0C2

loc_14028A0AE:                          ; CODE XREF: sub_140289B60+542↑j
                                        ; sub_140289B60+547↑j
                movzx   edx, sil
                mov     rcx, r14
                call    sub_1403580AC
                movzx   eax, byte ptr [r14+0B8h]

loc_14028A0C2:                          ; CODE XREF: sub_140289B60+54C↑j
                and     al, 7
                lea     rbx, unk_140C4F600
                cmp     al, 2
                jz      short loc_14028A0D6
                lea     rbx, [r14+0C0h]

loc_14028A0D6:                          ; CODE XREF: sub_140289B60+56D↑j
                mov     edx, 1
                mov     rcx, r14
                call    sub_140226A50
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_14028A0FD
                mov     rdx, [rbp+208h]
                mov     rcx, rbx
                call    sub_1405B6074
                jmp     short loc_14028A107
; ---------------------------------------------------------------------------

loc_14028A0FD:                          ; CODE XREF: sub_140289B60+58A↑j
                lock and dword ptr [rbx], 0BFFFFFFFh
                lock dec dword ptr [rbx]

loc_14028A107:                          ; CODE XREF: sub_140289B60+59B↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14028A132
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14028A132
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14028A132
                call    sub_1403F2EC4

loc_14028A132:                          ; CODE XREF: sub_140289B60+52D↑j
                                        ; sub_140289B60+5BA↑j ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14028A18C
                test    al, 1
                jz      short loc_14028A18C
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14028A18C
                cmp     sil, 0Fh
                ja      short loc_14028A18C
                cmp     al, 2
                jb      short loc_14028A18C
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14028A18C
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14028A18C:                          ; CODE XREF: sub_140289B60+5DA↑j
                                        ; sub_140289B60+5DE↑j ...
                movzx   eax, sil
                mov     cr8, rax
                jmp     short loc_14028A1A2
; ---------------------------------------------------------------------------

loc_14028A196:                          ; CODE XREF: sub_140289B60+51B↑j
                movzx   edx, sil
                mov     rcx, r14
                call    sub_140234180

loc_14028A1A2:                          ; CODE XREF: sub_140289B60+511↑j
                                        ; sub_140289B60+634↑j
                mov     rcx, [r13+28h]
                test    rcx, rcx
                jns     short loc_14028A1CB
                lea     rdx, [rsp+300h+var_2B8]
                mov     [rsp+300h+var_2B8], 0
                call    sub_14055E698
                mov     [r13+8], rax
                mov     rax, [rsp+300h+var_2B8]
                mov     [r13+28h], rax

loc_14028A1CB:                          ; CODE XREF: sub_140289B60+649↑j
                mov     rcx, [r13+20h]
                test    rcx, rcx
                jz      short loc_14028A1EB
                mov     rdx, qword ptr [rbp+200h+var_140]
                test    rdx, rdx
                jz      short loc_14028A1EB
                mov     r8d, 1
                call    sub_14054BDB8

loc_14028A1EB:                          ; CODE XREF: sub_140289B60+672↑j
                                        ; sub_140289B60+67E↑j
                mov     r10d, [rsp+300h+var_2D0]
                test    r10d, r10d
                jz      short loc_14028A21E
                mov     rbx, gs:188h
                mov     rax, [r13+20h]
                xor     edx, edx
                mov     rcx, [rax+20h]
                add     rcx, 38h ; '8'
                call    ExReleaseAutoExpandPushLockExclusive
                mov     rcx, rbx
                call    sub_140245770
                mov     r10d, [rsp+300h+var_2D0]

loc_14028A21E:                          ; CODE XREF: sub_140289B60+693↑j
                cmp     byte ptr [rsp+300h+var_2DC], 1
                jnz     short loc_14028A250
                mov     r15, [rsp+300h+var_2B0]
                mov     bl, 2
                mov     edx, [rsp+300h+var_2D8]
                mov     r8d, [rsp+300h+var_2D4]
                mov     r9, [rsp+300h+var_2C0]
                movzx   eax, [rsp+300h+var_2E0]
                mov     r11d, [rsp+300h+var_2C8]
                mov     r12d, [rbp+200h+arg_28]
                jmp     loc_140289C68
; ---------------------------------------------------------------------------

loc_14028A250:                          ; CODE XREF: sub_140289B60+6C3↑j
                mov     rcx, [rbp+200h+var_50]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 2C8h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140289B60
sub_140289B60   endp

algn_14028A274:                         ; DATA XREF: .pdata:00000001400CEC64↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

sub_14028A280   proc near               ; CODE XREF: sub_140289B60+48A↑p
                                        ; DATA XREF: .rdata:0000000140009160↑o ...

var_D0          = qword ptr -0D0h
var_C8          = dword ptr -0C8h
var_C0          = qword ptr -0C0h
var_B8          = dword ptr -0B8h
var_B4          = dword ptr -0B4h
var_B0          = qword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = dword ptr -0A0h
var_98          = qword ptr -98h
var_90          = qword ptr -90h
var_88          = qword ptr -88h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = dword ptr -60h
var_40          = qword ptr -40h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
arg_18          = qword ptr  28h

; __unwind { // __GSHandlerCheck
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                lea     rbp, [rsp-3Fh]
                sub     rsp, 0D8h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+57h+var_40], rax
                mov     rbx, [rdx]
                mov     rsi, rdx
                mov     rdx, 0FFFFF6FB7DBED000h
                mov     r9d, r8d
                mov     [rbp+57h+var_B4], r8d
                mov     rdi, rcx
                mov     rax, rdx
                mov     r11, 0FFFFF6FB7DBED7F8h
                cmp     rsi, rax
                jb      loc_14028A361
                mov     rax, r11
                cmp     rsi, rax
                ja      loc_14028A361
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14028A357
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14028A357
                test    bl, 1
                jz      short loc_14028A357
                test    bl, 20h
                jz      short loc_14028A30F
                test    bl, 42h
                jnz     short loc_14028A357

loc_14028A30F:                          ; CODE XREF: sub_14028A280+88↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028A357
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14028A357
                or      rbx, 42h

loc_14028A357:                          ; CODE XREF: sub_14028A280+65↑j
                                        ; sub_14028A280+7E↑j ...
                mov     rdx, 0FFFFF6FB7DBED000h
; } // starts at 14028A280

loc_14028A361:                          ; CODE XREF: sub_14028A280+49↑j
                                        ; sub_14028A280+55↑j
                                        ; DATA XREF: ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+0F0h+arg_18], r12
                mov     [rsp+0F0h+var_20], r13
                mov     [rsp+0F0h+var_28], r14
                mov     [rsp+0F0h+var_30], r15
                mov     [rbp+57h+var_80], rbx
                test    rbx, rbx
                jnz     loc_14028A486
                test    r9d, r9d
                jnz     loc_14028B39F
                mov     r10, [rdi+58h]
                mov     rax, rsi
                and     rax, 0FFFFFFFFFFFFF000h
                mov     r9b, 1
                add     rax, 0FF8h
                cmp     r10, rax
                cmova   r10, rax
                add     rsi, 8
                cmp     rsi, r10
                ja      loc_14028A47A

loc_14028A3C1:                          ; CODE XREF: sub_14028A280+1F4↓j
                mov     rcx, [rsi]
                mov     rax, rdx
                cmp     rsi, rax
                jb      loc_14028A462
                mov     rax, r11
                cmp     rsi, rax
                ja      loc_14028A462
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14028A458
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_14028A458
                test    cl, 1
                jz      short loc_14028A458
                test    cl, 20h
                jz      short loc_14028A410
                test    cl, 42h
                jnz     short loc_14028A458

loc_14028A410:                          ; CODE XREF: sub_14028A280+189↑j
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     r8, [rdx+788h]
                test    r8, r8
                jz      short loc_14028A458
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rcx
                or      r8, 20h
                movzx   edx, al
                and     dl, 20h
                cmovz   r8, rcx
                mov     rcx, r8
                test    al, 42h
                jz      short loc_14028A458
                or      rcx, 42h

loc_14028A458:                          ; CODE XREF: sub_14028A280+166↑j
                                        ; sub_14028A280+17F↑j ...
                mov     rdx, 0FFFFF6FB7DBED000h

loc_14028A462:                          ; CODE XREF: sub_14028A280+14A↑j
                                        ; sub_14028A280+156↑j
                test    rcx, rcx
                jnz     short loc_14028A47A
                add     r9b, 1
                jz      short loc_14028A47A
                add     rsi, 8
                cmp     rsi, r10
                jbe     loc_14028A3C1

loc_14028A47A:                          ; CODE XREF: sub_14028A280+13B↑j
                                        ; sub_14028A280+1E5↑j ...
                dec     r9b
                mov     [rdi+3], r9b
                jmp     loc_14028B39F
; ---------------------------------------------------------------------------

loc_14028A486:                          ; CODE XREF: sub_14028A280+108↑j
                mov     r13, [rdi+0A8h]
                mov     r15, rsi
                mov     r8, [rdi+18h]
                mov     r14, [rdi+10h]
                mov     [rbp+57h+var_A8], r13
                mov     r12d, [r13+68h]
                mov     [rbp+57h+var_C0], r8
                shl     r15, 19h
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                shl     rax, 19h
                sub     r15, rax
                sar     r15, 10h
                test    bl, 1
                jz      loc_14028B3DA
                cmp     r9d, 1
                jl      short loc_14028A4FB
                mov     rdx, rsi
                mov     rcx, rdi
                test    bl, bl
                jns     short loc_14028A4E6
                mov     r8d, r9d
                call    sub_14054FB5C
                jmp     loc_14028B39F
; ---------------------------------------------------------------------------

loc_14028A4E6:                          ; CODE XREF: sub_14028A280+257↑j
                call    sub_1402A8050
                test    eax, eax
                jz      loc_14028B39F
                mov     r8, [rbp+57h+var_C0]
                mov     r9d, [rbp+57h+var_B4]

loc_14028A4FB:                          ; CODE XREF: sub_14028A280+24D↑j
                test    byte ptr [r8+0B8h], 7
                jnz     loc_14028B269
                mov     rcx, 0FFFFF6FFFFFFFFFFh
                mov     rax, 7FFFFFFFF8h
                test    r9d, r9d
                jnz     loc_14028A832
                bt      r12d, 0Bh
                jnb     short loc_14028A54A
                xor     r8d, r8d
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_14054FB5C
                xor     edx, edx
                mov     rcx, r14
                call    sub_14033B0A4
                jmp     loc_14028B39F
; ---------------------------------------------------------------------------

loc_14028A54A:                          ; CODE XREF: sub_14028A280+2AB↑j
                test    r12b, 10h
                jz      short loc_14028A57A
                mov     rcx, [r13+10h]
                lea     r8, [r13+70h]
                mov     rdx, rsi
                mov     rcx, [rcx+20h]
                call    sub_14054BD04
                xor     r9d, r9d
                mov     r8, rax
                mov     rdx, r15
                mov     rcx, r14
                call    sub_1402882E0
                jmp     loc_14028B326
; ---------------------------------------------------------------------------

loc_14028A57A:                          ; CODE XREF: sub_14028A280+2CE↑j
                test    r12b, 60h
                jz      short loc_14028A590
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_14037E9A8
                jmp     loc_14028B326
; ---------------------------------------------------------------------------

loc_14028A590:                          ; CODE XREF: sub_14028A280+2FE↑j
                test    r12b, 8
                jz      short loc_14028A5E0
                mov     rcx, rsi
                call    sub_140342C88
                cmp     eax, 1
                jnz     short loc_14028A5D2
                xor     eax, eax
                lea     r9, [rbp+57h+var_68]
                xor     r8d, r8d
                mov     [rbp+57h+var_68], rax
                mov     rcx, rsi
                lea     edx, [rax+3]
                call    sub_140353B08
                xor     r9d, r9d
                mov     rdx, r15
                mov     rcx, r14
                lea     r8d, [r9+1]
                call    sub_1402882E0
                jmp     loc_14028B326
; ---------------------------------------------------------------------------

loc_14028A5D2:                          ; CODE XREF: sub_14028A280+321↑j
                mov     r8, [rbp+57h+var_C0]
                mov     rcx, 0FFFFF6FFFFFFFFFFh

loc_14028A5E0:                          ; CODE XREF: sub_14028A280+314↑j
                mov     eax, r12d
                and     al, 90h
                cmp     al, 80h
                jnz     loc_14028A828
                test    r12b, 2
                jz      loc_14028A710
                test    byte ptr [r8+0BBh], 1
                jnz     loc_14028A710
                cmp     cs:dword_140C4E6A8, 0
                jz      loc_14028A710
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                cmp     r15, rax
                jb      short loc_14028A630
                mov     rax, rcx
                cmp     r15, rax
                jbe     loc_14028A700

loc_14028A630:                          ; CODE XREF: sub_14028A280+3A2↑j
                mov     r8, r15
                mov     rax, 7FFFFFFFF8h
                shr     r8, 9
                and     r8, rax
                mov     rax, rdx
                add     r8, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rcx, [r8]
                mov     rax, rax
                cmp     r8, rax
                jb      loc_14028A6F0
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r8, rax
                ja      short loc_14028A6F0
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14028A6F0
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     byte ptr [rdx+390h], 1
                jz      short loc_14028A6F0
                test    cl, 1
                jz      short loc_14028A6F0
                test    cl, 20h
                jz      short loc_14028A6A9
                test    cl, 42h
                jnz     short loc_14028A6F0

loc_14028A6A9:                          ; CODE XREF: sub_14028A280+422↑j
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                mov     rax, [rdx+788h]
                test    rax, rax
                jz      short loc_14028A6F0
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rcx
                or      r8, 20h
                movzx   edx, al
                and     dl, 20h
                cmovz   r8, rcx
                mov     rcx, r8
                test    al, 42h
                jz      short loc_14028A6F0
                or      rcx, 42h

loc_14028A6F0:                          ; CODE XREF: sub_14028A280+3DD↑j
                                        ; sub_14028A280+3F3↑j ...
                shr     rcx, 38h
                and     cl, 0Fh
                cmp     cl, 7
                jz      short loc_14028A710
                mov     r8, [rbp+57h+var_C0]

loc_14028A700:                          ; CODE XREF: sub_14028A280+3AA↑j
                test    byte ptr [rsi], 20h
                jz      short loc_14028A710
                mov     rdx, rsi
                mov     rcx, r8
                call    sub_14028CE50

loc_14028A710:                          ; CODE XREF: sub_14028A280+371↑j
                                        ; sub_14028A280+37F↑j ...
                lea     rcx, [rbp+57h+var_80]
                mov     rdi, rbx
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_14028A792
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14028A792
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14028A792
                test    bl, 20h
                jz      short loc_14028A74F
                test    bl, 42h
                jnz     short loc_14028A792

loc_14028A74F:                          ; CODE XREF: sub_14028A280+4C8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028A792
                or      rdi, 20h
                lea     rax, [rbp+57h+var_80]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdi, rbx
                test    al, 42h
                jz      short loc_14028A792
                or      rdi, 42h

loc_14028A792:                          ; CODE XREF: sub_14028A280+49E↑j
                                        ; sub_14028A280+4AA↑j ...
                shr     rdi, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdi, rax
                mov     rax, 0FFFFFA8000000000h
                lea     rdi, [rdi+rdi*2]
                shl     rdi, 4
                mov     rax, rax
                add     rdi, rax
                mov     rcx, 3FFFFFFFFFFFFFFFh
                mov     rax, [rdi+18h]
                and     rax, rcx
                cmp     rax, 1
                jnz     short loc_14028A828
                test    al, r12b
                jz      short loc_14028A7F1
                mov     rcx, rdi
                call    sub_14022FC60
                sub     eax, 3
                cmp     eax, 2
                ja      short loc_14028A7F1
                mov     edx, 2
                call    sub_14031B1DC

loc_14028A7F1:                          ; CODE XREF: sub_14028A280+555↑j
                                        ; sub_14028A280+565↑j
                test    r12b, 4
                jz      short loc_14028A828
                cmp     qword ptr [r13+58h], 0
                jnz     short loc_14028A828
                test    bl, 42h
                jnz     short loc_14028A828
                mov     rcx, rdi
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14028A828
                test    byte ptr [rdi+22h], 10h
                jnz     short loc_14028A828
                call    sub_14022FC60
                cmp     eax, 5
                jnb     short loc_14028A828
                call    sub_140341438
                mov     [r13+58h], rax

loc_14028A828:                          ; CODE XREF: sub_14028A280+367↑j
                                        ; sub_14028A280+550↑j ...
                mov     rax, 7FFFFFFFF8h

loc_14028A832:                          ; CODE XREF: sub_14028A280+2A0↑j
                bt      r12d, 8
                jnb     short loc_14028A884
                xor     r9d, r9d
                mov     rdx, r15
                mov     rcx, r14
                lea     r8d, [r9+1]
                call    sub_1402882E0

loc_14028A84B:                          ; CODE XREF: sub_14028A280+1000↓j
                                        ; sub_14028A280+1016↓j ...
                mov     r13, [rbp+57h+var_C0]

loc_14028A84F:                          ; CODE XREF: sub_14028A280+DFF↓j
                                        ; sub_14028A280+EBA↓j ...
                and     rbx, 0FFFFFFFFFFFFFFFEh
                bts     rbx, 0Ah
                cmp     [rbp+57h+var_B4], 3
                mov     [rbp+57h+var_80], rbx
                jnz     loc_14028B2DF
                test    byte ptr [r13+0B8h], 7
                jz      loc_14028B2DF
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_14039EB7C
                jmp     loc_14028B326
; ---------------------------------------------------------------------------

loc_14028A884:                          ; CODE XREF: sub_14028A280+5B7↑j
                xor     r10d, r10d
                mov     [rbp+57h+var_88], r10
                cmp     [rbp+57h+var_B4], r10d
                jnz     loc_14028ABA6
                mov     r8, r15
                mov     r9, 0FFFFF68000000000h
                shr     r8, 9
                and     r8, rax
                mov     rax, r9
                add     r8, rax
                mov     rdi, 0FFFFF6FB7DBED000h
                mov     rdx, [r8]
                mov     rax, rdi
                mov     r11, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                jb      short loc_14028A935
                mov     rax, r11
                cmp     r8, rax
                ja      short loc_14028A935
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028A935
                test    dl, 1
                jz      short loc_14028A935
                test    dl, 20h
                jz      short loc_14028A8EE
                test    dl, 42h
                jnz     short loc_14028A935

loc_14028A8EE:                          ; CODE XREF: sub_14028A280+667↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14028A935
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028A935
                or      rdx, 42h

loc_14028A935:                          ; CODE XREF: sub_14028A280+64C↑j
                                        ; sub_14028A280+654↑j ...
                shr     rdx, 38h
                and     dl, 0Fh
                cmp     dl, 8
                jz      loc_14028ABA6
                mov     r8, r15
                lea     r12, [r13+78h]
                shr     r8, 9
                mov     rax, 7FFFFFFFF8h
                and     r8, rax
                mov     rax, r9
                add     r8, rax
                mov     rdx, [r8]
                mov     rax, rdi
                cmp     r8, rax
                jb      short loc_14028A9D5
                mov     rax, r11
                cmp     r8, rax
                ja      short loc_14028A9D5
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028A9D5
                test    dl, 1
                jz      short loc_14028A9D5
                test    dl, 20h
                jz      short loc_14028A98E
                test    dl, 42h
                jnz     short loc_14028A9D5

loc_14028A98E:                          ; CODE XREF: sub_14028A280+707↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14028A9D5
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028A9D5
                or      rdx, 42h

loc_14028A9D5:                          ; CODE XREF: sub_14028A280+6EC↑j
                                        ; sub_14028A280+6F4↑j ...
                mov     r9, rdx
                shr     rdx, 38h
                shr     r9, 3Ch
                and     dl, 0Fh
                and     r9b, 7
                shl     r9b, 4
                or      r9b, dl
                mov     rdx, [rsi]
                mov     [rbp+57h+var_B0], r9
                mov     rax, rdi
                cmp     rsi, rax
                jb      short loc_14028AA65
                mov     rax, r11
                cmp     rsi, rax
                ja      short loc_14028AA65
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028AA65
                test    dl, 1
                jz      short loc_14028AA65
                test    dl, 20h
                jz      short loc_14028AA1D
                test    dl, 42h
                jnz     short loc_14028AA65

loc_14028AA1D:                          ; CODE XREF: sub_14028A280+796↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14028AA65
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028AA65
                or      rdx, 42h

loc_14028AA65:                          ; CODE XREF: sub_14028A280+77B↑j
                                        ; sub_14028A280+783↑j ...
                mov     [rbp+57h+var_98], rdx
                mov     rax, rdi
                lea     rcx, [rbp+57h+var_98]
                cmp     rcx, rax
                jb      short loc_14028AAE2
                mov     rax, r11
                lea     rcx, [rbp+57h+var_98]
                cmp     rcx, rax
                ja      short loc_14028AAE2
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028AAE2
                test    dl, 1
                jz      short loc_14028AAE2
                test    dl, 20h
                jz      short loc_14028AA99
                test    dl, 42h
                jnz     short loc_14028AAE2

loc_14028AA99:                          ; CODE XREF: sub_14028A280+812↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14028AAE2
                lea     rax, [rbp+57h+var_98]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028AAE2
                or      rdx, 42h

loc_14028AAE2:                          ; CODE XREF: sub_14028A280+7F3↑j
                                        ; sub_14028A280+7FF↑j ...
                shr     rdx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax
                mov     r11, 0FFFFFA8000000000h
                lea     rcx, [rdx+rdx*2]
                shl     rcx, 4
                mov     rax, r11
                add     rcx, rax
                call    sub_1403F41D8
                test    eax, eax
                mov     r13d, r10d
                mov     rax, [r12+8]
                setz    r13b
                test    rax, rax
                jz      short loc_14028AB6E
                mov     rdi, [r12+10h]
                lea     rax, [rax+rdi*8]
                cmp     rsi, rax
                jnz     short loc_14028AB59
                cmp     r9b, [r12+1Ch]
                jnz     short loc_14028AB59
                mov     eax, [r12+18h]
                and     eax, 1
                cmp     r13d, eax
                jnz     short loc_14028AB59
                inc     rdi
                mov     [r12+10h], rdi
                mov     rax, [rsi]
                mov     [rbp+57h+var_68], rax
                jmp     loc_14028B326
; ---------------------------------------------------------------------------

loc_14028AB59:                          ; CODE XREF: sub_14028A280+8AF↑j
                                        ; sub_14028A280+8B6↑j ...
                mov     eax, [r12+18h]
                test    al, 2
                jnz     short loc_14028ABB0
                mov     rcx, r12
                call    sub_14028E340
                mov     r9, [rbp+57h+var_B0]

loc_14028AB6E:                          ; CODE XREF: sub_14028A280+8A1↑j
                mov     rax, [rbp+57h+var_C0]
                mov     edi, 1
                mov     [r12], rax
                mov     eax, [r12+18h]
                and     eax, 0FFFFFFFEh
                mov     [r12+8], rsi
                or      eax, r13d
                mov     [r12+1Ch], r9b
                mov     [r12+18h], eax
                mov     [r12+10h], rdi
                mov     rax, [rsi]
                mov     [rbp+57h+var_68], rax
                jmp     loc_14028B326
; ---------------------------------------------------------------------------

loc_14028ABA6:                          ; CODE XREF: sub_14028A280+60F↑j
                                        ; sub_14028A280+6BF↑j
                mov     r11, 0FFFFFA8000000000h

loc_14028ABB0:                          ; CODE XREF: sub_14028A280+8E0↑j
                mov     r12, r15
                mov     r13, 0FFFFF68000000000h
                shr     r12, 9
                mov     edi, 1
                mov     rax, 7FFFFFFFF8h
                mov     [rbp+57h+var_B8], edi
                and     r12, rax
                mov     rax, r13
                add     r12, rax
                mov     r8, 0FFFFF6FB7DBED000h
                mov     rdx, [r12]
                mov     rax, r8
                mov     rcx, 0FFFFF6FB7DBED7F8h
                cmp     r12, rax
                jb      short loc_14028AC78
                mov     rax, rcx
                cmp     r12, rax
                ja      short loc_14028AC78
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028AC64
                test    dil, dl
                jz      short loc_14028AC64
                test    dl, 20h
                jz      short loc_14028AC1C
                test    dl, 42h
                jnz     short loc_14028AC64

loc_14028AC1C:                          ; CODE XREF: sub_14028A280+995↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14028AC64
                mov     rax, r12
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028AC64
                or      rdx, 42h

loc_14028AC64:                          ; CODE XREF: sub_14028A280+98B↑j
                                        ; sub_14028A280+990↑j ...
                mov     rcx, 0FFFFF6FB7DBED7F8h
                mov     r8, 0FFFFF6FB7DBED000h

loc_14028AC78:                          ; CODE XREF: sub_14028A280+97A↑j
                                        ; sub_14028A280+982↑j
                shr     rdx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rdx, rax
                lea     r9, [rdx+rdx*2]
                shl     r9, 4
                mov     rax, r11
                add     r9, rax
                mov     rax, r13
                cmp     r15, rax
                jb      short loc_14028ACE3
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r15, rax
                ja      short loc_14028ACE3
                movzx   r13d, byte ptr [r9]
                mov     rdx, r12
                mov     r8, cs:qword_14001D278
                xor     r9d, r9d
                mov     rcx, [rbp+57h+var_C0]
                shr     r13b, 1
                and     r13b, 7
                mov     dword ptr [rbp+57h+var_B0], r10d
                call    sub_14029B720
                test    eax, eax
                jz      loc_14028B39F
                jmp     loc_14028AEA5
; ---------------------------------------------------------------------------

loc_14028ACE3:                          ; CODE XREF: sub_14028A280+A1D↑j
                                        ; sub_14028A280+A2F↑j
                mov     rdx, [r12]
                mov     dword ptr [rbp+57h+var_B0], edi
                mov     rax, r8
                cmp     r12, rax
                jb      short loc_14028AD5A
                mov     rax, rcx
                cmp     r12, rax
                ja      short loc_14028AD5A
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028AD5A
                test    dil, dl
                jz      short loc_14028AD5A
                test    dl, 20h
                jz      short loc_14028AD12
                test    dl, 42h
                jnz     short loc_14028AD5A

loc_14028AD12:                          ; CODE XREF: sub_14028A280+A8B↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14028AD5A
                mov     rax, r12
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028AD5A
                or      rdx, 42h

loc_14028AD5A:                          ; CODE XREF: sub_14028A280+A70↑j
                                        ; sub_14028A280+A78↑j ...
                mov     r13, rdx
                mov     rcx, r9
                shr     r13, 3Ch
                and     r13b, 7
                shr     rdx, 38h
                shl     r13b, 4
                and     dl, 0Fh
                or      r13b, dl
                call    sub_1403F41D8
                test    eax, eax
                mov     ecx, r10d
                movzx   eax, r13b
                setz    cl
                and     al, 0Fh
                mov     [rbp+57h+var_B8], ecx
                cmp     al, 8
                jnz     short loc_14028ADAB
                mov     rcx, [rbp+57h+var_C0]
                mov     r8, r9
                mov     rdx, r15
                call    sub_1402DDB98
                mov     rdx, r15
                call    sub_1402DECC0
                movzx   r13d, al

loc_14028ADAB:                          ; CODE XREF: sub_14028A280+B0E↑j
                mov     rdx, cs:qword_14001D278
                mov     r8, [r12]
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rcx, r10
                mov     r9, 0FFFFF6FB7DBED7F8h
                cmp     r12, rcx
                jb      short loc_14028ADE7
                mov     rcx, r9
                cmp     r12, rcx
                ja      short loc_14028ADE7
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028ADE7
                or      r8, 20h

loc_14028ADE7:                          ; CODE XREF: sub_14028A280+B50↑j
                                        ; sub_14028A280+B58↑j ...
                mov     eax, cs:dword_140CFC400
                bt      eax, 0Bh
                jnb     short loc_14028ADFB
                mov     r8d, 20h ; ' '
                jmp     short loc_14028AE04
; ---------------------------------------------------------------------------

loc_14028ADFB:                          ; CODE XREF: sub_14028A280+B71↑j
                bt      eax, 1Ah
                jnb     short loc_14028AE04
                lfence

loc_14028AE04:                          ; CODE XREF: sub_14028A280+B79↑j
                                        ; sub_14028A280+B7F↑j
                test    r8b, 20h
                jnz     short loc_14028AE31
                mov     r11, rdx
                xchg    r11, [r12]
                mov     rax, r10
                cmp     r12, rax
                jb      short loc_14028AE29
                mov     rax, r9
                cmp     r12, rax
                ja      short loc_14028AE29
                mov     rcx, r12
                call    sub_140349620

loc_14028AE29:                          ; CODE XREF: sub_14028A280+B97↑j
                                        ; sub_14028A280+B9F↑j
                test    r11b, 20h
                jnz     short loc_14028AEA5
                jmp     short loc_14028AEA8
; ---------------------------------------------------------------------------

loc_14028AE31:                          ; CODE XREF: sub_14028A280+B88↑j
                mov     rax, r10
                cmp     r12, rax
                jb      short loc_14028AEA1
                mov     rax, r9
                cmp     r12, rax
                ja      short loc_14028AEA1
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028AE73
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14028AE65
                test    dil, dl
                jz      short loc_14028AE65
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14028AE65:                          ; CODE XREF: sub_14028A280+BD1↑j
                                        ; sub_14028A280+BD6↑j
                mov     rcx, r12
                mov     [r12], rdx
                call    sub_140349620
                jmp     short loc_14028AEA5
; ---------------------------------------------------------------------------

loc_14028AE73:                          ; CODE XREF: sub_14028A280+BC8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14028AEA1
                test    dil, dl
                jz      short loc_14028AEA1
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14028AEA1:                          ; CODE XREF: sub_14028A280+BB7↑j
                                        ; sub_14028A280+BBF↑j ...
                mov     [r12], rdx

loc_14028AEA5:                          ; CODE XREF: sub_14028A280+A5E↑j
                                        ; sub_14028A280+BAD↑j ...
                mov     dword ptr [rbp+57h+var_88], edi

loc_14028AEA8:                          ; CODE XREF: sub_14028A280+BAF↑j
                mov     eax, [rbp+57h+var_B8]
                movzx   r9d, r13b
                mov     r13, [rbp+57h+var_C0]
                mov     r8, rdi
                mov     [rsp+0F0h+var_C8], eax
                mov     rcx, r13
                mov     rdx, r15
                mov     dword ptr [rsp+0F0h+var_D0], 0Ah
                call    sub_14028B7E0
                cmp     dword ptr [rbp+57h+var_B0], 0
                jz      loc_14028B07C
                mov     r8, r15
                mov     rax, 0FFFFF6FB40000000h
                shr     r8, 12h
                and     r8d, 3FFFFFF8h
                mov     rax, rax
                add     r8, rax
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rdx, [r8]
                mov     rax, r10
                mov     r9, 0FFFFF6FB7DBED7F8h
                cmp     r8, rax
                jb      short loc_14028AF7B
                mov     rax, r9
                cmp     r8, rax
                ja      short loc_14028AF7B
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028AF7B
                test    dil, dl
                jz      short loc_14028AF7B
                test    dl, 20h
                jz      short loc_14028AF34
                test    dl, 42h
                jnz     short loc_14028AF7B

loc_14028AF34:                          ; CODE XREF: sub_14028A280+CAD↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14028AF7B
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028AF7B
                or      rdx, 42h

loc_14028AF7B:                          ; CODE XREF: sub_14028A280+C92↑j
                                        ; sub_14028A280+C9A↑j ...
                mov     [rbp+57h+var_90], rdx
                mov     rax, r10
                lea     rcx, [rbp+57h+var_90]
                cmp     rcx, rax
                jb      short loc_14028AFF8
                mov     rax, r9
                lea     rcx, [rbp+57h+var_90]
                cmp     rcx, rax
                ja      short loc_14028AFF8
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028AFF8
                test    dil, dl
                jz      short loc_14028AFF8
                test    dl, 20h
                jz      short loc_14028AFAF
                test    dl, 42h
                jnz     short loc_14028AFF8

loc_14028AFAF:                          ; CODE XREF: sub_14028A280+D28↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14028AFF8
                lea     rax, [rbp+57h+var_90]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028AFF8
                or      rdx, 42h

loc_14028AFF8:                          ; CODE XREF: sub_14028A280+D09↑j
                                        ; sub_14028A280+D15↑j ...
                mov     rax, 0FFFFFFFFFh
                shr     rdx, 0Ch
                and     rdx, rax
                mov     rax, 0FFFFFA8000000000h
                lea     r12, [rdx+rdx*2]
                shl     r12, 4
                mov     rax, rax
                add     r12, rax
                mov     eax, [r12]
                shr     rax, 4
                test    eax, 3FFh
                jnz     short loc_14028B07C
                lea     r8, [rbp+57h+var_60]
                mov     rdx, r15
                call    sub_1402FD640
                mov     cl, 8
                xchg    ax, ax

loc_14028B040:                          ; CODE XREF: sub_14028A280+DD0↓j
                add     cl, 0FFh
                movzx   eax, cl
                mov     edx, [rbp+rax*4+57h+var_60]
                test    edx, edx
                jnz     short loc_14028B054
                test    cl, cl
                jnz     short loc_14028B040
                jmp     short loc_14028B07C
; ---------------------------------------------------------------------------

loc_14028B054:                          ; CODE XREF: sub_14028A280+DCC↑j
                mov     rax, [r12]
                and     edx, 3FFh
                movzx   ecx, cl
                and     rax, 0FFFFFFFFFFFE000Fh
                and     ecx, 7
                shl     rcx, 0Ah
                or      rcx, rdx
                shl     rcx, 4
                or      rcx, rax
                mov     [r12], rcx

loc_14028B07C:                          ; CODE XREF: sub_14028A280+C51↑j
                                        ; sub_14028A280+DAE↑j ...
                cmp     dword ptr [rbp+57h+var_88], edi
                jnz     loc_14028A84F
                cmp     [r14], edi
                jz      short loc_14028B0BF
                movzx   ecx, byte ptr [r14+4]
                test    cl, 8
                jnz     short loc_14028B0BF
                mov     r9, 0FFFFF68000000000h
                mov     rax, r9
                cmp     r15, rax
                jb      short loc_14028B0BF
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r15, rax
                ja      short loc_14028B0BF
                or      cl, 8
                mov     [r14+4], cl

loc_14028B0BF:                          ; CODE XREF: sub_14028A280+E08↑j
                                        ; sub_14028A280+E12↑j ...
                mov     r10d, [r14+0Ch]
                movzx   r8d, byte ptr [r14+4]
                test    r10d, r10d
                jz      loc_14028B1B3
                test    r8b, 4
                jnz     short loc_14028B13F
                lea     eax, [r10-1]
                lea     r11, [r14+rax*8]
                mov     rax, [r14+rax*8+18h]
                test    rax, 0C00h
                jnz     short loc_14028B13F
                mov     r9, rax
                mov     rcx, rax
                and     r9d, 3FFh
                and     rcx, 0FFFFFFFFFFFFF000h
                lea     rdx, [r9+1]
                shl     rdx, 0Ch
                add     rdx, rcx
                cmp     rdx, r15
                jnz     short loc_14028B13F
                lea     rcx, [r9+1]
                cmp     rcx, r9
                jbe     short loc_14028B13F
                cmp     rcx, 3FFh
                ja      short loc_14028B13F
                inc     qword ptr [r14+10h]
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rcx, rax
                mov     [r11+18h], rcx
                jmp     loc_14028A84F
; ---------------------------------------------------------------------------

loc_14028B13F:                          ; CODE XREF: sub_14028A280+E55↑j
                                        ; sub_14028A280+E6A↑j ...
                test    r10d, r10d
                jz      short loc_14028B1B3
                test    r8b, 4
                jnz     short loc_14028B1B3
                lea     eax, [r10-1]
                lea     r8, [r14+rax*8]
                mov     rax, [r14+rax*8+18h]
                test    rax, 0C00h
                jnz     short loc_14028B1B3
                mov     rdx, rax
                lea     rcx, [r15+1000h]
                and     rdx, 0FFFFFFFFFFFFF000h
                cmp     rdx, rcx
                jnz     short loc_14028B1B3
                mov     rcx, rax
                and     ecx, 3FFh
                lea     rdx, [rcx+1]
                cmp     rdx, rcx
                jbe     short loc_14028B1B3
                cmp     rdx, 3FFh
                ja      short loc_14028B1B3
                inc     qword ptr [r14+10h]
                add     rax, 0FFFFFFFFFFFFF000h
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rcx, rax
                mov     [r8+18h], rcx
                jmp     loc_14028A84F
; ---------------------------------------------------------------------------

loc_14028B1B3:                          ; CODE XREF: sub_14028A280+E4B↑j
                                        ; sub_14028A280+EC2↑j ...
                cmp     r10d, [r14+8]
                jb      short loc_14028B1C2
                mov     [r14+5], dil
                jmp     loc_14028A84F
; ---------------------------------------------------------------------------

loc_14028B1C2:                          ; CODE XREF: sub_14028A280+F37↑j
                                        ; sub_14028A280+FC7↓j
                lea     rax, [rdi-1]
                mov     rcx, r15
                cmp     rax, 3FFh
                mov     edx, 400h
                cmovbe  rdx, rdi
                and     rcx, 0FFFFFFFFFFFFF000h
                sub     rdi, rdx
                lea     rax, [rdx-1]
                and     eax, 3FFh
                or      rax, rcx
                mov     rcx, rdx
                shl     rcx, 0Ch
                add     r15, rcx
                mov     ecx, [r14+0Ch]
                mov     [r14+rcx*8+18h], rax
                inc     dword ptr [r14+0Ch]
                mov     ecx, [r14+0Ch]
                add     [r14+10h], rdx
                cmp     ecx, [r14+8]
                jnz     short loc_14028B244
                test    byte ptr [r14+4], 4
                jnz     short loc_14028B244
                mov     edx, ecx
                lea     r9, sub_14033B080
                lea     rcx, [r14+18h]
                mov     r8d, 8
                call    qsort
                mov     rcx, r14
                call    sub_14033A660
                mov     eax, [r14+0Ch]
                cmp     eax, [r14+8]
                jz      short loc_14028B252

loc_14028B244:                          ; CODE XREF: sub_14028A280+F91↑j
                                        ; sub_14028A280+F98↑j
                test    rdi, rdi
                jnz     loc_14028B1C2
                jmp     loc_14028A84F
; ---------------------------------------------------------------------------

loc_14028B252:                          ; CODE XREF: sub_14028A280+FC2↑j
                test    rdi, rdi
                jz      loc_14028A84F
                mov     byte ptr [r14+5], 1
                mov     [r14+10h], rax
                jmp     loc_14028A84F
; ---------------------------------------------------------------------------

loc_14028B269:                          ; CODE XREF: sub_14028A280+283↑j
                xor     r9d, r9d
                mov     rdx, r15
                mov     rcx, r14
                lea     r8d, [r9+1]
                call    sub_1402882E0
                bt      r12d, 8
                jb      loc_14028A84B
                mov     r9, 0FFFFF68000000000h
                mov     rax, r9
                cmp     r15, rax
                jb      loc_14028A84B
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r15, rax
                ja      loc_14028A84B
                mov     rcx, [rbp+57h+var_C0]
                xor     eax, eax
                and     rbx, 0FFFFFFFFFFFFFFFEh
                mov     rdx, rsi
                bts     rbx, 0Ah
                cmp     [rbp+57h+var_B4], 1
                mov     r8, rbx
                setnle  al
                mov     r9d, eax
                call    sub_14029B720
                test    eax, eax
                jnz     short loc_14028B326
                jmp     loc_14028B39F
; ---------------------------------------------------------------------------

loc_14028B2DF:                          ; CODE XREF: sub_14028A280+5E0↑j
                                        ; sub_14028A280+5EE↑j
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     rsi, rax
                jb      short loc_14028B323
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rsi, rax
                ja      short loc_14028B323
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028B323
                cmp     byte ptr cs:word_140C4DE88+1, 0
                mov     rcx, rsi
                mov     rdx, rbx
                mov     [rsi], rbx
                call    sub_140349620
                jmp     short loc_14028B326
; ---------------------------------------------------------------------------

loc_14028B323:                          ; CODE XREF: sub_14028A280+106F↑j
                                        ; sub_14028A280+1081↑j ...
                mov     [rsi], rbx

loc_14028B326:                          ; CODE XREF: sub_14028A280+2F5↑j
                                        ; sub_14028A280+30B↑j ...
                test    byte ptr [r14+4], 2
                mov     rdx, cs:qword_140C4DE10
                jnz     short loc_14028B35D
                cmp     dword ptr [r14], 1
                jnz     short loc_14028B35D
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, 0FFFFFFFFFFFFFFFFh
                cmp     qword ptr [rcx+8F0h], 0
                cmovnz  rdx, rax

loc_14028B35D:                          ; CODE XREF: sub_14028A280+10B2↑j
                                        ; sub_14028A280+10B8↑j
                mov     eax, [r14+8]
                cmp     [r14+0Ch], eax
                jnb     short loc_14028B374
                cmp     byte ptr [r14+5], 0
                jnz     short loc_14028B374
                cmp     [r14+10h], rdx
                jbe     short loc_14028B38C

loc_14028B374:                          ; CODE XREF: sub_14028A280+10E5↑j
                                        ; sub_14028A280+10EC↑j
                cmp     rdx, 400h
                jb      short loc_14028B38C
                cmp     byte ptr [r14+5], 0
                jnz     short loc_14028B38C
                mov     rcx, r14
                call    sub_14028EDB0

loc_14028B38C:                          ; CODE XREF: sub_14028A280+10F2↑j
                                        ; sub_14028A280+10FB↑j ...
                mov     r13, [rbp+57h+var_A8]

loc_14028B390:                          ; CODE XREF: sub_14028A280+14EE↓j
                                        ; sub_14028A280+1501↓j ...
                cmp     qword ptr [r13+0], 0
                jnz     short loc_14028B39B
                mov     [r13+0], rsi

loc_14028B39B:                          ; CODE XREF: sub_14028A280+1115↑j
                mov     [r13+8], rsi

loc_14028B39F:                          ; CODE XREF: sub_14028A280+111↑j
                                        ; sub_14028A280+201↑j ...
                mov     r15, [rsp+0F0h+var_30]
                xor     eax, eax
                mov     r14, [rsp+0F0h+var_28]
                mov     r13, [rsp+0F0h+var_20]
                mov     r12, [rsp+0F0h+arg_18]
                mov     rcx, [rbp+57h+var_40]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 0D8h
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; } // starts at 14028A361
; ---------------------------------------------------------------------------
; __unwind { // __GSHandlerCheck
algn_14028B3D9:                         ; DATA XREF: .pdata:00000001400CEC7C↑o
                                        ; .pdata:00000001400CEC88↑o
                align 2
; } // starts at 14028B3D9

loc_14028B3DA:                          ; CODE XREF: sub_14028A280+243↑j
                                        ; DATA XREF: .pdata:00000001400CEC88↑o ...
                xor     r14d, r14d
                bt      rbx, 0Ah
                jnb     loc_14028B4C3
                mov     rcx, cs:qword_140C4DDC0
                mov     rdx, rbx
                test    rcx, rcx
                jz      short loc_14028B405
                test    bl, 10h
                jnz     short loc_14028B405
                mov     rdx, rcx
                not     rdx
                and     rdx, rbx

loc_14028B405:                          ; CODE XREF: sub_14028A280+1175↑j
                                        ; sub_14028A280+117A↑j
                sar     rdx, 10h
                mov     rax, rbx
                test    rcx, rcx
                jz      short loc_14028B41F
                test    bl, 10h
                jnz     short loc_14028B41F
                mov     rax, rcx
                not     rax
                and     rax, rbx

loc_14028B41F:                          ; CODE XREF: sub_14028A280+118F↑j
                                        ; sub_14028A280+1194↑j
                shr     rax, 20h
                mov     ecx, 0FFFFFFFFh
                cmp     rax, rcx
                jz      short loc_14028B43E
                bt      rbx, 0Bh
                jnb     short loc_14028B43E
                mov     rcx, r8
                call    sub_140366EF4
                jmp     short loc_14028B478
; ---------------------------------------------------------------------------

loc_14028B43E:                          ; CODE XREF: sub_14028A280+11AB↑j
                                        ; sub_14028A280+11B2↑j
                mov     rax, gs:188h
                mov     r8, [rax+0B8h]
                cmp     [r8+4F0h], r14
                jz      short loc_14028B49E
                mov     rcx, rbx
                call    sub_14031C870
                test    eax, eax
                jnz     short loc_14028B49E
                mov     rcx, r8
                call    sub_1402C6E74
                test    rax, rax
                jz      short loc_14028B49E
                mov     rcx, rax
                call    sub_14055A088

loc_14028B478:                          ; CODE XREF: sub_14028A280+11BC↑j
                cmp     eax, 3
                jnz     short loc_14028B487
                mov     rax, [r13+10h]
                inc     qword ptr [rax+8]
                jmp     short loc_14028B494
; ---------------------------------------------------------------------------

loc_14028B487:                          ; CODE XREF: sub_14028A280+11FB↑j
                cmp     eax, 5
                jnz     short loc_14028B494
                mov     rax, [r13+10h]
                inc     qword ptr [rax+10h]

loc_14028B494:                          ; CODE XREF: sub_14028A280+1205↑j
                                        ; sub_14028A280+120A↑j
                mov     r11, 0FFFFF6FB7DBED7F8h

loc_14028B49E:                          ; CODE XREF: sub_14028A280+11D5↑j
                                        ; sub_14028A280+11E1↑j ...
                mov     rdx, cs:qword_14001D278
                mov     r9, 0FFFFF6FB7DBED000h
                mov     rax, r9
                cmp     rsi, rax
                jb      loc_14028B60F
                mov     rax, r11
                jmp     loc_14028B5A1
; ---------------------------------------------------------------------------

loc_14028B4C3:                          ; CODE XREF: sub_14028A280+1162↑j
                bt      rbx, 0Bh
                jb      loc_14028B750
                test    rbx, 3E0h
                jz      loc_14028B7A0
                mov     rax, cs:qword_140C4E4C8
                movzx   ecx, word ptr [r8+0AEh]
                mov     [rbp+57h+var_78], rbx
                mov     rdi, [rax+rcx*8]
                movzx   eax, bl
                shr     al, 2
                test    al, 1
                jz      short loc_14028B507
                lea     rcx, [rbp+57h+var_78]
                call    sub_1402805F0
                jmp     short loc_14028B51E
; ---------------------------------------------------------------------------

loc_14028B507:                          ; CODE XREF: sub_14028A280+127A↑j
                movzx   eax, bl
                shr     al, 1
                test    al, 1
                jz      short loc_14028B51B
                lea     rcx, [rbp+57h+var_78]
                call    sub_1402805F0
                jmp     short loc_14028B51E
; ---------------------------------------------------------------------------

loc_14028B51B:                          ; CODE XREF: sub_14028A280+128E↑j
                mov     rax, r14

loc_14028B51E:                          ; CODE XREF: sub_14028A280+1285↑j
                                        ; sub_14028A280+1299↑j
                mov     [rbp+57h+var_78], rax
                test    rax, rax
                jz      short loc_14028B535
                xor     r8d, r8d
                mov     rdx, rax
                mov     rcx, rdi
                call    sub_14020B2C0

loc_14028B535:                          ; CODE XREF: sub_14028A280+12A5↑j
                mov     rax, [rbp+57h+var_C0]
                movzx   eax, byte ptr [rax+0B8h]
                test    al, 7
                jnz     short loc_14028B573
                test    r12b, r12b
                jns     short loc_14028B57B
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14028B560
                test    bl, 10h
                jnz     short loc_14028B560
                not     rax
                and     rbx, rax

loc_14028B560:                          ; CODE XREF: sub_14028A280+12D3↑j
                                        ; sub_14028A280+12D8↑j
                bt      rbx, 0Ah
                jb      short loc_14028B573
                bt      rbx, 0Bh
                jb      short loc_14028B573
                test    bl, 4
                jz      short loc_14028B57B

loc_14028B573:                          ; CODE XREF: sub_14028A280+12C2↑j
                                        ; sub_14028A280+12E5↑j ...
                mov     rax, [r13+10h]
                inc     qword ptr [rax+18h]

loc_14028B57B:                          ; CODE XREF: sub_14028A280+12C7↑j
                                        ; sub_14028A280+12F1↑j
                mov     rdx, cs:qword_14001D278
                mov     r9, 0FFFFF6FB7DBED000h
                mov     rax, r9
                cmp     rsi, rax
                jb      short loc_14028B60F
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax

loc_14028B5A1:                          ; CODE XREF: sub_14028A280+123E↑j
                cmp     rsi, rax
                ja      short loc_14028B60F
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028B5E1
                cmp     byte ptr cs:word_140C4DE88+1, r14b
                jnz     short loc_14028B5CA
                test    dl, 1
                jz      short loc_14028B5CA
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14028B5CA:                          ; CODE XREF: sub_14028A280+1336↑j
                                        ; sub_14028A280+133B↑j
                mov     rcx, rsi
                mov     [rsi], rdx
                call    sub_140349620
                mov     r9, 0FFFFF6FB7DBED000h
                jmp     short loc_14028B612
; ---------------------------------------------------------------------------

loc_14028B5E1:                          ; CODE XREF: sub_14028A280+132D↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14028B60F
                test    dl, 1
                jz      short loc_14028B60F
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14028B60F:                          ; CODE XREF: sub_14028A280+1235↑j
                                        ; sub_14028A280+1312↑j ...
                mov     [rsi], rdx

loc_14028B612:                          ; CODE XREF: sub_14028A280+135F↑j
                test    r12b, r12b
                jns     loc_14028B39F
                mov     rax, r9
                cmp     rsi, rax
                jb      short loc_14028B636
                mov     rax, 0FFFFF6FB7DBEDFFFh
                cmp     rsi, rax
                jbe     loc_14028B39F

loc_14028B636:                          ; CODE XREF: sub_14028A280+13A1↑j
                shr     r15, 12h
                and     r15d, 3FFFFFF8h
                mov     rax, 0FFFFF6FB40000000h
                mov     rax, rax
                add     r15, rax
                mov     rax, [r15]
                mov     rdx, r9
                mov     r8, 0FFFFF6FB7DBED7F8h
                cmp     r15, rdx
                jb      short loc_14028B683
                mov     rdx, r8
                cmp     r15, rdx
                ja      short loc_14028B683
                mov     rdx, rax
                mov     rcx, r15
                call    sub_1402A8730
                mov     r8, 0FFFFF6FB7DBED7F8h

loc_14028B683:                          ; CODE XREF: sub_14028A280+13E4↑j
                                        ; sub_14028A280+13EC↑j
                mov     [rbp+57h+var_70], rax
                mov     rcx, r9
                lea     rdx, [rbp+57h+var_70]
                cmp     rdx, rcx
                jb      short loc_14028B6AB
                mov     rcx, r8
                lea     rdx, [rbp+57h+var_70]
                cmp     rdx, rcx
                ja      short loc_14028B6AB
                mov     rdx, rax
                lea     rcx, [rbp+57h+var_70]
                call    sub_1402A8730

loc_14028B6AB:                          ; CODE XREF: sub_14028A280+1411↑j
                                        ; sub_14028A280+141D↑j
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rbx, [rax+rax*2]
                mov     rax, 0FFFFFA8000000000h
                shl     rbx, 4
                mov     rax, rax
                add     rbx, rax
                mov     r9d, [rbx+10h]
                shr     r9, 10h
                and     r9d, 3FFh
                cmp     r9, 1
                jb      loc_14028B7BB
                mov     [rbp+57h+var_A0], r14d
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jnb     short loc_14028B71B
                nop     word ptr [rax+rax+00h]

loc_14028B700:                          ; CODE XREF: sub_14028A280+1490↓j
                                        ; sub_14028A280+1499↓j
                lea     rcx, [rbp+57h+var_A0]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_14028B700
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_14028B700

loc_14028B71B:                          ; CODE XREF: sub_14028A280+1478↑j
                mov     rdx, [rbx+10h]
                mov     rax, 7FFFFFFFFFFFFFFFh
                mov     rcx, rdx
                shr     rcx, 10h
                dec     ecx
                shl     rcx, 10h
                xor     rcx, rdx
                and     ecx, 3FF0000h
                xor     rcx, rdx
                mov     [rbx+10h], rcx
                lock and [rbx+18h], rax
                jmp     loc_14028B39F
; ---------------------------------------------------------------------------

loc_14028B750:                          ; CODE XREF: sub_14028A280+1248↑j
                bt      r12d, 0Bh
                jnb     short loc_14028B76A
                mov     r8d, r9d
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_14054FB5C
                jmp     loc_14028B39F
; ---------------------------------------------------------------------------

loc_14028B76A:                          ; CODE XREF: sub_14028A280+14D5↑j
                test    r12b, 10h
                jz      loc_14028B390
                and     ebx, 3E0h
                cmp     rbx, 300h
                jnz     loc_14028B390
                mov     rcx, [r13+10h]
                lea     r8, [r13+70h]
                mov     rdx, rsi
                mov     rcx, [rcx+20h]
                call    sub_14054BD04
                jmp     loc_14028B390
; ---------------------------------------------------------------------------

loc_14028B7A0:                          ; CODE XREF: sub_14028A280+1255↑j
                xor     eax, eax
                mov     r9, rbx
                mov     r8, rsi
                mov     [rsp+0F0h+var_D0], rax
                mov     edx, 41792h
                lea     ecx, [rax+1Ah]
                call    KeBugCheckEx
                int     3               ; Trap to Debugger
; ---------------------------------------------------------------------------

loc_14028B7BB:                          ; CODE XREF: sub_14028A280+1467↑j
                mov     edi, 1
                mov     r8, rbx
                mov     edx, 41790h
                mov     [rsp+0F0h+var_D0], rdi
                lea     ecx, [rdi+19h]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_14028A280   endp

algn_14028B7D6:                         ; DATA XREF: .pdata:00000001400CEC94↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028B7E0   proc near               ; CODE XREF: sub_140289320+28B↑p
                                        ; sub_14028A280+C48↑p ...

var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = xmmword ptr -50h
var_40          = qword ptr -40h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_20          = dword ptr  28h
arg_28          = dword ptr  30h

; FUNCTION CHUNK AT 0000000140445320 SIZE 0000022D BYTES

                mov     [rsp+arg_10], rbx
                mov     [rsp+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 50h
                movzx   eax, byte ptr [rcx+0B8h]
                xor     r14d, r14d
                and     al, 7
                mov     [rsp+88h+var_58], r14
                movzx   edi, r9b
                mov     r15, r8
                mov     rbp, rdx
                mov     rbx, rcx
                cmp     al, 2
                jz      loc_14028BC2B
                lea     rsi, [rcx+100h]

loc_14028B826:                          ; CODE XREF: sub_14028B7E0+452↓j
                mov     [rsp+88h+var_60], rsi
                mov     [rsp+88h+var_68], r14
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_140445320

loc_14028B849:                          ; CODE XREF: sub_14028B7E0+1B9B44↓j
                                        ; sub_14028B7E0+1B9B53↓j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jnz     loc_140445344
                lea     rdx, [rsp+88h+var_68]
                xchg    rdx, [rsi]
                test    rdx, rdx
                jnz     loc_14028BC02

loc_14028B867:                          ; CODE XREF: sub_14028B7E0+42C↓j
                                        ; sub_14028B7E0+1B9B72↓j
                mov     r13, 0FFFFF68000000000h
                mov     rdx, 0FFFFF6FFFFFFFFFFh
                cmp     [rsp+88h+arg_28], r14d
                jnz     loc_14028BA84

loc_14028B889:                          ; CODE XREF: sub_14028B7E0+2C9↓j
                                        ; sub_14028B7E0+320↓j
                movzx   eax, byte ptr [rbx+0B8h]
                mov     rsi, 7FFFFFFFF8h
                and     al, 7
                cmp     al, 4
                jz      loc_14028BB76

loc_14028B8A4:                          ; CODE XREF: sub_14028B7E0+3FC↓j
                                        ; sub_14028B7E0+1B9B7E↓j
                movzx   ecx, byte ptr [rbx+0B8h]
                sub     [rbx+88h], r15
                and     cl, 7
                mov     rax, r13
                cmp     rbp, rax
                jnb     loc_14028BAC9

loc_14028B8C1:                          ; CODE XREF: sub_14028B7E0+2EF↓j
                sub     [rbx+78h], r15
                and     dil, 0Fh
                mov     r12d, 1
                cmp     dil, 8
                jz      loc_14028B9B7

loc_14028B8D9:                          ; CODE XREF: sub_14028B7E0+304↓j
                mov     rsi, r15
                neg     rsi
                mov     rax, r13
                cmp     rbp, rax
                jnb     loc_14028BAE9

loc_14028B8EB:                          ; CODE XREF: sub_14028B7E0+315↓j
                mov     rdx, rbp
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rcx, 0FFFFF6FB40000000h
                add     rdx, rcx
                mov     r14, [rdx]
                mov     rax, 0FFFFF6FB7DBED000h
                cmp     rdx, rax
                jnb     loc_14028BB5E

loc_14028B91B:                          ; CODE XREF: sub_14028B7E0+38B↓j
                                        ; sub_14028B7E0+1B9B8D↓j ...
                lea     rcx, [rsp+88h+arg_8]
                mov     [rsp+88h+arg_8], r14
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_1404453FD

loc_14028B938:                          ; CODE XREF: sub_14028B7E0+1B9C27↓j
                                        ; sub_14028B7E0+1B9C44↓j ...
                shr     r14, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     r14, rax
                lea     rdx, [r14+r14*2]
                shl     rdx, 4
                mov     rax, 0FFFFFA8000000000h
                add     rdx, rax
                mov     r8, [rdx]
                mov     rax, r8
                mov     rcx, r8
                shr     rax, 0Eh
                and     al, 7
                shr     rcx, 4
                and     ecx, 3FFh
                jz      short loc_14028B997
                cmp     dil, al
                jnz     loc_14028BAAE
                add     ecx, esi
                shl     rcx, 4
                xor     rcx, r8
                and     ecx, 3FF0h
                xor     rcx, r8

loc_14028B994:                          ; CODE XREF: sub_14028B7E0+1B9CE2↓j
                mov     [rdx], rcx

loc_14028B997:                          ; CODE XREF: sub_14028B7E0+197↑j
                                        ; sub_14028B7E0:loc_14028BAAE↓j
                xor     r14d, r14d

loc_14028B99A:                          ; CODE XREF: sub_14028B7E0+30F↓j
                movzx   eax, dil
                add     [rbx+rax*8+28h], rsi
                cmp     dil, 7
                jz      loc_14028BAB9

loc_14028B9AD:                          ; CODE XREF: sub_14028B7E0+2E4↓j
                mov     rsi, 7FFFFFFFF8h

loc_14028B9B7:                          ; CODE XREF: sub_14028B7E0+F3↑j
                                        ; sub_14028B7E0+2FA↓j
                movzx   eax, byte ptr [rbx+0B8h]
                and     al, 7
                cmp     al, 2
                jz      loc_1404454C7

loc_14028B9C8:                          ; CODE XREF: sub_14028B7E0+1B9CF2↓j
                                        ; sub_14028B7E0+1B9CFF↓j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jnz     loc_1404454E4
                prefetchw byte ptr [rsp+88h+var_68]
                mov     rax, [rsp+88h+var_68]
                test    rax, rax
                jnz     loc_14028BC1B
                mov     rcx, [rsp+88h+var_60]
                lea     rax, [rsp+88h+var_68]
                lock cmpxchg [rcx], r14
                lea     rcx, [rsp+88h+var_68]
                cmp     rax, rcx
                jnz     loc_14028BC11

loc_14028BA05:                          ; CODE XREF: sub_14028B7E0+446↓j
                                        ; sub_14028B7E0+1B9D17↓j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_1404454FC

loc_14028BA1E:                          ; CODE XREF: sub_14028B7E0+1B9D20↓j
                                        ; sub_14028B7E0+1B9D2F↓j ...
                cmp     r12d, 1
                jnz     short loc_14028BA53
                mov     edi, [rsp+88h+arg_20]
                cmp     edi, 9
                jz      loc_14028BB08
                cmp     edi, 0Ah
                jnz     short loc_14028BA53
                mov     rcx, rbp
                shr     rcx, 9
                and     rcx, rsi
                mov     rax, r13
                movzx   ecx, byte ptr [rcx+rax]
                test    r12b, cl
                jnz     loc_14028BB08

loc_14028BA53:                          ; CODE XREF: sub_14028B7E0+242↑j
                                        ; sub_14028B7E0+257↑j ...
                test    dword ptr cs:xmmword_140CFC480+4, 8000000h
                mov     rbx, [rsp+88h+arg_0]
                jnz     loc_140445520

loc_14028BA6B:                          ; CODE XREF: sub_14028B7E0+1B9D43↓j
                                        ; sub_14028B7E0+1B9D68↓j
                mov     rbx, [rsp+88h+arg_10]
                add     rsp, 50h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14028BA84:                          ; CODE XREF: sub_14028B7E0+A3↑j
                sub     [rbx+90h], r15
                xorps   xmm0, xmm0
                xor     eax, eax
                movups  [rsp+88h+var_50], xmm0
                mov     [rsp+88h+var_40], rax
                mov     rax, r13
                cmp     rbp, rax
                jnb     short loc_14028BAFA

loc_14028BAA2:                          ; CODE XREF: sub_14028B7E0+326↓j
                sub     [rbx+80h], r15
                jmp     loc_14028B889
; ---------------------------------------------------------------------------

loc_14028BAAE:                          ; CODE XREF: sub_14028B7E0+19C↑j
                jbe     loc_14028B997
                jmp     loc_14044549E
; ---------------------------------------------------------------------------

loc_14028BAB9:                          ; CODE XREF: sub_14028B7E0+1C7↑j
                mov     rdx, rsi
                mov     rcx, rbx
                call    sub_1402898C0
                jmp     loc_14028B9AD
; ---------------------------------------------------------------------------

loc_14028BAC9:                          ; CODE XREF: sub_14028B7E0+DB↑j
                mov     rax, rdx
                cmp     rbp, rax
                ja      loc_14028B8C1
                mov     r12d, r14d
                test    cl, cl
                jnz     loc_14028B9B7
                and     dil, 0Fh
                jmp     loc_14028B8D9
; ---------------------------------------------------------------------------

loc_14028BAE9:                          ; CODE XREF: sub_14028B7E0+105↑j
                mov     rax, rdx
                cmp     rbp, rax
                jbe     loc_14028B99A
                jmp     loc_14028B8EB
; ---------------------------------------------------------------------------

loc_14028BAFA:                          ; CODE XREF: sub_14028B7E0+2C0↑j
                mov     rax, rdx
                cmp     rbp, rax
                jbe     loc_14028B889
                jmp     short loc_14028BAA2
; ---------------------------------------------------------------------------

loc_14028BB08:                          ; CODE XREF: sub_14028B7E0+24E↑j
                                        ; sub_14028B7E0+26D↑j
                and     dil, 0Fh
                test    r15, r15
                jz      loc_14028BA53
                mov     rsi, rbp
                mov     r14, r15
                mov     ebx, 80000000h
                mov     r12, 7FFFFFFFF8h
                nop     word ptr [rax+rax+00h]

loc_14028BB30:                          ; CODE XREF: sub_14028B7E0+377↓j
                mov     rcx, rsi
                shr     rcx, 9
                and     rcx, r12
                mov     rax, r13
                add     rcx, rax
                movzx   r8d, dil
                mov     rdx, rbx
                call    sub_1402C67E0
                add     rsi, 1000h
                sub     r14, 1
                jnz     short loc_14028BB30
                jmp     loc_14028BA53
; ---------------------------------------------------------------------------

loc_14028BB5E:                          ; CODE XREF: sub_14028B7E0+135↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                cmp     rdx, rax
                ja      loc_14028B91B
                jmp     loc_140445363
; ---------------------------------------------------------------------------

loc_14028BB76:                          ; CODE XREF: sub_14028B7E0+BE↑j
                mov     rax, cs:qword_140CFC470
                test    rax, rax
                jz      short loc_14028BB94
                cmp     rbp, cs:qword_140CFC640
                jb      short loc_14028BBE1

loc_14028BB8B:                          ; CODE XREF: sub_14028B7E0+404↓j
                cmp     rbp, cs:qword_140CFC648
                jb      short loc_14028BBF4

loc_14028BB94:                          ; CODE XREF: sub_14028B7E0+3A0↑j
                                        ; sub_14028B7E0+41B↓j
                mov     rcx, rbp
                call    sub_140245330
                cmp     eax, 0Ch
                jnz     short loc_14028BBD2
                mov     rcx, rbp
                shr     rcx, 9
                and     rcx, rsi
                mov     rax, r13
                add     rcx, rax
                shl     rcx, 19h
                mov     rax, r13
                shl     rax, 19h
                mov     edx, 2
                sub     rcx, rax
                sar     rcx, 10h
                call    sub_14033EE44
                test    rax, rax
                jnz     short loc_14028BBEB

loc_14028BBD2:                          ; CODE XREF: sub_14028B7E0+3BF↑j
                                        ; sub_14028B7E0+412↓j
                mov     rdx, 0FFFFF6FFFFFFFFFFh
                jmp     loc_14028B8A4
; ---------------------------------------------------------------------------

loc_14028BBE1:                          ; CODE XREF: sub_14028B7E0+3A9↑j
                cmp     rbp, rax
                jb      short loc_14028BB8B
                jmp     loc_140445357
; ---------------------------------------------------------------------------

loc_14028BBEB:                          ; CODE XREF: sub_14028B7E0+3F0↑j
                sub     dword ptr cs:xmmword_140C4CBC8+4, r15d
                jmp     short loc_14028BBD2
; ---------------------------------------------------------------------------

loc_14028BBF4:                          ; CODE XREF: sub_14028B7E0+3B2↑j
                cmp     rbp, cs:qword_140CFC500
                jb      short loc_14028BB94
                jmp     loc_140445357
; ---------------------------------------------------------------------------

loc_14028BC02:                          ; CODE XREF: sub_14028B7E0+81↑j
                lea     rcx, [rsp+88h+var_68]
                call    sub_14025FC20
                jmp     loc_14028B867
; ---------------------------------------------------------------------------

loc_14028BC11:                          ; CODE XREF: sub_14028B7E0+21F↑j
                lea     rcx, [rsp+88h+var_68]
                call    sub_140313680

loc_14028BC1B:                          ; CODE XREF: sub_14028B7E0+202↑j
                mov     [rsp+88h+var_68], r14
                lock xor qword ptr [rax+8], 1
                jmp     loc_14028BA05
; ---------------------------------------------------------------------------

loc_14028BC2B:                          ; CODE XREF: sub_14028B7E0+39↑j
                lea     rsi, unk_140C4F640
                jmp     loc_14028B826
sub_14028B7E0   endp

; ---------------------------------------------------------------------------
algn_14028BC37:                         ; DATA XREF: .rdata:000000014005EF80↑o
                                        ; .pdata:00000001400CECA0↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028BC40   proc near               ; DATA XREF: .rdata:00000001400090E0↑o
                                        ; .pdata:00000001400CECAC↑o ...

var_78          = qword ptr -78h
var_70          = dword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_10], r8d
                mov     [rsp+arg_8], rdx
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 58h
                mov     rdi, [rcx+0A8h]
                mov     r14, rdx
                mov     r13, [rcx+18h]
                mov     r12, rcx
                cmp     byte ptr [rdi+6], 1
                mov     r15, [r13+10h]
                jnz     loc_14028BE58
                mov     byte ptr [rdi+6], 0
                mov     r15, [r13+10h]
                mov     rsi, [r13+88h]
                mov     rax, [r15+20h]
                cmp     rsi, rax
                jbe     loc_14028C16D
                mov     r14d, [rdi]
                sub     rsi, rax
                mov     r12d, [rdi+0Ch]
                xor     ebx, ebx
                test    r14b, 4
                jnz     loc_14028BDF6
                movzx   eax, byte ptr [r13+0B8h]
                lea     rbp, unk_140C4F640
                and     al, 7
                mov     [rsp+98h+var_58], rbx
                cmp     al, 2
                jz      short loc_14028BCD1
                lea     rbp, [r13+100h]

loc_14028BCD1:                          ; CODE XREF: sub_14028BC40+88↑j
                mov     [rsp+98h+var_60], rbp
                mov     [rsp+98h+var_68], rbx
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14028BD06
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14028BD06
                mov     eax, [rdx+18h]
                add     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14028BD06
                call    sub_1403F2EC4

loc_14028BD06:                          ; CODE XREF: sub_14028BC40+AE↑j
                                        ; sub_14028BC40+B4↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_14028BD1E
                mov     rdx, rbp
                lea     rcx, [rsp+98h+var_68]
                call    sub_14051652C
                jmp     short loc_14028BD36
; ---------------------------------------------------------------------------

loc_14028BD1E:                          ; CODE XREF: sub_14028BC40+CD↑j
                lea     rdx, [rsp+98h+var_68]
                xchg    rdx, [rbp+0]
                test    rdx, rdx
                jz      short loc_14028BD36
                lea     rcx, [rsp+98h+var_68]
                call    sub_14025FC20

loc_14028BD36:                          ; CODE XREF: sub_14028BC40+DC↑j
                                        ; sub_14028BC40+EA↑j
                xor     edx, edx
                mov     rcx, r12
                test    r14b, 2
                jz      short loc_14028BD55
                mov     r14d, [r15+18h]
                lea     rbp, [r14+rsi]
                mov     rax, rbp
                div     rcx
                mov     [r15+18h], edx
                jmp     short loc_14028BD67
; ---------------------------------------------------------------------------

loc_14028BD55:                          ; CODE XREF: sub_14028BC40+FF↑j
                mov     r14d, [r15+1Ch]
                lea     rbp, [r14+rsi]
                mov     rax, rbp
                div     rcx
                mov     [r15+1Ch], edx

loc_14028BD67:                          ; CODE XREF: sub_14028BC40+113↑j
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_14028BD84
                mov     rdx, [rsp+98h]
                lea     rcx, [rsp+98h+var_68]
                call    sub_1405165EC
                jmp     short loc_14028BDC1
; ---------------------------------------------------------------------------

loc_14028BD84:                          ; CODE XREF: sub_14028BC40+12E↑j
                prefetchw byte ptr [rsp+98h+var_68]
                mov     rax, [rsp+98h+var_68]
                test    rax, rax
                jnz     short loc_14028BDB6
                mov     rcx, [rsp+98h+var_60]
                lea     rax, [rsp+98h+var_68]
                lock cmpxchg [rcx], rbx
                lea     rcx, [rsp+98h+var_68]
                cmp     rax, rcx
                jz      short loc_14028BDC1
                lea     rcx, [rsp+98h+var_68]
                call    sub_140313680

loc_14028BDB6:                          ; CODE XREF: sub_14028BC40+151↑j
                mov     [rsp+98h+var_68], rbx
                lock xor qword ptr [rax+8], 1

loc_14028BDC1:                          ; CODE XREF: sub_14028BC40+142↑j
                                        ; sub_14028BC40+16A↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14028BDEC
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14028BDEC
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14028BDEC
                call    sub_1403F2EC4

loc_14028BDEC:                          ; CODE XREF: sub_14028BC40+194↑j
                                        ; sub_14028BC40+19A↑j ...
                cmp     rbp, rsi
                cmovb   r14, rbx
                mov     rbx, r14

loc_14028BDF6:                          ; CODE XREF: sub_14028BC40+6A↑j
                lea     rcx, [rbx+rsi]
                mov     r9, 624DD2F1A9FBE77h
                imul    rcx, r12
                mov     rax, r9
                mul     rcx
                sub     rcx, rdx
                shr     rcx, 1
                add     rcx, rdx
                shr     rcx, 9
                cmp     rcx, rsi
                jbe     short loc_14028BE3A
                mov     rcx, r12
                mov     rax, r9
                imul    rcx, rsi
                mul     rcx
                sub     rcx, rdx
                shr     rcx, 1
                add     rcx, rdx
                shr     rcx, 9

loc_14028BE3A:                          ; CODE XREF: sub_14028BC40+1DE↑j
                mov     [rdi+30h], rcx
                cmp     [rdi+28h], rcx
                jnb     loc_14028C16D
                mov     r14, [rsp+98h+arg_8]
                mov     r12, [rsp+98h+arg_0]

loc_14028BE58:                          ; CODE XREF: sub_14028BC40+38↑j
                mov     rdx, 0FFFFF68000000000h
                mov     rbp, rdx
                shl     r14, 19h
                mov     rax, 7FFFFFFFF8h
                shl     rbp, 19h
                sub     r14, rbp
                sar     r14, 10h
                mov     rsi, r14
                shr     rsi, 9
                and     rsi, rax
                mov     rax, rdx
                add     rsi, rax
                mov     rbx, [rsi]
                mov     rax, 0FFFFF6FB7DBED000h
                cmp     rsi, rax
                jb      loc_14028BF2F
                mov     rax, 0FFFFF6FB7DBED7F8h
                cmp     rsi, rax
                ja      short loc_14028BF2F
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14028BF2F
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14028BF2F
                test    bl, 1
                jz      short loc_14028BF2F
                test    bl, 20h
                jz      short loc_14028BEE7
                test    bl, 42h
                jnz     short loc_14028BF2F

loc_14028BEE7:                          ; CODE XREF: sub_14028BC40+2A0↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028BF2F
                mov     rax, rsi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14028BF2F
                or      rbx, 42h

loc_14028BF2F:                          ; CODE XREF: sub_14028BC40+25E↑j
                                        ; sub_14028BC40+271↑j ...
                lea     rcx, [rsp+98h+arg_18]
                mov     [rsp+98h+arg_18], rbx
                call    sub_1402433C0
                test    eax, eax
                jz      loc_14028BFCD
                test    cs:dword_140CFC400, 0C00000h
                jz      short loc_14028BFCD
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     byte ptr [rcx+390h], 1
                jz      short loc_14028BFCD
                test    bl, 1
                jz      short loc_14028BFCD
                test    bl, 20h
                jz      short loc_14028BF80
                test    bl, 42h
                jnz     short loc_14028BFCD

loc_14028BF80:                          ; CODE XREF: sub_14028BC40+339↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028BFCD
                lea     rax, [rsp+98h+arg_18]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, rbx
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, rbx
                mov     rbx, rdx
                test    al, 42h
                jz      short loc_14028BFCD
                or      rbx, 42h

loc_14028BFCD:                          ; CODE XREF: sub_14028BC40+306↑j
                                        ; sub_14028BC40+316↑j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                lea     rbx, [rbx+rbx*2]
                shl     rbx, 4
                mov     rax, 0FFFFFA8000000000h
                mov     r8d, [rsp+98h+arg_10]
                add     rbx, rax
                test    r8d, r8d
                jnz     short loc_14028C006
                lea     rdx, [rsi+8]
                jmp     short loc_14028C063
; ---------------------------------------------------------------------------

loc_14028C006:                          ; CODE XREF: sub_14028BC40+3BE↑j
                mov     rdx, rsi
                mov     r10, 0FFFFF68000000000h
                shl     rdx, 19h
                sub     rdx, rbp
                add     rdx, 10000000h
                sar     rdx, 10h
                mov     rcx, rdx
                shl     rcx, 19h
                sub     rcx, rbp
                sar     rcx, 10h
                mov     rax, r10
                cmp     rcx, rax
                jb      short loc_14028C063
                mov     r9, 0FFFFF6FFFFFFFFFFh

loc_14028C045:                          ; CODE XREF: sub_14028BC40+421↓j
                mov     rax, r9
                cmp     rcx, rax
                ja      short loc_14028C063
                mov     rdx, rcx
                shl     rcx, 19h
                sub     rcx, rbp
                sar     rcx, 10h
                mov     rax, r10
                cmp     rcx, rax
                jnb     short loc_14028C045

loc_14028C063:                          ; CODE XREF: sub_14028BC40+3C4↑j
                                        ; sub_14028BC40+3F9↑j ...
                mov     eax, [rdi]
                test    al, 2
                jz      short loc_14028C06F
                mov     [r15+10h], rdx
                jmp     short loc_14028C077
; ---------------------------------------------------------------------------

loc_14028C06F:                          ; CODE XREF: sub_14028BC40+427↑j
                test    al, 4
                jnz     short loc_14028C077
                mov     [r15+8], rdx

loc_14028C077:                          ; CODE XREF: sub_14028BC40+42D↑j
                                        ; sub_14028BC40+431↑j
                test    r8d, r8d
                jz      short loc_14028C0AA
                mov     rax, [rbx+18h]
                mov     rcx, 3FFFFFFFFFFFFFFFh
                and     rax, rcx
                cmp     rax, 1
                jnz     loc_14028C174
                mov     rdx, rsi
                mov     rcx, r13
                call    sub_14034381C
                test    eax, eax
                jnz     loc_14028C174

loc_14028C0AA:                          ; CODE XREF: sub_14028BC40+43A↑j
                mov     rcx, 1000000000h
                test    [rbx+28h], rcx
                jnz     short loc_14028C0F2
                mov     r8, [rbx+8]
                test    r8, r8
                js      short loc_14028C0F2
                jz      short loc_14028C0F2
                mov     rax, 8000000000000000h
                mov     rdx, rsi
                or      r8, rax
                mov     rcx, r13
                call    sub_14036B290
                cmp     eax, 1
                jnz     short loc_14028C0F2
                mov     rcx, rsi
                call    sub_1402805F0
                mov     [rsp+98h+arg_18], rax

loc_14028C0F2:                          ; CODE XREF: sub_14028BC40+478↑j
                                        ; sub_14028BC40+481↑j ...
                mov     r9, [rsp+98h+arg_18]
                shr     r9, 5
                and     r9d, 1
                jz      short loc_14028C135
                mov     rcx, [rdi+0F8h]
                test    rcx, rcx
                jz      short loc_14028C135
                mov     rax, 7FFFFFFEFFFFh
                cmp     r14, rax
                ja      short loc_14028C135
                mov     rdx, r14
                call    sub_14053B5D0
                test    eax, eax
                jz      short loc_14028C15F
                mov     rcx, r12
                call    sub_14031FBD0
                jmp     short loc_14028C176
; ---------------------------------------------------------------------------

loc_14028C135:                          ; CODE XREF: sub_14028BC40+4C2↑j
                                        ; sub_14028BC40+4CE↑j ...
                mov     eax, [rdi]
                mov     r8d, r9d
                or      r8d, 2
                mov     rdx, rsi
                and     al, 3
                mov     rcx, r13
                cmovz   r8d, r9d
                mov     r9, rbx
                mov     [rsp+98h+var_70], r8d
                mov     r8, r14
                mov     [rsp+98h+var_78], rdi
                call    sub_14028C190

loc_14028C15F:                          ; CODE XREF: sub_14028BC40+4E9↑j
                inc     qword ptr [rdi+28h]
                mov     rax, [rdi+28h]
                cmp     rax, [rdi+30h]
                jb      short loc_14028C174

loc_14028C16D:                          ; CODE XREF: sub_14028BC40+54↑j
                                        ; sub_14028BC40+202↑j
                mov     eax, 3
                jmp     short loc_14028C176
; ---------------------------------------------------------------------------

loc_14028C174:                          ; CODE XREF: sub_14028BC40+451↑j
                                        ; sub_14028BC40+464↑j ...
                xor     eax, eax

loc_14028C176:                          ; CODE XREF: sub_14028BC40+4F3↑j
                                        ; sub_14028BC40+532↑j
                add     rsp, 58h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14028BC40   endp

algn_14028C188:                         ; DATA XREF: .pdata:00000001400CECAC↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14028C190   proc near               ; CODE XREF: sub_14028BC40+51A↑p
                                        ; sub_14053ADA0+135↓p ...

var_38          = dword ptr -38h
var_30          = dword ptr -30h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h
arg_20          = qword ptr  28h
arg_28          = dword ptr  30h

                mov     [rsp+arg_10], rbx
                mov     [rsp+arg_18], rbp
                mov     [rsp+arg_8], rdx
                push    rsi
                push    rdi
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                mov     rsi, rdx
                mov     rbp, r9
                mov     rdx, 0FFFFF68000000000h
                mov     r14, r8
                mov     r13, rcx
                mov     rax, rdx
                mov     r9, 0FFFFF6FB7DBED000h
                mov     r15, 0FFFFFFFFFh
                mov     r8, 0FFFFF6FB7DBED7F8h
                mov     rbx, 0FFFFFA8000000000h
                mov     rcx, 0FFFFF6FFFFFFFFFFh
                cmp     r14, rax
                jb      short loc_14028C244
                mov     rax, rcx
                cmp     r14, rax
                ja      short loc_14028C244
                mov     rdi, r14
                mov     rax, 7FFFFFFFF8h
                shr     rdi, 9
                and     rdi, rax
                mov     rax, rdx
                add     rdi, rax
                mov     rcx, rdi
                call    sub_1402805F0
                shr     rax, 0Ch
                and     rax, r15
                lea     rdx, [rax+rax*2]
                add     rdx, rdx
                mov     rax, rbx
                movzx   edx, byte ptr [rax+rdx*8]
                shr     dl, 1
                and     dl, 7
                jmp     loc_14028C2D8
; ---------------------------------------------------------------------------

loc_14028C244:                          ; CODE XREF: sub_14028C190+69↑j
                                        ; sub_14028C190+71↑j
                mov     rdi, r14
                mov     rax, 7FFFFFFFF8h
                shr     rdi, 9
                and     rdi, rax
                mov     rax, rdx
                add     rdi, rax
                mov     rdx, [rdi]
                mov     rax, r9
                cmp     rdi, rax
                jb      short loc_14028C2D1
                mov     rax, r8
                cmp     rdi, rax
                ja      short loc_14028C2D1
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028C2D1
                test    dl, 1
                jz      short loc_14028C2D1
                test    dl, 20h
                jz      short loc_14028C289
                test    dl, 42h
                jnz     short loc_14028C2D1

loc_14028C289:                          ; CODE XREF: sub_14028C190+F2↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r8, [rcx+788h]
                test    r8, r8
                jz      short loc_14028C2D1
                mov     rax, rdi
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r8+rax*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028C2D1
                or      rdx, 42h

loc_14028C2D1:                          ; CODE XREF: sub_14028C190+D7↑j
                                        ; sub_14028C190+DF↑j ...
                shr     rdx, 38h
                and     dl, 0Fh

loc_14028C2D8:                          ; CODE XREF: sub_14028C190+AF↑j
                mov     r15d, [rsp+58h+arg_28]

loc_14028C2E0:                          ; DATA XREF: .rdata:000000014005EFCC↑o
                                        ; .rdata:000000014005EFDC↑o ...
                mov     [rsp+58h+arg_0], r12
                test    r15b, 1
                jz      loc_14028C3F7
                lea     eax, [rdx-1]
                mov     r12d, 1
                cmp     al, 5
                ja      short loc_14028C30F
                xor     r9d, r9d
                mov     r8d, r12d
                mov     rdx, r14
                mov     rcx, r13
                call    sub_14027FDE0
                jmp     short loc_14028C314
; ---------------------------------------------------------------------------

loc_14028C30F:                          ; CODE XREF: sub_14028C190+16A↑j
                cmp     dl, 7
                jz      short loc_14028C336

loc_14028C314:                          ; CODE XREF: sub_14028C190+17D↑j
                movzx   eax, byte ptr [rbp+23h]
                test    al, 8
                jnz     short loc_14028C336
                and     eax, 7
                cmp     eax, 5
                jnb     short loc_14028C336
                mov     edx, 5
                mov     rcx, rbp
                call    sub_14031B1DC
                mov     rsi, [rsp+58h+arg_8]

loc_14028C336:                          ; CODE XREF: sub_14028C190+182↑j
                                        ; sub_14028C190+18A↑j ...
                mov     rdi, [rsp+58h+arg_20]
                xor     ebx, ebx
                mov     eax, ebx
                test    r15b, 2
                jz      short loc_14028C34E
                mov     rbx, [rdi+38h]
                jmp     short loc_14028C356
; ---------------------------------------------------------------------------

loc_14028C34E:                          ; CODE XREF: sub_14028C190+1B6↑j
                test    r15b, 4
                cmovnz  eax, r12d

loc_14028C356:                          ; CODE XREF: sub_14028C190+1BC↑j
                mov     [rsp+58h+var_30], eax
                mov     r9, rbx
                mov     eax, cs:dword_140C4E6A8
                mov     r8, rsi
                mov     rdx, rbp
                mov     [rsp+58h+var_38], eax
                mov     rcx, r13
                call    sub_14028C600
                test    eax, eax
                jz      short loc_14028C37D
                inc     qword ptr [rdi+18h]

loc_14028C37D:                          ; CODE XREF: sub_14028C190+1E7↑j
                test    rbx, rbx
                jz      loc_14028C5D4
                test    byte ptr [rbx+4], 2
                mov     rdx, cs:qword_140C4DE10
                jnz     short loc_14028C3BB
                cmp     [rbx], r12d
                jnz     short loc_14028C3BB
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, 0FFFFFFFFFFFFFFFFh
                cmp     qword ptr [rcx+8F0h], 0
                cmovnz  rdx, rax

loc_14028C3BB:                          ; CODE XREF: sub_14028C190+201↑j
                                        ; sub_14028C190+206↑j
                mov     eax, [rbx+8]
                cmp     [rbx+0Ch], eax
                jnb     short loc_14028C3D3
                cmp     byte ptr [rbx+5], 0
                jnz     short loc_14028C3D3
                cmp     [rbx+10h], rdx
                jbe     loc_14028C5D4

loc_14028C3D3:                          ; CODE XREF: sub_14028C190+231↑j
                                        ; sub_14028C190+237↑j
                cmp     rdx, 400h
                jb      loc_14028C5D4
                cmp     byte ptr [rbx+5], 0
                jnz     loc_14028C5D4
                mov     rcx, rbx
                call    sub_14028EDB0
                jmp     loc_14028C5D4
; ---------------------------------------------------------------------------

loc_14028C3F7:                          ; CODE XREF: sub_14028C190+159↑j
                movzx   eax, byte ptr [rbp+23h]
                test    al, 8
                jz      short loc_14028C406
                mov     esi, 5
                jmp     short loc_14028C40B
; ---------------------------------------------------------------------------

loc_14028C406:                          ; CODE XREF: sub_14028C190+26D↑j
                mov     esi, eax
                and     esi, 7

loc_14028C40B:                          ; CODE XREF: sub_14028C190+274↑j
                mov     rbx, [rsp+58h+arg_20]
                mov     r12d, 1
                cmp     dl, 6
                jnb     short loc_14028C446
                cmp     esi, 5
                jnb     short loc_14028C427
                mov     dl, 6
                jmp     short loc_14028C430
; ---------------------------------------------------------------------------

loc_14028C427:                          ; CODE XREF: sub_14028C190+291↑j
                mov     eax, [rbx]
                test    r12b, al
                jz      short loc_14028C446
                inc     dl

loc_14028C430:                          ; CODE XREF: sub_14028C190+295↑j
                movzx   r9d, dl
                mov     r8d, r12d
                mov     rdx, r14
                mov     rcx, r13
                call    sub_14027FDE0
                inc     qword ptr [rbx+10h]

loc_14028C446:                          ; CODE XREF: sub_14028C190+28C↑j
                                        ; sub_14028C190+29C↑j
                mov     rcx, rbp
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14028C458
                movzx   eax, byte ptr [rbx+5]
                jmp     short loc_14028C45C
; ---------------------------------------------------------------------------

loc_14028C458:                          ; CODE XREF: sub_14028C190+2C0↑j
                movzx   eax, byte ptr [rbx+4]

loc_14028C45C:                          ; CODE XREF: sub_14028C190+2C6↑j
                test    al, al
                movzx   r15d, al
                movzx   eax, byte ptr [r13+0B8h]
                mov     ecx, 7
                cmovz   r15d, ecx
                and     al, cl
                cmp     al, 3
                jnz     short loc_14028C4A8
                mov     rax, [rbp+28h]
                shr     rax, 3Ch
                and     al, cl
                cmp     al, 4
                jnz     short loc_14028C4A8
                mov     rax, [rbp+18h]
                mov     rcx, 3FFFFFFFFFFFFFFFh
                and     rax, rcx
                cmp     rax, r12
                jnz     short loc_14028C4A8
                cmp     [rbp+20h], r12w
                jz      loc_14028C5A7

loc_14028C4A8:                          ; CODE XREF: sub_14028C190+2E7↑j
                                        ; sub_14028C190+2F5↑j ...
                mov     eax, [rbx]
                test    al, 3
                jz      loc_14028C5D4
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     r14, rax
                jb      short loc_14028C511
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     r14, rax
                ja      short loc_14028C511
                mov     rcx, rdi
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                mov     rcx, 0FFFFFA8000000000h
                lea     rax, [rax+rax*2]
                add     rax, rax
                mov     rdx, rcx
                movzx   edx, byte ptr [rdx+rax*8]
                shr     dl, 1
                and     dl, 7
                jmp     loc_14028C59D
; ---------------------------------------------------------------------------

loc_14028C511:                          ; CODE XREF: sub_14028C190+332↑j
                                        ; sub_14028C190+344↑j
                mov     rdx, [rdi]
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rax, rax
                cmp     rdi, rax
                jb      short loc_14028C596
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdi, rax
                ja      short loc_14028C596
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028C596
                test    r12b, dl
                jz      short loc_14028C596
                test    dl, 20h
                jz      short loc_14028C550
                test    dl, 42h
                jnz     short loc_14028C596

loc_14028C550:                          ; CODE XREF: sub_14028C190+3B9↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14028C596
                shr     rdi, 3
                mov     r8, rdx
                and     edi, 1FFh
                or      r8, 20h
                mov     rax, [rax+rdi*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028C596
                or      rdx, 42h

loc_14028C596:                          ; CODE XREF: sub_14028C190+394↑j
                                        ; sub_14028C190+3A6↑j ...
                shr     rdx, 38h
                and     dl, 0Fh

loc_14028C59D:                          ; CODE XREF: sub_14028C190+37C↑j
                cmp     dl, r15b
                jnb     short loc_14028C5A7
                cmp     esi, [rbx+8]
                jnb     short loc_14028C5D4

loc_14028C5A7:                          ; CODE XREF: sub_14028C190+312↑j
                                        ; sub_14028C190+410↑j
                inc     qword ptr [rbx+20h]
                lea     rcx, [rbx+40h]
                xor     r9d, r9d
                mov     r8, r12
                mov     rdx, r14
                call    sub_1402882E0
                mov     eax, [rbx+48h]
                cmp     [rbx+4Ch], eax
                jnz     short loc_14028C5D4
                xor     r8d, r8d
                lea     rdx, [rbx+40h]
                mov     rcx, r13
                call    sub_140279D90

loc_14028C5D4:                          ; CODE XREF: sub_14028C190+1F0↑j
                                        ; sub_14028C190+23D↑j ...
                mov     r12, [rsp+58h+arg_0]
                mov     rbx, [rsp+58h+arg_10]
                mov     rbp, [rsp+58h+arg_18]
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                pop     rdi
                pop     rsi
                retn
; ---------------------------------------------------------------------------
algn_14028C5F0:                         ; DATA XREF: .pdata:00000001400CECC4↑o
                                        ; .pdata:00000001400CECD0↑o ...
                align 20h
sub_14028C190   endp


; =============== S U B R O U T I N E =======================================


sub_14028C600   proc near               ; CODE XREF: sub_14028C190+1E0↑p
                                        ; sub_140367BA4+24E↓p ...

var_58          = dword ptr -58h
var_50          = xmmword ptr -50h
var_40          = qword ptr -40h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_20          = dword ptr  28h
arg_28          = dword ptr  30h

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_0], rcx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 40h
                xor     eax, eax
                mov     rsi, r8
                xorps   xmm0, xmm0
                mov     [rsp+78h+var_40], rax
                mov     r14, r8
                mov     [rsp+78h+arg_10], eax
                movups  [rsp+78h+var_50], xmm0
                shl     rsi, 19h
                mov     rdi, r9
                mov     rbx, rdx
                mov     r8, 0FFFFF68000000000h
                mov     r12, rcx
                xor     r13d, r13d
                xor     ebp, ebp
                xor     r15d, r15d
                mov     rax, r8
                movzx   ecx, byte ptr [rcx+0B8h]
                shl     rax, 19h
                sub     rsi, rax
                mov     r9, 0FFFFF6FFFFFFFFFFh
                sar     rsi, 10h
                and     cl, 7
                jz      short loc_14028C68C
                mov     rax, r8
                cmp     rsi, rax
                jb      short loc_14028C68C
                mov     rax, r9
                cmp     rsi, rax
                jbe     loc_14028C85A

loc_14028C68C:                          ; CODE XREF: sub_14028C600+76↑j
                                        ; sub_14028C600+7E↑j
                mov     rdx, 3FFFFFFFFFFFFFFFh
                mov     r10, 7FFFFFFFF8h
                test    cl, cl
                jz      short loc_14028C707
                mov     rax, [rbx+18h]
                and     rax, rdx
                cmp     rax, 1
                jbe     short loc_14028C6C1
                mov     rcx, rbx
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14028C85A

loc_14028C6C1:                          ; CODE XREF: sub_14028C600+AF↑j
                cmp     word ptr [rbx+20h], 1
                ja      loc_14028C85A
                mov     ebp, 1
                test    rdi, rdi
                jz      short loc_14028C74E
                mov     rax, r8
                cmp     rsi, rax
                jb      short loc_14028C707
                mov     rax, r9
                cmp     rsi, rax
                ja      short loc_14028C707
                mov     rcx, r14
                shr     rcx, 9
                and     rcx, r10
                mov     rax, r8
                add     rcx, rax
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     rcx, rax
                setz    r13b

loc_14028C707:                          ; CODE XREF: sub_14028C600+A2↑j
                                        ; sub_14028C600+DC↑j ...
                test    rdi, rdi
                jz      short loc_14028C730
                mov     rax, r8
                cmp     rsi, rax
                jb      short loc_14028C730
                mov     rax, r9
                cmp     rsi, rax
                ja      short loc_14028C730
                xor     r8d, r8d
                mov     rdx, r14
                mov     rcx, r12
                mov     r15d, 1
                call    sub_140225CC0

loc_14028C730:                          ; CODE XREF: sub_14028C600+10A↑j
                                        ; sub_14028C600+112↑j ...
                test    ebp, ebp
                jz      loc_14028C861
                test    r13d, r13d
                jz      short loc_14028C74E
                lea     rdx, [rsp+78h+var_50]
                lea     rcx, qword_140C4ECC0
                call    KeAcquireInStackQueuedSpinLock

loc_14028C74E:                          ; CODE XREF: sub_14028C600+D4↑j
                                        ; sub_14028C600+13B↑j
                mov     [rsp+78h+var_58], 0
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                mov     [rsp+78h+arg_10], 1
                jnb     short loc_14028C78C
                nop     word ptr [rax+rax+00h]

loc_14028C770:                          ; CODE XREF: sub_14028C600+181↓j
                                        ; sub_14028C600+18A↓j
                lea     rcx, [rsp+78h+var_58]
                call    sub_1402C8C70
                mov     rax, [rbx+18h]
                test    rax, rax
                js      short loc_14028C770
                lock bts qword ptr [rbx+18h], 3Fh ; '?'
                jb      short loc_14028C770

loc_14028C78C:                          ; CODE XREF: sub_14028C600+168↑j
                mov     rax, [rbx+18h]
                mov     rcx, 3FFFFFFFFFFFFFFFh
                and     rax, rcx
                cmp     rax, 1
                jbe     short loc_14028C7AF
                mov     rcx, rbx
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14028C7C9

loc_14028C7AF:                          ; CODE XREF: sub_14028C600+1A1↑j
                test    byte ptr [r12+0B8h], 7
                jz      loc_14028C861
                cmp     word ptr [rbx+20h], 1
                jbe     loc_14028C861

loc_14028C7C9:                          ; CODE XREF: sub_14028C600+1AD↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rax
                test    r13d, r13d
                jz      short loc_14028C84A
                lea     rcx, [rsp+78h+var_50]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rsp+78h+var_40]
                test    eax, eax
                jz      short loc_14028C846
                test    al, 1
                jz      short loc_14028C846
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14028C846
                cmp     bl, 0Fh
                ja      short loc_14028C846
                cmp     al, 2
                jb      short loc_14028C846
                mov     r10, gs:20h
                mov     r9, 0FFFFFFFFFFFFFFFFh
                mov     r8, [r10+84B8h]
                mov     edx, [r8+14h]
                movzx   ecx, byte ptr [rsp+78h+var_40]
                inc     ecx
                shl     r9, cl
                movzx   eax, r9w
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_14028C846
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14028C846:                          ; CODE XREF: sub_14028C600+1F4↑j
                                        ; sub_14028C600+1F8↑j ...
                mov     cr8, rbx

loc_14028C84A:                          ; CODE XREF: sub_14028C600+1DB↑j
                test    r15d, r15d
                jz      short loc_14028C85A
                mov     rdx, r14
                mov     rcx, r12
                call    sub_140312B40

loc_14028C85A:                          ; CODE XREF: sub_14028C600+86↑j
                                        ; sub_14028C600+BB↑j ...
                xor     eax, eax
                jmp     loc_14028CE2E
; ---------------------------------------------------------------------------

loc_14028C861:                          ; CODE XREF: sub_14028C600+132↑j
                                        ; sub_14028C600+1B8↑j ...
                mov     r10, 0FFFFF6FB7DBED000h
                mov     rbp, 0FFFFF6FB7DBED7F8h
                test    rdi, rdi
                jz      loc_14028CD45
                test    r15d, r15d
                jz      short loc_14028C8AB
                mov     rcx, r14
                call    sub_1402805F0
                mov     r8, 0CFFFFFFFFFFFFFDFh
                mov     r9d, r13d
                and     r8, rax
                mov     rdx, r14
                mov     rcx, r12
                call    sub_14029B94C
                jmp     loc_14028CA33
; ---------------------------------------------------------------------------

loc_14028C8AB:                          ; CODE XREF: sub_14028C600+281↑j
                mov     rdx, [r14]
                mov     r8, rdx
                mov     rax, r10
                cmp     r14, rax
                jb      short loc_14028C91E
                mov     rax, rbp
                cmp     r14, rax
                ja      short loc_14028C91E
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028C91E
                test    r8b, 1
                jz      short loc_14028C91E
                test    r8b, 20h
                jz      short loc_14028C8DC
                test    r8b, 42h
                jnz     short loc_14028C91E

loc_14028C8DC:                          ; CODE XREF: sub_14028C600+2D4↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r9, [rcx+788h]
                test    r9, r9
                jz      short loc_14028C91E
                or      r8, 20h
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r9+rax*8]
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                test    al, 42h
                jz      short loc_14028C91E
                or      r8, 42h

loc_14028C91E:                          ; CODE XREF: sub_14028C600+2B7↑j
                                        ; sub_14028C600+2BF↑j ...
                mov     rax, r10
                cmp     r14, rax
                jb      short loc_14028C98E
                mov     rax, rbp
                cmp     r14, rax
                ja      short loc_14028C98E
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028C98E
                test    dl, 1
                jz      short loc_14028C98E
                test    dl, 20h
                jz      short loc_14028C946
                test    dl, 42h
                jnz     short loc_14028C98E

loc_14028C946:                          ; CODE XREF: sub_14028C600+33F↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     r9, [rcx+788h]
                test    r9, r9
                jz      short loc_14028C98E
                mov     rax, r14
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [r9+rax*8]
                mov     r9, rdx
                or      r9, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r9, rdx
                mov     rdx, r9
                test    al, 42h
                jz      short loc_14028C98E
                or      rdx, 42h

loc_14028C98E:                          ; CODE XREF: sub_14028C600+324↑j
                                        ; sub_14028C600+32C↑j ...
                mov     rax, rdx
                mov     rcx, 0F00000000000000h
                and     rax, rcx
                mov     rcx, 0F0FFFFFFFFFFFFDFh
                and     r8, rcx
                mov     rcx, 7000000000000000h
                or      rax, r8
                xor     rdx, rax
                and     rdx, rcx
                xor     rdx, rax
                mov     rax, r10
                cmp     r14, rax
                jb      short loc_14028CA30
                mov     rax, rbp
                cmp     r14, rax
                ja      short loc_14028CA30
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028CA02
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14028C9F5
                test    dl, 1
                jz      short loc_14028C9F5
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14028C9F5:                          ; CODE XREF: sub_14028C600+3E1↑j
                                        ; sub_14028C600+3E6↑j
                mov     rcx, r14
                mov     [r14], rdx
                call    sub_140349620
                jmp     short loc_14028CA33
; ---------------------------------------------------------------------------

loc_14028CA02:                          ; CODE XREF: sub_14028C600+3D8↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14028CA30
                test    dl, 1
                jz      short loc_14028CA30
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14028CA30:                          ; CODE XREF: sub_14028C600+3C7↑j
                                        ; sub_14028C600+3CF↑j ...
                mov     [r14], rdx

loc_14028CA33:                          ; CODE XREF: sub_14028C600+2A6↑j
                                        ; sub_14028C600+400↑j
                mov     ebp, 1
                mov     r15, rsi
                mov     r12d, ebp
                cmp     [rdi], ebp
                jz      short loc_14028CA75
                movzx   ecx, byte ptr [rdi+4]
                test    cl, 8
                jnz     short loc_14028CA75
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rsi, rax
                jb      short loc_14028CA75
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rsi, rax
                ja      short loc_14028CA75
                or      cl, 8
                mov     [rdi+4], cl

loc_14028CA75:                          ; CODE XREF: sub_14028C600+440↑j
                                        ; sub_14028C600+449↑j ...
                mov     r8d, [rdi+0Ch]
                test    r8d, r8d
                jz      loc_14028CC90
                test    byte ptr [rdi+4], 4
                jnz     loc_14028CC1C
                lea     eax, [r8-1]
                lea     r10, [rdi+rax*8]
                mov     rax, [rdi+rax*8+18h]
                test    rax, 0C00h
                jnz     loc_14028CC1C
                mov     r9, rax
                mov     rcx, rax
                and     r9d, 3FFh
                and     rcx, 0FFFFFFFFFFFFF000h
                lea     rdx, [r9+1]
                shl     rdx, 0Ch
                add     rdx, rcx
                cmp     rdx, rsi
                jnz     loc_14028CC1C
                lea     rcx, [r9+1]
                cmp     rcx, r9
                jbe     loc_14028CC1C
                cmp     rcx, 3FFh
                ja      loc_14028CC1C
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rax, rcx
                inc     qword ptr [rdi+10h]
                mov     [r10+18h], rax

loc_14028CAFF:                          ; CODE XREF: sub_14028C600+68B↓j
                                        ; sub_14028C600+69A↓j ...
                mov     rbp, 0FFFFF6FB7DBED7F8h

loc_14028CB09:                          ; CODE XREF: sub_14028C600+732↓j
                                        ; sub_14028C600+740↓j ...
                cmp     [rsp+78h+arg_10], 1
                jnz     loc_14028CB98
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [rbx+18h], rax
                test    r13d, r13d
                jz      short loc_14028CB98
                lea     rcx, [rsp+78h+var_50]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rsp+78h+var_40]
                test    eax, eax
                jz      short loc_14028CB94
                test    al, 1
                jz      short loc_14028CB94
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14028CB94
                cmp     bl, 0Fh
                ja      short loc_14028CB94
                cmp     al, 2
                jb      short loc_14028CB94
                mov     r10, gs:20h
                mov     r9, 0FFFFFFFFFFFFFFFFh
                mov     r8, [r10+84B8h]
                mov     edx, [r8+14h]
                movzx   ecx, byte ptr [rsp+78h+var_40]
                inc     ecx
                shl     r9, cl
                movzx   eax, r9w
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_14028CB94
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14028CB94:                          ; CODE XREF: sub_14028C600+542↑j
                                        ; sub_14028C600+546↑j ...
                mov     cr8, rbx

loc_14028CB98:                          ; CODE XREF: sub_14028C600+511↑j
                                        ; sub_14028C600+529↑j
                test    r12d, r12d
                jz      loc_14028CE29
                mov     rdx, 0FFFFF68000000000h
                mov     rax, rdx
                cmp     rsi, rax
                jb      loc_14028CD52
                mov     rax, 0FFFFF6FFFFFFFFFFh
                mov     rax, rax
                cmp     rsi, rax
                ja      loc_14028CD52
                mov     rcx, rsi
                mov     rax, 7FFFFFFFF8h
                shr     rcx, 9
                and     rcx, rax
                mov     rax, rdx
                add     rcx, rax
                call    sub_1402805F0
                shr     rax, 0Ch
                mov     rcx, 0FFFFFFFFFh
                and     rax, rcx
                lea     rax, [rax+rax*2]
                add     rax, rax
                mov     rbx, 0FFFFFA8000000000h
                mov     ebx, [rbx+rax*8]
                shr     rbx, 1
                and     ebx, 7
                jmp     loc_14028CDF1
; ---------------------------------------------------------------------------

loc_14028CC1C:                          ; CODE XREF: sub_14028C600+486↑j
                                        ; sub_14028C600+49F↑j ...
                test    r8d, r8d
                jz      short loc_14028CC90
                test    byte ptr [rdi+4], 4
                jnz     short loc_14028CC90
                lea     eax, [r8-1]
                lea     r9, [rdi+rax*8]
                mov     rax, [rdi+rax*8+18h]
                test    rax, 0C00h
                jnz     short loc_14028CC90
                mov     rdx, rax
                lea     rcx, [rsi+1000h]
                and     rdx, 0FFFFFFFFFFFFF000h
                cmp     rdx, rcx
                jnz     short loc_14028CC90
                mov     rcx, rax
                and     ecx, 3FFh
                lea     rdx, [rcx+1]
                cmp     rdx, rcx
                jbe     short loc_14028CC90
                cmp     rdx, 3FFh
                ja      short loc_14028CC90
                add     rax, 0FFFFFFFFFFFFF000h
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rax, rcx
                inc     qword ptr [rdi+10h]
                mov     [r9+18h], rax
                jmp     loc_14028CAFF
; ---------------------------------------------------------------------------

loc_14028CC90:                          ; CODE XREF: sub_14028C600+47C↑j
                                        ; sub_14028C600+61F↑j ...
                cmp     r8d, [rdi+8]
                jb      short loc_14028CCA0
                mov     [rdi+5], bpl
                jmp     loc_14028CAFF
; ---------------------------------------------------------------------------
                align 20h

loc_14028CCA0:                          ; CODE XREF: sub_14028C600+694↑j
                                        ; sub_14028C600+71E↓j
                lea     rax, [rbp-1]
                mov     rcx, r15
                cmp     rax, 3FFh
                mov     edx, 400h
                cmovbe  rdx, rbp
                and     rcx, 0FFFFFFFFFFFFF000h
                sub     rbp, rdx
                lea     rax, [rdx-1]
                and     eax, 3FFh
                or      rax, rcx
                mov     rcx, rdx
                shl     rcx, 0Ch
                add     r15, rcx
                mov     ecx, [rdi+0Ch]
                mov     [rdi+rcx*8+18h], rax
                inc     dword ptr [rdi+0Ch]
                mov     ecx, [rdi+0Ch]
                add     [rdi+10h], rdx
                cmp     ecx, [rdi+8]
                jnz     short loc_14028CD1B
                test    byte ptr [rdi+4], 4
                jnz     short loc_14028CD1B
                mov     edx, ecx
                lea     r9, sub_14033B080
                lea     rcx, [rdi+18h]
                mov     r8d, 8
                call    qsort
                mov     rcx, rdi
                call    sub_14033A660
                mov     eax, [rdi+0Ch]
                cmp     eax, [rdi+8]
                jz      short loc_14028CD25

loc_14028CD1B:                          ; CODE XREF: sub_14028C600+6EB↑j
                                        ; sub_14028C600+6F1↑j
                test    rbp, rbp
                jnz     short loc_14028CCA0
                jmp     loc_14028CAFF
; ---------------------------------------------------------------------------

loc_14028CD25:                          ; CODE XREF: sub_14028C600+719↑j
                test    rbp, rbp
                mov     rbp, 0FFFFF6FB7DBED7F8h
                jz      loc_14028CB09
                mov     [rdi+5], r12b
                mov     [rdi+10h], rax
                jmp     loc_14028CB09
; ---------------------------------------------------------------------------

loc_14028CD45:                          ; CODE XREF: sub_14028C600+278↑j
                mov     r12d, [rsp+78h+arg_28]
                jmp     loc_14028CB09
; ---------------------------------------------------------------------------

loc_14028CD52:                          ; CODE XREF: sub_14028C600+5B1↑j
                                        ; sub_14028C600+5C7↑j
                mov     r8, rsi
                mov     rax, 7FFFFFFFF8h
                shr     r8, 9
                and     r8, rax
                mov     rax, rdx
                add     r8, rax
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rdx, [r8]
                mov     rax, rax
                cmp     r8, rax
                jb      short loc_14028CDE8
                mov     rax, rbp
                cmp     r8, rax
                ja      short loc_14028CDE8
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028CDE8
                test    dl, 1
                jz      short loc_14028CDE8
                test    dl, 20h
                jz      short loc_14028CDA1
                test    dl, 42h
                jnz     short loc_14028CDE8

loc_14028CDA1:                          ; CODE XREF: sub_14028C600+79A↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rax, [rcx+788h]
                test    rax, rax
                jz      short loc_14028CDE8
                shr     r8, 3
                and     r8d, 1FFh
                mov     rax, [rax+r8*8]
                mov     r8, rdx
                or      r8, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   r8, rdx
                mov     rdx, r8
                test    al, 42h
                jz      short loc_14028CDE8
                or      rdx, 42h

loc_14028CDE8:                          ; CODE XREF: sub_14028C600+77F↑j
                                        ; sub_14028C600+787↑j ...
                shr     rdx, 38h
                and     edx, 0Fh
                mov     ebx, edx

loc_14028CDF1:                          ; CODE XREF: sub_14028C600+617↑j
                cmp     [rsp+78h+arg_20], 0
                mov     rdi, [rsp+78h+arg_0]
                jz      short loc_14028CE13
                cmp     ebx, 7
                jz      short loc_14028CE13
                mov     rdx, r14
                mov     rcx, rdi
                call    sub_14028CE50

loc_14028CE13:                          ; CODE XREF: sub_14028C600+801↑j
                                        ; sub_14028C600+806↑j
                test    ebx, ebx
                jnz     short loc_14028CE29
                mov     r9b, 1
                lea     r8d, [rbx+1]
                mov     rdx, rsi
                mov     rcx, rdi
                call    sub_14027FDE0

loc_14028CE29:                          ; CODE XREF: sub_14028C600+59B↑j
                                        ; sub_14028C600+815↑j
                mov     eax, 1

loc_14028CE2E:                          ; CODE XREF: sub_14028C600+25C↑j
                mov     rbx, [rsp+78h+arg_8]
                add     rsp, 40h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14028C600   endp

algn_14028CE47:                         ; DATA XREF: .pdata:00000001400CECDC↑o
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame

sub_14028CE50   proc near               ; CODE XREF: sub_140265E70+983↑p
                                        ; sub_14026E700+4AE↑p ...

var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
var_10          = qword ptr -10h
arg_0           = qword ptr  48h
arg_8           = dword ptr  50h
arg_C           = dword ptr  54h
arg_10          = qword ptr  58h
arg_18          = qword ptr  60h

                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                mov     rbp, rsp
                sub     rsp, 48h
                movzx   r9d, byte ptr [rcx+0B8h]
                lea     r15, unk_140C4F628
                xor     r12d, r12d
                mov     [rbp+arg_C], 3
                and     r9b, 7
                mov     [rbp+var_10], r12
                mov     [rbp+arg_8], r12d
                mov     rbx, rdx
                mov     rsi, rcx
                cmp     r9b, 2
                jz      short loc_14028CE9C
                lea     r15, [rcx+0E8h]

loc_14028CE9C:                          ; CODE XREF: sub_14028CE50+43↑j
                mov     r13, rbx
                and     r13d, 1
                mov     [rbp+var_28], r13
                jz      short loc_14028CEAD
                and     rbx, 0FFFFFFFFFFFFFFFEh

loc_14028CEAD:                          ; CODE XREF: sub_14028CE50+57↑j
                mov     r8, [rbx]
                mov     r11, 0FFFFF6FB7DBED000h
                mov     rax, r11
                mov     r10, 0FFFFF6FB7DBED7F8h
                cmp     rbx, rax
                jb      short loc_14028CF37
                mov     rax, r10
                cmp     rbx, rax
                ja      short loc_14028CF37
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028CF37
                test    r8b, 1
                jz      short loc_14028CF37
                test    r8b, 20h
                jz      short loc_14028CEEF
                test    r8b, 42h
                jnz     short loc_14028CF37

loc_14028CEEF:                          ; CODE XREF: sub_14028CE50+97↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028CF37
                mov     rax, rbx
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r8
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_14028CF37
                or      r8, 42h

loc_14028CF37:                          ; CODE XREF: sub_14028CE50+7A↑j
                                        ; sub_14028CE50+82↑j ...
                mov     [rbp+arg_0], r8
                mov     rax, r11
                lea     rcx, [rbp+arg_0]
                cmp     rcx, rax
                jb      short loc_14028CFB7
                mov     rax, r10
                lea     rcx, [rbp+arg_0]
                cmp     rcx, rax
                ja      short loc_14028CFB7
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028CFB7
                test    r8b, 1
                jz      short loc_14028CFB7
                test    r8b, 20h
                jz      short loc_14028CF6E
                test    r8b, 42h
                jnz     short loc_14028CFB7

loc_14028CF6E:                          ; CODE XREF: sub_14028CE50+116↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028CFB7
                lea     rax, [rbp+arg_0]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r8
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_14028CFB7
                or      r8, 42h

loc_14028CFB7:                          ; CODE XREF: sub_14028CE50+F5↑j
                                        ; sub_14028CE50+101↑j ...
                shr     r8, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     r8, rax
                lea     r14, [r8+r8*2]
                shl     r14, 4
                mov     rax, 0FFFFFA8000000000h
                add     r14, rax
                lea     rdi, unk_140C4F640
                cmp     r9b, 2
                jz      short loc_14028CFF1
                lea     rdi, [rsi+100h]

loc_14028CFF1:                          ; CODE XREF: sub_14028CE50+198↑j
                mov     [rbp+var_18], rdi
                mov     [rbp+var_20], r12
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14028D024
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14028D024
                mov     eax, [rdx+18h]
                add     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14028D024
                call    sub_1403F2EC4

loc_14028D024:                          ; CODE XREF: sub_14028CE50+1BC↑j
                                        ; sub_14028CE50+1C2↑j ...
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_14028D03B
                mov     rdx, rdi
                lea     rcx, [rbp+var_20]
                call    sub_14051652C
                jmp     short loc_14028D050
; ---------------------------------------------------------------------------

loc_14028D03B:                          ; CODE XREF: sub_14028CE50+1DB↑j
                lea     rdx, [rbp+var_20]
                xchg    rdx, [rdi]
                test    rdx, rdx
                jz      short loc_14028D050
                lea     rcx, [rbp+var_20]
                call    sub_14025FC20

loc_14028D050:                          ; CODE XREF: sub_14028CE50+1E9↑j
                                        ; sub_14028CE50+1F5↑j
                mov     rdi, [r15]
                test    rdi, rdi
                jz      short loc_14028D066
                mov     rax, [rdi+20h]
                add     rax, 8
                cmp     rax, [rdi+28h]
                jbe     short loc_14028D07A

loc_14028D066:                          ; CODE XREF: sub_14028CE50+206↑j
                mov     rcx, rsi
                call    sub_1402685E0
                mov     rdi, rax
                test    rax, rax
                jz      loc_14028D307

loc_14028D07A:                          ; CODE XREF: sub_14028CE50+214↑j
                mov     rcx, r14
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14028D272
                mov     rsi, [r14+10h]
                bt      rsi, 0Ah
                jnb     loc_14028D272
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14028D0B1
                test    sil, 10h
                jnz     short loc_14028D0B1
                not     rax
                and     rsi, rax

loc_14028D0B1:                          ; CODE XREF: sub_14028CE50+253↑j
                                        ; sub_14028CE50+259↑j
                mov     rax, [r14+8]
                mov     rcx, 8000000000000000h
                mov     r12, [rdi+30h]
                or      rax, rcx
                mov     rcx, rax
                sar     rsi, 10h
                shl     rcx, 10h
                cmp     qword ptr [rdi+38h], 1
                mov     [rbp+arg_18], rax
                jbe     short loc_14028D0E4
                mov     rbx, rsi
                jmp     loc_14028D219
; ---------------------------------------------------------------------------

loc_14028D0E4:                          ; CODE XREF: sub_14028CE50+28A↑j
                test    byte ptr [rsi+22h], 2
                mov     r13, [rsi]
                mov     [rbp+arg_10], r13
                jz      short loc_14028D0FF
                test    dword ptr [r13+38h], 4000000h
                jnz     loc_14028D307

loc_14028D0FF:                          ; CODE XREF: sub_14028CE50+29F↑j
                lea     r14, [r13+40h]
                mov     rcx, r14
                call    sub_14024C570
                mov     r15, rax
                test    rax, rax
                jnz     loc_14028D19C
                lea     rbx, [r13+48h]
                mov     rcx, rbx
                call    ExAcquireSpinLockShared
                mov     rcx, r14
                movzx   r13d, al
                call    sub_14021AEA8
                mov     rcx, rbx
                mov     r15, rax
                call    ExReleaseSpinLockSharedFromDpcLevel
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14028D194
                test    al, 1
                jz      short loc_14028D194
                mov     rcx, cr8
                cmp     cl, 0Fh
                ja      short loc_14028D194
                cmp     r13b, 0Fh
                ja      short loc_14028D194
                cmp     cl, 2
                jb      short loc_14028D194
                mov     r10, gs:20h
                lea     ecx, [r13+1]
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                movzx   eax, dx
                mov     r9, [r10+84B8h]
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14028D194
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14028D194:                          ; CODE XREF: sub_14028CE50+2F2↑j
                                        ; sub_14028CE50+2F6↑j ...
                mov     cr8, r13
                mov     r13, [rbp+arg_10]

loc_14028D19C:                          ; CODE XREF: sub_14028CE50+2C1↑j
                mov     rbx, [r15+18h]
                prefetchw byte ptr [r14]
                mov     rax, [r14]
                mov     rcx, rax
                xor     rcx, r15
                cmp     rcx, 0Fh
                jnb     short loc_14028D1CA

loc_14028D1B3:                          ; CODE XREF: sub_14028CE50+378↓j
                lea     rcx, [rax+1]
                lock cmpxchg [r14], rcx
                jz      short loc_14028D1D2
                mov     r8, rax
                xor     r8, r15
                cmp     r8, 0Fh
                jb      short loc_14028D1B3

loc_14028D1CA:                          ; CODE XREF: sub_14028CE50+361↑j
                mov     rcx, r15
                call    ObDereferenceObjectDeferDelete

loc_14028D1D2:                          ; CODE XREF: sub_14028CE50+36C↑j
                mov     rdx, [rbp+arg_18]
                mov     r8d, 0FFFFFFFFh
                mov     rcx, rsi
                call    sub_140270E80
                mov     edx, [r13+38h]
                mov     ecx, edx
                mov     r13, [rbp+var_28]
                shr     rcx, 5
                shl     edx, 5
                and     ecx, 1
                movzx   ecx, byte ptr [rbp+rcx*4+arg_8]
                shl     rax, cl
                xor     edx, eax
                mov     [rbp+arg_10], rax
                and     edx, 400h
                xor     edx, eax
                mov     dword ptr [rbp+arg_10], edx
                sub     r12, 8
                mov     rcx, [rbp+arg_10]

loc_14028D219:                          ; CODE XREF: sub_14028CE50+28F↑j
                mov     rax, [rdi+28h]
                lea     rdx, [rax+8]
                cmp     rdx, r12
                ja      short loc_14028D23B

loc_14028D226:                          ; CODE XREF: sub_14028CE50+3E2↓j
                cmp     [rdx], rbx
                jz      short loc_14028D236
                add     rdx, 8
                cmp     rdx, r12
                jbe     short loc_14028D226
                jmp     short loc_14028D23B
; ---------------------------------------------------------------------------

loc_14028D236:                          ; CODE XREF: sub_14028CE50+3D9↑j
                cmp     rdx, r12
                jbe     short loc_14028D249

loc_14028D23B:                          ; CODE XREF: sub_14028CE50+3D4↑j
                                        ; sub_14028CE50+3E4↑j
                mov     rdx, rax
                add     rax, 0FFFFFFFFFFFFFFF8h
                mov     [rdi+28h], rax
                mov     [rdx], rbx

loc_14028D249:                          ; CODE XREF: sub_14028CE50+3E9↑j
                mov     rax, [rdi+30h]
                and     rcx, 0FFFFFFFFFFFFFC00h
                sub     rax, rdx
                mov     edx, r13d
                sar     rax, 3
                and     eax, 1FFh
                shl     rdx, 9
                or      rax, rdx
                or      rax, rcx
                xor     r12d, r12d
                jmp     short loc_14028D280
; ---------------------------------------------------------------------------

loc_14028D272:                          ; CODE XREF: sub_14028CE50+234↑j
                                        ; sub_14028CE50+243↑j
                mov     eax, r13d
                shl     rax, 9
                shl     rbx, 10h
                or      rax, rbx

loc_14028D280:                          ; CODE XREF: sub_14028CE50+420↑j
                mov     rcx, [rdi+20h]
                mov     [rcx], rax
                add     qword ptr [rdi+20h], 8
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_14028D2A4
                mov     rdx, [rbp+40h]
                lea     rcx, [rbp+var_20]
                call    sub_1405165EC
                jmp     short loc_14028D2DA
; ---------------------------------------------------------------------------

loc_14028D2A4:                          ; CODE XREF: sub_14028CE50+443↑j
                prefetchw byte ptr [rbp+var_20]
                mov     rax, [rbp+var_20]
                test    rax, rax
                jnz     short loc_14028D2D0
                mov     rcx, [rbp+var_18]
                lea     rax, [rbp+var_20]
                lock cmpxchg [rcx], r12
                lea     rcx, [rbp+var_20]
                cmp     rax, rcx
                jz      short loc_14028D2DA
                lea     rcx, [rbp+var_20]
                call    sub_140313680

loc_14028D2D0:                          ; CODE XREF: sub_14028CE50+45F↑j
                mov     [rbp+var_20], r12
                lock xor qword ptr [rax+8], 1

loc_14028D2DA:                          ; CODE XREF: sub_14028CE50+452↑j
                                        ; sub_14028CE50+475↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14028D310
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14028D310
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14028D310
                call    sub_1403F2EC4
                jmp     short loc_14028D310
; ---------------------------------------------------------------------------

loc_14028D307:                          ; CODE XREF: sub_14028CE50+224↑j
                                        ; sub_14028CE50+2A9↑j
                lea     rcx, [rbp+var_20]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel

loc_14028D310:                          ; CODE XREF: sub_14028CE50+49D↑j
                                        ; sub_14028CE50+4A3↑j ...
                add     rsp, 48h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14028CE50   endp

algn_14028D322:                         ; DATA XREF: .pdata:00000001400CECE8↑o
                align 10h
; Exported entry 1311. KeSetActualBasePriorityThread

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=57h

                public KeSetActualBasePriorityThread
KeSetActualBasePriorityThread proc near ; CODE XREF: sub_14020F26C+D2↑p
                                        ; sub_14020F4F0+289↑p ...

var_78          = qword ptr -78h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
var_28          = qword ptr -28h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_0           = dword ptr  10h
arg_8           = dword ptr  18h
arg_10          = dword ptr  20h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 000000014044554E SIZE 00000193 BYTES

                mov     [rsp-8+arg_8], edx
                mov     r11, rsp
                push    rbp
                push    rbx
                lea     rbp, [r11-5Fh]
                sub     rsp, 88h
                lea     rax, unk_140D24A00
                mov     rbx, rcx
                cmp     [rcx+220h], rax
                jz      loc_14044554E

loc_14028D35B:                          ; DATA XREF: .rdata:000000014005F048↑o
                                        ; .rdata:000000014005F068↑o ...
                mov     [r11-18h], rsi
                mov     [r11-20h], rdi
                mov     [r11-28h], r12
                mov     [r11-30h], r13
                xor     r13d, r13d
                mov     [r11-38h], r14
                mov     [rbp+57h+var_50], r13
                mov     [r11-40h], r15
                mov     r15, cr8
                mov     [rbp+57h+var_60], r15
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140445558

loc_14028D399:                          ; CODE XREF: KeSetActualBasePriorityThread+1B822A↓j
                                        ; KeSetActualBasePriorityThread+1B8234↓j ...
                mov     rdi, gs:20h
                mov     rsi, gs:20h
                mov     [rbp+57h+arg_10], r13d
                mov     r14, [rdi+8]
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14044559D

loc_14028D3C3:                          ; CODE XREF: KeSetActualBasePriorityThread+550↓j
                                        ; KeSetActualBasePriorityThread+1B8271↓j ...
                lock bts qword ptr [rbx+40h], 0
                jb      loc_14028D854
                movsx   eax, byte ptr [rbx+233h]
                mov     [rbx+285h], r13b
                mov     r12d, eax
                mov     rcx, gs:20h
                mov     [rbp+57h+arg_0], eax
                cmp     byte ptr [rbp+57h+arg_8], al
                jl      loc_14028D62B

loc_14028D3F6:                          ; CODE XREF: KeSetActualBasePriorityThread+302↓j
                                        ; KeSetActualBasePriorityThread+313↓j ...
                movzx   eax, byte ptr [rbp+57h+arg_8]
                mov     [rbx+233h], al
                movzx   eax, byte ptr [rbx+234h]
                test    al, al
                jnz     loc_14028D711

loc_14028D40F:                          ; CODE XREF: KeSetActualBasePriorityThread+3FB↓j
                movsx   eax, byte ptr [rbx+0C3h]
                cmp     [rbp+57h+arg_8], eax
                jz      loc_14028D54E
                cmp     rbx, r14
                jnz     loc_14028D699
                cmp     [rdi+20h], r13b
                jnz     loc_14028D699
                cli
                xor     r8d, r8d
                mov     rdx, rbx
                mov     rcx, rdi
                call    sub_1402CDFD0
                mov     rdx, rax
                sti

loc_14028D445:                          ; CODE XREF: KeSetActualBasePriorityThread+36D↓j
                movzx   ecx, byte ptr [rbx+28Bh]
                imul    ecx, cs:dword_140CFB150
                mov     eax, [rbx+78h]
                add     rcx, rdx
                test    al, 20h
                jnz     loc_14028D68E

loc_14028D461:                          ; CODE XREF: KeSetActualBasePriorityThread+364↓j
                movzx   edx, byte ptr [rbp+57h+arg_8]
                mov     [rbx+20h], rcx
                mov     rcx, rbx
                mov     [rbp+57h+arg_18], r13
                mov     [rbp+57h+var_58], r13
                call    sub_14028DB40
                movsx   r14d, al
                movsx   eax, byte ptr [rbx+0C3h]
                cmp     eax, r14d
                jz      loc_14028D54E
                lea     r8, [rbp+57h+var_58]
                mov     rcx, rbx
                lea     rdx, [rbp+57h+arg_18]
                call    sub_14028DCC0
                movzx   ecx, al
                mov     r15d, r13d
                movsx   r13d, byte ptr [rbx+0C3h]
                cmp     ecx, 2
                jnz     loc_14028D6A2
                mov     rsi, [rbp+57h+arg_18]
                mov     r8d, r14d
                mov     r12, [rsi+10h]
                lea     rax, [rsi+10h]
                test    r12, r12
                mov     [rbp+57h+var_48], rax
                mov     rdx, rbx
                mov     rcx, rsi
                setz    r9b
                call    sub_14028DBD0
                cmp     r14d, r13d
                jge     loc_14028D5CD
                test    r12, r12
                jnz     loc_14028D5CA
                movzx   eax, byte ptr [rbx+184h]
                mov     rsi, [rbp+57h+arg_18]
                cmp     al, 2
                jnz     loc_14028D88B
                xor     r8d, r8d
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_1402897D0
                mov     r14, rax
                test    rax, rax
                jnz     loc_14028D6F0

loc_14028D518:                          ; CODE XREF: KeSetActualBasePriorityThread:loc_14028D5CD↓j
                                        ; KeSetActualBasePriorityThread+2A6↓j
                mov     r12d, [rbp+57h+arg_0]

loc_14028D51C:                          ; CODE XREF: KeSetActualBasePriorityThread+2BD↓j
                                        ; KeSetActualBasePriorityThread+2C6↓j ...
                xor     r14b, r14b

loc_14028D51F:                          ; CODE XREF: KeSetActualBasePriorityThread+4B0↓j
                mov     rdx, rbx
                xor     ecx, ecx
                call    sub_14028DB70
                mov     r8, [rbp+57h+var_58]
                mov     rdx, rsi
                call    sub_1402B86D0
                test    r14b, r14b
                jnz     loc_14028D6CD

loc_14028D53E:                          ; CODE XREF: KeSetActualBasePriorityThread+3AE↓j
                                        ; KeSetActualBasePriorityThread+3BB↓j
                test    r15d, r15d
                jg      loc_14028D5FB

loc_14028D547:                          ; CODE XREF: KeSetActualBasePriorityThread+2DC↓j
                                        ; KeSetActualBasePriorityThread+2F0↓j ...
                mov     r15, [rbp+57h+var_60]
                xor     r13d, r13d

loc_14028D54E:                          ; CODE XREF: KeSetActualBasePriorityThread+E9↑j
                                        ; KeSetActualBasePriorityThread+157↑j
                mov     rcx, [rbx+0E8h]
                mov     r14, [rsp+90h+var_30]
                mov     rsi, [rsp+80h]
                test    rcx, rcx
                jnz     loc_14028D674

loc_14028D56B:                          ; CODE XREF: KeSetActualBasePriorityThread+34B↓j
                                        ; DATA XREF: .pdata:00000001400CED00↑o ...
                mov     [rbx+40h], r13
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jnz     loc_14044569A

loc_14028D588:                          ; CODE XREF: KeSetActualBasePriorityThread+359↓j
                                        ; KeSetActualBasePriorityThread+1B836E↓j ...
                movzx   r8d, r15b
                lea     rdx, [rbp+57h+var_50]
                mov     rcx, rdi
                call    sub_14028D950
                test    dword ptr cs:xmmword_140CFC480+4, 2000h
                mov     r15, [rsp+90h+var_38]
                mov     r13, [rsp+90h+var_28]
                mov     rdi, [rsp+90h+var_18]
                jnz     loc_1404456BE

loc_14028D5B7:                          ; CODE XREF: KeSetActualBasePriorityThread+1B83AC↓j
                                        ; DATA XREF: .pdata:00000001400CED0C↑o ...
                mov     eax, r12d
                mov     r12, [rsp+90h+var_20]

loc_14028D5BF:                          ; CODE XREF: KeSetActualBasePriorityThread+1B8223↓j
                                        ; DATA XREF: .pdata:00000001400CED18↑o ...
                add     rsp, 88h
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14028D5CA:                          ; CODE XREF: KeSetActualBasePriorityThread+1B5↑j
                                        ; DATA XREF: .pdata:00000001400CED24↑o ...
                cmp     r14d, r13d

loc_14028D5CD:                          ; CODE XREF: KeSetActualBasePriorityThread+1AC↑j
                jle     loc_14028D518
                test    r12, r12
                jnz     loc_14028D518
                movzx   eax, byte ptr [rbx+184h]
                mov     rsi, [rbp+57h+arg_18]
                mov     r12d, [rbp+57h+arg_0]
                cmp     al, 2
                jnz     loc_14028D51C

loc_14028D5F3:                          ; CODE XREF: KeSetActualBasePriorityThread+4E3↓j
                mov     r15d, r14d
                jmp     loc_14028D51C
; ---------------------------------------------------------------------------

loc_14028D5FB:                          ; CODE XREF: KeSetActualBasePriorityThread+211↑j
                mov     rdx, gs:20h
                mov     eax, cs:dword_140CFC450
                test    al, 2
                jz      loc_14028D547
                mov     rax, [rbp+57h+arg_18]
                mov     rcx, [rax+84B8h]
                test    rcx, rcx
                jz      loc_14028D547
                jmp     loc_140445606
; ---------------------------------------------------------------------------

loc_14028D62B:                          ; CODE XREF: KeSetActualBasePriorityThread+C0↑j
                cmp     [rbx+367h], r13b
                jbe     loc_14028D3F6
                lea     rdx, [rbx+330h]
                cmp     qword ptr [rdx], 1
                jnz     loc_14028D3F6
                lea     r8, [rcx+8770h]
                test    r8, r8
                jz      loc_14028D3F6
                mov     rax, [r8]
                mov     [rdx], rax
                mov     [r8], rdx
                lock inc word ptr [rbx+364h]
                call    sub_14032A28C
                jmp     loc_14028D3F6
; ---------------------------------------------------------------------------

loc_14028D674:                          ; CODE XREF: KeSetActualBasePriorityThread+235↑j
                                        ; DATA XREF: .pdata:00000001400CED30↑o ...
                movzx   eax, byte ptr [rcx]
                and     al, 7Fh
                cmp     al, 15h
                jnz     loc_14028D56B
                mov     rdx, rbx
                call    sub_14032F34C
                jmp     loc_14028D588
; ---------------------------------------------------------------------------

loc_14028D68E:                          ; CODE XREF: KeSetActualBasePriorityThread+12B↑j
                                        ; DATA XREF: .pdata:00000001400CED3C↑o ...
                lock btr dword ptr [rbx+78h], 5
                jmp     loc_14028D461
; ---------------------------------------------------------------------------

loc_14028D699:                          ; CODE XREF: KeSetActualBasePriorityThread+F2↑j
                                        ; KeSetActualBasePriorityThread+FC↑j
                mov     rdx, [rbx+48h]
                jmp     loc_14028D445
; ---------------------------------------------------------------------------

loc_14028D6A2:                          ; CODE XREF: KeSetActualBasePriorityThread+17E↑j
                sub     ecx, 1
                jz      loc_14028D730
                mov     r8d, r14d
                mov     rdx, rbx
                cmp     ecx, 2
                jz      loc_14028D801
                xor     r9d, r9d
                xor     ecx, ecx
                call    sub_14028DBD0
                mov     rsi, [rbp+57h+arg_18]
                jmp     loc_14028D51C
; ---------------------------------------------------------------------------

loc_14028D6CD:                          ; CODE XREF: KeSetActualBasePriorityThread+208↑j
                mov     edx, gs:1A4h
                mov     rax, [rbp+57h+arg_18]
                mov     ecx, [rax+24h]
                cmp     edx, ecx
                jz      loc_14028D53E
                mov     dl, 2
                call    sub_140308E0C
                jmp     loc_14028D53E
; ---------------------------------------------------------------------------

loc_14028D6F0:                          ; CODE XREF: KeSetActualBasePriorityThread+1E2↑j
                test    byte ptr [rax+2], 4
                jz      short loc_14028D76A
                mov     rdx, rsi
                mov     rcx, r14
                call    sub_1402D0980
                mov     dl, 1
                test    al, al
                jnz     short loc_14028D771
                movzx   edx, byte ptr [r14+0C3h]
                jmp     short loc_14028D771
; ---------------------------------------------------------------------------

loc_14028D711:                          ; CODE XREF: KeSetActualBasePriorityThread+D9↑j
                test    al, 0Fh
                jz      short loc_14028D724
                mov     eax, ds:0FFFFF78000000320h
                mov     [rbx+368h], eax

loc_14028D724:                          ; CODE XREF: KeSetActualBasePriorityThread+3E3↑j
                mov     [rbx+234h], r13b
                jmp     loc_14028D40F
; ---------------------------------------------------------------------------

loc_14028D730:                          ; CODE XREF: KeSetActualBasePriorityThread+375↑j
                mov     rsi, [rbp+57h+arg_18]
                mov     r9d, r13d
                mov     rdx, [rbp+57h+var_58]
                mov     rcx, rsi
                mov     r8, rbx
                call    sub_1402B8790
                xor     r9d, r9d
                mov     r8d, r14d
                mov     rdx, rbx
                xor     ecx, ecx
                call    sub_14028DBD0
                lea     r8, [rbp+57h+var_50]
                mov     edx, r14d
                mov     rcx, rbx
                call    sub_1402B8730
                jmp     loc_14028D51C
; ---------------------------------------------------------------------------

loc_14028D76A:                          ; CODE XREF: KeSetActualBasePriorityThread+3C4↑j
                movzx   edx, byte ptr [rax+0C3h]

loc_14028D771:                          ; CODE XREF: KeSetActualBasePriorityThread+3D5↑j
                                        ; KeSetActualBasePriorityThread+3DF↑j
                mov     rax, [rsi+38h]
                mov     [rax], dl
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jz      short loc_14028D78E
                cmp     r14, [rsi+18h]
                jz      short loc_14028D7E5
                movsx   edx, dl
                jmp     short loc_14028D7EB
; ---------------------------------------------------------------------------

loc_14028D78E:                          ; CODE XREF: KeSetActualBasePriorityThread+451↑j
                                        ; KeSetActualBasePriorityThread+4CA↓j
                mov     rax, [rbp+57h+var_48]
                cmp     r14, [rsi+18h]
                mov     [rax], r14
                setz    al
                test    rcx, rcx
                jnz     short loc_14028D7FC

loc_14028D7A1:                          ; CODE XREF: KeSetActualBasePriorityThread+4CF↓j
                movzx   eax, byte ptr [r14+184h]
                cmp     al, 1
                jnz     short loc_14028D7CD
                mov     ecx, [r14+84h]
                mov     eax, ds:0FFFFF78000000320h
                sub     ecx, [r14+1B4h]
                add     eax, ecx
                mov     [r14+84h], eax

loc_14028D7CD:                          ; CODE XREF: KeSetActualBasePriorityThread+47B↑j
                mov     rsi, [rbp+57h+arg_18]
                mov     r12d, [rbp+57h+arg_0]
                mov     byte ptr [r14+184h], 3
                mov     r14b, 1
                jmp     loc_14028D51F
; ---------------------------------------------------------------------------

loc_14028D7E5:                          ; CODE XREF: KeSetActualBasePriorityThread+457↑j
                mov     edx, cs:dword_140CFB01C

loc_14028D7EB:                          ; CODE XREF: KeSetActualBasePriorityThread+45C↑j
                xor     r8d, r8d
                call    sub_140520B44
                mov     rcx, [rsi+84B8h]
                jmp     short loc_14028D78E
; ---------------------------------------------------------------------------

loc_14028D7FC:                          ; CODE XREF: KeSetActualBasePriorityThread+46F↑j
                mov     [rcx+10h], al
                jmp     short loc_14028D7A1
; ---------------------------------------------------------------------------

loc_14028D801:                          ; CODE XREF: KeSetActualBasePriorityThread+384↑j
                mov     rsi, [rbp+57h+arg_18]
                mov     r9b, 1
                mov     rcx, rsi
                call    sub_14028DBD0
                cmp     r14d, r13d
                jge     loc_14028D5F3
                xor     r8d, r8d
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_1402897D0
                mov     r14, rax
                test    rax, rax
                jz      loc_14028D51C
                test    byte ptr [rax+2], 4
                jz      short loc_14028D8AC
                mov     rdx, rsi
                mov     rcx, rax
                call    sub_1402D0980
                mov     cl, 1
                test    al, al
                jnz     short loc_14028D8B3
                movzx   ecx, byte ptr [r14+0C3h]
                jmp     short loc_14028D8B3
; ---------------------------------------------------------------------------

loc_14028D854:                          ; CODE XREF: KeSetActualBasePriorityThread+9A↑j
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_1404455C4

loc_14028D864:                          ; CODE XREF: KeSetActualBasePriorityThread+544↓j
                                        ; KeSetActualBasePriorityThread+1B8298↓j ...
                lea     rcx, [rbp+57h+arg_10]
                call    sub_1402C8C70
                mov     rax, [rbx+40h]
                test    rax, rax
                jnz     short loc_14028D864
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jz      loc_14028D3C3
                jmp     loc_1404455EB
; ---------------------------------------------------------------------------

loc_14028D88B:                          ; CODE XREF: KeSetActualBasePriorityThread+1C8↑j
                mov     eax, [rsi+7C18h]
                lea     ecx, [r14+1]
                mov     r12d, [rbp+57h+arg_0]
                shr     eax, cl
                test    eax, eax
                jz      loc_14028D51C
                or      byte ptr [rbx+70h], 10h
                jmp     loc_14028D51C
; ---------------------------------------------------------------------------

loc_14028D8AC:                          ; CODE XREF: KeSetActualBasePriorityThread+507↑j
                movzx   ecx, byte ptr [rax+0C3h]

loc_14028D8B3:                          ; CODE XREF: KeSetActualBasePriorityThread+518↑j
                                        ; KeSetActualBasePriorityThread+522↑j
                mov     rax, [rsi+38h]
                mov     [rax], cl
                mov     rax, [rsi+84B8h]
                test    rax, rax
                jz      short loc_14028D8E6
                mov     edx, cs:dword_140CFB01C
                cmp     r14, [rsi+18h]
                jz      short loc_14028D8D4
                movsx   edx, cl

loc_14028D8D4:                          ; CODE XREF: KeSetActualBasePriorityThread+59F↑j
                xor     r8d, r8d
                mov     rcx, rax
                call    sub_140520B44
                mov     rax, [rsi+84B8h]

loc_14028D8E6:                          ; CODE XREF: KeSetActualBasePriorityThread+593↑j
                cmp     r14, [rsi+18h]
                mov     [rsi+10h], r14
                setz    cl
                test    rax, rax
                jz      short loc_14028D8F9
                mov     [rax+10h], cl

loc_14028D8F9:                          ; CODE XREF: KeSetActualBasePriorityThread+5C4↑j
                movzx   eax, byte ptr [r14+184h]
                cmp     al, 1
                jnz     short loc_14028D925
                mov     ecx, [r14+84h]
                mov     eax, ds:0FFFFF78000000320h
                sub     ecx, [r14+1B4h]
                add     eax, ecx
                mov     [r14+84h], eax

loc_14028D925:                          ; CODE XREF: KeSetActualBasePriorityThread+5D3↑j
                mov     rdx, rbx
                mov     byte ptr [r14+184h], 3
                lea     rcx, [rbp+57h+var_50]
                call    sub_1402C34D0
                mov     rsi, [rbp+57h+arg_18]
                jmp     loc_14028D51C
KeSetActualBasePriorityThread endp

; ---------------------------------------------------------------------------
algn_14028D942:                         ; DATA XREF: .pdata:00000001400CED48↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14028D950   proc near               ; CODE XREF: KeWaitForSingleObject+554↑p
                                        ; sub_14025C3A0+147↑p ...

var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h

; FUNCTION CHUNK AT 00000001404456E2 SIZE 0000016B BYTES

                push    rbx
                push    rdi
                sub     rsp, 28h
                movzx   edi, r8b
                mov     rbx, rcx
                call    sub_14028DAE0
                mov     rax, [rbx+10h]
                cmp     dil, 2
                jnb     short loc_14028D9A5

loc_14028D96D:                          ; DATA XREF: .rdata:000000014005F18C↑o
                                        ; .rdata:000000014005F1A0↑o ...
                mov     [rsp+38h+arg_8], rsi
                mov     rsi, [rbx+8]
                test    rax, rax
                jnz     short loc_14028D9C1
                mov     eax, [rsi+74h]
                test    al, 40h
                jnz     loc_1404457A6

loc_14028D986:                          ; CODE XREF: sub_14028D950+119↓j
                                        ; sub_14028D950+146↓j
                mov     eax, cs:dword_140CFC660
                mov     rsi, [rsp+38h+arg_8]
                test    eax, eax
                jnz     loc_1404457F6

loc_14028D999:                          ; CODE XREF: sub_14028D950+1B7EA8↓j
                                        ; sub_14028D950+1B7EB6↓j ...
                mov     cr8, rdi

loc_14028D99D:                          ; CODE XREF: sub_14028D950+58↓j
                                        ; sub_14028D950+63↓j ...
                add     rsp, 28h
                pop     rdi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028D9A5:                          ; CODE XREF: sub_14028D950+1B↑j
                test    rax, rax
                jz      short loc_14028D99D
                movzx   eax, byte ptr [rbx+312Ah]
                test    al, al
                jnz     short loc_14028D99D
                mov     dl, 2
                mov     rcx, rbx
                call    sub_140308B50
                jmp     short loc_14028D99D
; ---------------------------------------------------------------------------

loc_14028D9C1:                          ; CODE XREF: sub_14028D950+29↑j
                                        ; DATA XREF: .rdata:000000014005F1C8↑o ...
                mov     [rsp+38h+arg_0], rbp
                xor     edx, edx
                mov     rcx, rsi

loc_14028D9CB:                          ; DATA XREF: .rdata:000000014005F1C8↑o
                                        ; .rdata:000000014005F1D8↑o ...
                mov     [rsp+38h+var_18], r14
                call    sub_1402423B0
                mov     rbp, gs:20h
                xor     r14d, r14d
                mov     [rsp+38h+arg_10], r14d
                mov     rcx, [rbp+84B8h]
                test    rcx, rcx
                jnz     loc_1404456E2

loc_14028D9F6:                          ; CODE XREF: sub_14028D950+17D↓j
                                        ; sub_14028D950+1B7D96↓j ...
                lock bts qword ptr [rbx+30h], 0
                jb      loc_14028DA9B
                mov     rbp, [rbx+10h]
                mov     [rbx+10h], r14
                cli
                xor     r8d, r8d
                mov     rdx, rsi
                mov     rcx, rbx
                call    sub_1402CC660
                sti
                mov     r14, [rsp+38h+var_18]
                mov     [rbx+8], rbp
                movzx   eax, byte ptr [rbp+184h]
                cmp     al, 1
                jz      loc_14044574B

loc_14028DA33:                          ; CODE XREF: sub_14028D950+1B7E18↓j
                                        ; DATA XREF: .pdata:00000001400CED84↑o ...
                mov     byte ptr [rbp+184h], 2
                mov     rdx, rsi
                mov     rcx, rbx
                mov     byte ptr [rsi+283h], 20h ; ' '
                mov     [rsi+186h], dil
                call    sub_1402CE090
                movzx   r8d, dil
                mov     rdx, rbp
                mov     rcx, rsi
                call    sub_1404058F0
                mov     rbp, [rsp+38h+arg_0]
                test    al, al
                jz      loc_14028D986

loc_14028DA6F:                          ; DATA XREF: .rdata:000000014005F1B4↑o
                                        ; .pdata:00000001400CED90↑o ...
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14044576D

loc_14028DA7D:                          ; CODE XREF: sub_14028D950+1B7E1F↓j
                                        ; sub_14028D950+1B7E2D↓j ...
                mov     eax, 1
                mov     cr8, rax
                and     dword ptr [rsi+74h], 0FFFFFFBFh
                xor     r8d, r8d
                xor     edx, edx
                xor     ecx, ecx
                call    sub_1402C8140
                jmp     loc_14028D986
; ---------------------------------------------------------------------------

loc_14028DA9B:                          ; CODE XREF: sub_14028D950+AD↑j
                                        ; DATA XREF: .rdata:000000014005F1B4↑o ...
                mov     rcx, [rbp+84B8h]
                test    rcx, rcx
                jnz     loc_140445709
                nop     dword ptr [rax+rax+00h]

loc_14028DAB0:                          ; CODE XREF: sub_14028D950+171↓j
                                        ; sub_14028D950+1B7DBD↓j ...
                lea     rcx, [rsp+38h+arg_10]
                call    sub_1402C8C70
                mov     rax, [rbx+30h]
                test    rax, rax
                jnz     short loc_14028DAB0
                mov     rcx, [rbp+84B8h]
                test    rcx, rcx
                jz      loc_14028D9F6
                jmp     loc_140445730
sub_14028D950   endp

; ---------------------------------------------------------------------------
algn_14028DAD8:                         ; DATA XREF: .pdata:00000001400CEDA8↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028DAE0   proc near               ; CODE XREF: sub_140233220+156↑p
                                        ; sub_140240E30+BF6↑p ...

arg_0           = qword ptr  8

                mov     [rsp+arg_0], rbx
                push    rdi
                sub     rsp, 20h
                mov     rax, [rdx]
                mov     rbx, rdx
                mov     rdi, rcx
                test    rax, rax
                jnz     short loc_14028DB04

loc_14028DAF8:                          ; CODE XREF: sub_14028DAE0+42↓j
                mov     rbx, [rsp+28h+arg_0]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14028DB04:                          ; CODE XREF: sub_14028DAE0+16↑j
                mov     r8, [rax]
                mov     [rdx], r8

loc_14028DB0A:                          ; CODE XREF: sub_14028DAE0+4A↓j
                lea     rdx, [rax-0D8h]
                mov     r8, rbx
                mov     rcx, rdi
                call    sub_14023E510
                mov     rax, [rbx]
                test    rax, rax
                jz      short loc_14028DAF8
                mov     rcx, [rax]
                mov     [rbx], rcx
                jmp     short loc_14028DB0A
sub_14028DAE0   endp

; ---------------------------------------------------------------------------
algn_14028DB2C:                         ; DATA XREF: .pdata:00000001400CEDB4↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028DB40   proc near               ; CODE XREF: sub_14025C570+20↑p
                                        ; KeSetActualBasePriorityThread+144↑p ...

arg_8           = dword ptr  10h

                mov     eax, [rcx+358h]
                mov     [rsp+arg_8], 0
                test    eax, eax
                jnz     short loc_14028DB57

loc_14028DB52:                          ; CODE XREF: sub_14028DB40+21↓j
                movzx   eax, dl
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028DB57:                          ; CODE XREF: sub_14028DB40+10↑j
                bsr     r8d, eax
                movsx   ecx, dl
                cmp     ecx, r8d
                jge     short loc_14028DB52
                movzx   eax, r8b
                retn
sub_14028DB40   endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14028DB69:                         ; DATA XREF: .pdata:00000001400CEDC0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14028DB70   proc near               ; CODE XREF: sub_14025C570+C2↑p
                                        ; KeSetActualBasePriorityThread+1F4↑p ...
                test    rcx, rcx
                jnz     short loc_14028DB86
                mov     eax, [rdx+24Ch]
                lea     rcx, qword_140CFDCC0
                mov     rcx, [rcx+rax*8]

loc_14028DB86:                          ; CODE XREF: sub_14028DB70+3↑j
                mov     r8, [rcx+8440h]
                xor     eax, eax
                test    r8, r8
                jz      short loc_14028DBA4
                mov     rcx, [rdx+240h]
                and     rcx, r8
                cmp     rcx, r8
                setz    al

loc_14028DBA4:                          ; CODE XREF: sub_14028DB70+22↑j
                mov     ecx, [rdx+78h]
                shr     ecx, 0Dh
                and     ecx, 1
                cmp     eax, ecx
                jnz     short loc_14028DBB3
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028DBB3:                          ; CODE XREF: sub_14028DB70+3F↑j
                lock xor dword ptr [rdx+78h], 2000h
                retn
sub_14028DB70   endp

; ---------------------------------------------------------------------------
                db 0CCh
byte_14028DBBD  db 13h dup(0CCh)        ; DATA XREF: .pdata:00000001400CEDCC↑o

; =============== S U B R O U T I N E =======================================


sub_14028DBD0   proc near               ; CODE XREF: sub_14023E510+5A5↑p
                                        ; sub_14025C570+91↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014044584E SIZE 0000003A BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                push    rdi
                sub     rsp, 20h
                mov     rsi, rcx
                movzx   ebp, r9b
                mov     rcx, gs:20h
                mov     edi, r8d
                mov     rbx, rdx
                cmp     r8b, [rdx+0C3h]
                jle     short loc_14028DC0C
                cmp     byte ptr [rdx+319h], 0
                ja      short loc_14028DC75

loc_14028DC0C:                          ; CODE XREF: sub_14028DBD0+31↑j
                                        ; sub_14028DBD0+B0↓j ...
                mov     [rbx+0C3h], dil
                test    bpl, bpl
                jz      short loc_14028DC35
                test    byte ptr [rbx+2], 4
                jnz     short loc_14028DC58

loc_14028DC1E:                          ; CODE XREF: sub_14028DBD0+A3↓j
                mov     rax, [rsi+38h]
                mov     [rax], dil
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jnz     loc_14044584E

loc_14028DC35:                          ; CODE XREF: sub_14028DBD0+46↑j
                                        ; sub_14028DBD0+1B7C97↓j
                test    dword ptr [rbx+78h], 400000h
                jnz     loc_14044586C

loc_14028DC42:                          ; CODE XREF: sub_14028DBD0+1B7CB3↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rbp, [rsp+28h+arg_8]
                mov     rsi, [rsp+28h+arg_10]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                align 8

loc_14028DC58:                          ; CODE XREF: sub_14028DBD0+4C↑j
                mov     rdx, rsi
                mov     rcx, rbx
                call    sub_1402D0980
                test    al, al
                mov     al, 1
                jnz     short loc_14028DC70
                movzx   eax, byte ptr [rbx+0C3h]

loc_14028DC70:                          ; CODE XREF: sub_14028DBD0+97↑j
                movzx   edi, al
                jmp     short loc_14028DC1E
; ---------------------------------------------------------------------------

loc_14028DC75:                          ; CODE XREF: sub_14028DBD0+3A↑j
                add     rdx, 328h
                cmp     qword ptr [rdx], 1
                jnz     short loc_14028DC0C
                lea     r8, [rcx+8778h]
                test    r8, r8
                jz      loc_14028DC0C
                mov     rax, [r8]
                mov     [rdx], rax
                mov     [r8], rdx
                lock inc word ptr [rbx+364h]
                call    sub_14032A28C
                jmp     loc_14028DC0C
sub_14028DBD0   endp

; ---------------------------------------------------------------------------
algn_14028DCAD:                         ; DATA XREF: .rdata:000000014005F298↑o
                                        ; .pdata:00000001400CEDD8↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028DCC0   proc near               ; CODE XREF: sub_14025C570+53↑p
                                        ; KeSetActualBasePriorityThread+168↑p ...

var_48          = dword ptr -48h
var_44          = dword ptr -44h
arg_0           = dword ptr  8
arg_8           = qword ptr  10h
arg_18          = dword ptr  20h

; FUNCTION CHUNK AT 0000000140445888 SIZE 000001E6 BYTES

                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r13
                push    r14
                push    r15
                sub     rsp, 30h
                mov     r15, r8

loc_14028DCD2:                          ; DATA XREF: .rdata:000000014005F2C4↑o
                                        ; .rdata:000000014005F2D4↑o ...
                mov     [rsp+68h+arg_8], r12
                mov     rbp, rdx
                mov     rdi, rcx

loc_14028DCDD:                          ; CODE XREF: sub_14028DCC0+1B7D36↓j
                lea     r9, qword_140CFDCC0
                xor     r8d, r8d

loc_14028DCE7:                          ; CODE XREF: sub_14028DCC0+43↓j
                                        ; sub_14028DCC0+D3↓j ...
                movzx   esi, byte ptr [rdi+184h]
                mov     rbx, r8
                mov     r14, r8
                mov     ecx, esi
                cmp     esi, 2
                jnz     short loc_14028DD5E

loc_14028DCFB:                          ; CODE XREF: sub_14028DCC0+C4↓j
                mov     eax, [rdi+218h]
                test    eax, eax
                js      short loc_14028DCE7
                mov     r13, gs:20h
                mov     rbx, [r9+rax*8]
                mov     [rsp+68h+var_44], r8d
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_1404459FB

loc_14028DD27:                          ; CODE XREF: sub_14028DCC0+1F3↓j
                                        ; sub_14028DCC0+1B7D40↓j ...
                lock bts qword ptr [rbx+30h], 0
                jb      loc_14028DE86
                cmp     rdi, [rbx+8]

loc_14028DD38:                          ; CODE XREF: sub_14028DCC0+27B↓j
                jnz     loc_14028DDE1

loc_14028DD3E:                          ; CODE XREF: sub_14028DCC0+AF↓j
                                        ; sub_14028DCC0+B9↓j ...
                mov     r12, [rsp+68h+arg_8]
                movzx   eax, sil
                mov     [rbp+0], rbx
                mov     [r15], r14
                add     rsp, 30h
                pop     r15
                pop     r14
                pop     r13
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
algn_14028DD5D:                         ; DATA XREF: .pdata:00000001400CEDF0↑o
                                        ; .pdata:00000001400CEDFC↑o
                align 2

loc_14028DD5E:                          ; CODE XREF: sub_14028DCC0+39↑j
                                        ; DATA XREF: .pdata:00000001400CEDFC↑o ...
                sub     ecx, 1
                jz      loc_14028DE12
                sub     ecx, 2
                jz      short loc_14028DD89
                cmp     ecx, 2
                jnz     short loc_14028DD3E
                movzx   eax, byte ptr [rdi+70h]
                and     al, 7
                cmp     al, 1
                jz      short loc_14028DD3E
                sub     al, 3
                cmp     al, 3
                jbe     short loc_14028DD3E
                movzx   esi, cl
                jmp     loc_14028DCFB
; ---------------------------------------------------------------------------

loc_14028DD89:                          ; CODE XREF: sub_14028DCC0+AA↑j
                mov     r12d, [rdi+218h]
                test    r12d, r12d
                js      loc_14028DCE7
                mov     r13, gs:20h
                mov     rbx, [r9+r12*8]
                mov     [rsp+68h+arg_0], r8d
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_140445888

loc_14028DDBB:                          ; CODE XREF: sub_14028DCC0+22D↓j
                                        ; sub_14028DCC0+1B7BCD↓j ...
                lock bts qword ptr [rbx+30h], 0
                jb      loc_14028DEBE
                cmp     rdi, [rbx+10h]
                jz      loc_14028DD3E
                movzx   eax, byte ptr [rdi+184h]
                cmp     al, 3
                jz      loc_14028DFB8

loc_14028DDE1:                          ; CODE XREF: sub_14028DCC0:loc_14028DD38↑j
                                        ; sub_14028DCC0+26C↓j ...
                lock and qword ptr [rbx+30h], 0

loc_14028DDE7:                          ; CODE XREF: sub_14028DCC0+2F3↓j
                mov     rcx, gs:20h
                lea     r9, qword_140CFDCC0
                mov     r8d, 0
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      loc_14028DCE7
                jmp     loc_1404459C9
; ---------------------------------------------------------------------------

loc_14028DE12:                          ; CODE XREF: sub_14028DCC0+A1↑j
                mov     r12d, [rdi+218h]
                test    r12d, r12d
                jns     loc_14028DEF8
                mov     rbx, gs:20h
                mov     eax, r12d
                btr     eax, 1Fh
                mov     [rsp+68h+arg_18], r8d
                mov     rcx, [rbx+84B8h]
                mov     rax, [r9+rax*8]
                mov     r14, [rax+8448h]
                test    rcx, rcx
                jnz     loc_1404458F4

loc_14028DE55:                          ; CODE XREF: sub_14028DCC0+2E3↓j
                                        ; sub_14028DCC0+1B7C38↓j ...
                lock bts qword ptr [r14], 0
                jb      loc_14028DF74
                movzx   eax, byte ptr [rdi+184h]
                cmp     al, 1
                jnz     loc_14028DFAE
                mov     eax, [rdi+218h]
                cmp     eax, r12d
                jnz     loc_14028DFAE
                xor     ebx, ebx
                jmp     loc_14028DD3E
; ---------------------------------------------------------------------------

loc_14028DE86:                          ; CODE XREF: sub_14028DCC0+6E↑j
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_140445A23

loc_14028DE96:                          ; CODE XREF: sub_14028DCC0+1E7↓j
                                        ; sub_14028DCC0+1B7D68↓j ...
                lea     rcx, [rsp+68h+var_44]
                call    sub_1402C8C70
                mov     rax, [rbx+30h]
                test    rax, rax
                jnz     short loc_14028DE96
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jz      loc_14028DD27
                jmp     loc_140445A4B
; ---------------------------------------------------------------------------

loc_14028DEBE:                          ; CODE XREF: sub_14028DCC0+102↑j
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_1404458B0
                xchg    ax, ax

loc_14028DED0:                          ; CODE XREF: sub_14028DCC0+221↓j
                                        ; sub_14028DCC0+1B7BF5↓j ...
                lea     rcx, [rsp+68h+arg_0]
                call    sub_1402C8C70
                mov     rax, [rbx+30h]
                test    rax, rax
                jnz     short loc_14028DED0
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jz      loc_14028DDBB
                jmp     loc_1404458D8
; ---------------------------------------------------------------------------

loc_14028DEF8:                          ; CODE XREF: sub_14028DCC0+15C↑j
                mov     r13, gs:20h
                mov     rbx, [r9+r12*8]
                mov     [rsp+68h+var_48], r8d
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_14044595D

loc_14028DF1A:                          ; CODE XREF: sub_14028DCC0+2AD↓j
                                        ; sub_14028DCC0+1B7CA2↓j ...
                lock bts qword ptr [rbx+30h], 0
                jb      short loc_14028DF40
                movzx   eax, byte ptr [rdi+184h]
                cmp     al, 1
                jnz     loc_14028DDE1
                mov     eax, [rdi+218h]
                cmp     eax, r12d
                jmp     loc_14028DD38
; ---------------------------------------------------------------------------

loc_14028DF40:                          ; CODE XREF: sub_14028DCC0+261↑j
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jnz     loc_140445985

loc_14028DF50:                          ; CODE XREF: sub_14028DCC0+2A1↓j
                                        ; sub_14028DCC0+1B7CCA↓j ...
                lea     rcx, [rsp+68h+var_48]
                call    sub_1402C8C70
                mov     rax, [rbx+30h]
                test    rax, rax
                jnz     short loc_14028DF50
                mov     rcx, [r13+84B8h]
                test    rcx, rcx
                jz      short loc_14028DF1A
                jmp     loc_1404459AD
; ---------------------------------------------------------------------------

loc_14028DF74:                          ; CODE XREF: sub_14028DCC0+19B↑j
                mov     rcx, [rbx+84B8h]
                test    rcx, rcx
                jnz     loc_14044591B

loc_14028DF84:                          ; CODE XREF: sub_14028DCC0+2D7↓j
                                        ; sub_14028DCC0+1B7C5F↓j ...
                lea     rcx, [rsp+68h+arg_18]
                call    sub_1402C8C70
                mov     rax, [r14]
                test    rax, rax
                jnz     short loc_14028DF84
                mov     rcx, [rbx+84B8h]
                test    rcx, rcx
                jz      loc_14028DE55
                jmp     loc_140445942
; ---------------------------------------------------------------------------

loc_14028DFAE:                          ; CODE XREF: sub_14028DCC0+1AA↑j
                                        ; sub_14028DCC0+1B9↑j
                lock and qword ptr [r14], 0
                jmp     loc_14028DDE7
; ---------------------------------------------------------------------------

loc_14028DFB8:                          ; CODE XREF: sub_14028DCC0+11B↑j
                mov     eax, [rdi+218h]
                cmp     eax, r12d
                jnz     loc_14028DDE1
                jmp     loc_140445A67
sub_14028DCC0   endp

; ---------------------------------------------------------------------------
algn_14028DFCC:                         ; DATA XREF: .pdata:00000001400CEE08↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028DFE0   proc near               ; CODE XREF: KeQueryTotalCycleTimeThread+C7↑p
                                        ; sub_140240E30+A52↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h

; FUNCTION CHUNK AT 000000014041D6AA SIZE 00000031 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 20h
                movzx   esi, r8b
                mov     r10, rdx
                mov     rbx, rcx
                rdtsc
                shl     rdx, 20h
                or      rax, rdx
                mov     rdi, rax
                mov     r11, rax
                sub     rdi, [rcx+7EC0h]
                add     [rcx+7F38h], rdi
                movzx   ecx, byte ptr [r10+2]
                test    cl, 20h
                jz      short loc_14028E089
                mov     rdx, [rbx+8168h]
                mov     rax, [rbx+8170h]
                test    rdx, rdx
                jz      short loc_14028E05A
                test    rax, rax
                jz      short loc_14028E05A
                cmp     byte ptr [rax+64h], 0
                jnz     loc_14041D6AA
                mov     ecx, [rax+48h]
                mov     eax, [rdx+170h]
                cmp     ecx, eax
                jb      short loc_14028E051
                mov     ecx, eax

loc_14028E051:                          ; CODE XREF: sub_14028DFE0+6D↑j
                                        ; sub_14028DFE0+18F6CD↓j
                cmp     ecx, 4Bh ; 'K'
                jb      loc_14028E0EA

loc_14028E05A:                          ; CODE XREF: sub_14028DFE0+51↑j
                                        ; sub_14028DFE0+56↑j
                mov     edx, 3

loc_14028E05F:                          ; CODE XREF: sub_14028DFE0+114↓j
                movzx   r8d, byte ptr [rbx+81B8h]
                mov     eax, edx
                lea     r9, ds:0FE8h[rax*2]
                lea     rax, [r9+r8]
                mov     rdx, [rbx+rax*8]
                lea     rax, [r9+r8]
                add     rdx, rdi
                mov     [rbx+rax*8], rdx
                movzx   ecx, byte ptr [r10+2]

loc_14028E089:                          ; CODE XREF: sub_14028DFE0+3E↑j
                test    cl, 40h
                jnz     loc_14041D6B2

loc_14028E092:                          ; CODE XREF: sub_14028DFE0+18F6DC↓j
                                        ; sub_14028DFE0+18F6E6↓j
                mov     [rbx+7EC0h], r11
                movzx   eax, byte ptr [r10+2]
                test    al, 10h
                jnz     short loc_14028E0D7

loc_14028E0A2:                          ; CODE XREF: sub_14028DFE0+108↓j
                test    al, 2
                jnz     loc_14041D6CB

loc_14028E0AA:                          ; CODE XREF: sub_14028DFE0+18F6F6↓j
                cmp     byte ptr [rbx+6], 0
                mov     byte ptr [rbx+20h], 0
                jnz     short loc_14028E0C5

loc_14028E0B4:                          ; CODE XREF: sub_14028DFE0+EC↓j
                                        ; sub_14028DFE0+F5↓j
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_8]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028E0C5:                          ; CODE XREF: sub_14028DFE0+D2↑j
                mov     byte ptr [rbx+6], 0
                test    sil, sil
                jnz     short loc_14028E0B4
                mov     cl, 2
                call    HalRequestSoftwareInterrupt
                jmp     short loc_14028E0B4
; ---------------------------------------------------------------------------

loc_14028E0D7:                          ; CODE XREF: sub_14028DFE0+C0↑j
                movzx   eax, byte ptr [r10+7Ch]
                mov     [rbx+7EC8h], r11
                movzx   eax, byte ptr [r10+2]
                jmp     short loc_14028E0A2
; ---------------------------------------------------------------------------

loc_14028E0EA:                          ; CODE XREF: sub_14028DFE0+74↑j
                mov     eax, 51EB851Fh
                mul     ecx
                shr     edx, 3
                jmp     loc_14028E05F
sub_14028DFE0   endp

; ---------------------------------------------------------------------------
algn_14028E0F9:                         ; DATA XREF: .rdata:000000014005F320↑o
                                        ; .pdata:00000001400CEE14↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028E100   proc near               ; CODE XREF: KeQueryTotalCycleTimeThread+B1↑p
                                        ; sub_1402CC660+68↓p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

; FUNCTION CHUNK AT 000000014041D6DC SIZE 00000078 BYTES

                mov     [rsp+arg_10], rbx
                push    rdi
                sub     rsp, 20h
                movzx   r9d, byte ptr [rdx+2]
                mov     rbx, rdx
                mov     rdi, rcx
                test    r9b, 10h
                jnz     loc_14028E309

loc_14028E11F:                          ; CODE XREF: sub_14028E100+232↓j
                test    r9b, 20h
                jz      loc_14028E1F5
                mov     r10, [rdx+5F8h]
                test    r10, r10
                jz      loc_14028E1F1
                mov     rdx, [rcx+8168h]
                mov     rax, [rcx+8170h]

loc_14028E147:                          ; DATA XREF: .rdata:000000014005F340↑o
                                        ; .rdata:000000014005F354↑o ...
                mov     [rsp+28h+arg_0], rsi
                test    rdx, rdx
                jz      loc_14028E2FF
                test    rax, rax
                jz      loc_14028E2FF
                cmp     byte ptr [rax+64h], 0
                jnz     loc_14041D6DC
                mov     ecx, [rax+48h]
                mov     eax, [rdx+170h]
                cmp     ecx, eax
                jb      short loc_14028E177
                mov     ecx, eax

loc_14028E177:                          ; CODE XREF: sub_14028E100+73↑j
                                        ; sub_14028E100+204↓j ...
                cmp     ecx, 4Bh ; 'K'
                jb      loc_14041D6E4
                mov     edx, 3

loc_14028E185:                          ; CODE XREF: sub_14028E100+18F5EE↓j
                movzx   esi, byte ptr [rdi+81B8h]
                mov     r11d, edx
                lea     rax, [rsi+r11*2]
                mov     rcx, [r10+rax*8]
                lea     rdx, [r10+rax*8]
                mov     eax, cs:dword_140C2AF04
                add     rcx, r8
                mov     [rdx], rcx
                mov     ecx, [r10+0C0h]
                cmp     eax, ecx
                ja      loc_14028E2C8
                sub     ecx, eax
                cmp     ecx, 20h ; ' '
                jnb     short loc_14028E1CB
                mov     eax, 1
                shl     eax, cl
                or      [r10+0C4h], eax

loc_14028E1CB:                          ; CODE XREF: sub_14028E100+BB↑j
                                        ; sub_14028E100+1F3↓j
                cmp     cs:dword_140CFC930, 0
                jnz     short loc_14028E1E2
                mov     eax, [rbx+200h]
                cmp     al, 2
                jz      loc_14041D6F3

loc_14028E1E2:                          ; CODE XREF: sub_14028E100+D2↑j
                                        ; sub_14028E100+18F606↓j
                cmp     qword ptr [rbx+5C0h], 0
                jnz     short loc_14028E264

loc_14028E1EC:                          ; CODE XREF: sub_14028E100+19C↓j
                mov     rsi, [rsp+28h+arg_0]

loc_14028E1F1:                          ; CODE XREF: sub_14028E100+33↑j
                                        ; DATA XREF: .pdata:00000001400CEE2C↑o ...
                and     r9b, 0DFh

loc_14028E1F5:                          ; CODE XREF: sub_14028E100+23↑j
                test    r9b, 40h
                jnz     loc_14041D70B

loc_14028E1FF:                          ; CODE XREF: sub_14028E100+18F61F↓j
                test    r9b, 3Eh
                jnz     short loc_14028E211

loc_14028E205:                          ; CODE XREF: sub_14028E100+15D↓j
                                        ; sub_14028E100+18F64F↓j
                mov     rbx, [rsp+28h+arg_10]
                add     rsp, 20h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028E211:                          ; CODE XREF: sub_14028E100+103↑j
                mov     rcx, [rbx+68h]
                test    rcx, rcx
                jnz     loc_14028E2A1

loc_14028E21E:                          ; CODE XREF: sub_14028E100+1AD↓j
                                        ; sub_14028E100+1C0↓j
                test    byte ptr [rbx+2], 8
                jz      short loc_14028E24B
                mov     rax, [rdi+0C0h]
                mov     rcx, [rbx+240h]
                mov     rdx, [rax+88h]
                mov     rax, rdx
                and     rax, rcx
                cmp     rax, rdx
                jz      short loc_14028E24B
                add     [rdi+7EE8h], r8

loc_14028E24B:                          ; CODE XREF: sub_14028E100+122↑j
                                        ; sub_14028E100+142↑j
                cmp     byte ptr [rbx+7Dh], 0
                jnz     loc_14041D724

loc_14028E255:                          ; CODE XREF: sub_14028E100+18F635↓j
                                        ; sub_14028E100+18F641↓j
                cmp     qword ptr [rbx+168h], 0
                jz      short loc_14028E205
                jmp     loc_14041D746
; ---------------------------------------------------------------------------

loc_14028E264:                          ; CODE XREF: sub_14028E100+EA↑j
                                        ; DATA XREF: .pdata:00000001400CEE38↑o ...
                lea     rax, [rsi+10h]
                lea     rax, [rax+r11*2]
                mov     rcx, [r10+rax*8]
                lea     rdx, [r10+rax*8]
                add     rcx, r8
                mov     [rdx], rcx
                lea     rcx, [rsi+8]
                mov     rax, [rbx+5C0h]
                lea     rcx, [rcx+r11*2]
                mov     rax, [rax+5F8h]
                lea     rdx, [rax+rcx*8]
                mov     rax, r8
                lock xadd [rdx], rax
                jmp     loc_14028E1EC
; ---------------------------------------------------------------------------

loc_14028E2A1:                          ; CODE XREF: sub_14028E100+118↑j
                                        ; DATA XREF: .pdata:00000001400CEE44↑o ...
                mov     eax, [rdi+0D8h]
                add     rcx, rax
                test    rcx, rcx
                jz      loc_14028E21E

loc_14028E2B3:                          ; CODE XREF: sub_14028E100+1C6↓j
                add     [rcx], r8
                mov     rcx, [rcx+198h]
                test    rcx, rcx
                jz      loc_14028E21E
                jmp     short loc_14028E2B3
; ---------------------------------------------------------------------------

loc_14028E2C8:                          ; CODE XREF: sub_14028E100+B0↑j
                                        ; DATA XREF: .pdata:00000001400CEE50↑o ...
                mov     edx, eax
                mov     dword ptr [rsp+28h+arg_8], eax
                sub     edx, ecx
                cmp     edx, 20h ; ' '
                jnb     short loc_14028E2F8
                mov     eax, [r10+0C4h]
                mov     ecx, edx
                shl     eax, cl
                or      eax, 1

loc_14028E2E3:                          ; CODE XREF: sub_14028E100+1FD↓j
                mov     dword ptr [rsp+28h+arg_8+4], eax
                mov     rax, [rsp+28h+arg_8]
                mov     [r10+0C0h], rax
                jmp     loc_14028E1CB
; ---------------------------------------------------------------------------

loc_14028E2F8:                          ; CODE XREF: sub_14028E100+1D3↑j
                mov     eax, 1
                jmp     short loc_14028E2E3
; ---------------------------------------------------------------------------

loc_14028E2FF:                          ; CODE XREF: sub_14028E100+4F↑j
                                        ; sub_14028E100+58↑j
                mov     ecx, 64h ; 'd'
                jmp     loc_14028E177
; ---------------------------------------------------------------------------

loc_14028E309:                          ; CODE XREF: sub_14028E100+19↑j
                                        ; DATA XREF: .pdata:00000001400CEE5C↑o ...
                movzx   eax, byte ptr [rdx+7Ch]
                mov     r11, [rcx+7EC0h]
                sub     r11, [rcx+7EC8h]
                add     [rcx+rax*8+7ED0h], r11
                and     r9b, 0EFh
                mov     qword ptr [rcx+7EC8h], 0
                jmp     loc_14028E11F
sub_14028E100   endp

; ---------------------------------------------------------------------------
algn_14028E337:                         ; DATA XREF: .pdata:00000001400CEE68↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=0A0h

sub_14028E340   proc near               ; CODE XREF: sub_140286D90+399↑p
                                        ; sub_140286D90+11FB↑p ...

var_180         = dword ptr -180h
var_178         = dword ptr -178h
var_170         = qword ptr -170h
var_168         = qword ptr -168h
var_160         = qword ptr -160h
var_158         = qword ptr -158h
var_150         = qword ptr -150h
var_148         = xmmword ptr -148h
var_138         = xmmword ptr -138h
var_128         = xmmword ptr -128h
var_110         = dword ptr -110h
var_10C         = word ptr -10Ch
var_10A         = word ptr -10Ah
var_108         = qword ptr -108h
var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = byte ptr -0F0h
var_50          = dword ptr -50h
var_30          = qword ptr -30h
var_20          = qword ptr -20h
var_18          = qword ptr -18h
arg_8           = qword ptr  18h
arg_10          = qword ptr  20h
arg_18          = qword ptr  28h

; FUNCTION CHUNK AT 0000000140445A6E SIZE 00000470 BYTES

; __unwind { // __GSHandlerCheck
                push    rbp
                push    r12
                push    r13
                lea     rbp, [rsp-90h]
                sub     rsp, 190h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rbp+0A0h+var_30], rax
                mov     r12, rcx
                xor     eax, eax
                lea     rcx, [rbp+0A0h+var_F0]
                mov     [rbp+0A0h+var_10A], ax
                xor     edx, edx
                mov     r8d, 98h
                call    memset
                mov     r13, [r12+8]
                xorps   xmm0, xmm0
                mov     [rsp+1A0h+var_160], r13
                movups  [rsp+1A0h+var_148], xmm0
                movups  [rsp+1A0h+var_138], xmm0
                movups  [rsp+1A0h+var_128], xmm0
                test    r13, r13
                jz      loc_14028E7B5
; } // starts at 14028E340

loc_14028E3A2:                          ; DATA XREF: .rdata:000000014005F3FC↑o
                                        ; .rdata:000000014005F410↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+1A0h+arg_8], rbx
                mov     [rsp+1A0h+arg_10], rsi
                mov     [rsp+1A0h+arg_18], rdi
                mov     [rsp+1A0h+var_18], r14
                mov     [rsp+1A0h+var_20], r15
                mov     r15, r13
                shl     r15, 19h
                mov     r8, 0FFFFF68000000000h
                mov     rax, r8
                mov     rdi, [r12]
                xor     r14d, r14d
                shl     rax, 19h
                sub     r15, rax
                mov     [rsp+1A0h+var_170], rdi
                sar     r15, 10h
                movzx   eax, byte ptr [rdi+0B8h]
                mov     [rsp+1A0h+var_158], r15
                and     al, 7
                jnz     loc_14028E8B6
                mov     ecx, 1

loc_14028E40E:                          ; CODE XREF: sub_14028E340+581↓j
                mov     [rbp+0A0h+var_108], 14h
                mov     [rbp+0A0h+var_110], ecx
                mov     [rbp+0A0h+var_10C], r14w
                mov     [rbp+0A0h+var_100], r14
                mov     [rbp+0A0h+var_F8], r14
                test    byte ptr [rdi+0B8h], 7
                mov     r9, 0FFFFF6FB7DBED7F8h
                mov     rsi, 0FFFFFA8000000000h
                jnz     loc_14028E8C6
                cmp     [r12+10h], r14
                jbe     loc_14028E5DA
                mov     rdi, r13
                mov     rcx, 0FFFFF6FFFFFFFFFFh
                mov     r13, 0FFFFF6FB7DBED000h
                mov     rsi, r15
                nop     dword ptr [rax+00h]

loc_14028E470:                          ; CODE XREF: sub_14028E340+278↓j
                mov     rbx, [rdi]
                mov     rax, r13
                cmp     rdi, rax
                jnb     loc_14028E94A

loc_14028E47F:                          ; CODE XREF: sub_14028E340+610↓j
                                        ; sub_14028E340+1B7738↓j ...
                mov     rdx, [rdi]
                and     rbx, 0FFFFFFFFFFFFFFFEh
                bts     rbx, 0Ah
                mov     [rsp+1A0h+var_168], rbx
                mov     rax, r13
                cmp     rdi, rax
                jnb     loc_14028E95B

loc_14028E49C:                          ; CODE XREF: sub_14028E340+621↓j
                                        ; sub_14028E340+1B77CE↓j ...
                mov     eax, cs:dword_140CFC400
                bt      eax, 0Bh
                jb      loc_140445B1D
                bt      eax, 1Ah
                jb      loc_140445B27

loc_14028E4B6:                          ; CODE XREF: sub_14028E340+1B77E2↓j
                                        ; sub_14028E340+1B77EA↓j
                test    dl, 20h
                jz      loc_14028E794
                mov     rcx, rdi
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140445B53

loc_14028E4CF:                          ; CODE XREF: sub_14028E340+1B7840↓j
                mov     [rdi], rbx

loc_14028E4D2:                          ; CODE XREF: sub_14028E340+1B782B↓j
                mov     r8, 0FFFFF68000000000h
                mov     rcx, 0FFFFF6FFFFFFFFFFh

loc_14028E4E6:                          ; CODE XREF: sub_14028E340+470↓j
                movzx   r9d, byte ptr [rbp+0A0h+var_10C]
                mov     ebx, 1
                mov     r15, rsi
                cmp     [rbp+0A0h+var_110], ebx
                jnz     loc_140445B85

loc_14028E4FC:                          ; CODE XREF: sub_14028E340+1B7849↓j
                                        ; sub_14028E340+1B7855↓j ...
                mov     r8d, dword ptr [rbp+0A0h+var_108+4]
                test    r8d, r8d
                jz      loc_14028E728
                and     r9b, 4
                jnz     loc_14028E6F2
                lea     eax, [r8-1]
                lea     r11, [rbp+0A0h+var_F8]
                lea     r11, [r11+rax*8]
                mov     rax, [r11]
                test    rax, 0C00h
                jnz     loc_14028E6F2
                mov     r10, rax
                mov     rcx, rax
                and     r10d, 3FFh
                and     rcx, 0FFFFFFFFFFFFF000h
                lea     rdx, [r10+1]
                shl     rdx, 0Ch
                add     rdx, rcx
                cmp     rdx, rsi
                jnz     loc_14028E6F2
                lea     rcx, [r10+1]
                cmp     rcx, r10
                jbe     loc_14028E6F2
                cmp     rcx, 3FFh
                ja      loc_14028E6F2
                inc     [rbp+0A0h+var_100]
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rcx, rax
                mov     [r11], rcx

loc_14028E587:                          ; CODE XREF: sub_14028E340+44C↓j
                                        ; sub_14028E340+46A↓j ...
                inc     r14
                mov     r8, 0FFFFF68000000000h
                add     rdi, 8
                mov     rcx, 0FFFFF6FFFFFFFFFFh
                add     rsi, 1000h
                mov     r9, 0FFFFF6FB7DBED7F8h
                cmp     r14, [r12+10h]
                jb      loc_14028E470
                mov     r13, [rsp+1A0h+var_160]
                xor     r14d, r14d
                mov     r15, [rsp+1A0h+var_158]
                mov     rdi, [rsp+1A0h+var_170]
                mov     rsi, 0FFFFFA8000000000h

loc_14028E5DA:                          ; CODE XREF: sub_14028E340+10C↑j
                                        ; sub_14028E340+59D↓j ...
                mov     eax, [r12+18h]
                mov     rdx, r15
                movzx   r9d, byte ptr [r12+1Ch]
                and     eax, 1
                mov     r8, [r12+10h]
                mov     rcx, rdi
                mov     [rsp+1A0h+var_178], eax
                mov     [rsp+1A0h+var_180], 0Ah
                call    sub_14028B7E0
                mov     rdx, r15
                shr     rdx, 12h
                and     edx, 3FFFFFF8h
                mov     rcx, 0FFFFF6FB40000000h
                add     rdx, rcx
                mov     rax, 0FFFFF6FB7DBED000h
                mov     rbx, [rdx]
                mov     rax, rax
                cmp     rdx, rax
                jnb     loc_14028E8FC

loc_14028E637:                          ; CODE XREF: sub_14028E340+5CC↓j
                                        ; sub_14028E340+1B79E9↓j ...
                lea     rcx, [rsp+1A0h+var_150]
                mov     [rsp+1A0h+var_150], rbx
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140445DB6

loc_14028E64E:                          ; CODE XREF: sub_14028E340+1B7A80↓j
                                        ; sub_14028E340+1B7A9D↓j ...
                shr     rbx, 0Ch
                mov     rax, 0FFFFFFFFFh
                and     rbx, rax
                lea     rbx, [rbx+rbx*2]
                shl     rbx, 4
                mov     rax, rsi
                add     rbx, rax
                mov     eax, [rbx]
                shr     rax, 4
                test    eax, 3FFh
                jz      loc_14028E7BC

loc_14028E67E:                          ; CODE XREF: sub_14028E340+4A6↓j
                                        ; sub_14028E340+605↓j
                test    byte ptr [rdi+0B8h], 7
                jnz     loc_14028E7EB

loc_14028E68B:                          ; CODE XREF: sub_14028E340+4CB↓j
                                        ; sub_14028E340+571↓j
                test    byte ptr [r12+18h], 1
                lea     rcx, [rbp+0A0h+var_110]
                mov     rbx, r14
                cmovnz  rbx, qword ptr [rsp+1A0h+var_148+8]
                call    sub_14028EDB0
                mov     r15, [rsp+1A0h+var_20]
                mov     rax, rbx
                mov     rbx, [rsp+1A0h+arg_8]
                mov     rdi, [rsp+1A0h+arg_18]
                mov     rsi, [rsp+1A0h+arg_10]
                mov     [r12+8], r14
                mov     [r12+10h], r14
                mov     r14, [rsp+1A0h+var_18]
; } // starts at 14028E3A2

loc_14028E6D8:                          ; CODE XREF: sub_14028E340+477↓j
                                        ; DATA XREF: .pdata:00000001400CEE80↑o ...
; __unwind { // __GSHandlerCheck
                mov     rcx, [rbp+0A0h+var_30]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 190h
                pop     r13
                pop     r12
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 2
; } // starts at 14028E6D8

loc_14028E6F2:                          ; CODE XREF: sub_14028E340+1CD↑j
                                        ; sub_14028E340+1E8↑j ...
; __unwind { // __GSHandlerCheck
                test    r9b, r9b
                jnz     short loc_14028E728
                lea     eax, [r8-1]
                lea     r9, [rbp+0A0h+var_F8]
                lea     r9, [r9+rax*8]
                mov     rax, [r9]
                test    rax, 0C00h
                jnz     short loc_14028E728
                mov     rcx, rax
                lea     rdx, [rsi+1000h]
                and     rcx, 0FFFFFFFFFFFFF000h
                cmp     rcx, rdx
                jz      loc_140445BB4

loc_14028E728:                          ; CODE XREF: sub_14028E340+1C3↑j
                                        ; sub_14028E340+3B5↑j ...
                cmp     r8d, dword ptr [rbp+0A0h+var_108]
                jnb     loc_14028E917

loc_14028E732:                          ; CODE XREF: sub_14028E340+452↓j
                lea     rax, [rbx-1]
                cmp     rax, 3FFh
                ja      loc_140445BF9
                mov     rdx, rbx

loc_14028E745:                          ; CODE XREF: sub_14028E340+1B78BE↓j
                lea     rax, [rdx-1]
                mov     rcx, r15
                and     rcx, 0FFFFFFFFFFFFF000h
                and     eax, 3FFh
                or      rax, rcx
                sub     rbx, rdx
                mov     rcx, rdx
                shl     rcx, 0Ch
                add     r15, rcx
                mov     ecx, r8d
                mov     [rbp+rcx*8+0A0h+var_F8], rax
                mov     r8d, dword ptr [rbp+0A0h+var_108+4]
                add     [rbp+0A0h+var_100], rdx
                inc     r8d
                mov     dword ptr [rbp+0A0h+var_108+4], r8d
                cmp     r8d, dword ptr [rbp+0A0h+var_108]
                jz      loc_14028E96C

loc_14028E789:                          ; CODE XREF: sub_14028E340+630↓j
                                        ; sub_14028E340+660↓j
                test    rbx, rbx
                jz      loc_14028E587
                jmp     short loc_14028E732
; ---------------------------------------------------------------------------

loc_14028E794:                          ; CODE XREF: sub_14028E340+179↑j
                mov     r11, rbx
                xchg    r11, [rdi]
                mov     rax, r13
                cmp     rdi, rax
                jnb     loc_14028E9B4

loc_14028E7A6:                          ; CODE XREF: sub_14028E340+67A↓j
                                        ; sub_14028E340+1B780E↓j
                test    r11b, 20h
                jz      loc_14028E587
                jmp     loc_14028E4E6
; } // starts at 14028E6F2
; ---------------------------------------------------------------------------

loc_14028E7B5:                          ; CODE XREF: sub_14028E340+5C↑j
                                        ; DATA XREF: .pdata:00000001400CEE98↑o ...
; __unwind { // __GSHandlerCheck
                xor     eax, eax
                jmp     loc_14028E6D8
; } // starts at 14028E7B5
; ---------------------------------------------------------------------------

loc_14028E7BC:                          ; CODE XREF: sub_14028E340+338↑j
                                        ; DATA XREF: .pdata:00000001400CEEA4↑o ...
; __unwind { // __GSHandlerCheck
                lea     r8, [rbp+0A0h+var_50]
                mov     rdx, r15
                call    sub_1402FD640
                mov     cl, 8
                nop     word ptr [rax+rax+00h]

loc_14028E7D0:                          ; CODE XREF: sub_14028E340+4A4↓j
                add     cl, 0FFh
                movzx   eax, cl
                mov     edx, [rbp+rax*4+0A0h+var_50]
                test    edx, edx
                jnz     loc_14028E91F
                test    cl, cl
                jnz     short loc_14028E7D0
                jmp     loc_14028E67E
; ---------------------------------------------------------------------------

loc_14028E7EB:                          ; CODE XREF: sub_14028E340+345↑j
                mov     ecx, [r12+18h]
                mov     rdi, r14
                mov     eax, ecx
                and     eax, 8
                add     eax, eax
                mov     esi, eax
                or      esi, 4
                and     cl, 10h
                cmovz   esi, eax
                cmp     qword ptr [r12+10h], 0
                jbe     loc_14028E68B
                mov     r14, 0FFFFFFFF00000000h
                nop     dword ptr [rax+rax+00h]

loc_14028E820:                          ; CODE XREF: sub_14028E340+568↓j
                mov     rcx, [rsp+1A0h+var_170]
                lea     r9, [rsp+1A0h+var_148]
                mov     r8d, esi
                mov     rdx, r13
                call    sub_14027B890
                mov     eax, [r12+18h]
                test    al, 4
                jz      short loc_14028E895
                lea     rcx, [rsp+1A0h+var_168]
                mov     [rsp+1A0h+var_168], 0
                call    sub_14032C660
                mov     rbx, [rsp+1A0h+var_168]
                mov     rcx, r13
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140445E51

loc_14028E866:                          ; CODE XREF: sub_14028E340+1B7B64↓j
                                        ; sub_14028E340+1B7B6D↓j ...
                mov     [r13+0], rbx

loc_14028E86A:                          ; CODE XREF: sub_14028E340+1B7B45↓j
                mov     rdx, cs:qword_140C4DDC0
                mov     rax, [rsp+1A0h+var_168]
                mov     rcx, rax
                test    rdx, rdx
                jz      short loc_14028E88C
                test    cl, 10h
                jnz     short loc_14028E88C
                mov     rax, rdx
                not     rax
                and     rax, rcx

loc_14028E88C:                          ; CODE XREF: sub_14028E340+53C↑j
                                        ; sub_14028E340+541↑j
                test    r14, rax
                jz      loc_140445EC5

loc_14028E895:                          ; CODE XREF: sub_14028E340+4FC↑j
                                        ; sub_14028E340+1B7B99↓j
                inc     rdi
                add     r13, 8
                add     r15, 1000h
                cmp     rdi, [r12+10h]
                jb      loc_14028E820
                xor     r14d, r14d
                jmp     loc_14028E68B
; ---------------------------------------------------------------------------

loc_14028E8B6:                          ; CODE XREF: sub_14028E340+C3↑j
                mov     ecx, 2
                cmp     al, cl
                cmovnb  ecx, r14d
                jmp     loc_14028E40E
; ---------------------------------------------------------------------------

loc_14028E8C6:                          ; CODE XREF: sub_14028E340+101↑j
                movzx   eax, byte ptr [r12+1Ch]
                and     al, 0Fh
                cmp     al, 8
                jz      loc_140445C10

loc_14028E8D6:                          ; CODE XREF: sub_14028E340+1B78D5↓j
                                        ; sub_14028E340+1B79DA↓j
                mov     eax, [r12+18h]
                test    al, 4
                jnz     loc_14028E5DA
                mov     r8, [r12+10h]
                lea     rcx, [rbp+0A0h+var_110]
                xor     r9d, r9d
                mov     rdx, r15
                call    sub_1402882E0
                jmp     loc_14028E5DA
; ---------------------------------------------------------------------------

loc_14028E8FC:                          ; CODE XREF: sub_14028E340+2F1↑j
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     rdx, rax
                ja      loc_14028E637
                jmp     loc_140445D1F
; ---------------------------------------------------------------------------

loc_14028E917:                          ; CODE XREF: sub_14028E340+3EC↑j
                mov     byte ptr [rbp+0A0h+var_10C+1], bl
                jmp     loc_14028E587
; ---------------------------------------------------------------------------

loc_14028E91F:                          ; CODE XREF: sub_14028E340+49C↑j
                mov     rax, [rbx]
                and     edx, 3FFh
                movzx   ecx, cl
                and     rax, 0FFFFFFFFFFFE000Fh
                and     ecx, 7
                shl     rcx, 0Ah
                or      rcx, rdx
                shl     rcx, 4
                or      rcx, rax
                mov     [rbx], rcx
                jmp     loc_14028E67E
; ---------------------------------------------------------------------------

loc_14028E94A:                          ; CODE XREF: sub_14028E340+139↑j
                mov     rax, r9
                cmp     rdi, rax
                ja      loc_14028E47F
                jmp     loc_140445A6E
; ---------------------------------------------------------------------------

loc_14028E95B:                          ; CODE XREF: sub_14028E340+156↑j
                mov     rax, r9
                cmp     rdi, rax
                ja      loc_14028E49C
                jmp     loc_140445AFD
; ---------------------------------------------------------------------------

loc_14028E96C:                          ; CODE XREF: sub_14028E340+443↑j
                test    byte ptr [rbp+0A0h+var_10C], 4
                jnz     loc_14028E789
                mov     edx, r8d
                lea     r9, sub_14033B080
                mov     r8d, 8
                lea     rcx, [rbp+0A0h+var_F8]
                call    qsort
                lea     rcx, [rbp+0A0h+var_110]
                call    sub_14033A660
                mov     r8d, dword ptr [rbp+0A0h+var_108+4]
                cmp     r8d, dword ptr [rbp+0A0h+var_108]
                jnz     loc_14028E789
                test    rbx, rbx
                jz      loc_14028E587
                jmp     loc_140445C03
; ---------------------------------------------------------------------------

loc_14028E9B4:                          ; CODE XREF: sub_14028E340+460↑j
                mov     rax, r9
                cmp     rdi, rax
                ja      loc_14028E7A6
                jmp     loc_140445B2F
; } // starts at 14028E7BC
sub_14028E340   endp

; ---------------------------------------------------------------------------
algn_14028E9C5:                         ; DATA XREF: .pdata:00000001400CEEB0↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14028E9D0   proc near               ; CODE XREF: sub_140289B60+4A6↑p
                                        ; DATA XREF: .rdata:000000014005F4AC↑o ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h

                push    rbx
                sub     rsp, 20h
                mov     rbx, [rcx+0A8h]

loc_14028E9DD:                          ; DATA XREF: .rdata:000000014005F4AC↑o
                                        ; .rdata:000000014005F4C0↑o ...
                mov     [rsp+28h+arg_8], rsi
                mov     [rsp+28h+arg_10], rdi
                mov     rdi, rcx
                lea     rcx, [rbx+78h]
                call    sub_14028E340
                mov     rcx, [rdi+10h]
                call    sub_14028EDB0
                mov     rsi, [rbx]
                test    rsi, rsi
                jnz     short loc_14028EA20

loc_14028EA04:                          ; CODE XREF: sub_14028E9D0+83↓j
                mov     rcx, [rbx+58h]
                mov     rdi, [rsp+28h+arg_10]
                mov     rsi, [rsp+28h+arg_8]
                test    rcx, rcx
                jnz     short loc_14028EA55

loc_14028EA17:                          ; CODE XREF: sub_14028E9D0+92↓j
                                        ; DATA XREF: .pdata:00000001400CEEC8↑o ...
                xor     eax, eax
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 20h

loc_14028EA20:                          ; CODE XREF: sub_14028E9D0+32↑j
                                        ; DATA XREF: .rdata:000000014005F4EC↑o ...
                mov     rcx, [rdi+18h]

loc_14028EA24:                          ; DATA XREF: .rdata:000000014005F4EC↑o
                                        ; .pdata:00000001400CEEE0↑o ...
                mov     [rsp+28h+arg_0], rbp
                test    byte ptr [rcx+0B8h], 7
                jnz     short loc_14028EA64

loc_14028EA32:                          ; CODE XREF: sub_14028E9D0+A1↓j
                                        ; sub_14028E9D0+B0↓j
                xor     esi, esi
                xor     ebp, ebp

loc_14028EA36:                          ; CODE XREF: sub_14028E9D0+F4↓j
                mov     rdx, rbx
                call    sub_1402947A0
                test    rsi, rsi
                jnz     loc_14028EAC9

loc_14028EA47:                          ; CODE XREF: sub_14028E9D0+104↓j
                mov     rbp, [rsp+28h+arg_0]
                mov     qword ptr [rbx], 0
                jmp     short loc_14028EA04
; ---------------------------------------------------------------------------

loc_14028EA55:                          ; CODE XREF: sub_14028E9D0+45↑j
                                        ; DATA XREF: .pdata:00000001400CEEEC↑o ...
                call    sub_14033EA5C
                mov     qword ptr [rbx+58h], 0
                jmp     short loc_14028EA17
; ---------------------------------------------------------------------------

loc_14028EA64:                          ; CODE XREF: sub_14028E9D0+60↑j
                                        ; DATA XREF: .pdata:00000001400CEEF8↑o ...
                mov     rax, 0FFFFF6FB7DBED000h
                cmp     rsi, rax
                jb      short loc_14028EA32
                mov     rax, 0FFFFF6FB7DBEDFFFh
                cmp     rsi, rax
                ja      short loc_14028EA32
                mov     rbp, [rbx+8]
                mov     rax, 0FFFFF68000000000h
                shl     rax, 19h
                mov     ecx, 3

loc_14028EA99:                          ; CODE XREF: sub_14028E9D0+E3↓j
                shl     rsi, 19h
                shl     rbp, 19h
                sub     rsi, rax
                sub     rbp, rax
                sar     rsi, 10h
                sar     rbp, 10h
                sub     rcx, 1
                jnz     short loc_14028EA99
                mov     rdx, rbp
                mov     rcx, rsi
                call    sub_1403A4534
                mov     rcx, [rdi+18h]
                jmp     loc_14028EA36
; ---------------------------------------------------------------------------

loc_14028EAC9:                          ; CODE XREF: sub_14028E9D0+71↑j
                mov     rdx, rbp
                mov     rcx, rsi
                call    sub_1403A4534
                jmp     loc_14028EA47
sub_14028E9D0   endp

; ---------------------------------------------------------------------------
algn_14028EAD9:                         ; DATA XREF: .pdata:00000001400CEF04↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028EAE0   proc near               ; CODE XREF: sub_140234420+7B↑p
                                        ; sub_140243C30+581↑p ...

arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 0000000140445EDE SIZE 000000FE BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rbp
                mov     [rsp+arg_10], rsi
                mov     [rsp+arg_18], rdi
                push    r14
                sub     rsp, 20h
                xor     ebx, ebx
                movzx   edi, dl
                mov     rsi, rcx
                lea     r14d, [rbx+2]

loc_14028EB06:                          ; CODE XREF: sub_14028EAE0+E8↓j
                                        ; sub_14028EAE0+1B74D9↓j ...
                mov     eax, [rsi]
                test    eax, eax
                jns     short loc_14028EB3C
                nop     dword ptr [rax+00h]

loc_14028EB10:                          ; CODE XREF: sub_14028EAE0+5A↓j
                bt      eax, 1Eh
                jnb     loc_14028EBA9

loc_14028EB1A:                          ; CODE XREF: sub_14028EAE0+D3↓j
                cmp     dil, 0FFh
                jnz     short loc_14028EB7A

loc_14028EB20:                          ; CODE XREF: sub_14028EAE0+B0↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jz      loc_14028EBD3

loc_14028EB2E:                          ; CODE XREF: sub_14028EAE0+FB↓j
                                        ; sub_14028EAE0+108↓j
                pause

loc_14028EB30:                          ; CODE XREF: sub_14028EAE0+115↓j
                cmp     dil, 0FFh
                jnz     short loc_14028EB92

loc_14028EB36:                          ; CODE XREF: sub_14028EAE0+C2↓j
                                        ; sub_14028EAE0+1B746B↓j ...
                mov     eax, [rsi]

loc_14028EB38:                          ; CODE XREF: sub_14028EAE0+D9↓j
                test    eax, eax
                js      short loc_14028EB10

loc_14028EB3C:                          ; CODE XREF: sub_14028EAE0+2A↑j
                mov     rbp, gs:20h
                mov     rcx, [rbp+84B8h]
                test    rcx, rcx
                jnz     loc_140445F8E

loc_14028EB55:                          ; CODE XREF: sub_14028EAE0+1B74B2↓j
                                        ; sub_14028EAE0+1B74C1↓j ...
                lock bts dword ptr [rsi], 1Fh
                jb      short loc_14028EBBE
                mov     rbp, [rsp+28h+arg_8]
                mov     eax, ebx
                mov     rbx, [rsp+28h+arg_0]
                mov     rsi, [rsp+28h+arg_10]
                mov     rdi, [rsp+28h+arg_18]
                add     rsp, 20h
                pop     r14
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14028EB7A:                          ; CODE XREF: sub_14028EAE0+3E↑j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_140445EDE

loc_14028EB88:                          ; CODE XREF: sub_14028EAE0+1B7400↓j
                                        ; sub_14028EAE0+1B740C↓j ...
                movzx   eax, dil
                mov     cr8, rax
                jmp     short loc_14028EB20
; ---------------------------------------------------------------------------

loc_14028EB92:                          ; CODE XREF: sub_14028EAE0+54↑j
                mov     rdi, cr8
                mov     cr8, r14
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14028EB36
                jmp     loc_140445F49
; ---------------------------------------------------------------------------

loc_14028EBA9:                          ; CODE XREF: sub_14028EAE0+34↑j
                mov     ecx, eax
                bts     ecx, 1Eh
                lock cmpxchg [rsi], ecx
                jz      loc_14028EB1A
                jmp     loc_14028EB38
; ---------------------------------------------------------------------------

loc_14028EBBE:                          ; CODE XREF: sub_14028EAE0+7A↑j
                mov     rcx, [rbp+84B8h]
                test    rcx, rcx
                jz      loc_14028EB06
                jmp     loc_140445FB5
; ---------------------------------------------------------------------------

loc_14028EBD3:                          ; CODE XREF: sub_14028EAE0+48↑j
                mov     eax, cs:dword_140CFC41C
                test    al, 40h
                jz      loc_14028EB2E
                call    sub_140390EA0
                test    al, al
                jz      loc_14028EB2E
                mov     ecx, ebx
                call    sub_1403900C0
                jmp     loc_14028EB30
sub_14028EAE0   endp

; ---------------------------------------------------------------------------
algn_14028EBFA:                         ; DATA XREF: .rdata:000000014005F544↑o
                                        ; .pdata:00000001400CEF10↑o
                align 20h
; Exported entry 1132. KeCopyAffinityEx

; =============== S U B R O U T I N E =======================================


                public KeCopyAffinityEx
KeCopyAffinityEx proc near              ; CODE XREF: sub_14024EFB0+3F0↑p
                                        ; sub_140250E60+416↑p ...
                movzx   eax, word ptr [rdx]
                mov     r8, rdx
                mov     [rcx], ax
                mov     r9, rcx
                movzx   eax, word ptr [rdx+2]
                mov     [rcx+2], ax
                xor     eax, eax
                mov     [rcx+4], eax
                cmp     ax, [rdx]
                jnb     short locret_14028EC3E
                xchg    ax, ax

loc_14028EC20:                          ; CODE XREF: KeCopyAffinityEx+3C↓j
                movzx   ecx, ax
                inc     ax
                lea     rdx, ds:0[rcx*8]
                mov     rcx, [rdx+r8+8]
                mov     [rdx+r9+8], rcx
                cmp     ax, [r8]
                jb      short loc_14028EC20

locret_14028EC3E:                       ; CODE XREF: KeCopyAffinityEx+1C↑j
                retn
KeCopyAffinityEx endp

; ---------------------------------------------------------------------------
                align 20h
byte_14028EC40  db 10h dup(0CCh)        ; DATA XREF: .pdata:00000001400CEF1C↑o
; Exported entry 1293. KeRemoveProcessorAffinityEx

; =============== S U B R O U T I N E =======================================


                public KeRemoveProcessorAffinityEx
KeRemoveProcessorAffinityEx proc near   ; CODE XREF: sub_14024EFB0+402↑p
                                        ; sub_140254310+1A12↑p ...
                mov     eax, edx
                mov     r8, rcx
                lea     rcx, dword_140D010D0
                mov     ecx, [rcx+rax*4]
                mov     eax, ecx
                movzx   edx, word ptr [r8]
                shr     eax, 6
                cmp     edx, eax
                jbe     short locret_14028EC7F
                mov     edx, eax
                and     ecx, 3Fh
                mov     rax, [r8+rax*8+8]
                btr     rax, rcx
                mov     [r8+rdx*8+8], rax

locret_14028EC7F:                       ; CODE XREF: KeRemoveProcessorAffinityEx+1A↑j
                retn
KeRemoveProcessorAffinityEx endp

; ---------------------------------------------------------------------------
                db 0CCh
algn_14028EC81:                         ; DATA XREF: .pdata:00000001400CEF28↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14028EC90   proc near               ; CODE XREF: std::time_get<wchar_t,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>>>::_Getint(std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,int,int,int &)+75↓p
                                        ; sub_140389BD8+55↓p ...
                cmp     edx, 1
                jnz     short loc_14028ECBE
                mov     rax, 7FFFFFFEFFFFh
                cmp     rcx, rax
                ja      short loc_14028ECBE
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     qword ptr [rcx+3E0h], 0
                jnz     short loc_14028ECC2

loc_14028ECBE:                          ; CODE XREF: sub_14028EC90+3↑j
                                        ; sub_14028EC90+12↑j
                xor     al, al
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14028ECC2:                          ; CODE XREF: sub_14028EC90+2C↑j
                mov     al, 1
                retn
sub_14028EC90   endp

; ---------------------------------------------------------------------------
                align 2
algn_14028ECC6:                         ; DATA XREF: .pdata:00000001400CEF34↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_14028ECD0   proc near               ; CODE XREF: sub_1402E35C8+C3↓p
                                        ; sub_14031FEB0+1B7↓p ...

var_18          = qword ptr -18h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_20          = qword ptr  28h
arg_28          = qword ptr  30h
arg_30          = qword ptr  38h

; FUNCTION CHUNK AT 0000000140445FDC SIZE 00000028 BYTES

                mov     [rsp+arg_0], rbx
                mov     [rsp+arg_8], rsi
                push    rdi
                sub     rsp, 30h
                mov     rsi, r9
                mov     r11, r8
                mov     ebx, edx
                mov     rdi, rcx
                test    edx, edx
                jnz     short loc_14028ED1F
                mov     rdx, r8
                call    sub_140243A00
                test    eax, eax
                jnz     short loc_14028ED2A

loc_14028ECFA:                          ; CODE XREF: sub_14028ECD0+58↓j
                mov     rax, [rsp+38h+arg_28]
                test    rax, rax
                jz      short loc_14028ED0E
                mov     rcx, [rsp+38h+arg_30]
                call    sub_1404079D0

loc_14028ED0E:                          ; CODE XREF: sub_14028ECD0+32↑j
                                        ; sub_14028ECD0+92↓j
                mov     rbx, [rsp+38h+arg_0]
                mov     rsi, [rsp+38h+arg_8]
                add     rsp, 30h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028ED1F:                          ; CODE XREF: sub_14028ECD0+1C↑j
                mov     eax, cs:dword_140CFC404
                cmp     eax, 1
                jbe     short loc_14028ECFA

loc_14028ED2A:                          ; CODE XREF: sub_14028ECD0+28↑j
                mov     rax, [rsp+38h+arg_20]
                mov     r9, rsi
                mov     r8, r11
                mov     [rsp+38h+var_18], rax
                mov     edx, ebx
                mov     rcx, rdi
                call    sub_14024EFB0
                mov     rax, [rsp+38h+arg_28]
                test    rax, rax
                jz      short loc_14028ED58
                mov     rcx, [rsp+38h+arg_30]
                call    sub_1404079D0

loc_14028ED58:                          ; CODE XREF: sub_14028ECD0+7C↑j
                mov     eax, [rdi+2D80h]
                xor     ebx, ebx
                test    eax, eax
                jz      short loc_14028ED0E
                nop     dword ptr [rax+00h]
                nop     dword ptr [rax+rax+00000000h]

loc_14028ED70:                          ; CODE XREF: sub_14028ECD0+B8↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jz      loc_140445FDC

loc_14028ED7E:                          ; CODE XREF: sub_14028ECD0+1B7314↓j
                                        ; sub_14028ECD0+1B7321↓j
                pause

loc_14028ED80:                          ; CODE XREF: sub_14028ECD0+1B732F↓j
                mov     eax, [rdi+2D80h]
                test    eax, eax
                jnz     short loc_14028ED70
                mov     rbx, [rsp+38h+arg_0]
                mov     rsi, [rsp+38h+arg_8]
                add     rsp, 30h
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_14028ECD0   endp

byte_14028ED9B  db 15h dup(0CCh)        ; DATA XREF: .rdata:000000014005F56C↑o
                                        ; .pdata:00000001400CEF40↑o

; =============== S U B R O U T I N E =======================================


sub_14028EDB0   proc near               ; CODE XREF: sub_140223F80+BE↑p
                                        ; sub_14025BAF0+18D↑p ...

; FUNCTION CHUNK AT 0000000140446004 SIZE 0000000C BYTES

                push    rbx
                sub     rsp, 20h
                mov     rbx, rcx
                mov     ecx, [rcx+0Ch]
                test    ecx, ecx
                jnz     short loc_14028EDC7

loc_14028EDC0:                          ; CODE XREF: sub_14028EDB0+9B↓j
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028EDC7:                          ; CODE XREF: sub_14028EDB0+E↑j
                movzx   r8d, byte ptr [rbx+4]
                mov     r10, cs:qword_140C4DE10
                test    r8b, 2
                jnz     short loc_14028EE10
                mov     eax, [rbx]
                cmp     eax, 1
                jnz     loc_14028EE66
                mov     rax, gs:188h
                mov     rdx, [rax+0B8h]
                cmp     qword ptr [rdx+8F0h], 0
                jnz     loc_140446004
                cmp     qword ptr [rdx+3E0h], 0
                jnz     loc_140446004

loc_14028EE10:                          ; CODE XREF: sub_14028EDB0+27↑j
                                        ; sub_14028EDB0+1B725B↓j
                mov     eax, [rbx]
                cmp     eax, 1
                jnz     short loc_14028EE66
                xor     r9d, r9d

loc_14028EE1A:                          ; CODE XREF: sub_14028EDB0+C7↓j
                cmp     byte ptr [rbx+5], 0
                jnz     short loc_14028EE50
                cmp     [rbx+10h], r10
                ja      short loc_14028EE50
                test    r8b, 1
                lea     rdx, [rbx+18h]
                mov     r8d, eax
                jnz     short loc_14028EE84
                call    sub_14028EEC0

loc_14028EE38:                          ; CODE XREF: sub_14028EDB0+B4↓j
                                        ; sub_14028EDB0+D2↓j ...
                and     byte ptr [rbx+4], 0F7h
                mov     dword ptr [rbx+0Ch], 0
                mov     qword ptr [rbx+10h], 0
                jmp     loc_14028EDC0
; ---------------------------------------------------------------------------

loc_14028EE50:                          ; CODE XREF: sub_14028EDB0+6E↑j
                                        ; sub_14028EDB0+74↑j
                mov     ecx, eax
                test    r8b, 1
                jnz     short loc_14028EE79
                mov     edx, r9d
                call    sub_14031FD30
                mov     byte ptr [rbx+5], 0
                jmp     short loc_14028EE38
; ---------------------------------------------------------------------------

loc_14028EE66:                          ; CODE XREF: sub_14028EDB0+2E↑j
                                        ; sub_14028EDB0+65↑j
                test    r8b, 8
                mov     r9d, 0
                setnz   r9b
                inc     r9d
                jmp     short loc_14028EE1A
; ---------------------------------------------------------------------------

loc_14028EE79:                          ; CODE XREF: sub_14028EDB0+A6↑j
                call    sub_1403B7418
                mov     byte ptr [rbx+5], 0
                jmp     short loc_14028EE38
; ---------------------------------------------------------------------------

loc_14028EE84:                          ; CODE XREF: sub_14028EDB0+81↑j
                call    sub_1403C914C
                jmp     short loc_14028EE38
sub_14028EDB0   endp

; ---------------------------------------------------------------------------
algn_14028EE8B:                         ; DATA XREF: .rdata:000000014005F588↑o
                                        ; .pdata:00000001400CEF4C↑o
                align 20h
; Exported entry 843. IoGetCurrentProcess
; Exported entry 1804. PsGetCurrentProcess

; =============== S U B R O U T I N E =======================================


                public PsGetCurrentProcess
PsGetCurrentProcess proc near           ; CODE XREF: sub_1402834D0:loc_140283AE3↑p
                                        ; sub_1402834D0:loc_140283BB6↑p ...
                mov     rax, gs:188h    ; IoGetCurrentProcess
                mov     rax, [rax+0B8h]
                retn
PsGetCurrentProcess endp

; ---------------------------------------------------------------------------
                align 2
algn_14028EEB2:                         ; DATA XREF: .pdata:00000001400CEF58↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028EEC0   proc near               ; CODE XREF: sub_14028EDB0+83↑p
                                        ; sub_14031FBD0+EA↓p
                                        ; DATA XREF: ...

var_98          = dword ptr -98h
var_78          = qword ptr -78h
var_70          = dword ptr -70h
var_68          = qword ptr -68h
var_58          = byte ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_0           = qword ptr  8
arg_8           = byte ptr  10h
arg_10          = byte ptr  18h

; FUNCTION CHUNK AT 0000000140446010 SIZE 0000021A BYTES

                mov     r11, rsp
                push    rbx
                push    rbp
                push    r12
                push    r13
                push    r15
                sub     rsp, 70h
                xor     ebx, ebx

loc_14028EED1:                          ; DATA XREF: .rdata:000000014005F5B4↑o
                                        ; .rdata:000000014005F5C8↑o ...
                mov     [r11+8], rsi
                mov     [r11-30h], rdi
                lea     rax, [r11+18h]
                mov     ebp, r8d
                mov     [r11-38h], r14
                mov     r14d, r9d
                mov     r12d, ecx
                mov     r15, rdx
                mov     [r11-50h], rbx
                mov     r8d, r14d
                mov     [r11+10h], bl
                lea     r9, [r11+10h]
                mov     [rsp+98h+var_58], bl
                mov     edx, ebp
                mov     [r11+18h], bl
                xor     ecx, ecx
                mov     [r11-78h], rax
                xor     dil, dil
                call    sub_14028F220
                test    al, al
                jnz     loc_140446010
                lea     r13, [rbx-1]

loc_14028EF20:                          ; CODE XREF: sub_14028EEC0+1B71EE↓j
                mov     rax, [r15]
                cmp     ebp, 1
                jnz     short loc_14028EF54
                mov     rcx, 7FFFFFFEFFFFh
                cmp     rax, rcx
                ja      short loc_14028EF54
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                cmp     [rcx+3E0h], rbx
                jnz     loc_1404460B3

loc_14028EF54:                          ; CODE XREF: sub_14028EEC0+66↑j
                                        ; sub_14028EEC0+75↑j
                movzx   r10d, [rsp+98h+arg_8]
                xor     r11b, r11b
                test    r10b, r10b
                jnz     loc_14028F1C2

loc_14028EF69:                          ; CODE XREF: sub_14028EEC0+344↓j
                test    dil, dil
                jnz     loc_14028F209
                mov     [rsp+98h+var_48], r15
                mov     [rsp+98h+var_40], r12d
                mov     [rsp+98h+var_3C], ebp
                mov     rsi, cr8
                mov     eax, 0Ch
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_14028F02F

loc_14028EF9B:                          ; CODE XREF: sub_14028EEC0+171↓j
                                        ; sub_14028EEC0+17B↓j ...
                mov     rdi, gs:20h
                test    r14d, r14d
                jz      loc_14028F073
                mov     eax, cs:dword_140CFC404
                mov     r10d, 1
                mov     r8, rbx
                cmp     eax, r10d
                jbe     loc_14028F146

loc_14028EFC5:                          ; CODE XREF: sub_14028EEC0+2EA↓j
                                        ; sub_14028EEC0+2F7↓j
                mov     ecx, 4
                lea     r9, [rsp+98h+var_48]
                cmp     r14d, 1
                mov     eax, 80000004h
                mov     edx, r10d
                cmovnz  eax, ecx
                mov     rcx, rdi
                mov     [rsp+98h+var_78], rax
                call    sub_14024EFB0
                lea     rcx, [rsp+98h+var_48]
                call    sub_140323D30
                mov     eax, [rdi+2D80h]
                test    eax, eax
                jz      loc_14028F150
                nop     dword ptr [rax+00h]
                nop     word ptr [rax+rax+00000000h]

loc_14028F010:                          ; CODE XREF: sub_14028EEC0+168↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jz      loc_1404460C4

loc_14028F01E:                          ; CODE XREF: sub_14028EEC0+1B720C↓j
                                        ; sub_14028EEC0+1B7219↓j
                pause

loc_14028F020:                          ; CODE XREF: sub_14028EEC0+1B7227↓j
                mov     eax, [rdi+2D80h]
                test    eax, eax
                jnz     short loc_14028F010
                jmp     loc_14028F150
; ---------------------------------------------------------------------------

loc_14028F02F:                          ; CODE XREF: sub_14028EEC0+D5↑j
                test    al, 1
                jz      loc_14028EF9B
                cmp     sil, 0Fh
                ja      loc_14028EF9B
                mov     rax, gs:20h
                mov     rdx, r13
                movzx   ecx, sil
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 1FFCh
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d
                jmp     loc_14028EF9B
; ---------------------------------------------------------------------------

loc_14028F073:                          ; CODE XREF: sub_14028EEC0+E7↑j
                lock or [rsp+98h+var_98], ebx
                mov     rax, [rdi+8]
                lea     r8, [rdi+2DB8h]
                movzx   edx, bx
                mov     r9, [rax+0B8h]
                movzx   ecx, word ptr [r9+170h]
                mov     [r8], cx
                movzx   eax, word ptr [r9+172h]
                mov     [r8+2], ax
                mov     [r8+4], ebx
                cmp     bx, [r9+170h]
                jnb     short loc_14028F0E9
                nop     dword ptr [rax+00h]
                nop     word ptr [rax+rax+00000000h]

loc_14028F0C0:                          ; CODE XREF: sub_14028EEC0+223↓j
                movzx   eax, dx
                inc     dx
                lea     rcx, ds:0[rax*8]
                mov     rax, [rcx+r9+178h]
                mov     [rcx+r8+8], rax
                cmp     dx, [r9+170h]
                jb      short loc_14028F0C0
                movzx   ecx, word ptr [r8]

loc_14028F0E9:                          ; CODE XREF: sub_14028EEC0+1F1↑j
                movzx   edx, cx
                lea     rax, dword_140D010D0
                mov     ecx, [rdi+24h]
                mov     r9d, [rax+rcx*4]
                mov     eax, r9d
                shr     eax, 6
                and     r9d, 3Fh
                cmp     edx, eax
                jbe     short loc_14028F120
                mov     rcx, [r8+rax*8+8]
                lea     rdx, [r8+rax*8]
                mov     eax, r9d
                btr     rcx, rax
                mov     [rdx+8], rcx
                movzx   edx, word ptr [r8]

loc_14028F120:                          ; CODE XREF: sub_14028EEC0+246↑j
                mov     r10d, ebx
                movzx   eax, bx
                cmp     bx, dx
                jnb     short loc_14028F146
                nop     dword ptr [rax+rax+00h]

loc_14028F130:                          ; CODE XREF: sub_14028EEC0+284↓j
                movzx   ecx, ax
                mov     rdx, [r8+rcx*8+8]
                test    rdx, rdx
                jnz     short loc_14028F1A0

loc_14028F13D:                          ; CODE XREF: sub_14028EEC0+2FD↓j
                inc     ax
                cmp     ax, [r8]
                jb      short loc_14028F130

loc_14028F146:                          ; CODE XREF: sub_14028EEC0+FF↑j
                                        ; sub_14028EEC0+269↑j
                lea     rcx, [rsp+98h+var_48]
                call    sub_140323D30

loc_14028F150:                          ; CODE XREF: sub_14028EEC0+13D↑j
                                        ; sub_14028EEC0+16A↑j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     loc_1404460EC

loc_14028F15E:                          ; CODE XREF: sub_14028EEC0+1B722E↓j
                                        ; sub_14028EEC0+1B723A↓j ...
                movzx   eax, sil
                mov     cr8, rax

loc_14028F166:                          ; CODE XREF: sub_14028EEC0+34C↓j
                                        ; sub_14028EEC0+1B729A↓j
                cmp     cs:byte_140CFB002, 0
                mov     r14, [rsp+98h+var_38]
                mov     rdi, [rsp+98h+var_30]
                mov     rsi, [rsp+98h+arg_0]
                jnz     loc_14044615F

loc_14028F185:                          ; CODE XREF: sub_14028EEC0+1B72AE↓j
                                        ; DATA XREF: .pdata:00000001400CEF70↑o ...
                cmp     cs:dword_140CF4D10, 0
                jnz     loc_140446173

loc_14028F192:                          ; CODE XREF: sub_14028EEC0+1B7365↓j
                add     rsp, 70h
                pop     r15
                pop     r13
                pop     r12
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 20h

loc_14028F1A0:                          ; CODE XREF: sub_14028EEC0+27B↑j
                                        ; DATA XREF: .pdata:00000001400CEF7C↑o ...
                movzx   ecx, byte ptr [rdi+0D0h]
                cmp     ax, cx
                jnz     loc_14028EFC5
                cmp     rdx, [rdi+0C8h]
                jnz     loc_14028EFC5
                jmp     loc_14028F13D
; ---------------------------------------------------------------------------

loc_14028F1C2:                          ; CODE XREF: sub_14028EEC0+A3↑j
                                        ; sub_14028EEC0+1B71FF↓j
                lea     r8, [rsp+98h+var_58]
                mov     ecx, ebp
                lea     rdx, [rsp+98h+var_50]
                call    sub_140390CAC
                mov     ecx, r14d
                call    sub_140390CE4
                movzx   r8d, [rsp+98h+var_58]
                mov     rdx, rax
                mov     rcx, [rsp+98h+var_50]
                movzx   r9d, r11b
                mov     [rsp+98h+var_68], r15
                mov     [rsp+98h+var_70], r12d
                mov     byte ptr [rsp+98h+var_78], r10b
                call    sub_14038FEDC
                or      dil, al
                jmp     loc_14028EF69
; ---------------------------------------------------------------------------

loc_14028F209:                          ; CODE XREF: sub_14028EEC0+AC↑j
                cmp     ebp, 4
                jnz     loc_14028F166
                jmp     loc_140446152
sub_14028EEC0   endp

; ---------------------------------------------------------------------------
algn_14028F217:                         ; DATA XREF: .pdata:00000001400CEF88↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_14028F220   proc near               ; CODE XREF: sub_14028EEC0+4F↑p
                                        ; std::time_get<wchar_t,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>>>::_Getint(std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,std::istreambuf_iterator<wchar_t,std::char_traits<wchar_t>> &,int,int,int &)+55↓p ...

var_28          = dword ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_20          = qword ptr  28h

; FUNCTION CHUNK AT 000000014044622A SIZE 00000073 BYTES

                push    rbx
                sub     rsp, 20h
                mov     eax, cs:dword_140CFC41C
                mov     rbx, r9
                test    al, 4
                jnz     short loc_14028F240

loc_14028F233:                          ; CODE XREF: sub_14028F220+43↓j
                mov     byte ptr [r9], 0
                xor     al, al

loc_14028F239:                          ; CODE XREF: sub_14028F220+A8↓j
                                        ; sub_14028F220+12E↓j
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 20h

loc_14028F240:                          ; CODE XREF: sub_14028F220+11↑j
                test    al, 2
                jnz     loc_14028F317
                test    cl, cl
                jz      loc_14028F306
                bt      eax, 17h
                jb      loc_14044622A

loc_14028F25A:                          ; CODE XREF: sub_14028F220+F1↓j
                                        ; sub_14028F220+1B7013↓j
                mov     eax, cs:dword_140CFC404
                cmp     eax, 1
                jz      short loc_14028F233
                test    r8d, r8d
                jnz     loc_14028F317

loc_14028F26E:                          ; DATA XREF: .rdata:000000014005F630↑o
                                        ; .rdata:000000014005F644↑o ...
                mov     [rsp+28h+arg_8], rdi
                lock or [rsp+28h+var_28], r8d
                mov     r10, cr8
                mov     eax, 0Ch
                mov     cr8, rax
                lea     rdi, [rax-0Dh]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jnz     short loc_14028F2CD

loc_14028F293:                          ; CODE XREF: sub_14028F220+AF↓j
                                        ; sub_14028F220+B5↓j ...
                mov     rcx, gs:20h
                mov     r11, [rsp+28h+arg_20]
                mov     rax, [rcx+8]
                mov     [r11], r10b
                mov     rdx, [rax+0B8h]
                add     rdx, 170h
                call    sub_140243A00
                test    eax, eax
                jnz     short loc_14028F324
                mov     rdi, [rsp+28h+arg_8]
                mov     [rbx], al
                mov     al, 1
                jmp     loc_14028F239
; ---------------------------------------------------------------------------

loc_14028F2CD:                          ; CODE XREF: sub_14028F220+71↑j
                                        ; DATA XREF: .pdata:00000001400CEFA0↑o ...
                test    al, 1
                jz      short loc_14028F293
                cmp     r10b, 0Fh
                ja      short loc_14028F293
                mov     rax, gs:20h
                mov     rdx, rdi
                movzx   ecx, r10b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 1FFCh
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d
                jmp     short loc_14028F293
; ---------------------------------------------------------------------------

loc_14028F306:                          ; CODE XREF: sub_14028F220+2A↑j
                                        ; DATA XREF: .pdata:00000001400CEFAC↑o ...
                movzx   eax, cs:byte_140CFC409
                and     al, 3
                cmp     al, 1
                jnz     loc_14028F25A

loc_14028F317:                          ; CODE XREF: sub_14028F220+22↑j
                                        ; sub_14028F220+48↑j ...
                mov     byte ptr [r9], 1
                xor     al, al
                add     rsp, 20h
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 4

loc_14028F324:                          ; CODE XREF: sub_14028F220+9D↑j
                                        ; DATA XREF: .pdata:00000001400CEFB8↑o ...
                mov     eax, cs:dword_140CFC660
                mov     [rsp+28h+arg_0], rsi
                movzx   esi, byte ptr [r11]
                test    eax, eax
                jnz     loc_14044623E

loc_14028F33B:                          ; CODE XREF: sub_14028F220+1B7020↓j
                                        ; sub_14028F220+1B702C↓j ...
                mov     cr8, rsi
                mov     rsi, [rsp+28h+arg_0]
                xor     al, al
                mov     rdi, [rsp+28h+arg_8]
                mov     byte ptr [rbx], 1
                jmp     loc_14028F239
sub_14028F220   endp

; ---------------------------------------------------------------------------
algn_14028F353:                         ; DATA XREF: .pdata:00000001400CEFC4↑o
                align 20h

; =============== S U B R O U T I N E =======================================

; Attributes: bp-based frame fpd=4Fh

sub_14028F360   proc near               ; CODE XREF: sub_140286D90+3B7↑p
                                        ; sub_140286D90+43A↑p ...

var_B0          = dword ptr -0B0h
var_A8          = qword ptr -0A8h
var_A0          = dword ptr -0A0h
var_9C          = dword ptr -9Ch
var_98          = dword ptr -98h
var_90          = qword ptr -90h
var_88          = dword ptr -88h
var_84          = dword ptr -84h
var_80          = dword ptr -80h
var_7C          = dword ptr -7Ch
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = qword ptr -48h
var_40          = qword ptr -40h
var_30          = qword ptr -30h
arg_0           = qword ptr  10h
arg_8           = qword ptr  18h
arg_10          = qword ptr  20h
arg_18          = qword ptr  28h
arg_20          = dword ptr  30h

                mov     [rsp-8+arg_18], r9
                mov     [rsp-8+arg_8], rdx
                mov     [rsp-8+arg_0], rcx
                push    rbp
                push    rbx
                push    rsi
                push    rdi
                push    r13
                push    r14
                lea     rbp, [rsp-27h]
                sub     rsp, 0A8h
                mov     eax, [rcx+0Ch]
                xor     r11d, r11d
                mov     rdi, r9
                mov     rsi, r8
                mov     r13d, r11d
                mov     [rbp+4Fh+var_A0], r11d
                mov     r14d, r11d
                mov     [rbp+4Fh+var_9C], r11d
                mov     [rbp+4Fh+var_B0], r11d
                mov     [rbp+4Fh+var_58], 0FFFFFFFFFFFFFFFFh
                mov     [rbp+4Fh+var_98], eax
                cmp     [rbp+4Fh+arg_20], r11d
                jz      short loc_14028F3C1
                call    sub_14028EDB0
                mov     rcx, [rbp+4Fh+arg_0]
                xor     r11d, r11d
                mov     eax, [rbp+4Fh+var_98]

loc_14028F3C1:                          ; CODE XREF: sub_14028F360+50↑j
                cmp     [rdi+20h], r13
                jnz     loc_14028FC17
                cmp     [rdi+28h], r13
                jnz     loc_14028FC17

loc_14028F3D5:                          ; DATA XREF: .rdata:000000014005F6C8↑o
                                        ; .rdata:000000014005F6DC↑o ...
                mov     [rsp+0D0h+arg_10], r12
                mov     rdi, r11
                mov     [rsp+0D0h+var_30], r15
                mov     [rbp+4Fh+arg_20], r11d
                test    eax, eax
                jz      loc_14028FBF3
                mov     rax, r11
                mov     r9, 0FFFFF68000000000h
                mov     [rbp+4Fh+var_40], rax
                mov     rbx, 8000000000000000h
                mov     r12, 0FFFFF6FB7DBED000h
                mov     r10, 0FFFFF6FB7DBED7F8h
                jmp     short loc_14028F428
; ---------------------------------------------------------------------------

loc_14028F425:                          ; CODE XREF: sub_14028F360+7E7↓j
                xor     r11d, r11d

loc_14028F428:                          ; CODE XREF: sub_14028F360+C3↑j
                mov     rax, [rcx+rax*8+18h]
                mov     rdx, rax
                and     edx, 3FFh
                inc     rdx
                and     rax, 0FFFFFFFFFFFFF000h
                mov     [rbp+4Fh+var_48], rdx
                mov     [rbp+4Fh+var_50], rax
                jmp     short loc_14028F453
; ---------------------------------------------------------------------------
                align 10h

loc_14028F450:                          ; CODE XREF: sub_14028F360+7C7↓j
                xor     r11d, r11d

loc_14028F453:                          ; CODE XREF: sub_14028F360+E7↑j
                mov     rcx, rax
                mov     rax, 7FFFFFFFF8h
                shr     rcx, 9
                and     rcx, rax
                mov     rax, r9
                mov     r8, [rcx+rax]
                lea     r9, [rcx+rax]
                mov     [rbp+4Fh+var_68], r9
                mov     rax, r12
                cmp     r9, rax
                jb      short loc_14028F4E9
                mov     rax, r10
                cmp     r9, rax
                ja      short loc_14028F4E9
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028F4E9
                test    r8b, 1
                jz      short loc_14028F4E9
                test    r8b, 20h
                jz      short loc_14028F4A1
                test    r8b, 42h
                jnz     short loc_14028F4E9

loc_14028F4A1:                          ; CODE XREF: sub_14028F360+139↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jz      short loc_14028F4E9
                mov     rax, r9
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                mov     rdx, r8
                or      rdx, 20h
                movzx   ecx, al
                and     cl, 20h
                cmovz   rdx, r8
                mov     r8, rdx
                test    al, 42h
                jz      short loc_14028F4E9
                or      r8, 42h

loc_14028F4E9:                          ; CODE XREF: sub_14028F360+11C↑j
                                        ; sub_14028F360+124↑j ...
                or      r8, 1
                btr     r8, 0Ah
                mov     [rbp+4Fh+var_A8], r8
                mov     rax, r12
                lea     rcx, [rbp+4Fh+var_A8]
                cmp     rcx, rax
                jb      short loc_14028F566
                mov     rax, r10
                lea     rcx, [rbp+4Fh+var_A8]
                cmp     rcx, rax
                ja      short loc_14028F566
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028F566
                test    r8b, 20h
                jz      short loc_14028F523
                test    r8b, 42h
                jnz     short loc_14028F566

loc_14028F523:                          ; CODE XREF: sub_14028F360+1BB↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                mov     rdx, [rcx+788h]
                test    rdx, rdx
                jnz     short loc_14028F545
                mov     r8, [rbp+4Fh+var_A8]
                jmp     short loc_14028F566
; ---------------------------------------------------------------------------

loc_14028F545:                          ; CODE XREF: sub_14028F360+1DD↑j
                lea     rax, [rbp+4Fh+var_A8]
                shr     rax, 3
                and     eax, 1FFh
                mov     rax, [rdx+rax*8]
                test    al, 20h
                jz      short loc_14028F55E
                or      r8, 20h

loc_14028F55E:                          ; CODE XREF: sub_14028F360+1F8↑j
                test    al, 42h
                jz      short loc_14028F566
                or      r8, 42h

loc_14028F566:                          ; CODE XREF: sub_14028F360+1A0↑j
                                        ; sub_14028F360+1AC↑j ...
                shr     r8, 0Ch
                mov     r10, 0FFFFFFFFFh
                and     r8, r10
                mov     rax, 0FFFFFA8000000000h
                lea     r12, [r8+r8*2]
                shl     r12, 4
                mov     rax, rax
                mov     rdx, [r12+rax+28h]
                lea     r14, [r12+rax]
                mov     rax, cs:qword_140C4E4C8
                mov     rcx, rdx
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     r15, [rax+rcx*8]
                mov     rcx, r14
                mov     [rbp+4Fh+var_70], r15
                call    sub_1403F41D8
                test    eax, eax
                jz      loc_14028F6B7
                mov     rax, [r14+8]
                mov     rcx, 1000000000h
                mov     r15, rax
                or      r15, rbx
                test    rcx, rdx
                jnz     short loc_14028F5E6
                test    rax, rax
                js      short loc_14028F5E6
                jz      short loc_14028F5E6
                mov     r12b, 1
                jmp     short loc_14028F5E9
; ---------------------------------------------------------------------------

loc_14028F5E6:                          ; CODE XREF: sub_14028F360+278↑j
                                        ; sub_14028F360+27D↑j ...
                xor     r12b, r12b

loc_14028F5E9:                          ; CODE XREF: sub_14028F360+284↑j
                mov     rcx, r9
                call    sub_1402C78A0
                mov     [rbp+4Fh+var_88], r11d
                mov     rbx, r11
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                mov     [rbp+4Fh+var_60], rax
                jnb     short loc_14028F620

loc_14028F605:                          ; CODE XREF: sub_14028F360+2B5↓j
                                        ; sub_14028F360+2BE↓j
                lea     rcx, [rbp+4Fh+var_88]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_14028F605
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_14028F605

loc_14028F620:                          ; CODE XREF: sub_14028F360+2A3↑j
                test    byte ptr [rbp+4Fh+var_A8], 42h
                jz      short loc_14028F631
                mov     rcx, r14
                call    sub_1402A6940
                mov     rbx, rax

loc_14028F631:                          ; CODE XREF: sub_14028F360+2C4↑j
                mov     rcx, r14
                call    sub_1402C5FA0
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], rax
                test    rbx, rbx
                jz      short loc_14028F65F
                mov     rcx, [rbp+4Fh+var_70]
                mov     r8d, 1
                mov     rdx, rbx
                call    sub_14020B2C0

loc_14028F65F:                          ; CODE XREF: sub_14028F360+2EB↑j
                mov     rcx, [rbp+4Fh+arg_8]
                mov     rdx, r15
                cmp     r12b, 1
                jnz     short loc_14028F67A
                add     rcx, 680h
                call    sub_140366EF4
                jmp     short loc_14028F68B
; ---------------------------------------------------------------------------

loc_14028F67A:                          ; CODE XREF: sub_14028F360+30A↑j
                call    sub_1402C6E74
                mov     r8, [rbp+4Fh+arg_8]
                mov     rcx, rax
                call    sub_14055A088

loc_14028F68B:                          ; CODE XREF: sub_14028F360+318↑j
                cmp     eax, 3
                jnz     short loc_14028F6A1
                mov     rax, [rbp+4Fh+arg_18]
                mov     [rbp+4Fh+var_A8], rsi
                inc     qword ptr [rax+8]
                jmp     loc_14028F9AF
; ---------------------------------------------------------------------------

loc_14028F6A1:                          ; CODE XREF: sub_14028F360+32E↑j
                cmp     eax, 5
                jnz     short loc_14028F6AE
                mov     rax, [rbp+4Fh+arg_18]
                inc     qword ptr [rax+10h]

loc_14028F6AE:                          ; CODE XREF: sub_14028F360+344↑j
                mov     [rbp+4Fh+var_A8], rsi
                jmp     loc_14028F9AF
; ---------------------------------------------------------------------------

loc_14028F6B7:                          ; CODE XREF: sub_14028F360+25B↑j
                and     rdx, r10
                mov     [rbp+4Fh+var_84], r11d
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                mov     [rbp+4Fh+var_60], rdx
                jnb     short loc_14028F6EB
                nop     dword ptr [rax+rax+00h]

loc_14028F6D0:                          ; CODE XREF: sub_14028F360+380↓j
                                        ; sub_14028F360+389↓j
                lea     rcx, [rbp+4Fh+var_84]
                call    sub_1402C8C70
                mov     rax, [r14+18h]
                test    rax, rax
                js      short loc_14028F6D0
                lock bts qword ptr [r14+18h], 3Fh ; '?'
                jb      short loc_14028F6D0

loc_14028F6EB:                          ; CODE XREF: sub_14028F360+369↑j
                mov     r9, [r14+10h]
                mov     rax, 4000000000000000h
                or      [r14+18h], rax
                movzx   eax, r9b
                shr     al, 1
                test    al, 1
                jz      short loc_14028F72F
                lea     rdx, [r14+10h]
                mov     rcx, r15
                call    sub_140340134
                test    eax, eax
                jnz     short loc_14028F72F
                cmp     word ptr [r14+20h], 1
                jnz     short loc_14028F72F
                test    rsi, rsi
                jz      short loc_14028F72F
                mov     rdi, r9
                and     r9, 0FFFFFFFFFFFFFFFDh
                mov     [r14+10h], r9

loc_14028F72F:                          ; CODE XREF: sub_14028F360+3A5↑j
                                        ; sub_14028F360+3B5↑j ...
                movzx   eax, byte ptr [r14+22h]
                and     al, 7
                cmp     al, 6
                jnz     loc_14028FC33
                mov     rax, [r14+18h]
                mov     r8, 3FFFFFFFFFFFFFFFh
                mov     rcx, rax
                and     rcx, r8
                dec     rcx
                mov     rdx, rcx
                xor     rdx, rax
                and     rdx, r8
                xor     rdx, rax
                mov     [r14+18h], rdx
                test    rcx, rcx
                jnz     loc_14028F8E0
                mov     rcx, r14
                call    sub_1403F41D8
                test    eax, eax
                jz      short loc_14028F783
                call    sub_14055C968
                mov     rdx, [r14+18h]

loc_14028F783:                          ; CODE XREF: sub_14028F360+418↑j
                shr     rdx, 3Eh
                mov     eax, 0FFFFh
                add     [r14+20h], ax
                and     edx, 1
                cmp     word ptr [r14+20h], 0
                jz      short loc_14028F800
                movzx   eax, byte ptr [r14+22h]
                test    edx, edx
                jz      short loc_14028F7A9
                or      al, 7
                jmp     short loc_14028F7B7
; ---------------------------------------------------------------------------

loc_14028F7A9:                          ; CODE XREF: sub_14028F360+443↑j
                test    al, 10h
                jz      short loc_14028F7B3
                and     al, 0FBh
                or      al, 3
                jmp     short loc_14028F7B7
; ---------------------------------------------------------------------------

loc_14028F7B3:                          ; CODE XREF: sub_14028F360+44B↑j
                and     al, 0FAh
                or      al, 2

loc_14028F7B7:                          ; CODE XREF: sub_14028F360+447↑j
                                        ; sub_14028F360+451↑j
                mov     [r14+22h], al
                mov     eax, [r14+10h]
                bt      rax, 0Ah
                jb      short loc_14028F7F3
                lea     rcx, [r14+10h]
                call    sub_1402DF6E4
                test    eax, eax
                jz      short loc_14028F7F3
                mov     rcx, [r14+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     rcx, [rax+rcx*8]
                mov     byte ptr [rcx+2A3h], 1

loc_14028F7F3:                          ; CODE XREF: sub_14028F360+464↑j
                                        ; sub_14028F360+471↑j
                mov     rax, [rbp+4Fh+arg_18]
                inc     qword ptr [rax+8]
                jmp     loc_14028F8E0
; ---------------------------------------------------------------------------

loc_14028F800:                          ; CODE XREF: sub_14028F360+43A↑j
                test    edx, edx
                jz      loc_14028F8AD
                movzx   eax, byte ptr [r14+23h]
                test    al, 10h
                jz      short loc_14028F817
                and     al, 0EFh
                mov     [r14+23h], al

loc_14028F817:                          ; CODE XREF: sub_14028F360+4AF↑j
                mov     rcx, [r14+28h]
                mov     rax, cs:qword_140C4E4C8
                shr     rcx, 27h
                and     ecx, 3FFh
                mov     r15, [rax+rcx*8]
                mov     rcx, [r14+10h]
                mov     [rbp+4Fh+var_78], rcx
                bt      rcx, 0Ah
                jb      short loc_14028F87F
                movzx   eax, cl
                shr     al, 2
                test    al, 1
                jz      short loc_14028F854
                lea     rcx, [rbp+4Fh+var_78]
                call    sub_1402805F0
                jmp     short loc_14028F868
; ---------------------------------------------------------------------------

loc_14028F854:                          ; CODE XREF: sub_14028F360+4E7↑j
                shr     cl, 1
                test    cl, 1
                jz      short loc_14028F866
                lea     rcx, [rbp+4Fh+var_78]
                call    sub_1402805F0
                jmp     short loc_14028F868
; ---------------------------------------------------------------------------

loc_14028F866:                          ; CODE XREF: sub_14028F360+4F9↑j
                xor     eax, eax

loc_14028F868:                          ; CODE XREF: sub_14028F360+4F2↑j
                                        ; sub_14028F360+504↑j
                mov     [rbp+4Fh+var_78], rax
                test    rax, rax
                jz      short loc_14028F87F
                xor     r8d, r8d
                mov     rdx, rax
                mov     rcx, r15
                call    sub_14020B2C0

loc_14028F87F:                          ; CODE XREF: sub_14028F360+4DD↑j
                                        ; sub_14028F360+50F↑j
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    r12
                mov     rcx, rdx
                mov     edx, 2
                sar     rcx, 3
                mov     rax, rcx
                shr     rax, 3Fh
                add     rcx, rax
                call    sub_140292A50
                mov     r15, [rbp+4Fh+var_70]
                jmp     short loc_14028F8E0
; ---------------------------------------------------------------------------

loc_14028F8AD:                          ; CODE XREF: sub_14028F360+4A2↑j
                xor     edx, edx
                lea     rcx, [r14+10h]
                call    sub_1402C75A0
                movzx   ecx, byte ptr [r14+22h]
                test    cl, 10h
                jz      short loc_14028F8C9
                mov     edx, 8
                jmp     short loc_14028F8D8
; ---------------------------------------------------------------------------

loc_14028F8C9:                          ; CODE XREF: sub_14028F360+560↑j
                and     cl, 0FAh
                mov     edx, 4
                or      cl, 2
                mov     [r14+22h], cl

loc_14028F8D8:                          ; CODE XREF: sub_14028F360+567↑j
                mov     rcx, r14
                call    sub_140279270

loc_14028F8E0:                          ; CODE XREF: sub_14028F360+408↑j
                                        ; sub_14028F360+49B↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r14+18h], rax
                mov     [rbp+4Fh+var_A8], rsi
                test    rdi, rdi
                jz      loc_14028F99A
                mov     rax, rdi
                shr     rax, 0Ch
                and     eax, 0Fh
                mov     r10, [r15+rax*8+1B20h]
                mov     rax, cs:qword_140C4DDC0
                test    rax, rax
                jz      short loc_14028F926
                test    dil, 10h
                jnz     short loc_14028F926
                not     rax
                and     rdi, rax

loc_14028F926:                          ; CODE XREF: sub_14028F360+5B8↑j
                                        ; sub_14028F360+5BE↑j
                xor     edx, edx
                shr     rdi, 20h
                lea     rcx, [rbp+4Fh+var_90]
                mov     [rbp+4Fh+var_90], rsi
                call    sub_1402C75A0
                mov     rax, [rbp+4Fh+var_90]
                bt      rsi, 0Ah
                jb      short loc_14028F94C
                and     rax, 0FFFFFFFFFFFFFFF9h
                mov     [rbp+4Fh+var_90], rax

loc_14028F94C:                          ; CODE XREF: sub_14028F360+5E2↑j
                test    r10, r10
                jz      short loc_14028F994
                movzx   r8d, word ptr [r10+0CCh]
                test    rax, rax
                jnz     short loc_14028F96C
                shl     rdi, 20h
                mov     rcx, rdi
                call    sub_14027C6C0
                jmp     short loc_14028F977
; ---------------------------------------------------------------------------

loc_14028F96C:                          ; CODE XREF: sub_14028F360+5FC↑j
                mov     rdx, rdi
                mov     rcx, rax
                call    sub_1402C98B0

loc_14028F977:                          ; CODE XREF: sub_14028F360+60A↑j
                mov     rdx, rax
                mov     rax, r8
                shl     rax, 0Ch
                xor     rax, rdx
                and     eax, 0F000h
                xor     rax, rdx
                or      rax, 2
                mov     [rbp+4Fh+var_90], rax

loc_14028F994:                          ; CODE XREF: sub_14028F360+5EF↑j
                mov     [rbp+4Fh+var_A8], rax
                xor     edi, edi

loc_14028F99A:                          ; CODE XREF: sub_14028F360+596↑j
                mov     r12, [rbp+4Fh+arg_8]
                mov     rax, 0FFFFFFFFFFFFFFFFh
                lock xadd [r12+4F8h], rax

loc_14028F9AF:                          ; CODE XREF: sub_14028F360+33C↑j
                                        ; sub_14028F360+352↑j
                mov     rdx, [rbp+4Fh+var_A8]
                mov     r12, 0FFFFF6FB7DBED000h
                mov     rax, r12
                mov     r14, [rbp+4Fh+var_68]
                cmp     r14, rax
                jb      short loc_14028FA3A
                mov     rax, 0FFFFF6FB7DBED7F8h
                mov     rax, rax
                cmp     r14, rax
                ja      short loc_14028FA3A
                call    sub_140349680
                test    eax, eax
                jz      short loc_14028FA0C
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_14028F9FF
                test    dl, 1
                jz      short loc_14028F9FF
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14028F9FF:                          ; CODE XREF: sub_14028F360+68B↑j
                                        ; sub_14028F360+690↑j
                mov     rcx, r14
                mov     [r14], rdx
                call    sub_140349620
                jmp     short loc_14028FA3D
; ---------------------------------------------------------------------------

loc_14028FA0C:                          ; CODE XREF: sub_14028F360+682↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_14028FA3A
                test    dl, 1
                jz      short loc_14028FA3A
                mov     rax, 8000000000000000h
                or      rdx, rax

loc_14028FA3A:                          ; CODE XREF: sub_14028F360+667↑j
                                        ; sub_14028F360+679↑j ...
                mov     [r14], rdx

loc_14028FA3D:                          ; CODE XREF: sub_14028F360+6AA↑j
                cmp     [rbp+4Fh+var_A8], 0
                mov     r15d, [rbp+4Fh+var_A0]
                jnz     short loc_14028FA4F
                inc     r15d
                mov     [rbp+4Fh+var_A0], r15d

loc_14028FA4F:                          ; CODE XREF: sub_14028F360+6E6↑j
                mov     rbx, [rbp+4Fh+var_60]
                cmp     rbx, [rbp+4Fh+var_58]
                jz      loc_14028FAEB
                test    r13, r13
                jz      short loc_14028FACF
                xor     r12d, r12d
                mov     [rbp+4Fh+var_80], r12d
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jnb     short loc_14028FA8D

loc_14028FA72:                          ; CODE XREF: sub_14028F360+722↓j
                                        ; sub_14028F360+72B↓j
                lea     rcx, [rbp+4Fh+var_80]
                call    sub_1402C8C70
                mov     rax, [r13+18h]
                test    rax, rax
                js      short loc_14028FA72
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jb      short loc_14028FA72

loc_14028FA8D:                          ; CODE XREF: sub_14028F360+710↑j
                mov     edx, [rbp+4Fh+var_B0]
                mov     rcx, r13
                call    sub_14032C75C
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax
                mov     [rbp+4Fh+var_B0], r12d
                test    r15d, r15d
                jz      short loc_14028FAC5
                mov     edx, r15d
                mov     rcx, r14
                call    sub_1403F3EF0
                mov     [rbp+4Fh+var_9C], eax
                mov     r15d, r12d
                mov     [rbp+4Fh+var_A0], r12d

loc_14028FAC5:                          ; CODE XREF: sub_14028F360+74E↑j
                mov     r12, 0FFFFF6FB7DBED000h

loc_14028FACF:                          ; CODE XREF: sub_14028F360+700↑j
                lea     r13, [rbx+rbx*2]
                mov     rax, 0FFFFFA8000000000h
                shl     r13, 4
                mov     rcx, rax
                add     r13, rcx
                mov     [rbp+4Fh+var_58], rbx

loc_14028FAEB:                          ; CODE XREF: sub_14028F360+6F7↑j
                mov     r8d, [rbp+4Fh+var_B0]
                mov     rbx, 8000000000000000h
                mov     rax, [rbp+4Fh+var_50]
                inc     r8d
                add     rax, 1000h
                mov     [rbp+4Fh+var_B0], r8d
                sub     [rbp+4Fh+var_48], 1
                mov     [rbp+4Fh+var_50], rax
                mov     r10, 0FFFFF6FB7DBED7F8h
                mov     r9, 0FFFFF68000000000h
                jnz     loc_14028F450
                mov     ecx, [rbp+4Fh+arg_20]
                mov     rax, [rbp+4Fh+var_40]
                inc     ecx
                inc     rax
                mov     [rbp+4Fh+arg_20], ecx
                cmp     ecx, [rbp+4Fh+var_98]
                mov     rcx, [rbp+4Fh+arg_0]
                mov     [rbp+4Fh+var_40], rax
                jb      loc_14028F425
                test    r8d, r8d
                jz      loc_14028FBEF
                mov     [rbp+4Fh+var_7C], 0
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jnb     short loc_14028FB85

loc_14028FB66:                          ; CODE XREF: sub_14028F360+816↓j
                                        ; sub_14028F360+81F↓j
                lea     rcx, [rbp+4Fh+var_7C]
                call    sub_1402C8C70
                mov     rax, [r13+18h]
                test    rax, rax
                js      short loc_14028FB66
                lock bts qword ptr [r13+18h], 3Fh ; '?'
                jb      short loc_14028FB66
                mov     r8d, [rbp+4Fh+var_B0]

loc_14028FB85:                          ; CODE XREF: sub_14028F360+804↑j
                movzx   eax, byte ptr [r13+22h]
                and     al, 7
                cmp     al, 6
                jnz     loc_14028FC2A
                mov     rcx, [r13+18h]
                mov     r9, 3FFFFFFFFFFFFFFFh
                mov     eax, r8d
                mov     rdx, rcx
                and     rdx, r9
                sub     rdx, rax
                mov     rax, rdx
                xor     rax, rcx
                and     rax, r9
                xor     rax, rcx
                mov     [r13+18h], rax
                test    rdx, rdx
                jnz     short loc_14028FBCB
                mov     rcx, r13
                call    sub_140278C00

loc_14028FBCB:                          ; CODE XREF: sub_14028F360+861↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r13+18h], rax
                test    r15d, r15d
                jz      short loc_14028FBEF
                mov     edx, r15d
                mov     rcx, r14
                call    sub_1403F3EF0
                mov     r14d, eax
                jmp     short loc_14028FBF3
; ---------------------------------------------------------------------------

loc_14028FBEF:                          ; CODE XREF: sub_14028F360+7F0↑j
                                        ; sub_14028F360+87D↑j
                mov     r14d, [rbp+4Fh+var_9C]

loc_14028FBF3:                          ; CODE XREF: sub_14028F360+8E↑j
                                        ; sub_14028F360+88D↑j
                mov     r12, [rsp+0D0h+arg_10]
                mov     eax, r14d
                mov     r15, [rsp+0D0h+var_30]
                add     rsp, 0A8h
                pop     r14
                pop     r13
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
byte_14028FC16  db 0CCh                 ; DATA XREF: .pdata:00000001400CEFDC↑o
                                        ; .pdata:00000001400CEFE8↑o
; ---------------------------------------------------------------------------

loc_14028FC17:                          ; CODE XREF: sub_14028F360+65↑j
                                        ; sub_14028F360+6F↑j
                xor     eax, eax
                add     rsp, 0A8h
                pop     r14
                pop     r13
                pop     rdi
                pop     rsi
                pop     rbx
                pop     rbp
                retn
; ---------------------------------------------------------------------------
                align 2

loc_14028FC2A:                          ; CODE XREF: sub_14028F360+82E↑j
                                        ; DATA XREF: .pdata:00000001400CEFE8↑o ...
                mov     rcx, r13
                call    sub_1403F4244
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14028FC33:                          ; CODE XREF: sub_14028F360+3D8↑j
                mov     rcx, r14
                call    sub_1403F4244
; ---------------------------------------------------------------------------
                db 0CCh
sub_14028F360   endp

byte_14028FC3C  db 14h dup(0CCh)        ; DATA XREF: .pdata:00000001400CEFF4↑o

; =============== S U B R O U T I N E =======================================


sub_14028FC50   proc near               ; CODE XREF: sub_1402E4D4C+3D↓p
                                        ; DATA XREF: .rdata:000000014005F72C↑o ...

var_108         = qword ptr -108h
var_100         = qword ptr -100h
var_F8          = dword ptr -0F8h
var_F0          = dword ptr -0F0h
var_E8          = dword ptr -0E8h
var_E4          = dword ptr -0E4h
var_E0          = qword ptr -0E0h
var_D8          = qword ptr -0D8h
var_D0          = dword ptr -0D0h
var_CC          = xmmword ptr -0CCh
var_BC          = xmmword ptr -0BCh
var_AC          = xmmword ptr -0ACh
var_9C          = xmmword ptr -9Ch
var_8C          = xmmword ptr -8Ch
var_7C          = xmmword ptr -7Ch
var_6C          = xmmword ptr -6Ch
var_5C          = xmmword ptr -5Ch
var_4C          = dword ptr -4Ch
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_30          = qword ptr -30h
arg_10          = qword ptr  18h

; __unwind { // __GSHandlerCheck
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r13
                sub     rsp, 100h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+128h+var_48], rax
                mov     ebx, r8d
                mov     [rsp+128h+var_E4], edx
                mov     rsi, r9
                mov     r8d, edx
                mov     r13, rcx
                test    bl, 1
                jnz     loc_140290051
                xor     ebp, ebp
                cmp     cs:dword_140CFB004, 1
                mov     [rsp+128h+var_E8], ebp
                jbe     short loc_14028FCB2
                movzx   ecx, cs:byte_140C4DD0D
                movzx   eax, cs:byte_140CFC53C
                shr     edx, cl
                and     dx, ax
                movzx   ebp, dx
                mov     [rsp+128h+var_E8], ebp

loc_14028FCB2:                          ; CODE XREF: sub_14028FC50+46↑j
                movzx   ecx, cs:byte_140C4DD0C
                mov     edi, r8d
                shr     edi, cl
                mov     r8d, ebx
                mov     eax, edi
                mov     edx, ebp
                imul    rax, 11C0h
                add     rax, [r13+10h]
                mov     rcx, rax
                mov     [rsp+128h+var_E0], rax
                call    sub_14026C3D4
                cmp     rax, rsi
                jnb     loc_140290051
; } // starts at 14028FC50

loc_14028FCE6:                          ; DATA XREF: .rdata:000000014005F72C↑o
                                        ; .rdata:000000014005F740↑o ...
; __unwind { // __GSHandlerCheck
                mov     [rsp+128h+arg_10], r12
                mov     eax, 2
                mov     [rsp+128h+var_30], r14
                mov     [rsp+128h+var_38], r15
                bt      ebx, 0Ah
                jnb     short loc_14028FD0E
                xor     r12d, r12d
                jmp     short loc_14028FD1C
; ---------------------------------------------------------------------------

loc_14028FD0E:                          ; CODE XREF: sub_14028FC50+B7↑j
                bt      ebx, 0Bh
                mov     r12d, 1
                cmovb   r12d, eax

loc_14028FD1C:                          ; CODE XREF: sub_14028FC50+BC↑j
                and     ebx, eax
                mov     esi, 3
                add     ebx, ebx
                or      ebx, 9
                mov     r14, cr8
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                mov     r15, 0FFFFFFFFFFFFFFFFh
                test    eax, eax
                jz      short loc_14028FD80
                test    al, 1
                jz      short loc_14028FD80
                cmp     r14b, 0Fh
                ja      short loc_14028FD80
                mov     rax, gs:20h
                mov     rdx, r15
                movzx   ecx, r14b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_14028FD80:                          ; CODE XREF: sub_14028FC50+EF↑j
                                        ; sub_14028FC50+F3↑j ...
                mov     eax, ebx
                mov     [rsp+128h+var_F0], r12d
                or      ebx, 20h
                mov     [rsp+128h+var_F8], ebp
                add     esi, 0FFFFFFFFh
                mov     r8d, 1
                mov     edx, esi
                mov     rcx, r13
                cmovnz  ebx, eax
                mov     eax, [rsp+128h+var_E4]
                mov     dword ptr [rsp+128h+var_100], eax
                mov     r9d, ebx
                mov     dword ptr [rsp+128h+var_108], edi
                call    sub_1403F6330
                mov     rbp, rax
                test    rax, rax
                jnz     loc_14028FE68
                mov     ebp, [rsp+128h+var_E8]
                test    esi, esi
                jnz     short loc_14028FD80
                test    bl, 1
                jz      short loc_14028FDD4
                lea     esi, [rax+3]
                and     ebx, 0FFFFFFDEh
                jmp     short loc_14028FD80
; ---------------------------------------------------------------------------

loc_14028FDD4:                          ; CODE XREF: sub_14028FC50+17A↑j
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14028FE27
                test    al, 1
                jz      short loc_14028FE27
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14028FE27
                cmp     r14b, 0Fh
                ja      short loc_14028FE27
                cmp     al, 2
                jb      short loc_14028FE27
                mov     r9, gs:20h
                movzx   ecx, r14b
                inc     ecx
                shl     r15, cl
                mov     r8, [r9+84B8h]
                movzx   eax, r15w
                not     eax
                mov     edx, [r8+14h]
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_14028FE27
                mov     rcx, r9
                call    sub_1403F2EC4

loc_14028FE27:                          ; CODE XREF: sub_14028FC50+18C↑j
                                        ; sub_14028FC50+190↑j ...
                movzx   eax, r14b
                mov     cr8, rax
                xor     eax, eax

loc_14028FE31:                          ; CODE XREF: sub_14028FC50+3FC↓j
                mov     r14, [rsp+128h+var_30]
                mov     r12, [rsp+128h+arg_10]
                mov     r15, [rsp+128h+var_38]
; } // starts at 14028FCE6

loc_14028FE49:                          ; CODE XREF: sub_14028FC50+403↓j
                                        ; DATA XREF: .pdata:00000001400CF00C↑o ...
; __unwind { // __GSHandlerCheck
                mov     rcx, [rsp+128h+var_48]
                xor     rcx, rsp
                call    __security_check_cookie
                add     rsp, 100h
                pop     r13
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                align 8
; } // starts at 14028FE49

loc_14028FE68:                          ; CODE XREF: sub_14028FC50+169↑j
                                        ; DATA XREF: .pdata:00000001400CF018↑o ...
; __unwind { // __GSHandlerCheck
                test    bl, 20h
                jz      short loc_14028FE8D
                mov     rcx, [rsp+128h+var_E0]
                mov     r9d, 1
                mov     r8d, esi
                mov     [rsp+128h+var_108], rbp
                mov     rdx, rbp
                call    sub_140320BB0
                mov     esi, 1

loc_14028FE8D:                          ; CODE XREF: sub_14028FC50+21B↑j
                mov     eax, esi
                lea     r8, qword_14001A848
                mov     r8, [r8+rax*8]
                mov     rax, 0FFFFFA8000000000h
                mov     rcx, rbp
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rcx, [r13+1BC0h]
                mov     r9, rdx
                sar     r9, 3
                mov     rax, r9
                shr     rax, 3Fh
                add     r9, rax
                test    rcx, rcx
                jz      short loc_14028FED7
                dec     rcx

loc_14028FED7:                          ; CODE XREF: sub_14028FC50+282↑j
                cmp     rcx, 9Fh
                jnb     short loc_14028FF20
                mov     rax, gs:188h
                mov     edx, [rax+514h]
                mov     eax, edx
                and     al, 0Ch
                cmp     al, 8
                jz      short loc_14028FF20
                cmp     rcx, 20h ; ' '
                jnb     short loc_14028FF09
                lea     rax, unk_140C50C00
                cmp     r13, rax
                jz      short loc_14028FF1C

loc_14028FF09:                          ; CODE XREF: sub_14028FC50+2AB↑j
                test    dl, 2
                jz      short loc_14028FF14
                cmp     rcx, 21h ; '!'
                jnb     short loc_14028FF20

loc_14028FF14:                          ; CODE XREF: sub_14028FC50+2BC↑j
                mov     eax, [r13+4]
                test    al, 20h
                jnz     short loc_14028FF20

loc_14028FF1C:                          ; CODE XREF: sub_14028FC50+2B7↑j
                xor     ebx, ebx
                jmp     short loc_14028FF36
; ---------------------------------------------------------------------------

loc_14028FF20:                          ; CODE XREF: sub_14028FC50+28E↑j
                                        ; sub_14028FC50+2A5↑j ...
                mov     eax, [rsp+128h+var_E4]
                lea     rcx, [r8-1]
                and     rcx, rax
                lea     rbx, [rcx+rcx*2]
                shl     rbx, 4
                add     rbx, rbp

loc_14028FF36:                          ; CODE XREF: sub_14028FC50+2CE↑j
                mov     rcx, rbp
                call    sub_1402D9B30
                test    eax, eax
                jz      short loc_14028FFBC
                test    cs:dword_140CFC41C, 200000h
                jz      short loc_14028FFBC
                xorps   xmm0, xmm0
                mov     [rsp+128h+var_D8], 1
                xor     eax, eax
                mov     [rsp+128h+var_D0], 1
                mov     r8d, esi
                mov     [rsp+128h+var_4C], eax
                mov     rdx, r9
                lea     rcx, [rsp+128h+var_D8]
                movups  [rsp+128h+var_CC], xmm0
                movups  [rsp+128h+var_BC], xmm0
                movups  [rsp+128h+var_AC], xmm0
                movups  [rsp+128h+var_9C], xmm0
                movups  [rsp+128h+var_8C], xmm0
                movups  [rsp+128h+var_7C], xmm0
                movups  [rsp+128h+var_6C], xmm0
                movups  [rsp+128h+var_5C], xmm0
                call    sub_1403F76A4
                xor     edx, edx
                mov     rcx, rbp
                call    sub_1403AC890

loc_14028FFBC:                          ; CODE XREF: sub_14028FC50+2F0↑j
                                        ; sub_14028FC50+2FC↑j
                mov     eax, [rbp+10h]
                mov     r9d, 0
                test    rax, 3E0h
                mov     [rsp+128h+var_100], 0
                mov     r8d, 1
                mov     [rsp+128h+var_108], rbx
                setnz   r9b
                mov     edx, esi
                mov     rcx, rbp
                call    sub_1403F5644
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140290041
                test    al, 1
                jz      short loc_140290041
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140290041
                cmp     r14b, 0Fh
                ja      short loc_140290041
                cmp     al, 2
                jb      short loc_140290041
                mov     rax, gs:20h
                movzx   ecx, r14b
                inc     ecx
                shl     r15, cl
                mov     r9, [rax+84B8h]
                movzx   edx, r15w
                not     edx
                mov     r8d, [r9+14h]
                and     r8d, edx
                mov     [r9+14h], r8d
                jnz     short loc_140290041
                mov     rcx, rax
                call    sub_1403F2EC4

loc_140290041:                          ; CODE XREF: sub_14028FC50+3A5↑j
                                        ; sub_14028FC50+3A9↑j ...
                movzx   ecx, r14b
                mov     cr8, rcx
                mov     rax, rbx
                jmp     loc_14028FE31
; } // starts at 14028FE68
; ---------------------------------------------------------------------------

loc_140290051:                          ; CODE XREF: sub_14028FC50+33↑j
                                        ; sub_14028FC50+90↑j
                                        ; DATA XREF: ...
; __unwind { // __GSHandlerCheck
                xor     eax, eax
                jmp     loc_14028FE49
; } // starts at 140290051
sub_14028FC50   endp

; ---------------------------------------------------------------------------
algn_140290058:                         ; DATA XREF: .pdata:00000001400CF030↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140290060   proc near               ; CODE XREF: sub_1403AF110+83↓p
                                        ; DATA XREF: .pdata:00000001400CF03C↑o

var_E8          = dword ptr -0E8h
var_C8          = qword ptr -0C8h
var_C0          = dword ptr -0C0h
var_B8          = qword ptr -0B8h
var_B0          = dword ptr -0B0h
var_A8          = qword ptr -0A8h
var_98          = qword ptr -98h
var_90          = xmmword ptr -90h
var_80          = qword ptr -80h
var_78          = qword ptr -78h
var_70          = qword ptr -70h
var_68          = qword ptr -68h
var_60          = qword ptr -60h
var_58          = qword ptr -58h
var_50          = qword ptr -50h
var_48          = xmmword ptr -48h
arg_0           = qword ptr  8
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_18          = dword ptr  20h

                mov     [rsp+arg_0], rcx
                push    rbx
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 0B0h
                mov     rax, gs:188h
                mov     r12, rcx
                xor     edx, edx
                mov     [rsp+0E8h+var_50], rax
                mov     rcx, rax
                or      dword ptr [rax+514h], 400h
                call    KeSetActualBasePriorityThread
                mov     rcx, gs:188h
                xor     edi, edi
                mov     r8, [r12+0E8h]
                mov     [rsp+0E8h+arg_18], eax
                mov     [rsp+0E8h+arg_8], edi
                mov     [rsp+0E8h+var_58], r8
                mov     rax, [r8+48h]
                mov     [r12+110h], rcx
                mov     ecx, [r12+108h]
                mov     [rsp+0E8h+var_70], rax
                lea     rdx, [rcx+rcx*4]
                mov     rcx, [r8+90h]
                mov     [rcx+rdx*8+8], r12
                mov     eax, [r12+108h]
                lea     rcx, [rax+rax*4]
                mov     rax, [r8+90h]
                lea     rsi, [rax+rcx*8]
                xor     eax, eax
                xchg    eax, [rsi]
                mov     [rsp+0E8h+var_78], rsi
                rdtsc
                shl     rdx, 20h
                or      rax, rdx
                lock or [rsp+0E8h+var_E8], edi
                lea     ebx, [rdi+1]

loc_140290121:                          ; CODE XREF: sub_140290060+D84↓j
                mov     [rsp+0E8h+var_68], rax

loc_140290129:                          ; CODE XREF: sub_140290060+DB4↓j
                lea     r9, qword_140010630
                mov     r8d, 2
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140290140:                          ; CODE XREF: sub_140290060+D4E↓j
                mov     r13, [r12+0E8h]
                xor     eax, eax
                mov     [rsp+0E8h+var_80], rax
                xorps   xmm0, xmm0
                movups  [rsp+0E8h+var_90], xmm0
                xor     r14d, r14d
                mov     r15, [r13+48h]
                cmp     [r13+88h], eax
                jnz     loc_140290213
                cmp     [r12+12Ch], al
                jnz     loc_140290464
                lea     rcx, [r13+18h]
                mov     byte ptr [r12+12Ch], 1
                lea     rdx, [rsp+0E8h+var_90]
                call    KeAcquireInStackQueuedSpinLock
                add     dword ptr [r13+98h], 0FFFFFFFFh
                jnz     short loc_1402901A1
                mov     [r13+88h], ebx

loc_1402901A1:                          ; CODE XREF: sub_140290060+138↑j
                lea     rcx, [rsp+0E8h+var_90]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rsp+0E8h+var_80]
                test    eax, eax
                jz      short loc_14029020A
                test    al, 1
                jz      short loc_14029020A
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14029020A
                cmp     bl, 0Fh
                ja      short loc_14029020A
                cmp     al, 2
                jb      short loc_14029020A
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, byte ptr [rsp+0E8h+var_80]
                inc     ecx
                shl     rdx, cl
                movzx   eax, dx
                not     eax
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14029020A
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14029020A:                          ; CODE XREF: sub_140290060+158↑j
                                        ; sub_140290060+15C↑j ...
                mov     cr8, rbx
                jmp     loc_140290464
; ---------------------------------------------------------------------------

loc_140290213:                          ; CODE XREF: sub_140290060+105↑j
                mov     eax, [r12+108h]
                lea     rdx, [rax+rax*4]
                mov     rax, [r13+90h]
                lea     rdi, [rax+rdx*8]
                movzx   eax, byte ptr [rax+rdx*8+4]
                test    al, 1
                jz      loc_1402903E0
                lea     rsi, [r13+18h]
                nop     dword ptr [rax+rax+00h]

loc_140290240:                          ; CODE XREF: sub_140290060+2FA↓j
                mov     qword ptr [rsp+0E8h+var_90+8], rsi
                mov     qword ptr [rsp+0E8h+var_90], 0
                mov     r10, cr8
                mov     cr8, r8
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140290298
                test    al, 1
                jz      short loc_140290298
                cmp     r10b, 0Fh
                ja      short loc_140290298
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r10b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_140290298:                          ; CODE XREF: sub_140290060+1FE↑j
                                        ; sub_140290060+202↑j ...
                mov     rdx, rsi
                mov     byte ptr [rsp+0E8h+var_80], r10b
                lea     rcx, [rsp+0E8h+var_90]
                call    sub_14024B3F0
                movzx   eax, byte ptr [rdi+4]
                lea     rcx, [rsp+0E8h+var_90]
                test    al, 2
                jnz     loc_140290362
                movzx   eax, byte ptr [rdi+4]
                test    al, 1
                jz      loc_140290362
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rsp+0E8h+var_80]
                test    eax, eax
                jz      short loc_14029032B
                test    al, 1
                jz      short loc_14029032B
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14029032B
                cmp     bl, 0Fh
                ja      short loc_14029032B
                cmp     al, 2
                jb      short loc_14029032B
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, byte ptr [rsp+0E8h+var_80]
                inc     ecx
                shl     rdx, cl
                movzx   eax, dx
                not     eax
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14029032B
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14029032B:                          ; CODE XREF: sub_140290060+279↑j
                                        ; sub_140290060+27D↑j ...
                mov     cr8, rbx
                lea     rcx, [rdi+10h]
                mov     [rsp+0E8h+var_C8], 0
                xor     r9d, r9d
                xor     r8d, r8d
                xor     edx, edx
                mov     r14d, 1
                call    KeWaitForSingleObject
                movzx   eax, byte ptr [rdi+4]
                lea     r8d, [r14+1]
                test    r14b, al
                jnz     loc_140290240
                jmp     short loc_1402903CA
; ---------------------------------------------------------------------------

loc_140290362:                          ; CODE XREF: sub_140290060+255↑j
                                        ; sub_140290060+261↑j
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rsp+0E8h+var_80]
                test    eax, eax
                jz      short loc_1402903C6
                test    al, 1
                jz      short loc_1402903C6
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_1402903C6
                cmp     bl, 0Fh
                ja      short loc_1402903C6
                cmp     al, 2
                jb      short loc_1402903C6
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, byte ptr [rsp+0E8h+var_80]
                inc     ecx
                shl     rdx, cl
                movzx   eax, dx
                not     eax
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_1402903C6
                mov     rcx, r10
                call    sub_1403F2EC4

loc_1402903C6:                          ; CODE XREF: sub_140290060+314↑j
                                        ; sub_140290060+318↑j ...
                mov     cr8, rbx

loc_1402903CA:                          ; CODE XREF: sub_140290060+300↑j
                mov     rsi, [rsp+0E8h+var_78]

loc_1402903CF:                          ; CODE XREF: sub_140290060+3AF↓j
                lea     r9, qword_140010630
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_1402903E0:                          ; CODE XREF: sub_140290060+1D1↑j
                mov     eax, [r15+18C4h]
                test    eax, eax
                jnz     short loc_1402903F5
                mov     eax, cs:dword_140C4ED58
                test    eax, eax
                jz      short loc_14029045D

loc_1402903F5:                          ; CODE XREF: sub_140290060+389↑j
                mov     [rsp+0E8h+var_C8], r9
                lea     rcx, [r15+68h]
                xor     r9d, r9d
                xor     r8d, r8d
                lea     edx, [r9+8]
                call    KeWaitForSingleObject
                test    eax, eax
                jnz     short loc_1402903CF
                mov     rcx, gs:188h
                lea     edx, [rax+0Ch]
                call    KeSetActualBasePriorityThread

loc_140290422:                          ; CODE XREF: sub_140290060+41D↓j
                inc     cs:dword_140C2A108

loc_140290428:                          ; CODE XREF: sub_140290060+D93↓j
                mov     rbx, [rsp+0E8h+var_50]
                mov     edx, [rsp+0E8h+arg_18]
                mov     rcx, rbx
                call    KeSetActualBasePriorityThread
                and     dword ptr [rbx+514h], 0FFFFFBFFh
                add     rsp, 0B0h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_14029045D:                          ; CODE XREF: sub_140290060+393↑j
                mov     edi, [rsp+0E8h+arg_8]

loc_140290464:                          ; CODE XREF: sub_140290060+113↑j
                                        ; sub_140290060+1AE↑j
                cmp     qword ptr [r12+0F0h], 0
                jnz     short loc_140290487
                mov     rcx, [r13+48h]
                xor     edx, edx
                call    sub_14032ACE0
                test    rax, rax
                jz      short loc_140290422
                mov     [r12+0F0h], rax

loc_140290487:                          ; CODE XREF: sub_140290060+40D↑j
                test    r14d, r14d
                jz      short loc_1402904A6
                xor     eax, eax
                xchg    eax, [rsi]
                rdtsc
                shl     rdx, 20h
                or      rax, rdx
                mov     [rsp+0E8h+var_68], rax
                lock or [rsp+0E8h+var_E8], 0

loc_1402904A6:                          ; CODE XREF: sub_140290060+42A↑j
                mov     rsi, [rsp+0E8h+var_58]
                inc     dword ptr [rsi+120h]
                test    edi, edi
                jnz     short loc_1402904D4
                cmp     [r12+50h], dil
                jz      short loc_1402904D4
                mov     rbx, [rsp+0E8h+var_70]
                mov     rdx, r12
                mov     rcx, rbx
                call    sub_140330BF0
                jmp     loc_140290D55
; ---------------------------------------------------------------------------

loc_1402904D4:                          ; CODE XREF: sub_140290060+456↑j
                                        ; sub_140290060+45D↑j
                movzx   ecx, cs:byte_140C4DD0C
                lea     rax, [r12+0F8h]
                mov     r9d, [rax+0Ch]
                shr     r9d, cl
                mov     qword ptr [r12+20h], 0
                mov     byte ptr [r12+45h], 0
                cmp     edi, 3
                jnb     short loc_14029053D
                mov     rbx, [rsp+0E8h+var_70]
                mov     r8d, 1
                mov     [rsp+0E8h+var_A8], r12
                mov     edx, edi
                mov     [rsp+0E8h+var_B0], 40h ; '@'
                mov     rcx, rbx
                mov     [rsp+0E8h+var_B8], rax
                mov     [rsp+0E8h+var_C0], 1
                mov     dword ptr [rsp+0E8h+var_C8], 4
                call    sub_1403F6B04
                mov     r15, rax
                jmp     loc_140290CC6
; ---------------------------------------------------------------------------

loc_14029053D:                          ; CODE XREF: sub_140290060+49C↑j
                mov     rax, [rsp+0E8h+arg_0]
                xor     r12d, r12d
                mov     r11b, 11h
                xor     r14d, r14d
                mov     [rsp+0E8h+var_98], r11
                mov     r13d, [rax+104h]
                mov     edx, r13d
                mov     rax, [rsp+0E8h+var_70]
                mov     r8, [rax+888h]
                mov     [rsp+0E8h+var_60], r8
                nop     dword ptr [rax+00h]
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_140290580:                          ; CODE XREF: sub_140290060+5AE↓j
                                        ; sub_140290060+5C0↓j
                mov     eax, edx
                lea     rcx, [rax+rax*4]
                mov     rax, 0FFFFFFFFFh
                mov     rsi, [r8+rcx*8+10h]
                cmp     rsi, rax
                jz      short loc_1402905D6
                lea     rdi, [rsi+rsi*2]
                mov     rax, 0FFFFFA8000000000h
                add     rdi, rdi
                mov     rax, rax
                lea     r15, [rax+rdi*8]
                test    r14d, r14d
                jnz     loc_140290655
                mov     rax, [r15+18h]
                mov     rcx, 8000000000000000h
                test    rcx, rax
                jz      loc_140290655
                lea     r12d, [r14+1]

loc_1402905D6:                          ; CODE XREF: sub_140290060+538↑j
                                        ; sub_140290060+77B↓j
                xor     r15d, r15d

loc_1402905D9:                          ; CODE XREF: sub_140290060+5F8↓j
                mov     r8, [rsp+0E8h+arg_0]
                mov     edx, cs:dword_140C4DD00
                not     edx
                mov     eax, [r8+104h]
                and     edx, eax
                inc     eax
                and     eax, cs:dword_140C4DD00
                or      edx, eax
                mov     [r8+104h], edx

loc_140290603:                          ; CODE XREF: sub_140290060+807↓j
                mov     r8, [rsp+0E8h+var_60]
                cmp     edx, r13d
                jnz     loc_140290580
                test    r12d, r12d
                jz      short loc_140290626
                inc     r14d
                cmp     r14d, 2
                jb      loc_140290580

loc_140290626:                          ; CODE XREF: sub_140290060+5B7↑j
                                        ; sub_140290060+6FF↓j
                test    r15, r15
                jz      loc_140290DE9
                cmp     word ptr [r15+20h], 0
                jnz     loc_140290E20
                test    byte ptr [r15+22h], 8
                mov     r12, [rsp+0E8h+arg_0]
                jz      loc_14029086C
                xor     ebx, ebx
                jmp     loc_140290C38
; ---------------------------------------------------------------------------

loc_140290655:                          ; CODE XREF: sub_140290060+555↑j
                                        ; sub_140290060+56C↑j
                test    r15, r15
                jz      loc_1402905D9
                mov     r11, cr8
                mov     [rsp+0E8h+var_98], r11
                mov     eax, 2
                mov     cr8, rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_1402906B2
                test    al, 1
                jz      short loc_1402906B2
                cmp     r11b, 0Fh
                ja      short loc_1402906B2
                mov     rax, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r11b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_1402906B2:                          ; CODE XREF: sub_140290060+618↑j
                                        ; sub_140290060+61C↑j ...
                xor     ebx, ebx
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jnb     short loc_1402906FF
                nop     dword ptr [rax]

loc_1402906C0:                          ; CODE XREF: sub_140290060+68F↓j
                                        ; sub_140290060+698↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jnz     short loc_1402906E6
                mov     eax, cs:dword_140CFC41C
                test    al, 40h
                jz      short loc_1402906E6
                call    sub_140390EA0
                test    al, al
                jz      short loc_1402906E6
                mov     ecx, ebx
                call    sub_1403900C0
                jmp     short loc_1402906E8
; ---------------------------------------------------------------------------

loc_1402906E6:                          ; CODE XREF: sub_140290060+668↑j
                                        ; sub_140290060+672↑j ...
                pause

loc_1402906E8:                          ; CODE XREF: sub_140290060+684↑j
                mov     rax, [r15+18h]
                test    rax, rax
                js      short loc_1402906C0
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jb      short loc_1402906C0
                mov     r11, [rsp+0E8h+var_98]

loc_1402906FF:                          ; CODE XREF: sub_140290060+65B↑j
                mov     rax, 0FFFFFFFFFh
                cmp     rsi, rax
                ja      loc_1402907E0
                mov     rax, 0FFFFFA8000000028h
                mov     rax, rax
                mov     rcx, [rax+rdi*8]
                mov     rax, 4000000000000h
                test    rax, rcx
                jz      loc_1402907E0
                movzx   ecx, byte ptr [r15+22h]
                movzx   eax, cl
                and     al, 7
                cmp     al, 1
                jnz     loc_1402907E0
                mov     rdx, 1000000000h
                test    [r15+28h], rdx
                jnz     loc_1402907E0
                test    cl, 8
                jz      loc_140290626
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r15+18h], rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_1402907D3
                test    al, 1
                jz      short loc_1402907D3
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_1402907D3
                cmp     r11b, 0Fh
                ja      short loc_1402907D3
                cmp     al, 2
                jb      short loc_1402907D3
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r11b
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_1402907D3
                mov     rcx, r10
                call    sub_1403F2EC4
                mov     r11, [rsp+0E8h+var_98]

loc_1402907D3:                          ; CODE XREF: sub_140290060+71C↑j
                                        ; sub_140290060+720↑j ...
                movzx   eax, r11b
                mov     cr8, rax
                jmp     loc_1402905D6
; ---------------------------------------------------------------------------

loc_1402907E0:                          ; CODE XREF: sub_140290060+6AC↑j
                                        ; sub_140290060+6D0↑j ...
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r15+18h], rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14029084E
                test    al, 1
                jz      short loc_14029084E
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14029084E
                cmp     r11b, 0Fh
                ja      short loc_14029084E
                cmp     al, 2
                jb      short loc_14029084E
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r11b
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_14029084E
                mov     rcx, r10
                call    sub_1403F2EC4
                mov     r11, [rsp+0E8h+var_98]

loc_14029084E:                          ; CODE XREF: sub_140290060+797↑j
                                        ; sub_140290060+79B↑j ...
                movzx   eax, r11b
                mov     cr8, rax
                mov     rax, [rsp+0E8h+arg_0]
                xor     r15d, r15d
                mov     edx, [rax+104h]
                jmp     loc_140290603
; ---------------------------------------------------------------------------

loc_14029086C:                          ; CODE XREF: sub_140290060+5E8↑j
                mov     [r12+18h], r15
                lea     r14, unk_140C4E3F0
                mov     rdi, gs:188h
                mov     [r12+38h], rdi
                movzx   eax, byte ptr [r15+22h]
                or      al, 8
                mov     [r15+10h], r12
                mov     [r15+22h], al
                lea     rax, unk_140C4E3E0
                cmp     byte ptr [r12+47h], 0
                mov     qword ptr [r12+20h], 0
                cmovnz  r14, rax
                mov     word ptr [r12+45h], 0
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_1402908CF
                mov     dl, 0FFh
                mov     rcx, r14
                call    sub_1405B5E68
                jmp     loc_14029098B
; ---------------------------------------------------------------------------

loc_1402908CF:                          ; CODE XREF: sub_140290060+85E↑j
                mov     rbx, gs:20h
                mov     [rsp+0E8h+arg_10], 0
                mov     rcx, [rbx+84B8h]
                test    rcx, rcx
                jz      short loc_140290908
                cmp     byte ptr [rbx+20h], 1
                ja      short loc_140290908
                mov     eax, [rcx+18h]
                add     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_140290908
                mov     rcx, rbx
                call    sub_1403F2EC4

loc_140290908:                          ; CODE XREF: sub_140290060+88D↑j
                                        ; sub_140290060+893↑j ...
                lock bts dword ptr [r14], 1Fh
                jnb     short loc_140290946
                mov     rcx, [rbx+84B8h]
                test    rcx, rcx
                jz      short loc_140290935
                cmp     byte ptr [rbx+20h], 1
                ja      short loc_140290935
                mov     eax, [rcx+18h]
                sub     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_140290935
                mov     rcx, rbx
                call    sub_1403F2EC4

loc_140290935:                          ; CODE XREF: sub_140290060+8BA↑j
                                        ; sub_140290060+8C0↑j ...
                mov     dl, 0FFh
                mov     rcx, r14
                call    sub_14028EAE0
                mov     [rsp+0E8h+arg_10], eax

loc_140290946:                          ; CODE XREF: sub_140290060+8AE↑j
                mov     edx, [r14]
                mov     ecx, edx
                btr     ecx, 1Eh
                cmp     ecx, 80000000h
                jz      short loc_14029098B

loc_140290957:                          ; CODE XREF: sub_140290060+929↓j
                bt      edx, 1Eh
                jb      short loc_14029096E
                mov     ecx, edx
                mov     eax, edx
                bts     ecx, 1Eh
                lock cmpxchg [r14], ecx
                mov     edx, eax
                jnz     short loc_14029097E

loc_14029096E:                          ; CODE XREF: sub_140290060+8FB↑j
                lea     rcx, [rsp+0E8h+arg_10]
                call    sub_1402C8C70
                mov     edx, [r14]

loc_14029097E:                          ; CODE XREF: sub_140290060+90C↑j
                mov     eax, edx
                btr     eax, 1Eh
                cmp     eax, 80000000h
                jnz     short loc_140290957

loc_14029098B:                          ; CODE XREF: sub_140290060+86A↑j
                                        ; sub_140290060+8F5↑j
                cmp     byte ptr [r12+47h], 0
                jnz     loc_140290B99
                mov     rdx, cs:qword_140C4E3F8
                xor     r10b, r10b
                test    rdx, rdx
                jz      short loc_1402909C9

loc_1402909A6:                          ; CODE XREF: sub_140290060+956↓j
                                        ; sub_140290060+964↓j
                cmp     r12, rdx
                jnb     short loc_1402909B8
                mov     rax, [rdx]
                test    rax, rax
                jz      short loc_1402909C9
                mov     rdx, rax
                jmp     short loc_1402909A6
; ---------------------------------------------------------------------------

loc_1402909B8:                          ; CODE XREF: sub_140290060+949↑j
                mov     rax, [rdx+8]
                test    rax, rax
                jz      short loc_1402909C6
                mov     rdx, rax
                jmp     short loc_1402909A6
; ---------------------------------------------------------------------------

loc_1402909C6:                          ; CODE XREF: sub_140290060+95F↑j
                mov     r10b, 1

loc_1402909C9:                          ; CODE XREF: sub_140290060+944↑j
                                        ; sub_140290060+951↑j
                mov     qword ptr [r12], 0
                mov     rdi, r12
                mov     qword ptr [r12+8], 0
                mov     [r12+10h], rdx
                test    rdx, rdx
                jnz     short loc_1402909F3
                mov     cs:qword_140C4E3F8, r12
                jmp     loc_140290BDB
; ---------------------------------------------------------------------------

loc_1402909F3:                          ; CODE XREF: sub_140290060+985↑j
                movzx   eax, r10b
                lea     r9, [rdx+10h]
                mov     ecx, 0FFFFFFFFh
                mov     [rdx+rax*8], r12
                movzx   eax, r10b
                movzx   r8d, byte ptr [r9]
                add     al, al
                sub     cl, al
                movzx   ebx, r8b
                and     cl, 3
                and     bl, 3
                jnz     short loc_140290A62
                nop     dword ptr [rax+00h]

loc_140290A20:                          ; CODE XREF: sub_140290060+A00↓j
                and     r8b, 0FCh
                mov     rdi, rdx
                or      r8b, cl
                mov     [r9], r8b
                mov     rdx, [r9]
                and     rdx, 0FFFFFFFFFFFFFFFCh
                jz      loc_140290BDB
                cmp     [rdx], rdi
                lea     r9, [rdx+10h]
                movzx   r8d, byte ptr [r9]
                mov     ecx, 0FFFFFFFFh
                setnz   r10b
                movzx   ebx, r8b
                movzx   eax, r10b
                add     al, al
                sub     cl, al
                and     cl, 3
                and     bl, 3
                jz      short loc_140290A20

loc_140290A62:                          ; CODE XREF: sub_140290060+9BA↑j
                cmp     bl, cl
                jz      short loc_140290A6F
                and     byte ptr [rdx+10h], 0FCh
                jmp     loc_140290BDB
; ---------------------------------------------------------------------------

loc_140290A6F:                          ; CODE XREF: sub_140290060+A04↑j
                movzx   eax, byte ptr [rdi+10h]
                and     eax, 3
                movzx   esi, bl
                movzx   r9d, r10b
                cmp     eax, esi
                jnz     loc_140290B3F
                mov     rax, [rdi+10h]
                xor     r9d, 1
                and     rax, 0FFFFFFFFFFFFFFFCh
                cmp     rax, rdx
                jnz     loc_140290E19
                mov     eax, r9d
                xor     rax, 1
                mov     r10d, r9d
                cmp     [rdx+rax*8], rdi
                lea     r9, [rdx+rax*8]
                jnz     loc_140290E19
                mov     rcx, [rdx+10h]
                and     rcx, 0FFFFFFFFFFFFFFFCh
                jnz     short loc_140290AD2
                cmp     cs:qword_140C4E3F8, rdx
                jnz     loc_140290E19
                mov     cs:qword_140C4E3F8, rdi
                jmp     short loc_140290AEA
; ---------------------------------------------------------------------------

loc_140290AD2:                          ; CODE XREF: sub_140290060+A5A↑j
                cmp     [rcx+8], rdx
                jnz     short loc_140290ADE
                mov     [rcx+8], rdi
                jmp     short loc_140290AEA
; ---------------------------------------------------------------------------

loc_140290ADE:                          ; CODE XREF: sub_140290060+A76↑j
                cmp     [rcx], rdx
                jnz     loc_140290E19
                mov     [rcx], rdi

loc_140290AEA:                          ; CODE XREF: sub_140290060+A70↑j
                                        ; sub_140290060+A7C↑j
                mov     eax, [rdi+10h]
                and     eax, 3
                or      rax, rcx
                mov     [rdi+10h], rax
                mov     r8, [rdi+r10*8]
                test    r8, r8
                jz      short loc_140290B1E
                mov     rcx, [r8+10h]
                mov     rax, rcx
                and     rax, 0FFFFFFFFFFFFFFFCh
                cmp     rax, rdi
                jnz     loc_140290E19
                and     ecx, 3
                or      rcx, rdx
                mov     [r8+10h], rcx

loc_140290B1E:                          ; CODE XREF: sub_140290060+A9E↑j
                mov     [r9], r8
                mov     [rdi+r10*8], rdx
                mov     eax, [rdx+10h]
                and     eax, 3
                or      rax, rdi
                mov     [rdx+10h], rax
                and     byte ptr [rdi+10h], 0FCh
                and     byte ptr [rdx+10h], 0FCh
                jmp     loc_140290BDB
; ---------------------------------------------------------------------------

loc_140290B3F:                          ; CODE XREF: sub_140290060+A1F↑j
                mov     r8, rdi
                lea     rcx, qword_140C4E3F8
                call    sub_14032FA30
                and     byte ptr [rdx+10h], 0FCh
                movzx   r9d, byte ptr [rdi+10h]
                and     r9b, 0FCh
                mov     [rdi+10h], r9b
                movzx   r8d, byte ptr [rax+10h]
                mov     ecx, r8d
                and     ecx, 3
                cmp     esi, ecx
                jnz     short loc_140290B80
                xor     bl, [rdx+10h]
                xor     bl, 0FEh
                and     bl, 3
                xor     [rdx+10h], bl
                and     byte ptr [rax+10h], 0FCh
                jmp     short loc_140290BDB
; ---------------------------------------------------------------------------

loc_140290B80:                          ; CODE XREF: sub_140290060+B0C↑j
                xor     r8d, 0FFFFFFFEh
                and     r8d, 3
                cmp     esi, r8d
                jnz     short loc_140290B93
                or      bl, r9b
                mov     [rdi+10h], bl

loc_140290B93:                          ; CODE XREF: sub_140290060+B2B↑j
                and     byte ptr [rax+10h], 0FCh
                jmp     short loc_140290BDB
; ---------------------------------------------------------------------------

loc_140290B99:                          ; CODE XREF: sub_140290060+931↑j
                mov     rdx, cs:qword_140C4E3E8
                xor     r8b, r8b
                test    rdx, rdx
                jz      short loc_140290BCC

loc_140290BA8:                          ; CODE XREF: sub_140290060+B59↓j
                                        ; sub_140290060+B67↓j
                cmp     rdi, [rdx+38h]
                jnb     short loc_140290BBB
                mov     rax, [rdx]
                test    rax, rax
                jz      short loc_140290BCC
                mov     rdx, rax
                jmp     short loc_140290BA8
; ---------------------------------------------------------------------------

loc_140290BBB:                          ; CODE XREF: sub_140290060+B4C↑j
                mov     rax, [rdx+8]
                test    rax, rax
                jz      short loc_140290BC9
                mov     rdx, rax
                jmp     short loc_140290BA8
; ---------------------------------------------------------------------------

loc_140290BC9:                          ; CODE XREF: sub_140290060+B62↑j
                mov     r8b, 1

loc_140290BCC:                          ; CODE XREF: sub_140290060+B46↑j
                                        ; sub_140290060+B54↑j
                mov     r9, r12
                lea     rcx, qword_140C4E3E8
                call    RtlAvlInsertNodeEx

loc_140290BDB:                          ; CODE XREF: sub_140290060+98E↑j
                                        ; sub_140290060+9D4↑j ...
                mov     byte ptr [r12+44h], 1
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_140290BFC
                mov     rdx, [rsp+0E8h]
                mov     rcx, r14
                call    sub_1405B6044
                jmp     short loc_140290C03
; ---------------------------------------------------------------------------

loc_140290BFC:                          ; CODE XREF: sub_140290060+B88↑j
                mov     dword ptr [r14], 0

loc_140290C03:                          ; CODE XREF: sub_140290060+B9A↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_140290C2E
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_140290C2E
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_140290C2E
                call    sub_1403F2EC4

loc_140290C2E:                          ; CODE XREF: sub_140290060+BB6↑j
                                        ; sub_140290060+BBC↑j ...
                mov     r11, [rsp+0E8h+var_98]
                mov     ebx, 1

loc_140290C38:                          ; CODE XREF: sub_140290060+5F0↑j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r15+18h], rax
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140290CA1
                test    al, 1
                jz      short loc_140290CA1
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140290CA1
                cmp     r11b, 0Fh
                ja      short loc_140290CA1
                cmp     al, 2
                jb      short loc_140290CA1
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r11b
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   eax, dx
                not     eax
                mov     r8d, [r9+14h]
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     short loc_140290CA1
                mov     rcx, r10
                call    sub_1403F2EC4

loc_140290CA1:                          ; CODE XREF: sub_140290060+BEF↑j
                                        ; sub_140290060+BF3↑j ...
                movzx   eax, byte ptr [rsp+0E8h+var_98]
                mov     cr8, rax
                mov     edi, [rsp+0E8h+arg_8]
                test    ebx, ebx
                jz      loc_140290DF0
                mov     rbx, [rsp+0E8h+var_70]
                mov     rsi, [rsp+0E8h+var_58]

loc_140290CC6:                          ; CODE XREF: sub_140290060+4D8↑j
                test    r15, r15
                jz      loc_140290DF0
                cmp     byte ptr [r12+50h], 0
                jnz     short loc_140290D47
                mov     rax, 0FFFFFA8000000000h
                mov     rax, rax
                mov     rcx, r15
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                sar     rdx, 3
                mov     rcx, rdx
                shr     rcx, 3Fh
                add     rcx, rdx
                call    sub_14027DEC0
                mov     eax, [rax+8]
                cmp     [r12+10Ch], eax
                jz      short loc_140290D47
                imul    rdx, rax, 11C0h
                mov     [r12+10Ch], eax
                lea     rcx, [rsp+0E8h+var_48]
                mov     rax, [rbx+10h]
                movups  xmm0, xmmword ptr [rdx+rax+1178h]
                movaps  [rsp+0E8h+var_48], xmm0
                call    sub_1403002B8

loc_140290D47:                          ; CODE XREF: sub_140290060+C75↑j
                                        ; sub_140290060+CB5↑j
                mov     r8d, edi
                mov     rdx, r15
                mov     rcx, r12
                call    sub_140291BB0

loc_140290D55:                          ; CODE XREF: sub_140290060+46F↑j
                test    eax, eax
                jz      loc_140290DF0
                mov     rdx, rbx
                mov     rcx, r12
                call    sub_140290E50
                mov     ebx, 1
                cmp     edi, 3
                jnz     short loc_140290D76
                mov     ecx, ebx
                jmp     short loc_140290D89
; ---------------------------------------------------------------------------

loc_140290D76:                          ; CODE XREF: sub_140290060+D10↑j
                mov     eax, edi
                lea     rcx, qword_14001A848
                cmp     edi, 1
                cmovb   eax, ebx
                mov     rcx, [rcx+rax*8]

loc_140290D89:                          ; CODE XREF: sub_140290060+D14↑j
                mov     rax, rcx
                lock xadd [rsi+28h], rax
                mov     rsi, [rsp+0E8h+var_78]
                lock xadd [rsi], ecx
                cmp     dword ptr [rsi], 1000h
                lea     r9, qword_140010630
                mov     r8d, 2
                jb      loc_140290140
                lock or [rsp+0E8h+var_E8], 0
                rdtsc
                shl     rdx, 20h
                mov     rcx, r12
                or      rdx, rax
                sub     rdx, [rsp+0E8h+var_68]
                call    sub_1402FDB0C
                xor     eax, eax
                xchg    eax, [rsi]
                rdtsc
                shl     rdx, 20h
                or      rax, rdx
                lock or [rsp+0E8h+var_E8], 0
                jmp     loc_140290121
; ---------------------------------------------------------------------------

loc_140290DE9:                          ; CODE XREF: sub_140290060+5C9↑j
                mov     edi, [rsp+0E8h+arg_8]

loc_140290DF0:                          ; CODE XREF: sub_140290060+C53↑j
                                        ; sub_140290060+C69↑j ...
                cmp     edi, 3
                jnb     loc_140290428
                mov     r12, [rsp+0E8h+arg_0]
                inc     edi
                mov     rsi, [rsp+0E8h+var_78]
                mov     ebx, 1
                mov     [rsp+0E8h+arg_8], edi
                jmp     loc_140290129
; ---------------------------------------------------------------------------

loc_140290E19:                          ; CODE XREF: sub_140290060+A34↑j
                                        ; sub_140290060+A4C↑j ...
                mov     ecx, 1Dh
                int     29h             ; Win8: RtlFailFast(ecx)
; ---------------------------------------------------------------------------

loc_140290E20:                          ; CODE XREF: sub_140290060+5D5↑j
                mov     rax, [r15+8]
                mov     edx, 8Dh
                mov     r9d, [r15+20h]
                mov     r8, rsi
                mov     [rsp+0E8h+var_C8], rax
                lea     ecx, [rdx-3Fh]
                call    KeBugCheckEx
; ---------------------------------------------------------------------------
                db 0CCh
sub_140290060   endp

byte_140290E3E  db 12h dup(0CCh)        ; DATA XREF: .pdata:00000001400CF03C↑o

; =============== S U B R O U T I N E =======================================


sub_140290E50   proc near               ; CODE XREF: sub_140290060+D03↑p
                                        ; sub_1403CA820+E8974↓p
                                        ; DATA XREF: ...

var_188         = byte ptr -188h
var_184         = dword ptr -184h
var_180         = dword ptr -180h
var_17C         = dword ptr -17Ch
var_178         = qword ptr -178h
var_170         = dword ptr -170h
var_16C         = dword ptr -16Ch
var_168         = qword ptr -168h
var_160         = qword ptr -160h
var_158         = qword ptr -158h
var_150         = dword ptr -150h
var_14C         = dword ptr -14Ch
var_148         = dword ptr -148h
var_144         = dword ptr -144h
var_140         = qword ptr -140h
var_138         = qword ptr -138h
var_130         = qword ptr -130h
var_128         = qword ptr -128h
var_120         = qword ptr -120h
var_118         = qword ptr -118h
var_110         = xmmword ptr -110h
var_100         = qword ptr -100h
var_F8          = qword ptr -0F8h
var_F0          = qword ptr -0F0h
var_E8          = qword ptr -0E8h
var_E0          = qword ptr -0E0h
var_D8          = xmmword ptr -0D8h
var_C8          = xmmword ptr -0C8h
var_B8          = xmmword ptr -0B8h
var_A8          = xmmword ptr -0A8h
var_98          = xmmword ptr -98h
var_88          = xmmword ptr -88h
var_78          = xmmword ptr -78h
var_68          = xmmword ptr -68h
var_58          = xmmword ptr -58h
var_48          = qword ptr -48h
var_38          = qword ptr -38h
var_28          = byte ptr -28h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; __unwind { // __GSHandlerCheck_SEH
                mov     [rsp+arg_10], rbx
                mov     [rsp+arg_18], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 180h
                mov     rax, cs:__security_cookie
                xor     rax, rsp
                mov     [rsp+1A8h+var_38], rax
                mov     [rsp+1A8h+var_140], rdx
                mov     rdi, rcx
                mov     [rsp+1A8h+var_160], rcx
                mov     [rsp+1A8h+var_138], rcx
                mov     [rsp+1A8h+var_120], rcx
                mov     [rsp+1A8h+var_158], rdx
                xorps   xmm0, xmm0
                xor     eax, eax
                movups  [rsp+1A8h+var_110], xmm0
                mov     [rsp+1A8h+var_100], rax
                xor     ebx, ebx
                mov     [rsp+1A8h+var_168], rbx
                mov     r15, [rcx+48h]
                mov     [rsp+1A8h+var_130], r15
                mov     [rsp+1A8h+var_128], r15
                mov     r13, rcx
                mov     [rsp+1A8h+var_178], rcx
                mov     rcx, [rcx+28h]
                mov     r9d, [r13+40h]
                mov     [rsp+1A8h+var_180], r9d
                mov     [rsp+1A8h+var_16C], r9d
                mov     [rsp+1A8h+var_118], r9
                lea     r8, cs:140000000h
                cmp     r9d, 3
                jnb     short loc_140290F3E
                mov     rdx, ds:rva qword_14001A848[r8+r9*8]
                cmp     [r13+50h], al
                jz      short loc_140290F36
                test    r9d, r9d
                jnz     short loc_140290F36
                mov     rax, [r13+0E0h]
                mov     [rsp+1A8h+var_168], rax
                movzx   ecx, word ptr [r13+0D8h]
                shl     rcx, 15h
                add     rcx, [rax+0B0h]
                mov     r13, rax
                mov     [rsp+1A8h+var_178], rax
                mov     edx, 200h

loc_140290F36:                          ; CODE XREF: sub_140290E50+B3↑j
                                        ; sub_140290E50+B8↑j
                mov     r12d, 1
                jmp     short loc_140290F47
; ---------------------------------------------------------------------------

loc_140290F3E:                          ; CODE XREF: sub_140290E50+A5↑j
                mov     r12d, 1
                mov     edx, r12d

loc_140290F47:                          ; CODE XREF: sub_140290E50+EC↑j
                mov     rax, r9
                cmp     r13, rdi
                jnz     short loc_140290F57
                inc     rva dword_140C2A178[r8+rax*4]

loc_140290F57:                          ; CODE XREF: sub_140290E50+FD↑j
                shl     rdx, 0Ch
                cmp     r9d, 1
                ja      short loc_140290F69
                inc     rva dword_140C2A138[r8+rax*4]

loc_140290F69:                          ; CODE XREF: sub_140290E50+10F↑j
                                        ; DATA XREF: .rdata:000000014005F7BC↑o
;   __try { // __except at loc_140290F79
                call    sub_1404023E0
                mov     ecx, [rsp+1A8h+var_180]
                mov     rdi, [rsp+1A8h+var_140]
                jmp     short loc_140290FAD
;   } // starts at 140290F69
; ---------------------------------------------------------------------------

loc_140290F79:                          ; DATA XREF: .rdata:000000014005F7BC↑o
;   __except(1) // owned by 140290F69
                xor     ebx, ebx
                lea     r12d, [rbx+1]
                mov     r15, [rsp+1A8h+var_128]
                mov     [rsp+1A8h+var_130], r15
                mov     ecx, [rsp+1A8h+var_16C]
                mov     [rsp+1A8h+var_180], ecx
                mov     rax, [rsp+1A8h+var_138]
                mov     [rsp+1A8h+var_160], rax
                mov     rdi, [rsp+1A8h+var_158]
                mov     [rsp+1A8h+var_140], rdi
                mov     r13, [rsp+1A8h+var_178]

loc_140290FAD:                          ; CODE XREF: sub_140290E50+127↑j
                mov     [rsp+1A8h+var_184], r12d
                mov     esi, r12d
                mov     [rsp+1A8h+var_148], r12d
                mov     r14d, ebx
                mov     [rsp+1A8h+var_17C], ebx
                mov     [rsp+1A8h+var_170], ebx
                mov     [rsp+1A8h+var_16C], ebx
                mov     r9, gs:188h
                mov     [rsp+1A8h+var_128], r9
                call    sub_1403F7774
                test    eax, eax
                jz      short loc_14029102F
                cmp     byte ptr [r9+0C3h], 0
                jnz     short loc_14029102F
                cmp     byte ptr [r13+46h], 0
                jnz     short loc_14029102F
                cmp     byte ptr [r13+45h], 0
                jnz     short loc_14029102F
                mov     [rsp+1A8h+var_170], r12d
                mov     r8d, r12d
                mov     rdx, r9
                mov     rcx, rdi
                call    sub_1405500B4
                mov     [rsp+1A8h+var_16C], eax
                mov     rax, [rsp+1A8h+var_128]
                dec     word ptr [rax+1E6h]
                lea     rcx, [rdi+0C0h]
                xor     edx, edx
                call    ExAcquirePushLockSharedEx

loc_14029102F:                          ; CODE XREF: sub_140290E50+191↑j
                                        ; sub_140290E50+19B↑j ...
                mov     [rsp+1A8h+var_138], rbx
                mov     r13, [rsp+1A8h+var_168]
                test    r13, r13
                jz      short loc_140291076
                mov     r14d, r12d
                mov     r15, [r13+0A8h]
                mov     [rsp+1A8h+var_130], r15
                mov     eax, [r13+0B8h]
                imul    rcx, rax, 11C0h
                add     rcx, 10D0h
                add     rcx, cs:qword_140C50C10
                lea     rdx, [rsp+1A8h+var_110]
                call    KeAcquireInStackQueuedSpinLock

loc_140291076:                          ; CODE XREF: sub_140290E50+1EC↑j
                mov     rcx, cr8
                mov     [rsp+1A8h+var_158], rcx
                mov     edi, 2
                mov     cr8, rdi
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_1402910C8
                test    al, 1
                jz      short loc_1402910C8
                cmp     cl, 0Fh
                ja      short loc_1402910C8
                mov     rax, gs:20h
                mov     r9, [rax+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, cl
                inc     ecx
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                shl     rdx, cl
                and     edx, 4
                or      r8d, edx
                mov     [r9+14h], r8d

loc_1402910C8:                          ; CODE XREF: sub_140290E50+240↑j
                                        ; sub_140290E50+244↑j ...
                mov     [rsp+1A8h+var_150], ebx
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jnb     short loc_140291127
                db      66h, 66h
                nop     word ptr [rax+rax+00000000h]

loc_1402910E0:                          ; CODE XREF: sub_140290E50+2C7↓j
                                        ; sub_140290E50+2D0↓j
                mov     edi, [rsp+1A8h+var_150]
                inc     edi
                mov     [rsp+1A8h+var_150], edi
                test    cs:dword_140CFB240, edi
                jnz     short loc_14029110E
                mov     eax, cs:dword_140CFC41C
                test    al, 40h
                jz      short loc_14029110E
                call    sub_140390EA0
                test    al, al
                jz      short loc_14029110E
                mov     ecx, edi
                call    sub_1403900C0
                jmp     short loc_140291110
; ---------------------------------------------------------------------------

loc_14029110E:                          ; CODE XREF: sub_140290E50+2A0↑j
                                        ; sub_140290E50+2AA↑j ...
                pause

loc_140291110:                          ; CODE XREF: sub_140290E50+2BC↑j
                mov     rax, [r15+18h]
                test    rax, rax
                js      short loc_1402910E0
                lock bts qword ptr [r15+18h], 3Fh ; '?'
                jb      short loc_1402910E0
                mov     edi, 2

loc_140291127:                          ; CODE XREF: sub_140290E50+283↑j
                test    r13, r13
                jz      short loc_1402911A7
                mov     [rsp+1A8h+var_184], ebx
                mov     esi, ebx
                mov     rax, [rsp+1A8h+var_178]
                cmp     byte ptr [rax+45h], 1
                jz      short loc_14029115A
                inc     dword ptr [r13+0C0h]
                cmp     dword ptr [r13+0C0h], 200h
                jz      short loc_140291157
                mov     [rsp+1A8h+var_148], ebx
                jmp     short loc_1402911A7
; ---------------------------------------------------------------------------

loc_140291157:                          ; CODE XREF: sub_140290E50+2FF↑j
                mov     esi, r12d

loc_14029115A:                          ; CODE XREF: sub_140290E50+2EB↑j
                mov     ecx, esi
                mov     [rsp+1A8h+var_184], ecx
                mov     eax, [r13+0BCh]
                cmp     eax, 1
                jnz     short loc_14029119A
                lea     rax, [r13+48h]
                mov     rdx, [rax]
                mov     rcx, [rax+8]
                cmp     [rdx+8], rax
                jnz     short loc_140291193
                cmp     [rcx], rax
                jnz     short loc_140291193
                mov     [rcx], rdx
                mov     [rdx+8], rcx
                mov     esi, r12d
                mov     [rsp+1A8h+var_138], r13
                jmp     short loc_1402911A7
; ---------------------------------------------------------------------------

loc_140291193:                          ; CODE XREF: sub_140290E50+32B↑j
                                        ; sub_140290E50+330↑j
                mov     ecx, 3
                int     29h             ; Win8: RtlFailFast(ecx)
; ---------------------------------------------------------------------------

loc_14029119A:                          ; CODE XREF: sub_140290E50+31A↑j
                dec     eax
                mov     [r13+0BCh], eax
                mov     [rsp+1A8h+var_184], ecx

loc_1402911A7:                          ; CODE XREF: sub_140290E50+2DA↑j
                                        ; sub_140290E50+305↑j ...
                mov     rax, [rsp+1A8h+var_178]
                movzx   r13d, byte ptr [rax+45h]
                mov     [rsp+1A8h+var_188], r13b
                cmp     esi, 1
                jnz     loc_140291692
                cmp     r14d, esi
                jnz     short loc_1402911E6
                mov     rdi, [rsp+1A8h+var_160]
                mov     rax, [rdi+0E0h]
                mov     rcx, [rax+0B0h]
                call    sub_14039A9DC
                mov     rax, [rsp+1A8h+var_178]
                jmp     loc_140291697
; ---------------------------------------------------------------------------

loc_1402911E6:                          ; CODE XREF: sub_140290E50+372↑j
                mov     rax, [rsp+1A8h+var_160]
                mov     r15d, [rax+40h]
                mov     rsi, [rax+20h]
                xor     eax, eax
                mov     [rsp+1A8h+var_F8], rax
                xorps   xmm0, xmm0
                movups  [rsp+1A8h+var_D8], xmm0
                movups  [rsp+1A8h+var_C8], xmm0
                movups  [rsp+1A8h+var_B8], xmm0
                movups  [rsp+1A8h+var_A8], xmm0
                movups  [rsp+1A8h+var_98], xmm0
                movups  [rsp+1A8h+var_88], xmm0
                movups  [rsp+1A8h+var_78], xmm0
                movups  [rsp+1A8h+var_68], xmm0
                movups  [rsp+1A8h+var_58], xmm0
                mov     [rsp+1A8h+var_48], rax
                mov     r12, rbx
                mov     r8d, ebx
                mov     [rsp+1A8h+var_F0], 14h
                mov     r10d, ebx
                xor     r11b, r11b
                mov     r13, rbx
                mov     [rsp+1A8h+var_E8], rbx
                mov     [rsp+1A8h+var_E0], rbx
                cmp     r15d, 1
                ja      short loc_1402912BD
                mov     edx, edi
                sub     edx, r15d
                mov     r8, rsi
                lea     rcx, [rsp+1A8h+var_F8]
                call    sub_14034A590
                mov     r12d, 1
                mov     r13, [rsp+1A8h+var_E8]
                mov     r8d, dword ptr [rsp+1A8h+var_F0+4]
                movzx   r11d, byte ptr [rsp+1A8h+var_F8+4]
                mov     r10d, dword ptr [rsp+1A8h+var_F8]

loc_1402912BD:                          ; CODE XREF: sub_140290E50+42F↑j
                mov     rcx, rsi
                mov     rdi, 0FFFFF68000000000h
                mov     rax, rdi
                mov     r9, 0FFFFF6FFFFFFFFFFh
                cmp     rsi, rax
                jb      short loc_140291302
                nop     dword ptr [rax+00h]

loc_1402912E0:                          ; CODE XREF: sub_140290E50+4B0↓j
                mov     rax, r9
                cmp     rcx, rax
                ja      short loc_140291302
                shl     rcx, 19h
                mov     rax, rdi
                shl     rax, 19h
                sub     rcx, rax
                sar     rcx, 10h
                mov     rax, rdi
                cmp     rcx, rax
                jnb     short loc_1402912E0

loc_140291302:                          ; CODE XREF: sub_140290E50+48A↑j
                                        ; sub_140290E50+496↑j
                mov     rdx, cs:qword_140C4EA78
                test    rdx, rdx
                jz      short loc_14029132C
                cmp     rcx, rdx
                jb      short loc_14029132C
                mov     rax, cs:qword_140C4EA88
                shl     rax, 1Eh
                add     rax, rdx
                cmp     rcx, rax
                jnb     short loc_14029132C
                mov     [rsp+1A8h+var_14C], ebx
                jmp     short loc_14029133B
; ---------------------------------------------------------------------------

loc_14029132C:                          ; CODE XREF: sub_140290E50+4BC↑j
                                        ; sub_140290E50+4C1↑j ...
                mov     eax, 1
                cmp     r15d, eax
                cmova   eax, ebx
                mov     [rsp+1A8h+var_14C], eax

loc_14029133B:                          ; CODE XREF: sub_140290E50+4DA↑j
                test    r12, r12
                jnz     loc_140291606
                mov     r12, rdi
                shl     r12, 19h
                mov     rdi, rsi
                shl     rdi, 19h
                sub     rdi, r12
                sar     rdi, 10h
                cmp     r15d, 3
                jnz     loc_140291591
                mov     r15d, 1
                mov     r12d, r15d
                mov     r14d, r15d
                cmp     r10d, r15d
                jz      short loc_1402913A0
                test    r11b, 8
                jnz     short loc_1402913A0
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                cmp     rdi, rax
                jb      short loc_1402913A0
                mov     rax, r9
                cmp     rdi, rax
                ja      short loc_1402913A0
                or      r11b, 8
                mov     byte ptr [rsp+1A8h+var_F8+4], r11b

loc_1402913A0:                          ; CODE XREF: sub_140290E50+522↑j
                                        ; sub_140290E50+528↑j ...
                test    r8d, r8d
                jz      loc_1402914A3
                test    r11b, 4
                jnz     short loc_140291423
                lea     eax, [r8-1]
                lea     r10, [rsp+1A8h+var_E0]
                lea     r10, [r10+rax*8]
                mov     rax, [r10]
                test    rax, 0C00h
                jnz     short loc_140291423
                mov     r9, rax
                and     r9d, 3FFh
                lea     rdx, [r9+1]
                shl     rdx, 0Ch
                mov     rcx, rax
                and     rcx, 0FFFFFFFFFFFFF000h
                add     rdx, rcx
                cmp     rdx, rdi
                jnz     short loc_140291423
                lea     rcx, [r9+1]
                cmp     rcx, r9
                jbe     short loc_140291423
                cmp     rcx, 3FFh
                ja      short loc_140291423
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rax, rcx
                inc     r13
                mov     [rsp+1A8h+var_E8], r13
                mov     [r10], rax
                jmp     loc_14029160C
; ---------------------------------------------------------------------------

loc_140291423:                          ; CODE XREF: sub_140290E50+55D↑j
                                        ; sub_140290E50+578↑j ...
                test    r8d, r8d
                jz      short loc_1402914A3
                test    r11b, 4
                jnz     short loc_1402914A3
                lea     eax, [r8-1]
                lea     r9, [rsp+1A8h+var_E0]
                lea     r9, [r9+rax*8]
                mov     rax, [r9]
                test    rax, 0C00h
                jnz     short loc_1402914A3
                mov     rdx, rax
                and     rdx, 0FFFFFFFFFFFFF000h
                lea     rcx, [rdi+1000h]
                cmp     rdx, rcx
                jnz     short loc_1402914A3
                mov     rcx, rax
                and     ecx, 3FFh
                lea     rdx, [rcx+1]
                cmp     rdx, rcx
                jbe     short loc_1402914A3
                cmp     rdx, 3FFh
                ja      short loc_1402914A3
                add     rax, 0FFFFFFFFFFFFF000h
                lea     rcx, [rax+1]
                xor     rcx, rax
                and     ecx, 3FFh
                xor     rax, rcx
                inc     r13
                mov     [rsp+1A8h+var_E8], r13
                mov     [r9], rax
                jmp     loc_14029160C
; ---------------------------------------------------------------------------

loc_1402914A3:                          ; CODE XREF: sub_140290E50+553↑j
                                        ; sub_140290E50+5D6↑j ...
                cmp     r8d, dword ptr [rsp+1A8h+var_F0]
                jb      short loc_1402914C0
                mov     byte ptr [rsp+1A8h+var_F8+5], r12b
                jmp     loc_14029160C
; ---------------------------------------------------------------------------
                align 20h

loc_1402914C0:                          ; CODE XREF: sub_140290E50+65B↑j
                                        ; sub_140290E50+72A↓j
                lea     rax, [r14-1]
                mov     edx, 400h
                cmp     rax, 3FFh
                cmovbe  rdx, r14
                sub     r14, rdx
                lea     rax, [rdx-1]
                and     eax, 3FFh
                mov     rcx, rdi
                and     rcx, 0FFFFFFFFFFFFF000h
                or      rax, rcx
                mov     rcx, rdx
                shl     rcx, 0Ch
                add     rdi, rcx
                mov     ecx, r8d
                mov     [rsp+rcx*8+1A8h+var_E0], rax
                mov     r8d, dword ptr [rsp+1A8h+var_F0+4]
                inc     r8d
                mov     dword ptr [rsp+1A8h+var_F0+4], r8d
                add     [rsp+1A8h+var_E8], rdx
                cmp     r8d, dword ptr [rsp+1A8h+var_F0]
                jnz     short loc_140291571
                test    byte ptr [rsp+1A8h+var_F8+4], 4
                jnz     short loc_140291571
                mov     edx, r8d
                lea     r9, sub_14033B080
                mov     r8d, 8
                lea     rcx, [rsp+1A8h+var_E0]
                call    qsort
                lea     rcx, [rsp+1A8h+var_F8]
                call    sub_14033A660
                mov     r8d, dword ptr [rsp+1A8h+var_F0+4]
                cmp     r8d, dword ptr [rsp+1A8h+var_F0]
                jnz     short loc_140291571
                test    r14, r14
                jnz     short loc_14029157F

loc_140291571:                          ; CODE XREF: sub_140290E50+6D4↑j
                                        ; sub_140290E50+6DE↑j ...
                test    r14, r14
                jz      loc_14029160C
                jmp     loc_1402914C0
; ---------------------------------------------------------------------------

loc_14029157F:                          ; CODE XREF: sub_140290E50+71F↑j
                mov     byte ptr [rsp+1A8h+var_F8+5], r12b
                mov     [rsp+1A8h+var_E8], r8
                jmp     short loc_14029160C
; ---------------------------------------------------------------------------

loc_140291591:                          ; CODE XREF: sub_140290E50+50D↑j
                cmp     r15d, 2
                jnz     short loc_1402915B5
                mov     r12d, 10h
                xor     r9d, r9d
                mov     r8d, r12d
                mov     rdx, rdi
                lea     rcx, [rsp+1A8h+var_F8]
                call    sub_1402882E0
                jmp     short loc_140291606
; ---------------------------------------------------------------------------

loc_1402915B5:                          ; CODE XREF: sub_140290E50+745↑j
                lea     r14, cs:140000000h
                mov     r14, ds:rva qword_14001A848[r14+r15*8]
                cmp     r15d, 1
                ja      short loc_140291600
                mov     eax, 2
                sub     eax, r15d
                mov     r15d, eax

loc_1402915D5:                          ; CODE XREF: sub_140290E50+7AE↓j
                xor     r9d, r9d
                mov     r8, r14
                mov     rdx, rdi
                lea     rcx, [rsp+1A8h+var_F8]
                call    sub_1402882E0
                shl     rdi, 19h
                sub     rdi, r12
                sar     rdi, 10h
                shl     r14, 9
                sub     r15, 1
                jnz     short loc_1402915D5

loc_140291600:                          ; CODE XREF: sub_140290E50+778↑j
                mov     r12d, 200h

loc_140291606:                          ; CODE XREF: sub_140290E50+4EE↑j
                                        ; sub_140290E50+763↑j
                mov     r15d, 1

loc_14029160C:                          ; CODE XREF: sub_140290E50+5CE↑j
                                        ; sub_140290E50+64E↑j ...
                lea     r11, [rsi+r12*8]
                cmp     rsi, r11
                jnb     short loc_140291668
                mov     rdi, 0FFFFF6FB7DBED000h
                mov     r14, 0FFFFF6FB7DBED7F8h
                nop     dword ptr [rax+00000000h]

loc_140291630:                          ; CODE XREF: sub_140290E50+816↓j
                mov     edx, ebx
                mov     rax, rdi
                cmp     rsi, rax
                jb      short loc_14029164D
                mov     rax, r14
                cmp     rsi, rax
                ja      short loc_14029164D
                call    sub_140349680
                test    eax, eax
                cmovnz  edx, r15d

loc_14029164D:                          ; CODE XREF: sub_140290E50+7E8↑j
                                        ; sub_140290E50+7F0↑j
                mov     [rsi], rbx
                test    edx, edx
                jz      short loc_14029165F
                mov     rdx, rbx
                mov     rcx, rsi
                call    sub_140349620

loc_14029165F:                          ; CODE XREF: sub_140290E50+802↑j
                add     rsi, 8
                cmp     rsi, r11
                jb      short loc_140291630

loc_140291668:                          ; CODE XREF: sub_140290E50+7C3↑j
                cmp     [rsp+1A8h+var_14C], 0
                jz      short loc_14029167C
                lea     rcx, [rsp+1A8h+var_F8]
                call    sub_14028EDB0

loc_14029167C:                          ; CODE XREF: sub_140290E50+81D↑j
                mov     rax, [rsp+1A8h+var_178]
                movzx   r13d, [rsp+1A8h+var_188]
                mov     r12d, 1
                mov     r15, [rsp+1A8h+var_130]

loc_140291692:                          ; CODE XREF: sub_140290E50+369↑j
                mov     rdi, [rsp+1A8h+var_160]

loc_140291697:                          ; CODE XREF: sub_140290E50+391↑j
                mov     r14, [rsp+1A8h+var_168]
                test    r14, r14
                jz      short loc_1402916AF
                cmp     [rsp+1A8h+var_148], 1
                jnz     short loc_1402916AF
                mov     [rdi+0E0h], rbx

loc_1402916AF:                          ; CODE XREF: sub_140290E50+84F↑j
                                        ; sub_140290E50+856↑j
                mov     edx, [rsp+1A8h+var_184]
                cmp     edx, 1
                jz      short loc_1402916C4
                cmp     [rsp+1A8h+var_138], 0
                jz      loc_140291816

loc_1402916C4:                          ; CODE XREF: sub_140290E50+866↑j
                movzx   eax, byte ptr [rax+47h]
                lea     rcx, unk_140C4E3E0
                lea     rdi, unk_140C4E3F0
                test    al, al
                cmovnz  rdi, rcx
                lea     rcx, qword_140C4E3E8
                lea     r14, qword_140C4E3F8
                cmovnz  r14, rcx
                test    byte ptr cs:xmmword_140CFC480+6, 21h
                jz      short loc_140291706
                mov     dl, 0FFh
                mov     rcx, rdi
                call    sub_1405B5E68
                jmp     loc_1402917B1
; ---------------------------------------------------------------------------

loc_140291706:                          ; CODE XREF: sub_140290E50+8A5↑j
                mov     [rsp+1A8h+var_144], ebx
                mov     rsi, gs:20h
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jz      short loc_140291738
                cmp     byte ptr [rsi+20h], 1
                ja      short loc_140291738
                mov     eax, [rcx+18h]
                add     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_140291738
                mov     rcx, rsi
                call    sub_1403F2EC4

loc_140291738:                          ; CODE XREF: sub_140290E50+8CD↑j
                                        ; sub_140290E50+8D3↑j ...
                lock bts dword ptr [rdi], 1Fh
                jnb     short loc_140291772
                mov     rcx, [rsi+84B8h]
                test    rcx, rcx
                jz      short loc_140291764
                cmp     byte ptr [rsi+20h], 1
                ja      short loc_140291764
                mov     eax, [rcx+18h]
                sub     eax, 1
                mov     [rcx+18h], eax
                jnz     short loc_140291764
                mov     rcx, rsi
                call    sub_1403F2EC4

loc_140291764:                          ; CODE XREF: sub_140290E50+8F9↑j
                                        ; sub_140290E50+8FF↑j ...
                mov     dl, 0FFh
                mov     rcx, rdi
                call    sub_14028EAE0
                mov     [rsp+1A8h+var_144], eax

loc_140291772:                          ; CODE XREF: sub_140290E50+8ED↑j
                mov     edx, [rdi]
                mov     ecx, edx
                btr     ecx, 1Eh
                cmp     ecx, 80000000h
                jz      short loc_1402917B1

loc_140291782:                          ; CODE XREF: sub_140290E50+95F↓j
                bt      edx, 1Eh
                jb      short loc_140291798
                mov     ecx, edx
                bts     ecx, 1Eh
                mov     eax, edx
                lock cmpxchg [rdi], ecx
                mov     edx, eax
                jnz     short loc_1402917A4

loc_140291798:                          ; CODE XREF: sub_140290E50+936↑j
                lea     rcx, [rsp+1A8h+var_144]
                call    sub_1402C8C70
                mov     edx, [rdi]

loc_1402917A4:                          ; CODE XREF: sub_140290E50+946↑j
                mov     eax, edx
                btr     eax, 1Eh
                cmp     eax, 80000000h
                jnz     short loc_140291782

loc_1402917B1:                          ; CODE XREF: sub_140290E50+8B1↑j
                                        ; sub_140290E50+930↑j
                mov     rsi, [rsp+1A8h+var_178]
                mov     rdx, rsi
                mov     rcx, r14
                call    RtlAvlRemoveNode
                mov     byte ptr [rsi+44h], 0
                test    byte ptr cs:xmmword_140CFC480+6, 1
                jz      short loc_1402917E0
                mov     rdx, [rsp+1A8h]
                mov     rcx, rdi
                call    sub_1405B6044
                jmp     short loc_1402917E2
; ---------------------------------------------------------------------------

loc_1402917E0:                          ; CODE XREF: sub_140290E50+97C↑j
                mov     [rdi], ebx

loc_1402917E2:                          ; CODE XREF: sub_140290E50+98E↑j
                mov     rcx, gs:20h
                mov     rdx, [rcx+84B8h]
                test    rdx, rdx
                jz      short loc_14029180D
                cmp     byte ptr [rcx+20h], 1
                ja      short loc_14029180D
                mov     eax, [rdx+18h]
                sub     eax, 1
                mov     [rdx+18h], eax
                jnz     short loc_14029180D
                call    sub_1403F2EC4

loc_14029180D:                          ; CODE XREF: sub_140290E50+9A5↑j
                                        ; sub_140290E50+9AB↑j ...
                mov     edx, [rsp+1A8h+var_184]
                mov     r14, [rsp+1A8h+var_168]

loc_140291816:                          ; CODE XREF: sub_140290E50+86E↑j
                mov     eax, dword ptr [rsp+1A8h+var_118]
                mov     rcx, [rsp+1A8h+var_120]
                movzx   ecx, byte ptr [rcx+50h]
                cmp     r13b, 1
                jnz     loc_1402918E9
                test    cl, cl
                lea     rcx, cs:140000000h
                jz      short loc_140291847
                inc     rva dword_140C2A158[rcx+rax*4]
                jmp     short loc_14029184E
; ---------------------------------------------------------------------------

loc_140291847:                          ; CODE XREF: sub_140290E50+9EC↑j
                inc     rva dword_140C2A198[rcx+rax*4]

loc_14029184E:                          ; CODE XREF: sub_140290E50+9F5↑j
                inc     cs:dword_140C2A134

loc_140291854:                          ; CODE XREF: sub_140290E50+AD2↓j
                mov     r13, rbx

loc_140291857:                          ; CODE XREF: sub_140290E50+B66↓j
                                        ; sub_140290E50+BF7↓j
                mov     esi, [rsp+1A8h+var_180]

loc_14029185B:                          ; CODE XREF: sub_140290E50+C24↓j
                mov     rax, 7FFFFFFFFFFFFFFFh
                lock and [r15+18h], rax
                mov     eax, cs:dword_140CFC660
                mov     rdi, [rsp+1A8h+var_158]
                test    eax, eax
                jz      loc_140291A79
                test    al, 1
                jz      loc_140291A79
                mov     rax, cr8
                cmp     al, 0Fh
                ja      loc_140291A79
                cmp     dil, 0Fh
                ja      loc_140291A79
                mov     r15, 0FFFFFFFFFFFFFFFFh
                cmp     al, 2
                jb      loc_140291A80
                mov     r10, gs:20h
                mov     r9, [r10+84B8h]
                mov     r8d, [r9+14h]
                movzx   ecx, dil
                inc     ecx
                mov     rdx, r15
                shl     rdx, cl
                movzx   eax, dx
                not     eax
                and     r8d, eax
                mov     [r9+14h], r8d
                jnz     loc_140291A80
                mov     rcx, r10
                call    sub_1403F2EC4
                jmp     loc_140291A80
; ---------------------------------------------------------------------------

loc_1402918E9:                          ; CODE XREF: sub_140290E50+9DD↑j
                mov     r8, [rsp+1A8h+var_178]
                test    cl, cl
                lea     rcx, cs:140000000h
                jz      short loc_140291902
                inc     rva dword_140C2A148[rcx+rax*4]
                jmp     short loc_140291919
; ---------------------------------------------------------------------------

loc_140291902:                          ; CODE XREF: sub_140290E50+AA7↑j
                cmp     byte ptr [r8+46h], 0
                jz      short loc_140291912
                inc     rva dword_140C2A168[rcx+rax*4]
                jmp     short loc_140291919
; ---------------------------------------------------------------------------

loc_140291912:                          ; CODE XREF: sub_140290E50+AB7↑j
                inc     rva dword_140C2A188[rcx+rax*4]

loc_140291919:                          ; CODE XREF: sub_140290E50+AB0↑j
                                        ; sub_140290E50+AC0↑j
                inc     cs:dword_140C2A128
                cmp     edx, 1
                jnz     loc_140291854
                mov     rax, 0FFFFFA8000000000h
                mov     rcx, r15
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     r13, rdx
                sar     r13, 3
                mov     rax, r13
                shr     rax, 3Fh
                add     r13, rax
                mov     esi, [rsp+1A8h+var_180]
                cmp     esi, 3
                jnz     loc_140291A4C
                mov     esi, r12d
                inc     cs:dword_140C2A12C
                mov     rax, [rsp+1A8h+var_160]
                mov     [rax+18h], rbx
                movzx   eax, byte ptr [r15+22h]
                and     al, 0F7h
                mov     [r15+22h], al
                mov     eax, 80h
                mov     rdx, cs:qword_140C4DDC0
                test    rdx, rdx
                jz      short loc_1402919A3
                mov     rcx, rdx
                and     rcx, rax
                jnz     short loc_14029199E
                or      rax, rdx
                jmp     short loc_1402919A3
; ---------------------------------------------------------------------------

loc_14029199E:                          ; CODE XREF: sub_140290E50+B47↑j
                mov     eax, 90h

loc_1402919A3:                          ; CODE XREF: sub_140290E50+B3F↑j
                                        ; sub_140290E50+B4C↑j
                mov     [r15+10h], rax
                cmp     byte ptr [r8+46h], 0
                jz      short loc_1402919BB
                mov     rcx, r13
                call    sub_14054F01C
                jmp     loc_140291857
; ---------------------------------------------------------------------------

loc_1402919BB:                          ; CODE XREF: sub_140290E50+B5C↑j
                cmp     [rsp+1A8h+var_170], 0
                jz      short loc_140291A30
                mov     rcx, r13
                call    sub_14027DEC0
                mov     edi, [rax+8]
                mov     rcx, r15
                call    sub_1402DA7F4
                movzx   ecx, cs:byte_140C4DD0D
                shl     eax, cl
                movzx   ecx, cs:byte_140C4DD0C
                shl     edi, cl
                mov     ecx, r13d
                and     ecx, cs:dword_140C4DD78
                or      edi, ecx
                or      edi, eax
                xor     r8d, r8d
                mov     edx, edi
                mov     rcx, [rsp+1A8h+var_140]
                call    sub_140365828
                test    eax, eax
                jz      short loc_140291A30
                lea     rdx, [rdi+rdi*4]
                mov     rax, [rsp+1A8h+var_140]
                mov     rcx, [rax+880h]
                mov     eax, [rax+189Ch]
                shl     eax, 2
                cmp     [rcx+rdx*8], rax
                jb      short loc_140291A30
                mov     esi, 401h
                mov     [rsp+1A8h+var_17C], r12d

loc_140291A30:                          ; CODE XREF: sub_140290E50+B70↑j
                                        ; sub_140290E50+BB5↑j ...
                xor     r8d, r8d
                xor     edx, edx
                mov     rcx, r13
                call    sub_140293F00
                mov     edx, esi
                mov     rcx, r13
                call    sub_140292A50
                jmp     loc_140291857
; ---------------------------------------------------------------------------

loc_140291A4C:                          ; CODE XREF: sub_140290E50+B0D↑j
                mov     eax, ebx
                cmp     [rsp+1A8h+var_170], 0
                jz      short loc_140291A62
                cmp     byte ptr [r8+46h], 0
                cmovz   eax, r12d
                mov     [rsp+1A8h+var_17C], eax

loc_140291A62:                          ; CODE XREF: sub_140290E50+C03↑j
                movzx   r9d, byte ptr [r8+46h]
                mov     r8d, eax
                mov     edx, esi
                mov     rcx, r13
                call    sub_1402DA370
                jmp     loc_14029185B
; ---------------------------------------------------------------------------

loc_140291A79:                          ; CODE XREF: sub_140290E50+A27↑j
                                        ; sub_140290E50+A2F↑j ...
                mov     r15, 0FFFFFFFFFFFFFFFFh

loc_140291A80:                          ; CODE XREF: sub_140290E50+A54↑j
                                        ; sub_140290E50+A86↑j ...
                movzx   eax, dil
                mov     cr8, rax
                test    r14, r14
                jz      short loc_140291AFD
                lea     rcx, [rsp+1A8h+var_110]
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                movzx   edi, byte ptr [rsp+1A8h+var_100]
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140291AF9
                test    al, 1
                jz      short loc_140291AF9
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140291AF9
                cmp     dil, 0Fh
                ja      short loc_140291AF9
                cmp     al, 2
                jb      short loc_140291AF9
                mov     r9, gs:20h
                mov     r8, [r9+84B8h]
                mov     edx, [r8+14h]
                movzx   ecx, byte ptr [rsp+1A8h+var_100]
                inc     ecx
                shl     r15, cl
                movzx   eax, r15w
                not     eax
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_140291AF9
                mov     rcx, r9
                call    sub_1403F2EC4

loc_140291AF9:                          ; CODE XREF: sub_140290E50+C5A↑j
                                        ; sub_140290E50+C5E↑j ...
                mov     cr8, rdi

loc_140291AFD:                          ; CODE XREF: sub_140290E50+C3B↑j
                mov     rax, [rsp+1A8h+var_138]
                test    rax, rax
                jz      short loc_140291B11
                xor     edx, edx
                mov     rcx, rax
                call    ExFreePoolWithTag

loc_140291B11:                          ; CODE XREF: sub_140290E50+CB5↑j
                cmp     [rsp+1A8h+var_17C], 0
                jz      short loc_140291B25
                xor     r8d, r8d
                mov     edx, esi
                mov     rcx, r13
                call    sub_1403F76CC

loc_140291B25:                          ; CODE XREF: sub_140290E50+CC6↑j
                cmp     [rsp+1A8h+var_170], 0
                jz      short loc_140291B7B
                mov     rsi, [rsp+1A8h+var_140]
                mov     eax, 11h
                lock cmpxchg [rsi+0C0h], rbx
                jz      short loc_140291B4D
                lea     rcx, [rsi+0C0h]
                call    ExfReleasePushLockShared

loc_140291B4D:                          ; CODE XREF: sub_140290E50+CEF↑j
                lea     rcx, [rsi+0C0h]
                call    sub_140243660
                mov     rcx, [rsp+1A8h+var_128]
                call    sub_140245770
                mov     r8d, [rsp+1A8h+var_16C]
                mov     rdx, [rsp+1A8h+var_128]
                mov     rcx, rsi
                call    sub_1405500B4

loc_140291B7B:                          ; CODE XREF: sub_140290E50+CDA↑j
                mov     rcx, [rsp+1A8h+var_38]
                xor     rcx, rsp
                call    __security_check_cookie
                lea     r11, [rsp+1A8h+var_28]
                mov     rbx, [r11+40h]
                mov     rsi, [r11+48h]
                mov     rsp, r11
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; } // starts at 140290E50
sub_140290E50   endp

algn_140291BA9:                         ; DATA XREF: .pdata:00000001400CF048↑o
                align 10h

; =============== S U B R O U T I N E =======================================


sub_140291BB0   proc near               ; CODE XREF: sub_140290060+CF0↑p
                                        ; sub_14054FF4C+108↓p
                                        ; DATA XREF: ...

var_58          = qword ptr -58h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = dword ptr  18h
arg_18          = qword ptr  20h

                mov     [rsp+arg_10], r8d
                mov     [rsp+arg_0], rcx
                push    rbx
                push    rbp
                push    rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 38h
                mov     r15d, r8d
                mov     r13, rcx
                mov     eax, r8d
                lea     rcx, cs:140000000h
                mov     rsi, rdx
                cmp     r8d, 3
                jnb     short loc_140291BF0
                lfence
                mov     rdx, ds:rva qword_14001A848[rcx+r15*8]
                jmp     short loc_140291BF5
; ---------------------------------------------------------------------------

loc_140291BF0:                          ; CODE XREF: sub_140291BB0+31↑j
                mov     edx, 1

loc_140291BF5:                          ; CODE XREF: sub_140291BB0+3E↑j
                shl     rax, 5
                lea     rcx, [r13+58h]
                mov     [rsp+78h+arg_8], rdx
                mov     r8, rdx
                add     rcx, rax
                xor     r9d, r9d
                mov     edx, r15d
                call    sub_140292240
                mov     rdi, rax
                mov     [rsp+78h+var_58], rax
                shr     rdi, 9
                mov     rdx, 7FFFFFFFF8h
                and     rdi, rdx
                mov     r9, 0FFFFF68000000000h
                mov     rax, r9
                add     rdi, rax
                mov     r8d, 2
                cmp     r15d, 1
                ja      short loc_140291C64
                mov     ecx, r8d
                sub     ecx, r15d

loc_140291C51:                          ; CODE XREF: sub_140291BB0+B2↓j
                shr     rdi, 9
                and     rdi, rdx
                mov     rax, r9
                add     rdi, rax
                sub     rcx, 1
                jnz     short loc_140291C51

loc_140291C64:                          ; CODE XREF: sub_140291BB0+99↑j
                mov     rax, 0FFFFFA8000000000h
                mov     rcx, rsi
                sub     rcx, rax
                mov     rax, 2AAAAAAAAAAAAAABh
                imul    rcx
                mov     rbp, rdx
                sar     rbp, 3
                mov     rax, rbp
                shr     rax, 3Fh
                add     rbp, rax
                mov     r12, cr8
                mov     [rsp+78h+arg_18], r12
                mov     cr8, r8
                mov     eax, cs:dword_140CFC660
                mov     r14, 0FFFFFFFFFFFFFFFFh
                test    eax, eax
                jz      short loc_140291CE7
                test    al, 1
                jz      short loc_140291CE7
                cmp     r12b, 0Fh
                ja      short loc_140291CE7
                mov     rax, gs:20h
                mov     rdx, r14
                movzx   ecx, r12b
                inc     ecx
                shl     rdx, cl
                mov     r9, [rax+84B8h]
                and     edx, 4
                mov     r8d, [r9+14h]
                or      r8d, edx
                mov     [r9+14h], r8d

loc_140291CE7:                          ; CODE XREF: sub_140291BB0+101↑j
                                        ; sub_140291BB0+105↑j ...
                xor     ebx, ebx
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jnb     short loc_140291D2C

loc_140291CF2:                          ; CODE XREF: sub_140291BB0+171↓j
                                        ; sub_140291BB0+17A↓j
                inc     ebx
                test    cs:dword_140CFB240, ebx
                jnz     short loc_140291D18
                mov     eax, cs:dword_140CFC41C
                test    al, 40h
                jz      short loc_140291D18
                call    sub_140390EA0
                test    al, al
                jz      short loc_140291D18
                mov     ecx, ebx
                call    sub_1403900C0
                jmp     short loc_140291D1A
; ---------------------------------------------------------------------------

loc_140291D18:                          ; CODE XREF: sub_140291BB0+14A↑j
                                        ; sub_140291BB0+154↑j ...
                pause

loc_140291D1A:                          ; CODE XREF: sub_140291BB0+166↑j
                mov     rax, [rsi+18h]
                test    rax, rax
                js      short loc_140291CF2
                lock bts qword ptr [rsi+18h], 3Fh ; '?'
                jb      short loc_140291CF2

loc_140291D2C:                          ; CODE XREF: sub_140291BB0+140↑j
                cmp     byte ptr [r13+45h], 1
                jnz     short loc_140291DB2
                mov     rcx, r13
                call    sub_14035A03C
                mov     r15, 7FFFFFFFFFFFFFFFh
                lock and [rsi+18h], r15
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_140291D9D
                test    al, 1
                jz      short loc_140291D9D
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_140291D9D
                cmp     r12b, 0Fh
                ja      short loc_140291D9D
                cmp     al, 2
                jb      short loc_140291D9D
                mov     r9, gs:20h
                movzx   ecx, r12b
                inc     ecx
                shl     r14, cl
                mov     r8, [r9+84B8h]
                movzx   eax, r14w
                not     eax
                mov     edx, [r8+14h]
                and     edx, eax
                mov     [r8+14h], edx
                jnz     short loc_140291D9D
                mov     rcx, r9
                call    sub_1403F2EC4

loc_140291D9D:                          ; CODE XREF: sub_140291BB0+1A2↑j
                                        ; sub_140291BB0+1A6↑j ...
                movzx   eax, r12b
                mov     cr8, rax
                inc     cs:dword_140C2A130
                xor     eax, eax
                jmp     loc_14029221C
; ---------------------------------------------------------------------------

loc_140291DB2:                          ; CODE XREF: sub_140291BB0+181↑j
                movzx   ecx, byte ptr [rsi+22h]
                mov     eax, ecx
                shr     eax, 6
                cmp     [rsp+78h+arg_8], 1
                jnz     short loc_140291E0D
                test    eax, eax
                jz      short loc_140291DE9
                cmp     eax, 2
                jz      short loc_140291DE9
                and     cl, 0C0h
                cmp     cl, 0C0h
                jnz     short loc_140291E0D
                mov     edx, 1
                mov     rcx, rsi
                mov     r8d, edx
                call    sub_1402DF1A4
                jmp     short loc_140291E0D
; ---------------------------------------------------------------------------

loc_140291DE9:                          ; CODE XREF: sub_140291BB0+218↑j
                                        ; sub_140291BB0+21D↑j
                add     rax, rax
                lea     r10, cs:140000000h
                mov     eax, rva dword_140C4DE1C[r10+rax*8]
                cmp     eax, 1
                jnz     short loc_140291E14
                mov     edx, eax
                mov     r8d, eax
                mov     rcx, rsi
                call    sub_14031F848

loc_140291E0D:                          ; CODE XREF: sub_140291BB0+214↑j
                                        ; sub_140291BB0+225↑j ...
                lea     r10, cs:140000000h

loc_140291E14:                          ; CODE XREF: sub_140291BB0+24E↑j
                movzx   ecx, byte ptr [rsi+22h]
                mov     eax, 4
                shr     cl, 6
                test    cl, cl
                jnz     short loc_140291E2B
                mov     eax, 0Ch
                jmp     short loc_140291E36
; ---------------------------------------------------------------------------

loc_140291E2B:                          ; CODE XREF: sub_140291BB0+272↑j
                cmp     cl, 2
                mov     edx, 1Ch
                cmovz   eax, edx

loc_140291E36:                          ; CODE XREF: sub_140291BB0+279↑j
                mov     r14d, eax
                or      r14d, 0A0000000h
                cmp     r15d, 1
                ja      short loc_140291E50
                mov     r14d, eax
                or      r14d, 0A4000000h

loc_140291E50:                          ; CODE XREF: sub_140291BB0+294↑j
                mov     eax, r14d
                mov     r8, 0FFFFF68000000000h
                and     eax, 1Fh
                mov     rbx, ds:rva qword_140017520[r10+rax*8]
                mov     rax, 0FFFF000000000E7Fh
                and     rbx, rax
                mov     rax, 0FFFFFFFFFh
                and     rbp, rax
                shl     rbp, 0Ch
                or      rbx, rbp
                or      rbx, 21h
                mov     rax, r8
                mov     rcx, 8000000000000000h
                mov     r15, 7FFFFFFFFFFFFFFFh
                cmp     rdi, rax
                jb      loc_140291FE1
                mov     r9, 0FFFFF6FFFFFFFFFFh
                mov     rax, r9
                cmp     rdi, rax
                ja      loc_140291FE1
                mov     rbp, rdi
                shl     rbp, 19h
                mov     rax, r8
                shl     rax, 19h
                sub     rbp, rax
                sar     rbp, 10h
                mov     rax, 0FFFFF6FB40000000h
                cmp     rdi, rax
                jb      short loc_140291F3F
                mov     rax, 0FFFFF6FB7FFFFFFFh
                cmp     rdi, rax
                ja      short loc_140291F3F
                mov     rax, 0FFFFF6FB7DBEDF68h
                cmp     rdi, rax
                jnz     short loc_140291F0A
                or      rbx, rcx
                jmp     short loc_140291F14
; ---------------------------------------------------------------------------

loc_140291F0A:                          ; CODE XREF: sub_140291BB0+353↑j
                bt      r14d, 1Ah
                jb      short loc_140291F14
                and     rbx, r15

loc_140291F14:                          ; CODE XREF: sub_140291BB0+358↑j
                                        ; sub_140291BB0+35F↑j
                mov     rcx, rdi
                call    sub_14033FA34
                mov     r9, 0FFFFF6FFFFFFFFFFh
                lea     r10, cs:140000000h
                mov     r8, 0FFFFF68000000000h
                test    eax, eax
                jz      short loc_140291F3F
                or      rbx, 4

loc_140291F3F:                          ; CODE XREF: sub_140291BB0+335↑j
                                        ; sub_140291BB0+344↑j ...
                mov     rcx, rbx
                mov     rax, r8
                or      rbx, 4
                mov     rdx, 3FFFFFFF78h
                add     rax, rdx
                cmp     rdi, rax
                cmova   rbx, rcx
                bt      r14d, 1Ah
                jnb     short loc_140291F79
                mov     rcx, rbp
                call    sub_14027F590
                mov     rbp, rax
                mov     r8, 0FFFFF68000000000h

loc_140291F79:                          ; CODE XREF: sub_140291BB0+3B2↑j
                mov     rax, 0FFFF800000000000h
                cmp     rbp, rax
                jnb     short loc_140291F91
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jmp     short loc_140291FDD
; ---------------------------------------------------------------------------

loc_140291F91:                          ; CODE XREF: sub_140291BB0+3D6↑j
                mov     rax, rbp
                shr     rax, 27h
                and     eax, 1FFh
                add     eax, 0FFFFFF00h
                cmp     byte ptr [rax+r10+0C4F848h], 1
                jz      short loc_140291FE6
                mov     rax, r8
                cmp     rbp, rax
                jb      short loc_140291FBD
                mov     rax, r9
                cmp     rbp, rax
                jbe     short loc_140291FE6

loc_140291FBD:                          ; CODE XREF: sub_140291BB0+403↑j
                cmp     rbp, cs:qword_140C4F9B8
                jb      short loc_140291FD6
                cmp     rbp, cs:qword_140C4E1E8
                movzx   eax, byte ptr cs:word_140C4DE88+1
                jbe     short loc_140291FDD

loc_140291FD6:                          ; CODE XREF: sub_140291BB0+414↑j
                movzx   eax, byte ptr cs:word_140C4DE88

loc_140291FDD:                          ; CODE XREF: sub_140291BB0+3DF↑j
                                        ; sub_140291BB0+424↑j
                test    eax, eax
                jz      short loc_140291FE6

loc_140291FE1:                          ; CODE XREF: sub_140291BB0+2F7↑j
                                        ; sub_140291BB0+30D↑j
                bts     rbx, 8

loc_140291FE6:                          ; CODE XREF: sub_140291BB0+3FB↑j
                                        ; sub_140291BB0+40B↑j ...
                movzx   eax, byte ptr cs:word_140C4DE88
                mov     ebp, [rsp+78h+arg_10]
                shl     rax, 8
                xor     rax, rbx
                and     eax, 100h
                xor     rax, rbx
                or      rax, 42h
                mov     rbx, rax
                bts     rbx, 7
                and     r14d, 4000000h
                cmovz   rbx, rax
                mov     rax, 0FAFFFFFFFFFFFFFFh
                and     rbx, rax
                mov     rax, 0A00000000000000h
                or      rbx, rax
                cmp     ebp, 1
                ja      short loc_1402920A8
                mov     rcx, rdi
                call    sub_1402433C0
                test    eax, eax
                jz      short loc_1402920A0
                call    sub_140349680
                test    eax, eax
                jz      short loc_140292077
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140292064
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_140292064:                          ; CODE XREF: sub_140291BB0+4A5↑j
                mov     rdx, rbx
                mov     [rdi], rbx
                mov     rcx, rdi
                call    sub_140349620
                jmp     loc_140292185
; ---------------------------------------------------------------------------

loc_140292077:                          ; CODE XREF: sub_140291BB0+49C↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_1402920A0
                mov     rax, 8000000000000000h
                or      rbx, rax

loc_1402920A0:                          ; CODE XREF: sub_140291BB0+493↑j
                                        ; sub_140291BB0+4E1↑j
                mov     [rdi], rbx
                jmp     loc_140292185
; ---------------------------------------------------------------------------

loc_1402920A8:                          ; CODE XREF: sub_140291BB0+487↑j
                mov     rax, [rsp+78h+arg_8]
                lea     r14, ds:0[rax*8]
                lea     r11, [r14+rdi]
                cmp     rdi, r11
                jnb     loc_140292182
                mov     r12, 0FFFFF6FB7DBED000h
                mov     rbp, 8000000000000000h
                mov     r13, 0FFFFF6FB7DBED7F8h

loc_1402920E3:                          ; CODE XREF: sub_140291BB0+5B5↓j
                mov     rdx, rbx
                mov     rax, r12
                cmp     rdi, rax
                jb      short loc_140292141
                mov     rax, r13
                cmp     rdi, rax
                ja      short loc_140292141
                call    sub_140349680
                test    eax, eax
                jz      short loc_14029211D
                cmp     byte ptr cs:word_140C4DE88+1, 0
                jnz     short loc_140292110
                test    bl, 1
                jz      short loc_140292110
                or      rdx, rbp

loc_140292110:                          ; CODE XREF: sub_140291BB0+556↑j
                                        ; sub_140291BB0+55B↑j
                mov     rcx, rdi
                mov     [rdi], rdx
                call    sub_140349620
                jmp     short loc_140292144
; ---------------------------------------------------------------------------

loc_14029211D:                          ; CODE XREF: sub_140291BB0+54D↑j
                mov     rax, gs:188h
                mov     rcx, [rax+0B8h]
                test    dword ptr [rcx+87Ch], 1000h
                jz      short loc_140292141
                test    bl, 1
                jz      short loc_140292141
                or      rdx, rbp

loc_140292141:                          ; CODE XREF: sub_140291BB0+53C↑j
                                        ; sub_140291BB0+544↑j ...
                mov     [rdi], rdx

loc_140292144:                          ; CODE XREF: sub_140291BB0+56B↑j
                lea     rax, [rbx+1000h]
                mov     rcx, 0FFFFFFFFF000h
                xor     rax, rbx
                add     rdi, 8
                and     rax, rcx
                xor     rbx, rax
                cmp     rdi, r11
                jb      loc_1402920E3
                mov     r12, [rsp+78h+arg_18]
                mov     r13, [rsp+78h+arg_0]
                mov     ebp, [rsp+78h+arg_10]

loc_140292182:                          ; CODE XREF: sub_140291BB0+50F↑j
                sub     rdi, r14

loc_140292185:                          ; CODE XREF: sub_140291BB0+4C2↑j
                                        ; sub_140291BB0+4F3↑j
                mov     rcx, [rsp+78h+var_58]
                mov     rax, [rsp+78h+arg_8]
                shl     rax, 0Ch
                dec     rax
                mov     [r13+20h], rdi
                add     rax, rcx
                mov     [r13+28h], rcx
                mov     [r13+30h], rax
                mov     [r13+40h], ebp
                mov     [r13+48h], rsi
                lock and [rsi+18h], r15
                mov     eax, cs:dword_140CFC660
                test    eax, eax
                jz      short loc_14029220F
                test    al, 1
                jz      short loc_14029220F
                mov     rax, cr8
                cmp     al, 0Fh
                ja      short loc_14029220F
                cmp     r12b, 0Fh
                ja      short loc_14029220F
                cmp     al, 2
                jb      short loc_14029220F
                mov     r10, gs:20h
                mov     rdx, 0FFFFFFFFFFFFFFFFh
                movzx   ecx, r12b
                inc     ecx
                shl     rdx, cl
                mov     r9, [r10+84B8h]
                movzx   edx, dx
                not     edx
                mov     r8d, [r9+14h]
                and     r8d, edx
                mov     [r9+14h], r8d
                jnz     short loc_14029220F
                mov     rcx, r10
                call    sub_1403F2EC4

loc_14029220F:                          ; CODE XREF: sub_140291BB0+60D↑j
                                        ; sub_140291BB0+611↑j ...
                movzx   ecx, r12b
                mov     cr8, rcx
                mov     eax, 1

loc_14029221C:                          ; CODE XREF: sub_140291BB0+1FD↑j
                add     rsp, 38h
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                pop     rsi
                pop     rbp
                pop     rbx
                retn
; ---------------------------------------------------------------------------
                db 0CCh
sub_140291BB0   endp

algn_14029222E:                         ; DATA XREF: .pdata:00000001400CF054↑o
                align 20h

; =============== S U B R O U T I N E =======================================


sub_140292240   proc near               ; CODE XREF: sub_140229EE0+77F↑p
                                        ; sub_140278C00+1F9↑p ...

var_48          = xmmword ptr -48h
var_38          = qword ptr -38h
var_28          = byte ptr -28h
arg_0           = qword ptr  8
arg_8           = qword ptr  10h
arg_10          = qword ptr  18h
arg_18          = qword ptr  20h

; FUNCTION CHUNK AT 000000014044629E SIZE 00000349 BYTES

                mov     [rsp+arg_8], rbx
                mov     [rsp+arg_10], rbp
                mov     [rsp+arg_18], rsi
                push    rdi
                push    r12
                push    r13
                push    r14
                push    r15
                sub     rsp, 40h
                mov     rdi, [rcx]
                lea     r13, qword_1400112D0
                xor     eax, eax
                mov     r15d, edx
                mov     [rsp+68h+var_38], rax
                xorps   xmm0, xmm0
                mov     ebp, r9d
                mov     r12, r8
                mov     r14, rcx
                mov     r13, [r13+r15*8+0]
                movups  [rsp+68h+var_48], xmm0
                test    rdi, rdi
                jz      loc_1402923FB
                cmp     r15d, 1
                jz      loc_1402923EF
                jb      loc_14029261B
                mov     edx, 200000h

loc_1402922A4:                          ; CODE XREF: sub_140292240+1B6↓j
                lea     rcx, [rdx-1]
                mov     rsi, r12
                shl     rsi, 0Ch
                mov     rax, rcx
                and     rax, rdi
                add     rax, rsi
                cmp     rax, rdx
                ja      loc_14029245C

loc_1402922C1:                          ; CODE XREF: sub_140292240+22E↓j
                test    rdi, rcx
                setnz   cl
                test    bpl, 2
                setz    al
                test    al, cl
                jz      short loc_1402922FB
                lea     rax, [rsi+rdi]
                mov     [r14], rax
                mov     rax, rdi

loc_1402922DC:                          ; CODE XREF: sub_140292240+1AA↓j
                                        ; sub_140292240+217↓j ...
                lea     r11, [rsp+68h+var_28]
                mov     rbx, [r11+38h]
                mov     rbp, [r11+40h]
                mov     rsi, [r11+48h]
                mov     rsp, r11
                pop     r15
                pop     r14
                pop     r13
                pop     r12
                pop     rdi
                retn
; ---------------------------------------------------------------------------
                db 0CCh
; ---------------------------------------------------------------------------

loc_1402922FB:                          ; CODE XREF: sub_140292240+90↑j
                lea     rcx, [rdi-1]
                shr     rcx, 12h
                and     ecx, 3FFFFFF8h
                mov     rax, 0FFFFF6FB40000000h
                add     rcx, rax
                mov     rdx, 0FFFFF68000000000h
                mov     [rsp+68h+arg_0], rcx
                mov     r9, 7FFFFFFFF8h
                cmp     r15d, 1
                jbe     loc_140292627

loc_140292339:                          ; CODE XREF: sub_140292240+408↓j
                mov     rbx, cs:qword_14001D278
                call    sub_1402433C0
                mov     rdx, 8000000000000000h
                test    eax, eax
                jnz     loc_14044629E

loc_140292357:                          ; CODE XREF: sub_140292240+1B40AE↓j
                                        ; sub_140292240+1B40B7↓j ...
                mov     r11, [rsp+68h+arg_0]
                mov     [r11], rbx

loc_14029235F:                          ; CODE XREF: sub_140292240+1B408F↓j
                test    bpl, 2
                jnz     loc_1402925BE
                cmp     r15d, 1
                jz      loc_14029261B
                add     r11, 8
                mov     [rsp+68h+arg_0], r11
                test    r11, 0FFFh
                jz      loc_14029261B
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                mov     rdx, [r14+10h]
                mov     rbp, r11
                shl     rbp, 19h
                mov     r8d, 0B8000004h
                shl     rax, 19h
                mov     rcx, r11
                sub     rbp, rax
                sar     rbp, 10h
                shl     rbp, 19h
                sub     rbp, rax
                sar     rbp, 10h
                call    sub_140280E60
                mov     rdi, [rsp+68h+arg_0]
                mov     rbx, rax
                mov     rcx, rdi
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140446373

loc_1402923DD:                          ; CODE XREF: sub_140292240+1B4185↓j
                                        ; sub_140292240+1B418E↓j ...
                mov     [rdi], rbx

loc_1402923E0:                          ; CODE XREF: sub_140292240+1B4166↓j
                lea     rcx, [rsi+rbp]
                mov     rax, rbp
                mov     [r14], rcx
                jmp     loc_1402922DC
; ---------------------------------------------------------------------------

loc_1402923EF:                          ; CODE XREF: sub_140292240+53↑j
                mov     rdx, r13
                shl     rdx, 9
                jmp     loc_1402922A4
; ---------------------------------------------------------------------------

loc_1402923FB:                          ; CODE XREF: sub_140292240+49↑j
                mov     rsi, 8000000000000000h

loc_140292405:                          ; CODE XREF: sub_140292240+3D6↓j
                lea     rdx, [rsp+68h+var_48]
                lea     rcx, unk_140C4EA70
                call    KeAcquireInStackQueuedSpinLock
                mov     rax, 0FFFFF6FB7DA00000h
                test    rdi, rdi
                jnz     loc_140292576

loc_140292429:                          ; CODE XREF: sub_140292240+379↓j
                test    bpl, 2
                jz      short loc_140292473
                xor     ebp, ebp
                lea     rcx, [rsp+68h+var_48]
                mov     [r14], rbp
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rsp+68h+var_38]
                test    eax, eax
                jnz     loc_140446445

loc_140292451:                          ; CODE XREF: sub_140292240+1B4207↓j
                                        ; sub_140292240+1B4213↓j ...
                mov     cr8, rbx
                xor     eax, eax
                jmp     loc_1402922DC
; ---------------------------------------------------------------------------

loc_14029245C:                          ; CODE XREF: sub_140292240+7B↑j
                dec     rdi
                mov     rax, rcx
                add     rdi, rdx
                not     rax
                and     rdi, rax
                mov     [r14], rdi
                jmp     loc_1402922C1
; ---------------------------------------------------------------------------

loc_140292473:                          ; CODE XREF: sub_140292240+1ED↑j
                xor     ebx, ebx

loc_140292475:                          ; CODE XREF: sub_140292240+1B42D9↓j
                mov     r8, cs:qword_140C4EA80
                lea     rcx, qword_140C4EA88
                mov     edx, 1
                call    RtlFindSetBitsAndClearEx
                mov     r13, rax
                cmp     rax, 0FFFFFFFFFFFFFFFFh
                jz      loc_1404464AF
                inc     rax
                lea     rcx, [rsp+68h+var_48]
                mov     cs:qword_140C4EA80, rax
                call    KeReleaseInStackQueuedSpinLockFromDpcLevel
                mov     eax, cs:dword_140CFC660
                movzx   ebx, byte ptr [rsp+68h+var_38]
                test    eax, eax
                jnz     loc_14044651E

loc_1402924C1:                          ; CODE XREF: sub_140292240+1B42E0↓j
                                        ; sub_140292240+1B42EC↓j ...
                mov     cr8, rbx
                shl     r13, 1Eh
                add     r13, cs:qword_140C4EA78
                test    bpl, 1
                jnz     short loc_1402924E0
                shl     r12, 0Ch
                add     r12, r13
                mov     [r14], r12

loc_1402924E0:                          ; CODE XREF: sub_140292240+294↑j
                test    r15d, r15d
                jz      loc_14029256E
                mov     rdi, r13
                mov     rax, 0FFFFF6FB7DA00000h
                shr     rdi, 1Bh
                and     edi, 1FFFF8h
                mov     rax, rax
                add     rdi, rax
                mov     rax, 0FFFFF68000000000h
                mov     r12, rax
                shl     r12, 19h
                add     r14, 8
                cmp     r15d, 1
                mov     ebx, 0
                setnz   bl
                inc     rbx
                mov     [rsp+68h+arg_0], rbx
                mov     rbp, rbx

loc_140292532:                          ; CODE XREF: sub_140292240+32C↓j
                mov     rdx, [r14]
                mov     r8d, 0B8000004h
                mov     rcx, rdi
                call    sub_140280E60
                mov     rcx, rdi
                mov     rbx, rax
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140446588

loc_140292556:                          ; CODE XREF: sub_140292240+1B4390↓j
                                        ; sub_140292240+1B4399↓j ...
                mov     [rdi], rbx

loc_140292559:                          ; CODE XREF: sub_140292240+1B4371↓j
                shl     rdi, 19h
                add     r14, 8
                sub     rdi, r12
                sar     rdi, 10h
                sub     rbp, 1
                jnz     short loc_140292532

loc_14029256E:                          ; CODE XREF: sub_140292240+2A3↑j
                mov     rax, r13
                jmp     loc_1402922DC
; ---------------------------------------------------------------------------

loc_140292576:                          ; CODE XREF: sub_140292240+1E3↑j
                mov     r13, rdi
                shr     rdi, 1Bh
                sub     r13, cs:qword_140C4EA78
                and     edi, 1FFFF8h
                shr     r13, 1Eh
                mov     rax, rax
                mov     rbx, cs:qword_14001D278
                add     rdi, rax
                mov     rcx, rdi
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_1404463E6

loc_1402925AB:                          ; CODE XREF: sub_140292240+1B41EE↓j
                                        ; sub_140292240+1B41F7↓j ...
                mov     [rdi], rbx

loc_1402925AE:                          ; CODE XREF: sub_140292240+1B41CF↓j
                mov     rax, cs:qword_140C4EAA0
                bts     [rax], r13
                jmp     loc_140292429
; ---------------------------------------------------------------------------

loc_1402925BE:                          ; CODE XREF: sub_140292240+123↑j
                cmp     r15d, 1
                jbe     short loc_14029261B
                mov     rax, 7FFFFFFFF8h
                shr     r11, 9
                and     r11, rax
                mov     rax, 0FFFFF68000000000h
                mov     rax, rax
                mov     rbx, cs:qword_14001D278
                add     r11, rax
                mov     rcx, r11
                mov     [rsp+68h+arg_0], r11
                call    sub_1402433C0
                test    eax, eax
                jnz     loc_140446305
                mov     rsi, 8000000000000000h

loc_14029260B:                          ; CODE XREF: sub_140292240+1B411C↓j
                                        ; sub_140292240+1B4125↓j ...
                mov     rax, [rsp+68h+arg_0]
                mov     [rax], rbx

loc_140292613:                          ; CODE XREF: sub_140292240+3E5↓j
                                        ; sub_140292240+1B40FD↓j
                sub     rdi, r13
                jmp     loc_140292405
; ---------------------------------------------------------------------------

loc_14029261B:                          ; CODE XREF: sub_140292240+59↑j
                                        ; sub_140292240+12D↑j ...
                mov     rsi, 8000000000000000h
                jmp     short loc_140292613
; ---------------------------------------------------------------------------

loc_140292627:                          ; CODE XREF: sub_140292240+F3↑j
                mov     r8d, 2
                sub     r8d, r15d

loc_140292630:                          ; CODE XREF: sub_140292240+401↓j
                shr     rcx, 9
                and     rcx, r9
                mov     rax, rdx
                add     rcx, rax
                sub     r8, 1
                jnz     short loc_140292630
                mov     [rsp+68h+arg_0], rcx
                jmp     loc_140292339
sub_140292240   endp

; ---------------------------------------------------------------------------
algn_14029264D:                         ; DATA XREF: .rdata:000000014005F810↑o
                                        ; .pdata:00000001400CF060↑o
                align 20h
; Exported entry 2002. RtlAvlRemoveNode

; =============== S U B R O U T I N E =======================================


